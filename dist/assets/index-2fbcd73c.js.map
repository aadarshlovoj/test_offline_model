{"version":3,"file":"index-2fbcd73c.js","sources":["../../node_modules/three/build/three.webgpu.js","../../node_modules/three/examples/jsm/controls/OrbitControls.js","../../node_modules/three/examples/jsm/utils/BufferGeometryUtils.js","../../node_modules/three/examples/jsm/loaders/GLTFLoader.js","../../node_modules/three/examples/jsm/objects/ShadowMesh.js","../../node_modules/tweakpane/dist/tweakpane.js","../../node_modules/@tweakpane/plugin-essentials/dist/tweakpane-plugin-essentials.js","../../src/script.js"],"sourcesContent":["/**\n * @license\n * Copyright 2010-2024 Three.js Authors\n * SPDX-License-Identifier: MIT\n */\nconst REVISION = '170';\n\nconst MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2, ROTATE: 0, DOLLY: 1, PAN: 2 };\nconst TOUCH = { ROTATE: 0, PAN: 1, DOLLY_PAN: 2, DOLLY_ROTATE: 3 };\nconst CullFaceNone = 0;\nconst CullFaceBack = 1;\nconst CullFaceFront = 2;\nconst CullFaceFrontBack = 3;\nconst BasicShadowMap$1 = 0;\nconst PCFShadowMap$1 = 1;\nconst PCFSoftShadowMap$1 = 2;\nconst VSMShadowMap = 3;\nconst FrontSide = 0;\nconst BackSide = 1;\nconst DoubleSide = 2;\nconst NoBlending = 0;\nconst NormalBlending = 1;\nconst AdditiveBlending = 2;\nconst SubtractiveBlending = 3;\nconst MultiplyBlending = 4;\nconst CustomBlending = 5;\nconst AddEquation = 100;\nconst SubtractEquation = 101;\nconst ReverseSubtractEquation = 102;\nconst MinEquation = 103;\nconst MaxEquation = 104;\nconst ZeroFactor = 200;\nconst OneFactor = 201;\nconst SrcColorFactor = 202;\nconst OneMinusSrcColorFactor = 203;\nconst SrcAlphaFactor = 204;\nconst OneMinusSrcAlphaFactor = 205;\nconst DstAlphaFactor = 206;\nconst OneMinusDstAlphaFactor = 207;\nconst DstColorFactor = 208;\nconst OneMinusDstColorFactor = 209;\nconst SrcAlphaSaturateFactor = 210;\nconst ConstantColorFactor = 211;\nconst OneMinusConstantColorFactor = 212;\nconst ConstantAlphaFactor = 213;\nconst OneMinusConstantAlphaFactor = 214;\nconst NeverDepth = 0;\nconst AlwaysDepth = 1;\nconst LessDepth = 2;\nconst LessEqualDepth = 3;\nconst EqualDepth = 4;\nconst GreaterEqualDepth = 5;\nconst GreaterDepth = 6;\nconst NotEqualDepth = 7;\nconst MultiplyOperation = 0;\nconst MixOperation = 1;\nconst AddOperation = 2;\nconst NoToneMapping = 0;\nconst LinearToneMapping = 1;\nconst ReinhardToneMapping = 2;\nconst CineonToneMapping = 3;\nconst ACESFilmicToneMapping = 4;\nconst CustomToneMapping = 5;\nconst AgXToneMapping = 6;\nconst NeutralToneMapping = 7;\nconst AttachedBindMode = 'attached';\nconst DetachedBindMode = 'detached';\n\nconst UVMapping = 300;\nconst CubeReflectionMapping = 301;\nconst CubeRefractionMapping = 302;\nconst EquirectangularReflectionMapping = 303;\nconst EquirectangularRefractionMapping = 304;\nconst CubeUVReflectionMapping = 306;\nconst RepeatWrapping = 1000;\nconst ClampToEdgeWrapping = 1001;\nconst MirroredRepeatWrapping = 1002;\nconst NearestFilter = 1003;\nconst NearestMipmapNearestFilter = 1004;\nconst NearestMipMapNearestFilter = 1004;\nconst NearestMipmapLinearFilter = 1005;\nconst NearestMipMapLinearFilter = 1005;\nconst LinearFilter = 1006;\nconst LinearMipmapNearestFilter = 1007;\nconst LinearMipMapNearestFilter = 1007;\nconst LinearMipmapLinearFilter = 1008;\nconst LinearMipMapLinearFilter = 1008;\nconst UnsignedByteType = 1009;\nconst ByteType = 1010;\nconst ShortType = 1011;\nconst UnsignedShortType = 1012;\nconst IntType = 1013;\nconst UnsignedIntType = 1014;\nconst FloatType = 1015;\nconst HalfFloatType = 1016;\nconst UnsignedShort4444Type = 1017;\nconst UnsignedShort5551Type = 1018;\nconst UnsignedInt248Type = 1020;\nconst UnsignedInt5999Type = 35902;\nconst AlphaFormat = 1021;\nconst RGBFormat = 1022;\nconst RGBAFormat = 1023;\nconst LuminanceFormat = 1024;\nconst LuminanceAlphaFormat = 1025;\nconst DepthFormat = 1026;\nconst DepthStencilFormat = 1027;\nconst RedFormat = 1028;\nconst RedIntegerFormat = 1029;\nconst RGFormat = 1030;\nconst RGIntegerFormat = 1031;\nconst RGBIntegerFormat = 1032;\nconst RGBAIntegerFormat = 1033;\n\nconst RGB_S3TC_DXT1_Format = 33776;\nconst RGBA_S3TC_DXT1_Format = 33777;\nconst RGBA_S3TC_DXT3_Format = 33778;\nconst RGBA_S3TC_DXT5_Format = 33779;\nconst RGB_PVRTC_4BPPV1_Format = 35840;\nconst RGB_PVRTC_2BPPV1_Format = 35841;\nconst RGBA_PVRTC_4BPPV1_Format = 35842;\nconst RGBA_PVRTC_2BPPV1_Format = 35843;\nconst RGB_ETC1_Format = 36196;\nconst RGB_ETC2_Format = 37492;\nconst RGBA_ETC2_EAC_Format = 37496;\nconst RGBA_ASTC_4x4_Format = 37808;\nconst RGBA_ASTC_5x4_Format = 37809;\nconst RGBA_ASTC_5x5_Format = 37810;\nconst RGBA_ASTC_6x5_Format = 37811;\nconst RGBA_ASTC_6x6_Format = 37812;\nconst RGBA_ASTC_8x5_Format = 37813;\nconst RGBA_ASTC_8x6_Format = 37814;\nconst RGBA_ASTC_8x8_Format = 37815;\nconst RGBA_ASTC_10x5_Format = 37816;\nconst RGBA_ASTC_10x6_Format = 37817;\nconst RGBA_ASTC_10x8_Format = 37818;\nconst RGBA_ASTC_10x10_Format = 37819;\nconst RGBA_ASTC_12x10_Format = 37820;\nconst RGBA_ASTC_12x12_Format = 37821;\nconst RGBA_BPTC_Format = 36492;\nconst RGB_BPTC_SIGNED_Format = 36494;\nconst RGB_BPTC_UNSIGNED_Format = 36495;\nconst RED_RGTC1_Format = 36283;\nconst SIGNED_RED_RGTC1_Format = 36284;\nconst RED_GREEN_RGTC2_Format = 36285;\nconst SIGNED_RED_GREEN_RGTC2_Format = 36286;\nconst LoopOnce = 2200;\nconst LoopRepeat = 2201;\nconst LoopPingPong = 2202;\nconst InterpolateDiscrete = 2300;\nconst InterpolateLinear = 2301;\nconst InterpolateSmooth = 2302;\nconst ZeroCurvatureEnding = 2400;\nconst ZeroSlopeEnding = 2401;\nconst WrapAroundEnding = 2402;\nconst NormalAnimationBlendMode = 2500;\nconst AdditiveAnimationBlendMode = 2501;\nconst TrianglesDrawMode = 0;\nconst TriangleStripDrawMode = 1;\nconst TriangleFanDrawMode = 2;\nconst BasicDepthPacking = 3200;\nconst RGBADepthPacking = 3201;\nconst RGBDepthPacking = 3202;\nconst RGDepthPacking = 3203;\nconst TangentSpaceNormalMap = 0;\nconst ObjectSpaceNormalMap = 1;\n\n// Color space string identifiers, matching CSS Color Module Level 4 and WebGPU names where available.\nconst NoColorSpace = '';\nconst SRGBColorSpace = 'srgb';\nconst LinearSRGBColorSpace = 'srgb-linear';\n\nconst LinearTransfer = 'linear';\nconst SRGBTransfer = 'srgb';\n\nconst ZeroStencilOp = 0;\nconst KeepStencilOp = 7680;\nconst ReplaceStencilOp = 7681;\nconst IncrementStencilOp = 7682;\nconst DecrementStencilOp = 7683;\nconst IncrementWrapStencilOp = 34055;\nconst DecrementWrapStencilOp = 34056;\nconst InvertStencilOp = 5386;\n\nconst NeverStencilFunc = 512;\nconst LessStencilFunc = 513;\nconst EqualStencilFunc = 514;\nconst LessEqualStencilFunc = 515;\nconst GreaterStencilFunc = 516;\nconst NotEqualStencilFunc = 517;\nconst GreaterEqualStencilFunc = 518;\nconst AlwaysStencilFunc = 519;\n\nconst NeverCompare = 512;\nconst LessCompare = 513;\nconst EqualCompare = 514;\nconst LessEqualCompare = 515;\nconst GreaterCompare = 516;\nconst NotEqualCompare = 517;\nconst GreaterEqualCompare = 518;\nconst AlwaysCompare = 519;\n\nconst StaticDrawUsage = 35044;\nconst DynamicDrawUsage = 35048;\nconst StreamDrawUsage = 35040;\nconst StaticReadUsage = 35045;\nconst DynamicReadUsage = 35049;\nconst StreamReadUsage = 35041;\nconst StaticCopyUsage = 35046;\nconst DynamicCopyUsage = 35050;\nconst StreamCopyUsage = 35042;\n\nconst GLSL1 = '100';\nconst GLSL3 = '300 es';\n\nconst WebGLCoordinateSystem = 2000;\nconst WebGPUCoordinateSystem = 2001;\n\n/**\n * https://github.com/mrdoob/eventdispatcher.js/\n */\n\nclass EventDispatcher {\n\n\taddEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) this._listeners = {};\n\n\t\tconst listeners = this._listeners;\n\n\t\tif ( listeners[ type ] === undefined ) {\n\n\t\t\tlisteners[ type ] = [];\n\n\t\t}\n\n\t\tif ( listeners[ type ].indexOf( listener ) === - 1 ) {\n\n\t\t\tlisteners[ type ].push( listener );\n\n\t\t}\n\n\t}\n\n\thasEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return false;\n\n\t\tconst listeners = this._listeners;\n\n\t\treturn listeners[ type ] !== undefined && listeners[ type ].indexOf( listener ) !== - 1;\n\n\t}\n\n\tremoveEventListener( type, listener ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tconst index = listenerArray.indexOf( listener );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\tlistenerArray.splice( index, 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispatchEvent( event ) {\n\n\t\tif ( this._listeners === undefined ) return;\n\n\t\tconst listeners = this._listeners;\n\t\tconst listenerArray = listeners[ event.type ];\n\n\t\tif ( listenerArray !== undefined ) {\n\n\t\t\tevent.target = this;\n\n\t\t\t// Make a copy, in case listeners are removed while iterating.\n\t\t\tconst array = listenerArray.slice( 0 );\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i ++ ) {\n\n\t\t\t\tarray[ i ].call( this, event );\n\n\t\t\t}\n\n\t\t\tevent.target = null;\n\n\t\t}\n\n\t}\n\n}\n\nconst _lut = [ '00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '0a', '0b', '0c', '0d', '0e', '0f', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '1a', '1b', '1c', '1d', '1e', '1f', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '2a', '2b', '2c', '2d', '2e', '2f', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '3a', '3b', '3c', '3d', '3e', '3f', '40', '41', '42', '43', '44', '45', '46', '47', '48', '49', '4a', '4b', '4c', '4d', '4e', '4f', '50', '51', '52', '53', '54', '55', '56', '57', '58', '59', '5a', '5b', '5c', '5d', '5e', '5f', '60', '61', '62', '63', '64', '65', '66', '67', '68', '69', '6a', '6b', '6c', '6d', '6e', '6f', '70', '71', '72', '73', '74', '75', '76', '77', '78', '79', '7a', '7b', '7c', '7d', '7e', '7f', '80', '81', '82', '83', '84', '85', '86', '87', '88', '89', '8a', '8b', '8c', '8d', '8e', '8f', '90', '91', '92', '93', '94', '95', '96', '97', '98', '99', '9a', '9b', '9c', '9d', '9e', '9f', 'a0', 'a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9', 'aa', 'ab', 'ac', 'ad', 'ae', 'af', 'b0', 'b1', 'b2', 'b3', 'b4', 'b5', 'b6', 'b7', 'b8', 'b9', 'ba', 'bb', 'bc', 'bd', 'be', 'bf', 'c0', 'c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7', 'c8', 'c9', 'ca', 'cb', 'cc', 'cd', 'ce', 'cf', 'd0', 'd1', 'd2', 'd3', 'd4', 'd5', 'd6', 'd7', 'd8', 'd9', 'da', 'db', 'dc', 'dd', 'de', 'df', 'e0', 'e1', 'e2', 'e3', 'e4', 'e5', 'e6', 'e7', 'e8', 'e9', 'ea', 'eb', 'ec', 'ed', 'ee', 'ef', 'f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9', 'fa', 'fb', 'fc', 'fd', 'fe', 'ff' ];\n\nlet _seed = 1234567;\n\n\nconst DEG2RAD = Math.PI / 180;\nconst RAD2DEG = 180 / Math.PI;\n\n// http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\nfunction generateUUID() {\n\n\tconst d0 = Math.random() * 0xffffffff | 0;\n\tconst d1 = Math.random() * 0xffffffff | 0;\n\tconst d2 = Math.random() * 0xffffffff | 0;\n\tconst d3 = Math.random() * 0xffffffff | 0;\n\tconst uuid = _lut[ d0 & 0xff ] + _lut[ d0 >> 8 & 0xff ] + _lut[ d0 >> 16 & 0xff ] + _lut[ d0 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d1 & 0xff ] + _lut[ d1 >> 8 & 0xff ] + '-' + _lut[ d1 >> 16 & 0x0f | 0x40 ] + _lut[ d1 >> 24 & 0xff ] + '-' +\n\t\t\t_lut[ d2 & 0x3f | 0x80 ] + _lut[ d2 >> 8 & 0xff ] + '-' + _lut[ d2 >> 16 & 0xff ] + _lut[ d2 >> 24 & 0xff ] +\n\t\t\t_lut[ d3 & 0xff ] + _lut[ d3 >> 8 & 0xff ] + _lut[ d3 >> 16 & 0xff ] + _lut[ d3 >> 24 & 0xff ];\n\n\t// .toLowerCase() here flattens concatenated strings to save heap memory space.\n\treturn uuid.toLowerCase();\n\n}\n\nfunction clamp$1( value, min, max ) {\n\n\treturn Math.max( min, Math.min( max, value ) );\n\n}\n\n// compute euclidean modulo of m % n\n// https://en.wikipedia.org/wiki/Modulo_operation\nfunction euclideanModulo( n, m ) {\n\n\treturn ( ( n % m ) + m ) % m;\n\n}\n\n// Linear mapping from range <a1, a2> to range <b1, b2>\nfunction mapLinear( x, a1, a2, b1, b2 ) {\n\n\treturn b1 + ( x - a1 ) * ( b2 - b1 ) / ( a2 - a1 );\n\n}\n\n// https://www.gamedev.net/tutorials/programming/general-and-gameplay-programming/inverse-lerp-a-super-useful-yet-often-overlooked-function-r5230/\nfunction inverseLerp( x, y, value ) {\n\n\tif ( x !== y ) {\n\n\t\treturn ( value - x ) / ( y - x );\n\n\t} else {\n\n\t\treturn 0;\n\n\t}\n\n}\n\n// https://en.wikipedia.org/wiki/Linear_interpolation\nfunction lerp( x, y, t ) {\n\n\treturn ( 1 - t ) * x + t * y;\n\n}\n\n// http://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\nfunction damp( x, y, lambda, dt ) {\n\n\treturn lerp( x, y, 1 - Math.exp( - lambda * dt ) );\n\n}\n\n// https://www.desmos.com/calculator/vcsjnyz7x4\nfunction pingpong( x, length = 1 ) {\n\n\treturn length - Math.abs( euclideanModulo( x, length * 2 ) - length );\n\n}\n\n// http://en.wikipedia.org/wiki/Smoothstep\nfunction smoothstep$1( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * ( 3 - 2 * x );\n\n}\n\nfunction smootherstep( x, min, max ) {\n\n\tif ( x <= min ) return 0;\n\tif ( x >= max ) return 1;\n\n\tx = ( x - min ) / ( max - min );\n\n\treturn x * x * x * ( x * ( x * 6 - 15 ) + 10 );\n\n}\n\n// Random integer from <low, high> interval\nfunction randInt( low, high ) {\n\n\treturn low + Math.floor( Math.random() * ( high - low + 1 ) );\n\n}\n\n// Random float from <low, high> interval\nfunction randFloat( low, high ) {\n\n\treturn low + Math.random() * ( high - low );\n\n}\n\n// Random float from <-range/2, range/2> interval\nfunction randFloatSpread( range ) {\n\n\treturn range * ( 0.5 - Math.random() );\n\n}\n\n// Deterministic pseudo-random float in the interval [ 0, 1 ]\nfunction seededRandom( s ) {\n\n\tif ( s !== undefined ) _seed = s;\n\n\t// Mulberry32 generator\n\n\tlet t = _seed += 0x6D2B79F5;\n\n\tt = Math.imul( t ^ t >>> 15, t | 1 );\n\n\tt ^= t + Math.imul( t ^ t >>> 7, t | 61 );\n\n\treturn ( ( t ^ t >>> 14 ) >>> 0 ) / 4294967296;\n\n}\n\nfunction degToRad( degrees ) {\n\n\treturn degrees * DEG2RAD;\n\n}\n\nfunction radToDeg( radians ) {\n\n\treturn radians * RAD2DEG;\n\n}\n\nfunction isPowerOfTwo( value ) {\n\n\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n}\n\nfunction ceilPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.ceil( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction floorPowerOfTwo( value ) {\n\n\treturn Math.pow( 2, Math.floor( Math.log( value ) / Math.LN2 ) );\n\n}\n\nfunction setQuaternionFromProperEuler( q, a, b, c, order ) {\n\n\t// Intrinsic Proper Euler Angles - see https://en.wikipedia.org/wiki/Euler_angles\n\n\t// rotations are applied to the axes in the order specified by 'order'\n\t// rotation by angle 'a' is applied first, then by angle 'b', then by angle 'c'\n\t// angles are in radians\n\n\tconst cos = Math.cos;\n\tconst sin = Math.sin;\n\n\tconst c2 = cos( b / 2 );\n\tconst s2 = sin( b / 2 );\n\n\tconst c13 = cos( ( a + c ) / 2 );\n\tconst s13 = sin( ( a + c ) / 2 );\n\n\tconst c1_3 = cos( ( a - c ) / 2 );\n\tconst s1_3 = sin( ( a - c ) / 2 );\n\n\tconst c3_1 = cos( ( c - a ) / 2 );\n\tconst s3_1 = sin( ( c - a ) / 2 );\n\n\tswitch ( order ) {\n\n\t\tcase 'XYX':\n\t\t\tq.set( c2 * s13, s2 * c1_3, s2 * s1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YZY':\n\t\t\tq.set( s2 * s1_3, c2 * s13, s2 * c1_3, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZXZ':\n\t\t\tq.set( s2 * c1_3, s2 * s1_3, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'XZX':\n\t\t\tq.set( c2 * s13, s2 * s3_1, s2 * c3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'YXY':\n\t\t\tq.set( s2 * c3_1, c2 * s13, s2 * s3_1, c2 * c13 );\n\t\t\tbreak;\n\n\t\tcase 'ZYZ':\n\t\t\tq.set( s2 * s3_1, s2 * c3_1, c2 * s13, c2 * c13 );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconsole.warn( 'THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: ' + order );\n\n\t}\n\n}\n\nfunction denormalize( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint32Array:\n\n\t\t\treturn value / 4294967295.0;\n\n\t\tcase Uint16Array:\n\n\t\t\treturn value / 65535.0;\n\n\t\tcase Uint8Array:\n\n\t\t\treturn value / 255.0;\n\n\t\tcase Int32Array:\n\n\t\t\treturn Math.max( value / 2147483647.0, - 1.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.max( value / 32767.0, - 1.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.max( value / 127.0, - 1.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nfunction normalize$1( value, array ) {\n\n\tswitch ( array.constructor ) {\n\n\t\tcase Float32Array:\n\n\t\t\treturn value;\n\n\t\tcase Uint32Array:\n\n\t\t\treturn Math.round( value * 4294967295.0 );\n\n\t\tcase Uint16Array:\n\n\t\t\treturn Math.round( value * 65535.0 );\n\n\t\tcase Uint8Array:\n\n\t\t\treturn Math.round( value * 255.0 );\n\n\t\tcase Int32Array:\n\n\t\t\treturn Math.round( value * 2147483647.0 );\n\n\t\tcase Int16Array:\n\n\t\t\treturn Math.round( value * 32767.0 );\n\n\t\tcase Int8Array:\n\n\t\t\treturn Math.round( value * 127.0 );\n\n\t\tdefault:\n\n\t\t\tthrow new Error( 'Invalid component type.' );\n\n\t}\n\n}\n\nconst MathUtils = {\n\tDEG2RAD: DEG2RAD,\n\tRAD2DEG: RAD2DEG,\n\tgenerateUUID: generateUUID,\n\tclamp: clamp$1,\n\teuclideanModulo: euclideanModulo,\n\tmapLinear: mapLinear,\n\tinverseLerp: inverseLerp,\n\tlerp: lerp,\n\tdamp: damp,\n\tpingpong: pingpong,\n\tsmoothstep: smoothstep$1,\n\tsmootherstep: smootherstep,\n\trandInt: randInt,\n\trandFloat: randFloat,\n\trandFloatSpread: randFloatSpread,\n\tseededRandom: seededRandom,\n\tdegToRad: degToRad,\n\tradToDeg: radToDeg,\n\tisPowerOfTwo: isPowerOfTwo,\n\tceilPowerOfTwo: ceilPowerOfTwo,\n\tfloorPowerOfTwo: floorPowerOfTwo,\n\tsetQuaternionFromProperEuler: setQuaternionFromProperEuler,\n\tnormalize: normalize$1,\n\tdenormalize: denormalize\n};\n\nclass Vector2 {\n\n\tconstructor( x = 0, y = 0 ) {\n\n\t\tVector2.prototype.isVector2 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.x;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.x = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.y;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.y = value;\n\n\t}\n\n\tset( x, y ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ];\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = Math.trunc( this.x );\n\t\tthis.y = Math.trunc( this.y );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.x * v.y - this.y * v.x;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tangle() {\n\n\t\t// computes the angle in radians with respect to the positive x-axis\n\n\t\tconst angle = Math.atan2( - this.y, - this.x ) + Math.PI;\n\n\t\treturn angle;\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( clamp$1( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y;\n\t\treturn dx * dx + dy * dy;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\n\t\treturn this;\n\n\t}\n\n\trotateAround( center, angle ) {\n\n\t\tconst c = Math.cos( angle ), s = Math.sin( angle );\n\n\t\tconst x = this.x - center.x;\n\t\tconst y = this.y - center.y;\n\n\t\tthis.x = x * c - y * s + center.x;\n\t\tthis.y = x * s + y * c + center.y;\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\n\t}\n\n}\n\nclass Matrix3 {\n\n\tconstructor( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tMatrix3.prototype.isMatrix3 = true;\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t];\n\n\t\tif ( n11 !== undefined ) {\n\n\t\t\tthis.set( n11, n12, n13, n21, n22, n23, n31, n32, n33 );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n21, n22, n23, n31, n32, n33 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 1 ] = n21; te[ 2 ] = n31;\n\t\tte[ 3 ] = n12; te[ 4 ] = n22; te[ 5 ] = n32;\n\t\tte[ 6 ] = n13; te[ 7 ] = n23; te[ 8 ] = n33;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0,\n\t\t\t0, 1, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ];\n\t\tte[ 3 ] = me[ 3 ]; te[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ];\n\t\tte[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ]; te[ 8 ] = me[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrix3Column( this, 0 );\n\t\tyAxis.setFromMatrix3Column( this, 1 );\n\t\tzAxis.setFromMatrix3Column( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix4( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 4 ], me[ 8 ],\n\t\t\tme[ 1 ], me[ 5 ], me[ 9 ],\n\t\t\tme[ 2 ], me[ 6 ], me[ 10 ]\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 3 ], a13 = ae[ 6 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 4 ], a23 = ae[ 7 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 5 ], a33 = ae[ 8 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 3 ], b13 = be[ 6 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 4 ], b23 = be[ 7 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 5 ], b33 = be[ 8 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31;\n\t\tte[ 3 ] = a11 * b12 + a12 * b22 + a13 * b32;\n\t\tte[ 6 ] = a11 * b13 + a12 * b23 + a13 * b33;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31;\n\t\tte[ 4 ] = a21 * b12 + a22 * b22 + a23 * b32;\n\t\tte[ 7 ] = a21 * b13 + a22 * b23 + a23 * b33;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31;\n\t\tte[ 5 ] = a31 * b12 + a32 * b22 + a33 * b32;\n\t\tte[ 8 ] = a31 * b13 + a32 * b23 + a33 * b33;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 3 ] *= s; te[ 6 ] *= s;\n\t\tte[ 1 ] *= s; te[ 4 ] *= s; te[ 7 ] *= s;\n\t\tte[ 2 ] *= s; te[ 5 ] *= s; te[ 8 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst a = te[ 0 ], b = te[ 1 ], c = te[ 2 ],\n\t\t\td = te[ 3 ], e = te[ 4 ], f = te[ 5 ],\n\t\t\tg = te[ 6 ], h = te[ 7 ], i = te[ 8 ];\n\n\t\treturn a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;\n\n\t}\n\n\tinvert() {\n\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ],\n\t\t\tn12 = te[ 3 ], n22 = te[ 4 ], n32 = te[ 5 ],\n\t\t\tn13 = te[ 6 ], n23 = te[ 7 ], n33 = te[ 8 ],\n\n\t\t\tt11 = n33 * n22 - n32 * n23,\n\t\t\tt12 = n32 * n13 - n33 * n12,\n\t\t\tt13 = n23 * n12 - n22 * n13,\n\n\t\t\tdet = n11 * t11 + n21 * t12 + n31 * t13;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n31 * n23 - n33 * n21 ) * detInv;\n\t\tte[ 2 ] = ( n32 * n21 - n31 * n22 ) * detInv;\n\n\t\tte[ 3 ] = t12 * detInv;\n\t\tte[ 4 ] = ( n33 * n11 - n31 * n13 ) * detInv;\n\t\tte[ 5 ] = ( n31 * n12 - n32 * n11 ) * detInv;\n\n\t\tte[ 6 ] = t13 * detInv;\n\t\tte[ 7 ] = ( n21 * n13 - n23 * n11 ) * detInv;\n\t\tte[ 8 ] = ( n22 * n11 - n21 * n12 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\ttranspose() {\n\n\t\tlet tmp;\n\t\tconst m = this.elements;\n\n\t\ttmp = m[ 1 ]; m[ 1 ] = m[ 3 ]; m[ 3 ] = tmp;\n\t\ttmp = m[ 2 ]; m[ 2 ] = m[ 6 ]; m[ 6 ] = tmp;\n\t\ttmp = m[ 5 ]; m[ 5 ] = m[ 7 ]; m[ 7 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tgetNormalMatrix( matrix4 ) {\n\n\t\treturn this.setFromMatrix4( matrix4 ).invert().transpose();\n\n\t}\n\n\ttransposeIntoArray( r ) {\n\n\t\tconst m = this.elements;\n\n\t\tr[ 0 ] = m[ 0 ];\n\t\tr[ 1 ] = m[ 3 ];\n\t\tr[ 2 ] = m[ 6 ];\n\t\tr[ 3 ] = m[ 1 ];\n\t\tr[ 4 ] = m[ 4 ];\n\t\tr[ 5 ] = m[ 7 ];\n\t\tr[ 6 ] = m[ 2 ];\n\t\tr[ 7 ] = m[ 5 ];\n\t\tr[ 8 ] = m[ 8 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetUvTransform( tx, ty, sx, sy, rotation, cx, cy ) {\n\n\t\tconst c = Math.cos( rotation );\n\t\tconst s = Math.sin( rotation );\n\n\t\tthis.set(\n\t\t\tsx * c, sx * s, - sx * ( c * cx + s * cy ) + cx + tx,\n\t\t\t- sy * s, sy * c, - sy * ( - s * cx + c * cy ) + cy + ty,\n\t\t\t0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\t//\n\n\tscale( sx, sy ) {\n\n\t\tthis.premultiply( _m3.makeScale( sx, sy ) );\n\n\t\treturn this;\n\n\t}\n\n\trotate( theta ) {\n\n\t\tthis.premultiply( _m3.makeRotation( - theta ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( tx, ty ) {\n\n\t\tthis.premultiply( _m3.makeTranslation( tx, ty ) );\n\n\t\treturn this;\n\n\t}\n\n\t// for 2D Transforms\n\n\tmakeTranslation( x, y ) {\n\n\t\tif ( x.isVector2 ) {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, x.x,\n\t\t\t\t0, 1, x.y,\n\t\t\t\t0, 0, 1\n\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, x,\n\t\t\t\t0, 1, y,\n\t\t\t\t0, 0, 1\n\n\t\t\t);\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotation( theta ) {\n\n\t\t// counterclockwise\n\n\t\tconst c = Math.cos( theta );\n\t\tconst s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0,\n\t\t\ts, c, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0,\n\t\t\t0, y, 0,\n\t\t\t0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\t//\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\n\t\treturn array;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().fromArray( this.elements );\n\n\t}\n\n}\n\nconst _m3 = /*@__PURE__*/ new Matrix3();\n\nfunction arrayNeedsUint32$1( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] >= 65535 ) return true; // account for PRIMITIVE_RESTART_FIXED_INDEX, #24565\n\n\t}\n\n\treturn false;\n\n}\n\nconst TYPED_ARRAYS = {\n\tInt8Array: Int8Array,\n\tUint8Array: Uint8Array,\n\tUint8ClampedArray: Uint8ClampedArray,\n\tInt16Array: Int16Array,\n\tUint16Array: Uint16Array,\n\tInt32Array: Int32Array,\n\tUint32Array: Uint32Array,\n\tFloat32Array: Float32Array,\n\tFloat64Array: Float64Array\n};\n\nfunction getTypedArray( type, buffer ) {\n\n\treturn new TYPED_ARRAYS[ type ]( buffer );\n\n}\n\nfunction createElementNS( name ) {\n\n\treturn document.createElementNS( 'http://www.w3.org/1999/xhtml', name );\n\n}\n\nfunction createCanvasElement() {\n\n\tconst canvas = createElementNS( 'canvas' );\n\tcanvas.style.display = 'block';\n\treturn canvas;\n\n}\n\nconst _cache$2 = {};\n\nfunction warnOnce( message ) {\n\n\tif ( message in _cache$2 ) return;\n\n\t_cache$2[ message ] = true;\n\n\tconsole.warn( message );\n\n}\n\nconst ColorManagement = {\n\n\tenabled: true,\n\n\tworkingColorSpace: LinearSRGBColorSpace,\n\n\t/**\n\t * Implementations of supported color spaces.\n\t *\n\t * Required:\n\t *\t- primaries: chromaticity coordinates [ rx ry gx gy bx by ]\n\t *\t- whitePoint: reference white [ x y ]\n\t *\t- transfer: transfer function (pre-defined)\n\t *\t- toXYZ: Matrix3 RGB to XYZ transform\n\t *\t- fromXYZ: Matrix3 XYZ to RGB transform\n\t *\t- luminanceCoefficients: RGB luminance coefficients\n\t *\n\t * Optional:\n\t *  - outputColorSpaceConfig: { drawingBufferColorSpace: ColorSpace }\n\t *  - workingColorSpaceConfig: { unpackColorSpace: ColorSpace }\n\t *\n\t * Reference:\n\t * - https://www.russellcottrell.com/photo/matrixCalculator.htm\n\t */\n\tspaces: {},\n\n\tconvert: function ( color, sourceColorSpace, targetColorSpace ) {\n\n\t\tif ( this.enabled === false || sourceColorSpace === targetColorSpace || ! sourceColorSpace || ! targetColorSpace ) {\n\n\t\t\treturn color;\n\n\t\t}\n\n\t\tif ( this.spaces[ sourceColorSpace ].transfer === SRGBTransfer ) {\n\n\t\t\tcolor.r = SRGBToLinear( color.r );\n\t\t\tcolor.g = SRGBToLinear( color.g );\n\t\t\tcolor.b = SRGBToLinear( color.b );\n\n\t\t}\n\n\t\tif ( this.spaces[ sourceColorSpace ].primaries !== this.spaces[ targetColorSpace ].primaries ) {\n\n\t\t\tcolor.applyMatrix3( this.spaces[ sourceColorSpace ].toXYZ );\n\t\t\tcolor.applyMatrix3( this.spaces[ targetColorSpace ].fromXYZ );\n\n\t\t}\n\n\t\tif ( this.spaces[ targetColorSpace ].transfer === SRGBTransfer ) {\n\n\t\t\tcolor.r = LinearToSRGB( color.r );\n\t\t\tcolor.g = LinearToSRGB( color.g );\n\t\t\tcolor.b = LinearToSRGB( color.b );\n\n\t\t}\n\n\t\treturn color;\n\n\t},\n\n\tfromWorkingColorSpace: function ( color, targetColorSpace ) {\n\n\t\treturn this.convert( color, this.workingColorSpace, targetColorSpace );\n\n\t},\n\n\ttoWorkingColorSpace: function ( color, sourceColorSpace ) {\n\n\t\treturn this.convert( color, sourceColorSpace, this.workingColorSpace );\n\n\t},\n\n\tgetPrimaries: function ( colorSpace ) {\n\n\t\treturn this.spaces[ colorSpace ].primaries;\n\n\t},\n\n\tgetTransfer: function ( colorSpace ) {\n\n\t\tif ( colorSpace === NoColorSpace ) return LinearTransfer;\n\n\t\treturn this.spaces[ colorSpace ].transfer;\n\n\t},\n\n\tgetLuminanceCoefficients: function ( target, colorSpace = this.workingColorSpace ) {\n\n\t\treturn target.fromArray( this.spaces[ colorSpace ].luminanceCoefficients );\n\n\t},\n\n\tdefine: function ( colorSpaces ) {\n\n\t\tObject.assign( this.spaces, colorSpaces );\n\n\t},\n\n\t// Internal APIs\n\n\t_getMatrix: function ( targetMatrix, sourceColorSpace, targetColorSpace ) {\n\n\t\treturn targetMatrix\n\t\t\t.copy( this.spaces[ sourceColorSpace ].toXYZ )\n\t\t\t.multiply( this.spaces[ targetColorSpace ].fromXYZ );\n\n\t},\n\n\t_getDrawingBufferColorSpace: function ( colorSpace ) {\n\n\t\treturn this.spaces[ colorSpace ].outputColorSpaceConfig.drawingBufferColorSpace;\n\n\t},\n\n\t_getUnpackColorSpace: function ( colorSpace = this.workingColorSpace ) {\n\n\t\treturn this.spaces[ colorSpace ].workingColorSpaceConfig.unpackColorSpace;\n\n\t}\n\n};\n\nfunction SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nfunction LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n\n/******************************************************************************\n * sRGB definitions\n */\n\nconst REC709_PRIMARIES = [ 0.640, 0.330, 0.300, 0.600, 0.150, 0.060 ];\nconst REC709_LUMINANCE_COEFFICIENTS = [ 0.2126, 0.7152, 0.0722 ];\nconst D65 = [ 0.3127, 0.3290 ];\n\nconst LINEAR_REC709_TO_XYZ = /*@__PURE__*/ new Matrix3().set(\n\t0.4123908, 0.3575843, 0.1804808,\n\t0.2126390, 0.7151687, 0.0721923,\n\t0.0193308, 0.1191948, 0.9505322\n);\n\nconst XYZ_TO_LINEAR_REC709 = /*@__PURE__*/ new Matrix3().set(\n\t3.2409699, - 1.5373832, - 0.4986108,\n\t- 0.9692436, 1.8759675, 0.0415551,\n\t0.0556301, - 0.2039770, 1.0569715\n);\n\nColorManagement.define( {\n\n\t[ LinearSRGBColorSpace ]: {\n\t\tprimaries: REC709_PRIMARIES,\n\t\twhitePoint: D65,\n\t\ttransfer: LinearTransfer,\n\t\ttoXYZ: LINEAR_REC709_TO_XYZ,\n\t\tfromXYZ: XYZ_TO_LINEAR_REC709,\n\t\tluminanceCoefficients: REC709_LUMINANCE_COEFFICIENTS,\n\t\tworkingColorSpaceConfig: { unpackColorSpace: SRGBColorSpace },\n\t\toutputColorSpaceConfig: { drawingBufferColorSpace: SRGBColorSpace }\n\t},\n\n\t[ SRGBColorSpace ]: {\n\t\tprimaries: REC709_PRIMARIES,\n\t\twhitePoint: D65,\n\t\ttransfer: SRGBTransfer,\n\t\ttoXYZ: LINEAR_REC709_TO_XYZ,\n\t\tfromXYZ: XYZ_TO_LINEAR_REC709,\n\t\tluminanceCoefficients: REC709_LUMINANCE_COEFFICIENTS,\n\t\toutputColorSpaceConfig: { drawingBufferColorSpace: SRGBColorSpace }\n\t},\n\n} );\n\nlet _canvas;\n\nclass ImageUtils {\n\n\tstatic getDataURL( image ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement === 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\tif ( canvas.width > 2048 || canvas.height > 2048 ) {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons', image );\n\n\t\t\treturn canvas.toDataURL( 'image/jpeg', 0.6 );\n\n\t\t} else {\n\n\t\t\treturn canvas.toDataURL( 'image/png' );\n\n\t\t}\n\n\t}\n\n\tstatic sRGBToLinear( image ) {\n\n\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\tconst canvas = createElementNS( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\tconst imageData = context.getImageData( 0, 0, image.width, image.height );\n\t\t\tconst data = imageData.data;\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] / 255 ) * 255;\n\n\t\t\t}\n\n\t\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\t\treturn canvas;\n\n\t\t} else if ( image.data ) {\n\n\t\t\tconst data = image.data.slice( 0 );\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tif ( data instanceof Uint8Array || data instanceof Uint8ClampedArray ) {\n\n\t\t\t\t\tdata[ i ] = Math.floor( SRGBToLinear( data[ i ] / 255 ) * 255 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assuming float\n\n\t\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.' );\n\t\t\treturn image;\n\n\t\t}\n\n\t}\n\n}\n\nlet _sourceId = 0;\n\nclass Source {\n\n\tconstructor( data = null ) {\n\n\t\tthis.isSource = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _sourceId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.data = data;\n\t\tthis.dataReady = true;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.images[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.images[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\t\t\tuuid: this.uuid,\n\t\t\turl: ''\n\t\t};\n\n\t\tconst data = this.data;\n\n\t\tif ( data !== null ) {\n\n\t\t\tlet url;\n\n\t\t\tif ( Array.isArray( data ) ) {\n\n\t\t\t\t// cube texture\n\n\t\t\t\turl = [];\n\n\t\t\t\tfor ( let i = 0, l = data.length; i < l; i ++ ) {\n\n\t\t\t\t\tif ( data[ i ].isDataTexture ) {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ].image ) );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\turl.push( serializeImage( data[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// texture\n\n\t\t\t\turl = serializeImage( data );\n\n\t\t\t}\n\n\t\t\toutput.url = url;\n\n\t\t}\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.images[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nfunction serializeImage( image ) {\n\n\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t// default images\n\n\t\treturn ImageUtils.getDataURL( image );\n\n\t} else {\n\n\t\tif ( image.data ) {\n\n\t\t\t// images of DataTexture\n\n\t\t\treturn {\n\t\t\t\tdata: Array.from( image.data ),\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\ttype: image.data.constructor.name\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Texture: Unable to serialize Texture.' );\n\t\t\treturn {};\n\n\t\t}\n\n\t}\n\n}\n\nlet _textureId = 0;\n\nclass Texture extends EventDispatcher {\n\n\tconstructor( image = Texture.DEFAULT_IMAGE, mapping = Texture.DEFAULT_MAPPING, wrapS = ClampToEdgeWrapping, wrapT = ClampToEdgeWrapping, magFilter = LinearFilter, minFilter = LinearMipmapLinearFilter, format = RGBAFormat, type = UnsignedByteType, anisotropy = Texture.DEFAULT_ANISOTROPY, colorSpace = NoColorSpace ) {\n\n\t\tsuper();\n\n\t\tthis.isTexture = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _textureId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.source = new Source( image );\n\t\tthis.mipmaps = [];\n\n\t\tthis.mapping = mapping;\n\t\tthis.channel = 0;\n\n\t\tthis.wrapS = wrapS;\n\t\tthis.wrapT = wrapT;\n\n\t\tthis.magFilter = magFilter;\n\t\tthis.minFilter = minFilter;\n\n\t\tthis.anisotropy = anisotropy;\n\n\t\tthis.format = format;\n\t\tthis.internalFormat = null;\n\t\tthis.type = type;\n\n\t\tthis.offset = new Vector2( 0, 0 );\n\t\tthis.repeat = new Vector2( 1, 1 );\n\t\tthis.center = new Vector2( 0, 0 );\n\t\tthis.rotation = 0;\n\n\t\tthis.matrixAutoUpdate = true;\n\t\tthis.matrix = new Matrix3();\n\n\t\tthis.generateMipmaps = true;\n\t\tthis.premultiplyAlpha = false;\n\t\tthis.flipY = true;\n\t\tthis.unpackAlignment = 4;\t// valid values: 1, 2, 4, 8 (see http://www.khronos.org/opengles/sdk/docs/man/xhtml/glPixelStorei.xml)\n\n\t\tthis.colorSpace = colorSpace;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\t\tthis.onUpdate = null;\n\n\t\tthis.isRenderTargetTexture = false; // indicates whether a texture belongs to a render target or not\n\t\tthis.pmremVersion = 0; // indicates whether this texture should be processed by PMREMGenerator or not (only relevant for render target textures)\n\n\t}\n\n\tget image() {\n\n\t\treturn this.source.data;\n\n\t}\n\n\tset image( value = null ) {\n\n\t\tthis.source.data = value;\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.setUvTransform( this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.source = source.source;\n\t\tthis.mipmaps = source.mipmaps.slice( 0 );\n\n\t\tthis.mapping = source.mapping;\n\t\tthis.channel = source.channel;\n\n\t\tthis.wrapS = source.wrapS;\n\t\tthis.wrapT = source.wrapT;\n\n\t\tthis.magFilter = source.magFilter;\n\t\tthis.minFilter = source.minFilter;\n\n\t\tthis.anisotropy = source.anisotropy;\n\n\t\tthis.format = source.format;\n\t\tthis.internalFormat = source.internalFormat;\n\t\tthis.type = source.type;\n\n\t\tthis.offset.copy( source.offset );\n\t\tthis.repeat.copy( source.repeat );\n\t\tthis.center.copy( source.center );\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\t\tthis.matrix.copy( source.matrix );\n\n\t\tthis.generateMipmaps = source.generateMipmaps;\n\t\tthis.premultiplyAlpha = source.premultiplyAlpha;\n\t\tthis.flipY = source.flipY;\n\t\tthis.unpackAlignment = source.unpackAlignment;\n\t\tthis.colorSpace = source.colorSpace;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( ! isRootObject && meta.textures[ this.uuid ] !== undefined ) {\n\n\t\t\treturn meta.textures[ this.uuid ];\n\n\t\t}\n\n\t\tconst output = {\n\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Texture',\n\t\t\t\tgenerator: 'Texture.toJSON'\n\t\t\t},\n\n\t\t\tuuid: this.uuid,\n\t\t\tname: this.name,\n\n\t\t\timage: this.source.toJSON( meta ).uuid,\n\n\t\t\tmapping: this.mapping,\n\t\t\tchannel: this.channel,\n\n\t\t\trepeat: [ this.repeat.x, this.repeat.y ],\n\t\t\toffset: [ this.offset.x, this.offset.y ],\n\t\t\tcenter: [ this.center.x, this.center.y ],\n\t\t\trotation: this.rotation,\n\n\t\t\twrap: [ this.wrapS, this.wrapT ],\n\n\t\t\tformat: this.format,\n\t\t\tinternalFormat: this.internalFormat,\n\t\t\ttype: this.type,\n\t\t\tcolorSpace: this.colorSpace,\n\n\t\t\tminFilter: this.minFilter,\n\t\t\tmagFilter: this.magFilter,\n\t\t\tanisotropy: this.anisotropy,\n\n\t\t\tflipY: this.flipY,\n\n\t\t\tgenerateMipmaps: this.generateMipmaps,\n\t\t\tpremultiplyAlpha: this.premultiplyAlpha,\n\t\t\tunpackAlignment: this.unpackAlignment\n\n\t\t};\n\n\t\tif ( Object.keys( this.userData ).length > 0 ) output.userData = this.userData;\n\n\t\tif ( ! isRootObject ) {\n\n\t\t\tmeta.textures[ this.uuid ] = output;\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttransformUv( uv ) {\n\n\t\tif ( this.mapping !== UVMapping ) return uv;\n\n\t\tuv.applyMatrix3( this.matrix );\n\n\t\tif ( uv.x < 0 || uv.x > 1 ) {\n\n\t\t\tswitch ( this.wrapS ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.x = uv.x < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.x ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.x = Math.ceil( uv.x ) - uv.x;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.x = uv.x - Math.floor( uv.x );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( uv.y < 0 || uv.y > 1 ) {\n\n\t\t\tswitch ( this.wrapT ) {\n\n\t\t\t\tcase RepeatWrapping:\n\n\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ClampToEdgeWrapping:\n\n\t\t\t\t\tuv.y = uv.y < 0 ? 0 : 1;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MirroredRepeatWrapping:\n\n\t\t\t\t\tif ( Math.abs( Math.floor( uv.y ) % 2 ) === 1 ) {\n\n\t\t\t\t\t\tuv.y = Math.ceil( uv.y ) - uv.y;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tuv.y = uv.y - Math.floor( uv.y );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.flipY ) {\n\n\t\t\tuv.y = 1 - uv.y;\n\n\t\t}\n\n\t\treturn uv;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\t\t\tthis.source.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tset needsPMREMUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.pmremVersion ++;\n\n\t\t}\n\n\t}\n\n}\n\nTexture.DEFAULT_IMAGE = null;\nTexture.DEFAULT_MAPPING = UVMapping;\nTexture.DEFAULT_ANISOTROPY = 1;\n\nclass Vector4 {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tVector4.prototype.isVector4 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t}\n\n\tget width() {\n\n\t\treturn this.z;\n\n\t}\n\n\tset width( value ) {\n\n\t\tthis.z = value;\n\n\t}\n\n\tget height() {\n\n\t\treturn this.w;\n\n\t}\n\n\tset height( value ) {\n\n\t\tthis.w = value;\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\t\tthis.w = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( w ) {\n\n\t\tthis.w = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tcase 3: this.w = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tcase 3: return this.w;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z, this.w );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\t\tthis.w = ( v.w !== undefined ) ? v.w : 1;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\t\tthis.w += v.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\t\tthis.w += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\t\tthis.w = a.w + b.w;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\t\tthis.w += v.w * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\t\tthis.w -= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\t\tthis.w -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\t\tthis.w = a.w - b.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\t\tthis.w *= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\t\tthis.w *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z, w = this.w;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] * w;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] * w;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] * w;\n\t\tthis.w = e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] * w;\n\n\t\treturn this;\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\t\tthis.w /= v.w;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tsetAxisAngleFromQuaternion( q ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/quaternionToAngle/index.htm\n\n\t\t// q is assumed to be normalized\n\n\t\tthis.w = 2 * Math.acos( q.w );\n\n\t\tconst s = Math.sqrt( 1 - q.w * q.w );\n\n\t\tif ( s < 0.0001 ) {\n\n\t\t\tthis.x = 1;\n\t\t\tthis.y = 0;\n\t\t\tthis.z = 0;\n\n\t\t} else {\n\n\t\t\tthis.x = q.x / s;\n\t\t\tthis.y = q.y / s;\n\t\t\tthis.z = q.z / s;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetAxisAngleFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToAngle/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tlet angle, x, y, z; // variables for result\n\t\tconst epsilon = 0.01,\t\t// margin to allow for rounding errors\n\t\t\tepsilon2 = 0.1,\t\t// margin to distinguish between 0 and 180 degrees\n\n\t\t\tte = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tif ( ( Math.abs( m12 - m21 ) < epsilon ) &&\n\t\t     ( Math.abs( m13 - m31 ) < epsilon ) &&\n\t\t     ( Math.abs( m23 - m32 ) < epsilon ) ) {\n\n\t\t\t// singularity found\n\t\t\t// first check for identity matrix which must have +1 for all terms\n\t\t\t// in leading diagonal and zero in other terms\n\n\t\t\tif ( ( Math.abs( m12 + m21 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m13 + m31 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m23 + m32 ) < epsilon2 ) &&\n\t\t\t     ( Math.abs( m11 + m22 + m33 - 3 ) < epsilon2 ) ) {\n\n\t\t\t\t// this singularity is identity matrix so angle = 0\n\n\t\t\t\tthis.set( 1, 0, 0, 0 );\n\n\t\t\t\treturn this; // zero angle, arbitrary axis\n\n\t\t\t}\n\n\t\t\t// otherwise this singularity is angle = 180\n\n\t\t\tangle = Math.PI;\n\n\t\t\tconst xx = ( m11 + 1 ) / 2;\n\t\t\tconst yy = ( m22 + 1 ) / 2;\n\t\t\tconst zz = ( m33 + 1 ) / 2;\n\t\t\tconst xy = ( m12 + m21 ) / 4;\n\t\t\tconst xz = ( m13 + m31 ) / 4;\n\t\t\tconst yz = ( m23 + m32 ) / 4;\n\n\t\t\tif ( ( xx > yy ) && ( xx > zz ) ) {\n\n\t\t\t\t// m11 is the largest diagonal term\n\n\t\t\t\tif ( xx < epsilon ) {\n\n\t\t\t\t\tx = 0;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tx = Math.sqrt( xx );\n\t\t\t\t\ty = xy / x;\n\t\t\t\t\tz = xz / x;\n\n\t\t\t\t}\n\n\t\t\t} else if ( yy > zz ) {\n\n\t\t\t\t// m22 is the largest diagonal term\n\n\t\t\t\tif ( yy < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0;\n\t\t\t\t\tz = 0.707106781;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ty = Math.sqrt( yy );\n\t\t\t\t\tx = xy / y;\n\t\t\t\t\tz = yz / y;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// m33 is the largest diagonal term so base result on this\n\n\t\t\t\tif ( zz < epsilon ) {\n\n\t\t\t\t\tx = 0.707106781;\n\t\t\t\t\ty = 0.707106781;\n\t\t\t\t\tz = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tz = Math.sqrt( zz );\n\t\t\t\t\tx = xz / z;\n\t\t\t\t\ty = yz / z;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.set( x, y, z, angle );\n\n\t\t\treturn this; // return 180 deg rotation\n\n\t\t}\n\n\t\t// as we have reached here there are no singularities so we can handle normally\n\n\t\tlet s = Math.sqrt( ( m32 - m23 ) * ( m32 - m23 ) +\n\t\t\t( m13 - m31 ) * ( m13 - m31 ) +\n\t\t\t( m21 - m12 ) * ( m21 - m12 ) ); // used to normalize\n\n\t\tif ( Math.abs( s ) < 0.001 ) s = 1;\n\n\t\t// prevent divide by zero, should not happen if matrix is orthogonal and should be\n\t\t// caught by singularity test above, but I've left it in just in case\n\n\t\tthis.x = ( m32 - m23 ) / s;\n\t\tthis.y = ( m13 - m31 ) / s;\n\t\tthis.z = ( m21 - m12 ) / s;\n\t\tthis.w = Math.acos( ( m11 + m22 + m33 - 1 ) / 2 );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\t\tthis.w = e[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\t\tthis.w = Math.min( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\t\tthis.w = Math.max( this.w, v.w );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\t\tthis.w = Math.max( min.w, Math.min( max.w, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\t\tthis.w = Math.max( minVal, Math.min( maxVal, this.w ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\t\tthis.w = Math.floor( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\t\tthis.w = Math.ceil( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\t\tthis.w = Math.round( this.w );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = Math.trunc( this.x );\n\t\tthis.y = Math.trunc( this.y );\n\t\tthis.z = Math.trunc( this.z );\n\t\tthis.w = Math.trunc( this.w );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\t\tthis.w = - this.w;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z + this.w * v.w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z ) + Math.abs( this.w );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\t\tthis.w += ( v.w - this.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\t\tthis.w = v1.w + ( v2.w - v1.w ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) && ( v.w === this.w ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\t\tthis.w = array[ offset + 3 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\t\tarray[ offset + 3 ] = this.w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\t\tthis.w = attribute.getW( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\t\tthis.w = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\t\tyield this.w;\n\n\t}\n\n}\n\n/*\n In options, we can specify:\n * Texture parameters for an auto-generated target texture\n * depthBuffer/stencilBuffer: Booleans to indicate if we should generate these buffers\n*/\nclass RenderTarget extends EventDispatcher {\n\n\tconstructor( width = 1, height = 1, options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.isRenderTarget = true;\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = 1;\n\n\t\tthis.scissor = new Vector4( 0, 0, width, height );\n\t\tthis.scissorTest = false;\n\n\t\tthis.viewport = new Vector4( 0, 0, width, height );\n\n\t\tconst image = { width: width, height: height, depth: 1 };\n\n\t\toptions = Object.assign( {\n\t\t\tgenerateMipmaps: false,\n\t\t\tinternalFormat: null,\n\t\t\tminFilter: LinearFilter,\n\t\t\tdepthBuffer: true,\n\t\t\tstencilBuffer: false,\n\t\t\tresolveDepthBuffer: true,\n\t\t\tresolveStencilBuffer: true,\n\t\t\tdepthTexture: null,\n\t\t\tsamples: 0,\n\t\t\tcount: 1\n\t\t}, options );\n\n\t\tconst texture = new Texture( image, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.colorSpace );\n\n\t\ttexture.flipY = false;\n\t\ttexture.generateMipmaps = options.generateMipmaps;\n\t\ttexture.internalFormat = options.internalFormat;\n\n\t\tthis.textures = [];\n\n\t\tconst count = options.count;\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.textures[ i ] = texture.clone();\n\t\t\tthis.textures[ i ].isRenderTargetTexture = true;\n\n\t\t}\n\n\t\tthis.depthBuffer = options.depthBuffer;\n\t\tthis.stencilBuffer = options.stencilBuffer;\n\n\t\tthis.resolveDepthBuffer = options.resolveDepthBuffer;\n\t\tthis.resolveStencilBuffer = options.resolveStencilBuffer;\n\n\t\tthis.depthTexture = options.depthTexture;\n\n\t\tthis.samples = options.samples;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this.textures[ 0 ];\n\n\t}\n\n\tset texture( value ) {\n\n\t\tthis.textures[ 0 ] = value;\n\n\t}\n\n\tsetSize( width, height, depth = 1 ) {\n\n\t\tif ( this.width !== width || this.height !== height || this.depth !== depth ) {\n\n\t\t\tthis.width = width;\n\t\t\tthis.height = height;\n\t\t\tthis.depth = depth;\n\n\t\t\tfor ( let i = 0, il = this.textures.length; i < il; i ++ ) {\n\n\t\t\t\tthis.textures[ i ].image.width = width;\n\t\t\t\tthis.textures[ i ].image.height = height;\n\t\t\t\tthis.textures[ i ].image.depth = depth;\n\n\t\t\t}\n\n\t\t\tthis.dispose();\n\n\t\t}\n\n\t\tthis.viewport.set( 0, 0, width, height );\n\t\tthis.scissor.set( 0, 0, width, height );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\t\tthis.depth = source.depth;\n\n\t\tthis.scissor.copy( source.scissor );\n\t\tthis.scissorTest = source.scissorTest;\n\n\t\tthis.viewport.copy( source.viewport );\n\n\t\tthis.textures.length = 0;\n\n\t\tfor ( let i = 0, il = source.textures.length; i < il; i ++ ) {\n\n\t\t\tthis.textures[ i ] = source.textures[ i ].clone();\n\t\t\tthis.textures[ i ].isRenderTargetTexture = true;\n\n\t\t}\n\n\t\t// ensure image object is not shared, see #20328\n\n\t\tconst image = Object.assign( {}, source.texture.image );\n\t\tthis.texture.source = new Source( image );\n\n\t\tthis.depthBuffer = source.depthBuffer;\n\t\tthis.stencilBuffer = source.stencilBuffer;\n\n\t\tthis.resolveDepthBuffer = source.resolveDepthBuffer;\n\t\tthis.resolveStencilBuffer = source.resolveStencilBuffer;\n\n\t\tif ( source.depthTexture !== null ) this.depthTexture = source.depthTexture.clone();\n\n\t\tthis.samples = source.samples;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nclass WebGLRenderTarget extends RenderTarget {\n\n\tconstructor( width = 1, height = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGLRenderTarget = true;\n\n\t}\n\n}\n\nclass DataArrayTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\tsuper( null );\n\n\t\tthis.isDataArrayTexture = true;\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t\tthis.layerUpdates = new Set();\n\n\t}\n\n\taddLayerUpdate( layerIndex ) {\n\n\t\tthis.layerUpdates.add( layerIndex );\n\n\t}\n\n\tclearLayerUpdates() {\n\n\t\tthis.layerUpdates.clear();\n\n\t}\n\n}\n\nclass WebGLArrayRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, depth = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGLArrayRenderTarget = true;\n\n\t\tthis.depth = depth;\n\n\t\tthis.texture = new DataArrayTexture( null, width, height, depth );\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t}\n\n}\n\nclass Data3DTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, depth = 1 ) {\n\n\t\t// We're going to add .setXXX() methods for setting properties later.\n\t\t// Users can still set in DataTexture3D directly.\n\t\t//\n\t\t//\tconst texture = new THREE.DataTexture3D( data, width, height, depth );\n\t\t// \ttexture.anisotropy = 16;\n\t\t//\n\t\t// See #14839\n\n\t\tsuper( null );\n\n\t\tthis.isData3DTexture = true;\n\n\t\tthis.image = { data, width, height, depth };\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nclass WebGL3DRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( width = 1, height = 1, depth = 1, options = {} ) {\n\n\t\tsuper( width, height, options );\n\n\t\tthis.isWebGL3DRenderTarget = true;\n\n\t\tthis.depth = depth;\n\n\t\tthis.texture = new Data3DTexture( null, width, height, depth );\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t}\n\n}\n\nclass Quaternion {\n\n\tconstructor( x = 0, y = 0, z = 0, w = 1 ) {\n\n\t\tthis.isQuaternion = true;\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t}\n\n\tstatic slerpFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1, t ) {\n\n\t\t// fuzz-free, array-based Quaternion SLERP operation\n\n\t\tlet x0 = src0[ srcOffset0 + 0 ],\n\t\t\ty0 = src0[ srcOffset0 + 1 ],\n\t\t\tz0 = src0[ srcOffset0 + 2 ],\n\t\t\tw0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 + 0 ],\n\t\t\ty1 = src1[ srcOffset1 + 1 ],\n\t\t\tz1 = src1[ srcOffset1 + 2 ],\n\t\t\tw1 = src1[ srcOffset1 + 3 ];\n\n\t\tif ( t === 0 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x0;\n\t\t\tdst[ dstOffset + 1 ] = y0;\n\t\t\tdst[ dstOffset + 2 ] = z0;\n\t\t\tdst[ dstOffset + 3 ] = w0;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( t === 1 ) {\n\n\t\t\tdst[ dstOffset + 0 ] = x1;\n\t\t\tdst[ dstOffset + 1 ] = y1;\n\t\t\tdst[ dstOffset + 2 ] = z1;\n\t\t\tdst[ dstOffset + 3 ] = w1;\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( w0 !== w1 || x0 !== x1 || y0 !== y1 || z0 !== z1 ) {\n\n\t\t\tlet s = 1 - t;\n\t\t\tconst cos = x0 * x1 + y0 * y1 + z0 * z1 + w0 * w1,\n\t\t\t\tdir = ( cos >= 0 ? 1 : - 1 ),\n\t\t\t\tsqrSin = 1 - cos * cos;\n\n\t\t\t// Skip the Slerp for tiny steps to avoid numeric problems:\n\t\t\tif ( sqrSin > Number.EPSILON ) {\n\n\t\t\t\tconst sin = Math.sqrt( sqrSin ),\n\t\t\t\t\tlen = Math.atan2( sin, cos * dir );\n\n\t\t\t\ts = Math.sin( s * len ) / sin;\n\t\t\t\tt = Math.sin( t * len ) / sin;\n\n\t\t\t}\n\n\t\t\tconst tDir = t * dir;\n\n\t\t\tx0 = x0 * s + x1 * tDir;\n\t\t\ty0 = y0 * s + y1 * tDir;\n\t\t\tz0 = z0 * s + z1 * tDir;\n\t\t\tw0 = w0 * s + w1 * tDir;\n\n\t\t\t// Normalize in case we just did a lerp:\n\t\t\tif ( s === 1 - t ) {\n\n\t\t\t\tconst f = 1 / Math.sqrt( x0 * x0 + y0 * y0 + z0 * z0 + w0 * w0 );\n\n\t\t\t\tx0 *= f;\n\t\t\t\ty0 *= f;\n\t\t\t\tz0 *= f;\n\t\t\t\tw0 *= f;\n\n\t\t\t}\n\n\t\t}\n\n\t\tdst[ dstOffset ] = x0;\n\t\tdst[ dstOffset + 1 ] = y0;\n\t\tdst[ dstOffset + 2 ] = z0;\n\t\tdst[ dstOffset + 3 ] = w0;\n\n\t}\n\n\tstatic multiplyQuaternionsFlat( dst, dstOffset, src0, srcOffset0, src1, srcOffset1 ) {\n\n\t\tconst x0 = src0[ srcOffset0 ];\n\t\tconst y0 = src0[ srcOffset0 + 1 ];\n\t\tconst z0 = src0[ srcOffset0 + 2 ];\n\t\tconst w0 = src0[ srcOffset0 + 3 ];\n\n\t\tconst x1 = src1[ srcOffset1 ];\n\t\tconst y1 = src1[ srcOffset1 + 1 ];\n\t\tconst z1 = src1[ srcOffset1 + 2 ];\n\t\tconst w1 = src1[ srcOffset1 + 3 ];\n\n\t\tdst[ dstOffset ] = x0 * w1 + w0 * x1 + y0 * z1 - z0 * y1;\n\t\tdst[ dstOffset + 1 ] = y0 * w1 + w0 * y1 + z0 * x1 - x0 * z1;\n\t\tdst[ dstOffset + 2 ] = z0 * w1 + w0 * z1 + x0 * y1 - y0 * x1;\n\t\tdst[ dstOffset + 3 ] = w0 * w1 - x0 * x1 - y0 * y1 - z0 * z1;\n\n\t\treturn dst;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget w() {\n\n\t\treturn this._w;\n\n\t}\n\n\tset w( value ) {\n\n\t\tthis._w = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, w ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._w = w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._w );\n\n\t}\n\n\tcopy( quaternion ) {\n\n\t\tthis._x = quaternion.x;\n\t\tthis._y = quaternion.y;\n\t\tthis._z = quaternion.z;\n\t\tthis._w = quaternion.w;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromEuler( euler, update = true ) {\n\n\t\tconst x = euler._x, y = euler._y, z = euler._z, order = euler._order;\n\n\t\t// http://www.mathworks.com/matlabcentral/fileexchange/\n\t\t// \t20696-function-to-convert-between-dcm-euler-angles-quaternions-and-euler-vectors/\n\t\t//\tcontent/SpinCalc.m\n\n\t\tconst cos = Math.cos;\n\t\tconst sin = Math.sin;\n\n\t\tconst c1 = cos( x / 2 );\n\t\tconst c2 = cos( y / 2 );\n\t\tconst c3 = cos( z / 2 );\n\n\t\tconst s1 = sin( x / 2 );\n\t\tconst s2 = sin( y / 2 );\n\t\tconst s3 = sin( z / 2 );\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\t\t\t\tthis._x = s1 * c2 * c3 + c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 + s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 - s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 - s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\t\t\t\tthis._x = s1 * c2 * c3 - c1 * s2 * s3;\n\t\t\t\tthis._y = c1 * s2 * c3 - s1 * c2 * s3;\n\t\t\t\tthis._z = c1 * c2 * s3 + s1 * s2 * c3;\n\t\t\t\tthis._w = c1 * c2 * c3 + s1 * s2 * s3;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.Quaternion: .setFromEuler() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAxisAngle( axis, angle ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/angleToQuaternion/index.htm\n\n\t\t// assumes axis is normalized\n\n\t\tconst halfAngle = angle / 2, s = Math.sin( halfAngle );\n\n\t\tthis._x = axis.x * s;\n\t\tthis._y = axis.y * s;\n\t\tthis._z = axis.z * s;\n\t\tthis._w = Math.cos( halfAngle );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m ) {\n\n\t\t// http://www.euclideanspace.com/maths/geometry/rotations/conversions/matrixToQuaternion/index.htm\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements,\n\n\t\t\tm11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ],\n\t\t\tm21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ],\n\t\t\tm31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ],\n\n\t\t\ttrace = m11 + m22 + m33;\n\n\t\tif ( trace > 0 ) {\n\n\t\t\tconst s = 0.5 / Math.sqrt( trace + 1.0 );\n\n\t\t\tthis._w = 0.25 / s;\n\t\t\tthis._x = ( m32 - m23 ) * s;\n\t\t\tthis._y = ( m13 - m31 ) * s;\n\t\t\tthis._z = ( m21 - m12 ) * s;\n\n\t\t} else if ( m11 > m22 && m11 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m11 - m22 - m33 );\n\n\t\t\tthis._w = ( m32 - m23 ) / s;\n\t\t\tthis._x = 0.25 * s;\n\t\t\tthis._y = ( m12 + m21 ) / s;\n\t\t\tthis._z = ( m13 + m31 ) / s;\n\n\t\t} else if ( m22 > m33 ) {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m22 - m11 - m33 );\n\n\t\t\tthis._w = ( m13 - m31 ) / s;\n\t\t\tthis._x = ( m12 + m21 ) / s;\n\t\t\tthis._y = 0.25 * s;\n\t\t\tthis._z = ( m23 + m32 ) / s;\n\n\t\t} else {\n\n\t\t\tconst s = 2.0 * Math.sqrt( 1.0 + m33 - m11 - m22 );\n\n\t\t\tthis._w = ( m21 - m12 ) / s;\n\t\t\tthis._x = ( m13 + m31 ) / s;\n\t\t\tthis._y = ( m23 + m32 ) / s;\n\t\t\tthis._z = 0.25 * s;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromUnitVectors( vFrom, vTo ) {\n\n\t\t// assumes direction vectors vFrom and vTo are normalized\n\n\t\tlet r = vFrom.dot( vTo ) + 1;\n\n\t\tif ( r < Number.EPSILON ) {\n\n\t\t\t// vFrom and vTo point in opposite directions\n\n\t\t\tr = 0;\n\n\t\t\tif ( Math.abs( vFrom.x ) > Math.abs( vFrom.z ) ) {\n\n\t\t\t\tthis._x = - vFrom.y;\n\t\t\t\tthis._y = vFrom.x;\n\t\t\t\tthis._z = 0;\n\t\t\t\tthis._w = r;\n\n\t\t\t} else {\n\n\t\t\t\tthis._x = 0;\n\t\t\t\tthis._y = - vFrom.z;\n\t\t\t\tthis._z = vFrom.y;\n\t\t\t\tthis._w = r;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// crossVectors( vFrom, vTo ); // inlined to avoid cyclic dependency on Vector3\n\n\t\t\tthis._x = vFrom.y * vTo.z - vFrom.z * vTo.y;\n\t\t\tthis._y = vFrom.z * vTo.x - vFrom.x * vTo.z;\n\t\t\tthis._z = vFrom.x * vTo.y - vFrom.y * vTo.x;\n\t\t\tthis._w = r;\n\n\t\t}\n\n\t\treturn this.normalize();\n\n\t}\n\n\tangleTo( q ) {\n\n\t\treturn 2 * Math.acos( Math.abs( clamp$1( this.dot( q ), - 1, 1 ) ) );\n\n\t}\n\n\trotateTowards( q, step ) {\n\n\t\tconst angle = this.angleTo( q );\n\n\t\tif ( angle === 0 ) return this;\n\n\t\tconst t = Math.min( 1, step / angle );\n\n\t\tthis.slerp( q, t );\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\treturn this.set( 0, 0, 0, 1 );\n\n\t}\n\n\tinvert() {\n\n\t\t// quaternion is assumed to have unit length\n\n\t\treturn this.conjugate();\n\n\t}\n\n\tconjugate() {\n\n\t\tthis._x *= - 1;\n\t\tthis._y *= - 1;\n\t\tthis._z *= - 1;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this._x * v._x + this._y * v._y + this._z * v._z + this._w * v._w;\n\n\t}\n\n\tlengthSq() {\n\n\t\treturn this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w );\n\n\t}\n\n\tnormalize() {\n\n\t\tlet l = this.length();\n\n\t\tif ( l === 0 ) {\n\n\t\t\tthis._x = 0;\n\t\t\tthis._y = 0;\n\t\t\tthis._z = 0;\n\t\t\tthis._w = 1;\n\n\t\t} else {\n\n\t\t\tl = 1 / l;\n\n\t\t\tthis._x = this._x * l;\n\t\t\tthis._y = this._y * l;\n\t\t\tthis._z = this._z * l;\n\t\t\tthis._w = this._w * l;\n\n\t\t}\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( this, q );\n\n\t}\n\n\tpremultiply( q ) {\n\n\t\treturn this.multiplyQuaternions( q, this );\n\n\t}\n\n\tmultiplyQuaternions( a, b ) {\n\n\t\t// from http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/code/index.htm\n\n\t\tconst qax = a._x, qay = a._y, qaz = a._z, qaw = a._w;\n\t\tconst qbx = b._x, qby = b._y, qbz = b._z, qbw = b._w;\n\n\t\tthis._x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n\t\tthis._y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n\t\tthis._z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n\t\tthis._w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerp( qb, t ) {\n\n\t\tif ( t === 0 ) return this;\n\t\tif ( t === 1 ) return this.copy( qb );\n\n\t\tconst x = this._x, y = this._y, z = this._z, w = this._w;\n\n\t\t// http://www.euclideanspace.com/maths/algebra/realNormedAlgebra/quaternions/slerp/\n\n\t\tlet cosHalfTheta = w * qb._w + x * qb._x + y * qb._y + z * qb._z;\n\n\t\tif ( cosHalfTheta < 0 ) {\n\n\t\t\tthis._w = - qb._w;\n\t\t\tthis._x = - qb._x;\n\t\t\tthis._y = - qb._y;\n\t\t\tthis._z = - qb._z;\n\n\t\t\tcosHalfTheta = - cosHalfTheta;\n\n\t\t} else {\n\n\t\t\tthis.copy( qb );\n\n\t\t}\n\n\t\tif ( cosHalfTheta >= 1.0 ) {\n\n\t\t\tthis._w = w;\n\t\t\tthis._x = x;\n\t\t\tthis._y = y;\n\t\t\tthis._z = z;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sqrSinHalfTheta = 1.0 - cosHalfTheta * cosHalfTheta;\n\n\t\tif ( sqrSinHalfTheta <= Number.EPSILON ) {\n\n\t\t\tconst s = 1 - t;\n\t\t\tthis._w = s * w + t * this._w;\n\t\t\tthis._x = s * x + t * this._x;\n\t\t\tthis._y = s * y + t * this._y;\n\t\t\tthis._z = s * z + t * this._z;\n\n\t\t\tthis.normalize(); // normalize calls _onChangeCallback()\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst sinHalfTheta = Math.sqrt( sqrSinHalfTheta );\n\t\tconst halfTheta = Math.atan2( sinHalfTheta, cosHalfTheta );\n\t\tconst ratioA = Math.sin( ( 1 - t ) * halfTheta ) / sinHalfTheta,\n\t\t\tratioB = Math.sin( t * halfTheta ) / sinHalfTheta;\n\n\t\tthis._w = ( w * ratioA + this._w * ratioB );\n\t\tthis._x = ( x * ratioA + this._x * ratioB );\n\t\tthis._y = ( y * ratioA + this._y * ratioB );\n\t\tthis._z = ( z * ratioA + this._z * ratioB );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tslerpQuaternions( qa, qb, t ) {\n\n\t\treturn this.copy( qa ).slerp( qb, t );\n\n\t}\n\n\trandom() {\n\n\t\t// sets this quaternion to a uniform random unit quaternnion\n\n\t\t// Ken Shoemake\n\t\t// Uniform random rotations\n\t\t// D. Kirk, editor, Graphics Gems III, pages 124-132. Academic Press, New York, 1992.\n\n\t\tconst theta1 = 2 * Math.PI * Math.random();\n\t\tconst theta2 = 2 * Math.PI * Math.random();\n\n\t\tconst x0 = Math.random();\n\t\tconst r1 = Math.sqrt( 1 - x0 );\n\t\tconst r2 = Math.sqrt( x0 );\n\n\t\treturn this.set(\n\t\t\tr1 * Math.sin( theta1 ),\n\t\t\tr1 * Math.cos( theta1 ),\n\t\t\tr2 * Math.sin( theta2 ),\n\t\t\tr2 * Math.cos( theta2 ),\n\t\t);\n\n\t}\n\n\tequals( quaternion ) {\n\n\t\treturn ( quaternion._x === this._x ) && ( quaternion._y === this._y ) && ( quaternion._z === this._z ) && ( quaternion._w === this._w );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis._x = array[ offset ];\n\t\tthis._y = array[ offset + 1 ];\n\t\tthis._z = array[ offset + 2 ];\n\t\tthis._w = array[ offset + 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._w;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis._x = attribute.getX( index );\n\t\tthis._y = attribute.getY( index );\n\t\tthis._z = attribute.getZ( index );\n\t\tthis._w = attribute.getW( index );\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.toArray();\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this._x;\n\t\tyield this._y;\n\t\tyield this._z;\n\t\tyield this._w;\n\n\t}\n\n}\n\nclass Vector3 {\n\n\tconstructor( x = 0, y = 0, z = 0 ) {\n\n\t\tVector3.prototype.isVector3 = true;\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t}\n\n\tset( x, y, z ) {\n\n\t\tif ( z === undefined ) z = this.z; // sprite.scale.set(x,y)\n\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.x = scalar;\n\t\tthis.y = scalar;\n\t\tthis.z = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( x ) {\n\n\t\tthis.x = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( y ) {\n\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( z ) {\n\n\t\tthis.z = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponent( index, value ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: this.x = value; break;\n\t\t\tcase 1: this.y = value; break;\n\t\t\tcase 2: this.z = value; break;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index ) {\n\n\t\tswitch ( index ) {\n\n\t\t\tcase 0: return this.x;\n\t\t\tcase 1: return this.y;\n\t\t\tcase 2: return this.z;\n\t\t\tdefault: throw new Error( 'index is out of range: ' + index );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.x, this.y, this.z );\n\n\t}\n\n\tcopy( v ) {\n\n\t\tthis.x = v.x;\n\t\tthis.y = v.y;\n\t\tthis.z = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tadd( v ) {\n\n\t\tthis.x += v.x;\n\t\tthis.y += v.y;\n\t\tthis.z += v.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.x += s;\n\t\tthis.y += s;\n\t\tthis.z += s;\n\n\t\treturn this;\n\n\t}\n\n\taddVectors( a, b ) {\n\n\t\tthis.x = a.x + b.x;\n\t\tthis.y = a.y + b.y;\n\t\tthis.z = a.z + b.z;\n\n\t\treturn this;\n\n\t}\n\n\taddScaledVector( v, s ) {\n\n\t\tthis.x += v.x * s;\n\t\tthis.y += v.y * s;\n\t\tthis.z += v.z * s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( v ) {\n\n\t\tthis.x -= v.x;\n\t\tthis.y -= v.y;\n\t\tthis.z -= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tsubScalar( s ) {\n\n\t\tthis.x -= s;\n\t\tthis.y -= s;\n\t\tthis.z -= s;\n\n\t\treturn this;\n\n\t}\n\n\tsubVectors( a, b ) {\n\n\t\tthis.x = a.x - b.x;\n\t\tthis.y = a.y - b.y;\n\t\tthis.z = a.z - b.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( v ) {\n\n\t\tthis.x *= v.x;\n\t\tthis.y *= v.y;\n\t\tthis.z *= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( scalar ) {\n\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\tthis.z *= scalar;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyVectors( a, b ) {\n\n\t\tthis.x = a.x * b.x;\n\t\tthis.y = a.y * b.y;\n\t\tthis.z = a.z * b.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyEuler( euler ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromEuler( euler ) );\n\n\t}\n\n\tapplyAxisAngle( axis, angle ) {\n\n\t\treturn this.applyQuaternion( _quaternion$4.setFromAxisAngle( axis, angle ) );\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 3 ] * y + e[ 6 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 4 ] * y + e[ 7 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 5 ] * y + e[ 8 ] * z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\treturn this.applyMatrix3( m ).normalize();\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tconst w = 1 / ( e[ 3 ] * x + e[ 7 ] * y + e[ 11 ] * z + e[ 15 ] );\n\n\t\tthis.x = ( e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z + e[ 12 ] ) * w;\n\t\tthis.y = ( e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z + e[ 13 ] ) * w;\n\t\tthis.z = ( e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z + e[ 14 ] ) * w;\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t// quaternion q is assumed to have unit length\n\n\t\tconst vx = this.x, vy = this.y, vz = this.z;\n\t\tconst qx = q.x, qy = q.y, qz = q.z, qw = q.w;\n\n\t\t// t = 2 * cross( q.xyz, v );\n\t\tconst tx = 2 * ( qy * vz - qz * vy );\n\t\tconst ty = 2 * ( qz * vx - qx * vz );\n\t\tconst tz = 2 * ( qx * vy - qy * vx );\n\n\t\t// v + q.w * t + cross( q.xyz, t );\n\t\tthis.x = vx + qw * tx + qy * tz - qz * ty;\n\t\tthis.y = vy + qw * ty + qz * tx - qx * tz;\n\t\tthis.z = vz + qw * tz + qx * ty - qy * tx;\n\n\t\treturn this;\n\n\t}\n\n\tproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.matrixWorldInverse ).applyMatrix4( camera.projectionMatrix );\n\n\t}\n\n\tunproject( camera ) {\n\n\t\treturn this.applyMatrix4( camera.projectionMatrixInverse ).applyMatrix4( camera.matrixWorld );\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\t// input: THREE.Matrix4 affine matrix\n\t\t// vector interpreted as a direction\n\n\t\tconst x = this.x, y = this.y, z = this.z;\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ] * z;\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ] * z;\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\n\n\t\treturn this.normalize();\n\n\t}\n\n\tdivide( v ) {\n\n\t\tthis.x /= v.x;\n\t\tthis.y /= v.y;\n\t\tthis.z /= v.z;\n\n\t\treturn this;\n\n\t}\n\n\tdivideScalar( scalar ) {\n\n\t\treturn this.multiplyScalar( 1 / scalar );\n\n\t}\n\n\tmin( v ) {\n\n\t\tthis.x = Math.min( this.x, v.x );\n\t\tthis.y = Math.min( this.y, v.y );\n\t\tthis.z = Math.min( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tmax( v ) {\n\n\t\tthis.x = Math.max( this.x, v.x );\n\t\tthis.y = Math.max( this.y, v.y );\n\t\tthis.z = Math.max( this.z, v.z );\n\n\t\treturn this;\n\n\t}\n\n\tclamp( min, max ) {\n\n\t\t// assumes min < max, componentwise\n\n\t\tthis.x = Math.max( min.x, Math.min( max.x, this.x ) );\n\t\tthis.y = Math.max( min.y, Math.min( max.y, this.y ) );\n\t\tthis.z = Math.max( min.z, Math.min( max.z, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampScalar( minVal, maxVal ) {\n\n\t\tthis.x = Math.max( minVal, Math.min( maxVal, this.x ) );\n\t\tthis.y = Math.max( minVal, Math.min( maxVal, this.y ) );\n\t\tthis.z = Math.max( minVal, Math.min( maxVal, this.z ) );\n\n\t\treturn this;\n\n\t}\n\n\tclampLength( min, max ) {\n\n\t\tconst length = this.length();\n\n\t\treturn this.divideScalar( length || 1 ).multiplyScalar( Math.max( min, Math.min( max, length ) ) );\n\n\t}\n\n\tfloor() {\n\n\t\tthis.x = Math.floor( this.x );\n\t\tthis.y = Math.floor( this.y );\n\t\tthis.z = Math.floor( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tceil() {\n\n\t\tthis.x = Math.ceil( this.x );\n\t\tthis.y = Math.ceil( this.y );\n\t\tthis.z = Math.ceil( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tround() {\n\n\t\tthis.x = Math.round( this.x );\n\t\tthis.y = Math.round( this.y );\n\t\tthis.z = Math.round( this.z );\n\n\t\treturn this;\n\n\t}\n\n\troundToZero() {\n\n\t\tthis.x = Math.trunc( this.x );\n\t\tthis.y = Math.trunc( this.y );\n\t\tthis.z = Math.trunc( this.z );\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.x = - this.x;\n\t\tthis.y = - this.y;\n\t\tthis.z = - this.z;\n\n\t\treturn this;\n\n\t}\n\n\tdot( v ) {\n\n\t\treturn this.x * v.x + this.y * v.y + this.z * v.z;\n\n\t}\n\n\t// TODO lengthSquared?\n\n\tlengthSq() {\n\n\t\treturn this.x * this.x + this.y * this.y + this.z * this.z;\n\n\t}\n\n\tlength() {\n\n\t\treturn Math.sqrt( this.x * this.x + this.y * this.y + this.z * this.z );\n\n\t}\n\n\tmanhattanLength() {\n\n\t\treturn Math.abs( this.x ) + Math.abs( this.y ) + Math.abs( this.z );\n\n\t}\n\n\tnormalize() {\n\n\t\treturn this.divideScalar( this.length() || 1 );\n\n\t}\n\n\tsetLength( length ) {\n\n\t\treturn this.normalize().multiplyScalar( length );\n\n\t}\n\n\tlerp( v, alpha ) {\n\n\t\tthis.x += ( v.x - this.x ) * alpha;\n\t\tthis.y += ( v.y - this.y ) * alpha;\n\t\tthis.z += ( v.z - this.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpVectors( v1, v2, alpha ) {\n\n\t\tthis.x = v1.x + ( v2.x - v1.x ) * alpha;\n\t\tthis.y = v1.y + ( v2.y - v1.y ) * alpha;\n\t\tthis.z = v1.z + ( v2.z - v1.z ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tcross( v ) {\n\n\t\treturn this.crossVectors( this, v );\n\n\t}\n\n\tcrossVectors( a, b ) {\n\n\t\tconst ax = a.x, ay = a.y, az = a.z;\n\t\tconst bx = b.x, by = b.y, bz = b.z;\n\n\t\tthis.x = ay * bz - az * by;\n\t\tthis.y = az * bx - ax * bz;\n\t\tthis.z = ax * by - ay * bx;\n\n\t\treturn this;\n\n\t}\n\n\tprojectOnVector( v ) {\n\n\t\tconst denominator = v.lengthSq();\n\n\t\tif ( denominator === 0 ) return this.set( 0, 0, 0 );\n\n\t\tconst scalar = v.dot( this ) / denominator;\n\n\t\treturn this.copy( v ).multiplyScalar( scalar );\n\n\t}\n\n\tprojectOnPlane( planeNormal ) {\n\n\t\t_vector$c.copy( this ).projectOnVector( planeNormal );\n\n\t\treturn this.sub( _vector$c );\n\n\t}\n\n\treflect( normal ) {\n\n\t\t// reflect incident vector off plane orthogonal to normal\n\t\t// normal is assumed to have unit length\n\n\t\treturn this.sub( _vector$c.copy( normal ).multiplyScalar( 2 * this.dot( normal ) ) );\n\n\t}\n\n\tangleTo( v ) {\n\n\t\tconst denominator = Math.sqrt( this.lengthSq() * v.lengthSq() );\n\n\t\tif ( denominator === 0 ) return Math.PI / 2;\n\n\t\tconst theta = this.dot( v ) / denominator;\n\n\t\t// clamp, to handle numerical problems\n\n\t\treturn Math.acos( clamp$1( theta, - 1, 1 ) );\n\n\t}\n\n\tdistanceTo( v ) {\n\n\t\treturn Math.sqrt( this.distanceToSquared( v ) );\n\n\t}\n\n\tdistanceToSquared( v ) {\n\n\t\tconst dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;\n\n\t\treturn dx * dx + dy * dy + dz * dz;\n\n\t}\n\n\tmanhattanDistanceTo( v ) {\n\n\t\treturn Math.abs( this.x - v.x ) + Math.abs( this.y - v.y ) + Math.abs( this.z - v.z );\n\n\t}\n\n\tsetFromSpherical( s ) {\n\n\t\treturn this.setFromSphericalCoords( s.radius, s.phi, s.theta );\n\n\t}\n\n\tsetFromSphericalCoords( radius, phi, theta ) {\n\n\t\tconst sinPhiRadius = Math.sin( phi ) * radius;\n\n\t\tthis.x = sinPhiRadius * Math.sin( theta );\n\t\tthis.y = Math.cos( phi ) * radius;\n\t\tthis.z = sinPhiRadius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCylindrical( c ) {\n\n\t\treturn this.setFromCylindricalCoords( c.radius, c.theta, c.y );\n\n\t}\n\n\tsetFromCylindricalCoords( radius, theta, y ) {\n\n\t\tthis.x = radius * Math.sin( theta );\n\t\tthis.y = y;\n\t\tthis.z = radius * Math.cos( theta );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixPosition( m ) {\n\n\t\tconst e = m.elements;\n\n\t\tthis.x = e[ 12 ];\n\t\tthis.y = e[ 13 ];\n\t\tthis.z = e[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixScale( m ) {\n\n\t\tconst sx = this.setFromMatrixColumn( m, 0 ).length();\n\t\tconst sy = this.setFromMatrixColumn( m, 1 ).length();\n\t\tconst sz = this.setFromMatrixColumn( m, 2 ).length();\n\n\t\tthis.x = sx;\n\t\tthis.y = sy;\n\t\tthis.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrixColumn( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 4 );\n\n\t}\n\n\tsetFromMatrix3Column( m, index ) {\n\n\t\treturn this.fromArray( m.elements, index * 3 );\n\n\t}\n\n\tsetFromEuler( e ) {\n\n\t\tthis.x = e._x;\n\t\tthis.y = e._y;\n\t\tthis.z = e._z;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromColor( c ) {\n\n\t\tthis.x = c.r;\n\t\tthis.y = c.g;\n\t\tthis.z = c.b;\n\n\t\treturn this;\n\n\t}\n\n\tequals( v ) {\n\n\t\treturn ( ( v.x === this.x ) && ( v.y === this.y ) && ( v.z === this.z ) );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.x = array[ offset ];\n\t\tthis.y = array[ offset + 1 ];\n\t\tthis.z = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.x;\n\t\tarray[ offset + 1 ] = this.y;\n\t\tarray[ offset + 2 ] = this.z;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.x = attribute.getX( index );\n\t\tthis.y = attribute.getY( index );\n\t\tthis.z = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\trandom() {\n\n\t\tthis.x = Math.random();\n\t\tthis.y = Math.random();\n\t\tthis.z = Math.random();\n\n\t\treturn this;\n\n\t}\n\n\trandomDirection() {\n\n\t\t// https://mathworld.wolfram.com/SpherePointPicking.html\n\n\t\tconst theta = Math.random() * Math.PI * 2;\n\t\tconst u = Math.random() * 2 - 1;\n\t\tconst c = Math.sqrt( 1 - u * u );\n\n\t\tthis.x = c * Math.cos( theta );\n\t\tthis.y = u;\n\t\tthis.z = c * Math.sin( theta );\n\n\t\treturn this;\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.x;\n\t\tyield this.y;\n\t\tyield this.z;\n\n\t}\n\n}\n\nconst _vector$c = /*@__PURE__*/ new Vector3();\nconst _quaternion$4 = /*@__PURE__*/ new Quaternion();\n\nclass Box3 {\n\n\tconstructor( min = new Vector3( + Infinity, + Infinity, + Infinity ), max = new Vector3( - Infinity, - Infinity, - Infinity ) ) {\n\n\t\tthis.isBox3 = true;\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromArray( array ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = array.length; i < il; i += 3 ) {\n\n\t\t\tthis.expandByPoint( _vector$b.fromArray( array, i ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromBufferAttribute( attribute ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = attribute.count; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( _vector$b.fromBufferAttribute( attribute, i ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$b.copy( size ).multiplyScalar( 0.5 );\n\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromObject( object, precise = false ) {\n\n\t\tthis.makeEmpty();\n\n\t\treturn this.expandByObject( object, precise );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = this.min.z = + Infinity;\n\t\tthis.max.x = this.max.y = this.max.z = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y ) || ( this.max.z < this.min.z );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\texpandByObject( object, precise = false ) {\n\n\t\t// Computes the world-axis-aligned bounding box of an object (including its children),\n\t\t// accounting for both the object's, and children's, world transforms\n\n\t\tobject.updateWorldMatrix( false, false );\n\n\t\tconst geometry = object.geometry;\n\n\t\tif ( geometry !== undefined ) {\n\n\t\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\n\t\t\t// precise AABB computation based on vertex data requires at least a position attribute.\n\t\t\t// instancing isn't supported so far and uses the normal (conservative) code path.\n\n\t\t\tif ( precise === true && positionAttribute !== undefined && object.isInstancedMesh !== true ) {\n\n\t\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t\tif ( object.isMesh === true ) {\n\n\t\t\t\t\t\tobject.getVertexPosition( i, _vector$b );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_vector$b.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_vector$b.applyMatrix4( object.matrixWorld );\n\t\t\t\t\tthis.expandByPoint( _vector$b );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( object.boundingBox !== undefined ) {\n\n\t\t\t\t\t// object-level bounding box\n\n\t\t\t\t\tif ( object.boundingBox === null ) {\n\n\t\t\t\t\t\tobject.computeBoundingBox();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_box$4.copy( object.boundingBox );\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// geometry-level bounding box\n\n\t\t\t\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\t\t\t\tgeometry.computeBoundingBox();\n\n\t\t\t\t\t}\n\n\t\t\t\t\t_box$4.copy( geometry.boundingBox );\n\n\t\t\t\t}\n\n\t\t\t\t_box$4.applyMatrix4( object.matrixWorld );\n\n\t\t\t\tthis.union( _box$4 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis.expandByObject( children[ i ], precise );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x >= this.min.x && point.x <= this.max.x &&\n\t\t\tpoint.y >= this.min.y && point.y <= this.max.y &&\n\t\t\tpoint.z >= this.min.z && point.z <= this.max.z;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y &&\n\t\t\tthis.min.z <= box.min.z && box.max.z <= this.max.z;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y ),\n\t\t\t( point.z - this.min.z ) / ( this.max.z - this.min.z )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 6 splitting planes to rule out intersections.\n\t\treturn box.max.x >= this.min.x && box.min.x <= this.max.x &&\n\t\t\tbox.max.y >= this.min.y && box.min.y <= this.max.y &&\n\t\t\tbox.max.z >= this.min.z && box.min.z <= this.max.z;\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\t// Find the point on the AABB closest to the sphere center.\n\t\tthis.clampPoint( sphere.center, _vector$b );\n\n\t\t// If that point is inside the sphere, the AABB and sphere intersect.\n\t\treturn _vector$b.distanceToSquared( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// We compute the minimum and maximum dot product values. If those values\n\t\t// are on the same side (back or front) of the plane, then there is no intersection.\n\n\t\tlet min, max;\n\n\t\tif ( plane.normal.x > 0 ) {\n\n\t\t\tmin = plane.normal.x * this.min.x;\n\t\t\tmax = plane.normal.x * this.max.x;\n\n\t\t} else {\n\n\t\t\tmin = plane.normal.x * this.max.x;\n\t\t\tmax = plane.normal.x * this.min.x;\n\n\t\t}\n\n\t\tif ( plane.normal.y > 0 ) {\n\n\t\t\tmin += plane.normal.y * this.min.y;\n\t\t\tmax += plane.normal.y * this.max.y;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.y * this.max.y;\n\t\t\tmax += plane.normal.y * this.min.y;\n\n\t\t}\n\n\t\tif ( plane.normal.z > 0 ) {\n\n\t\t\tmin += plane.normal.z * this.min.z;\n\t\t\tmax += plane.normal.z * this.max.z;\n\n\t\t} else {\n\n\t\t\tmin += plane.normal.z * this.max.z;\n\t\t\tmax += plane.normal.z * this.min.z;\n\n\t\t}\n\n\t\treturn ( min <= - plane.constant && max >= - plane.constant );\n\n\t}\n\n\tintersectsTriangle( triangle ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// compute box center and extents\n\t\tthis.getCenter( _center );\n\t\t_extents.subVectors( this.max, _center );\n\n\t\t// translate triangle to aabb origin\n\t\t_v0$2.subVectors( triangle.a, _center );\n\t\t_v1$7.subVectors( triangle.b, _center );\n\t\t_v2$4.subVectors( triangle.c, _center );\n\n\t\t// compute edge vectors for triangle\n\t\t_f0.subVectors( _v1$7, _v0$2 );\n\t\t_f1.subVectors( _v2$4, _v1$7 );\n\t\t_f2.subVectors( _v0$2, _v2$4 );\n\n\t\t// test against axes that are given by cross product combinations of the edges of the triangle and the edges of the aabb\n\t\t// make an axis testing of each of the 3 sides of the aabb against each of the 3 sides of the triangle = 9 axis of separation\n\t\t// axis_ij = u_i x f_j (u0, u1, u2 = face normals of aabb = x,y,z axes vectors since aabb is axis aligned)\n\t\tlet axes = [\n\t\t\t0, - _f0.z, _f0.y, 0, - _f1.z, _f1.y, 0, - _f2.z, _f2.y,\n\t\t\t_f0.z, 0, - _f0.x, _f1.z, 0, - _f1.x, _f2.z, 0, - _f2.x,\n\t\t\t- _f0.y, _f0.x, 0, - _f1.y, _f1.x, 0, - _f2.y, _f2.x, 0\n\t\t];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// test 3 face normals from the aabb\n\t\taxes = [ 1, 0, 0, 0, 1, 0, 0, 0, 1 ];\n\t\tif ( ! satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents ) ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// finally testing the face normal of the triangle\n\t\t// use already existing triangle edge vectors here\n\t\t_triangleNormal.crossVectors( _f0, _f1 );\n\t\taxes = [ _triangleNormal.x, _triangleNormal.y, _triangleNormal.z ];\n\n\t\treturn satForAxes( axes, _v0$2, _v1$7, _v2$4, _extents );\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.clampPoint( point, _vector$b ).distanceTo( point );\n\n\t}\n\n\tgetBoundingSphere( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\ttarget.makeEmpty();\n\n\t\t} else {\n\n\t\t\tthis.getCenter( target.center );\n\n\t\t\ttarget.radius = this.getSize( _vector$b ).length() * 0.5;\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\t// ensure that if there is no overlap, the result is fully empty, not slightly empty with non-inf/+inf values that will cause subsequence intersects to erroneously return valid values.\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\t// transform of empty box is an empty box.\n\t\tif ( this.isEmpty() ) return this;\n\n\t\t// NOTE: I am using a binary pattern to specify all 2^3 combinations below\n\t\t_points[ 0 ].set( this.min.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 000\n\t\t_points[ 1 ].set( this.min.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 001\n\t\t_points[ 2 ].set( this.min.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 010\n\t\t_points[ 3 ].set( this.min.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 011\n\t\t_points[ 4 ].set( this.max.x, this.min.y, this.min.z ).applyMatrix4( matrix ); // 100\n\t\t_points[ 5 ].set( this.max.x, this.min.y, this.max.z ).applyMatrix4( matrix ); // 101\n\t\t_points[ 6 ].set( this.max.x, this.max.y, this.min.z ).applyMatrix4( matrix ); // 110\n\t\t_points[ 7 ].set( this.max.x, this.max.y, this.max.z ).applyMatrix4( matrix ); // 111\n\n\t\tthis.setFromPoints( _points );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nconst _points = [\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3(),\n\t/*@__PURE__*/ new Vector3()\n];\n\nconst _vector$b = /*@__PURE__*/ new Vector3();\n\nconst _box$4 = /*@__PURE__*/ new Box3();\n\n// triangle centered vertices\n\nconst _v0$2 = /*@__PURE__*/ new Vector3();\nconst _v1$7 = /*@__PURE__*/ new Vector3();\nconst _v2$4 = /*@__PURE__*/ new Vector3();\n\n// triangle edge vectors\n\nconst _f0 = /*@__PURE__*/ new Vector3();\nconst _f1 = /*@__PURE__*/ new Vector3();\nconst _f2 = /*@__PURE__*/ new Vector3();\n\nconst _center = /*@__PURE__*/ new Vector3();\nconst _extents = /*@__PURE__*/ new Vector3();\nconst _triangleNormal = /*@__PURE__*/ new Vector3();\nconst _testAxis = /*@__PURE__*/ new Vector3();\n\nfunction satForAxes( axes, v0, v1, v2, extents ) {\n\n\tfor ( let i = 0, j = axes.length - 3; i <= j; i += 3 ) {\n\n\t\t_testAxis.fromArray( axes, i );\n\t\t// project the aabb onto the separating axis\n\t\tconst r = extents.x * Math.abs( _testAxis.x ) + extents.y * Math.abs( _testAxis.y ) + extents.z * Math.abs( _testAxis.z );\n\t\t// project all 3 vertices of the triangle onto the separating axis\n\t\tconst p0 = v0.dot( _testAxis );\n\t\tconst p1 = v1.dot( _testAxis );\n\t\tconst p2 = v2.dot( _testAxis );\n\t\t// actual test, basically see if either of the most extreme of the triangle points intersects r\n\t\tif ( Math.max( - Math.max( p0, p1, p2 ), Math.min( p0, p1, p2 ) ) > r ) {\n\n\t\t\t// points of the projected triangle are outside the projected half-length of the aabb\n\t\t\t// the axis is separating and we can exit\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nconst _box$3 = /*@__PURE__*/ new Box3();\nconst _v1$6 = /*@__PURE__*/ new Vector3();\nconst _v2$3 = /*@__PURE__*/ new Vector3();\n\nclass Sphere {\n\n\tconstructor( center = new Vector3(), radius = - 1 ) {\n\n\t\tthis.isSphere = true;\n\n\t\tthis.center = center;\n\t\tthis.radius = radius;\n\n\t}\n\n\tset( center, radius ) {\n\n\t\tthis.center.copy( center );\n\t\tthis.radius = radius;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points, optionalCenter ) {\n\n\t\tconst center = this.center;\n\n\t\tif ( optionalCenter !== undefined ) {\n\n\t\t\tcenter.copy( optionalCenter );\n\n\t\t} else {\n\n\t\t\t_box$3.setFromPoints( points ).getCenter( center );\n\n\t\t}\n\n\t\tlet maxRadiusSq = 0;\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( points[ i ] ) );\n\n\t\t}\n\n\t\tthis.radius = Math.sqrt( maxRadiusSq );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( sphere ) {\n\n\t\tthis.center.copy( sphere.center );\n\t\tthis.radius = sphere.radius;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\treturn ( this.radius < 0 );\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.center.set( 0, 0, 0 );\n\t\tthis.radius = - 1;\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn ( point.distanceToSquared( this.center ) <= ( this.radius * this.radius ) );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn ( point.distanceTo( this.center ) - this.radius );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst radiusSum = this.radius + sphere.radius;\n\n\t\treturn sphere.center.distanceToSquared( this.center ) <= ( radiusSum * radiusSum );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsSphere( this );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\treturn Math.abs( plane.distanceToPoint( this.center ) ) <= this.radius;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\tconst deltaLengthSq = this.center.distanceToSquared( point );\n\n\t\ttarget.copy( point );\n\n\t\tif ( deltaLengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\ttarget.sub( this.center ).normalize();\n\t\t\ttarget.multiplyScalar( this.radius ).add( this.center );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetBoundingBox( target ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\t// Empty sphere produces empty bounding box\n\t\t\ttarget.makeEmpty();\n\t\t\treturn target;\n\n\t\t}\n\n\t\ttarget.set( this.center, this.center );\n\t\ttarget.expandByScalar( this.radius );\n\n\t\treturn target;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.center.applyMatrix4( matrix );\n\t\tthis.radius = this.radius * matrix.getMaxScaleOnAxis();\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.center.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\tthis.center.copy( point );\n\n\t\t\tthis.radius = 0;\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\t_v1$6.subVectors( point, this.center );\n\n\t\tconst lengthSq = _v1$6.lengthSq();\n\n\t\tif ( lengthSq > ( this.radius * this.radius ) ) {\n\n\t\t\t// calculate the minimal sphere\n\n\t\t\tconst length = Math.sqrt( lengthSq );\n\n\t\t\tconst delta = ( length - this.radius ) * 0.5;\n\n\t\t\tthis.center.addScaledVector( _v1$6, delta / length );\n\n\t\t\tthis.radius += delta;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunion( sphere ) {\n\n\t\tif ( sphere.isEmpty() ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( this.isEmpty() ) {\n\n\t\t\tthis.copy( sphere );\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( this.center.equals( sphere.center ) === true ) {\n\n\t\t\t this.radius = Math.max( this.radius, sphere.radius );\n\n\t\t} else {\n\n\t\t\t_v2$3.subVectors( sphere.center, this.center ).setLength( sphere.radius );\n\n\t\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).add( _v2$3 ) );\n\n\t\t\tthis.expandByPoint( _v1$6.copy( sphere.center ).sub( _v2$3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sphere ) {\n\n\t\treturn sphere.center.equals( this.center ) && ( sphere.radius === this.radius );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$a = /*@__PURE__*/ new Vector3();\nconst _segCenter = /*@__PURE__*/ new Vector3();\nconst _segDir = /*@__PURE__*/ new Vector3();\nconst _diff = /*@__PURE__*/ new Vector3();\n\nconst _edge1 = /*@__PURE__*/ new Vector3();\nconst _edge2 = /*@__PURE__*/ new Vector3();\nconst _normal$2 = /*@__PURE__*/ new Vector3();\n\nclass Ray {\n\n\tconstructor( origin = new Vector3(), direction = new Vector3( 0, 0, - 1 ) ) {\n\n\t\tthis.origin = origin;\n\t\tthis.direction = direction;\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\tthis.origin.copy( origin );\n\t\tthis.direction.copy( direction );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( ray ) {\n\n\t\tthis.origin.copy( ray.origin );\n\t\tthis.direction.copy( ray.direction );\n\n\t\treturn this;\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn target.copy( this.origin ).addScaledVector( this.direction, t );\n\n\t}\n\n\tlookAt( v ) {\n\n\t\tthis.direction.copy( v ).sub( this.origin ).normalize();\n\n\t\treturn this;\n\n\t}\n\n\trecast( t ) {\n\n\t\tthis.origin.copy( this.at( t, _vector$a ) );\n\n\t\treturn this;\n\n\t}\n\n\tclosestPointToPoint( point, target ) {\n\n\t\ttarget.subVectors( point, this.origin );\n\n\t\tconst directionDistance = target.dot( this.direction );\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn target.copy( this.origin );\n\n\t\t}\n\n\t\treturn target.copy( this.origin ).addScaledVector( this.direction, directionDistance );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn Math.sqrt( this.distanceSqToPoint( point ) );\n\n\t}\n\n\tdistanceSqToPoint( point ) {\n\n\t\tconst directionDistance = _vector$a.subVectors( point, this.origin ).dot( this.direction );\n\n\t\t// point behind the ray\n\n\t\tif ( directionDistance < 0 ) {\n\n\t\t\treturn this.origin.distanceToSquared( point );\n\n\t\t}\n\n\t\t_vector$a.copy( this.origin ).addScaledVector( this.direction, directionDistance );\n\n\t\treturn _vector$a.distanceToSquared( point );\n\n\t}\n\n\tdistanceSqToSegment( v0, v1, optionalPointOnRay, optionalPointOnSegment ) {\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteDistRaySegment.h\n\t\t// It returns the min distance between the ray and the segment\n\t\t// defined by v0 and v1\n\t\t// It can also set two optional targets :\n\t\t// - The closest point on the ray\n\t\t// - The closest point on the segment\n\n\t\t_segCenter.copy( v0 ).add( v1 ).multiplyScalar( 0.5 );\n\t\t_segDir.copy( v1 ).sub( v0 ).normalize();\n\t\t_diff.copy( this.origin ).sub( _segCenter );\n\n\t\tconst segExtent = v0.distanceTo( v1 ) * 0.5;\n\t\tconst a01 = - this.direction.dot( _segDir );\n\t\tconst b0 = _diff.dot( this.direction );\n\t\tconst b1 = - _diff.dot( _segDir );\n\t\tconst c = _diff.lengthSq();\n\t\tconst det = Math.abs( 1 - a01 * a01 );\n\t\tlet s0, s1, sqrDist, extDet;\n\n\t\tif ( det > 0 ) {\n\n\t\t\t// The ray and segment are not parallel.\n\n\t\t\ts0 = a01 * b1 - b0;\n\t\t\ts1 = a01 * b0 - b1;\n\t\t\textDet = segExtent * det;\n\n\t\t\tif ( s0 >= 0 ) {\n\n\t\t\t\tif ( s1 >= - extDet ) {\n\n\t\t\t\t\tif ( s1 <= extDet ) {\n\n\t\t\t\t\t\t// region 0\n\t\t\t\t\t\t// Minimum at interior points of ray and segment.\n\n\t\t\t\t\t\tconst invDet = 1 / det;\n\t\t\t\t\t\ts0 *= invDet;\n\t\t\t\t\t\ts1 *= invDet;\n\t\t\t\t\t\tsqrDist = s0 * ( s0 + a01 * s1 + 2 * b0 ) + s1 * ( a01 * s0 + s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// region 1\n\n\t\t\t\t\t\ts1 = segExtent;\n\t\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 5\n\n\t\t\t\t\ts1 = - segExtent;\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tif ( s1 <= - extDet ) {\n\n\t\t\t\t\t// region 4\n\n\t\t\t\t\ts0 = Math.max( 0, - ( - a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? - segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else if ( s1 <= extDet ) {\n\n\t\t\t\t\t// region 3\n\n\t\t\t\t\ts0 = 0;\n\t\t\t\t\ts1 = Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// region 2\n\n\t\t\t\t\ts0 = Math.max( 0, - ( a01 * segExtent + b0 ) );\n\t\t\t\t\ts1 = ( s0 > 0 ) ? segExtent : Math.min( Math.max( - segExtent, - b1 ), segExtent );\n\t\t\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Ray and segment are parallel.\n\n\t\t\ts1 = ( a01 > 0 ) ? - segExtent : segExtent;\n\t\t\ts0 = Math.max( 0, - ( a01 * s1 + b0 ) );\n\t\t\tsqrDist = - s0 * s0 + s1 * ( s1 + 2 * b1 ) + c;\n\n\t\t}\n\n\t\tif ( optionalPointOnRay ) {\n\n\t\t\toptionalPointOnRay.copy( this.origin ).addScaledVector( this.direction, s0 );\n\n\t\t}\n\n\t\tif ( optionalPointOnSegment ) {\n\n\t\t\toptionalPointOnSegment.copy( _segCenter ).addScaledVector( _segDir, s1 );\n\n\t\t}\n\n\t\treturn sqrDist;\n\n\t}\n\n\tintersectSphere( sphere, target ) {\n\n\t\t_vector$a.subVectors( sphere.center, this.origin );\n\t\tconst tca = _vector$a.dot( this.direction );\n\t\tconst d2 = _vector$a.dot( _vector$a ) - tca * tca;\n\t\tconst radius2 = sphere.radius * sphere.radius;\n\n\t\tif ( d2 > radius2 ) return null;\n\n\t\tconst thc = Math.sqrt( radius2 - d2 );\n\n\t\t// t0 = first intersect point - entrance on front of sphere\n\t\tconst t0 = tca - thc;\n\n\t\t// t1 = second intersect point - exit point on back of sphere\n\t\tconst t1 = tca + thc;\n\n\t\t// test to see if t1 is behind the ray - if so, return null\n\t\tif ( t1 < 0 ) return null;\n\n\t\t// test to see if t0 is behind the ray:\n\t\t// if it is, the ray is inside the sphere, so return the second exit point scaled by t1,\n\t\t// in order to always return an intersect point that is in front of the ray.\n\t\tif ( t0 < 0 ) return this.at( t1, target );\n\n\t\t// else t0 is in front of the ray, so return the first collision point scaled by t0\n\t\treturn this.at( t0, target );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn this.distanceSqToPoint( sphere.center ) <= ( sphere.radius * sphere.radius );\n\n\t}\n\n\tdistanceToPlane( plane ) {\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( plane.distanceToPoint( this.origin ) === 0 ) {\n\n\t\t\t\treturn 0;\n\n\t\t\t}\n\n\t\t\t// Null is preferable to undefined since undefined means.... it is undefined\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( this.origin.dot( plane.normal ) + plane.constant ) / denominator;\n\n\t\t// Return if the ray never intersects the plane\n\n\t\treturn t >= 0 ? t : null;\n\n\t}\n\n\tintersectPlane( plane, target ) {\n\n\t\tconst t = this.distanceToPlane( plane );\n\n\t\tif ( t === null ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn this.at( t, target );\n\n\t}\n\n\tintersectsPlane( plane ) {\n\n\t\t// check if the ray lies on the plane first\n\n\t\tconst distToPoint = plane.distanceToPoint( this.origin );\n\n\t\tif ( distToPoint === 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst denominator = plane.normal.dot( this.direction );\n\n\t\tif ( denominator * distToPoint < 0 ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\t// ray origin is behind the plane (and is pointing behind it)\n\n\t\treturn false;\n\n\t}\n\n\tintersectBox( box, target ) {\n\n\t\tlet tmin, tmax, tymin, tymax, tzmin, tzmax;\n\n\t\tconst invdirx = 1 / this.direction.x,\n\t\t\tinvdiry = 1 / this.direction.y,\n\t\t\tinvdirz = 1 / this.direction.z;\n\n\t\tconst origin = this.origin;\n\n\t\tif ( invdirx >= 0 ) {\n\n\t\t\ttmin = ( box.min.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.max.x - origin.x ) * invdirx;\n\n\t\t} else {\n\n\t\t\ttmin = ( box.max.x - origin.x ) * invdirx;\n\t\t\ttmax = ( box.min.x - origin.x ) * invdirx;\n\n\t\t}\n\n\t\tif ( invdiry >= 0 ) {\n\n\t\t\ttymin = ( box.min.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.max.y - origin.y ) * invdiry;\n\n\t\t} else {\n\n\t\t\ttymin = ( box.max.y - origin.y ) * invdiry;\n\t\t\ttymax = ( box.min.y - origin.y ) * invdiry;\n\n\t\t}\n\n\t\tif ( ( tmin > tymax ) || ( tymin > tmax ) ) return null;\n\n\t\tif ( tymin > tmin || isNaN( tmin ) ) tmin = tymin;\n\n\t\tif ( tymax < tmax || isNaN( tmax ) ) tmax = tymax;\n\n\t\tif ( invdirz >= 0 ) {\n\n\t\t\ttzmin = ( box.min.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.max.z - origin.z ) * invdirz;\n\n\t\t} else {\n\n\t\t\ttzmin = ( box.max.z - origin.z ) * invdirz;\n\t\t\ttzmax = ( box.min.z - origin.z ) * invdirz;\n\n\t\t}\n\n\t\tif ( ( tmin > tzmax ) || ( tzmin > tmax ) ) return null;\n\n\t\tif ( tzmin > tmin || tmin !== tmin ) tmin = tzmin;\n\n\t\tif ( tzmax < tmax || tmax !== tmax ) tmax = tzmax;\n\n\t\t//return point closest to the ray (positive side)\n\n\t\tif ( tmax < 0 ) return null;\n\n\t\treturn this.at( tmin >= 0 ? tmin : tmax, target );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn this.intersectBox( box, _vector$a ) !== null;\n\n\t}\n\n\tintersectTriangle( a, b, c, backfaceCulling, target ) {\n\n\t\t// Compute the offset origin, edges, and normal.\n\n\t\t// from https://github.com/pmjoniak/GeometricTools/blob/master/GTEngine/Include/Mathematics/GteIntrRay3Triangle3.h\n\n\t\t_edge1.subVectors( b, a );\n\t\t_edge2.subVectors( c, a );\n\t\t_normal$2.crossVectors( _edge1, _edge2 );\n\n\t\t// Solve Q + t*D = b1*E1 + b2*E2 (Q = kDiff, D = ray direction,\n\t\t// E1 = kEdge1, E2 = kEdge2, N = Cross(E1,E2)) by\n\t\t//   |Dot(D,N)|*b1 = sign(Dot(D,N))*Dot(D,Cross(Q,E2))\n\t\t//   |Dot(D,N)|*b2 = sign(Dot(D,N))*Dot(D,Cross(E1,Q))\n\t\t//   |Dot(D,N)|*t = -sign(Dot(D,N))*Dot(Q,N)\n\t\tlet DdN = this.direction.dot( _normal$2 );\n\t\tlet sign;\n\n\t\tif ( DdN > 0 ) {\n\n\t\t\tif ( backfaceCulling ) return null;\n\t\t\tsign = 1;\n\n\t\t} else if ( DdN < 0 ) {\n\n\t\t\tsign = - 1;\n\t\t\tDdN = - DdN;\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t_diff.subVectors( this.origin, a );\n\t\tconst DdQxE2 = sign * this.direction.dot( _edge2.crossVectors( _diff, _edge2 ) );\n\n\t\t// b1 < 0, no intersection\n\t\tif ( DdQxE2 < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst DdE1xQ = sign * this.direction.dot( _edge1.cross( _diff ) );\n\n\t\t// b2 < 0, no intersection\n\t\tif ( DdE1xQ < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// b1+b2 > 1, no intersection\n\t\tif ( DdQxE2 + DdE1xQ > DdN ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Line intersects triangle, check if ray does.\n\t\tconst QdN = - sign * _diff.dot( _normal$2 );\n\n\t\t// t < 0, no intersection\n\t\tif ( QdN < 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// Ray intersects triangle.\n\t\treturn this.at( QdN / DdN, target );\n\n\t}\n\n\tapplyMatrix4( matrix4 ) {\n\n\t\tthis.origin.applyMatrix4( matrix4 );\n\t\tthis.direction.transformDirection( matrix4 );\n\n\t\treturn this;\n\n\t}\n\n\tequals( ray ) {\n\n\t\treturn ray.origin.equals( this.origin ) && ray.direction.equals( this.direction );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass Matrix4 {\n\n\tconstructor( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tMatrix4.prototype.isMatrix4 = true;\n\n\t\tthis.elements = [\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t];\n\n\t\tif ( n11 !== undefined ) {\n\n\t\t\tthis.set( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 );\n\n\t\t}\n\n\t}\n\n\tset( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\n\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\n\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\n\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\n\n\t\treturn this;\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, 1, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Matrix4().fromArray( this.elements );\n\n\t}\n\n\tcopy( m ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\n\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\n\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\n\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\n\n\t\treturn this;\n\n\t}\n\n\tcopyPosition( m ) {\n\n\t\tconst te = this.elements, me = m.elements;\n\n\t\tte[ 12 ] = me[ 12 ];\n\t\tte[ 13 ] = me[ 13 ];\n\t\tte[ 14 ] = me[ 14 ];\n\n\t\treturn this;\n\n\t}\n\n\tsetFromMatrix3( m ) {\n\n\t\tconst me = m.elements;\n\n\t\tthis.set(\n\n\t\t\tme[ 0 ], me[ 3 ], me[ 6 ], 0,\n\t\t\tme[ 1 ], me[ 4 ], me[ 7 ], 0,\n\t\t\tme[ 2 ], me[ 5 ], me[ 8 ], 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractBasis( xAxis, yAxis, zAxis ) {\n\n\t\txAxis.setFromMatrixColumn( this, 0 );\n\t\tyAxis.setFromMatrixColumn( this, 1 );\n\t\tzAxis.setFromMatrixColumn( this, 2 );\n\n\t\treturn this;\n\n\t}\n\n\tmakeBasis( xAxis, yAxis, zAxis ) {\n\n\t\tthis.set(\n\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\n\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\n\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\n\t\t\t0, 0, 0, 1\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\textractRotation( m ) {\n\n\t\t// this method does not support reflection matrices\n\n\t\tconst te = this.elements;\n\t\tconst me = m.elements;\n\n\t\tconst scaleX = 1 / _v1$5.setFromMatrixColumn( m, 0 ).length();\n\t\tconst scaleY = 1 / _v1$5.setFromMatrixColumn( m, 1 ).length();\n\t\tconst scaleZ = 1 / _v1$5.setFromMatrixColumn( m, 2 ).length();\n\n\t\tte[ 0 ] = me[ 0 ] * scaleX;\n\t\tte[ 1 ] = me[ 1 ] * scaleX;\n\t\tte[ 2 ] = me[ 2 ] * scaleX;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = me[ 4 ] * scaleY;\n\t\tte[ 5 ] = me[ 5 ] * scaleY;\n\t\tte[ 6 ] = me[ 6 ] * scaleY;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = me[ 8 ] * scaleZ;\n\t\tte[ 9 ] = me[ 9 ] * scaleZ;\n\t\tte[ 10 ] = me[ 10 ] * scaleZ;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromEuler( euler ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = euler.x, y = euler.y, z = euler.z;\n\t\tconst a = Math.cos( x ), b = Math.sin( x );\n\t\tconst c = Math.cos( y ), d = Math.sin( y );\n\t\tconst e = Math.cos( z ), f = Math.sin( z );\n\n\t\tif ( euler.order === 'XYZ' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - c * f;\n\t\t\tte[ 8 ] = d;\n\n\t\t\tte[ 1 ] = af + be * d;\n\t\t\tte[ 5 ] = ae - bf * d;\n\t\t\tte[ 9 ] = - b * c;\n\n\t\t\tte[ 2 ] = bf - ae * d;\n\t\t\tte[ 6 ] = be + af * d;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YXZ' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce + df * b;\n\t\t\tte[ 4 ] = de * b - cf;\n\t\t\tte[ 8 ] = a * d;\n\n\t\t\tte[ 1 ] = a * f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b;\n\n\t\t\tte[ 2 ] = cf * b - de;\n\t\t\tte[ 6 ] = df + ce * b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZXY' ) {\n\n\t\t\tconst ce = c * e, cf = c * f, de = d * e, df = d * f;\n\n\t\t\tte[ 0 ] = ce - df * b;\n\t\t\tte[ 4 ] = - a * f;\n\t\t\tte[ 8 ] = de + cf * b;\n\n\t\t\tte[ 1 ] = cf + de * b;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = df - ce * b;\n\n\t\t\tte[ 2 ] = - a * d;\n\t\t\tte[ 6 ] = b;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'ZYX' ) {\n\n\t\t\tconst ae = a * e, af = a * f, be = b * e, bf = b * f;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = be * d - af;\n\t\t\tte[ 8 ] = ae * d + bf;\n\n\t\t\tte[ 1 ] = c * f;\n\t\t\tte[ 5 ] = bf * d + ae;\n\t\t\tte[ 9 ] = af * d - be;\n\n\t\t\tte[ 2 ] = - d;\n\t\t\tte[ 6 ] = b * c;\n\t\t\tte[ 10 ] = a * c;\n\n\t\t} else if ( euler.order === 'YZX' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = bd - ac * f;\n\t\t\tte[ 8 ] = bc * f + ad;\n\n\t\t\tte[ 1 ] = f;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = - b * e;\n\n\t\t\tte[ 2 ] = - d * e;\n\t\t\tte[ 6 ] = ad * f + bc;\n\t\t\tte[ 10 ] = ac - bd * f;\n\n\t\t} else if ( euler.order === 'XZY' ) {\n\n\t\t\tconst ac = a * c, ad = a * d, bc = b * c, bd = b * d;\n\n\t\t\tte[ 0 ] = c * e;\n\t\t\tte[ 4 ] = - f;\n\t\t\tte[ 8 ] = d * e;\n\n\t\t\tte[ 1 ] = ac * f + bd;\n\t\t\tte[ 5 ] = a * e;\n\t\t\tte[ 9 ] = ad * f - bc;\n\n\t\t\tte[ 2 ] = bc * f - ad;\n\t\t\tte[ 6 ] = b * e;\n\t\t\tte[ 10 ] = bd * f + ac;\n\n\t\t}\n\n\t\t// bottom row\n\t\tte[ 3 ] = 0;\n\t\tte[ 7 ] = 0;\n\t\tte[ 11 ] = 0;\n\n\t\t// last column\n\t\tte[ 12 ] = 0;\n\t\tte[ 13 ] = 0;\n\t\tte[ 14 ] = 0;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationFromQuaternion( q ) {\n\n\t\treturn this.compose( _zero, q, _one );\n\n\t}\n\n\tlookAt( eye, target, up ) {\n\n\t\tconst te = this.elements;\n\n\t\t_z.subVectors( eye, target );\n\n\t\tif ( _z.lengthSq() === 0 ) {\n\n\t\t\t// eye and target are in the same position\n\n\t\t\t_z.z = 1;\n\n\t\t}\n\n\t\t_z.normalize();\n\t\t_x.crossVectors( up, _z );\n\n\t\tif ( _x.lengthSq() === 0 ) {\n\n\t\t\t// up and z are parallel\n\n\t\t\tif ( Math.abs( up.z ) === 1 ) {\n\n\t\t\t\t_z.x += 0.0001;\n\n\t\t\t} else {\n\n\t\t\t\t_z.z += 0.0001;\n\n\t\t\t}\n\n\t\t\t_z.normalize();\n\t\t\t_x.crossVectors( up, _z );\n\n\t\t}\n\n\t\t_x.normalize();\n\t\t_y.crossVectors( _z, _x );\n\n\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\n\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\n\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( m ) {\n\n\t\treturn this.multiplyMatrices( this, m );\n\n\t}\n\n\tpremultiply( m ) {\n\n\t\treturn this.multiplyMatrices( m, this );\n\n\t}\n\n\tmultiplyMatrices( a, b ) {\n\n\t\tconst ae = a.elements;\n\t\tconst be = b.elements;\n\t\tconst te = this.elements;\n\n\t\tconst a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\n\t\tconst a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\n\t\tconst a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\n\t\tconst a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\n\n\t\tconst b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\n\t\tconst b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\n\t\tconst b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\n\t\tconst b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\n\n\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\n\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\n\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\n\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\n\n\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\n\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\n\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\n\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\n\n\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\n\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\n\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\n\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\n\n\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\n\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\n\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\n\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\n\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\n\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\n\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\n\n\t\treturn this;\n\n\t}\n\n\tdeterminant() {\n\n\t\tconst te = this.elements;\n\n\t\tconst n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\n\t\tconst n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\n\t\tconst n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\n\t\tconst n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\n\n\t\t//TODO: make this more efficient\n\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\n\n\t\treturn (\n\t\t\tn41 * (\n\t\t\t\t+ n14 * n23 * n32\n\t\t\t\t - n13 * n24 * n32\n\t\t\t\t - n14 * n22 * n33\n\t\t\t\t + n12 * n24 * n33\n\t\t\t\t + n13 * n22 * n34\n\t\t\t\t - n12 * n23 * n34\n\t\t\t) +\n\t\t\tn42 * (\n\t\t\t\t+ n11 * n23 * n34\n\t\t\t\t - n11 * n24 * n33\n\t\t\t\t + n14 * n21 * n33\n\t\t\t\t - n13 * n21 * n34\n\t\t\t\t + n13 * n24 * n31\n\t\t\t\t - n14 * n23 * n31\n\t\t\t) +\n\t\t\tn43 * (\n\t\t\t\t+ n11 * n24 * n32\n\t\t\t\t - n11 * n22 * n34\n\t\t\t\t - n14 * n21 * n32\n\t\t\t\t + n12 * n21 * n34\n\t\t\t\t + n14 * n22 * n31\n\t\t\t\t - n12 * n24 * n31\n\t\t\t) +\n\t\t\tn44 * (\n\t\t\t\t- n13 * n22 * n31\n\t\t\t\t - n11 * n23 * n32\n\t\t\t\t + n11 * n22 * n33\n\t\t\t\t + n13 * n21 * n32\n\t\t\t\t - n12 * n21 * n33\n\t\t\t\t + n12 * n23 * n31\n\t\t\t)\n\n\t\t);\n\n\t}\n\n\ttranspose() {\n\n\t\tconst te = this.elements;\n\t\tlet tmp;\n\n\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\n\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\n\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\n\n\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\n\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\n\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\n\n\t\treturn this;\n\n\t}\n\n\tsetPosition( x, y, z ) {\n\n\t\tconst te = this.elements;\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tte[ 12 ] = x.x;\n\t\t\tte[ 13 ] = x.y;\n\t\t\tte[ 14 ] = x.z;\n\n\t\t} else {\n\n\t\t\tte[ 12 ] = x;\n\t\t\tte[ 13 ] = y;\n\t\t\tte[ 14 ] = z;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinvert() {\n\n\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\n\t\tconst te = this.elements,\n\n\t\t\tn11 = te[ 0 ], n21 = te[ 1 ], n31 = te[ 2 ], n41 = te[ 3 ],\n\t\t\tn12 = te[ 4 ], n22 = te[ 5 ], n32 = te[ 6 ], n42 = te[ 7 ],\n\t\t\tn13 = te[ 8 ], n23 = te[ 9 ], n33 = te[ 10 ], n43 = te[ 11 ],\n\t\t\tn14 = te[ 12 ], n24 = te[ 13 ], n34 = te[ 14 ], n44 = te[ 15 ],\n\n\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\n\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\n\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\n\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\n\n\t\tconst det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\n\n\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\n\n\t\tconst detInv = 1 / det;\n\n\t\tte[ 0 ] = t11 * detInv;\n\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\n\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\n\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\n\n\t\tte[ 4 ] = t12 * detInv;\n\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\n\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\n\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\n\n\t\tte[ 8 ] = t13 * detInv;\n\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\n\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\n\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\n\n\t\tte[ 12 ] = t14 * detInv;\n\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\n\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\n\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\n\n\t\treturn this;\n\n\t}\n\n\tscale( v ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = v.x, y = v.y, z = v.z;\n\n\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\n\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\n\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\n\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxScaleOnAxis() {\n\n\t\tconst te = this.elements;\n\n\t\tconst scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\n\t\tconst scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\n\t\tconst scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\n\n\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\n\n\t}\n\n\tmakeTranslation( x, y, z ) {\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0, x.x,\n\t\t\t\t0, 1, 0, x.y,\n\t\t\t\t0, 0, 1, x.z,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tthis.set(\n\n\t\t\t\t1, 0, 0, x,\n\t\t\t\t0, 1, 0, y,\n\t\t\t\t0, 0, 1, z,\n\t\t\t\t0, 0, 0, 1\n\n\t\t\t);\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationX( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t1, 0, 0, 0,\n\t\t\t0, c, - s, 0,\n\t\t\t0, s, c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationY( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\t c, 0, s, 0,\n\t\t\t 0, 1, 0, 0,\n\t\t\t- s, 0, c, 0,\n\t\t\t 0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationZ( theta ) {\n\n\t\tconst c = Math.cos( theta ), s = Math.sin( theta );\n\n\t\tthis.set(\n\n\t\t\tc, - s, 0, 0,\n\t\t\ts, c, 0, 0,\n\t\t\t0, 0, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeRotationAxis( axis, angle ) {\n\n\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\n\n\t\tconst c = Math.cos( angle );\n\t\tconst s = Math.sin( angle );\n\t\tconst t = 1 - c;\n\t\tconst x = axis.x, y = axis.y, z = axis.z;\n\t\tconst tx = t * x, ty = t * y;\n\n\t\tthis.set(\n\n\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\n\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\n\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeScale( x, y, z ) {\n\n\t\tthis.set(\n\n\t\t\tx, 0, 0, 0,\n\t\t\t0, y, 0, 0,\n\t\t\t0, 0, z, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tmakeShear( xy, xz, yx, yz, zx, zy ) {\n\n\t\tthis.set(\n\n\t\t\t1, yx, zx, 0,\n\t\t\txy, 1, zy, 0,\n\t\t\txz, yz, 1, 0,\n\t\t\t0, 0, 0, 1\n\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tcompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tconst x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\n\t\tconst x2 = x + x,\ty2 = y + y, z2 = z + z;\n\t\tconst xx = x * x2, xy = x * y2, xz = x * z2;\n\t\tconst yy = y * y2, yz = y * z2, zz = z * z2;\n\t\tconst wx = w * x2, wy = w * y2, wz = w * z2;\n\n\t\tconst sx = scale.x, sy = scale.y, sz = scale.z;\n\n\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\n\t\tte[ 1 ] = ( xy + wz ) * sx;\n\t\tte[ 2 ] = ( xz - wy ) * sx;\n\t\tte[ 3 ] = 0;\n\n\t\tte[ 4 ] = ( xy - wz ) * sy;\n\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\n\t\tte[ 6 ] = ( yz + wx ) * sy;\n\t\tte[ 7 ] = 0;\n\n\t\tte[ 8 ] = ( xz + wy ) * sz;\n\t\tte[ 9 ] = ( yz - wx ) * sz;\n\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\n\t\tte[ 11 ] = 0;\n\n\t\tte[ 12 ] = position.x;\n\t\tte[ 13 ] = position.y;\n\t\tte[ 14 ] = position.z;\n\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tdecompose( position, quaternion, scale ) {\n\n\t\tconst te = this.elements;\n\n\t\tlet sx = _v1$5.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\n\t\tconst sy = _v1$5.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\n\t\tconst sz = _v1$5.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\n\n\t\t// if determine is negative, we need to invert one scale\n\t\tconst det = this.determinant();\n\t\tif ( det < 0 ) sx = - sx;\n\n\t\tposition.x = te[ 12 ];\n\t\tposition.y = te[ 13 ];\n\t\tposition.z = te[ 14 ];\n\n\t\t// scale the rotation part\n\t\t_m1$3.copy( this );\n\n\t\tconst invSX = 1 / sx;\n\t\tconst invSY = 1 / sy;\n\t\tconst invSZ = 1 / sz;\n\n\t\t_m1$3.elements[ 0 ] *= invSX;\n\t\t_m1$3.elements[ 1 ] *= invSX;\n\t\t_m1$3.elements[ 2 ] *= invSX;\n\n\t\t_m1$3.elements[ 4 ] *= invSY;\n\t\t_m1$3.elements[ 5 ] *= invSY;\n\t\t_m1$3.elements[ 6 ] *= invSY;\n\n\t\t_m1$3.elements[ 8 ] *= invSZ;\n\t\t_m1$3.elements[ 9 ] *= invSZ;\n\t\t_m1$3.elements[ 10 ] *= invSZ;\n\n\t\tquaternion.setFromRotationMatrix( _m1$3 );\n\n\t\tscale.x = sx;\n\t\tscale.y = sy;\n\t\tscale.z = sz;\n\n\t\treturn this;\n\n\t}\n\n\tmakePerspective( left, right, top, bottom, near, far, coordinateSystem = WebGLCoordinateSystem ) {\n\n\t\tconst te = this.elements;\n\t\tconst x = 2 * near / ( right - left );\n\t\tconst y = 2 * near / ( top - bottom );\n\n\t\tconst a = ( right + left ) / ( right - left );\n\t\tconst b = ( top + bottom ) / ( top - bottom );\n\n\t\tlet c, d;\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tc = - ( far + near ) / ( far - near );\n\t\t\td = ( - 2 * far * near ) / ( far - near );\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tc = - far / ( far - near );\n\t\t\td = ( - far * near ) / ( far - near );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.Matrix4.makePerspective(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a; \tte[ 12 ] = 0;\n\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b; \tte[ 13 ] = 0;\n\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c; \tte[ 14 ] = d;\n\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\n\n\t\treturn this;\n\n\t}\n\n\tmakeOrthographic( left, right, top, bottom, near, far, coordinateSystem = WebGLCoordinateSystem ) {\n\n\t\tconst te = this.elements;\n\t\tconst w = 1.0 / ( right - left );\n\t\tconst h = 1.0 / ( top - bottom );\n\t\tconst p = 1.0 / ( far - near );\n\n\t\tconst x = ( right + left ) * w;\n\t\tconst y = ( top + bottom ) * h;\n\n\t\tlet z, zInv;\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tz = ( far + near ) * p;\n\t\t\tzInv = - 2 * p;\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tz = near * p;\n\t\t\tzInv = - 1 * p;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.Matrix4.makeOrthographic(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\t\tte[ 8 ] = 0; \t\tte[ 12 ] = - x;\n\t\tte[ 1 ] = 0; \t\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0; \t\tte[ 13 ] = - y;\n\t\tte[ 2 ] = 0; \t\tte[ 6 ] = 0;\t\tte[ 10 ] = zInv;\tte[ 14 ] = - z;\n\t\tte[ 3 ] = 0; \t\tte[ 7 ] = 0;\t\tte[ 11 ] = 0;\t\tte[ 15 ] = 1;\n\n\t\treturn this;\n\n\t}\n\n\tequals( matrix ) {\n\n\t\tconst te = this.elements;\n\t\tconst me = matrix.elements;\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tif ( te[ i ] !== me[ i ] ) return false;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 16; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst te = this.elements;\n\n\t\tarray[ offset ] = te[ 0 ];\n\t\tarray[ offset + 1 ] = te[ 1 ];\n\t\tarray[ offset + 2 ] = te[ 2 ];\n\t\tarray[ offset + 3 ] = te[ 3 ];\n\n\t\tarray[ offset + 4 ] = te[ 4 ];\n\t\tarray[ offset + 5 ] = te[ 5 ];\n\t\tarray[ offset + 6 ] = te[ 6 ];\n\t\tarray[ offset + 7 ] = te[ 7 ];\n\n\t\tarray[ offset + 8 ] = te[ 8 ];\n\t\tarray[ offset + 9 ] = te[ 9 ];\n\t\tarray[ offset + 10 ] = te[ 10 ];\n\t\tarray[ offset + 11 ] = te[ 11 ];\n\n\t\tarray[ offset + 12 ] = te[ 12 ];\n\t\tarray[ offset + 13 ] = te[ 13 ];\n\t\tarray[ offset + 14 ] = te[ 14 ];\n\t\tarray[ offset + 15 ] = te[ 15 ];\n\n\t\treturn array;\n\n\t}\n\n}\n\nconst _v1$5 = /*@__PURE__*/ new Vector3();\nconst _m1$3 = /*@__PURE__*/ new Matrix4();\nconst _zero = /*@__PURE__*/ new Vector3( 0, 0, 0 );\nconst _one = /*@__PURE__*/ new Vector3( 1, 1, 1 );\nconst _x = /*@__PURE__*/ new Vector3();\nconst _y = /*@__PURE__*/ new Vector3();\nconst _z = /*@__PURE__*/ new Vector3();\n\nconst _matrix$2 = /*@__PURE__*/ new Matrix4();\nconst _quaternion$3 = /*@__PURE__*/ new Quaternion();\n\nclass Euler {\n\n\tconstructor( x = 0, y = 0, z = 0, order = Euler.DEFAULT_ORDER ) {\n\n\t\tthis.isEuler = true;\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t}\n\n\tget x() {\n\n\t\treturn this._x;\n\n\t}\n\n\tset x( value ) {\n\n\t\tthis._x = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget y() {\n\n\t\treturn this._y;\n\n\t}\n\n\tset y( value ) {\n\n\t\tthis._y = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget z() {\n\n\t\treturn this._z;\n\n\t}\n\n\tset z( value ) {\n\n\t\tthis._z = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tget order() {\n\n\t\treturn this._order;\n\n\t}\n\n\tset order( value ) {\n\n\t\tthis._order = value;\n\t\tthis._onChangeCallback();\n\n\t}\n\n\tset( x, y, z, order = this._order ) {\n\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._order = order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this._x, this._y, this._z, this._order );\n\n\t}\n\n\tcopy( euler ) {\n\n\t\tthis._x = euler._x;\n\t\tthis._y = euler._y;\n\t\tthis._z = euler._z;\n\t\tthis._order = euler._order;\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromRotationMatrix( m, order = this._order, update = true ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tconst te = m.elements;\n\t\tconst m11 = te[ 0 ], m12 = te[ 4 ], m13 = te[ 8 ];\n\t\tconst m21 = te[ 1 ], m22 = te[ 5 ], m23 = te[ 9 ];\n\t\tconst m31 = te[ 2 ], m32 = te[ 6 ], m33 = te[ 10 ];\n\n\t\tswitch ( order ) {\n\n\t\t\tcase 'XYZ':\n\n\t\t\t\tthis._y = Math.asin( clamp$1( m13, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m13 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YXZ':\n\n\t\t\t\tthis._x = Math.asin( - clamp$1( m23, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m23 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\t\t\t\t\tthis._z = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZXY':\n\n\t\t\t\tthis._x = Math.asin( clamp$1( m32, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m32 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._y = Math.atan2( - m31, m33 );\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._y = 0;\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'ZYX':\n\n\t\t\t\tthis._y = Math.asin( - clamp$1( m31, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m31 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m33 );\n\t\t\t\t\tthis._z = Math.atan2( m21, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._z = Math.atan2( - m12, m22 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'YZX':\n\n\t\t\t\tthis._z = Math.asin( clamp$1( m21, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m21 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m22 );\n\t\t\t\t\tthis._y = Math.atan2( - m31, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = 0;\n\t\t\t\t\tthis._y = Math.atan2( m13, m33 );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'XZY':\n\n\t\t\t\tthis._z = Math.asin( - clamp$1( m12, - 1, 1 ) );\n\n\t\t\t\tif ( Math.abs( m12 ) < 0.9999999 ) {\n\n\t\t\t\t\tthis._x = Math.atan2( m32, m22 );\n\t\t\t\t\tthis._y = Math.atan2( m13, m11 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._x = Math.atan2( - m23, m33 );\n\t\t\t\t\tthis._y = 0;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'THREE.Euler: .setFromRotationMatrix() encountered an unknown order: ' + order );\n\n\t\t}\n\n\t\tthis._order = order;\n\n\t\tif ( update === true ) this._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\tsetFromQuaternion( q, order, update ) {\n\n\t\t_matrix$2.makeRotationFromQuaternion( q );\n\n\t\treturn this.setFromRotationMatrix( _matrix$2, order, update );\n\n\t}\n\n\tsetFromVector3( v, order = this._order ) {\n\n\t\treturn this.set( v.x, v.y, v.z, order );\n\n\t}\n\n\treorder( newOrder ) {\n\n\t\t// WARNING: this discards revolution information -bhouston\n\n\t\t_quaternion$3.setFromEuler( this );\n\n\t\treturn this.setFromQuaternion( _quaternion$3, newOrder );\n\n\t}\n\n\tequals( euler ) {\n\n\t\treturn ( euler._x === this._x ) && ( euler._y === this._y ) && ( euler._z === this._z ) && ( euler._order === this._order );\n\n\t}\n\n\tfromArray( array ) {\n\n\t\tthis._x = array[ 0 ];\n\t\tthis._y = array[ 1 ];\n\t\tthis._z = array[ 2 ];\n\t\tif ( array[ 3 ] !== undefined ) this._order = array[ 3 ];\n\n\t\tthis._onChangeCallback();\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this._x;\n\t\tarray[ offset + 1 ] = this._y;\n\t\tarray[ offset + 2 ] = this._z;\n\t\tarray[ offset + 3 ] = this._order;\n\n\t\treturn array;\n\n\t}\n\n\t_onChange( callback ) {\n\n\t\tthis._onChangeCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\t_onChangeCallback() {}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this._x;\n\t\tyield this._y;\n\t\tyield this._z;\n\t\tyield this._order;\n\n\t}\n\n}\n\nEuler.DEFAULT_ORDER = 'XYZ';\n\nclass Layers {\n\n\tconstructor() {\n\n\t\tthis.mask = 1 | 0;\n\n\t}\n\n\tset( channel ) {\n\n\t\tthis.mask = ( 1 << channel | 0 ) >>> 0;\n\n\t}\n\n\tenable( channel ) {\n\n\t\tthis.mask |= 1 << channel | 0;\n\n\t}\n\n\tenableAll() {\n\n\t\tthis.mask = 0xffffffff | 0;\n\n\t}\n\n\ttoggle( channel ) {\n\n\t\tthis.mask ^= 1 << channel | 0;\n\n\t}\n\n\tdisable( channel ) {\n\n\t\tthis.mask &= ~ ( 1 << channel | 0 );\n\n\t}\n\n\tdisableAll() {\n\n\t\tthis.mask = 0;\n\n\t}\n\n\ttest( layers ) {\n\n\t\treturn ( this.mask & layers.mask ) !== 0;\n\n\t}\n\n\tisEnabled( channel ) {\n\n\t\treturn ( this.mask & ( 1 << channel | 0 ) ) !== 0;\n\n\t}\n\n}\n\nlet _object3DId = 0;\n\nconst _v1$4 = /*@__PURE__*/ new Vector3();\nconst _q1 = /*@__PURE__*/ new Quaternion();\nconst _m1$2 = /*@__PURE__*/ new Matrix4();\nconst _target$1 = /*@__PURE__*/ new Vector3();\n\nconst _position$3 = /*@__PURE__*/ new Vector3();\nconst _scale$2 = /*@__PURE__*/ new Vector3();\nconst _quaternion$2 = /*@__PURE__*/ new Quaternion();\n\nconst _xAxis = /*@__PURE__*/ new Vector3( 1, 0, 0 );\nconst _yAxis = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nconst _zAxis = /*@__PURE__*/ new Vector3( 0, 0, 1 );\n\nconst _addedEvent = { type: 'added' };\nconst _removedEvent = { type: 'removed' };\n\nconst _childaddedEvent = { type: 'childadded', child: null };\nconst _childremovedEvent = { type: 'childremoved', child: null };\n\nclass Object3D extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isObject3D = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _object3DId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'Object3D';\n\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\tthis.up = Object3D.DEFAULT_UP.clone();\n\n\t\tconst position = new Vector3();\n\t\tconst rotation = new Euler();\n\t\tconst quaternion = new Quaternion();\n\t\tconst scale = new Vector3( 1, 1, 1 );\n\n\t\tfunction onRotationChange() {\n\n\t\t\tquaternion.setFromEuler( rotation, false );\n\n\t\t}\n\n\t\tfunction onQuaternionChange() {\n\n\t\t\trotation.setFromQuaternion( quaternion, undefined, false );\n\n\t\t}\n\n\t\trotation._onChange( onRotationChange );\n\t\tquaternion._onChange( onQuaternionChange );\n\n\t\tObject.defineProperties( this, {\n\t\t\tposition: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: position\n\t\t\t},\n\t\t\trotation: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: rotation\n\t\t\t},\n\t\t\tquaternion: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: quaternion\n\t\t\t},\n\t\t\tscale: {\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: scale\n\t\t\t},\n\t\t\tmodelViewMatrix: {\n\t\t\t\tvalue: new Matrix4()\n\t\t\t},\n\t\t\tnormalMatrix: {\n\t\t\t\tvalue: new Matrix3()\n\t\t\t}\n\t\t} );\n\n\t\tthis.matrix = new Matrix4();\n\t\tthis.matrixWorld = new Matrix4();\n\n\t\tthis.matrixAutoUpdate = Object3D.DEFAULT_MATRIX_AUTO_UPDATE;\n\n\t\tthis.matrixWorldAutoUpdate = Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE; // checked by the renderer\n\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\tthis.layers = new Layers();\n\t\tthis.visible = true;\n\n\t\tthis.castShadow = false;\n\t\tthis.receiveShadow = false;\n\n\t\tthis.frustumCulled = true;\n\t\tthis.renderOrder = 0;\n\n\t\tthis.animations = [];\n\n\t\tthis.userData = {};\n\n\t}\n\n\tonBeforeShadow( /* renderer, object, camera, shadowCamera, geometry, depthMaterial, group */ ) {}\n\n\tonAfterShadow( /* renderer, object, camera, shadowCamera, geometry, depthMaterial, group */ ) {}\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tonAfterRender( /* renderer, scene, camera, geometry, material, group */ ) {}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tthis.matrix.premultiply( matrix );\n\n\t\tthis.matrix.decompose( this.position, this.quaternion, this.scale );\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\tthis.quaternion.premultiply( q );\n\n\t\treturn this;\n\n\t}\n\n\tsetRotationFromAxisAngle( axis, angle ) {\n\n\t\t// assumes axis is normalized\n\n\t\tthis.quaternion.setFromAxisAngle( axis, angle );\n\n\t}\n\n\tsetRotationFromEuler( euler ) {\n\n\t\tthis.quaternion.setFromEuler( euler, true );\n\n\t}\n\n\tsetRotationFromMatrix( m ) {\n\n\t\t// assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n\n\t\tthis.quaternion.setFromRotationMatrix( m );\n\n\t}\n\n\tsetRotationFromQuaternion( q ) {\n\n\t\t// assumes q is normalized\n\n\t\tthis.quaternion.copy( q );\n\n\t}\n\n\trotateOnAxis( axis, angle ) {\n\n\t\t// rotate object on axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.multiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateOnWorldAxis( axis, angle ) {\n\n\t\t// rotate object on axis in world space\n\t\t// axis is assumed to be normalized\n\t\t// method assumes no rotated parent\n\n\t\t_q1.setFromAxisAngle( axis, angle );\n\n\t\tthis.quaternion.premultiply( _q1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\treturn this.rotateOnAxis( _xAxis, angle );\n\n\t}\n\n\trotateY( angle ) {\n\n\t\treturn this.rotateOnAxis( _yAxis, angle );\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\treturn this.rotateOnAxis( _zAxis, angle );\n\n\t}\n\n\ttranslateOnAxis( axis, distance ) {\n\n\t\t// translate object by distance along axis in object space\n\t\t// axis is assumed to be normalized\n\n\t\t_v1$4.copy( axis ).applyQuaternion( this.quaternion );\n\n\t\tthis.position.add( _v1$4.multiplyScalar( distance ) );\n\n\t\treturn this;\n\n\t}\n\n\ttranslateX( distance ) {\n\n\t\treturn this.translateOnAxis( _xAxis, distance );\n\n\t}\n\n\ttranslateY( distance ) {\n\n\t\treturn this.translateOnAxis( _yAxis, distance );\n\n\t}\n\n\ttranslateZ( distance ) {\n\n\t\treturn this.translateOnAxis( _zAxis, distance );\n\n\t}\n\n\tlocalToWorld( vector ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn vector.applyMatrix4( this.matrixWorld );\n\n\t}\n\n\tworldToLocal( vector ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn vector.applyMatrix4( _m1$2.copy( this.matrixWorld ).invert() );\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\t// This method does not support objects having non-uniformly-scaled parent(s)\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target$1.copy( x );\n\n\t\t} else {\n\n\t\t\t_target$1.set( x, y, z );\n\n\t\t}\n\n\t\tconst parent = this.parent;\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_position$3.setFromMatrixPosition( this.matrixWorld );\n\n\t\tif ( this.isCamera || this.isLight ) {\n\n\t\t\t_m1$2.lookAt( _position$3, _target$1, this.up );\n\n\t\t} else {\n\n\t\t\t_m1$2.lookAt( _target$1, _position$3, this.up );\n\n\t\t}\n\n\t\tthis.quaternion.setFromRotationMatrix( _m1$2 );\n\n\t\tif ( parent ) {\n\n\t\t\t_m1$2.extractRotation( parent.matrixWorld );\n\t\t\t_q1.setFromRotationMatrix( _m1$2 );\n\t\t\tthis.quaternion.premultiply( _q1.invert() );\n\n\t\t}\n\n\t}\n\n\tadd( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.add( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object === this ) {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object can\\'t be added as a child of itself.', object );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tif ( object && object.isObject3D ) {\n\n\t\t\tobject.removeFromParent();\n\t\t\tobject.parent = this;\n\t\t\tthis.children.push( object );\n\n\t\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t\t_childaddedEvent.child = object;\n\t\t\tthis.dispatchEvent( _childaddedEvent );\n\t\t\t_childaddedEvent.child = null;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Object3D.add: object not an instance of THREE.Object3D.', object );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( object ) {\n\n\t\tif ( arguments.length > 1 ) {\n\n\t\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\n\n\t\t\t\tthis.remove( arguments[ i ] );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst index = this.children.indexOf( object );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tobject.parent = null;\n\t\t\tthis.children.splice( index, 1 );\n\n\t\t\tobject.dispatchEvent( _removedEvent );\n\n\t\t\t_childremovedEvent.child = object;\n\t\t\tthis.dispatchEvent( _childremovedEvent );\n\t\t\t_childremovedEvent.child = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremoveFromParent() {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tparent.remove( this );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclear() {\n\n\t\treturn this.remove( ... this.children );\n\n\t}\n\n\tattach( object ) {\n\n\t\t// adds object as a child of this, while maintaining the object's world transform\n\n\t\t// Note: This method does not support scene graphs having non-uniformly-scaled nodes(s)\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\t_m1$2.copy( this.matrixWorld ).invert();\n\n\t\tif ( object.parent !== null ) {\n\n\t\t\tobject.parent.updateWorldMatrix( true, false );\n\n\t\t\t_m1$2.multiply( object.parent.matrixWorld );\n\n\t\t}\n\n\t\tobject.applyMatrix4( _m1$2 );\n\n\t\tobject.removeFromParent();\n\t\tobject.parent = this;\n\t\tthis.children.push( object );\n\n\t\tobject.updateWorldMatrix( false, true );\n\n\t\tobject.dispatchEvent( _addedEvent );\n\n\t\t_childaddedEvent.child = object;\n\t\tthis.dispatchEvent( _childaddedEvent );\n\t\t_childaddedEvent.child = null;\n\n\t\treturn this;\n\n\t}\n\n\tgetObjectById( id ) {\n\n\t\treturn this.getObjectByProperty( 'id', id );\n\n\t}\n\n\tgetObjectByName( name ) {\n\n\t\treturn this.getObjectByProperty( 'name', name );\n\n\t}\n\n\tgetObjectByProperty( name, value ) {\n\n\t\tif ( this[ name ] === value ) return this;\n\n\t\tfor ( let i = 0, l = this.children.length; i < l; i ++ ) {\n\n\t\t\tconst child = this.children[ i ];\n\t\t\tconst object = child.getObjectByProperty( name, value );\n\n\t\t\tif ( object !== undefined ) {\n\n\t\t\t\treturn object;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tgetObjectsByProperty( name, value, result = [] ) {\n\n\t\tif ( this[ name ] === value ) result.push( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].getObjectsByProperty( name, value, result );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tgetWorldPosition( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\treturn target.setFromMatrixPosition( this.matrixWorld );\n\n\t}\n\n\tgetWorldQuaternion( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, target, _scale$2 );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldScale( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tthis.matrixWorld.decompose( _position$3, _quaternion$2, target );\n\n\t\treturn target;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\tthis.updateWorldMatrix( true, false );\n\n\t\tconst e = this.matrixWorld.elements;\n\n\t\treturn target.set( e[ 8 ], e[ 9 ], e[ 10 ] ).normalize();\n\n\t}\n\n\traycast( /* raycaster, intersects */ ) {}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverse( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseVisible( callback ) {\n\n\t\tif ( this.visible === false ) return;\n\n\t\tcallback( this );\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tchildren[ i ].traverseVisible( callback );\n\n\t\t}\n\n\t}\n\n\ttraverseAncestors( callback ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( parent !== null ) {\n\n\t\t\tcallback( parent );\n\n\t\t\tparent.traverseAncestors( callback );\n\n\t\t}\n\n\t}\n\n\tupdateMatrix() {\n\n\t\tthis.matrix.compose( this.position, this.quaternion, this.scale );\n\n\t\tthis.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldNeedsUpdate || force ) {\n\n\t\t\tif ( this.matrixWorldAutoUpdate === true ) {\n\n\t\t\t\tif ( this.parent === null ) {\n\n\t\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.matrixWorldNeedsUpdate = false;\n\n\t\t\tforce = true;\n\n\t\t}\n\n\t\t// make sure descendants are updated if required\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tconst child = children[ i ];\n\n\t\t\tchild.updateMatrixWorld( force );\n\n\t\t}\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tconst parent = this.parent;\n\n\t\tif ( updateParents === true && parent !== null ) {\n\n\t\t\tparent.updateWorldMatrix( true, false );\n\n\t\t}\n\n\t\tif ( this.matrixAutoUpdate ) this.updateMatrix();\n\n\t\tif ( this.matrixWorldAutoUpdate === true ) {\n\n\t\t\tif ( this.parent === null ) {\n\n\t\t\t\tthis.matrixWorld.copy( this.matrix );\n\n\t\t\t} else {\n\n\t\t\t\tthis.matrixWorld.multiplyMatrices( this.parent.matrixWorld, this.matrix );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// make sure descendants are updated\n\n\t\tif ( updateChildren === true ) {\n\n\t\t\tconst children = this.children;\n\n\t\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\n\t\t\t\tchild.updateWorldMatrix( false, true );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\t// meta is a string when called from JSON.stringify\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tconst output = {};\n\n\t\t// meta is a hash used to collect geometries, materials.\n\t\t// not providing it implies that this is the root object\n\t\t// being serialized.\n\t\tif ( isRootObject ) {\n\n\t\t\t// initialize meta obj\n\t\t\tmeta = {\n\t\t\t\tgeometries: {},\n\t\t\t\tmaterials: {},\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tshapes: {},\n\t\t\t\tskeletons: {},\n\t\t\t\tanimations: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t\toutput.metadata = {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Object',\n\t\t\t\tgenerator: 'Object3D.toJSON'\n\t\t\t};\n\n\t\t}\n\n\t\t// standard Object3D serialization\n\n\t\tconst object = {};\n\n\t\tobject.uuid = this.uuid;\n\t\tobject.type = this.type;\n\n\t\tif ( this.name !== '' ) object.name = this.name;\n\t\tif ( this.castShadow === true ) object.castShadow = true;\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\n\t\tif ( this.visible === false ) object.visible = false;\n\t\tif ( this.frustumCulled === false ) object.frustumCulled = false;\n\t\tif ( this.renderOrder !== 0 ) object.renderOrder = this.renderOrder;\n\t\tif ( Object.keys( this.userData ).length > 0 ) object.userData = this.userData;\n\n\t\tobject.layers = this.layers.mask;\n\t\tobject.matrix = this.matrix.toArray();\n\t\tobject.up = this.up.toArray();\n\n\t\tif ( this.matrixAutoUpdate === false ) object.matrixAutoUpdate = false;\n\n\t\t// object specific properties\n\n\t\tif ( this.isInstancedMesh ) {\n\n\t\t\tobject.type = 'InstancedMesh';\n\t\t\tobject.count = this.count;\n\t\t\tobject.instanceMatrix = this.instanceMatrix.toJSON();\n\t\t\tif ( this.instanceColor !== null ) object.instanceColor = this.instanceColor.toJSON();\n\n\t\t}\n\n\t\tif ( this.isBatchedMesh ) {\n\n\t\t\tobject.type = 'BatchedMesh';\n\t\t\tobject.perObjectFrustumCulled = this.perObjectFrustumCulled;\n\t\t\tobject.sortObjects = this.sortObjects;\n\n\t\t\tobject.drawRanges = this._drawRanges;\n\t\t\tobject.reservedRanges = this._reservedRanges;\n\n\t\t\tobject.visibility = this._visibility;\n\t\t\tobject.active = this._active;\n\t\t\tobject.bounds = this._bounds.map( bound => ( {\n\t\t\t\tboxInitialized: bound.boxInitialized,\n\t\t\t\tboxMin: bound.box.min.toArray(),\n\t\t\t\tboxMax: bound.box.max.toArray(),\n\n\t\t\t\tsphereInitialized: bound.sphereInitialized,\n\t\t\t\tsphereRadius: bound.sphere.radius,\n\t\t\t\tsphereCenter: bound.sphere.center.toArray()\n\t\t\t} ) );\n\n\t\t\tobject.maxInstanceCount = this._maxInstanceCount;\n\t\t\tobject.maxVertexCount = this._maxVertexCount;\n\t\t\tobject.maxIndexCount = this._maxIndexCount;\n\n\t\t\tobject.geometryInitialized = this._geometryInitialized;\n\t\t\tobject.geometryCount = this._geometryCount;\n\n\t\t\tobject.matricesTexture = this._matricesTexture.toJSON( meta );\n\n\t\t\tif ( this._colorsTexture !== null ) object.colorsTexture = this._colorsTexture.toJSON( meta );\n\n\t\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\t\tobject.boundingSphere = {\n\t\t\t\t\tcenter: object.boundingSphere.center.toArray(),\n\t\t\t\t\tradius: object.boundingSphere.radius\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox !== null ) {\n\n\t\t\t\tobject.boundingBox = {\n\t\t\t\t\tmin: object.boundingBox.min.toArray(),\n\t\t\t\t\tmax: object.boundingBox.max.toArray()\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tfunction serialize( library, element ) {\n\n\t\t\tif ( library[ element.uuid ] === undefined ) {\n\n\t\t\t\tlibrary[ element.uuid ] = element.toJSON( meta );\n\n\t\t\t}\n\n\t\t\treturn element.uuid;\n\n\t\t}\n\n\t\tif ( this.isScene ) {\n\n\t\t\tif ( this.background ) {\n\n\t\t\t\tif ( this.background.isColor ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON();\n\n\t\t\t\t} else if ( this.background.isTexture ) {\n\n\t\t\t\t\tobject.background = this.background.toJSON( meta ).uuid;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.environment && this.environment.isTexture && this.environment.isRenderTargetTexture !== true ) {\n\n\t\t\t\tobject.environment = this.environment.toJSON( meta ).uuid;\n\n\t\t\t}\n\n\t\t} else if ( this.isMesh || this.isLine || this.isPoints ) {\n\n\t\t\tobject.geometry = serialize( meta.geometries, this.geometry );\n\n\t\t\tconst parameters = this.geometry.parameters;\n\n\t\t\tif ( parameters !== undefined && parameters.shapes !== undefined ) {\n\n\t\t\t\tconst shapes = parameters.shapes;\n\n\t\t\t\tif ( Array.isArray( shapes ) ) {\n\n\t\t\t\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\t\t\t\tconst shape = shapes[ i ];\n\n\t\t\t\t\t\tserialize( meta.shapes, shape );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tserialize( meta.shapes, shapes );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.isSkinnedMesh ) {\n\n\t\t\tobject.bindMode = this.bindMode;\n\t\t\tobject.bindMatrix = this.bindMatrix.toArray();\n\n\t\t\tif ( this.skeleton !== undefined ) {\n\n\t\t\t\tserialize( meta.skeletons, this.skeleton );\n\n\t\t\t\tobject.skeleton = this.skeleton.uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.material !== undefined ) {\n\n\t\t\tif ( Array.isArray( this.material ) ) {\n\n\t\t\t\tconst uuids = [];\n\n\t\t\t\tfor ( let i = 0, l = this.material.length; i < l; i ++ ) {\n\n\t\t\t\t\tuuids.push( serialize( meta.materials, this.material[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\tobject.material = uuids;\n\n\t\t\t} else {\n\n\t\t\t\tobject.material = serialize( meta.materials, this.material );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.children.length > 0 ) {\n\n\t\t\tobject.children = [];\n\n\t\t\tfor ( let i = 0; i < this.children.length; i ++ ) {\n\n\t\t\t\tobject.children.push( this.children[ i ].toJSON( meta ).object );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.animations.length > 0 ) {\n\n\t\t\tobject.animations = [];\n\n\t\t\tfor ( let i = 0; i < this.animations.length; i ++ ) {\n\n\t\t\t\tconst animation = this.animations[ i ];\n\n\t\t\t\tobject.animations.push( serialize( meta.animations, animation ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst geometries = extractFromCache( meta.geometries );\n\t\t\tconst materials = extractFromCache( meta.materials );\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst shapes = extractFromCache( meta.shapes );\n\t\t\tconst skeletons = extractFromCache( meta.skeletons );\n\t\t\tconst animations = extractFromCache( meta.animations );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\n\t\t\tif ( images.length > 0 ) output.images = images;\n\t\t\tif ( shapes.length > 0 ) output.shapes = shapes;\n\t\t\tif ( skeletons.length > 0 ) output.skeletons = skeletons;\n\t\t\tif ( animations.length > 0 ) output.animations = animations;\n\t\t\tif ( nodes.length > 0 ) output.nodes = nodes;\n\n\t\t}\n\n\t\toutput.object = object;\n\n\t\treturn output;\n\n\t\t// extract data from the cache hash\n\t\t// remove metadata on each item\n\t\t// and return as array\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t}\n\n\tclone( recursive ) {\n\n\t\treturn new this.constructor().copy( this, recursive );\n\n\t}\n\n\tcopy( source, recursive = true ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.up.copy( source.up );\n\n\t\tthis.position.copy( source.position );\n\t\tthis.rotation.order = source.rotation.order;\n\t\tthis.quaternion.copy( source.quaternion );\n\t\tthis.scale.copy( source.scale );\n\n\t\tthis.matrix.copy( source.matrix );\n\t\tthis.matrixWorld.copy( source.matrixWorld );\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\tthis.matrixWorldAutoUpdate = source.matrixWorldAutoUpdate;\n\t\tthis.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n\t\tthis.layers.mask = source.layers.mask;\n\t\tthis.visible = source.visible;\n\n\t\tthis.castShadow = source.castShadow;\n\t\tthis.receiveShadow = source.receiveShadow;\n\n\t\tthis.frustumCulled = source.frustumCulled;\n\t\tthis.renderOrder = source.renderOrder;\n\n\t\tthis.animations = source.animations.slice();\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\tif ( recursive === true ) {\n\n\t\t\tfor ( let i = 0; i < source.children.length; i ++ ) {\n\n\t\t\t\tconst child = source.children[ i ];\n\t\t\t\tthis.add( child.clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nObject3D.DEFAULT_UP = /*@__PURE__*/ new Vector3( 0, 1, 0 );\nObject3D.DEFAULT_MATRIX_AUTO_UPDATE = true;\nObject3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE = true;\n\nconst _v0$1 = /*@__PURE__*/ new Vector3();\nconst _v1$3 = /*@__PURE__*/ new Vector3();\nconst _v2$2 = /*@__PURE__*/ new Vector3();\nconst _v3$2 = /*@__PURE__*/ new Vector3();\n\nconst _vab = /*@__PURE__*/ new Vector3();\nconst _vac = /*@__PURE__*/ new Vector3();\nconst _vbc = /*@__PURE__*/ new Vector3();\nconst _vap = /*@__PURE__*/ new Vector3();\nconst _vbp = /*@__PURE__*/ new Vector3();\nconst _vcp = /*@__PURE__*/ new Vector3();\n\nconst _v40 = /*@__PURE__*/ new Vector4();\nconst _v41 = /*@__PURE__*/ new Vector4();\nconst _v42 = /*@__PURE__*/ new Vector4();\n\nclass Triangle {\n\n\tconstructor( a = new Vector3(), b = new Vector3(), c = new Vector3() ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t}\n\n\tstatic getNormal( a, b, c, target ) {\n\n\t\ttarget.subVectors( c, b );\n\t\t_v0$1.subVectors( a, b );\n\t\ttarget.cross( _v0$1 );\n\n\t\tconst targetLengthSq = target.lengthSq();\n\t\tif ( targetLengthSq > 0 ) {\n\n\t\t\treturn target.multiplyScalar( 1 / Math.sqrt( targetLengthSq ) );\n\n\t\t}\n\n\t\treturn target.set( 0, 0, 0 );\n\n\t}\n\n\t// static/instance method to calculate barycentric coordinates\n\t// based on: http://www.blackpawn.com/texts/pointinpoly/default.html\n\tstatic getBarycoord( point, a, b, c, target ) {\n\n\t\t_v0$1.subVectors( c, a );\n\t\t_v1$3.subVectors( b, a );\n\t\t_v2$2.subVectors( point, a );\n\n\t\tconst dot00 = _v0$1.dot( _v0$1 );\n\t\tconst dot01 = _v0$1.dot( _v1$3 );\n\t\tconst dot02 = _v0$1.dot( _v2$2 );\n\t\tconst dot11 = _v1$3.dot( _v1$3 );\n\t\tconst dot12 = _v1$3.dot( _v2$2 );\n\n\t\tconst denom = ( dot00 * dot11 - dot01 * dot01 );\n\n\t\t// collinear or singular triangle\n\t\tif ( denom === 0 ) {\n\n\t\t\ttarget.set( 0, 0, 0 );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst invDenom = 1 / denom;\n\t\tconst u = ( dot11 * dot02 - dot01 * dot12 ) * invDenom;\n\t\tconst v = ( dot00 * dot12 - dot01 * dot02 ) * invDenom;\n\n\t\t// barycentric coordinates must always sum to 1\n\t\treturn target.set( 1 - u - v, v, u );\n\n\t}\n\n\tstatic containsPoint( point, a, b, c ) {\n\n\t\t// if the triangle is degenerate then we can't contain a point\n\t\tif ( this.getBarycoord( point, a, b, c, _v3$2 ) === null ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn ( _v3$2.x >= 0 ) && ( _v3$2.y >= 0 ) && ( ( _v3$2.x + _v3$2.y ) <= 1 );\n\n\t}\n\n\tstatic getInterpolation( point, p1, p2, p3, v1, v2, v3, target ) {\n\n\t\tif ( this.getBarycoord( point, p1, p2, p3, _v3$2 ) === null ) {\n\n\t\t\ttarget.x = 0;\n\t\t\ttarget.y = 0;\n\t\t\tif ( 'z' in target ) target.z = 0;\n\t\t\tif ( 'w' in target ) target.w = 0;\n\t\t\treturn null;\n\n\t\t}\n\n\t\ttarget.setScalar( 0 );\n\t\ttarget.addScaledVector( v1, _v3$2.x );\n\t\ttarget.addScaledVector( v2, _v3$2.y );\n\t\ttarget.addScaledVector( v3, _v3$2.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic getInterpolatedAttribute( attr, i1, i2, i3, barycoord, target ) {\n\n\t\t_v40.setScalar( 0 );\n\t\t_v41.setScalar( 0 );\n\t\t_v42.setScalar( 0 );\n\n\t\t_v40.fromBufferAttribute( attr, i1 );\n\t\t_v41.fromBufferAttribute( attr, i2 );\n\t\t_v42.fromBufferAttribute( attr, i3 );\n\n\t\ttarget.setScalar( 0 );\n\t\ttarget.addScaledVector( _v40, barycoord.x );\n\t\ttarget.addScaledVector( _v41, barycoord.y );\n\t\ttarget.addScaledVector( _v42, barycoord.z );\n\n\t\treturn target;\n\n\t}\n\n\tstatic isFrontFacing( a, b, c, direction ) {\n\n\t\t_v0$1.subVectors( c, b );\n\t\t_v1$3.subVectors( a, b );\n\n\t\t// strictly front facing\n\t\treturn ( _v0$1.cross( _v1$3 ).dot( direction ) < 0 ) ? true : false;\n\n\t}\n\n\tset( a, b, c ) {\n\n\t\tthis.a.copy( a );\n\t\tthis.b.copy( b );\n\t\tthis.c.copy( c );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPointsAndIndices( points, i0, i1, i2 ) {\n\n\t\tthis.a.copy( points[ i0 ] );\n\t\tthis.b.copy( points[ i1 ] );\n\t\tthis.c.copy( points[ i2 ] );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromAttributeAndIndices( attribute, i0, i1, i2 ) {\n\n\t\tthis.a.fromBufferAttribute( attribute, i0 );\n\t\tthis.b.fromBufferAttribute( attribute, i1 );\n\t\tthis.c.fromBufferAttribute( attribute, i2 );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( triangle ) {\n\n\t\tthis.a.copy( triangle.a );\n\t\tthis.b.copy( triangle.b );\n\t\tthis.c.copy( triangle.c );\n\n\t\treturn this;\n\n\t}\n\n\tgetArea() {\n\n\t\t_v0$1.subVectors( this.c, this.b );\n\t\t_v1$3.subVectors( this.a, this.b );\n\n\t\treturn _v0$1.cross( _v1$3 ).length() * 0.5;\n\n\t}\n\n\tgetMidpoint( target ) {\n\n\t\treturn target.addVectors( this.a, this.b ).add( this.c ).multiplyScalar( 1 / 3 );\n\n\t}\n\n\tgetNormal( target ) {\n\n\t\treturn Triangle.getNormal( this.a, this.b, this.c, target );\n\n\t}\n\n\tgetPlane( target ) {\n\n\t\treturn target.setFromCoplanarPoints( this.a, this.b, this.c );\n\n\t}\n\n\tgetBarycoord( point, target ) {\n\n\t\treturn Triangle.getBarycoord( point, this.a, this.b, this.c, target );\n\n\t}\n\n\tgetInterpolation( point, v1, v2, v3, target ) {\n\n\t\treturn Triangle.getInterpolation( point, this.a, this.b, this.c, v1, v2, v3, target );\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn Triangle.containsPoint( point, this.a, this.b, this.c );\n\n\t}\n\n\tisFrontFacing( direction ) {\n\n\t\treturn Triangle.isFrontFacing( this.a, this.b, this.c, direction );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsTriangle( this );\n\n\t}\n\n\tclosestPointToPoint( p, target ) {\n\n\t\tconst a = this.a, b = this.b, c = this.c;\n\t\tlet v, w;\n\n\t\t// algorithm thanks to Real-Time Collision Detection by Christer Ericson,\n\t\t// published by Morgan Kaufmann Publishers, (c) 2005 Elsevier Inc.,\n\t\t// under the accompanying license; see chapter 5.1.5 for detailed explanation.\n\t\t// basically, we're distinguishing which of the voronoi regions of the triangle\n\t\t// the point lies in with the minimum amount of redundant computation.\n\n\t\t_vab.subVectors( b, a );\n\t\t_vac.subVectors( c, a );\n\t\t_vap.subVectors( p, a );\n\t\tconst d1 = _vab.dot( _vap );\n\t\tconst d2 = _vac.dot( _vap );\n\t\tif ( d1 <= 0 && d2 <= 0 ) {\n\n\t\t\t// vertex region of A; barycentric coords (1, 0, 0)\n\t\t\treturn target.copy( a );\n\n\t\t}\n\n\t\t_vbp.subVectors( p, b );\n\t\tconst d3 = _vab.dot( _vbp );\n\t\tconst d4 = _vac.dot( _vbp );\n\t\tif ( d3 >= 0 && d4 <= d3 ) {\n\n\t\t\t// vertex region of B; barycentric coords (0, 1, 0)\n\t\t\treturn target.copy( b );\n\n\t\t}\n\n\t\tconst vc = d1 * d4 - d3 * d2;\n\t\tif ( vc <= 0 && d1 >= 0 && d3 <= 0 ) {\n\n\t\t\tv = d1 / ( d1 - d3 );\n\t\t\t// edge region of AB; barycentric coords (1-v, v, 0)\n\t\t\treturn target.copy( a ).addScaledVector( _vab, v );\n\n\t\t}\n\n\t\t_vcp.subVectors( p, c );\n\t\tconst d5 = _vab.dot( _vcp );\n\t\tconst d6 = _vac.dot( _vcp );\n\t\tif ( d6 >= 0 && d5 <= d6 ) {\n\n\t\t\t// vertex region of C; barycentric coords (0, 0, 1)\n\t\t\treturn target.copy( c );\n\n\t\t}\n\n\t\tconst vb = d5 * d2 - d1 * d6;\n\t\tif ( vb <= 0 && d2 >= 0 && d6 <= 0 ) {\n\n\t\t\tw = d2 / ( d2 - d6 );\n\t\t\t// edge region of AC; barycentric coords (1-w, 0, w)\n\t\t\treturn target.copy( a ).addScaledVector( _vac, w );\n\n\t\t}\n\n\t\tconst va = d3 * d6 - d5 * d4;\n\t\tif ( va <= 0 && ( d4 - d3 ) >= 0 && ( d5 - d6 ) >= 0 ) {\n\n\t\t\t_vbc.subVectors( c, b );\n\t\t\tw = ( d4 - d3 ) / ( ( d4 - d3 ) + ( d5 - d6 ) );\n\t\t\t// edge region of BC; barycentric coords (0, 1-w, w)\n\t\t\treturn target.copy( b ).addScaledVector( _vbc, w ); // edge region of BC\n\n\t\t}\n\n\t\t// face region\n\t\tconst denom = 1 / ( va + vb + vc );\n\t\t// u = va * denom\n\t\tv = vb * denom;\n\t\tw = vc * denom;\n\n\t\treturn target.copy( a ).addScaledVector( _vab, v ).addScaledVector( _vac, w );\n\n\t}\n\n\tequals( triangle ) {\n\n\t\treturn triangle.a.equals( this.a ) && triangle.b.equals( this.b ) && triangle.c.equals( this.c );\n\n\t}\n\n}\n\nconst _colorKeywords = { 'aliceblue': 0xF0F8FF, 'antiquewhite': 0xFAEBD7, 'aqua': 0x00FFFF, 'aquamarine': 0x7FFFD4, 'azure': 0xF0FFFF,\n\t'beige': 0xF5F5DC, 'bisque': 0xFFE4C4, 'black': 0x000000, 'blanchedalmond': 0xFFEBCD, 'blue': 0x0000FF, 'blueviolet': 0x8A2BE2,\n\t'brown': 0xA52A2A, 'burlywood': 0xDEB887, 'cadetblue': 0x5F9EA0, 'chartreuse': 0x7FFF00, 'chocolate': 0xD2691E, 'coral': 0xFF7F50,\n\t'cornflowerblue': 0x6495ED, 'cornsilk': 0xFFF8DC, 'crimson': 0xDC143C, 'cyan': 0x00FFFF, 'darkblue': 0x00008B, 'darkcyan': 0x008B8B,\n\t'darkgoldenrod': 0xB8860B, 'darkgray': 0xA9A9A9, 'darkgreen': 0x006400, 'darkgrey': 0xA9A9A9, 'darkkhaki': 0xBDB76B, 'darkmagenta': 0x8B008B,\n\t'darkolivegreen': 0x556B2F, 'darkorange': 0xFF8C00, 'darkorchid': 0x9932CC, 'darkred': 0x8B0000, 'darksalmon': 0xE9967A, 'darkseagreen': 0x8FBC8F,\n\t'darkslateblue': 0x483D8B, 'darkslategray': 0x2F4F4F, 'darkslategrey': 0x2F4F4F, 'darkturquoise': 0x00CED1, 'darkviolet': 0x9400D3,\n\t'deeppink': 0xFF1493, 'deepskyblue': 0x00BFFF, 'dimgray': 0x696969, 'dimgrey': 0x696969, 'dodgerblue': 0x1E90FF, 'firebrick': 0xB22222,\n\t'floralwhite': 0xFFFAF0, 'forestgreen': 0x228B22, 'fuchsia': 0xFF00FF, 'gainsboro': 0xDCDCDC, 'ghostwhite': 0xF8F8FF, 'gold': 0xFFD700,\n\t'goldenrod': 0xDAA520, 'gray': 0x808080, 'green': 0x008000, 'greenyellow': 0xADFF2F, 'grey': 0x808080, 'honeydew': 0xF0FFF0, 'hotpink': 0xFF69B4,\n\t'indianred': 0xCD5C5C, 'indigo': 0x4B0082, 'ivory': 0xFFFFF0, 'khaki': 0xF0E68C, 'lavender': 0xE6E6FA, 'lavenderblush': 0xFFF0F5, 'lawngreen': 0x7CFC00,\n\t'lemonchiffon': 0xFFFACD, 'lightblue': 0xADD8E6, 'lightcoral': 0xF08080, 'lightcyan': 0xE0FFFF, 'lightgoldenrodyellow': 0xFAFAD2, 'lightgray': 0xD3D3D3,\n\t'lightgreen': 0x90EE90, 'lightgrey': 0xD3D3D3, 'lightpink': 0xFFB6C1, 'lightsalmon': 0xFFA07A, 'lightseagreen': 0x20B2AA, 'lightskyblue': 0x87CEFA,\n\t'lightslategray': 0x778899, 'lightslategrey': 0x778899, 'lightsteelblue': 0xB0C4DE, 'lightyellow': 0xFFFFE0, 'lime': 0x00FF00, 'limegreen': 0x32CD32,\n\t'linen': 0xFAF0E6, 'magenta': 0xFF00FF, 'maroon': 0x800000, 'mediumaquamarine': 0x66CDAA, 'mediumblue': 0x0000CD, 'mediumorchid': 0xBA55D3,\n\t'mediumpurple': 0x9370DB, 'mediumseagreen': 0x3CB371, 'mediumslateblue': 0x7B68EE, 'mediumspringgreen': 0x00FA9A, 'mediumturquoise': 0x48D1CC,\n\t'mediumvioletred': 0xC71585, 'midnightblue': 0x191970, 'mintcream': 0xF5FFFA, 'mistyrose': 0xFFE4E1, 'moccasin': 0xFFE4B5, 'navajowhite': 0xFFDEAD,\n\t'navy': 0x000080, 'oldlace': 0xFDF5E6, 'olive': 0x808000, 'olivedrab': 0x6B8E23, 'orange': 0xFFA500, 'orangered': 0xFF4500, 'orchid': 0xDA70D6,\n\t'palegoldenrod': 0xEEE8AA, 'palegreen': 0x98FB98, 'paleturquoise': 0xAFEEEE, 'palevioletred': 0xDB7093, 'papayawhip': 0xFFEFD5, 'peachpuff': 0xFFDAB9,\n\t'peru': 0xCD853F, 'pink': 0xFFC0CB, 'plum': 0xDDA0DD, 'powderblue': 0xB0E0E6, 'purple': 0x800080, 'rebeccapurple': 0x663399, 'red': 0xFF0000, 'rosybrown': 0xBC8F8F,\n\t'royalblue': 0x4169E1, 'saddlebrown': 0x8B4513, 'salmon': 0xFA8072, 'sandybrown': 0xF4A460, 'seagreen': 0x2E8B57, 'seashell': 0xFFF5EE,\n\t'sienna': 0xA0522D, 'silver': 0xC0C0C0, 'skyblue': 0x87CEEB, 'slateblue': 0x6A5ACD, 'slategray': 0x708090, 'slategrey': 0x708090, 'snow': 0xFFFAFA,\n\t'springgreen': 0x00FF7F, 'steelblue': 0x4682B4, 'tan': 0xD2B48C, 'teal': 0x008080, 'thistle': 0xD8BFD8, 'tomato': 0xFF6347, 'turquoise': 0x40E0D0,\n\t'violet': 0xEE82EE, 'wheat': 0xF5DEB3, 'white': 0xFFFFFF, 'whitesmoke': 0xF5F5F5, 'yellow': 0xFFFF00, 'yellowgreen': 0x9ACD32 };\n\nconst _hslA = { h: 0, s: 0, l: 0 };\nconst _hslB = { h: 0, s: 0, l: 0 };\n\nfunction hue2rgb( p, q, t ) {\n\n\tif ( t < 0 ) t += 1;\n\tif ( t > 1 ) t -= 1;\n\tif ( t < 1 / 6 ) return p + ( q - p ) * 6 * t;\n\tif ( t < 1 / 2 ) return q;\n\tif ( t < 2 / 3 ) return p + ( q - p ) * 6 * ( 2 / 3 - t );\n\treturn p;\n\n}\n\nclass Color {\n\n\tconstructor( r, g, b ) {\n\n\t\tthis.isColor = true;\n\n\t\tthis.r = 1;\n\t\tthis.g = 1;\n\t\tthis.b = 1;\n\n\t\treturn this.set( r, g, b );\n\n\t}\n\n\tset( r, g, b ) {\n\n\t\tif ( g === undefined && b === undefined ) {\n\n\t\t\t// r is THREE.Color, hex or string\n\n\t\t\tconst value = r;\n\n\t\t\tif ( value && value.isColor ) {\n\n\t\t\t\tthis.copy( value );\n\n\t\t\t} else if ( typeof value === 'number' ) {\n\n\t\t\t\tthis.setHex( value );\n\n\t\t\t} else if ( typeof value === 'string' ) {\n\n\t\t\t\tthis.setStyle( value );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.setRGB( r, g, b );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetScalar( scalar ) {\n\n\t\tthis.r = scalar;\n\t\tthis.g = scalar;\n\t\tthis.b = scalar;\n\n\t\treturn this;\n\n\t}\n\n\tsetHex( hex, colorSpace = SRGBColorSpace ) {\n\n\t\thex = Math.floor( hex );\n\n\t\tthis.r = ( hex >> 16 & 255 ) / 255;\n\t\tthis.g = ( hex >> 8 & 255 ) / 255;\n\t\tthis.b = ( hex & 255 ) / 255;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetRGB( r, g, b, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\tthis.r = r;\n\t\tthis.g = g;\n\t\tthis.b = b;\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetHSL( h, s, l, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\t\th = euclideanModulo( h, 1 );\n\t\ts = clamp$1( s, 0, 1 );\n\t\tl = clamp$1( l, 0, 1 );\n\n\t\tif ( s === 0 ) {\n\n\t\t\tthis.r = this.g = this.b = l;\n\n\t\t} else {\n\n\t\t\tconst p = l <= 0.5 ? l * ( 1 + s ) : l + s - ( l * s );\n\t\t\tconst q = ( 2 * l ) - p;\n\n\t\t\tthis.r = hue2rgb( q, p, h + 1 / 3 );\n\t\t\tthis.g = hue2rgb( q, p, h );\n\t\t\tthis.b = hue2rgb( q, p, h - 1 / 3 );\n\n\t\t}\n\n\t\tColorManagement.toWorkingColorSpace( this, colorSpace );\n\n\t\treturn this;\n\n\t}\n\n\tsetStyle( style, colorSpace = SRGBColorSpace ) {\n\n\t\tfunction handleAlpha( string ) {\n\n\t\t\tif ( string === undefined ) return;\n\n\t\t\tif ( parseFloat( string ) < 1 ) {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Alpha component of ' + style + ' will be ignored.' );\n\n\t\t\t}\n\n\t\t}\n\n\n\t\tlet m;\n\n\t\tif ( m = /^(\\w+)\\(([^\\)]*)\\)/.exec( style ) ) {\n\n\t\t\t// rgb / hsl\n\n\t\t\tlet color;\n\t\t\tconst name = m[ 1 ];\n\t\t\tconst components = m[ 2 ];\n\n\t\t\tswitch ( name ) {\n\n\t\t\t\tcase 'rgb':\n\t\t\t\tcase 'rgba':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(255,0,0) rgba(255,0,0,0.5)\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setRGB(\n\t\t\t\t\t\t\tMath.min( 255, parseInt( color[ 1 ], 10 ) ) / 255,\n\t\t\t\t\t\t\tMath.min( 255, parseInt( color[ 2 ], 10 ) ) / 255,\n\t\t\t\t\t\t\tMath.min( 255, parseInt( color[ 3 ], 10 ) ) / 255,\n\t\t\t\t\t\t\tcolorSpace\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( color = /^\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*,\\s*(\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// rgb(100%,0%,0%) rgba(100%,0%,0%,0.5)\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setRGB(\n\t\t\t\t\t\t\tMath.min( 100, parseInt( color[ 1 ], 10 ) ) / 100,\n\t\t\t\t\t\t\tMath.min( 100, parseInt( color[ 2 ], 10 ) ) / 100,\n\t\t\t\t\t\t\tMath.min( 100, parseInt( color[ 3 ], 10 ) ) / 100,\n\t\t\t\t\t\t\tcolorSpace\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'hsl':\n\t\t\t\tcase 'hsla':\n\n\t\t\t\t\tif ( color = /^\\s*(\\d*\\.?\\d+)\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*,\\s*(\\d*\\.?\\d+)\\%\\s*(?:,\\s*(\\d*\\.?\\d+)\\s*)?$/.exec( components ) ) {\n\n\t\t\t\t\t\t// hsl(120,50%,50%) hsla(120,50%,50%,0.5)\n\n\t\t\t\t\t\thandleAlpha( color[ 4 ] );\n\n\t\t\t\t\t\treturn this.setHSL(\n\t\t\t\t\t\t\tparseFloat( color[ 1 ] ) / 360,\n\t\t\t\t\t\t\tparseFloat( color[ 2 ] ) / 100,\n\t\t\t\t\t\t\tparseFloat( color[ 3 ] ) / 100,\n\t\t\t\t\t\t\tcolorSpace\n\t\t\t\t\t\t);\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tconsole.warn( 'THREE.Color: Unknown color model ' + style );\n\n\t\t\t}\n\n\t\t} else if ( m = /^\\#([A-Fa-f\\d]+)$/.exec( style ) ) {\n\n\t\t\t// hex color\n\n\t\t\tconst hex = m[ 1 ];\n\t\t\tconst size = hex.length;\n\n\t\t\tif ( size === 3 ) {\n\n\t\t\t\t// #ff0\n\t\t\t\treturn this.setRGB(\n\t\t\t\t\tparseInt( hex.charAt( 0 ), 16 ) / 15,\n\t\t\t\t\tparseInt( hex.charAt( 1 ), 16 ) / 15,\n\t\t\t\t\tparseInt( hex.charAt( 2 ), 16 ) / 15,\n\t\t\t\t\tcolorSpace\n\t\t\t\t);\n\n\t\t\t} else if ( size === 6 ) {\n\n\t\t\t\t// #ff0000\n\t\t\t\treturn this.setHex( parseInt( hex, 16 ), colorSpace );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.Color: Invalid hex color ' + style );\n\n\t\t\t}\n\n\t\t} else if ( style && style.length > 0 ) {\n\n\t\t\treturn this.setColorName( style, colorSpace );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetColorName( style, colorSpace = SRGBColorSpace ) {\n\n\t\t// color keywords\n\t\tconst hex = _colorKeywords[ style.toLowerCase() ];\n\n\t\tif ( hex !== undefined ) {\n\n\t\t\t// red\n\t\t\tthis.setHex( hex, colorSpace );\n\n\t\t} else {\n\n\t\t\t// unknown color\n\t\t\tconsole.warn( 'THREE.Color: Unknown color ' + style );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tthis.r = color.r;\n\t\tthis.g = color.g;\n\t\tthis.b = color.b;\n\n\t\treturn this;\n\n\t}\n\n\tcopySRGBToLinear( color ) {\n\n\t\tthis.r = SRGBToLinear( color.r );\n\t\tthis.g = SRGBToLinear( color.g );\n\t\tthis.b = SRGBToLinear( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tcopyLinearToSRGB( color ) {\n\n\t\tthis.r = LinearToSRGB( color.r );\n\t\tthis.g = LinearToSRGB( color.g );\n\t\tthis.b = LinearToSRGB( color.b );\n\n\t\treturn this;\n\n\t}\n\n\tconvertSRGBToLinear() {\n\n\t\tthis.copySRGBToLinear( this );\n\n\t\treturn this;\n\n\t}\n\n\tconvertLinearToSRGB() {\n\n\t\tthis.copyLinearToSRGB( this );\n\n\t\treturn this;\n\n\t}\n\n\tgetHex( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\treturn Math.round( clamp$1( _color.r * 255, 0, 255 ) ) * 65536 + Math.round( clamp$1( _color.g * 255, 0, 255 ) ) * 256 + Math.round( clamp$1( _color.b * 255, 0, 255 ) );\n\n\t}\n\n\tgetHexString( colorSpace = SRGBColorSpace ) {\n\n\t\treturn ( '000000' + this.getHex( colorSpace ).toString( 16 ) ).slice( - 6 );\n\n\t}\n\n\tgetHSL( target, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\t// h,s,l ranges are in 0.0 - 1.0\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\tconst r = _color.r, g = _color.g, b = _color.b;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\n\t\tlet hue, saturation;\n\t\tconst lightness = ( min + max ) / 2.0;\n\n\t\tif ( min === max ) {\n\n\t\t\thue = 0;\n\t\t\tsaturation = 0;\n\n\t\t} else {\n\n\t\t\tconst delta = max - min;\n\n\t\t\tsaturation = lightness <= 0.5 ? delta / ( max + min ) : delta / ( 2 - max - min );\n\n\t\t\tswitch ( max ) {\n\n\t\t\t\tcase r: hue = ( g - b ) / delta + ( g < b ? 6 : 0 ); break;\n\t\t\t\tcase g: hue = ( b - r ) / delta + 2; break;\n\t\t\t\tcase b: hue = ( r - g ) / delta + 4; break;\n\n\t\t\t}\n\n\t\t\thue /= 6;\n\n\t\t}\n\n\t\ttarget.h = hue;\n\t\ttarget.s = saturation;\n\t\ttarget.l = lightness;\n\n\t\treturn target;\n\n\t}\n\n\tgetRGB( target, colorSpace = ColorManagement.workingColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\ttarget.r = _color.r;\n\t\ttarget.g = _color.g;\n\t\ttarget.b = _color.b;\n\n\t\treturn target;\n\n\t}\n\n\tgetStyle( colorSpace = SRGBColorSpace ) {\n\n\t\tColorManagement.fromWorkingColorSpace( _color.copy( this ), colorSpace );\n\n\t\tconst r = _color.r, g = _color.g, b = _color.b;\n\n\t\tif ( colorSpace !== SRGBColorSpace ) {\n\n\t\t\t// Requires CSS Color Module Level 4 (https://www.w3.org/TR/css-color-4/).\n\t\t\treturn `color(${ colorSpace } ${ r.toFixed( 3 ) } ${ g.toFixed( 3 ) } ${ b.toFixed( 3 ) })`;\n\n\t\t}\n\n\t\treturn `rgb(${ Math.round( r * 255 ) },${ Math.round( g * 255 ) },${ Math.round( b * 255 ) })`;\n\n\t}\n\n\toffsetHSL( h, s, l ) {\n\n\t\tthis.getHSL( _hslA );\n\n\t\treturn this.setHSL( _hslA.h + h, _hslA.s + s, _hslA.l + l );\n\n\t}\n\n\tadd( color ) {\n\n\t\tthis.r += color.r;\n\t\tthis.g += color.g;\n\t\tthis.b += color.b;\n\n\t\treturn this;\n\n\t}\n\n\taddColors( color1, color2 ) {\n\n\t\tthis.r = color1.r + color2.r;\n\t\tthis.g = color1.g + color2.g;\n\t\tthis.b = color1.b + color2.b;\n\n\t\treturn this;\n\n\t}\n\n\taddScalar( s ) {\n\n\t\tthis.r += s;\n\t\tthis.g += s;\n\t\tthis.b += s;\n\n\t\treturn this;\n\n\t}\n\n\tsub( color ) {\n\n\t\tthis.r = Math.max( 0, this.r - color.r );\n\t\tthis.g = Math.max( 0, this.g - color.g );\n\t\tthis.b = Math.max( 0, this.b - color.b );\n\n\t\treturn this;\n\n\t}\n\n\tmultiply( color ) {\n\n\t\tthis.r *= color.r;\n\t\tthis.g *= color.g;\n\t\tthis.b *= color.b;\n\n\t\treturn this;\n\n\t}\n\n\tmultiplyScalar( s ) {\n\n\t\tthis.r *= s;\n\t\tthis.g *= s;\n\t\tthis.b *= s;\n\n\t\treturn this;\n\n\t}\n\n\tlerp( color, alpha ) {\n\n\t\tthis.r += ( color.r - this.r ) * alpha;\n\t\tthis.g += ( color.g - this.g ) * alpha;\n\t\tthis.b += ( color.b - this.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpColors( color1, color2, alpha ) {\n\n\t\tthis.r = color1.r + ( color2.r - color1.r ) * alpha;\n\t\tthis.g = color1.g + ( color2.g - color1.g ) * alpha;\n\t\tthis.b = color1.b + ( color2.b - color1.b ) * alpha;\n\n\t\treturn this;\n\n\t}\n\n\tlerpHSL( color, alpha ) {\n\n\t\tthis.getHSL( _hslA );\n\t\tcolor.getHSL( _hslB );\n\n\t\tconst h = lerp( _hslA.h, _hslB.h, alpha );\n\t\tconst s = lerp( _hslA.s, _hslB.s, alpha );\n\t\tconst l = lerp( _hslA.l, _hslB.l, alpha );\n\n\t\tthis.setHSL( h, s, l );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\tthis.r = v.x;\n\t\tthis.g = v.y;\n\t\tthis.b = v.z;\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tconst r = this.r, g = this.g, b = this.b;\n\t\tconst e = m.elements;\n\n\t\tthis.r = e[ 0 ] * r + e[ 3 ] * g + e[ 6 ] * b;\n\t\tthis.g = e[ 1 ] * r + e[ 4 ] * g + e[ 7 ] * b;\n\t\tthis.b = e[ 2 ] * r + e[ 5 ] * g + e[ 8 ] * b;\n\n\t\treturn this;\n\n\t}\n\n\tequals( c ) {\n\n\t\treturn ( c.r === this.r ) && ( c.g === this.g ) && ( c.b === this.b );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tthis.r = array[ offset ];\n\t\tthis.g = array[ offset + 1 ];\n\t\tthis.b = array[ offset + 2 ];\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tarray[ offset ] = this.r;\n\t\tarray[ offset + 1 ] = this.g;\n\t\tarray[ offset + 2 ] = this.b;\n\n\t\treturn array;\n\n\t}\n\n\tfromBufferAttribute( attribute, index ) {\n\n\t\tthis.r = attribute.getX( index );\n\t\tthis.g = attribute.getY( index );\n\t\tthis.b = attribute.getZ( index );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.getHex();\n\n\t}\n\n\t*[ Symbol.iterator ]() {\n\n\t\tyield this.r;\n\t\tyield this.g;\n\t\tyield this.b;\n\n\t}\n\n}\n\nconst _color = /*@__PURE__*/ new Color();\n\nColor.NAMES = _colorKeywords;\n\nlet _materialId = 0;\n\nclass Material extends EventDispatcher {\n\n\tstatic get type() {\n\n\t\treturn 'Material';\n\n\t}\n\n\tget type() {\n\n\t\treturn this.constructor.type;\n\n\t}\n\n\tset type( _value ) { /* */ }\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isMaterial = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _materialId ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\n\t\tthis.blending = NormalBlending;\n\t\tthis.side = FrontSide;\n\t\tthis.vertexColors = false;\n\n\t\tthis.opacity = 1;\n\t\tthis.transparent = false;\n\t\tthis.alphaHash = false;\n\n\t\tthis.blendSrc = SrcAlphaFactor;\n\t\tthis.blendDst = OneMinusSrcAlphaFactor;\n\t\tthis.blendEquation = AddEquation;\n\t\tthis.blendSrcAlpha = null;\n\t\tthis.blendDstAlpha = null;\n\t\tthis.blendEquationAlpha = null;\n\t\tthis.blendColor = new Color( 0, 0, 0 );\n\t\tthis.blendAlpha = 0;\n\n\t\tthis.depthFunc = LessEqualDepth;\n\t\tthis.depthTest = true;\n\t\tthis.depthWrite = true;\n\n\t\tthis.stencilWriteMask = 0xff;\n\t\tthis.stencilFunc = AlwaysStencilFunc;\n\t\tthis.stencilRef = 0;\n\t\tthis.stencilFuncMask = 0xff;\n\t\tthis.stencilFail = KeepStencilOp;\n\t\tthis.stencilZFail = KeepStencilOp;\n\t\tthis.stencilZPass = KeepStencilOp;\n\t\tthis.stencilWrite = false;\n\n\t\tthis.clippingPlanes = null;\n\t\tthis.clipIntersection = false;\n\t\tthis.clipShadows = false;\n\n\t\tthis.shadowSide = null;\n\n\t\tthis.colorWrite = true;\n\n\t\tthis.precision = null; // override the renderer's default precision for this material\n\n\t\tthis.polygonOffset = false;\n\t\tthis.polygonOffsetFactor = 0;\n\t\tthis.polygonOffsetUnits = 0;\n\n\t\tthis.dithering = false;\n\n\t\tthis.alphaToCoverage = false;\n\t\tthis.premultipliedAlpha = false;\n\t\tthis.forceSinglePass = false;\n\n\t\tthis.visible = true;\n\n\t\tthis.toneMapped = true;\n\n\t\tthis.userData = {};\n\n\t\tthis.version = 0;\n\n\t\tthis._alphaTest = 0;\n\n\t}\n\n\tget alphaTest() {\n\n\t\treturn this._alphaTest;\n\n\t}\n\n\tset alphaTest( value ) {\n\n\t\tif ( this._alphaTest > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._alphaTest = value;\n\n\t}\n\n\t// onBeforeRender and onBeforeCompile only supported in WebGLRenderer\n\n\tonBeforeRender( /* renderer, scene, camera, geometry, object, group */ ) {}\n\n\tonBeforeCompile( /* shaderobject, renderer */ ) {}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.onBeforeCompile.toString();\n\n\t}\n\n\tsetValues( values ) {\n\n\t\tif ( values === undefined ) return;\n\n\t\tfor ( const key in values ) {\n\n\t\t\tconst newValue = values[ key ];\n\n\t\t\tif ( newValue === undefined ) {\n\n\t\t\t\tconsole.warn( `THREE.Material: parameter '${ key }' has value of undefined.` );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValue = this[ key ];\n\n\t\t\tif ( currentValue === undefined ) {\n\n\t\t\t\tconsole.warn( `THREE.Material: '${ key }' is not a property of THREE.${ this.type }.` );\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif ( currentValue && currentValue.isColor ) {\n\n\t\t\t\tcurrentValue.set( newValue );\n\n\t\t\t} else if ( ( currentValue && currentValue.isVector3 ) && ( newValue && newValue.isVector3 ) ) {\n\n\t\t\t\tcurrentValue.copy( newValue );\n\n\t\t\t} else {\n\n\t\t\t\tthis[ key ] = newValue;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRootObject = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRootObject ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Material',\n\t\t\t\tgenerator: 'Material.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard Material serialization\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\n\t\tif ( this.color && this.color.isColor ) data.color = this.color.getHex();\n\n\t\tif ( this.roughness !== undefined ) data.roughness = this.roughness;\n\t\tif ( this.metalness !== undefined ) data.metalness = this.metalness;\n\n\t\tif ( this.sheen !== undefined ) data.sheen = this.sheen;\n\t\tif ( this.sheenColor && this.sheenColor.isColor ) data.sheenColor = this.sheenColor.getHex();\n\t\tif ( this.sheenRoughness !== undefined ) data.sheenRoughness = this.sheenRoughness;\n\t\tif ( this.emissive && this.emissive.isColor ) data.emissive = this.emissive.getHex();\n\t\tif ( this.emissiveIntensity !== undefined && this.emissiveIntensity !== 1 ) data.emissiveIntensity = this.emissiveIntensity;\n\n\t\tif ( this.specular && this.specular.isColor ) data.specular = this.specular.getHex();\n\t\tif ( this.specularIntensity !== undefined ) data.specularIntensity = this.specularIntensity;\n\t\tif ( this.specularColor && this.specularColor.isColor ) data.specularColor = this.specularColor.getHex();\n\t\tif ( this.shininess !== undefined ) data.shininess = this.shininess;\n\t\tif ( this.clearcoat !== undefined ) data.clearcoat = this.clearcoat;\n\t\tif ( this.clearcoatRoughness !== undefined ) data.clearcoatRoughness = this.clearcoatRoughness;\n\n\t\tif ( this.clearcoatMap && this.clearcoatMap.isTexture ) {\n\n\t\t\tdata.clearcoatMap = this.clearcoatMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture ) {\n\n\t\t\tdata.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture ) {\n\n\t\t\tdata.clearcoatNormalMap = this.clearcoatNormalMap.toJSON( meta ).uuid;\n\t\t\tdata.clearcoatNormalScale = this.clearcoatNormalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.dispersion !== undefined ) data.dispersion = this.dispersion;\n\n\t\tif ( this.iridescence !== undefined ) data.iridescence = this.iridescence;\n\t\tif ( this.iridescenceIOR !== undefined ) data.iridescenceIOR = this.iridescenceIOR;\n\t\tif ( this.iridescenceThicknessRange !== undefined ) data.iridescenceThicknessRange = this.iridescenceThicknessRange;\n\n\t\tif ( this.iridescenceMap && this.iridescenceMap.isTexture ) {\n\n\t\t\tdata.iridescenceMap = this.iridescenceMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.iridescenceThicknessMap && this.iridescenceThicknessMap.isTexture ) {\n\n\t\t\tdata.iridescenceThicknessMap = this.iridescenceThicknessMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.anisotropy !== undefined ) data.anisotropy = this.anisotropy;\n\t\tif ( this.anisotropyRotation !== undefined ) data.anisotropyRotation = this.anisotropyRotation;\n\n\t\tif ( this.anisotropyMap && this.anisotropyMap.isTexture ) {\n\n\t\t\tdata.anisotropyMap = this.anisotropyMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.map && this.map.isTexture ) data.map = this.map.toJSON( meta ).uuid;\n\t\tif ( this.matcap && this.matcap.isTexture ) data.matcap = this.matcap.toJSON( meta ).uuid;\n\t\tif ( this.alphaMap && this.alphaMap.isTexture ) data.alphaMap = this.alphaMap.toJSON( meta ).uuid;\n\n\t\tif ( this.lightMap && this.lightMap.isTexture ) {\n\n\t\t\tdata.lightMap = this.lightMap.toJSON( meta ).uuid;\n\t\t\tdata.lightMapIntensity = this.lightMapIntensity;\n\n\t\t}\n\n\t\tif ( this.aoMap && this.aoMap.isTexture ) {\n\n\t\t\tdata.aoMap = this.aoMap.toJSON( meta ).uuid;\n\t\t\tdata.aoMapIntensity = this.aoMapIntensity;\n\n\t\t}\n\n\t\tif ( this.bumpMap && this.bumpMap.isTexture ) {\n\n\t\t\tdata.bumpMap = this.bumpMap.toJSON( meta ).uuid;\n\t\t\tdata.bumpScale = this.bumpScale;\n\n\t\t}\n\n\t\tif ( this.normalMap && this.normalMap.isTexture ) {\n\n\t\t\tdata.normalMap = this.normalMap.toJSON( meta ).uuid;\n\t\t\tdata.normalMapType = this.normalMapType;\n\t\t\tdata.normalScale = this.normalScale.toArray();\n\n\t\t}\n\n\t\tif ( this.displacementMap && this.displacementMap.isTexture ) {\n\n\t\t\tdata.displacementMap = this.displacementMap.toJSON( meta ).uuid;\n\t\t\tdata.displacementScale = this.displacementScale;\n\t\t\tdata.displacementBias = this.displacementBias;\n\n\t\t}\n\n\t\tif ( this.roughnessMap && this.roughnessMap.isTexture ) data.roughnessMap = this.roughnessMap.toJSON( meta ).uuid;\n\t\tif ( this.metalnessMap && this.metalnessMap.isTexture ) data.metalnessMap = this.metalnessMap.toJSON( meta ).uuid;\n\n\t\tif ( this.emissiveMap && this.emissiveMap.isTexture ) data.emissiveMap = this.emissiveMap.toJSON( meta ).uuid;\n\t\tif ( this.specularMap && this.specularMap.isTexture ) data.specularMap = this.specularMap.toJSON( meta ).uuid;\n\t\tif ( this.specularIntensityMap && this.specularIntensityMap.isTexture ) data.specularIntensityMap = this.specularIntensityMap.toJSON( meta ).uuid;\n\t\tif ( this.specularColorMap && this.specularColorMap.isTexture ) data.specularColorMap = this.specularColorMap.toJSON( meta ).uuid;\n\n\t\tif ( this.envMap && this.envMap.isTexture ) {\n\n\t\t\tdata.envMap = this.envMap.toJSON( meta ).uuid;\n\n\t\t\tif ( this.combine !== undefined ) data.combine = this.combine;\n\n\t\t}\n\n\t\tif ( this.envMapRotation !== undefined ) data.envMapRotation = this.envMapRotation.toArray();\n\t\tif ( this.envMapIntensity !== undefined ) data.envMapIntensity = this.envMapIntensity;\n\t\tif ( this.reflectivity !== undefined ) data.reflectivity = this.reflectivity;\n\t\tif ( this.refractionRatio !== undefined ) data.refractionRatio = this.refractionRatio;\n\n\t\tif ( this.gradientMap && this.gradientMap.isTexture ) {\n\n\t\t\tdata.gradientMap = this.gradientMap.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\tif ( this.transmission !== undefined ) data.transmission = this.transmission;\n\t\tif ( this.transmissionMap && this.transmissionMap.isTexture ) data.transmissionMap = this.transmissionMap.toJSON( meta ).uuid;\n\t\tif ( this.thickness !== undefined ) data.thickness = this.thickness;\n\t\tif ( this.thicknessMap && this.thicknessMap.isTexture ) data.thicknessMap = this.thicknessMap.toJSON( meta ).uuid;\n\t\tif ( this.attenuationDistance !== undefined && this.attenuationDistance !== Infinity ) data.attenuationDistance = this.attenuationDistance;\n\t\tif ( this.attenuationColor !== undefined ) data.attenuationColor = this.attenuationColor.getHex();\n\n\t\tif ( this.size !== undefined ) data.size = this.size;\n\t\tif ( this.shadowSide !== null ) data.shadowSide = this.shadowSide;\n\t\tif ( this.sizeAttenuation !== undefined ) data.sizeAttenuation = this.sizeAttenuation;\n\n\t\tif ( this.blending !== NormalBlending ) data.blending = this.blending;\n\t\tif ( this.side !== FrontSide ) data.side = this.side;\n\t\tif ( this.vertexColors === true ) data.vertexColors = true;\n\n\t\tif ( this.opacity < 1 ) data.opacity = this.opacity;\n\t\tif ( this.transparent === true ) data.transparent = true;\n\n\t\tif ( this.blendSrc !== SrcAlphaFactor ) data.blendSrc = this.blendSrc;\n\t\tif ( this.blendDst !== OneMinusSrcAlphaFactor ) data.blendDst = this.blendDst;\n\t\tif ( this.blendEquation !== AddEquation ) data.blendEquation = this.blendEquation;\n\t\tif ( this.blendSrcAlpha !== null ) data.blendSrcAlpha = this.blendSrcAlpha;\n\t\tif ( this.blendDstAlpha !== null ) data.blendDstAlpha = this.blendDstAlpha;\n\t\tif ( this.blendEquationAlpha !== null ) data.blendEquationAlpha = this.blendEquationAlpha;\n\t\tif ( this.blendColor && this.blendColor.isColor ) data.blendColor = this.blendColor.getHex();\n\t\tif ( this.blendAlpha !== 0 ) data.blendAlpha = this.blendAlpha;\n\n\t\tif ( this.depthFunc !== LessEqualDepth ) data.depthFunc = this.depthFunc;\n\t\tif ( this.depthTest === false ) data.depthTest = this.depthTest;\n\t\tif ( this.depthWrite === false ) data.depthWrite = this.depthWrite;\n\t\tif ( this.colorWrite === false ) data.colorWrite = this.colorWrite;\n\n\t\tif ( this.stencilWriteMask !== 0xff ) data.stencilWriteMask = this.stencilWriteMask;\n\t\tif ( this.stencilFunc !== AlwaysStencilFunc ) data.stencilFunc = this.stencilFunc;\n\t\tif ( this.stencilRef !== 0 ) data.stencilRef = this.stencilRef;\n\t\tif ( this.stencilFuncMask !== 0xff ) data.stencilFuncMask = this.stencilFuncMask;\n\t\tif ( this.stencilFail !== KeepStencilOp ) data.stencilFail = this.stencilFail;\n\t\tif ( this.stencilZFail !== KeepStencilOp ) data.stencilZFail = this.stencilZFail;\n\t\tif ( this.stencilZPass !== KeepStencilOp ) data.stencilZPass = this.stencilZPass;\n\t\tif ( this.stencilWrite === true ) data.stencilWrite = this.stencilWrite;\n\n\t\t// rotation (SpriteMaterial)\n\t\tif ( this.rotation !== undefined && this.rotation !== 0 ) data.rotation = this.rotation;\n\n\t\tif ( this.polygonOffset === true ) data.polygonOffset = true;\n\t\tif ( this.polygonOffsetFactor !== 0 ) data.polygonOffsetFactor = this.polygonOffsetFactor;\n\t\tif ( this.polygonOffsetUnits !== 0 ) data.polygonOffsetUnits = this.polygonOffsetUnits;\n\n\t\tif ( this.linewidth !== undefined && this.linewidth !== 1 ) data.linewidth = this.linewidth;\n\t\tif ( this.dashSize !== undefined ) data.dashSize = this.dashSize;\n\t\tif ( this.gapSize !== undefined ) data.gapSize = this.gapSize;\n\t\tif ( this.scale !== undefined ) data.scale = this.scale;\n\n\t\tif ( this.dithering === true ) data.dithering = true;\n\n\t\tif ( this.alphaTest > 0 ) data.alphaTest = this.alphaTest;\n\t\tif ( this.alphaHash === true ) data.alphaHash = true;\n\t\tif ( this.alphaToCoverage === true ) data.alphaToCoverage = true;\n\t\tif ( this.premultipliedAlpha === true ) data.premultipliedAlpha = true;\n\t\tif ( this.forceSinglePass === true ) data.forceSinglePass = true;\n\n\t\tif ( this.wireframe === true ) data.wireframe = true;\n\t\tif ( this.wireframeLinewidth > 1 ) data.wireframeLinewidth = this.wireframeLinewidth;\n\t\tif ( this.wireframeLinecap !== 'round' ) data.wireframeLinecap = this.wireframeLinecap;\n\t\tif ( this.wireframeLinejoin !== 'round' ) data.wireframeLinejoin = this.wireframeLinejoin;\n\n\t\tif ( this.flatShading === true ) data.flatShading = true;\n\n\t\tif ( this.visible === false ) data.visible = false;\n\n\t\tif ( this.toneMapped === false ) data.toneMapped = false;\n\n\t\tif ( this.fog === false ) data.fog = false;\n\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRootObject ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\n\t\tthis.blending = source.blending;\n\t\tthis.side = source.side;\n\t\tthis.vertexColors = source.vertexColors;\n\n\t\tthis.opacity = source.opacity;\n\t\tthis.transparent = source.transparent;\n\n\t\tthis.blendSrc = source.blendSrc;\n\t\tthis.blendDst = source.blendDst;\n\t\tthis.blendEquation = source.blendEquation;\n\t\tthis.blendSrcAlpha = source.blendSrcAlpha;\n\t\tthis.blendDstAlpha = source.blendDstAlpha;\n\t\tthis.blendEquationAlpha = source.blendEquationAlpha;\n\t\tthis.blendColor.copy( source.blendColor );\n\t\tthis.blendAlpha = source.blendAlpha;\n\n\t\tthis.depthFunc = source.depthFunc;\n\t\tthis.depthTest = source.depthTest;\n\t\tthis.depthWrite = source.depthWrite;\n\n\t\tthis.stencilWriteMask = source.stencilWriteMask;\n\t\tthis.stencilFunc = source.stencilFunc;\n\t\tthis.stencilRef = source.stencilRef;\n\t\tthis.stencilFuncMask = source.stencilFuncMask;\n\t\tthis.stencilFail = source.stencilFail;\n\t\tthis.stencilZFail = source.stencilZFail;\n\t\tthis.stencilZPass = source.stencilZPass;\n\t\tthis.stencilWrite = source.stencilWrite;\n\n\t\tconst srcPlanes = source.clippingPlanes;\n\t\tlet dstPlanes = null;\n\n\t\tif ( srcPlanes !== null ) {\n\n\t\t\tconst n = srcPlanes.length;\n\t\t\tdstPlanes = new Array( n );\n\n\t\t\tfor ( let i = 0; i !== n; ++ i ) {\n\n\t\t\t\tdstPlanes[ i ] = srcPlanes[ i ].clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.clippingPlanes = dstPlanes;\n\t\tthis.clipIntersection = source.clipIntersection;\n\t\tthis.clipShadows = source.clipShadows;\n\n\t\tthis.shadowSide = source.shadowSide;\n\n\t\tthis.colorWrite = source.colorWrite;\n\n\t\tthis.precision = source.precision;\n\n\t\tthis.polygonOffset = source.polygonOffset;\n\t\tthis.polygonOffsetFactor = source.polygonOffsetFactor;\n\t\tthis.polygonOffsetUnits = source.polygonOffsetUnits;\n\n\t\tthis.dithering = source.dithering;\n\n\t\tthis.alphaTest = source.alphaTest;\n\t\tthis.alphaHash = source.alphaHash;\n\t\tthis.alphaToCoverage = source.alphaToCoverage;\n\t\tthis.premultipliedAlpha = source.premultipliedAlpha;\n\t\tthis.forceSinglePass = source.forceSinglePass;\n\n\t\tthis.visible = source.visible;\n\n\t\tthis.toneMapped = source.toneMapped;\n\n\t\tthis.userData = JSON.parse( JSON.stringify( source.userData ) );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tonBuild( /* shaderobject, renderer */ ) {\n\n\t\tconsole.warn( 'Material: onBuild() has been removed.' ); // @deprecated, r166\n\n\t}\n\n}\n\nclass MeshBasicMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshBasicMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshBasicMaterial = true;\n\n\t\tthis.color = new Color( 0xffffff ); // emissive\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\n// Fast Half Float Conversions, http://www.fox-toolkit.org/ftp/fasthalffloatconversion.pdf\n\nconst _tables = /*@__PURE__*/ _generateTables();\n\nfunction _generateTables() {\n\n\t// float32 to float16 helpers\n\n\tconst buffer = new ArrayBuffer( 4 );\n\tconst floatView = new Float32Array( buffer );\n\tconst uint32View = new Uint32Array( buffer );\n\n\tconst baseTable = new Uint32Array( 512 );\n\tconst shiftTable = new Uint32Array( 512 );\n\n\tfor ( let i = 0; i < 256; ++ i ) {\n\n\t\tconst e = i - 127;\n\n\t\t// very small number (0, -0)\n\n\t\tif ( e < - 27 ) {\n\n\t\t\tbaseTable[ i ] = 0x0000;\n\t\t\tbaseTable[ i | 0x100 ] = 0x8000;\n\t\t\tshiftTable[ i ] = 24;\n\t\t\tshiftTable[ i | 0x100 ] = 24;\n\n\t\t\t// small number (denorm)\n\n\t\t} else if ( e < - 14 ) {\n\n\t\t\tbaseTable[ i ] = 0x0400 >> ( - e - 14 );\n\t\t\tbaseTable[ i | 0x100 ] = ( 0x0400 >> ( - e - 14 ) ) | 0x8000;\n\t\t\tshiftTable[ i ] = - e - 1;\n\t\t\tshiftTable[ i | 0x100 ] = - e - 1;\n\n\t\t\t// normal number\n\n\t\t} else if ( e <= 15 ) {\n\n\t\t\tbaseTable[ i ] = ( e + 15 ) << 10;\n\t\t\tbaseTable[ i | 0x100 ] = ( ( e + 15 ) << 10 ) | 0x8000;\n\t\t\tshiftTable[ i ] = 13;\n\t\t\tshiftTable[ i | 0x100 ] = 13;\n\n\t\t\t// large number (Infinity, -Infinity)\n\n\t\t} else if ( e < 128 ) {\n\n\t\t\tbaseTable[ i ] = 0x7c00;\n\t\t\tbaseTable[ i | 0x100 ] = 0xfc00;\n\t\t\tshiftTable[ i ] = 24;\n\t\t\tshiftTable[ i | 0x100 ] = 24;\n\n\t\t\t// stay (NaN, Infinity, -Infinity)\n\n\t\t} else {\n\n\t\t\tbaseTable[ i ] = 0x7c00;\n\t\t\tbaseTable[ i | 0x100 ] = 0xfc00;\n\t\t\tshiftTable[ i ] = 13;\n\t\t\tshiftTable[ i | 0x100 ] = 13;\n\n\t\t}\n\n\t}\n\n\t// float16 to float32 helpers\n\n\tconst mantissaTable = new Uint32Array( 2048 );\n\tconst exponentTable = new Uint32Array( 64 );\n\tconst offsetTable = new Uint32Array( 64 );\n\n\tfor ( let i = 1; i < 1024; ++ i ) {\n\n\t\tlet m = i << 13; // zero pad mantissa bits\n\t\tlet e = 0; // zero exponent\n\n\t\t// normalized\n\t\twhile ( ( m & 0x00800000 ) === 0 ) {\n\n\t\t\tm <<= 1;\n\t\t\te -= 0x00800000; // decrement exponent\n\n\t\t}\n\n\t\tm &= ~ 0x00800000; // clear leading 1 bit\n\t\te += 0x38800000; // adjust bias\n\n\t\tmantissaTable[ i ] = m | e;\n\n\t}\n\n\tfor ( let i = 1024; i < 2048; ++ i ) {\n\n\t\tmantissaTable[ i ] = 0x38000000 + ( ( i - 1024 ) << 13 );\n\n\t}\n\n\tfor ( let i = 1; i < 31; ++ i ) {\n\n\t\texponentTable[ i ] = i << 23;\n\n\t}\n\n\texponentTable[ 31 ] = 0x47800000;\n\texponentTable[ 32 ] = 0x80000000;\n\n\tfor ( let i = 33; i < 63; ++ i ) {\n\n\t\texponentTable[ i ] = 0x80000000 + ( ( i - 32 ) << 23 );\n\n\t}\n\n\texponentTable[ 63 ] = 0xc7800000;\n\n\tfor ( let i = 1; i < 64; ++ i ) {\n\n\t\tif ( i !== 32 ) {\n\n\t\t\toffsetTable[ i ] = 1024;\n\n\t\t}\n\n\t}\n\n\treturn {\n\t\tfloatView: floatView,\n\t\tuint32View: uint32View,\n\t\tbaseTable: baseTable,\n\t\tshiftTable: shiftTable,\n\t\tmantissaTable: mantissaTable,\n\t\texponentTable: exponentTable,\n\t\toffsetTable: offsetTable\n\t};\n\n}\n\n// float32 to float16\n\nfunction toHalfFloat( val ) {\n\n\tif ( Math.abs( val ) > 65504 ) console.warn( 'THREE.DataUtils.toHalfFloat(): Value out of range.' );\n\n\tval = clamp$1( val, - 65504, 65504 );\n\n\t_tables.floatView[ 0 ] = val;\n\tconst f = _tables.uint32View[ 0 ];\n\tconst e = ( f >> 23 ) & 0x1ff;\n\treturn _tables.baseTable[ e ] + ( ( f & 0x007fffff ) >> _tables.shiftTable[ e ] );\n\n}\n\n// float16 to float32\n\nfunction fromHalfFloat( val ) {\n\n\tconst m = val >> 10;\n\t_tables.uint32View[ 0 ] = _tables.mantissaTable[ _tables.offsetTable[ m ] + ( val & 0x3ff ) ] + _tables.exponentTable[ m ];\n\treturn _tables.floatView[ 0 ];\n\n}\n\nconst DataUtils = {\n\ttoHalfFloat: toHalfFloat,\n\tfromHalfFloat: fromHalfFloat,\n};\n\nconst _vector$9 = /*@__PURE__*/ new Vector3();\nconst _vector2$1 = /*@__PURE__*/ new Vector2();\n\nclass BufferAttribute {\n\n\tconstructor( array, itemSize, normalized = false ) {\n\n\t\tif ( Array.isArray( array ) ) {\n\n\t\t\tthrow new TypeError( 'THREE.BufferAttribute: array should be a Typed Array.' );\n\n\t\t}\n\n\t\tthis.isBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.array = array;\n\t\tthis.itemSize = itemSize;\n\t\tthis.count = array !== undefined ? array.length / itemSize : 0;\n\t\tthis.normalized = normalized;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRanges = [];\n\t\tthis.gpuType = FloatType;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\taddUpdateRange( start, count ) {\n\n\t\tthis.updateRanges.push( { start, count } );\n\n\t}\n\n\tclearUpdateRanges() {\n\n\t\tthis.updateRanges.length = 0;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.itemSize = source.itemSize;\n\t\tthis.count = source.count;\n\t\tthis.normalized = source.normalized;\n\n\t\tthis.usage = source.usage;\n\t\tthis.gpuType = source.gpuType;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.itemSize;\n\t\tindex2 *= attribute.itemSize;\n\n\t\tfor ( let i = 0, l = this.itemSize; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcopyArray( array ) {\n\n\t\tthis.array.set( array );\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix3( m ) {\n\n\t\tif ( this.itemSize === 2 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector2$1.fromBufferAttribute( this, i );\n\t\t\t\t_vector2$1.applyMatrix3( m );\n\n\t\t\t\tthis.setXY( i, _vector2$1.x, _vector2$1.y );\n\n\t\t\t}\n\n\t\t} else if ( this.itemSize === 3 ) {\n\n\t\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t\t_vector$9.fromBufferAttribute( this, i );\n\t\t\t\t_vector$9.applyMatrix3( m );\n\n\t\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$9.fromBufferAttribute( this, i );\n\n\t\t\t_vector$9.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$9.x, _vector$9.y, _vector$9.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\t// Matching BufferAttribute constructor, do not normalize the array.\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index, component ) {\n\n\t\tlet value = this.array[ index * this.itemSize + component ];\n\n\t\tif ( this.normalized ) value = denormalize( value, this.array );\n\n\t\treturn value;\n\n\t}\n\n\tsetComponent( index, component, value ) {\n\n\t\tif ( this.normalized ) value = normalize$1( value, this.array );\n\n\t\tthis.array[ index * this.itemSize + component ] = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = this.array[ index * this.itemSize ];\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize$1( x, this.array );\n\n\t\tthis.array[ index * this.itemSize ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = this.array[ index * this.itemSize + 1 ];\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize$1( y, this.array );\n\n\t\tthis.array[ index * this.itemSize + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = this.array[ index * this.itemSize + 2 ];\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize$1( z, this.array );\n\n\t\tthis.array[ index * this.itemSize + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = this.array[ index * this.itemSize + 3 ];\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize$1( w, this.array );\n\n\t\tthis.array[ index * this.itemSize + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\t\t\tz = normalize$1( z, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\t\t\tz = normalize$1( z, this.array );\n\t\t\tw = normalize$1( w, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = x;\n\t\tthis.array[ index + 1 ] = y;\n\t\tthis.array[ index + 2 ] = z;\n\t\tthis.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.array, this.itemSize ).copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\titemSize: this.itemSize,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tarray: Array.from( this.array ),\n\t\t\tnormalized: this.normalized\n\t\t};\n\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( this.usage !== StaticDrawUsage ) data.usage = this.usage;\n\n\t\treturn data;\n\n\t}\n\n}\n\n//\n\nclass Int8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint8ClampedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint8ClampedArray( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Int32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Int32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Uint32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nclass Float16BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Uint16Array( array ), itemSize, normalized );\n\n\t\tthis.isFloat16BufferAttribute = true;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = fromHalfFloat( this.array[ index * this.itemSize ] );\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize$1( x, this.array );\n\n\t\tthis.array[ index * this.itemSize ] = toHalfFloat( x );\n\n\t\treturn this;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = fromHalfFloat( this.array[ index * this.itemSize + 1 ] );\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize$1( y, this.array );\n\n\t\tthis.array[ index * this.itemSize + 1 ] = toHalfFloat( y );\n\n\t\treturn this;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = fromHalfFloat( this.array[ index * this.itemSize + 2 ] );\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize$1( z, this.array );\n\n\t\tthis.array[ index * this.itemSize + 2 ] = toHalfFloat( z );\n\n\t\treturn this;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = fromHalfFloat( this.array[ index * this.itemSize + 3 ] );\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize$1( w, this.array );\n\n\t\tthis.array[ index * this.itemSize + 3 ] = toHalfFloat( w );\n\n\t\treturn this;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = toHalfFloat( x );\n\t\tthis.array[ index + 1 ] = toHalfFloat( y );\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\t\t\tz = normalize$1( z, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = toHalfFloat( x );\n\t\tthis.array[ index + 1 ] = toHalfFloat( y );\n\t\tthis.array[ index + 2 ] = toHalfFloat( z );\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex *= this.itemSize;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\t\t\tz = normalize$1( z, this.array );\n\t\t\tw = normalize$1( w, this.array );\n\n\t\t}\n\n\t\tthis.array[ index + 0 ] = toHalfFloat( x );\n\t\tthis.array[ index + 1 ] = toHalfFloat( y );\n\t\tthis.array[ index + 2 ] = toHalfFloat( z );\n\t\tthis.array[ index + 3 ] = toHalfFloat( w );\n\n\t\treturn this;\n\n\t}\n\n}\n\n\nclass Float32BufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized ) {\n\n\t\tsuper( new Float32Array( array ), itemSize, normalized );\n\n\t}\n\n}\n\nlet _id$9 = 0;\n\nconst _m1$1 = /*@__PURE__*/ new Matrix4();\nconst _obj = /*@__PURE__*/ new Object3D();\nconst _offset = /*@__PURE__*/ new Vector3();\nconst _box$2 = /*@__PURE__*/ new Box3();\nconst _boxMorphTargets = /*@__PURE__*/ new Box3();\nconst _vector$8 = /*@__PURE__*/ new Vector3();\n\nclass BufferGeometry extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBufferGeometry = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _id$9 ++ } );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.name = '';\n\t\tthis.type = 'BufferGeometry';\n\n\t\tthis.index = null;\n\t\tthis.indirect = null;\n\t\tthis.attributes = {};\n\n\t\tthis.morphAttributes = {};\n\t\tthis.morphTargetsRelative = false;\n\n\t\tthis.groups = [];\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tthis.drawRange = { start: 0, count: Infinity };\n\n\t\tthis.userData = {};\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this.index;\n\n\t}\n\n\tsetIndex( index ) {\n\n\t\tif ( Array.isArray( index ) ) {\n\n\t\t\tthis.index = new ( arrayNeedsUint32$1( index ) ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\n\n\t\t} else {\n\n\t\t\tthis.index = index;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetIndirect( indirect ) {\n\n\t\tthis.indirect = indirect;\n\n\t\treturn this;\n\n\t}\n\n\tgetIndirect() {\n\n\t\treturn this.indirect;\n\n\t}\n\n\tgetAttribute( name ) {\n\n\t\treturn this.attributes[ name ];\n\n\t}\n\n\tsetAttribute( name, attribute ) {\n\n\t\tthis.attributes[ name ] = attribute;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteAttribute( name ) {\n\n\t\tdelete this.attributes[ name ];\n\n\t\treturn this;\n\n\t}\n\n\thasAttribute( name ) {\n\n\t\treturn this.attributes[ name ] !== undefined;\n\n\t}\n\n\taddGroup( start, count, materialIndex = 0 ) {\n\n\t\tthis.groups.push( {\n\n\t\t\tstart: start,\n\t\t\tcount: count,\n\t\t\tmaterialIndex: materialIndex\n\n\t\t} );\n\n\t}\n\n\tclearGroups() {\n\n\t\tthis.groups = [];\n\n\t}\n\n\tsetDrawRange( start, count ) {\n\n\t\tthis.drawRange.start = start;\n\t\tthis.drawRange.count = count;\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tconst position = this.attributes.position;\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tposition.applyMatrix4( matrix );\n\n\t\t\tposition.needsUpdate = true;\n\n\t\t}\n\n\t\tconst normal = this.attributes.normal;\n\n\t\tif ( normal !== undefined ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\n\n\t\t\tnormal.applyNormalMatrix( normalMatrix );\n\n\t\t\tnormal.needsUpdate = true;\n\n\t\t}\n\n\t\tconst tangent = this.attributes.tangent;\n\n\t\tif ( tangent !== undefined ) {\n\n\t\t\ttangent.transformDirection( matrix );\n\n\t\t\ttangent.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyQuaternion( q ) {\n\n\t\t_m1$1.makeRotationFromQuaternion( q );\n\n\t\tthis.applyMatrix4( _m1$1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateX( angle ) {\n\n\t\t// rotate geometry around world x-axis\n\n\t\t_m1$1.makeRotationX( angle );\n\n\t\tthis.applyMatrix4( _m1$1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateY( angle ) {\n\n\t\t// rotate geometry around world y-axis\n\n\t\t_m1$1.makeRotationY( angle );\n\n\t\tthis.applyMatrix4( _m1$1 );\n\n\t\treturn this;\n\n\t}\n\n\trotateZ( angle ) {\n\n\t\t// rotate geometry around world z-axis\n\n\t\t_m1$1.makeRotationZ( angle );\n\n\t\tthis.applyMatrix4( _m1$1 );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( x, y, z ) {\n\n\t\t// translate geometry\n\n\t\t_m1$1.makeTranslation( x, y, z );\n\n\t\tthis.applyMatrix4( _m1$1 );\n\n\t\treturn this;\n\n\t}\n\n\tscale( x, y, z ) {\n\n\t\t// scale geometry\n\n\t\t_m1$1.makeScale( x, y, z );\n\n\t\tthis.applyMatrix4( _m1$1 );\n\n\t\treturn this;\n\n\t}\n\n\tlookAt( vector ) {\n\n\t\t_obj.lookAt( vector );\n\n\t\t_obj.updateMatrix();\n\n\t\tthis.applyMatrix4( _obj.matrix );\n\n\t\treturn this;\n\n\t}\n\n\tcenter() {\n\n\t\tthis.computeBoundingBox();\n\n\t\tthis.boundingBox.getCenter( _offset ).negate();\n\n\t\tthis.translate( _offset.x, _offset.y, _offset.z );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute === undefined ) {\n\n\t\t\tconst position = [];\n\n\t\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\n\n\t\t\t}\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tpositionAttribute.setXYZ( i, point.x, point.y, point.z || 0 );\n\n\t\t\t}\n\n\t\t\tif ( points.length > positionAttribute.count ) {\n\n\t\t\t\tconsole.warn( 'THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry.' );\n\n\t\t\t}\n\n\t\t\tpositionAttribute.needsUpdate = true;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.', this );\n\n\t\t\tthis.boundingBox.set(\n\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\n\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\n\t\t\t);\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tthis.boundingBox.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_box$2.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.min, _box$2.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( this.boundingBox.max, _box$2.max );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$2.min );\n\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box$2.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.boundingBox.makeEmpty();\n\n\t\t}\n\n\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst position = this.attributes.position;\n\t\tconst morphAttributesPosition = this.morphAttributes.position;\n\n\t\tif ( position && position.isGLBufferAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.', this );\n\n\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( position ) {\n\n\t\t\t// first, find the center of the bounding sphere\n\n\t\t\tconst center = this.boundingSphere.center;\n\n\t\t\t_box$2.setFromBufferAttribute( position );\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\n\n\t\t\t\t\tif ( this.morphTargetsRelative ) {\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$2.min, _boxMorphTargets.min );\n\t\t\t\t\t\t_box$2.expandByPoint( _vector$8 );\n\n\t\t\t\t\t\t_vector$8.addVectors( _box$2.max, _boxMorphTargets.max );\n\t\t\t\t\t\t_box$2.expandByPoint( _vector$8 );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_box$2.expandByPoint( _boxMorphTargets.min );\n\t\t\t\t\t\t_box$2.expandByPoint( _boxMorphTargets.max );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_box$2.getCenter( center );\n\n\t\t\t// second, try to find a boundingSphere with a radius smaller than the\n\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\n\n\t\t\tlet maxRadiusSq = 0;\n\n\t\t\tfor ( let i = 0, il = position.count; i < il; i ++ ) {\n\n\t\t\t\t_vector$8.fromBufferAttribute( position, i );\n\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t}\n\n\t\t\t// process morph attributes if present\n\n\t\t\tif ( morphAttributesPosition ) {\n\n\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst morphAttribute = morphAttributesPosition[ i ];\n\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j ++ ) {\n\n\t\t\t\t\t\t_vector$8.fromBufferAttribute( morphAttribute, j );\n\n\t\t\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\n\t\t\t\t\t\t\t_vector$8.add( _offset );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector$8 ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeTangents() {\n\n\t\tconst index = this.index;\n\t\tconst attributes = this.attributes;\n\n\t\t// based on http://www.terathon.com/code/tangent.html\n\t\t// (per vertex tangents)\n\n\t\tif ( index === null ||\n\t\t\t attributes.position === undefined ||\n\t\t\t attributes.normal === undefined ||\n\t\t\t attributes.uv === undefined ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst positionAttribute = attributes.position;\n\t\tconst normalAttribute = attributes.normal;\n\t\tconst uvAttribute = attributes.uv;\n\n\t\tif ( this.hasAttribute( 'tangent' ) === false ) {\n\n\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * positionAttribute.count ), 4 ) );\n\n\t\t}\n\n\t\tconst tangentAttribute = this.getAttribute( 'tangent' );\n\n\t\tconst tan1 = [], tan2 = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i ++ ) {\n\n\t\t\ttan1[ i ] = new Vector3();\n\t\t\ttan2[ i ] = new Vector3();\n\n\t\t}\n\n\t\tconst vA = new Vector3(),\n\t\t\tvB = new Vector3(),\n\t\t\tvC = new Vector3(),\n\n\t\t\tuvA = new Vector2(),\n\t\t\tuvB = new Vector2(),\n\t\t\tuvC = new Vector2(),\n\n\t\t\tsdir = new Vector3(),\n\t\t\ttdir = new Vector3();\n\n\t\tfunction handleTriangle( a, b, c ) {\n\n\t\t\tvA.fromBufferAttribute( positionAttribute, a );\n\t\t\tvB.fromBufferAttribute( positionAttribute, b );\n\t\t\tvC.fromBufferAttribute( positionAttribute, c );\n\n\t\t\tuvA.fromBufferAttribute( uvAttribute, a );\n\t\t\tuvB.fromBufferAttribute( uvAttribute, b );\n\t\t\tuvC.fromBufferAttribute( uvAttribute, c );\n\n\t\t\tvB.sub( vA );\n\t\t\tvC.sub( vA );\n\n\t\t\tuvB.sub( uvA );\n\t\t\tuvC.sub( uvA );\n\n\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\n\n\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\n\n\t\t\tif ( ! isFinite( r ) ) return;\n\n\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\n\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\n\n\t\t\ttan1[ a ].add( sdir );\n\t\t\ttan1[ b ].add( sdir );\n\t\t\ttan1[ c ].add( sdir );\n\n\t\t\ttan2[ a ].add( tdir );\n\t\t\ttan2[ b ].add( tdir );\n\t\t\ttan2[ c ].add( tdir );\n\n\t\t}\n\n\t\tlet groups = this.groups;\n\n\t\tif ( groups.length === 0 ) {\n\n\t\t\tgroups = [ {\n\t\t\t\tstart: 0,\n\t\t\t\tcount: index.count\n\t\t\t} ];\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleTriangle(\n\t\t\t\t\tindex.getX( j + 0 ),\n\t\t\t\t\tindex.getX( j + 1 ),\n\t\t\t\t\tindex.getX( j + 2 )\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\n\t\tconst n = new Vector3(), n2 = new Vector3();\n\n\t\tfunction handleVertex( v ) {\n\n\t\t\tn.fromBufferAttribute( normalAttribute, v );\n\t\t\tn2.copy( n );\n\n\t\t\tconst t = tan1[ v ];\n\n\t\t\t// Gram-Schmidt orthogonalize\n\n\t\t\ttmp.copy( t );\n\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\n\n\t\t\t// Calculate handedness\n\n\t\t\ttmp2.crossVectors( n2, t );\n\t\t\tconst test = tmp2.dot( tan2[ v ] );\n\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\n\n\t\t\ttangentAttribute.setXYZW( v, tmp.x, tmp.y, tmp.z, w );\n\n\t\t}\n\n\t\tfor ( let i = 0, il = groups.length; i < il; ++ i ) {\n\n\t\t\tconst group = groups[ i ];\n\n\t\t\tconst start = group.start;\n\t\t\tconst count = group.count;\n\n\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\n\n\t\t\t\thandleVertex( index.getX( j + 0 ) );\n\t\t\t\thandleVertex( index.getX( j + 1 ) );\n\t\t\t\thandleVertex( index.getX( j + 2 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcomputeVertexNormals() {\n\n\t\tconst index = this.index;\n\t\tconst positionAttribute = this.getAttribute( 'position' );\n\n\t\tif ( positionAttribute !== undefined ) {\n\n\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\n\n\t\t\tif ( normalAttribute === undefined ) {\n\n\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\n\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\n\n\t\t\t} else {\n\n\t\t\t\t// reset existing normals to zero\n\n\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i ++ ) {\n\n\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\n\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\n\t\t\tconst cb = new Vector3(), ab = new Vector3();\n\n\t\t\t// indexed elements\n\n\t\t\tif ( index ) {\n\n\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\n\n\t\t\t\t\tconst vA = index.getX( i + 0 );\n\t\t\t\t\tconst vB = index.getX( i + 1 );\n\t\t\t\t\tconst vC = index.getX( i + 2 );\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\n\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\n\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\n\n\t\t\t\t\tnA.add( cb );\n\t\t\t\t\tnB.add( cb );\n\t\t\t\t\tnC.add( cb );\n\n\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\n\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed elements (unconnected triangle soup)\n\n\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\n\n\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\n\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\n\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\n\n\t\t\t\t\tcb.subVectors( pC, pB );\n\t\t\t\t\tab.subVectors( pA, pB );\n\t\t\t\t\tcb.cross( ab );\n\n\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\n\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.normalizeNormals();\n\n\t\t\tnormalAttribute.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tnormalizeNormals() {\n\n\t\tconst normals = this.attributes.normal;\n\n\t\tfor ( let i = 0, il = normals.count; i < il; i ++ ) {\n\n\t\t\t_vector$8.fromBufferAttribute( normals, i );\n\n\t\t\t_vector$8.normalize();\n\n\t\t\tnormals.setXYZ( i, _vector$8.x, _vector$8.y, _vector$8.z );\n\n\t\t}\n\n\t}\n\n\ttoNonIndexed() {\n\n\t\tfunction convertBufferAttribute( attribute, indices ) {\n\n\t\t\tconst array = attribute.array;\n\t\t\tconst itemSize = attribute.itemSize;\n\t\t\tconst normalized = attribute.normalized;\n\n\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\n\n\t\t\tlet index = 0, index2 = 0;\n\n\t\t\tfor ( let i = 0, l = indices.length; i < l; i ++ ) {\n\n\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\tindex = indices[ i ] * attribute.data.stride + attribute.offset;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindex = indices[ i ] * itemSize;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0; j < itemSize; j ++ ) {\n\n\t\t\t\t\tarray2[ index2 ++ ] = array[ index ++ ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( this.index === null ) {\n\n\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tconst geometry2 = new BufferGeometry();\n\n\t\tconst indices = this.index.array;\n\t\tconst attributes = this.attributes;\n\n\t\t// attributes\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\tgeometry2.setAttribute( name, newAttribute );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = this.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst morphArray = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = morphAttribute[ i ];\n\n\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\n\n\t\t\t\tmorphArray.push( newAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry2.morphAttributes[ name ] = morphArray;\n\n\t\t}\n\n\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = this.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\treturn geometry2;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'BufferGeometry',\n\t\t\t\tgenerator: 'BufferGeometry.toJSON'\n\t\t\t}\n\t\t};\n\n\t\t// standard BufferGeometry serialization\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.type = this.type;\n\t\tif ( this.name !== '' ) data.name = this.name;\n\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\n\n\t\tif ( this.parameters !== undefined ) {\n\n\t\t\tconst parameters = this.parameters;\n\n\t\t\tfor ( const key in parameters ) {\n\n\t\t\t\tif ( parameters[ key ] !== undefined ) data[ key ] = parameters[ key ];\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\n\n\t\tdata.data = { attributes: {} };\n\n\t\tconst index = this.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tdata.data.index = {\n\t\t\t\ttype: index.array.constructor.name,\n\t\t\t\tarray: Array.prototype.slice.call( index.array )\n\t\t\t};\n\n\t\t}\n\n\t\tconst attributes = this.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\n\t\t\tdata.data.attributes[ key ] = attribute.toJSON( data.data );\n\n\t\t}\n\n\t\tconst morphAttributes = {};\n\t\tlet hasMorphAttributes = false;\n\n\t\tfor ( const key in this.morphAttributes ) {\n\n\t\t\tconst attributeArray = this.morphAttributes[ key ];\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\tconst attribute = attributeArray[ i ];\n\n\t\t\t\tarray.push( attribute.toJSON( data.data ) );\n\n\t\t\t}\n\n\t\t\tif ( array.length > 0 ) {\n\n\t\t\t\tmorphAttributes[ key ] = array;\n\n\t\t\t\thasMorphAttributes = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( hasMorphAttributes ) {\n\n\t\t\tdata.data.morphAttributes = morphAttributes;\n\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\n\n\t\t}\n\n\t\tconst groups = this.groups;\n\n\t\tif ( groups.length > 0 ) {\n\n\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tdata.data.boundingSphere = {\n\t\t\t\tcenter: boundingSphere.center.toArray(),\n\t\t\t\tradius: boundingSphere.radius\n\t\t\t};\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\t// reset\n\n\t\tthis.index = null;\n\t\tthis.attributes = {};\n\t\tthis.morphAttributes = {};\n\t\tthis.groups = [];\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\t// used for storing cloned, shared data\n\n\t\tconst data = {};\n\n\t\t// name\n\n\t\tthis.name = source.name;\n\n\t\t// index\n\n\t\tconst index = source.index;\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.setIndex( index.clone( data ) );\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst attributes = source.attributes;\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\t\t\tthis.setAttribute( name, attribute.clone( data ) );\n\n\t\t}\n\n\t\t// morph attributes\n\n\t\tconst morphAttributes = source.morphAttributes;\n\n\t\tfor ( const name in morphAttributes ) {\n\n\t\t\tconst array = [];\n\t\t\tconst morphAttribute = morphAttributes[ name ]; // morphAttribute: array of Float32BufferAttributes\n\n\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i ++ ) {\n\n\t\t\t\tarray.push( morphAttribute[ i ].clone( data ) );\n\n\t\t\t}\n\n\t\t\tthis.morphAttributes[ name ] = array;\n\n\t\t}\n\n\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\n\n\t\t// groups\n\n\t\tconst groups = source.groups;\n\n\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\tconst group = groups[ i ];\n\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t}\n\n\t\t// bounding box\n\n\t\tconst boundingBox = source.boundingBox;\n\n\t\tif ( boundingBox !== null ) {\n\n\t\t\tthis.boundingBox = boundingBox.clone();\n\n\t\t}\n\n\t\t// bounding sphere\n\n\t\tconst boundingSphere = source.boundingSphere;\n\n\t\tif ( boundingSphere !== null ) {\n\n\t\t\tthis.boundingSphere = boundingSphere.clone();\n\n\t\t}\n\n\t\t// draw range\n\n\t\tthis.drawRange.start = source.drawRange.start;\n\t\tthis.drawRange.count = source.drawRange.count;\n\n\t\t// user data\n\n\t\tthis.userData = source.userData;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n}\n\nconst _inverseMatrix$3 = /*@__PURE__*/ new Matrix4();\nconst _ray$3 = /*@__PURE__*/ new Ray();\nconst _sphere$6 = /*@__PURE__*/ new Sphere();\nconst _sphereHitAt = /*@__PURE__*/ new Vector3();\n\nconst _vA$1 = /*@__PURE__*/ new Vector3();\nconst _vB$1 = /*@__PURE__*/ new Vector3();\nconst _vC$1 = /*@__PURE__*/ new Vector3();\n\nconst _tempA = /*@__PURE__*/ new Vector3();\nconst _morphA = /*@__PURE__*/ new Vector3();\n\nconst _intersectionPoint = /*@__PURE__*/ new Vector3();\nconst _intersectionPointWorld = /*@__PURE__*/ new Vector3();\n\nclass Mesh extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new MeshBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isMesh = true;\n\n\t\tthis.type = 'Mesh';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.morphTargetInfluences !== undefined ) {\n\n\t\t\tthis.morphTargetInfluences = source.morphTargetInfluences.slice();\n\n\t\t}\n\n\t\tif ( source.morphTargetDictionary !== undefined ) {\n\n\t\t\tthis.morphTargetDictionary = Object.assign( {}, source.morphTargetDictionary );\n\n\t\t}\n\n\t\tthis.material = Array.isArray( source.material ) ? source.material.slice() : source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetVertexPosition( index, target ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.attributes.position;\n\t\tconst morphPosition = geometry.morphAttributes.position;\n\t\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\n\t\ttarget.fromBufferAttribute( position, index );\n\n\t\tconst morphInfluences = this.morphTargetInfluences;\n\n\t\tif ( morphPosition && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphPosition.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morphAttribute = morphPosition[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morphAttribute, index );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( target ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttarget.add( _morphA );\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// test with bounding sphere in world space\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$6.copy( geometry.boundingSphere );\n\t\t_sphere$6.applyMatrix4( matrixWorld );\n\n\t\t// check distance from ray origin to bounding sphere\n\n\t\t_ray$3.copy( raycaster.ray ).recast( raycaster.near );\n\n\t\tif ( _sphere$6.containsPoint( _ray$3.origin ) === false ) {\n\n\t\t\tif ( _ray$3.intersectSphere( _sphere$6, _sphereHitAt ) === null ) return;\n\n\t\t\tif ( _ray$3.origin.distanceToSquared( _sphereHitAt ) > ( raycaster.far - raycaster.near ) ** 2 ) return;\n\n\t\t}\n\n\t\t// convert ray to local space of mesh\n\n\t\t_inverseMatrix$3.copy( matrixWorld ).invert();\n\t\t_ray$3.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$3 );\n\n\t\t// test with bounding box in local space\n\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tif ( _ray$3.intersectsBox( geometry.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\t// test for intersections with geometry\n\n\t\tthis._computeIntersections( raycaster, intersects, _ray$3 );\n\n\t}\n\n\t_computeIntersections( raycaster, intersects, rayLocalSpace ) {\n\n\t\tlet intersection;\n\n\t\tconst geometry = this.geometry;\n\t\tconst material = this.material;\n\n\t\tconst index = geometry.index;\n\t\tconst position = geometry.attributes.position;\n\t\tconst uv = geometry.attributes.uv;\n\t\tconst uv1 = geometry.attributes.uv1;\n\t\tconst normal = geometry.attributes.normal;\n\t\tconst groups = geometry.groups;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\tif ( index !== null ) {\n\n\t\t\t// indexed buffer geometry\n\n\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\tconst end = Math.min( index.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\tconst a = index.getX( j );\n\t\t\t\t\t\tconst b = index.getX( j + 1 );\n\t\t\t\t\t\tconst c = index.getX( j + 2 );\n\n\t\t\t\t\t\tintersection = checkGeometryIntersection( this, groupMaterial, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\tconst a = index.getX( i );\n\t\t\t\t\tconst b = index.getX( i + 1 );\n\t\t\t\t\tconst c = index.getX( i + 2 );\n\n\t\t\t\t\tintersection = checkGeometryIntersection( this, material, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in indexed buffer semantics\n\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( position !== undefined ) {\n\n\t\t\t// non-indexed buffer geometry\n\n\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\tconst start = Math.max( group.start, drawRange.start );\n\t\t\t\t\tconst end = Math.min( position.count, Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) ) );\n\n\t\t\t\t\tfor ( let j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\t\tconst a = j;\n\t\t\t\t\t\tconst b = j + 1;\n\t\t\t\t\t\tconst c = j + 2;\n\n\t\t\t\t\t\tintersection = checkGeometryIntersection( this, groupMaterial, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\t\tintersection.faceIndex = Math.floor( j / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\t\tintersection.face.materialIndex = group.materialIndex;\n\t\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\t\tconst end = Math.min( position.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( let i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\t\tconst a = i;\n\t\t\t\t\tconst b = i + 1;\n\t\t\t\t\tconst c = i + 2;\n\n\t\t\t\t\tintersection = checkGeometryIntersection( this, material, raycaster, rayLocalSpace, uv, uv1, normal, a, b, c );\n\n\t\t\t\t\tif ( intersection ) {\n\n\t\t\t\t\t\tintersection.faceIndex = Math.floor( i / 3 ); // triangle number in non-indexed buffer semantics\n\t\t\t\t\t\tintersects.push( intersection );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction checkIntersection$1( object, material, raycaster, ray, pA, pB, pC, point ) {\n\n\tlet intersect;\n\n\tif ( material.side === BackSide ) {\n\n\t\tintersect = ray.intersectTriangle( pC, pB, pA, true, point );\n\n\t} else {\n\n\t\tintersect = ray.intersectTriangle( pA, pB, pC, ( material.side === FrontSide ), point );\n\n\t}\n\n\tif ( intersect === null ) return null;\n\n\t_intersectionPointWorld.copy( point );\n\t_intersectionPointWorld.applyMatrix4( object.matrixWorld );\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectionPointWorld );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return null;\n\n\treturn {\n\t\tdistance: distance,\n\t\tpoint: _intersectionPointWorld.clone(),\n\t\tobject: object\n\t};\n\n}\n\nfunction checkGeometryIntersection( object, material, raycaster, ray, uv, uv1, normal, a, b, c ) {\n\n\tobject.getVertexPosition( a, _vA$1 );\n\tobject.getVertexPosition( b, _vB$1 );\n\tobject.getVertexPosition( c, _vC$1 );\n\n\tconst intersection = checkIntersection$1( object, material, raycaster, ray, _vA$1, _vB$1, _vC$1, _intersectionPoint );\n\n\tif ( intersection ) {\n\n\t\tconst barycoord = new Vector3();\n\t\tTriangle.getBarycoord( _intersectionPoint, _vA$1, _vB$1, _vC$1, barycoord );\n\n\t\tif ( uv ) {\n\n\t\t\tintersection.uv = Triangle.getInterpolatedAttribute( uv, a, b, c, barycoord, new Vector2() );\n\n\t\t}\n\n\t\tif ( uv1 ) {\n\n\t\t\tintersection.uv1 = Triangle.getInterpolatedAttribute( uv1, a, b, c, barycoord, new Vector2() );\n\n\t\t}\n\n\t\tif ( normal ) {\n\n\t\t\tintersection.normal = Triangle.getInterpolatedAttribute( normal, a, b, c, barycoord, new Vector3() );\n\n\t\t\tif ( intersection.normal.dot( ray.direction ) > 0 ) {\n\n\t\t\t\tintersection.normal.multiplyScalar( - 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst face = {\n\t\t\ta: a,\n\t\t\tb: b,\n\t\t\tc: c,\n\t\t\tnormal: new Vector3(),\n\t\t\tmaterialIndex: 0\n\t\t};\n\n\t\tTriangle.getNormal( _vA$1, _vB$1, _vC$1, face.normal );\n\n\t\tintersection.face = face;\n\t\tintersection.barycoord = barycoord;\n\n\t}\n\n\treturn intersection;\n\n}\n\nclass BoxGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, depth = 1, widthSegments = 1, heightSegments = 1, depthSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'BoxGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\tdepth: depth,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tdepthSegments: depthSegments\n\t\t};\n\n\t\tconst scope = this;\n\n\t\t// segments\n\n\t\twidthSegments = Math.floor( widthSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\t\tdepthSegments = Math.floor( depthSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet numberOfVertices = 0;\n\t\tlet groupStart = 0;\n\n\t\t// build each side of the box geometry\n\n\t\tbuildPlane( 'z', 'y', 'x', - 1, - 1, depth, height, width, depthSegments, heightSegments, 0 ); // px\n\t\tbuildPlane( 'z', 'y', 'x', 1, - 1, depth, height, - width, depthSegments, heightSegments, 1 ); // nx\n\t\tbuildPlane( 'x', 'z', 'y', 1, 1, width, depth, height, widthSegments, depthSegments, 2 ); // py\n\t\tbuildPlane( 'x', 'z', 'y', 1, - 1, width, depth, - height, widthSegments, depthSegments, 3 ); // ny\n\t\tbuildPlane( 'x', 'y', 'z', 1, - 1, width, height, depth, widthSegments, heightSegments, 4 ); // pz\n\t\tbuildPlane( 'x', 'y', 'z', - 1, - 1, width, height, - depth, widthSegments, heightSegments, 5 ); // nz\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction buildPlane( u, v, w, udir, vdir, width, height, depth, gridX, gridY, materialIndex ) {\n\n\t\t\tconst segmentWidth = width / gridX;\n\t\t\tconst segmentHeight = height / gridY;\n\n\t\t\tconst widthHalf = width / 2;\n\t\t\tconst heightHalf = height / 2;\n\t\t\tconst depthHalf = depth / 2;\n\n\t\t\tconst gridX1 = gridX + 1;\n\t\t\tconst gridY1 = gridY + 1;\n\n\t\t\tlet vertexCounter = 0;\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst vector = new Vector3();\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\t\tconst y = iy * segmentHeight - heightHalf;\n\n\t\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\t\tconst x = ix * segmentWidth - widthHalf;\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = x * udir;\n\t\t\t\t\tvector[ v ] = y * vdir;\n\t\t\t\t\tvector[ w ] = depthHalf;\n\n\t\t\t\t\t// now apply vector to vertex buffer\n\n\t\t\t\t\tvertices.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// set values to correct vector component\n\n\t\t\t\t\tvector[ u ] = 0;\n\t\t\t\t\tvector[ v ] = 0;\n\t\t\t\t\tvector[ w ] = depth > 0 ? 1 : - 1;\n\n\t\t\t\t\t// now apply vector to normal buffer\n\n\t\t\t\t\tnormals.push( vector.x, vector.y, vector.z );\n\n\t\t\t\t\t// uvs\n\n\t\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t\t\t// counters\n\n\t\t\t\t\tvertexCounter += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\t// 1. you need three indices to draw a single face\n\t\t\t// 2. a single segment consists of two faces\n\t\t\t// 3. so we need to generate six (2*3) indices per segment\n\n\t\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\t\tconst a = numberOfVertices + ix + gridX1 * iy;\n\t\t\t\t\tconst b = numberOfVertices + ix + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst c = numberOfVertices + ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\t\tconst d = numberOfVertices + ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t\t// increase counter\n\n\t\t\t\t\tgroupCount += 6;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, materialIndex );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t\t// update total number of vertices\n\n\t\t\tnumberOfVertices += vertexCounter;\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new BoxGeometry( data.width, data.height, data.depth, data.widthSegments, data.heightSegments, data.depthSegments );\n\n\t}\n\n}\n\n/**\n * Uniform Utilities\n */\n\nfunction cloneUniforms( src ) {\n\n\tconst dst = {};\n\n\tfor ( const u in src ) {\n\n\t\tdst[ u ] = {};\n\n\t\tfor ( const p in src[ u ] ) {\n\n\t\t\tconst property = src[ u ][ p ];\n\n\t\t\tif ( property && ( property.isColor ||\n\t\t\t\tproperty.isMatrix3 || property.isMatrix4 ||\n\t\t\t\tproperty.isVector2 || property.isVector3 || property.isVector4 ||\n\t\t\t\tproperty.isTexture || property.isQuaternion ) ) {\n\n\t\t\t\tif ( property.isRenderTargetTexture ) {\n\n\t\t\t\t\tconsole.warn( 'UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms().' );\n\t\t\t\t\tdst[ u ][ p ] = null;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdst[ u ][ p ] = property.clone();\n\n\t\t\t\t}\n\n\t\t\t} else if ( Array.isArray( property ) ) {\n\n\t\t\t\tdst[ u ][ p ] = property.slice();\n\n\t\t\t} else {\n\n\t\t\t\tdst[ u ][ p ] = property;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn dst;\n\n}\n\nfunction cloneUniformsGroups( src ) {\n\n\tconst dst = [];\n\n\tfor ( let u = 0; u < src.length; u ++ ) {\n\n\t\tdst.push( src[ u ].clone() );\n\n\t}\n\n\treturn dst;\n\n}\n\nvar default_vertex = /* glsl */`\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n`;\n\nvar default_fragment = /* glsl */`\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n`;\n\nclass ShaderMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'ShaderMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShaderMaterial = true;\n\n\t\tthis.defines = {};\n\t\tthis.uniforms = {};\n\t\tthis.uniformsGroups = [];\n\n\t\tthis.vertexShader = default_vertex;\n\t\tthis.fragmentShader = default_fragment;\n\n\t\tthis.linewidth = 1;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.fog = false; // set to use scene fog\n\t\tthis.lights = false; // set to use scene lights\n\t\tthis.clipping = false; // set to use user-defined clipping planes\n\n\t\tthis.forceSinglePass = true;\n\n\t\tthis.extensions = {\n\t\t\tclipCullDistance: false, // set to use vertex shader clipping\n\t\t\tmultiDraw: false // set to use vertex shader multi_draw / enable gl_DrawID\n\t\t};\n\n\t\t// When rendered geometry doesn't include these attributes but the material does,\n\t\t// use these default values in WebGL. This avoids errors when buffer data is missing.\n\t\tthis.defaultAttributeValues = {\n\t\t\t'color': [ 1, 1, 1 ],\n\t\t\t'uv': [ 0, 0 ],\n\t\t\t'uv1': [ 0, 0 ]\n\t\t};\n\n\t\tthis.index0AttributeName = undefined;\n\t\tthis.uniformsNeedUpdate = false;\n\n\t\tthis.glslVersion = null;\n\n\t\tif ( parameters !== undefined ) {\n\n\t\t\tthis.setValues( parameters );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.fragmentShader = source.fragmentShader;\n\t\tthis.vertexShader = source.vertexShader;\n\n\t\tthis.uniforms = cloneUniforms( source.uniforms );\n\t\tthis.uniformsGroups = cloneUniformsGroups( source.uniformsGroups );\n\n\t\tthis.defines = Object.assign( {}, source.defines );\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.fog = source.fog;\n\t\tthis.lights = source.lights;\n\t\tthis.clipping = source.clipping;\n\n\t\tthis.extensions = Object.assign( {}, source.extensions );\n\n\t\tthis.glslVersion = source.glslVersion;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.glslVersion = this.glslVersion;\n\t\tdata.uniforms = {};\n\n\t\tfor ( const name in this.uniforms ) {\n\n\t\t\tconst uniform = this.uniforms[ name ];\n\t\t\tconst value = uniform.value;\n\n\t\t\tif ( value && value.isTexture ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 't',\n\t\t\t\t\tvalue: value.toJSON( meta ).uuid\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isColor ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'c',\n\t\t\t\t\tvalue: value.getHex()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector2 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v2',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isVector4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'v4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix3 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm3',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else if ( value && value.isMatrix4 ) {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\ttype: 'm4',\n\t\t\t\t\tvalue: value.toArray()\n\t\t\t\t};\n\n\t\t\t} else {\n\n\t\t\t\tdata.uniforms[ name ] = {\n\t\t\t\t\tvalue: value\n\t\t\t\t};\n\n\t\t\t\t// note: the array variants v2v, v3v, v4v, m4v and tv are not supported so far\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( this.defines ).length > 0 ) data.defines = this.defines;\n\n\t\tdata.vertexShader = this.vertexShader;\n\t\tdata.fragmentShader = this.fragmentShader;\n\n\t\tdata.lights = this.lights;\n\t\tdata.clipping = this.clipping;\n\n\t\tconst extensions = {};\n\n\t\tfor ( const key in this.extensions ) {\n\n\t\t\tif ( this.extensions[ key ] === true ) extensions[ key ] = true;\n\n\t\t}\n\n\t\tif ( Object.keys( extensions ).length > 0 ) data.extensions = extensions;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass Camera extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isCamera = true;\n\n\t\tthis.type = 'Camera';\n\n\t\tthis.matrixWorldInverse = new Matrix4();\n\n\t\tthis.projectionMatrix = new Matrix4();\n\t\tthis.projectionMatrixInverse = new Matrix4();\n\n\t\tthis.coordinateSystem = WebGLCoordinateSystem;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.matrixWorldInverse.copy( source.matrixWorldInverse );\n\n\t\tthis.projectionMatrix.copy( source.projectionMatrix );\n\t\tthis.projectionMatrixInverse.copy( source.projectionMatrixInverse );\n\n\t\tthis.coordinateSystem = source.coordinateSystem;\n\n\t\treturn this;\n\n\t}\n\n\tgetWorldDirection( target ) {\n\n\t\treturn super.getWorldDirection( target ).negate();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tupdateWorldMatrix( updateParents, updateChildren ) {\n\n\t\tsuper.updateWorldMatrix( updateParents, updateChildren );\n\n\t\tthis.matrixWorldInverse.copy( this.matrixWorld ).invert();\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _v3$1 = /*@__PURE__*/ new Vector3();\nconst _minTarget = /*@__PURE__*/ new Vector2();\nconst _maxTarget = /*@__PURE__*/ new Vector2();\n\n\nclass PerspectiveCamera extends Camera {\n\n\tconstructor( fov = 50, aspect = 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.isPerspectiveCamera = true;\n\n\t\tthis.type = 'PerspectiveCamera';\n\n\t\tthis.fov = fov;\n\t\tthis.zoom = 1;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.focus = 10;\n\n\t\tthis.aspect = aspect;\n\t\tthis.view = null;\n\n\t\tthis.filmGauge = 35;\t// width of the film (default in millimeters)\n\t\tthis.filmOffset = 0;\t// horizontal film offset (same unit as gauge)\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.fov = source.fov;\n\t\tthis.zoom = source.zoom;\n\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\t\tthis.focus = source.focus;\n\n\t\tthis.aspect = source.aspect;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\tthis.filmGauge = source.filmGauge;\n\t\tthis.filmOffset = source.filmOffset;\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Sets the FOV by focal length in respect to the current .filmGauge.\n\t *\n\t * The default film gauge is 35, so that the focal length can be specified for\n\t * a 35mm (full frame) camera.\n\t *\n\t * Values for focal length and film gauge must have the same unit.\n\t */\n\tsetFocalLength( focalLength ) {\n\n\t\t/** see {@link http://www.bobatkins.com/photography/technical/field_of_view.html} */\n\t\tconst vExtentSlope = 0.5 * this.getFilmHeight() / focalLength;\n\n\t\tthis.fov = RAD2DEG * 2 * Math.atan( vExtentSlope );\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\t/**\n\t * Calculates the focal length from the current .fov and .filmGauge.\n\t */\n\tgetFocalLength() {\n\n\t\tconst vExtentSlope = Math.tan( DEG2RAD * 0.5 * this.fov );\n\n\t\treturn 0.5 * this.getFilmHeight() / vExtentSlope;\n\n\t}\n\n\tgetEffectiveFOV() {\n\n\t\treturn RAD2DEG * 2 * Math.atan(\n\t\t\tMath.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom );\n\n\t}\n\n\tgetFilmWidth() {\n\n\t\t// film not completely covered in portrait format (aspect < 1)\n\t\treturn this.filmGauge * Math.min( this.aspect, 1 );\n\n\t}\n\n\tgetFilmHeight() {\n\n\t\t// film not completely covered in landscape format (aspect > 1)\n\t\treturn this.filmGauge / Math.max( this.aspect, 1 );\n\n\t}\n\n\t/**\n\t * Computes the 2D bounds of the camera's viewable rectangle at a given distance along the viewing direction.\n\t * Sets minTarget and maxTarget to the coordinates of the lower-left and upper-right corners of the view rectangle.\n\t */\n\tgetViewBounds( distance, minTarget, maxTarget ) {\n\n\t\t_v3$1.set( - 1, - 1, 0.5 ).applyMatrix4( this.projectionMatrixInverse );\n\n\t\tminTarget.set( _v3$1.x, _v3$1.y ).multiplyScalar( - distance / _v3$1.z );\n\n\t\t_v3$1.set( 1, 1, 0.5 ).applyMatrix4( this.projectionMatrixInverse );\n\n\t\tmaxTarget.set( _v3$1.x, _v3$1.y ).multiplyScalar( - distance / _v3$1.z );\n\n\t}\n\n\t/**\n\t * Computes the width and height of the camera's viewable rectangle at a given distance along the viewing direction.\n\t * Copies the result into the target Vector2, where x is width and y is height.\n\t */\n\tgetViewSize( distance, target ) {\n\n\t\tthis.getViewBounds( distance, _minTarget, _maxTarget );\n\n\t\treturn target.subVectors( _maxTarget, _minTarget );\n\n\t}\n\n\t/**\n\t * Sets an offset in a larger frustum. This is useful for multi-window or\n\t * multi-monitor/multi-machine setups.\n\t *\n\t * For example, if you have 3x2 monitors and each monitor is 1920x1080 and\n\t * the monitors are in grid like this\n\t *\n\t *   +---+---+---+\n\t *   | A | B | C |\n\t *   +---+---+---+\n\t *   | D | E | F |\n\t *   +---+---+---+\n\t *\n\t * then for each monitor you would call it like this\n\t *\n\t *   const w = 1920;\n\t *   const h = 1080;\n\t *   const fullWidth = w * 3;\n\t *   const fullHeight = h * 2;\n\t *\n\t *   --A--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 0, w, h );\n\t *   --B--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 0, w, h );\n\t *   --C--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 0, w, h );\n\t *   --D--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 0, h * 1, w, h );\n\t *   --E--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 1, h * 1, w, h );\n\t *   --F--\n\t *   camera.setViewOffset( fullWidth, fullHeight, w * 2, h * 1, w, h );\n\t *\n\t *   Note there is no reason monitors have to be the same size or in a grid.\n\t */\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tthis.aspect = fullWidth / fullHeight;\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst near = this.near;\n\t\tlet top = near * Math.tan( DEG2RAD * 0.5 * this.fov ) / this.zoom;\n\t\tlet height = 2 * top;\n\t\tlet width = this.aspect * height;\n\t\tlet left = - 0.5 * width;\n\t\tconst view = this.view;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst fullWidth = view.fullWidth,\n\t\t\t\tfullHeight = view.fullHeight;\n\n\t\t\tleft += view.offsetX * width / fullWidth;\n\t\t\ttop -= view.offsetY * height / fullHeight;\n\t\t\twidth *= view.width / fullWidth;\n\t\t\theight *= view.height / fullHeight;\n\n\t\t}\n\n\t\tconst skew = this.filmOffset;\n\t\tif ( skew !== 0 ) left += near * skew / this.getFilmWidth();\n\n\t\tthis.projectionMatrix.makePerspective( left, left + width, top, top - height, near, this.far, this.coordinateSystem );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.fov = this.fov;\n\t\tdata.object.zoom = this.zoom;\n\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\t\tdata.object.focus = this.focus;\n\n\t\tdata.object.aspect = this.aspect;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\tdata.object.filmGauge = this.filmGauge;\n\t\tdata.object.filmOffset = this.filmOffset;\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst fov = - 90; // negative fov is not an error\nconst aspect = 1;\n\nclass CubeCamera extends Object3D {\n\n\tconstructor( near, far, renderTarget ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CubeCamera';\n\n\t\tthis.renderTarget = renderTarget;\n\t\tthis.coordinateSystem = null;\n\t\tthis.activeMipmapLevel = 0;\n\n\t\tconst cameraPX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPX.layers = this.layers;\n\t\tthis.add( cameraPX );\n\n\t\tconst cameraNX = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNX.layers = this.layers;\n\t\tthis.add( cameraNX );\n\n\t\tconst cameraPY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPY.layers = this.layers;\n\t\tthis.add( cameraPY );\n\n\t\tconst cameraNY = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNY.layers = this.layers;\n\t\tthis.add( cameraNY );\n\n\t\tconst cameraPZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraPZ.layers = this.layers;\n\t\tthis.add( cameraPZ );\n\n\t\tconst cameraNZ = new PerspectiveCamera( fov, aspect, near, far );\n\t\tcameraNZ.layers = this.layers;\n\t\tthis.add( cameraNZ );\n\n\t}\n\n\tupdateCoordinateSystem() {\n\n\t\tconst coordinateSystem = this.coordinateSystem;\n\n\t\tconst cameras = this.children.concat();\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = cameras;\n\n\t\tfor ( const camera of cameras ) this.remove( camera );\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tcameraPX.up.set( 0, 1, 0 );\n\t\t\tcameraPX.lookAt( 1, 0, 0 );\n\n\t\t\tcameraNX.up.set( 0, 1, 0 );\n\t\t\tcameraNX.lookAt( - 1, 0, 0 );\n\n\t\t\tcameraPY.up.set( 0, 0, - 1 );\n\t\t\tcameraPY.lookAt( 0, 1, 0 );\n\n\t\t\tcameraNY.up.set( 0, 0, 1 );\n\t\t\tcameraNY.lookAt( 0, - 1, 0 );\n\n\t\t\tcameraPZ.up.set( 0, 1, 0 );\n\t\t\tcameraPZ.lookAt( 0, 0, 1 );\n\n\t\t\tcameraNZ.up.set( 0, 1, 0 );\n\t\t\tcameraNZ.lookAt( 0, 0, - 1 );\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tcameraPX.up.set( 0, - 1, 0 );\n\t\t\tcameraPX.lookAt( - 1, 0, 0 );\n\n\t\t\tcameraNX.up.set( 0, - 1, 0 );\n\t\t\tcameraNX.lookAt( 1, 0, 0 );\n\n\t\t\tcameraPY.up.set( 0, 0, 1 );\n\t\t\tcameraPY.lookAt( 0, 1, 0 );\n\n\t\t\tcameraNY.up.set( 0, 0, - 1 );\n\t\t\tcameraNY.lookAt( 0, - 1, 0 );\n\n\t\t\tcameraPZ.up.set( 0, - 1, 0 );\n\t\t\tcameraPZ.lookAt( 0, 0, 1 );\n\n\t\t\tcameraNZ.up.set( 0, - 1, 0 );\n\t\t\tcameraNZ.lookAt( 0, 0, - 1 );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\tfor ( const camera of cameras ) {\n\n\t\t\tthis.add( camera );\n\n\t\t\tcamera.updateMatrixWorld();\n\n\t\t}\n\n\t}\n\n\tupdate( renderer, scene ) {\n\n\t\tif ( this.parent === null ) this.updateMatrixWorld();\n\n\t\tconst { renderTarget, activeMipmapLevel } = this;\n\n\t\tif ( this.coordinateSystem !== renderer.coordinateSystem ) {\n\n\t\t\tthis.coordinateSystem = renderer.coordinateSystem;\n\n\t\t\tthis.updateCoordinateSystem();\n\n\t\t}\n\n\t\tconst [ cameraPX, cameraNX, cameraPY, cameraNY, cameraPZ, cameraNZ ] = this.children;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentActiveCubeFace = renderer.getActiveCubeFace();\n\t\tconst currentActiveMipmapLevel = renderer.getActiveMipmapLevel();\n\n\t\tconst currentXrEnabled = renderer.xr.enabled;\n\n\t\trenderer.xr.enabled = false;\n\n\t\tconst generateMipmaps = renderTarget.texture.generateMipmaps;\n\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t\trenderer.setRenderTarget( renderTarget, 0, activeMipmapLevel );\n\t\trenderer.render( scene, cameraPX );\n\n\t\trenderer.setRenderTarget( renderTarget, 1, activeMipmapLevel );\n\t\trenderer.render( scene, cameraNX );\n\n\t\trenderer.setRenderTarget( renderTarget, 2, activeMipmapLevel );\n\t\trenderer.render( scene, cameraPY );\n\n\t\trenderer.setRenderTarget( renderTarget, 3, activeMipmapLevel );\n\t\trenderer.render( scene, cameraNY );\n\n\t\trenderer.setRenderTarget( renderTarget, 4, activeMipmapLevel );\n\t\trenderer.render( scene, cameraPZ );\n\n\t\t// mipmaps are generated during the last call of render()\n\t\t// at this point, all sides of the cube render target are defined\n\n\t\trenderTarget.texture.generateMipmaps = generateMipmaps;\n\n\t\trenderer.setRenderTarget( renderTarget, 5, activeMipmapLevel );\n\t\trenderer.render( scene, cameraNZ );\n\n\t\trenderer.setRenderTarget( currentRenderTarget, currentActiveCubeFace, currentActiveMipmapLevel );\n\n\t\trenderer.xr.enabled = currentXrEnabled;\n\n\t\trenderTarget.texture.needsPMREMUpdate = true;\n\n\t}\n\n}\n\nclass CubeTexture extends Texture {\n\n\tconstructor( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace ) {\n\n\t\timages = images !== undefined ? images : [];\n\t\tmapping = mapping !== undefined ? mapping : CubeReflectionMapping;\n\n\t\tsuper( images, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace );\n\n\t\tthis.isCubeTexture = true;\n\n\t\tthis.flipY = false;\n\n\t}\n\n\tget images() {\n\n\t\treturn this.image;\n\n\t}\n\n\tset images( value ) {\n\n\t\tthis.image = value;\n\n\t}\n\n}\n\nclass WebGLCubeRenderTarget extends WebGLRenderTarget {\n\n\tconstructor( size = 1, options = {} ) {\n\n\t\tsuper( size, size, options );\n\n\t\tthis.isWebGLCubeRenderTarget = true;\n\n\t\tconst image = { width: size, height: size, depth: 1 };\n\t\tconst images = [ image, image, image, image, image, image ];\n\n\t\tthis.texture = new CubeTexture( images, options.mapping, options.wrapS, options.wrapT, options.magFilter, options.minFilter, options.format, options.type, options.anisotropy, options.colorSpace );\n\n\t\t// By convention -- likely based on the RenderMan spec from the 1990's -- cube maps are specified by WebGL (and three.js)\n\t\t// in a coordinate system in which positive-x is to the right when looking up the positive-z axis -- in other words,\n\t\t// in a left-handed coordinate system. By continuing this convention, preexisting cube maps continued to render correctly.\n\n\t\t// three.js uses a right-handed coordinate system. So environment maps used in three.js appear to have px and nx swapped\n\t\t// and the flag isRenderTargetTexture controls this conversion. The flip is not required when using WebGLCubeRenderTarget.texture\n\t\t// as a cube texture (this is detected when isRenderTargetTexture is set to true for cube textures).\n\n\t\tthis.texture.isRenderTargetTexture = true;\n\n\t\tthis.texture.generateMipmaps = options.generateMipmaps !== undefined ? options.generateMipmaps : false;\n\t\tthis.texture.minFilter = options.minFilter !== undefined ? options.minFilter : LinearFilter;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture ) {\n\n\t\tthis.texture.type = texture.type;\n\t\tthis.texture.colorSpace = texture.colorSpace;\n\n\t\tthis.texture.generateMipmaps = texture.generateMipmaps;\n\t\tthis.texture.minFilter = texture.minFilter;\n\t\tthis.texture.magFilter = texture.magFilter;\n\n\t\tconst shader = {\n\n\t\t\tuniforms: {\n\t\t\t\ttEquirect: { value: null },\n\t\t\t},\n\n\t\t\tvertexShader: /* glsl */`\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t`,\n\n\t\t\tfragmentShader: /* glsl */`\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t`\n\t\t};\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst material = new ShaderMaterial( {\n\n\t\t\tname: 'CubemapFromEquirect',\n\n\t\t\tuniforms: cloneUniforms( shader.uniforms ),\n\t\t\tvertexShader: shader.vertexShader,\n\t\t\tfragmentShader: shader.fragmentShader,\n\t\t\tside: BackSide,\n\t\t\tblending: NoBlending\n\n\t\t} );\n\n\t\tmaterial.uniforms.tEquirect.value = texture;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst currentMinFilter = texture.minFilter;\n\n\t\t// Avoid blurred poles\n\t\tif ( texture.minFilter === LinearMipmapLinearFilter ) texture.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\t\tcamera.update( renderer, mesh );\n\n\t\ttexture.minFilter = currentMinFilter;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n\tclear( renderer, color, depth, stencil ) {\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\trenderer.setRenderTarget( this, i );\n\n\t\t\trenderer.clear( color, depth, stencil );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n}\n\nclass FogExp2 {\n\n\tconstructor( color, density = 0.00025 ) {\n\n\t\tthis.isFogExp2 = true;\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\t\tthis.density = density;\n\n\t}\n\n\tclone() {\n\n\t\treturn new FogExp2( this.color, this.density );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'FogExp2',\n\t\t\tname: this.name,\n\t\t\tcolor: this.color.getHex(),\n\t\t\tdensity: this.density\n\t\t};\n\n\t}\n\n}\n\nclass Fog {\n\n\tconstructor( color, near = 1, far = 1000 ) {\n\n\t\tthis.isFog = true;\n\n\t\tthis.name = '';\n\n\t\tthis.color = new Color( color );\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Fog( this.color, this.near, this.far );\n\n\t}\n\n\ttoJSON( /* meta */ ) {\n\n\t\treturn {\n\t\t\ttype: 'Fog',\n\t\t\tname: this.name,\n\t\t\tcolor: this.color.getHex(),\n\t\t\tnear: this.near,\n\t\t\tfar: this.far\n\t\t};\n\n\t}\n\n}\n\nclass Scene extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isScene = true;\n\n\t\tthis.type = 'Scene';\n\n\t\tthis.background = null;\n\t\tthis.environment = null;\n\t\tthis.fog = null;\n\n\t\tthis.backgroundBlurriness = 0;\n\t\tthis.backgroundIntensity = 1;\n\t\tthis.backgroundRotation = new Euler();\n\n\t\tthis.environmentIntensity = 1;\n\t\tthis.environmentRotation = new Euler();\n\n\t\tthis.overrideMaterial = null;\n\n\t\tif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t\t\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'observe', { detail: this } ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.background !== null ) this.background = source.background.clone();\n\t\tif ( source.environment !== null ) this.environment = source.environment.clone();\n\t\tif ( source.fog !== null ) this.fog = source.fog.clone();\n\n\t\tthis.backgroundBlurriness = source.backgroundBlurriness;\n\t\tthis.backgroundIntensity = source.backgroundIntensity;\n\t\tthis.backgroundRotation.copy( source.backgroundRotation );\n\n\t\tthis.environmentIntensity = source.environmentIntensity;\n\t\tthis.environmentRotation.copy( source.environmentRotation );\n\n\t\tif ( source.overrideMaterial !== null ) this.overrideMaterial = source.overrideMaterial.clone();\n\n\t\tthis.matrixAutoUpdate = source.matrixAutoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.fog !== null ) data.object.fog = this.fog.toJSON();\n\n\t\tif ( this.backgroundBlurriness > 0 ) data.object.backgroundBlurriness = this.backgroundBlurriness;\n\t\tif ( this.backgroundIntensity !== 1 ) data.object.backgroundIntensity = this.backgroundIntensity;\n\t\tdata.object.backgroundRotation = this.backgroundRotation.toArray();\n\n\t\tif ( this.environmentIntensity !== 1 ) data.object.environmentIntensity = this.environmentIntensity;\n\t\tdata.object.environmentRotation = this.environmentRotation.toArray();\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass InterleavedBuffer {\n\n\tconstructor( array, stride ) {\n\n\t\tthis.isInterleavedBuffer = true;\n\n\t\tthis.array = array;\n\t\tthis.stride = stride;\n\t\tthis.count = array !== undefined ? array.length / stride : 0;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.updateRanges = [];\n\n\t\tthis.version = 0;\n\n\t\tthis.uuid = generateUUID();\n\n\t}\n\n\tonUploadCallback() {}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\taddUpdateRange( start, count ) {\n\n\t\tthis.updateRanges.push( { start, count } );\n\n\t}\n\n\tclearUpdateRanges() {\n\n\t\tthis.updateRanges.length = 0;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.array = new source.array.constructor( source.array );\n\t\tthis.count = source.count;\n\t\tthis.stride = source.stride;\n\t\tthis.usage = source.usage;\n\n\t\treturn this;\n\n\t}\n\n\tcopyAt( index1, attribute, index2 ) {\n\n\t\tindex1 *= this.stride;\n\t\tindex2 *= attribute.stride;\n\n\t\tfor ( let i = 0, l = this.stride; i < l; i ++ ) {\n\n\t\t\tthis.array[ index1 + i ] = attribute.array[ index2 + i ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( value, offset = 0 ) {\n\n\t\tthis.array.set( value, offset );\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = this.array.slice( 0 ).buffer;\n\n\t\t}\n\n\t\tconst array = new this.array.constructor( data.arrayBuffers[ this.array.buffer._uuid ] );\n\n\t\tconst ib = new this.constructor( array, this.stride );\n\t\tib.setUsage( this.usage );\n\n\t\treturn ib;\n\n\t}\n\n\tonUpload( callback ) {\n\n\t\tthis.onUploadCallback = callback;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data.arrayBuffers === undefined ) {\n\n\t\t\tdata.arrayBuffers = {};\n\n\t\t}\n\n\t\t// generate UUID for array buffer if necessary\n\n\t\tif ( this.array.buffer._uuid === undefined ) {\n\n\t\t\tthis.array.buffer._uuid = generateUUID();\n\n\t\t}\n\n\t\tif ( data.arrayBuffers[ this.array.buffer._uuid ] === undefined ) {\n\n\t\t\tdata.arrayBuffers[ this.array.buffer._uuid ] = Array.from( new Uint32Array( this.array.buffer ) );\n\n\t\t}\n\n\t\t//\n\n\t\treturn {\n\t\t\tuuid: this.uuid,\n\t\t\tbuffer: this.array.buffer._uuid,\n\t\t\ttype: this.array.constructor.name,\n\t\t\tstride: this.stride\n\t\t};\n\n\t}\n\n}\n\nconst _vector$7 = /*@__PURE__*/ new Vector3();\n\nclass InterleavedBufferAttribute {\n\n\tconstructor( interleavedBuffer, itemSize, offset, normalized = false ) {\n\n\t\tthis.isInterleavedBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.data = interleavedBuffer;\n\t\tthis.itemSize = itemSize;\n\t\tthis.offset = offset;\n\n\t\tthis.normalized = normalized;\n\n\t}\n\n\tget count() {\n\n\t\treturn this.data.count;\n\n\t}\n\n\tget array() {\n\n\t\treturn this.data.array;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tthis.data.needsUpdate = value;\n\n\t}\n\n\tapplyMatrix4( m ) {\n\n\t\tfor ( let i = 0, l = this.data.count; i < l; i ++ ) {\n\n\t\t\t_vector$7.fromBufferAttribute( this, i );\n\n\t\t\t_vector$7.applyMatrix4( m );\n\n\t\t\tthis.setXYZ( i, _vector$7.x, _vector$7.y, _vector$7.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tapplyNormalMatrix( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$7.fromBufferAttribute( this, i );\n\n\t\t\t_vector$7.applyNormalMatrix( m );\n\n\t\t\tthis.setXYZ( i, _vector$7.x, _vector$7.y, _vector$7.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttransformDirection( m ) {\n\n\t\tfor ( let i = 0, l = this.count; i < l; i ++ ) {\n\n\t\t\t_vector$7.fromBufferAttribute( this, i );\n\n\t\t\t_vector$7.transformDirection( m );\n\n\t\t\tthis.setXYZ( i, _vector$7.x, _vector$7.y, _vector$7.z );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetComponent( index, component ) {\n\n\t\tlet value = this.array[ index * this.data.stride + this.offset + component ];\n\n\t\tif ( this.normalized ) value = denormalize( value, this.array );\n\n\t\treturn value;\n\n\t}\n\n\tsetComponent( index, component, value ) {\n\n\t\tif ( this.normalized ) value = normalize$1( value, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + component ] = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetX( index, x ) {\n\n\t\tif ( this.normalized ) x = normalize$1( x, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset ] = x;\n\n\t\treturn this;\n\n\t}\n\n\tsetY( index, y ) {\n\n\t\tif ( this.normalized ) y = normalize$1( y, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetZ( index, z ) {\n\n\t\tif ( this.normalized ) z = normalize$1( z, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetW( index, w ) {\n\n\t\tif ( this.normalized ) w = normalize$1( w, this.array );\n\n\t\tthis.data.array[ index * this.data.stride + this.offset + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tgetX( index ) {\n\n\t\tlet x = this.data.array[ index * this.data.stride + this.offset ];\n\n\t\tif ( this.normalized ) x = denormalize( x, this.array );\n\n\t\treturn x;\n\n\t}\n\n\tgetY( index ) {\n\n\t\tlet y = this.data.array[ index * this.data.stride + this.offset + 1 ];\n\n\t\tif ( this.normalized ) y = denormalize( y, this.array );\n\n\t\treturn y;\n\n\t}\n\n\tgetZ( index ) {\n\n\t\tlet z = this.data.array[ index * this.data.stride + this.offset + 2 ];\n\n\t\tif ( this.normalized ) z = denormalize( z, this.array );\n\n\t\treturn z;\n\n\t}\n\n\tgetW( index ) {\n\n\t\tlet w = this.data.array[ index * this.data.stride + this.offset + 3 ];\n\n\t\tif ( this.normalized ) w = denormalize( w, this.array );\n\n\t\treturn w;\n\n\t}\n\n\tsetXY( index, x, y ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZ( index, x, y, z ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\t\t\tz = normalize$1( z, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\n\t\treturn this;\n\n\t}\n\n\tsetXYZW( index, x, y, z, w ) {\n\n\t\tindex = index * this.data.stride + this.offset;\n\n\t\tif ( this.normalized ) {\n\n\t\t\tx = normalize$1( x, this.array );\n\t\t\ty = normalize$1( y, this.array );\n\t\t\tz = normalize$1( z, this.array );\n\t\t\tw = normalize$1( w, this.array );\n\n\t\t}\n\n\t\tthis.data.array[ index + 0 ] = x;\n\t\tthis.data.array[ index + 1 ] = y;\n\t\tthis.data.array[ index + 2 ] = z;\n\t\tthis.data.array[ index + 3 ] = w;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new BufferAttribute( new this.array.constructor( array ), this.itemSize, this.normalized );\n\n\t\t} else {\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.clone( data );\n\n\t\t\t}\n\n\t\t\treturn new InterleavedBufferAttribute( data.interleavedBuffers[ this.data.uuid ], this.itemSize, this.offset, this.normalized );\n\n\t\t}\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconsole.log( 'THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.' );\n\n\t\t\tconst array = [];\n\n\t\t\tfor ( let i = 0; i < this.count; i ++ ) {\n\n\t\t\t\tconst index = i * this.data.stride + this.offset;\n\n\t\t\t\tfor ( let j = 0; j < this.itemSize; j ++ ) {\n\n\t\t\t\t\tarray.push( this.data.array[ index + j ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// de-interleave data and save it as an ordinary buffer attribute for now\n\n\t\t\treturn {\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\ttype: this.array.constructor.name,\n\t\t\t\tarray: array,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t} else {\n\n\t\t\t// save as true interleaved attribute\n\n\t\t\tif ( data.interleavedBuffers === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers = {};\n\n\t\t\t}\n\n\t\t\tif ( data.interleavedBuffers[ this.data.uuid ] === undefined ) {\n\n\t\t\t\tdata.interleavedBuffers[ this.data.uuid ] = this.data.toJSON( data );\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tisInterleavedBufferAttribute: true,\n\t\t\t\titemSize: this.itemSize,\n\t\t\t\tdata: this.data.uuid,\n\t\t\t\toffset: this.offset,\n\t\t\t\tnormalized: this.normalized\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nclass SpriteMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'SpriteMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isSpriteMaterial = true;\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.rotation = 0;\n\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.transparent = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.rotation = source.rotation;\n\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nlet _geometry$1;\n\nconst _intersectPoint = /*@__PURE__*/ new Vector3();\nconst _worldScale = /*@__PURE__*/ new Vector3();\nconst _mvPosition = /*@__PURE__*/ new Vector3();\n\nconst _alignedPosition = /*@__PURE__*/ new Vector2();\nconst _rotatedPosition = /*@__PURE__*/ new Vector2();\nconst _viewWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _vA = /*@__PURE__*/ new Vector3();\nconst _vB = /*@__PURE__*/ new Vector3();\nconst _vC = /*@__PURE__*/ new Vector3();\n\nconst _uvA = /*@__PURE__*/ new Vector2();\nconst _uvB = /*@__PURE__*/ new Vector2();\nconst _uvC = /*@__PURE__*/ new Vector2();\n\nclass Sprite extends Object3D {\n\n\tconstructor( material = new SpriteMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isSprite = true;\n\n\t\tthis.type = 'Sprite';\n\n\t\tif ( _geometry$1 === undefined ) {\n\n\t\t\t_geometry$1 = new BufferGeometry();\n\n\t\t\tconst float32Array = new Float32Array( [\n\t\t\t\t- 0.5, - 0.5, 0, 0, 0,\n\t\t\t\t0.5, - 0.5, 0, 1, 0,\n\t\t\t\t0.5, 0.5, 0, 1, 1,\n\t\t\t\t- 0.5, 0.5, 0, 0, 1\n\t\t\t] );\n\n\t\t\tconst interleavedBuffer = new InterleavedBuffer( float32Array, 5 );\n\n\t\t\t_geometry$1.setIndex( [ 0, 1, 2,\t0, 2, 3 ] );\n\t\t\t_geometry$1.setAttribute( 'position', new InterleavedBufferAttribute( interleavedBuffer, 3, 0, false ) );\n\t\t\t_geometry$1.setAttribute( 'uv', new InterleavedBufferAttribute( interleavedBuffer, 2, 3, false ) );\n\n\t\t}\n\n\t\tthis.geometry = _geometry$1;\n\t\tthis.material = material;\n\n\t\tthis.center = new Vector2( 0.5, 0.5 );\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tif ( raycaster.camera === null ) {\n\n\t\t\tconsole.error( 'THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.' );\n\n\t\t}\n\n\t\t_worldScale.setFromMatrixScale( this.matrixWorld );\n\n\t\t_viewWorldMatrix.copy( raycaster.camera.matrixWorld );\n\t\tthis.modelViewMatrix.multiplyMatrices( raycaster.camera.matrixWorldInverse, this.matrixWorld );\n\n\t\t_mvPosition.setFromMatrixPosition( this.modelViewMatrix );\n\n\t\tif ( raycaster.camera.isPerspectiveCamera && this.material.sizeAttenuation === false ) {\n\n\t\t\t_worldScale.multiplyScalar( - _mvPosition.z );\n\n\t\t}\n\n\t\tconst rotation = this.material.rotation;\n\t\tlet sin, cos;\n\n\t\tif ( rotation !== 0 ) {\n\n\t\t\tcos = Math.cos( rotation );\n\t\t\tsin = Math.sin( rotation );\n\n\t\t}\n\n\t\tconst center = this.center;\n\n\t\ttransformVertex( _vA.set( - 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vB.set( 0.5, - 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\ttransformVertex( _vC.set( 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\n\t\t_uvA.set( 0, 0 );\n\t\t_uvB.set( 1, 0 );\n\t\t_uvC.set( 1, 1 );\n\n\t\t// check first triangle\n\t\tlet intersect = raycaster.ray.intersectTriangle( _vA, _vB, _vC, false, _intersectPoint );\n\n\t\tif ( intersect === null ) {\n\n\t\t\t// check second triangle\n\t\t\ttransformVertex( _vB.set( - 0.5, 0.5, 0 ), _mvPosition, center, _worldScale, sin, cos );\n\t\t\t_uvB.set( 0, 1 );\n\n\t\t\tintersect = raycaster.ray.intersectTriangle( _vA, _vC, _vB, false, _intersectPoint );\n\t\t\tif ( intersect === null ) {\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( _intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tpoint: _intersectPoint.clone(),\n\t\t\tuv: Triangle.getInterpolation( _intersectPoint, _vA, _vB, _vC, _uvA, _uvB, _uvC, new Vector2() ),\n\t\t\tface: null,\n\t\t\tobject: this\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tif ( source.center !== undefined ) this.center.copy( source.center );\n\n\t\tthis.material = source.material;\n\n\t\treturn this;\n\n\t}\n\n}\n\nfunction transformVertex( vertexPosition, mvPosition, center, scale, sin, cos ) {\n\n\t// compute position in camera space\n\t_alignedPosition.subVectors( vertexPosition, center ).addScalar( 0.5 ).multiply( scale );\n\n\t// to check if rotation is not zero\n\tif ( sin !== undefined ) {\n\n\t\t_rotatedPosition.x = ( cos * _alignedPosition.x ) - ( sin * _alignedPosition.y );\n\t\t_rotatedPosition.y = ( sin * _alignedPosition.x ) + ( cos * _alignedPosition.y );\n\n\t} else {\n\n\t\t_rotatedPosition.copy( _alignedPosition );\n\n\t}\n\n\n\tvertexPosition.copy( mvPosition );\n\tvertexPosition.x += _rotatedPosition.x;\n\tvertexPosition.y += _rotatedPosition.y;\n\n\t// transform to world space\n\tvertexPosition.applyMatrix4( _viewWorldMatrix );\n\n}\n\nconst _v1$2 = /*@__PURE__*/ new Vector3();\nconst _v2$1 = /*@__PURE__*/ new Vector3();\n\nclass LOD extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis._currentLevel = 0;\n\n\t\tthis.type = 'LOD';\n\n\t\tObject.defineProperties( this, {\n\t\t\tlevels: {\n\t\t\t\tenumerable: true,\n\t\t\t\tvalue: []\n\t\t\t},\n\t\t\tisLOD: {\n\t\t\t\tvalue: true,\n\t\t\t}\n\t\t} );\n\n\t\tthis.autoUpdate = true;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tconst levels = source.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tthis.addLevel( level.object.clone(), level.distance, level.hysteresis );\n\n\t\t}\n\n\t\tthis.autoUpdate = source.autoUpdate;\n\n\t\treturn this;\n\n\t}\n\n\taddLevel( object, distance = 0, hysteresis = 0 ) {\n\n\t\tdistance = Math.abs( distance );\n\n\t\tconst levels = this.levels;\n\n\t\tlet l;\n\n\t\tfor ( l = 0; l < levels.length; l ++ ) {\n\n\t\t\tif ( distance < levels[ l ].distance ) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlevels.splice( l, 0, { distance: distance, hysteresis: hysteresis, object: object } );\n\n\t\tthis.add( object );\n\n\t\treturn this;\n\n\t}\n\n\tremoveLevel( distance ) {\n\n\t\tconst levels = this.levels;\n\n\t\tfor ( let i = 0; i < levels.length; i ++ ) {\n\n\t\t\tif ( levels[ i ].distance === distance ) {\n\n\t\t\t\tconst removedElements = levels.splice( i, 1 );\n\t\t\t\tthis.remove( removedElements[ 0 ].object );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetCurrentLevel() {\n\n\t\treturn this._currentLevel;\n\n\t}\n\n\n\n\tgetObjectForDistance( distance ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tlet levelDistance = levels[ i ].distance;\n\n\t\t\t\tif ( levels[ i ].object.visible ) {\n\n\t\t\t\t\tlevelDistance -= levelDistance * levels[ i ].hysteresis;\n\n\t\t\t\t}\n\n\t\t\t\tif ( distance < levelDistance ) {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn levels[ i - 1 ].object;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 0 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = raycaster.ray.origin.distanceTo( _v1$2 );\n\n\t\t\tthis.getObjectForDistance( distance ).raycast( raycaster, intersects );\n\n\t\t}\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst levels = this.levels;\n\n\t\tif ( levels.length > 1 ) {\n\n\t\t\t_v1$2.setFromMatrixPosition( camera.matrixWorld );\n\t\t\t_v2$1.setFromMatrixPosition( this.matrixWorld );\n\n\t\t\tconst distance = _v1$2.distanceTo( _v2$1 ) / camera.zoom;\n\n\t\t\tlevels[ 0 ].object.visible = true;\n\n\t\t\tlet i, l;\n\n\t\t\tfor ( i = 1, l = levels.length; i < l; i ++ ) {\n\n\t\t\t\tlet levelDistance = levels[ i ].distance;\n\n\t\t\t\tif ( levels[ i ].object.visible ) {\n\n\t\t\t\t\tlevelDistance -= levelDistance * levels[ i ].hysteresis;\n\n\t\t\t\t}\n\n\t\t\t\tif ( distance >= levelDistance ) {\n\n\t\t\t\t\tlevels[ i - 1 ].object.visible = false;\n\t\t\t\t\tlevels[ i ].object.visible = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._currentLevel = i - 1;\n\n\t\t\tfor ( ; i < l; i ++ ) {\n\n\t\t\t\tlevels[ i ].object.visible = false;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.autoUpdate === false ) data.object.autoUpdate = false;\n\n\t\tdata.object.levels = [];\n\n\t\tconst levels = this.levels;\n\n\t\tfor ( let i = 0, l = levels.length; i < l; i ++ ) {\n\n\t\t\tconst level = levels[ i ];\n\n\t\t\tdata.object.levels.push( {\n\t\t\t\tobject: level.object.uuid,\n\t\t\t\tdistance: level.distance,\n\t\t\t\thysteresis: level.hysteresis\n\t\t\t} );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _basePosition = /*@__PURE__*/ new Vector3();\n\nconst _skinIndex = /*@__PURE__*/ new Vector4();\nconst _skinWeight = /*@__PURE__*/ new Vector4();\n\nconst _vector3 = /*@__PURE__*/ new Vector3();\nconst _matrix4 = /*@__PURE__*/ new Matrix4();\nconst _vertex = /*@__PURE__*/ new Vector3();\n\nconst _sphere$5 = /*@__PURE__*/ new Sphere();\nconst _inverseMatrix$2 = /*@__PURE__*/ new Matrix4();\nconst _ray$2 = /*@__PURE__*/ new Ray();\n\nclass SkinnedMesh extends Mesh {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isSkinnedMesh = true;\n\n\t\tthis.type = 'SkinnedMesh';\n\n\t\tthis.bindMode = AttachedBindMode;\n\t\tthis.bindMatrix = new Matrix4();\n\t\tthis.bindMatrixInverse = new Matrix4();\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tthis.boundingBox.makeEmpty();\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i ++ ) {\n\n\t\t\tthis.getVertexPosition( i, _vertex );\n\t\t\tthis.boundingBox.expandByPoint( _vertex );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tthis.boundingSphere.makeEmpty();\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i ++ ) {\n\n\t\t\tthis.getVertexPosition( i, _vertex );\n\t\t\tthis.boundingSphere.expandByPoint( _vertex );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.bindMode = source.bindMode;\n\t\tthis.bindMatrix.copy( source.bindMatrix );\n\t\tthis.bindMatrixInverse.copy( source.bindMatrixInverse );\n\n\t\tthis.skeleton = source.skeleton;\n\n\t\tif ( source.boundingBox !== null ) this.boundingBox = source.boundingBox.clone();\n\t\tif ( source.boundingSphere !== null ) this.boundingSphere = source.boundingSphere.clone();\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst material = this.material;\n\t\tconst matrixWorld = this.matrixWorld;\n\n\t\tif ( material === undefined ) return;\n\n\t\t// test with bounding sphere in world space\n\n\t\tif ( this.boundingSphere === null ) this.computeBoundingSphere();\n\n\t\t_sphere$5.copy( this.boundingSphere );\n\t\t_sphere$5.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$5 ) === false ) return;\n\n\t\t// convert ray to local space of skinned mesh\n\n\t\t_inverseMatrix$2.copy( matrixWorld ).invert();\n\t\t_ray$2.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$2 );\n\n\t\t// test with bounding box in local space\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tif ( _ray$2.intersectsBox( this.boundingBox ) === false ) return;\n\n\t\t}\n\n\t\t// test for intersections with geometry\n\n\t\tthis._computeIntersections( raycaster, intersects, _ray$2 );\n\n\t}\n\n\tgetVertexPosition( index, target ) {\n\n\t\tsuper.getVertexPosition( index, target );\n\n\t\tthis.applyBoneTransform( index, target );\n\n\t\treturn target;\n\n\t}\n\n\tbind( skeleton, bindMatrix ) {\n\n\t\tthis.skeleton = skeleton;\n\n\t\tif ( bindMatrix === undefined ) {\n\n\t\t\tthis.updateMatrixWorld( true );\n\n\t\t\tthis.skeleton.calculateInverses();\n\n\t\t\tbindMatrix = this.matrixWorld;\n\n\t\t}\n\n\t\tthis.bindMatrix.copy( bindMatrix );\n\t\tthis.bindMatrixInverse.copy( bindMatrix ).invert();\n\n\t}\n\n\tpose() {\n\n\t\tthis.skeleton.pose();\n\n\t}\n\n\tnormalizeSkinWeights() {\n\n\t\tconst vector = new Vector4();\n\n\t\tconst skinWeight = this.geometry.attributes.skinWeight;\n\n\t\tfor ( let i = 0, l = skinWeight.count; i < l; i ++ ) {\n\n\t\t\tvector.fromBufferAttribute( skinWeight, i );\n\n\t\t\tconst scale = 1.0 / vector.manhattanLength();\n\n\t\t\tif ( scale !== Infinity ) {\n\n\t\t\t\tvector.multiplyScalar( scale );\n\n\t\t\t} else {\n\n\t\t\t\tvector.set( 1, 0, 0, 0 ); // do something reasonable\n\n\t\t\t}\n\n\t\t\tskinWeight.setXYZW( i, vector.x, vector.y, vector.z, vector.w );\n\n\t\t}\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.bindMode === AttachedBindMode ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.matrixWorld ).invert();\n\n\t\t} else if ( this.bindMode === DetachedBindMode ) {\n\n\t\t\tthis.bindMatrixInverse.copy( this.bindMatrix ).invert();\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.SkinnedMesh: Unrecognized bindMode: ' + this.bindMode );\n\n\t\t}\n\n\t}\n\n\tapplyBoneTransform( index, vector ) {\n\n\t\tconst skeleton = this.skeleton;\n\t\tconst geometry = this.geometry;\n\n\t\t_skinIndex.fromBufferAttribute( geometry.attributes.skinIndex, index );\n\t\t_skinWeight.fromBufferAttribute( geometry.attributes.skinWeight, index );\n\n\t\t_basePosition.copy( vector ).applyMatrix4( this.bindMatrix );\n\n\t\tvector.set( 0, 0, 0 );\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tconst weight = _skinWeight.getComponent( i );\n\n\t\t\tif ( weight !== 0 ) {\n\n\t\t\t\tconst boneIndex = _skinIndex.getComponent( i );\n\n\t\t\t\t_matrix4.multiplyMatrices( skeleton.bones[ boneIndex ].matrixWorld, skeleton.boneInverses[ boneIndex ] );\n\n\t\t\t\tvector.addScaledVector( _vector3.copy( _basePosition ).applyMatrix4( _matrix4 ), weight );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn vector.applyMatrix4( this.bindMatrixInverse );\n\n\t}\n\n}\n\nclass Bone extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBone = true;\n\n\t\tthis.type = 'Bone';\n\n\t}\n\n}\n\nclass DataTexture extends Texture {\n\n\tconstructor( data = null, width = 1, height = 1, format, type, mapping, wrapS, wrapT, magFilter = NearestFilter, minFilter = NearestFilter, anisotropy, colorSpace ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace );\n\n\t\tthis.isDataTexture = true;\n\n\t\tthis.image = { data: data, width: width, height: height };\n\n\t\tthis.generateMipmaps = false;\n\t\tthis.flipY = false;\n\t\tthis.unpackAlignment = 1;\n\n\t}\n\n}\n\nconst _offsetMatrix = /*@__PURE__*/ new Matrix4();\nconst _identityMatrix = /*@__PURE__*/ new Matrix4();\n\nclass Skeleton {\n\n\tconstructor( bones = [], boneInverses = [] ) {\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.bones = bones.slice( 0 );\n\t\tthis.boneInverses = boneInverses;\n\t\tthis.boneMatrices = null;\n\n\t\tthis.boneTexture = null;\n\n\t\tthis.init();\n\n\t}\n\n\tinit() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tthis.boneMatrices = new Float32Array( bones.length * 16 );\n\n\t\t// calculate inverse bone matrices if necessary\n\n\t\tif ( boneInverses.length === 0 ) {\n\n\t\t\tthis.calculateInverses();\n\n\t\t} else {\n\n\t\t\t// handle special case\n\n\t\t\tif ( bones.length !== boneInverses.length ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: Number of inverse bone matrices does not match amount of bones.' );\n\n\t\t\t\tthis.boneInverses = [];\n\n\t\t\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\t\t\tthis.boneInverses.push( new Matrix4() );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcalculateInverses() {\n\n\t\tthis.boneInverses.length = 0;\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst inverse = new Matrix4();\n\n\t\t\tif ( this.bones[ i ] ) {\n\n\t\t\t\tinverse.copy( this.bones[ i ].matrixWorld ).invert();\n\n\t\t\t}\n\n\t\t\tthis.boneInverses.push( inverse );\n\n\t\t}\n\n\t}\n\n\tpose() {\n\n\t\t// recover the bind-time world matrices\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tbone.matrixWorld.copy( this.boneInverses[ i ] ).invert();\n\n\t\t\t}\n\n\t\t}\n\n\t\t// compute the local matrices, positions, rotations and scales\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone ) {\n\n\t\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t\tbone.matrix.copy( bone.parent.matrixWorld ).invert();\n\t\t\t\t\tbone.matrix.multiply( bone.matrixWorld );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbone.matrix.copy( bone.matrixWorld );\n\n\t\t\t\t}\n\n\t\t\t\tbone.matrix.decompose( bone.position, bone.quaternion, bone.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\t\tconst boneMatrices = this.boneMatrices;\n\t\tconst boneTexture = this.boneTexture;\n\n\t\t// flatten bone matrices to array\n\n\t\tfor ( let i = 0, il = bones.length; i < il; i ++ ) {\n\n\t\t\t// compute the offset between the current and the original transform\n\n\t\t\tconst matrix = bones[ i ] ? bones[ i ].matrixWorld : _identityMatrix;\n\n\t\t\t_offsetMatrix.multiplyMatrices( matrix, boneInverses[ i ] );\n\t\t\t_offsetMatrix.toArray( boneMatrices, i * 16 );\n\n\t\t}\n\n\t\tif ( boneTexture !== null ) {\n\n\t\t\tboneTexture.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new Skeleton( this.bones, this.boneInverses );\n\n\t}\n\n\tcomputeBoneTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 bones * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 bones * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 bones * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 bones * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this.bones.length * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = Math.ceil( size / 4 ) * 4;\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst boneMatrices = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tboneMatrices.set( this.boneMatrices ); // copy current values\n\n\t\tconst boneTexture = new DataTexture( boneMatrices, size, size, RGBAFormat, FloatType );\n\t\tboneTexture.needsUpdate = true;\n\n\t\tthis.boneMatrices = boneMatrices;\n\t\tthis.boneTexture = boneTexture;\n\n\t\treturn this;\n\n\t}\n\n\tgetBoneByName( name ) {\n\n\t\tfor ( let i = 0, il = this.bones.length; i < il; i ++ ) {\n\n\t\t\tconst bone = this.bones[ i ];\n\n\t\t\tif ( bone.name === name ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\tdispose( ) {\n\n\t\tif ( this.boneTexture !== null ) {\n\n\t\t\tthis.boneTexture.dispose();\n\n\t\t\tthis.boneTexture = null;\n\n\t\t}\n\n\t}\n\n\tfromJSON( json, bones ) {\n\n\t\tthis.uuid = json.uuid;\n\n\t\tfor ( let i = 0, l = json.bones.length; i < l; i ++ ) {\n\n\t\t\tconst uuid = json.bones[ i ];\n\t\t\tlet bone = bones[ uuid ];\n\n\t\t\tif ( bone === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.Skeleton: No bone found with UUID:', uuid );\n\t\t\t\tbone = new Bone();\n\n\t\t\t}\n\n\t\t\tthis.bones.push( bone );\n\t\t\tthis.boneInverses.push( new Matrix4().fromArray( json.boneInverses[ i ] ) );\n\n\t\t}\n\n\t\tthis.init();\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Skeleton',\n\t\t\t\tgenerator: 'Skeleton.toJSON'\n\t\t\t},\n\t\t\tbones: [],\n\t\t\tboneInverses: []\n\t\t};\n\n\t\tdata.uuid = this.uuid;\n\n\t\tconst bones = this.bones;\n\t\tconst boneInverses = this.boneInverses;\n\n\t\tfor ( let i = 0, l = bones.length; i < l; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\t\t\tdata.bones.push( bone.uuid );\n\n\t\t\tconst boneInverse = boneInverses[ i ];\n\t\t\tdata.boneInverses.push( boneInverse.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass InstancedBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, normalized, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, itemSize, normalized );\n\n\t\tthis.isInstancedBufferAttribute = true;\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.meshPerAttribute = this.meshPerAttribute;\n\n\t\tdata.isInstancedBufferAttribute = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst _instanceLocalMatrix = /*@__PURE__*/ new Matrix4();\nconst _instanceWorldMatrix = /*@__PURE__*/ new Matrix4();\n\nconst _instanceIntersects = [];\n\nconst _box3 = /*@__PURE__*/ new Box3();\nconst _identity = /*@__PURE__*/ new Matrix4();\nconst _mesh$1 = /*@__PURE__*/ new Mesh();\nconst _sphere$4 = /*@__PURE__*/ new Sphere();\n\nclass InstancedMesh extends Mesh {\n\n\tconstructor( geometry, material, count ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isInstancedMesh = true;\n\n\t\tthis.instanceMatrix = new InstancedBufferAttribute( new Float32Array( count * 16 ), 16 );\n\t\tthis.instanceColor = null;\n\t\tthis.morphTexture = null;\n\n\t\tthis.count = count;\n\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.setMatrixAt( i, _identity );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst count = this.count;\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tif ( geometry.boundingBox === null ) {\n\n\t\t\tgeometry.computeBoundingBox();\n\n\t\t}\n\n\t\tthis.boundingBox.makeEmpty();\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.getMatrixAt( i, _instanceLocalMatrix );\n\n\t\t\t_box3.copy( geometry.boundingBox ).applyMatrix4( _instanceLocalMatrix );\n\n\t\t\tthis.boundingBox.union( _box3 );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst count = this.count;\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tif ( geometry.boundingSphere === null ) {\n\n\t\t\tgeometry.computeBoundingSphere();\n\n\t\t}\n\n\t\tthis.boundingSphere.makeEmpty();\n\n\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\tthis.getMatrixAt( i, _instanceLocalMatrix );\n\n\t\t\t_sphere$4.copy( geometry.boundingSphere ).applyMatrix4( _instanceLocalMatrix );\n\n\t\t\tthis.boundingSphere.union( _sphere$4 );\n\n\t\t}\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.instanceMatrix.copy( source.instanceMatrix );\n\n\t\tif ( source.morphTexture !== null ) this.morphTexture = source.morphTexture.clone();\n\t\tif ( source.instanceColor !== null ) this.instanceColor = source.instanceColor.clone();\n\n\t\tthis.count = source.count;\n\n\t\tif ( source.boundingBox !== null ) this.boundingBox = source.boundingBox.clone();\n\t\tif ( source.boundingSphere !== null ) this.boundingSphere = source.boundingSphere.clone();\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( index, color ) {\n\n\t\tcolor.fromArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tgetMatrixAt( index, matrix ) {\n\n\t\tmatrix.fromArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tgetMorphAt( index, object ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tconst array = this.morphTexture.source.data.data;\n\n\t\tconst len = objectInfluences.length + 1; // All influences + the baseInfluenceSum\n\n\t\tconst dataIndex = index * len + 1; // Skip the baseInfluenceSum at the beginning\n\n\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\tobjectInfluences[ i ] = array[ dataIndex + i ];\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst raycastTimes = this.count;\n\n\t\t_mesh$1.geometry = this.geometry;\n\t\t_mesh$1.material = this.material;\n\n\t\tif ( _mesh$1.material === undefined ) return;\n\n\t\t// test with bounding sphere first\n\n\t\tif ( this.boundingSphere === null ) this.computeBoundingSphere();\n\n\t\t_sphere$4.copy( this.boundingSphere );\n\t\t_sphere$4.applyMatrix4( matrixWorld );\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$4 ) === false ) return;\n\n\t\t// now test each instance\n\n\t\tfor ( let instanceId = 0; instanceId < raycastTimes; instanceId ++ ) {\n\n\t\t\t// calculate the world matrix for each instance\n\n\t\t\tthis.getMatrixAt( instanceId, _instanceLocalMatrix );\n\n\t\t\t_instanceWorldMatrix.multiplyMatrices( matrixWorld, _instanceLocalMatrix );\n\n\t\t\t// the mesh represents this single instance\n\n\t\t\t_mesh$1.matrixWorld = _instanceWorldMatrix;\n\n\t\t\t_mesh$1.raycast( raycaster, _instanceIntersects );\n\n\t\t\t// process the result of raycast\n\n\t\t\tfor ( let i = 0, l = _instanceIntersects.length; i < l; i ++ ) {\n\n\t\t\t\tconst intersect = _instanceIntersects[ i ];\n\t\t\t\tintersect.instanceId = instanceId;\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_instanceIntersects.length = 0;\n\n\t\t}\n\n\t}\n\n\tsetColorAt( index, color ) {\n\n\t\tif ( this.instanceColor === null ) {\n\n\t\t\tthis.instanceColor = new InstancedBufferAttribute( new Float32Array( this.instanceMatrix.count * 3 ).fill( 1 ), 3 );\n\n\t\t}\n\n\t\tcolor.toArray( this.instanceColor.array, index * 3 );\n\n\t}\n\n\tsetMatrixAt( index, matrix ) {\n\n\t\tmatrix.toArray( this.instanceMatrix.array, index * 16 );\n\n\t}\n\n\tsetMorphAt( index, object ) {\n\n\t\tconst objectInfluences = object.morphTargetInfluences;\n\n\t\tconst len = objectInfluences.length + 1; // morphBaseInfluence + all influences\n\n\t\tif ( this.morphTexture === null ) {\n\n\t\t\tthis.morphTexture = new DataTexture( new Float32Array( len * this.count ), len, this.count, RedFormat, FloatType );\n\n\t\t}\n\n\t\tconst array = this.morphTexture.source.data.data;\n\n\t\tlet morphInfluencesSum = 0;\n\n\t\tfor ( let i = 0; i < objectInfluences.length; i ++ ) {\n\n\t\t\tmorphInfluencesSum += objectInfluences[ i ];\n\n\t\t}\n\n\t\tconst morphBaseInfluence = this.geometry.morphTargetsRelative ? 1 : 1 - morphInfluencesSum;\n\n\t\tconst dataIndex = len * index;\n\n\t\tarray[ dataIndex ] = morphBaseInfluence;\n\n\t\tarray.set( objectInfluences, dataIndex + 1 );\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\tif ( this.morphTexture !== null ) {\n\n\t\t\tthis.morphTexture.dispose();\n\t\t\tthis.morphTexture = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vector1 = /*@__PURE__*/ new Vector3();\nconst _vector2 = /*@__PURE__*/ new Vector3();\nconst _normalMatrix = /*@__PURE__*/ new Matrix3();\n\nclass Plane {\n\n\tconstructor( normal = new Vector3( 1, 0, 0 ), constant = 0 ) {\n\n\t\tthis.isPlane = true;\n\n\t\t// normal is assumed to be normalized\n\n\t\tthis.normal = normal;\n\t\tthis.constant = constant;\n\n\t}\n\n\tset( normal, constant ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = constant;\n\n\t\treturn this;\n\n\t}\n\n\tsetComponents( x, y, z, w ) {\n\n\t\tthis.normal.set( x, y, z );\n\t\tthis.constant = w;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromNormalAndCoplanarPoint( normal, point ) {\n\n\t\tthis.normal.copy( normal );\n\t\tthis.constant = - point.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCoplanarPoints( a, b, c ) {\n\n\t\tconst normal = _vector1.subVectors( c, b ).cross( _vector2.subVectors( a, b ) ).normalize();\n\n\t\t// Q: should an error be thrown if normal is zero (e.g. degenerate plane)?\n\n\t\tthis.setFromNormalAndCoplanarPoint( normal, a );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( plane ) {\n\n\t\tthis.normal.copy( plane.normal );\n\t\tthis.constant = plane.constant;\n\n\t\treturn this;\n\n\t}\n\n\tnormalize() {\n\n\t\t// Note: will lead to a divide by zero if the plane is invalid.\n\n\t\tconst inverseNormalLength = 1.0 / this.normal.length();\n\t\tthis.normal.multiplyScalar( inverseNormalLength );\n\t\tthis.constant *= inverseNormalLength;\n\n\t\treturn this;\n\n\t}\n\n\tnegate() {\n\n\t\tthis.constant *= - 1;\n\t\tthis.normal.negate();\n\n\t\treturn this;\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.normal.dot( point ) + this.constant;\n\n\t}\n\n\tdistanceToSphere( sphere ) {\n\n\t\treturn this.distanceToPoint( sphere.center ) - sphere.radius;\n\n\t}\n\n\tprojectPoint( point, target ) {\n\n\t\treturn target.copy( point ).addScaledVector( this.normal, - this.distanceToPoint( point ) );\n\n\t}\n\n\tintersectLine( line, target ) {\n\n\t\tconst direction = line.delta( _vector1 );\n\n\t\tconst denominator = this.normal.dot( direction );\n\n\t\tif ( denominator === 0 ) {\n\n\t\t\t// line is coplanar, return origin\n\t\t\tif ( this.distanceToPoint( line.start ) === 0 ) {\n\n\t\t\t\treturn target.copy( line.start );\n\n\t\t\t}\n\n\t\t\t// Unsure if this is the correct method to handle this case.\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst t = - ( line.start.dot( this.normal ) + this.constant ) / denominator;\n\n\t\tif ( t < 0 || t > 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn target.copy( line.start ).addScaledVector( direction, t );\n\n\t}\n\n\tintersectsLine( line ) {\n\n\t\t// Note: this tests if a line intersects the plane, not whether it (or its end-points) are coplanar with it.\n\n\t\tconst startSign = this.distanceToPoint( line.start );\n\t\tconst endSign = this.distanceToPoint( line.end );\n\n\t\treturn ( startSign < 0 && endSign > 0 ) || ( endSign < 0 && startSign > 0 );\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\treturn box.intersectsPlane( this );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\treturn sphere.intersectsPlane( this );\n\n\t}\n\n\tcoplanarPoint( target ) {\n\n\t\treturn target.copy( this.normal ).multiplyScalar( - this.constant );\n\n\t}\n\n\tapplyMatrix4( matrix, optionalNormalMatrix ) {\n\n\t\tconst normalMatrix = optionalNormalMatrix || _normalMatrix.getNormalMatrix( matrix );\n\n\t\tconst referencePoint = this.coplanarPoint( _vector1 ).applyMatrix4( matrix );\n\n\t\tconst normal = this.normal.applyMatrix3( normalMatrix ).normalize();\n\n\t\tthis.constant = - referencePoint.dot( normal );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.constant -= offset.dot( this.normal );\n\n\t\treturn this;\n\n\t}\n\n\tequals( plane ) {\n\n\t\treturn plane.normal.equals( this.normal ) && ( plane.constant === this.constant );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _sphere$3 = /*@__PURE__*/ new Sphere();\nconst _vector$6 = /*@__PURE__*/ new Vector3();\n\nclass Frustum {\n\n\tconstructor( p0 = new Plane(), p1 = new Plane(), p2 = new Plane(), p3 = new Plane(), p4 = new Plane(), p5 = new Plane() ) {\n\n\t\tthis.planes = [ p0, p1, p2, p3, p4, p5 ];\n\n\t}\n\n\tset( p0, p1, p2, p3, p4, p5 ) {\n\n\t\tconst planes = this.planes;\n\n\t\tplanes[ 0 ].copy( p0 );\n\t\tplanes[ 1 ].copy( p1 );\n\t\tplanes[ 2 ].copy( p2 );\n\t\tplanes[ 3 ].copy( p3 );\n\t\tplanes[ 4 ].copy( p4 );\n\t\tplanes[ 5 ].copy( p5 );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( frustum ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tplanes[ i ].copy( frustum.planes[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromProjectionMatrix( m, coordinateSystem = WebGLCoordinateSystem ) {\n\n\t\tconst planes = this.planes;\n\t\tconst me = m.elements;\n\t\tconst me0 = me[ 0 ], me1 = me[ 1 ], me2 = me[ 2 ], me3 = me[ 3 ];\n\t\tconst me4 = me[ 4 ], me5 = me[ 5 ], me6 = me[ 6 ], me7 = me[ 7 ];\n\t\tconst me8 = me[ 8 ], me9 = me[ 9 ], me10 = me[ 10 ], me11 = me[ 11 ];\n\t\tconst me12 = me[ 12 ], me13 = me[ 13 ], me14 = me[ 14 ], me15 = me[ 15 ];\n\n\t\tplanes[ 0 ].setComponents( me3 - me0, me7 - me4, me11 - me8, me15 - me12 ).normalize();\n\t\tplanes[ 1 ].setComponents( me3 + me0, me7 + me4, me11 + me8, me15 + me12 ).normalize();\n\t\tplanes[ 2 ].setComponents( me3 + me1, me7 + me5, me11 + me9, me15 + me13 ).normalize();\n\t\tplanes[ 3 ].setComponents( me3 - me1, me7 - me5, me11 - me9, me15 - me13 ).normalize();\n\t\tplanes[ 4 ].setComponents( me3 - me2, me7 - me6, me11 - me10, me15 - me14 ).normalize();\n\n\t\tif ( coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tplanes[ 5 ].setComponents( me3 + me2, me7 + me6, me11 + me10, me15 + me14 ).normalize();\n\n\t\t} else if ( coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\tplanes[ 5 ].setComponents( me2, me6, me10, me14 ).normalize();\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: ' + coordinateSystem );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tintersectsObject( object ) {\n\n\t\tif ( object.boundingSphere !== undefined ) {\n\n\t\t\tif ( object.boundingSphere === null ) object.computeBoundingSphere();\n\n\t\t\t_sphere$3.copy( object.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\t} else {\n\n\t\t\tconst geometry = object.geometry;\n\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t_sphere$3.copy( geometry.boundingSphere ).applyMatrix4( object.matrixWorld );\n\n\t\t}\n\n\t\treturn this.intersectsSphere( _sphere$3 );\n\n\t}\n\n\tintersectsSprite( sprite ) {\n\n\t\t_sphere$3.center.set( 0, 0, 0 );\n\t\t_sphere$3.radius = 0.7071067811865476;\n\t\t_sphere$3.applyMatrix4( sprite.matrixWorld );\n\n\t\treturn this.intersectsSphere( _sphere$3 );\n\n\t}\n\n\tintersectsSphere( sphere ) {\n\n\t\tconst planes = this.planes;\n\t\tconst center = sphere.center;\n\t\tconst negRadius = - sphere.radius;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst distance = planes[ i ].distanceToPoint( center );\n\n\t\t\tif ( distance < negRadius ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst plane = planes[ i ];\n\n\t\t\t// corner at max distance\n\n\t\t\t_vector$6.x = plane.normal.x > 0 ? box.max.x : box.min.x;\n\t\t\t_vector$6.y = plane.normal.y > 0 ? box.max.y : box.min.y;\n\t\t\t_vector$6.z = plane.normal.z > 0 ? box.max.z : box.min.z;\n\n\t\t\tif ( plane.distanceToPoint( _vector$6 ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tif ( planes[ i ].distanceToPoint( point ) < 0 ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nfunction ascIdSort( a, b ) {\n\n\treturn a - b;\n\n}\n\nfunction sortOpaque( a, b ) {\n\n\treturn a.z - b.z;\n\n}\n\nfunction sortTransparent( a, b ) {\n\n\treturn b.z - a.z;\n\n}\n\nclass MultiDrawRenderList {\n\n\tconstructor() {\n\n\t\tthis.index = 0;\n\t\tthis.pool = [];\n\t\tthis.list = [];\n\n\t}\n\n\tpush( start, count, z, index ) {\n\n\t\tconst pool = this.pool;\n\t\tconst list = this.list;\n\t\tif ( this.index >= pool.length ) {\n\n\t\t\tpool.push( {\n\n\t\t\t\tstart: - 1,\n\t\t\t\tcount: - 1,\n\t\t\t\tz: - 1,\n\t\t\t\tindex: - 1,\n\n\t\t\t} );\n\n\t\t}\n\n\t\tconst item = pool[ this.index ];\n\t\tlist.push( item );\n\t\tthis.index ++;\n\n\t\titem.start = start;\n\t\titem.count = count;\n\t\titem.z = z;\n\t\titem.index = index;\n\n\t}\n\n\treset() {\n\n\t\tthis.list.length = 0;\n\t\tthis.index = 0;\n\n\t}\n\n}\n\nconst _matrix$1 = /*@__PURE__*/ new Matrix4();\nconst _whiteColor = /*@__PURE__*/ new Color( 1, 1, 1 );\nconst _frustum$1 = /*@__PURE__*/ new Frustum();\nconst _box$1 = /*@__PURE__*/ new Box3();\nconst _sphere$2 = /*@__PURE__*/ new Sphere();\nconst _vector$5 = /*@__PURE__*/ new Vector3();\nconst _forward = /*@__PURE__*/ new Vector3();\nconst _temp = /*@__PURE__*/ new Vector3();\nconst _renderList = /*@__PURE__*/ new MultiDrawRenderList();\nconst _mesh = /*@__PURE__*/ new Mesh();\nconst _batchIntersects = [];\n\n// copies data from attribute \"src\" into \"target\" starting at \"targetOffset\"\nfunction copyAttributeData( src, target, targetOffset = 0 ) {\n\n\tconst itemSize = target.itemSize;\n\tif ( src.isInterleavedBufferAttribute || src.array.constructor !== target.array.constructor ) {\n\n\t\t// use the component getters and setters if the array data cannot\n\t\t// be copied directly\n\t\tconst vertexCount = src.count;\n\t\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\ttarget.setComponent( i + targetOffset, c, src.getComponent( i, c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// faster copy approach using typed array set function\n\t\ttarget.array.set( src.array, targetOffset * itemSize );\n\n\t}\n\n\ttarget.needsUpdate = true;\n\n}\n\n// safely copies array contents to a potentially smaller array\nfunction copyArrayContents( src, target ) {\n\n\tif ( src.constructor !== target.constructor ) {\n\n\t\t// if arrays are of a different type (eg due to index size increasing) then data must be per-element copied\n\t\tconst len = Math.min( src.length, target.length );\n\t\tfor ( let i = 0; i < len; i ++ ) {\n\n\t\t\ttarget[ i ] = src[ i ];\n\n\t\t}\n\n\t} else {\n\n\t\t// if the arrays use the same data layout we can use a fast block copy\n\t\tconst len = Math.min( src.length, target.length );\n\t\ttarget.set( new src.constructor( src.buffer, 0, len ) );\n\n\t}\n\n}\n\nclass BatchedMesh extends Mesh {\n\n\tget maxInstanceCount() {\n\n\t\treturn this._maxInstanceCount;\n\n\t}\n\n\tget instanceCount() {\n\n\t\treturn this._instanceInfo.length - this._availableInstanceIds.length;\n\n\t}\n\n\tget unusedVertexCount() {\n\n\t\treturn this._maxVertexCount - this._nextVertexStart;\n\n\t}\n\n\tget unusedIndexCount() {\n\n\t\treturn this._maxIndexCount - this._nextIndexStart;\n\n\t}\n\n\tconstructor( maxInstanceCount, maxVertexCount, maxIndexCount = maxVertexCount * 2, material ) {\n\n\t\tsuper( new BufferGeometry(), material );\n\n\t\tthis.isBatchedMesh = true;\n\t\tthis.perObjectFrustumCulled = true;\n\t\tthis.sortObjects = true;\n\t\tthis.boundingBox = null;\n\t\tthis.boundingSphere = null;\n\t\tthis.customSort = null;\n\n\t\t// stores visible, active, and geometry id per instance and reserved buffer ranges for geometries\n\t\tthis._instanceInfo = [];\n\t\tthis._geometryInfo = [];\n\n\t\t// instance, geometry ids that have been set as inactive, and are available to be overwritten\n\t\tthis._availableInstanceIds = [];\n\t\tthis._availableGeometryIds = [];\n\n\t\t// used to track where the next point is that geometry should be inserted\n\t\tthis._nextIndexStart = 0;\n\t\tthis._nextVertexStart = 0;\n\t\tthis._geometryCount = 0;\n\n\t\t// flags\n\t\tthis._visibilityChanged = true;\n\t\tthis._geometryInitialized = false;\n\n\t\t// cached user options\n\t\tthis._maxInstanceCount = maxInstanceCount;\n\t\tthis._maxVertexCount = maxVertexCount;\n\t\tthis._maxIndexCount = maxIndexCount;\n\n\t\t// buffers for multi draw\n\t\tthis._multiDrawCounts = new Int32Array( maxInstanceCount );\n\t\tthis._multiDrawStarts = new Int32Array( maxInstanceCount );\n\t\tthis._multiDrawCount = 0;\n\t\tthis._multiDrawInstances = null;\n\n\t\t// Local matrix per geometry by using data texture\n\t\tthis._matricesTexture = null;\n\t\tthis._indirectTexture = null;\n\t\tthis._colorsTexture = null;\n\n\t\tthis._initMatricesTexture();\n\t\tthis._initIndirectTexture();\n\n\t}\n\n\t_initMatricesTexture() {\n\n\t\t// layout (1 matrix = 4 pixels)\n\t\t//      RGBA RGBA RGBA RGBA (=> column1, column2, column3, column4)\n\t\t//  with  8x8  pixel texture max   16 matrices * 4 pixels =  (8 * 8)\n\t\t//       16x16 pixel texture max   64 matrices * 4 pixels = (16 * 16)\n\t\t//       32x32 pixel texture max  256 matrices * 4 pixels = (32 * 32)\n\t\t//       64x64 pixel texture max 1024 matrices * 4 pixels = (64 * 64)\n\n\t\tlet size = Math.sqrt( this._maxInstanceCount * 4 ); // 4 pixels needed for 1 matrix\n\t\tsize = Math.ceil( size / 4 ) * 4;\n\t\tsize = Math.max( size, 4 );\n\n\t\tconst matricesArray = new Float32Array( size * size * 4 ); // 4 floats per RGBA pixel\n\t\tconst matricesTexture = new DataTexture( matricesArray, size, size, RGBAFormat, FloatType );\n\n\t\tthis._matricesTexture = matricesTexture;\n\n\t}\n\n\t_initIndirectTexture() {\n\n\t\tlet size = Math.sqrt( this._maxInstanceCount );\n\t\tsize = Math.ceil( size );\n\n\t\tconst indirectArray = new Uint32Array( size * size );\n\t\tconst indirectTexture = new DataTexture( indirectArray, size, size, RedIntegerFormat, UnsignedIntType );\n\n\t\tthis._indirectTexture = indirectTexture;\n\n\t}\n\n\t_initColorsTexture() {\n\n\t\tlet size = Math.sqrt( this._maxInstanceCount );\n\t\tsize = Math.ceil( size );\n\n\t\t// 4 floats per RGBA pixel initialized to white\n\t\tconst colorsArray = new Float32Array( size * size * 4 ).fill( 1 );\n\t\tconst colorsTexture = new DataTexture( colorsArray, size, size, RGBAFormat, FloatType );\n\t\tcolorsTexture.colorSpace = ColorManagement.workingColorSpace;\n\n\t\tthis._colorsTexture = colorsTexture;\n\n\t}\n\n\t_initializeGeometry( reference ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst maxVertexCount = this._maxVertexCount;\n\t\tconst maxIndexCount = this._maxIndexCount;\n\t\tif ( this._geometryInitialized === false ) {\n\n\t\t\tfor ( const attributeName in reference.attributes ) {\n\n\t\t\t\tconst srcAttribute = reference.getAttribute( attributeName );\n\t\t\t\tconst { array, itemSize, normalized } = srcAttribute;\n\n\t\t\t\tconst dstArray = new array.constructor( maxVertexCount * itemSize );\n\t\t\t\tconst dstAttribute = new BufferAttribute( dstArray, itemSize, normalized );\n\n\t\t\t\tgeometry.setAttribute( attributeName, dstAttribute );\n\n\t\t\t}\n\n\t\t\tif ( reference.getIndex() !== null ) {\n\n\t\t\t\t// Reserve last u16 index for primitive restart.\n\t\t\t\tconst indexArray = maxVertexCount > 65535\n\t\t\t\t\t? new Uint32Array( maxIndexCount )\n\t\t\t\t\t: new Uint16Array( maxIndexCount );\n\n\t\t\t\tgeometry.setIndex( new BufferAttribute( indexArray, 1 ) );\n\n\t\t\t}\n\n\t\t\tthis._geometryInitialized = true;\n\n\t\t}\n\n\t}\n\n\t// Make sure the geometry is compatible with the existing combined geometry attributes\n\t_validateGeometry( geometry ) {\n\n\t\t// check to ensure the geometries are using consistent attributes and indices\n\t\tconst batchGeometry = this.geometry;\n\t\tif ( Boolean( geometry.getIndex() ) !== Boolean( batchGeometry.getIndex() ) ) {\n\n\t\t\tthrow new Error( 'BatchedMesh: All geometries must consistently have \"index\".' );\n\n\t\t}\n\n\t\tfor ( const attributeName in batchGeometry.attributes ) {\n\n\t\t\tif ( ! geometry.hasAttribute( attributeName ) ) {\n\n\t\t\t\tthrow new Error( `BatchedMesh: Added geometry missing \"${ attributeName }\". All geometries must have consistent attributes.` );\n\n\t\t\t}\n\n\t\t\tconst srcAttribute = geometry.getAttribute( attributeName );\n\t\t\tconst dstAttribute = batchGeometry.getAttribute( attributeName );\n\t\t\tif ( srcAttribute.itemSize !== dstAttribute.itemSize || srcAttribute.normalized !== dstAttribute.normalized ) {\n\n\t\t\t\tthrow new Error( 'BatchedMesh: All attributes must have a consistent itemSize and normalized value.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetCustomSort( func ) {\n\n\t\tthis.customSort = func;\n\t\treturn this;\n\n\t}\n\n\tcomputeBoundingBox() {\n\n\t\tif ( this.boundingBox === null ) {\n\n\t\t\tthis.boundingBox = new Box3();\n\n\t\t}\n\n\t\tconst boundingBox = this.boundingBox;\n\t\tconst instanceInfo = this._instanceInfo;\n\n\t\tboundingBox.makeEmpty();\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( instanceInfo[ i ].active === false ) continue;\n\n\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\tthis.getBoundingBoxAt( geometryId, _box$1 ).applyMatrix4( _matrix$1 );\n\t\t\tboundingBox.union( _box$1 );\n\n\t\t}\n\n\t}\n\n\tcomputeBoundingSphere() {\n\n\t\tif ( this.boundingSphere === null ) {\n\n\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tconst boundingSphere = this.boundingSphere;\n\t\tconst instanceInfo = this._instanceInfo;\n\n\t\tboundingSphere.makeEmpty();\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( instanceInfo[ i ].active === false ) continue;\n\n\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\tthis.getBoundingSphereAt( geometryId, _sphere$2 ).applyMatrix4( _matrix$1 );\n\t\t\tboundingSphere.union( _sphere$2 );\n\n\t\t}\n\n\t}\n\n\taddInstance( geometryId ) {\n\n\t\tconst atCapacity = this._instanceInfo.length >= this.maxInstanceCount;\n\n\t\t// ensure we're not over geometry\n\t\tif ( atCapacity && this._availableInstanceIds.length === 0 ) {\n\n\t\t\tthrow new Error( 'BatchedMesh: Maximum item count reached.' );\n\n\t\t}\n\n\t\tconst instanceInfo = {\n\t\t\tvisible: true,\n\t\t\tactive: true,\n\t\t\tgeometryIndex: geometryId,\n\t\t};\n\n\t\tlet drawId = null;\n\n\t\t// Prioritize using previously freed instance ids\n\t\tif ( this._availableInstanceIds.length > 0 ) {\n\n\t\t\tthis._availableInstanceIds.sort( ascIdSort );\n\n\t\t\tdrawId = this._availableInstanceIds.shift();\n\t\t\tthis._instanceInfo[ drawId ] = instanceInfo;\n\n\t\t} else {\n\n\t\t\tdrawId = this._instanceInfo.length;\n\t\t\tthis._instanceInfo.push( instanceInfo );\n\n\t\t}\n\n\t\tconst matricesTexture = this._matricesTexture;\n\t\t_matrix$1.identity().toArray( matricesTexture.image.data, drawId * 16 );\n\t\tmatricesTexture.needsUpdate = true;\n\n\t\tconst colorsTexture = this._colorsTexture;\n\t\tif ( colorsTexture ) {\n\n\t\t\t_whiteColor.toArray( colorsTexture.image.data, drawId * 4 );\n\t\t\tcolorsTexture.needsUpdate = true;\n\n\t\t}\n\n\t\tthis._visibilityChanged = true;\n\t\treturn drawId;\n\n\t}\n\n\taddGeometry( geometry, reservedVertexCount = - 1, reservedIndexCount = - 1 ) {\n\n\t\tthis._initializeGeometry( geometry );\n\n\t\tthis._validateGeometry( geometry );\n\n\t\tconst geometryInfo = {\n\t\t\t// geometry information\n\t\t\tvertexStart: - 1,\n\t\t\tvertexCount: - 1,\n\t\t\treservedVertexCount: - 1,\n\n\t\t\tindexStart: - 1,\n\t\t\tindexCount: - 1,\n\t\t\treservedIndexCount: - 1,\n\n\t\t\t// draw range information\n\t\t\tstart: - 1,\n\t\t\tcount: - 1,\n\n\t\t\t// state\n\t\t\tboundingBox: null,\n\t\t\tboundingSphere: null,\n\t\t\tactive: true,\n\t\t};\n\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tgeometryInfo.vertexStart = this._nextVertexStart;\n\t\tgeometryInfo.reservedVertexCount = reservedVertexCount === - 1 ? geometry.getAttribute( 'position' ).count : reservedVertexCount;\n\n\t\tconst index = geometry.getIndex();\n\t\tconst hasIndex = index !== null;\n\t\tif ( hasIndex ) {\n\n\t\t\tgeometryInfo.indexStart = this._nextIndexStart;\n\t\t\tgeometryInfo.reservedIndexCount = reservedIndexCount === - 1 ? index.count : reservedIndexCount;\n\n\t\t}\n\n\t\tif (\n\t\t\tgeometryInfo.indexStart !== - 1 &&\n\t\t\tgeometryInfo.indexStart + geometryInfo.reservedIndexCount > this._maxIndexCount ||\n\t\t\tgeometryInfo.vertexStart + geometryInfo.reservedVertexCount > this._maxVertexCount\n\t\t) {\n\n\t\t\tthrow new Error( 'BatchedMesh: Reserved space request exceeds the maximum buffer size.' );\n\n\t\t}\n\n\t\t// update id\n\t\tlet geometryId;\n\t\tif ( this._availableGeometryIds.length > 0 ) {\n\n\t\t\tthis._availableGeometryIds.sort( ascIdSort );\n\n\t\t\tgeometryId = this._availableGeometryIds.shift();\n\t\t\tgeometryInfoList[ geometryId ] = geometryInfo;\n\n\n\t\t} else {\n\n\t\t\tgeometryId = this._geometryCount;\n\t\t\tthis._geometryCount ++;\n\t\t\tgeometryInfoList.push( geometryInfo );\n\n\t\t}\n\n\t\t// update the geometry\n\t\tthis.setGeometryAt( geometryId, geometry );\n\n\t\t// increment the next geometry position\n\t\tthis._nextIndexStart = geometryInfo.indexStart + geometryInfo.reservedIndexCount;\n\t\tthis._nextVertexStart = geometryInfo.vertexStart + geometryInfo.reservedVertexCount;\n\n\t\treturn geometryId;\n\n\t}\n\n\tsetGeometryAt( geometryId, geometry ) {\n\n\t\tif ( geometryId >= this._geometryCount ) {\n\n\t\t\tthrow new Error( 'BatchedMesh: Maximum geometry count reached.' );\n\n\t\t}\n\n\t\tthis._validateGeometry( geometry );\n\n\t\tconst batchGeometry = this.geometry;\n\t\tconst hasIndex = batchGeometry.getIndex() !== null;\n\t\tconst dstIndex = batchGeometry.getIndex();\n\t\tconst srcIndex = geometry.getIndex();\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\tif (\n\t\t\thasIndex &&\n\t\t\tsrcIndex.count > geometryInfo.reservedIndexCount ||\n\t\t\tgeometry.attributes.position.count > geometryInfo.reservedVertexCount\n\t\t) {\n\n\t\t\tthrow new Error( 'BatchedMesh: Reserved space not large enough for provided geometry.' );\n\n\t\t}\n\n\t\t// copy geometry buffer data over\n\t\tconst vertexStart = geometryInfo.vertexStart;\n\t\tconst reservedVertexCount = geometryInfo.reservedVertexCount;\n\t\tgeometryInfo.vertexCount = geometry.getAttribute( 'position' ).count;\n\n\t\tfor ( const attributeName in batchGeometry.attributes ) {\n\n\t\t\t// copy attribute data\n\t\t\tconst srcAttribute = geometry.getAttribute( attributeName );\n\t\t\tconst dstAttribute = batchGeometry.getAttribute( attributeName );\n\t\t\tcopyAttributeData( srcAttribute, dstAttribute, vertexStart );\n\n\t\t\t// fill the rest in with zeroes\n\t\t\tconst itemSize = srcAttribute.itemSize;\n\t\t\tfor ( let i = srcAttribute.count, l = reservedVertexCount; i < l; i ++ ) {\n\n\t\t\t\tconst index = vertexStart + i;\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tdstAttribute.setComponent( index, c, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdstAttribute.needsUpdate = true;\n\t\t\tdstAttribute.addUpdateRange( vertexStart * itemSize, reservedVertexCount * itemSize );\n\n\t\t}\n\n\t\t// copy index\n\t\tif ( hasIndex ) {\n\n\t\t\tconst indexStart = geometryInfo.indexStart;\n\t\t\tconst reservedIndexCount = geometryInfo.reservedIndexCount;\n\t\t\tgeometryInfo.indexCount = geometry.getIndex().count;\n\n\t\t\t// copy index data over\n\t\t\tfor ( let i = 0; i < srcIndex.count; i ++ ) {\n\n\t\t\t\tdstIndex.setX( indexStart + i, vertexStart + srcIndex.getX( i ) );\n\n\t\t\t}\n\n\t\t\t// fill the rest in with zeroes\n\t\t\tfor ( let i = srcIndex.count, l = reservedIndexCount; i < l; i ++ ) {\n\n\t\t\t\tdstIndex.setX( indexStart + i, vertexStart );\n\n\t\t\t}\n\n\t\t\tdstIndex.needsUpdate = true;\n\t\t\tdstIndex.addUpdateRange( indexStart, geometryInfo.reservedIndexCount );\n\n\t\t}\n\n\t\t// update the draw range\n\t\tgeometryInfo.start = hasIndex ? geometryInfo.indexStart : geometryInfo.vertexStart;\n\t\tgeometryInfo.count = hasIndex ? geometryInfo.indexCount : geometryInfo.vertexCount;\n\n\t\t// store the bounding boxes\n\t\tgeometryInfo.boundingBox = null;\n\t\tif ( geometry.boundingBox !== null ) {\n\n\t\t\tgeometryInfo.boundingBox = geometry.boundingBox.clone();\n\n\t\t}\n\n\t\tgeometryInfo.boundingSphere = null;\n\t\tif ( geometry.boundingSphere !== null ) {\n\n\t\t\tgeometryInfo.boundingSphere = geometry.boundingSphere.clone();\n\n\t\t}\n\n\t\tthis._visibilityChanged = true;\n\t\treturn geometryId;\n\n\t}\n\n\tdeleteGeometry( geometryId ) {\n\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tif ( geometryId >= geometryInfoList.length || geometryInfoList[ geometryId ].active === false ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\t// delete any instances associated with this geometry\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( instanceInfo[ i ].geometryIndex === geometryId ) {\n\n\t\t\t\tthis.deleteInstance( i );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometryInfoList[ geometryId ].active = false;\n\t\tthis._availableGeometryIds.push( geometryId );\n\t\tthis._visibilityChanged = true;\n\n\t\treturn this;\n\n\t}\n\n\tdeleteInstance( instanceId ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tinstanceInfo[ instanceId ].active = false;\n\t\tthis._availableInstanceIds.push( instanceId );\n\t\tthis._visibilityChanged = true;\n\n\t\treturn this;\n\n\t}\n\n\toptimize() {\n\n\t\t// track the next indices to copy data to\n\t\tlet nextVertexStart = 0;\n\t\tlet nextIndexStart = 0;\n\n\t\t// Iterate over all geometry ranges in order sorted from earliest in the geometry buffer to latest\n\t\t// in the geometry buffer. Because draw range objects can be reused there is no guarantee of their order.\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tconst indices = geometryInfoList\n\t\t\t.map( ( e, i ) => i )\n\t\t\t.sort( ( a, b ) => {\n\n\t\t\t\treturn geometryInfoList[ a ].vertexStart - geometryInfoList[ b ].vertexStart;\n\n\t\t\t} );\n\n\t\tconst geometry = this.geometry;\n\t\tfor ( let i = 0, l = geometryInfoList.length; i < l; i ++ ) {\n\n\t\t\t// if a geometry range is inactive then don't copy anything\n\t\t\tconst index = indices[ i ];\n\t\t\tconst geometryInfo = geometryInfoList[ index ];\n\t\t\tif ( geometryInfo.active === false ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// if a geometry contains an index buffer then shift it, as well\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\tif ( geometryInfo.indexStart !== nextIndexStart ) {\n\n\t\t\t\t\tconst { indexStart, vertexStart, reservedIndexCount } = geometryInfo;\n\t\t\t\t\tconst index = geometry.index;\n\t\t\t\t\tconst array = index.array;\n\n\t\t\t\t\t// shift the index pointers based on how the vertex data will shift\n\t\t\t\t\t// adjusting the index must happen first so the original vertex start value is available\n\t\t\t\t\tconst elementDelta = nextVertexStart - vertexStart;\n\t\t\t\t\tfor ( let j = indexStart; j < indexStart + reservedIndexCount; j ++ ) {\n\n\t\t\t\t\t\tarray[ j ] = array[ j ] + elementDelta;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tindex.array.copyWithin( nextIndexStart, indexStart, indexStart + reservedIndexCount );\n\t\t\t\t\tindex.addUpdateRange( nextIndexStart, reservedIndexCount );\n\n\t\t\t\t\tgeometryInfo.indexStart = nextIndexStart;\n\n\t\t\t\t}\n\n\t\t\t\tnextIndexStart += geometryInfo.reservedIndexCount;\n\n\t\t\t}\n\n\t\t\t// if a geometry needs to be moved then copy attribute data to overwrite unused space\n\t\t\tif ( geometryInfo.vertexStart !== nextVertexStart ) {\n\n\t\t\t\tconst { vertexStart, reservedVertexCount } = geometryInfo;\n\t\t\t\tconst attributes = geometry.attributes;\n\t\t\t\tfor ( const key in attributes ) {\n\n\t\t\t\t\tconst attribute = attributes[ key ];\n\t\t\t\t\tconst { array, itemSize } = attribute;\n\t\t\t\t\tarray.copyWithin( nextVertexStart * itemSize, vertexStart * itemSize, ( vertexStart + reservedVertexCount ) * itemSize );\n\t\t\t\t\tattribute.addUpdateRange( nextVertexStart * itemSize, reservedVertexCount * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tgeometryInfo.vertexStart = nextVertexStart;\n\n\t\t\t}\n\n\t\t\tnextVertexStart += geometryInfo.reservedVertexCount;\n\t\t\tgeometryInfo.start = geometry.index ? geometryInfo.indexStart : geometryInfo.vertexStart;\n\n\t\t\t// step the next geometry points to the shifted position\n\t\t\tthis._nextIndexStart = geometry.index ? geometryInfo.indexStart + geometryInfo.reservedIndexCount : 0;\n\t\t\tthis._nextVertexStart = geometryInfo.vertexStart + geometryInfo.reservedVertexCount;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// get bounding box and compute it if it doesn't exist\n\tgetBoundingBoxAt( geometryId, target ) {\n\n\t\tif ( geometryId >= this._geometryCount ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// compute bounding box\n\t\tconst geometry = this.geometry;\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\tif ( geometryInfo.boundingBox === null ) {\n\n\t\t\tconst box = new Box3();\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\t\t\tfor ( let i = geometryInfo.start, l = geometryInfo.start + geometryInfo.count; i < l; i ++ ) {\n\n\t\t\t\tlet iv = i;\n\t\t\t\tif ( index ) {\n\n\t\t\t\t\tiv = index.getX( iv );\n\n\t\t\t\t}\n\n\t\t\t\tbox.expandByPoint( _vector$5.fromBufferAttribute( position, iv ) );\n\n\t\t\t}\n\n\t\t\tgeometryInfo.boundingBox = box;\n\n\t\t}\n\n\t\ttarget.copy( geometryInfo.boundingBox );\n\t\treturn target;\n\n\t}\n\n\t// get bounding sphere and compute it if it doesn't exist\n\tgetBoundingSphereAt( geometryId, target ) {\n\n\t\tif ( geometryId >= this._geometryCount ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// compute bounding sphere\n\t\tconst geometry = this.geometry;\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\tif ( geometryInfo.boundingSphere === null ) {\n\n\t\t\tconst sphere = new Sphere();\n\t\t\tthis.getBoundingBoxAt( geometryId, _box$1 );\n\t\t\t_box$1.getCenter( sphere.center );\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst position = geometry.attributes.position;\n\n\t\t\tlet maxRadiusSq = 0;\n\t\t\tfor ( let i = geometryInfo.start, l = geometryInfo.start + geometryInfo.count; i < l; i ++ ) {\n\n\t\t\t\tlet iv = i;\n\t\t\t\tif ( index ) {\n\n\t\t\t\t\tiv = index.getX( iv );\n\n\t\t\t\t}\n\n\t\t\t\t_vector$5.fromBufferAttribute( position, iv );\n\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, sphere.center.distanceToSquared( _vector$5 ) );\n\n\t\t\t}\n\n\t\t\tsphere.radius = Math.sqrt( maxRadiusSq );\n\t\t\tgeometryInfo.boundingSphere = sphere;\n\n\t\t}\n\n\t\ttarget.copy( geometryInfo.boundingSphere );\n\t\treturn target;\n\n\t}\n\n\tsetMatrixAt( instanceId, matrix ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst matricesTexture = this._matricesTexture;\n\t\tconst matricesArray = this._matricesTexture.image.data;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tmatrix.toArray( matricesArray, instanceId * 16 );\n\t\tmatricesTexture.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tgetMatrixAt( instanceId, matrix ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst matricesArray = this._matricesTexture.image.data;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn matrix.fromArray( matricesArray, instanceId * 16 );\n\n\t}\n\n\tsetColorAt( instanceId, color ) {\n\n\t\tif ( this._colorsTexture === null ) {\n\n\t\t\tthis._initColorsTexture();\n\n\t\t}\n\n\t\tconst colorsTexture = this._colorsTexture;\n\t\tconst colorsArray = this._colorsTexture.image.data;\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tcolor.toArray( colorsArray, instanceId * 4 );\n\t\tcolorsTexture.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tgetColorAt( instanceId, color ) {\n\n\t\tconst colorsArray = this._colorsTexture.image.data;\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\treturn color.fromArray( colorsArray, instanceId * 4 );\n\n\t}\n\n\tsetVisibleAt( instanceId, value ) {\n\n\t\t// if the geometry is out of range, not active, or visibility state\n\t\t// does not change then return early\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif (\n\t\t\tinstanceId >= instanceInfo.length ||\n\t\t\tinstanceInfo[ instanceId ].active === false ||\n\t\t\tinstanceInfo[ instanceId ].visible === value\n\t\t) {\n\n\t\t\treturn this;\n\n\t\t}\n\n\t\tinstanceInfo[ instanceId ].visible = value;\n\t\tthis._visibilityChanged = true;\n\n\t\treturn this;\n\n\t}\n\n\tgetVisibleAt( instanceId ) {\n\n\t\t// return early if the geometry is out of range or not active\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn instanceInfo[ instanceId ].visible;\n\n\t}\n\n\tsetGeometryIdAt( instanceId, geometryId ) {\n\n\t\t// return early if the geometry is out of range or not active\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// check if the provided geometryId is within the valid range\n\t\tif ( geometryId >= geometryInfoList.length || geometryInfoList[ geometryId ].active === false ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tinstanceInfo[ instanceId ].geometryIndex = geometryId;\n\n\t\treturn this;\n\n\t}\n\n\tgetGeometryIdAt( instanceId ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tif ( instanceId >= instanceInfo.length || instanceInfo[ instanceId ].active === false ) {\n\n\t\t\treturn - 1;\n\n\t\t}\n\n\t\treturn instanceInfo[ instanceId ].geometryIndex;\n\n\t}\n\n\tgetGeometryRangeAt( geometryId, target = {} ) {\n\n\t\tif ( geometryId < 0 || geometryId >= this._geometryCount ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst geometryInfo = this._geometryInfo[ geometryId ];\n\t\ttarget.vertexStart = geometryInfo.vertexStart;\n\t\ttarget.vertexCount = geometryInfo.vertexCount;\n\t\ttarget.reservedVertexCount = geometryInfo.reservedVertexCount;\n\n\t\ttarget.indexStart = geometryInfo.indexStart;\n\t\ttarget.indexCount = geometryInfo.indexCount;\n\t\ttarget.reservedIndexCount = geometryInfo.reservedIndexCount;\n\n\t\ttarget.start = geometryInfo.start;\n\t\ttarget.count = geometryInfo.count;\n\n\t\treturn target;\n\n\t}\n\n\tsetInstanceCount( maxInstanceCount ) {\n\n\t\t// shrink the available instances as much as possible\n\t\tconst availableInstanceIds = this._availableInstanceIds;\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tavailableInstanceIds.sort( ascIdSort );\n\t\twhile ( availableInstanceIds[ availableInstanceIds.length - 1 ] === instanceInfo.length ) {\n\n\t\t\tinstanceInfo.pop();\n\t\t\tavailableInstanceIds.pop();\n\n\t\t}\n\n\t\t// throw an error if it can't be shrunk to the desired size\n\t\tif ( maxInstanceCount < instanceInfo.length ) {\n\n\t\t\tthrow new Error( `BatchedMesh: Instance ids outside the range ${ maxInstanceCount } are being used. Cannot shrink instance count.` );\n\n\t\t}\n\n\t\t// copy the multi draw counts\n\t\tconst multiDrawCounts = new Int32Array( maxInstanceCount );\n\t\tconst multiDrawStarts = new Int32Array( maxInstanceCount );\n\t\tcopyArrayContents( this._multiDrawCounts, multiDrawCounts );\n\t\tcopyArrayContents( this._multiDrawStarts, multiDrawStarts );\n\n\t\tthis._multiDrawCounts = multiDrawCounts;\n\t\tthis._multiDrawStarts = multiDrawStarts;\n\t\tthis._maxInstanceCount = maxInstanceCount;\n\n\t\t// update texture data for instance sampling\n\t\tconst indirectTexture = this._indirectTexture;\n\t\tconst matricesTexture = this._matricesTexture;\n\t\tconst colorsTexture = this._colorsTexture;\n\n\t\tindirectTexture.dispose();\n\t\tthis._initIndirectTexture();\n\t\tcopyArrayContents( indirectTexture.image.data, this._indirectTexture.image.data );\n\n\t\tmatricesTexture.dispose();\n\t\tthis._initMatricesTexture();\n\t\tcopyArrayContents( matricesTexture.image.data, this._matricesTexture.image.data );\n\n\t\tif ( colorsTexture ) {\n\n\t\t\tcolorsTexture.dispose();\n\t\t\tthis._initColorsTexture();\n\t\t\tcopyArrayContents( colorsTexture.image.data, this._colorsTexture.image.data );\n\n\t\t}\n\n\t}\n\n\tsetGeometrySize( maxVertexCount, maxIndexCount ) {\n\n\t\t// Check if we can shrink to the requested vertex attribute size\n\t\tconst validRanges = [ ...this._geometryInfo ].filter( info => info.active );\n\t\tconst requiredVertexLength = Math.max( ...validRanges.map( range => range.vertexStart + range.reservedVertexCount ) );\n\t\tif ( requiredVertexLength > maxVertexCount ) {\n\n\t\t\tthrow new Error( `BatchedMesh: Geometry vertex values are being used outside the range ${ maxIndexCount }. Cannot shrink further.` );\n\n\t\t}\n\n\t\t// Check if we can shrink to the requested index attribute size\n\t\tif ( this.geometry.index ) {\n\n\t\t\tconst requiredIndexLength = Math.max( ...validRanges.map( range => range.indexStart + range.reservedIndexCount ) );\n\t\t\tif ( requiredIndexLength > maxIndexCount ) {\n\n\t\t\t\tthrow new Error( `BatchedMesh: Geometry index values are being used outside the range ${ maxIndexCount }. Cannot shrink further.` );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\t// dispose of the previous geometry\n\t\tconst oldGeometry = this.geometry;\n\t\toldGeometry.dispose();\n\n\t\t// recreate the geometry needed based on the previous variant\n\t\tthis._maxVertexCount = maxVertexCount;\n\t\tthis._maxIndexCount = maxIndexCount;\n\n\t\tif ( this._geometryInitialized ) {\n\n\t\t\tthis._geometryInitialized = false;\n\t\t\tthis.geometry = new BufferGeometry();\n\t\t\tthis._initializeGeometry( oldGeometry );\n\n\t\t}\n\n\t\t// copy data from the previous geometry\n\t\tconst geometry = this.geometry;\n\t\tif ( oldGeometry.index ) {\n\n\t\t\tcopyArrayContents( oldGeometry.index.array, geometry.index.array );\n\n\t\t}\n\n\t\tfor ( const key in oldGeometry.attributes ) {\n\n\t\t\tcopyArrayContents( oldGeometry.attributes[ key ].array, geometry.attributes[ key ].array );\n\n\t\t}\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst batchGeometry = this.geometry;\n\n\t\t// iterate over each geometry\n\t\t_mesh.material = this.material;\n\t\t_mesh.geometry.index = batchGeometry.index;\n\t\t_mesh.geometry.attributes = batchGeometry.attributes;\n\t\tif ( _mesh.geometry.boundingBox === null ) {\n\n\t\t\t_mesh.geometry.boundingBox = new Box3();\n\n\t\t}\n\n\t\tif ( _mesh.geometry.boundingSphere === null ) {\n\n\t\t\t_mesh.geometry.boundingSphere = new Sphere();\n\n\t\t}\n\n\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\tif ( ! instanceInfo[ i ].visible || ! instanceInfo[ i ].active ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\t\t\tconst geometryInfo = geometryInfoList[ geometryId ];\n\t\t\t_mesh.geometry.setDrawRange( geometryInfo.start, geometryInfo.count );\n\n\t\t\t// get the intersects\n\t\t\tthis.getMatrixAt( i, _mesh.matrixWorld ).premultiply( matrixWorld );\n\t\t\tthis.getBoundingBoxAt( geometryId, _mesh.geometry.boundingBox );\n\t\t\tthis.getBoundingSphereAt( geometryId, _mesh.geometry.boundingSphere );\n\t\t\t_mesh.raycast( raycaster, _batchIntersects );\n\n\t\t\t// add batch id to the intersects\n\t\t\tfor ( let j = 0, l = _batchIntersects.length; j < l; j ++ ) {\n\n\t\t\t\tconst intersect = _batchIntersects[ j ];\n\t\t\t\tintersect.object = this;\n\t\t\t\tintersect.batchId = i;\n\t\t\t\tintersects.push( intersect );\n\n\t\t\t}\n\n\t\t\t_batchIntersects.length = 0;\n\n\t\t}\n\n\t\t_mesh.material = null;\n\t\t_mesh.geometry.index = null;\n\t\t_mesh.geometry.attributes = {};\n\t\t_mesh.geometry.setDrawRange( 0, Infinity );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.geometry = source.geometry.clone();\n\t\tthis.perObjectFrustumCulled = source.perObjectFrustumCulled;\n\t\tthis.sortObjects = source.sortObjects;\n\t\tthis.boundingBox = source.boundingBox !== null ? source.boundingBox.clone() : null;\n\t\tthis.boundingSphere = source.boundingSphere !== null ? source.boundingSphere.clone() : null;\n\n\t\tthis._geometryInfo = source._geometryInfo.map( info => ( {\n\t\t\t...info,\n\n\t\t\tboundingBox: info.boundingBox !== null ? info.boundingBox.clone() : null,\n\t\t\tboundingSphere: info.boundingSphere !== null ? info.boundingSphere.clone() : null,\n\t\t} ) );\n\t\tthis._instanceInfo = source._instanceInfo.map( info => ( { ...info } ) );\n\n\t\tthis._maxInstanceCount = source._maxInstanceCount;\n\t\tthis._maxVertexCount = source._maxVertexCount;\n\t\tthis._maxIndexCount = source._maxIndexCount;\n\n\t\tthis._geometryInitialized = source._geometryInitialized;\n\t\tthis._geometryCount = source._geometryCount;\n\t\tthis._multiDrawCounts = source._multiDrawCounts.slice();\n\t\tthis._multiDrawStarts = source._multiDrawStarts.slice();\n\n\t\tthis._matricesTexture = source._matricesTexture.clone();\n\t\tthis._matricesTexture.image.data = this._matricesTexture.image.data.slice();\n\n\t\tif ( this._colorsTexture !== null ) {\n\n\t\t\tthis._colorsTexture = source._colorsTexture.clone();\n\t\t\tthis._colorsTexture.image.data = this._colorsTexture.image.data.slice();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\t// Assuming the geometry is not shared with other meshes\n\t\tthis.geometry.dispose();\n\n\t\tthis._matricesTexture.dispose();\n\t\tthis._matricesTexture = null;\n\n\t\tthis._indirectTexture.dispose();\n\t\tthis._indirectTexture = null;\n\n\t\tif ( this._colorsTexture !== null ) {\n\n\t\t\tthis._colorsTexture.dispose();\n\t\t\tthis._colorsTexture = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tonBeforeRender( renderer, scene, camera, geometry, material/*, _group*/ ) {\n\n\t\t// if visibility has not changed and frustum culling and object sorting is not required\n\t\t// then skip iterating over all items\n\t\tif ( ! this._visibilityChanged && ! this.perObjectFrustumCulled && ! this.sortObjects ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// the indexed version of the multi draw function requires specifying the start\n\t\t// offset in bytes.\n\t\tconst index = geometry.getIndex();\n\t\tconst bytesPerElement = index === null ? 1 : index.array.BYTES_PER_ELEMENT;\n\n\t\tconst instanceInfo = this._instanceInfo;\n\t\tconst multiDrawStarts = this._multiDrawStarts;\n\t\tconst multiDrawCounts = this._multiDrawCounts;\n\t\tconst geometryInfoList = this._geometryInfo;\n\t\tconst perObjectFrustumCulled = this.perObjectFrustumCulled;\n\t\tconst indirectTexture = this._indirectTexture;\n\t\tconst indirectArray = indirectTexture.image.data;\n\n\t\t// prepare the frustum in the local frame\n\t\tif ( perObjectFrustumCulled ) {\n\n\t\t\t_matrix$1\n\t\t\t\t.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse )\n\t\t\t\t.multiply( this.matrixWorld );\n\t\t\t_frustum$1.setFromProjectionMatrix(\n\t\t\t\t_matrix$1,\n\t\t\t\trenderer.coordinateSystem\n\t\t\t);\n\n\t\t}\n\n\t\tlet multiDrawCount = 0;\n\t\tif ( this.sortObjects ) {\n\n\t\t\t// get the camera position in the local frame\n\t\t\t_matrix$1.copy( this.matrixWorld ).invert();\n\t\t\t_vector$5.setFromMatrixPosition( camera.matrixWorld ).applyMatrix4( _matrix$1 );\n\t\t\t_forward.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld ).transformDirection( _matrix$1 );\n\n\t\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\t\tif ( instanceInfo[ i ].visible && instanceInfo[ i ].active ) {\n\n\t\t\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\n\t\t\t\t\t// get the bounds in world space\n\t\t\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\t\t\tthis.getBoundingSphereAt( geometryId, _sphere$2 ).applyMatrix4( _matrix$1 );\n\n\t\t\t\t\t// determine whether the batched geometry is within the frustum\n\t\t\t\t\tlet culled = false;\n\t\t\t\t\tif ( perObjectFrustumCulled ) {\n\n\t\t\t\t\t\tculled = ! _frustum$1.intersectsSphere( _sphere$2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! culled ) {\n\n\t\t\t\t\t\t// get the distance from camera used for sorting\n\t\t\t\t\t\tconst geometryInfo = geometryInfoList[ geometryId ];\n\t\t\t\t\t\tconst z = _temp.subVectors( _sphere$2.center, _vector$5 ).dot( _forward );\n\t\t\t\t\t\t_renderList.push( geometryInfo.start, geometryInfo.count, z, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Sort the draw ranges and prep for rendering\n\t\t\tconst list = _renderList.list;\n\t\t\tconst customSort = this.customSort;\n\t\t\tif ( customSort === null ) {\n\n\t\t\t\tlist.sort( material.transparent ? sortTransparent : sortOpaque );\n\n\t\t\t} else {\n\n\t\t\t\tcustomSort.call( this, list, camera );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = list.length; i < l; i ++ ) {\n\n\t\t\t\tconst item = list[ i ];\n\t\t\t\tmultiDrawStarts[ multiDrawCount ] = item.start * bytesPerElement;\n\t\t\t\tmultiDrawCounts[ multiDrawCount ] = item.count;\n\t\t\t\tindirectArray[ multiDrawCount ] = item.index;\n\t\t\t\tmultiDrawCount ++;\n\n\t\t\t}\n\n\t\t\t_renderList.reset();\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0, l = instanceInfo.length; i < l; i ++ ) {\n\n\t\t\t\tif ( instanceInfo[ i ].visible && instanceInfo[ i ].active ) {\n\n\t\t\t\t\tconst geometryId = instanceInfo[ i ].geometryIndex;\n\n\t\t\t\t\t// determine whether the batched geometry is within the frustum\n\t\t\t\t\tlet culled = false;\n\t\t\t\t\tif ( perObjectFrustumCulled ) {\n\n\t\t\t\t\t\t// get the bounds in world space\n\t\t\t\t\t\tthis.getMatrixAt( i, _matrix$1 );\n\t\t\t\t\t\tthis.getBoundingSphereAt( geometryId, _sphere$2 ).applyMatrix4( _matrix$1 );\n\t\t\t\t\t\tculled = ! _frustum$1.intersectsSphere( _sphere$2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! culled ) {\n\n\t\t\t\t\t\tconst geometryInfo = geometryInfoList[ geometryId ];\n\t\t\t\t\t\tmultiDrawStarts[ multiDrawCount ] = geometryInfo.start * bytesPerElement;\n\t\t\t\t\t\tmultiDrawCounts[ multiDrawCount ] = geometryInfo.count;\n\t\t\t\t\t\tindirectArray[ multiDrawCount ] = i;\n\t\t\t\t\t\tmultiDrawCount ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tindirectTexture.needsUpdate = true;\n\t\tthis._multiDrawCount = multiDrawCount;\n\t\tthis._visibilityChanged = false;\n\n\t}\n\n\tonBeforeShadow( renderer, object, camera, shadowCamera, geometry, depthMaterial/* , group */ ) {\n\n\t\tthis.onBeforeRender( renderer, null, shadowCamera, geometry, depthMaterial );\n\n\t}\n\n}\n\nclass LineBasicMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'LineBasicMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineBasicMaterial = true;\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.linewidth = 1;\n\t\tthis.linecap = 'round';\n\t\tthis.linejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.linewidth = source.linewidth;\n\t\tthis.linecap = source.linecap;\n\t\tthis.linejoin = source.linejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vStart = /*@__PURE__*/ new Vector3();\nconst _vEnd = /*@__PURE__*/ new Vector3();\n\nconst _inverseMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _ray$1 = /*@__PURE__*/ new Ray();\nconst _sphere$1 = /*@__PURE__*/ new Sphere();\n\nconst _intersectPointOnRay = /*@__PURE__*/ new Vector3();\nconst _intersectPointOnSegment = /*@__PURE__*/ new Vector3();\n\nclass Line extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new LineBasicMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isLine = true;\n\n\t\tthis.type = 'Line';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.material = Array.isArray( source.material ) ? source.material.slice() : source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\t// we assume non-indexed geometry\n\n\t\tif ( geometry.index === null ) {\n\n\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\tconst lineDistances = [ 0 ];\n\n\t\t\tfor ( let i = 1, l = positionAttribute.count; i < l; i ++ ) {\n\n\t\t\t\t_vStart.fromBufferAttribute( positionAttribute, i - 1 );\n\t\t\t\t_vEnd.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\tlineDistances[ i ] = lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i ] += _vStart.distanceTo( _vEnd );\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Line.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere$1.copy( geometry.boundingSphere );\n\t\t_sphere$1.applyMatrix4( matrixWorld );\n\t\t_sphere$1.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere$1 ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix$1.copy( matrixWorld ).invert();\n\t\t_ray$1.copy( raycaster.ray ).applyMatrix4( _inverseMatrix$1 );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst step = this.isLineSegments ? 2 : 1;\n\n\t\tconst index = geometry.index;\n\t\tconst attributes = geometry.attributes;\n\t\tconst positionAttribute = attributes.position;\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\tconst a = index.getX( i );\n\t\t\t\tconst b = index.getX( i + 1 );\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, a, b );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.isLineLoop ) {\n\n\t\t\t\tconst a = index.getX( end - 1 );\n\t\t\t\tconst b = index.getX( start );\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, a, b );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end - 1; i < l; i += step ) {\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, i, i + 1 );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( this.isLineLoop ) {\n\n\t\t\t\tconst intersect = checkIntersection( this, raycaster, _ray$1, localThresholdSq, end - 1, start );\n\n\t\t\t\tif ( intersect ) {\n\n\t\t\t\t\tintersects.push( intersect );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction checkIntersection( object, raycaster, ray, thresholdSq, a, b ) {\n\n\tconst positionAttribute = object.geometry.attributes.position;\n\n\t_vStart.fromBufferAttribute( positionAttribute, a );\n\t_vEnd.fromBufferAttribute( positionAttribute, b );\n\n\tconst distSq = ray.distanceSqToSegment( _vStart, _vEnd, _intersectPointOnRay, _intersectPointOnSegment );\n\n\tif ( distSq > thresholdSq ) return;\n\n\t_intersectPointOnRay.applyMatrix4( object.matrixWorld ); // Move back to world space for distance calculation\n\n\tconst distance = raycaster.ray.origin.distanceTo( _intersectPointOnRay );\n\n\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\treturn {\n\n\t\tdistance: distance,\n\t\t// What do we want? intersection point on the ray or on the segment??\n\t\t// point: raycaster.ray.at( distance ),\n\t\tpoint: _intersectPointOnSegment.clone().applyMatrix4( object.matrixWorld ),\n\t\tindex: a,\n\t\tface: null,\n\t\tfaceIndex: null,\n\t\tbarycoord: null,\n\t\tobject: object\n\n\t};\n\n}\n\nconst _start = /*@__PURE__*/ new Vector3();\nconst _end = /*@__PURE__*/ new Vector3();\n\nclass LineSegments extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isLineSegments = true;\n\n\t\tthis.type = 'LineSegments';\n\n\t}\n\n\tcomputeLineDistances() {\n\n\t\tconst geometry = this.geometry;\n\n\t\t// we assume non-indexed geometry\n\n\t\tif ( geometry.index === null ) {\n\n\t\t\tconst positionAttribute = geometry.attributes.position;\n\t\t\tconst lineDistances = [];\n\n\t\t\tfor ( let i = 0, l = positionAttribute.count; i < l; i += 2 ) {\n\n\t\t\t\t_start.fromBufferAttribute( positionAttribute, i );\n\t\t\t\t_end.fromBufferAttribute( positionAttribute, i + 1 );\n\n\t\t\t\tlineDistances[ i ] = ( i === 0 ) ? 0 : lineDistances[ i - 1 ];\n\t\t\t\tlineDistances[ i + 1 ] = lineDistances[ i ] + _start.distanceTo( _end );\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( 'lineDistance', new Float32BufferAttribute( lineDistances, 1 ) );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.' );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineLoop extends Line {\n\n\tconstructor( geometry, material ) {\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isLineLoop = true;\n\n\t\tthis.type = 'LineLoop';\n\n\t}\n\n}\n\nclass PointsMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'PointsMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isPointsMaterial = true;\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.size = 1;\n\t\tthis.sizeAttenuation = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.size = source.size;\n\t\tthis.sizeAttenuation = source.sizeAttenuation;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _inverseMatrix = /*@__PURE__*/ new Matrix4();\nconst _ray = /*@__PURE__*/ new Ray();\nconst _sphere = /*@__PURE__*/ new Sphere();\nconst _position$2 = /*@__PURE__*/ new Vector3();\n\nclass Points extends Object3D {\n\n\tconstructor( geometry = new BufferGeometry(), material = new PointsMaterial() ) {\n\n\t\tsuper();\n\n\t\tthis.isPoints = true;\n\n\t\tthis.type = 'Points';\n\n\t\tthis.geometry = geometry;\n\t\tthis.material = material;\n\n\t\tthis.updateMorphTargets();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.material = Array.isArray( source.material ) ? source.material.slice() : source.material;\n\t\tthis.geometry = source.geometry;\n\n\t\treturn this;\n\n\t}\n\n\traycast( raycaster, intersects ) {\n\n\t\tconst geometry = this.geometry;\n\t\tconst matrixWorld = this.matrixWorld;\n\t\tconst threshold = raycaster.params.Points.threshold;\n\t\tconst drawRange = geometry.drawRange;\n\n\t\t// Checking boundingSphere distance to ray\n\n\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t_sphere.copy( geometry.boundingSphere );\n\t\t_sphere.applyMatrix4( matrixWorld );\n\t\t_sphere.radius += threshold;\n\n\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\n\n\t\t//\n\n\t\t_inverseMatrix.copy( matrixWorld ).invert();\n\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\n\n\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\n\t\tconst localThresholdSq = localThreshold * localThreshold;\n\n\t\tconst index = geometry.index;\n\t\tconst attributes = geometry.attributes;\n\t\tconst positionAttribute = attributes.position;\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, il = end; i < il; i ++ ) {\n\n\t\t\t\tconst a = index.getX( i );\n\n\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, a );\n\n\t\t\t\ttestPoint( _position$2, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst start = Math.max( 0, drawRange.start );\n\t\t\tconst end = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( let i = start, l = end; i < l; i ++ ) {\n\n\t\t\t\t_position$2.fromBufferAttribute( positionAttribute, i );\n\n\t\t\t\ttestPoint( _position$2, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateMorphTargets() {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst morphAttributes = geometry.morphAttributes;\n\t\tconst keys = Object.keys( morphAttributes );\n\n\t\tif ( keys.length > 0 ) {\n\n\t\t\tconst morphAttribute = morphAttributes[ keys[ 0 ] ];\n\n\t\t\tif ( morphAttribute !== undefined ) {\n\n\t\t\t\tthis.morphTargetInfluences = [];\n\t\t\t\tthis.morphTargetDictionary = {};\n\n\t\t\t\tfor ( let m = 0, ml = morphAttribute.length; m < ml; m ++ ) {\n\n\t\t\t\t\tconst name = morphAttribute[ m ].name || String( m );\n\n\t\t\t\t\tthis.morphTargetInfluences.push( 0 );\n\t\t\t\t\tthis.morphTargetDictionary[ name ] = m;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\n\n\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\n\n\tif ( rayPointDistanceSq < localThresholdSq ) {\n\n\t\tconst intersectPoint = new Vector3();\n\n\t\t_ray.closestPointToPoint( point, intersectPoint );\n\t\tintersectPoint.applyMatrix4( matrixWorld );\n\n\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\n\n\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\n\n\t\tintersects.push( {\n\n\t\t\tdistance: distance,\n\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\n\t\t\tpoint: intersectPoint,\n\t\t\tindex: index,\n\t\t\tface: null,\n\t\t\tfaceIndex: null,\n\t\t\tbarycoord: null,\n\t\t\tobject: object\n\n\t\t} );\n\n\t}\n\n}\n\nclass Group extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isGroup = true;\n\n\t\tthis.type = 'Group';\n\n\t}\n\n}\n\nclass VideoTexture extends Texture {\n\n\tconstructor( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( video, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isVideoTexture = true;\n\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : LinearFilter;\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : LinearFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tconst scope = this;\n\n\t\tfunction updateVideo() {\n\n\t\t\tscope.needsUpdate = true;\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t\tif ( 'requestVideoFrameCallback' in video ) {\n\n\t\t\tvideo.requestVideoFrameCallback( updateVideo );\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.image ).copy( this );\n\n\t}\n\n\tupdate() {\n\n\t\tconst video = this.image;\n\t\tconst hasVideoFrameCallback = 'requestVideoFrameCallback' in video;\n\n\t\tif ( hasVideoFrameCallback === false && video.readyState >= video.HAVE_CURRENT_DATA ) {\n\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nclass FramebufferTexture extends Texture {\n\n\tconstructor( width, height ) {\n\n\t\tsuper( { width, height } );\n\n\t\tthis.isFramebufferTexture = true;\n\n\t\tthis.magFilter = NearestFilter;\n\t\tthis.minFilter = NearestFilter;\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nclass CompressedTexture extends Texture {\n\n\tconstructor( mipmaps, width, height, format, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, colorSpace ) {\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy, colorSpace );\n\n\t\tthis.isCompressedTexture = true;\n\n\t\tthis.image = { width: width, height: height };\n\t\tthis.mipmaps = mipmaps;\n\n\t\t// no flipping for cube textures\n\t\t// (also flipping doesn't work for compressed textures )\n\n\t\tthis.flipY = false;\n\n\t\t// can't generate mipmaps for compressed textures\n\t\t// mips must be embedded in DDS files\n\n\t\tthis.generateMipmaps = false;\n\n\t}\n\n}\n\nclass CompressedArrayTexture extends CompressedTexture {\n\n\tconstructor( mipmaps, width, height, depth, format, type ) {\n\n\t\tsuper( mipmaps, width, height, format, type );\n\n\t\tthis.isCompressedArrayTexture = true;\n\t\tthis.image.depth = depth;\n\t\tthis.wrapR = ClampToEdgeWrapping;\n\n\t\tthis.layerUpdates = new Set();\n\n\t}\n\n\taddLayerUpdate( layerIndex ) {\n\n\t\tthis.layerUpdates.add( layerIndex );\n\n\t}\n\n\tclearLayerUpdates() {\n\n\t\tthis.layerUpdates.clear();\n\n\t}\n\n}\n\nclass CompressedCubeTexture extends CompressedTexture {\n\n\tconstructor( images, format, type ) {\n\n\t\tsuper( undefined, images[ 0 ].width, images[ 0 ].height, format, type, CubeReflectionMapping );\n\n\t\tthis.isCompressedCubeTexture = true;\n\t\tthis.isCubeTexture = true;\n\n\t\tthis.image = images;\n\n\t}\n\n}\n\nclass CanvasTexture extends Texture {\n\n\tconstructor( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy ) {\n\n\t\tsuper( canvas, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isCanvasTexture = true;\n\n\t\tthis.needsUpdate = true;\n\n\t}\n\n}\n\nclass DepthTexture extends Texture {\n\n\tconstructor( width, height, type, mapping, wrapS, wrapT, magFilter, minFilter, anisotropy, format = DepthFormat ) {\n\n\t\tif ( format !== DepthFormat && format !== DepthStencilFormat ) {\n\n\t\t\tthrow new Error( 'DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat' );\n\n\t\t}\n\n\t\tif ( type === undefined && format === DepthFormat ) type = UnsignedIntType;\n\t\tif ( type === undefined && format === DepthStencilFormat ) type = UnsignedInt248Type;\n\n\t\tsuper( null, mapping, wrapS, wrapT, magFilter, minFilter, format, type, anisotropy );\n\n\t\tthis.isDepthTexture = true;\n\n\t\tthis.image = { width: width, height: height };\n\n\t\tthis.magFilter = magFilter !== undefined ? magFilter : NearestFilter;\n\t\tthis.minFilter = minFilter !== undefined ? minFilter : NearestFilter;\n\n\t\tthis.flipY = false;\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.compareFunction = null;\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.compareFunction = source.compareFunction;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tif ( this.compareFunction !== null ) data.compareFunction = this.compareFunction;\n\n\t\treturn data;\n\n\t}\n\n}\n\n/**\n * Extensible curve object.\n *\n * Some common of curve methods:\n * .getPoint( t, optionalTarget ), .getTangent( t, optionalTarget )\n * .getPointAt( u, optionalTarget ), .getTangentAt( u, optionalTarget )\n * .getPoints(), .getSpacedPoints()\n * .getLength()\n * .updateArcLengths()\n *\n * This following curves inherit from THREE.Curve:\n *\n * -- 2D curves --\n * THREE.ArcCurve\n * THREE.CubicBezierCurve\n * THREE.EllipseCurve\n * THREE.LineCurve\n * THREE.QuadraticBezierCurve\n * THREE.SplineCurve\n *\n * -- 3D curves --\n * THREE.CatmullRomCurve3\n * THREE.CubicBezierCurve3\n * THREE.LineCurve3\n * THREE.QuadraticBezierCurve3\n *\n * A series of curves can be represented as a THREE.CurvePath.\n *\n **/\n\nclass Curve {\n\n\tconstructor() {\n\n\t\tthis.type = 'Curve';\n\n\t\tthis.arcLengthDivisions = 200;\n\n\t}\n\n\t// Virtual base class method to overwrite and implement in subclasses\n\t//\t- t [0 .. 1]\n\n\tgetPoint( /* t, optionalTarget */ ) {\n\n\t\tconsole.warn( 'THREE.Curve: .getPoint() not implemented.' );\n\t\treturn null;\n\n\t}\n\n\t// Get point at relative position in curve according to arc length\n\t// - u [0 .. 1]\n\n\tgetPointAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getPoint( t, optionalTarget );\n\n\t}\n\n\t// Get sequence of points using getPoint( t )\n\n\tgetPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPoint( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get sequence of points using getPointAt( u )\n\n\tgetSpacedPoints( divisions = 5 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let d = 0; d <= divisions; d ++ ) {\n\n\t\t\tpoints.push( this.getPointAt( d / divisions ) );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\t// Get total curve arc length\n\n\tgetLength() {\n\n\t\tconst lengths = this.getLengths();\n\t\treturn lengths[ lengths.length - 1 ];\n\n\t}\n\n\t// Get list of cumulative segment lengths\n\n\tgetLengths( divisions = this.arcLengthDivisions ) {\n\n\t\tif ( this.cacheArcLengths &&\n\t\t\t( this.cacheArcLengths.length === divisions + 1 ) &&\n\t\t\t! this.needsUpdate ) {\n\n\t\t\treturn this.cacheArcLengths;\n\n\t\t}\n\n\t\tthis.needsUpdate = false;\n\n\t\tconst cache = [];\n\t\tlet current, last = this.getPoint( 0 );\n\t\tlet sum = 0;\n\n\t\tcache.push( 0 );\n\n\t\tfor ( let p = 1; p <= divisions; p ++ ) {\n\n\t\t\tcurrent = this.getPoint( p / divisions );\n\t\t\tsum += current.distanceTo( last );\n\t\t\tcache.push( sum );\n\t\t\tlast = current;\n\n\t\t}\n\n\t\tthis.cacheArcLengths = cache;\n\n\t\treturn cache; // { sums: cache, sum: sum }; Sum is in the last element.\n\n\t}\n\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.getLengths();\n\n\t}\n\n\t// Given u ( 0 .. 1 ), get a t to find p. This gives you points which are equidistant\n\n\tgetUtoTmapping( u, distance ) {\n\n\t\tconst arcLengths = this.getLengths();\n\n\t\tlet i = 0;\n\t\tconst il = arcLengths.length;\n\n\t\tlet targetArcLength; // The targeted u distance value to get\n\n\t\tif ( distance ) {\n\n\t\t\ttargetArcLength = distance;\n\n\t\t} else {\n\n\t\t\ttargetArcLength = u * arcLengths[ il - 1 ];\n\n\t\t}\n\n\t\t// binary search for the index with largest value smaller than target u distance\n\n\t\tlet low = 0, high = il - 1, comparison;\n\n\t\twhile ( low <= high ) {\n\n\t\t\ti = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats\n\n\t\t\tcomparison = arcLengths[ i ] - targetArcLength;\n\n\t\t\tif ( comparison < 0 ) {\n\n\t\t\t\tlow = i + 1;\n\n\t\t\t} else if ( comparison > 0 ) {\n\n\t\t\t\thigh = i - 1;\n\n\t\t\t} else {\n\n\t\t\t\thigh = i;\n\t\t\t\tbreak;\n\n\t\t\t\t// DONE\n\n\t\t\t}\n\n\t\t}\n\n\t\ti = high;\n\n\t\tif ( arcLengths[ i ] === targetArcLength ) {\n\n\t\t\treturn i / ( il - 1 );\n\n\t\t}\n\n\t\t// we could get finer grain at lengths, or use simple interpolation between two points\n\n\t\tconst lengthBefore = arcLengths[ i ];\n\t\tconst lengthAfter = arcLengths[ i + 1 ];\n\n\t\tconst segmentLength = lengthAfter - lengthBefore;\n\n\t\t// determine where we are between the 'before' and 'after' points\n\n\t\tconst segmentFraction = ( targetArcLength - lengthBefore ) / segmentLength;\n\n\t\t// add that fractional amount to t\n\n\t\tconst t = ( i + segmentFraction ) / ( il - 1 );\n\n\t\treturn t;\n\n\t}\n\n\t// Returns a unit vector tangent at t\n\t// In case any sub curve does not implement its tangent derivation,\n\t// 2 points a small delta apart will be used to find its gradient\n\t// which seems to give a reasonable approximation\n\n\tgetTangent( t, optionalTarget ) {\n\n\t\tconst delta = 0.0001;\n\t\tlet t1 = t - delta;\n\t\tlet t2 = t + delta;\n\n\t\t// Capping in case of danger\n\n\t\tif ( t1 < 0 ) t1 = 0;\n\t\tif ( t2 > 1 ) t2 = 1;\n\n\t\tconst pt1 = this.getPoint( t1 );\n\t\tconst pt2 = this.getPoint( t2 );\n\n\t\tconst tangent = optionalTarget || ( ( pt1.isVector2 ) ? new Vector2() : new Vector3() );\n\n\t\ttangent.copy( pt2 ).sub( pt1 ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\tconst t = this.getUtoTmapping( u );\n\t\treturn this.getTangent( t, optionalTarget );\n\n\t}\n\n\tcomputeFrenetFrames( segments, closed ) {\n\n\t\t// see http://www.cs.indiana.edu/pub/techreports/TR425.pdf\n\n\t\tconst normal = new Vector3();\n\n\t\tconst tangents = [];\n\t\tconst normals = [];\n\t\tconst binormals = [];\n\n\t\tconst vec = new Vector3();\n\t\tconst mat = new Matrix4();\n\n\t\t// compute the tangent vectors for each segment on the curve\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst u = i / segments;\n\n\t\t\ttangents[ i ] = this.getTangentAt( u, new Vector3() );\n\n\t\t}\n\n\t\t// select an initial normal vector perpendicular to the first tangent vector,\n\t\t// and in the direction of the minimum tangent xyz component\n\n\t\tnormals[ 0 ] = new Vector3();\n\t\tbinormals[ 0 ] = new Vector3();\n\t\tlet min = Number.MAX_VALUE;\n\t\tconst tx = Math.abs( tangents[ 0 ].x );\n\t\tconst ty = Math.abs( tangents[ 0 ].y );\n\t\tconst tz = Math.abs( tangents[ 0 ].z );\n\n\t\tif ( tx <= min ) {\n\n\t\t\tmin = tx;\n\t\t\tnormal.set( 1, 0, 0 );\n\n\t\t}\n\n\t\tif ( ty <= min ) {\n\n\t\t\tmin = ty;\n\t\t\tnormal.set( 0, 1, 0 );\n\n\t\t}\n\n\t\tif ( tz <= min ) {\n\n\t\t\tnormal.set( 0, 0, 1 );\n\n\t\t}\n\n\t\tvec.crossVectors( tangents[ 0 ], normal ).normalize();\n\n\t\tnormals[ 0 ].crossVectors( tangents[ 0 ], vec );\n\t\tbinormals[ 0 ].crossVectors( tangents[ 0 ], normals[ 0 ] );\n\n\n\t\t// compute the slowly-varying normal and binormal vectors for each segment on the curve\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tnormals[ i ] = normals[ i - 1 ].clone();\n\n\t\t\tbinormals[ i ] = binormals[ i - 1 ].clone();\n\n\t\t\tvec.crossVectors( tangents[ i - 1 ], tangents[ i ] );\n\n\t\t\tif ( vec.length() > Number.EPSILON ) {\n\n\t\t\t\tvec.normalize();\n\n\t\t\t\tconst theta = Math.acos( clamp$1( tangents[ i - 1 ].dot( tangents[ i ] ), - 1, 1 ) ); // clamp for floating pt errors\n\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( vec, theta ) );\n\n\t\t\t}\n\n\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t}\n\n\t\t// if the curve is closed, postprocess the vectors so the first and last normal vectors are the same\n\n\t\tif ( closed === true ) {\n\n\t\t\tlet theta = Math.acos( clamp$1( normals[ 0 ].dot( normals[ segments ] ), - 1, 1 ) );\n\t\t\ttheta /= segments;\n\n\t\t\tif ( tangents[ 0 ].dot( vec.crossVectors( normals[ 0 ], normals[ segments ] ) ) > 0 ) {\n\n\t\t\t\ttheta = - theta;\n\n\t\t\t}\n\n\t\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\t\t// twist a little...\n\t\t\t\tnormals[ i ].applyMatrix4( mat.makeRotationAxis( tangents[ i ], theta * i ) );\n\t\t\t\tbinormals[ i ].crossVectors( tangents[ i ], normals[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\ttangents: tangents,\n\t\t\tnormals: normals,\n\t\t\tbinormals: binormals\n\t\t};\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.arcLengthDivisions = source.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = {\n\t\t\tmetadata: {\n\t\t\t\tversion: 4.6,\n\t\t\t\ttype: 'Curve',\n\t\t\t\tgenerator: 'Curve.toJSON'\n\t\t\t}\n\t\t};\n\n\t\tdata.arcLengthDivisions = this.arcLengthDivisions;\n\t\tdata.type = this.type;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.arcLengthDivisions = json.arcLengthDivisions;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass EllipseCurve extends Curve {\n\n\tconstructor( aX = 0, aY = 0, xRadius = 1, yRadius = 1, aStartAngle = 0, aEndAngle = Math.PI * 2, aClockwise = false, aRotation = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.isEllipseCurve = true;\n\n\t\tthis.type = 'EllipseCurve';\n\n\t\tthis.aX = aX;\n\t\tthis.aY = aY;\n\n\t\tthis.xRadius = xRadius;\n\t\tthis.yRadius = yRadius;\n\n\t\tthis.aStartAngle = aStartAngle;\n\t\tthis.aEndAngle = aEndAngle;\n\n\t\tthis.aClockwise = aClockwise;\n\n\t\tthis.aRotation = aRotation;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst twoPi = Math.PI * 2;\n\t\tlet deltaAngle = this.aEndAngle - this.aStartAngle;\n\t\tconst samePoints = Math.abs( deltaAngle ) < Number.EPSILON;\n\n\t\t// ensures that deltaAngle is 0 .. 2 PI\n\t\twhile ( deltaAngle < 0 ) deltaAngle += twoPi;\n\t\twhile ( deltaAngle > twoPi ) deltaAngle -= twoPi;\n\n\t\tif ( deltaAngle < Number.EPSILON ) {\n\n\t\t\tif ( samePoints ) {\n\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.aClockwise === true && ! samePoints ) {\n\n\t\t\tif ( deltaAngle === twoPi ) {\n\n\t\t\t\tdeltaAngle = - twoPi;\n\n\t\t\t} else {\n\n\t\t\t\tdeltaAngle = deltaAngle - twoPi;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst angle = this.aStartAngle + t * deltaAngle;\n\t\tlet x = this.aX + this.xRadius * Math.cos( angle );\n\t\tlet y = this.aY + this.yRadius * Math.sin( angle );\n\n\t\tif ( this.aRotation !== 0 ) {\n\n\t\t\tconst cos = Math.cos( this.aRotation );\n\t\t\tconst sin = Math.sin( this.aRotation );\n\n\t\t\tconst tx = x - this.aX;\n\t\t\tconst ty = y - this.aY;\n\n\t\t\t// Rotate the point about the center of the ellipse.\n\t\t\tx = tx * cos - ty * sin + this.aX;\n\t\t\ty = tx * sin + ty * cos + this.aY;\n\n\t\t}\n\n\t\treturn point.set( x, y );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.aX = source.aX;\n\t\tthis.aY = source.aY;\n\n\t\tthis.xRadius = source.xRadius;\n\t\tthis.yRadius = source.yRadius;\n\n\t\tthis.aStartAngle = source.aStartAngle;\n\t\tthis.aEndAngle = source.aEndAngle;\n\n\t\tthis.aClockwise = source.aClockwise;\n\n\t\tthis.aRotation = source.aRotation;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.aX = this.aX;\n\t\tdata.aY = this.aY;\n\n\t\tdata.xRadius = this.xRadius;\n\t\tdata.yRadius = this.yRadius;\n\n\t\tdata.aStartAngle = this.aStartAngle;\n\t\tdata.aEndAngle = this.aEndAngle;\n\n\t\tdata.aClockwise = this.aClockwise;\n\n\t\tdata.aRotation = this.aRotation;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.aX = json.aX;\n\t\tthis.aY = json.aY;\n\n\t\tthis.xRadius = json.xRadius;\n\t\tthis.yRadius = json.yRadius;\n\n\t\tthis.aStartAngle = json.aStartAngle;\n\t\tthis.aEndAngle = json.aEndAngle;\n\n\t\tthis.aClockwise = json.aClockwise;\n\n\t\tthis.aRotation = json.aRotation;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass ArcCurve extends EllipseCurve {\n\n\tconstructor( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tsuper( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\tthis.isArcCurve = true;\n\n\t\tthis.type = 'ArcCurve';\n\n\t}\n\n}\n\n/**\n * Centripetal CatmullRom Curve - which is useful for avoiding\n * cusps and self-intersections in non-uniform catmull rom curves.\n * http://www.cemyuksel.com/research/catmullrom_param/catmullrom.pdf\n *\n * curve.type accepts centripetal(default), chordal and catmullrom\n * curve.tension is used for catmullrom which defaults to 0.5\n */\n\n\n/*\nBased on an optimized c++ solution in\n - http://stackoverflow.com/questions/9489736/catmull-rom-curve-with-no-cusps-and-no-self-intersections/\n - http://ideone.com/NoEbVM\n\nThis CubicPoly class could be used for reusing some variables and calculations,\nbut for three.js curve use, it could be possible inlined and flatten into a single function call\nwhich can be placed in CurveUtils.\n*/\n\nfunction CubicPoly() {\n\n\tlet c0 = 0, c1 = 0, c2 = 0, c3 = 0;\n\n\t/*\n\t * Compute coefficients for a cubic polynomial\n\t *   p(s) = c0 + c1*s + c2*s^2 + c3*s^3\n\t * such that\n\t *   p(0) = x0, p(1) = x1\n\t *  and\n\t *   p'(0) = t0, p'(1) = t1.\n\t */\n\tfunction init( x0, x1, t0, t1 ) {\n\n\t\tc0 = x0;\n\t\tc1 = t0;\n\t\tc2 = - 3 * x0 + 3 * x1 - 2 * t0 - t1;\n\t\tc3 = 2 * x0 - 2 * x1 + t0 + t1;\n\n\t}\n\n\treturn {\n\n\t\tinitCatmullRom: function ( x0, x1, x2, x3, tension ) {\n\n\t\t\tinit( x1, x2, tension * ( x2 - x0 ), tension * ( x3 - x1 ) );\n\n\t\t},\n\n\t\tinitNonuniformCatmullRom: function ( x0, x1, x2, x3, dt0, dt1, dt2 ) {\n\n\t\t\t// compute tangents when parameterized in [t1,t2]\n\t\t\tlet t1 = ( x1 - x0 ) / dt0 - ( x2 - x0 ) / ( dt0 + dt1 ) + ( x2 - x1 ) / dt1;\n\t\t\tlet t2 = ( x2 - x1 ) / dt1 - ( x3 - x1 ) / ( dt1 + dt2 ) + ( x3 - x2 ) / dt2;\n\n\t\t\t// rescale tangents for parametrization in [0,1]\n\t\t\tt1 *= dt1;\n\t\t\tt2 *= dt1;\n\n\t\t\tinit( x1, x2, t1, t2 );\n\n\t\t},\n\n\t\tcalc: function ( t ) {\n\n\t\t\tconst t2 = t * t;\n\t\t\tconst t3 = t2 * t;\n\t\t\treturn c0 + c1 * t + c2 * t2 + c3 * t3;\n\n\t\t}\n\n\t};\n\n}\n\n//\n\nconst tmp = /*@__PURE__*/ new Vector3();\nconst px = /*@__PURE__*/ new CubicPoly();\nconst py = /*@__PURE__*/ new CubicPoly();\nconst pz = /*@__PURE__*/ new CubicPoly();\n\nclass CatmullRomCurve3 extends Curve {\n\n\tconstructor( points = [], closed = false, curveType = 'centripetal', tension = 0.5 ) {\n\n\t\tsuper();\n\n\t\tthis.isCatmullRomCurve3 = true;\n\n\t\tthis.type = 'CatmullRomCurve3';\n\n\t\tthis.points = points;\n\t\tthis.closed = closed;\n\t\tthis.curveType = curveType;\n\t\tthis.tension = tension;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst l = points.length;\n\n\t\tconst p = ( l - ( this.closed ? 0 : 1 ) ) * t;\n\t\tlet intPoint = Math.floor( p );\n\t\tlet weight = p - intPoint;\n\n\t\tif ( this.closed ) {\n\n\t\t\tintPoint += intPoint > 0 ? 0 : ( Math.floor( Math.abs( intPoint ) / l ) + 1 ) * l;\n\n\t\t} else if ( weight === 0 && intPoint === l - 1 ) {\n\n\t\t\tintPoint = l - 2;\n\t\t\tweight = 1;\n\n\t\t}\n\n\t\tlet p0, p3; // 4 points (p1 & p2 defined below)\n\n\t\tif ( this.closed || intPoint > 0 ) {\n\n\t\t\tp0 = points[ ( intPoint - 1 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate first point\n\t\t\ttmp.subVectors( points[ 0 ], points[ 1 ] ).add( points[ 0 ] );\n\t\t\tp0 = tmp;\n\n\t\t}\n\n\t\tconst p1 = points[ intPoint % l ];\n\t\tconst p2 = points[ ( intPoint + 1 ) % l ];\n\n\t\tif ( this.closed || intPoint + 2 < l ) {\n\n\t\t\tp3 = points[ ( intPoint + 2 ) % l ];\n\n\t\t} else {\n\n\t\t\t// extrapolate last point\n\t\t\ttmp.subVectors( points[ l - 1 ], points[ l - 2 ] ).add( points[ l - 1 ] );\n\t\t\tp3 = tmp;\n\n\t\t}\n\n\t\tif ( this.curveType === 'centripetal' || this.curveType === 'chordal' ) {\n\n\t\t\t// init Centripetal / Chordal Catmull-Rom\n\t\t\tconst pow = this.curveType === 'chordal' ? 0.5 : 0.25;\n\t\t\tlet dt0 = Math.pow( p0.distanceToSquared( p1 ), pow );\n\t\t\tlet dt1 = Math.pow( p1.distanceToSquared( p2 ), pow );\n\t\t\tlet dt2 = Math.pow( p2.distanceToSquared( p3 ), pow );\n\n\t\t\t// safety check for repeated points\n\t\t\tif ( dt1 < 1e-4 ) dt1 = 1.0;\n\t\t\tif ( dt0 < 1e-4 ) dt0 = dt1;\n\t\t\tif ( dt2 < 1e-4 ) dt2 = dt1;\n\n\t\t\tpx.initNonuniformCatmullRom( p0.x, p1.x, p2.x, p3.x, dt0, dt1, dt2 );\n\t\t\tpy.initNonuniformCatmullRom( p0.y, p1.y, p2.y, p3.y, dt0, dt1, dt2 );\n\t\t\tpz.initNonuniformCatmullRom( p0.z, p1.z, p2.z, p3.z, dt0, dt1, dt2 );\n\n\t\t} else if ( this.curveType === 'catmullrom' ) {\n\n\t\t\tpx.initCatmullRom( p0.x, p1.x, p2.x, p3.x, this.tension );\n\t\t\tpy.initCatmullRom( p0.y, p1.y, p2.y, p3.y, this.tension );\n\t\t\tpz.initCatmullRom( p0.z, p1.z, p2.z, p3.z, this.tension );\n\n\t\t}\n\n\t\tpoint.set(\n\t\t\tpx.calc( weight ),\n\t\t\tpy.calc( weight ),\n\t\t\tpz.calc( weight )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\tthis.closed = source.closed;\n\t\tthis.curveType = source.curveType;\n\t\tthis.tension = source.tension;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\tdata.closed = this.closed;\n\t\tdata.curveType = this.curveType;\n\t\tdata.tension = this.tension;\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector3().fromArray( point ) );\n\n\t\t}\n\n\t\tthis.closed = json.closed;\n\t\tthis.curveType = json.curveType;\n\t\tthis.tension = json.tension;\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Bezier Curves formulas obtained from\n * https://en.wikipedia.org/wiki/B%C3%A9zier_curve\n */\n\nfunction CatmullRom( t, p0, p1, p2, p3 ) {\n\n\tconst v0 = ( p2 - p0 ) * 0.5;\n\tconst v1 = ( p3 - p1 ) * 0.5;\n\tconst t2 = t * t;\n\tconst t3 = t * t2;\n\treturn ( 2 * p1 - 2 * p2 + v0 + v1 ) * t3 + ( - 3 * p1 + 3 * p2 - 2 * v0 - v1 ) * t2 + v0 * t + p1;\n\n}\n\n//\n\nfunction QuadraticBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * p;\n\n}\n\nfunction QuadraticBezierP1( t, p ) {\n\n\treturn 2 * ( 1 - t ) * t * p;\n\n}\n\nfunction QuadraticBezierP2( t, p ) {\n\n\treturn t * t * p;\n\n}\n\nfunction QuadraticBezier( t, p0, p1, p2 ) {\n\n\treturn QuadraticBezierP0( t, p0 ) + QuadraticBezierP1( t, p1 ) +\n\t\tQuadraticBezierP2( t, p2 );\n\n}\n\n//\n\nfunction CubicBezierP0( t, p ) {\n\n\tconst k = 1 - t;\n\treturn k * k * k * p;\n\n}\n\nfunction CubicBezierP1( t, p ) {\n\n\tconst k = 1 - t;\n\treturn 3 * k * k * t * p;\n\n}\n\nfunction CubicBezierP2( t, p ) {\n\n\treturn 3 * ( 1 - t ) * t * t * p;\n\n}\n\nfunction CubicBezierP3( t, p ) {\n\n\treturn t * t * t * p;\n\n}\n\nfunction CubicBezier( t, p0, p1, p2, p3 ) {\n\n\treturn CubicBezierP0( t, p0 ) + CubicBezierP1( t, p1 ) + CubicBezierP2( t, p2 ) +\n\t\tCubicBezierP3( t, p3 );\n\n}\n\nclass CubicBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2(), v3 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isCubicBezierCurve = true;\n\n\t\tthis.type = 'CubicBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass CubicBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3(), v3 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isCubicBezierCurve3 = true;\n\n\t\tthis.type = 'CubicBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2, v3 = this.v3;\n\n\t\tpoint.set(\n\t\t\tCubicBezier( t, v0.x, v1.x, v2.x, v3.x ),\n\t\t\tCubicBezier( t, v0.y, v1.y, v2.y, v3.y ),\n\t\t\tCubicBezier( t, v0.z, v1.z, v2.z, v3.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\t\tthis.v3.copy( source.v3 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\t\tdata.v3 = this.v3.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\t\tthis.v3.fromArray( json.v3 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineCurve extends Curve {\n\n\tconstructor( v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isLineCurve = true;\n\n\t\tthis.type = 'LineCurve';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector2() ) {\n\n\t\treturn optionalTarget.subVectors( this.v2, this.v1 ).normalize();\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\treturn this.getTangent( u, optionalTarget );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineCurve3 extends Curve {\n\n\tconstructor( v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isLineCurve3 = true;\n\n\t\tthis.type = 'LineCurve3';\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tif ( t === 1 ) {\n\n\t\t\tpoint.copy( this.v2 );\n\n\t\t} else {\n\n\t\t\tpoint.copy( this.v2 ).sub( this.v1 );\n\t\t\tpoint.multiplyScalar( t ).add( this.v1 );\n\n\t\t}\n\n\t\treturn point;\n\n\t}\n\n\t// Line curve is linear, so we can overwrite default getPointAt\n\tgetPointAt( u, optionalTarget ) {\n\n\t\treturn this.getPoint( u, optionalTarget );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\treturn optionalTarget.subVectors( this.v2, this.v1 ).normalize();\n\n\t}\n\n\tgetTangentAt( u, optionalTarget ) {\n\n\t\treturn this.getTangent( u, optionalTarget );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve extends Curve {\n\n\tconstructor( v0 = new Vector2(), v1 = new Vector2(), v2 = new Vector2() ) {\n\n\t\tsuper();\n\n\t\tthis.isQuadraticBezierCurve = true;\n\n\t\tthis.type = 'QuadraticBezierCurve';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass QuadraticBezierCurve3 extends Curve {\n\n\tconstructor( v0 = new Vector3(), v1 = new Vector3(), v2 = new Vector3() ) {\n\n\t\tsuper();\n\n\t\tthis.isQuadraticBezierCurve3 = true;\n\n\t\tthis.type = 'QuadraticBezierCurve3';\n\n\t\tthis.v0 = v0;\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst v0 = this.v0, v1 = this.v1, v2 = this.v2;\n\n\t\tpoint.set(\n\t\t\tQuadraticBezier( t, v0.x, v1.x, v2.x ),\n\t\t\tQuadraticBezier( t, v0.y, v1.y, v2.y ),\n\t\t\tQuadraticBezier( t, v0.z, v1.z, v2.z )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.v0.copy( source.v0 );\n\t\tthis.v1.copy( source.v1 );\n\t\tthis.v2.copy( source.v2 );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.v0 = this.v0.toArray();\n\t\tdata.v1 = this.v1.toArray();\n\t\tdata.v2 = this.v2.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.v0.fromArray( json.v0 );\n\t\tthis.v1.fromArray( json.v1 );\n\t\tthis.v2.fromArray( json.v2 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass SplineCurve extends Curve {\n\n\tconstructor( points = [] ) {\n\n\t\tsuper();\n\n\t\tthis.isSplineCurve = true;\n\n\t\tthis.type = 'SplineCurve';\n\n\t\tthis.points = points;\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector2() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst points = this.points;\n\t\tconst p = ( points.length - 1 ) * t;\n\n\t\tconst intPoint = Math.floor( p );\n\t\tconst weight = p - intPoint;\n\n\t\tconst p0 = points[ intPoint === 0 ? intPoint : intPoint - 1 ];\n\t\tconst p1 = points[ intPoint ];\n\t\tconst p2 = points[ intPoint > points.length - 2 ? points.length - 1 : intPoint + 1 ];\n\t\tconst p3 = points[ intPoint > points.length - 3 ? points.length - 1 : intPoint + 2 ];\n\n\t\tpoint.set(\n\t\t\tCatmullRom( weight, p0.x, p1.x, p2.x, p3.x ),\n\t\t\tCatmullRom( weight, p0.y, p1.y, p2.y, p3.y )\n\t\t);\n\n\t\treturn point;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = source.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = source.points[ i ];\n\n\t\t\tthis.points.push( point.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.points = [];\n\n\t\tfor ( let i = 0, l = this.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = this.points[ i ];\n\t\t\tdata.points.push( point.toArray() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.points = [];\n\n\t\tfor ( let i = 0, l = json.points.length; i < l; i ++ ) {\n\n\t\t\tconst point = json.points[ i ];\n\t\t\tthis.points.push( new Vector2().fromArray( point ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nvar Curves = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tArcCurve: ArcCurve,\n\tCatmullRomCurve3: CatmullRomCurve3,\n\tCubicBezierCurve: CubicBezierCurve,\n\tCubicBezierCurve3: CubicBezierCurve3,\n\tEllipseCurve: EllipseCurve,\n\tLineCurve: LineCurve,\n\tLineCurve3: LineCurve3,\n\tQuadraticBezierCurve: QuadraticBezierCurve,\n\tQuadraticBezierCurve3: QuadraticBezierCurve3,\n\tSplineCurve: SplineCurve\n});\n\n/**************************************************************\n *\tCurved Path - a curve path is simply a array of connected\n *  curves, but retains the api of a curve\n **************************************************************/\n\nclass CurvePath extends Curve {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'CurvePath';\n\n\t\tthis.curves = [];\n\t\tthis.autoClose = false; // Automatically closes the path\n\n\t}\n\n\tadd( curve ) {\n\n\t\tthis.curves.push( curve );\n\n\t}\n\n\tclosePath() {\n\n\t\t// Add a line curve if start and end of lines are not connected\n\t\tconst startPoint = this.curves[ 0 ].getPoint( 0 );\n\t\tconst endPoint = this.curves[ this.curves.length - 1 ].getPoint( 1 );\n\n\t\tif ( ! startPoint.equals( endPoint ) ) {\n\n\t\t\tconst lineType = ( startPoint.isVector2 === true ) ? 'LineCurve' : 'LineCurve3';\n\t\t\tthis.curves.push( new Curves[ lineType ]( endPoint, startPoint ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// To get accurate point with reference to\n\t// entire path distance at time t,\n\t// following has to be done:\n\n\t// 1. Length of each sub path have to be known\n\t// 2. Locate and identify type of curve\n\t// 3. Get t for the curve\n\t// 4. Return curve.getPointAt(t')\n\n\tgetPoint( t, optionalTarget ) {\n\n\t\tconst d = t * this.getLength();\n\t\tconst curveLengths = this.getCurveLengths();\n\t\tlet i = 0;\n\n\t\t// To think about boundaries points.\n\n\t\twhile ( i < curveLengths.length ) {\n\n\t\t\tif ( curveLengths[ i ] >= d ) {\n\n\t\t\t\tconst diff = curveLengths[ i ] - d;\n\t\t\t\tconst curve = this.curves[ i ];\n\n\t\t\t\tconst segmentLength = curve.getLength();\n\t\t\t\tconst u = segmentLength === 0 ? 0 : 1 - diff / segmentLength;\n\n\t\t\t\treturn curve.getPointAt( u, optionalTarget );\n\n\t\t\t}\n\n\t\t\ti ++;\n\n\t\t}\n\n\t\treturn null;\n\n\t\t// loop where sum != 0, sum > d , sum+1 <d\n\n\t}\n\n\t// We cannot use the default THREE.Curve getPoint() with getLength() because in\n\t// THREE.Curve, getLength() depends on getPoint() but in THREE.CurvePath\n\t// getPoint() depends on getLength\n\n\tgetLength() {\n\n\t\tconst lens = this.getCurveLengths();\n\t\treturn lens[ lens.length - 1 ];\n\n\t}\n\n\t// cacheLengths must be recalculated.\n\tupdateArcLengths() {\n\n\t\tthis.needsUpdate = true;\n\t\tthis.cacheLengths = null;\n\t\tthis.getCurveLengths();\n\n\t}\n\n\t// Compute lengths and cache them\n\t// We cannot overwrite getLengths() because UtoT mapping uses it.\n\n\tgetCurveLengths() {\n\n\t\t// We use cache values if curves and cache array are same length\n\n\t\tif ( this.cacheLengths && this.cacheLengths.length === this.curves.length ) {\n\n\t\t\treturn this.cacheLengths;\n\n\t\t}\n\n\t\t// Get length of sub-curve\n\t\t// Push sums into cached array\n\n\t\tconst lengths = [];\n\t\tlet sums = 0;\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tsums += this.curves[ i ].getLength();\n\t\t\tlengths.push( sums );\n\n\t\t}\n\n\t\tthis.cacheLengths = lengths;\n\n\t\treturn lengths;\n\n\t}\n\n\tgetSpacedPoints( divisions = 40 ) {\n\n\t\tconst points = [];\n\n\t\tfor ( let i = 0; i <= divisions; i ++ ) {\n\n\t\t\tpoints.push( this.getPoint( i / divisions ) );\n\n\t\t}\n\n\t\tif ( this.autoClose ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tgetPoints( divisions = 12 ) {\n\n\t\tconst points = [];\n\t\tlet last;\n\n\t\tfor ( let i = 0, curves = this.curves; i < curves.length; i ++ ) {\n\n\t\t\tconst curve = curves[ i ];\n\t\t\tconst resolution = curve.isEllipseCurve ? divisions * 2\n\t\t\t\t: ( curve.isLineCurve || curve.isLineCurve3 ) ? 1\n\t\t\t\t\t: curve.isSplineCurve ? divisions * curve.points.length\n\t\t\t\t\t\t: divisions;\n\n\t\t\tconst pts = curve.getPoints( resolution );\n\n\t\t\tfor ( let j = 0; j < pts.length; j ++ ) {\n\n\t\t\t\tconst point = pts[ j ];\n\n\t\t\t\tif ( last && last.equals( point ) ) continue; // ensures no consecutive points are duplicates\n\n\t\t\t\tpoints.push( point );\n\t\t\t\tlast = point;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( this.autoClose && points.length > 1 && ! points[ points.length - 1 ].equals( points[ 0 ] ) ) {\n\n\t\t\tpoints.push( points[ 0 ] );\n\n\t\t}\n\n\t\treturn points;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = source.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = source.curves[ i ];\n\n\t\t\tthis.curves.push( curve.clone() );\n\n\t\t}\n\n\t\tthis.autoClose = source.autoClose;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.autoClose = this.autoClose;\n\t\tdata.curves = [];\n\n\t\tfor ( let i = 0, l = this.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = this.curves[ i ];\n\t\t\tdata.curves.push( curve.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.autoClose = json.autoClose;\n\t\tthis.curves = [];\n\n\t\tfor ( let i = 0, l = json.curves.length; i < l; i ++ ) {\n\n\t\t\tconst curve = json.curves[ i ];\n\t\t\tthis.curves.push( new Curves[ curve.type ]().fromJSON( curve ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Path extends CurvePath {\n\n\tconstructor( points ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Path';\n\n\t\tthis.currentPoint = new Vector2();\n\n\t\tif ( points ) {\n\n\t\t\tthis.setFromPoints( points );\n\n\t\t}\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.moveTo( points[ 0 ].x, points[ 0 ].y );\n\n\t\tfor ( let i = 1, l = points.length; i < l; i ++ ) {\n\n\t\t\tthis.lineTo( points[ i ].x, points[ i ].y );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPoint.set( x, y ); // TODO consider referencing vectors instead of copying?\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tconst curve = new LineCurve( this.currentPoint.clone(), new Vector2( x, y ) );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tconst curve = new QuadraticBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCPx, aCPy ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tconst curve = new CubicBezierCurve(\n\t\t\tthis.currentPoint.clone(),\n\t\t\tnew Vector2( aCP1x, aCP1y ),\n\t\t\tnew Vector2( aCP2x, aCP2y ),\n\t\t\tnew Vector2( aX, aY )\n\t\t);\n\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.set( aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts /*Array of Vector*/ ) {\n\n\t\tconst npts = [ this.currentPoint.clone() ].concat( pts );\n\n\t\tconst curve = new SplineCurve( npts );\n\t\tthis.curves.push( curve );\n\n\t\tthis.currentPoint.copy( pts[ pts.length - 1 ] );\n\n\t\treturn this;\n\n\t}\n\n\tarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absarc( aX + x0, aY + y0, aRadius,\n\t\t\taStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tabsarc( aX, aY, aRadius, aStartAngle, aEndAngle, aClockwise ) {\n\n\t\tthis.absellipse( aX, aY, aRadius, aRadius, aStartAngle, aEndAngle, aClockwise );\n\n\t\treturn this;\n\n\t}\n\n\tellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst x0 = this.currentPoint.x;\n\t\tconst y0 = this.currentPoint.y;\n\n\t\tthis.absellipse( aX + x0, aY + y0, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\treturn this;\n\n\t}\n\n\tabsellipse( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation ) {\n\n\t\tconst curve = new EllipseCurve( aX, aY, xRadius, yRadius, aStartAngle, aEndAngle, aClockwise, aRotation );\n\n\t\tif ( this.curves.length > 0 ) {\n\n\t\t\t// if a previous curve is present, attempt to join\n\t\t\tconst firstPoint = curve.getPoint( 0 );\n\n\t\t\tif ( ! firstPoint.equals( this.currentPoint ) ) {\n\n\t\t\t\tthis.lineTo( firstPoint.x, firstPoint.y );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.curves.push( curve );\n\n\t\tconst lastPoint = curve.getPoint( 1 );\n\t\tthis.currentPoint.copy( lastPoint );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.currentPoint.copy( source.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.currentPoint = this.currentPoint.toArray();\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.currentPoint.fromArray( json.currentPoint );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LatheGeometry extends BufferGeometry {\n\n\tconstructor( points = [ new Vector2( 0, - 0.5 ), new Vector2( 0.5, 0 ), new Vector2( 0, 0.5 ) ], segments = 12, phiStart = 0, phiLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'LatheGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpoints: points,\n\t\t\tsegments: segments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength\n\t\t};\n\n\t\tsegments = Math.floor( segments );\n\n\t\t// clamp phiLength so it's in range of [ 0, 2PI ]\n\n\t\tphiLength = clamp$1( phiLength, 0, Math.PI * 2 );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst uvs = [];\n\t\tconst initNormals = [];\n\t\tconst normals = [];\n\n\t\t// helper variables\n\n\t\tconst inverseSegments = 1.0 / segments;\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tconst normal = new Vector3();\n\t\tconst curNormal = new Vector3();\n\t\tconst prevNormal = new Vector3();\n\t\tlet dx = 0;\n\t\tlet dy = 0;\n\n\t\t// pre-compute normals for initial \"meridian\"\n\n\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\tswitch ( j ) {\n\n\t\t\t\tcase 0:\t\t\t\t// special handling for 1st vertex on path\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tprevNormal.copy( normal );\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase ( points.length - 1 ):\t// special handling for last Vertex on path\n\n\t\t\t\t\tinitNormals.push( prevNormal.x, prevNormal.y, prevNormal.z );\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\t\t\t// default handling for all vertices in between\n\n\t\t\t\t\tdx = points[ j + 1 ].x - points[ j ].x;\n\t\t\t\t\tdy = points[ j + 1 ].y - points[ j ].y;\n\n\t\t\t\t\tnormal.x = dy * 1.0;\n\t\t\t\t\tnormal.y = - dx;\n\t\t\t\t\tnormal.z = dy * 0.0;\n\n\t\t\t\t\tcurNormal.copy( normal );\n\n\t\t\t\t\tnormal.x += prevNormal.x;\n\t\t\t\t\tnormal.y += prevNormal.y;\n\t\t\t\t\tnormal.z += prevNormal.z;\n\n\t\t\t\t\tnormal.normalize();\n\n\t\t\t\t\tinitNormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\tprevNormal.copy( curNormal );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate vertices, uvs and normals\n\n\t\tfor ( let i = 0; i <= segments; i ++ ) {\n\n\t\t\tconst phi = phiStart + i * inverseSegments * phiLength;\n\n\t\t\tconst sin = Math.sin( phi );\n\t\t\tconst cos = Math.cos( phi );\n\n\t\t\tfor ( let j = 0; j <= ( points.length - 1 ); j ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = points[ j ].x * sin;\n\t\t\t\tvertex.y = points[ j ].y;\n\t\t\t\tvertex.z = points[ j ].x * cos;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = i / segments;\n\t\t\t\tuv.y = j / ( points.length - 1 );\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// normal\n\n\t\t\t\tconst x = initNormals[ 3 * j + 0 ] * sin;\n\t\t\t\tconst y = initNormals[ 3 * j + 1 ];\n\t\t\t\tconst z = initNormals[ 3 * j + 0 ] * cos;\n\n\t\t\t\tnormals.push( x, y, z );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 0; i < segments; i ++ ) {\n\n\t\t\tfor ( let j = 0; j < ( points.length - 1 ); j ++ ) {\n\n\t\t\t\tconst base = j + i * points.length;\n\n\t\t\t\tconst a = base;\n\t\t\t\tconst b = base + points.length;\n\t\t\t\tconst c = base + points.length + 1;\n\t\t\t\tconst d = base + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( c, d, b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new LatheGeometry( data.points, data.segments, data.phiStart, data.phiLength );\n\n\t}\n\n}\n\nclass CapsuleGeometry extends LatheGeometry {\n\n\tconstructor( radius = 1, length = 1, capSegments = 4, radialSegments = 8 ) {\n\n\t\tconst path = new Path();\n\t\tpath.absarc( 0, - length / 2, radius, Math.PI * 1.5, 0 );\n\t\tpath.absarc( 0, length / 2, radius, 0, Math.PI * 0.5 );\n\n\t\tsuper( path.getPoints( capSegments ), radialSegments );\n\n\t\tthis.type = 'CapsuleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tlength: length,\n\t\t\tcapSegments: capSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CapsuleGeometry( data.radius, data.length, data.capSegments, data.radialSegments );\n\n\t}\n\n}\n\nclass CircleGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, segments = 32, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CircleGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tsegments: segments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tsegments = Math.max( 3, segments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// center point\n\n\t\tvertices.push( 0, 0, 0 );\n\t\tnormals.push( 0, 0, 1 );\n\t\tuvs.push( 0.5, 0.5 );\n\n\t\tfor ( let s = 0, i = 3; s <= segments; s ++, i += 3 ) {\n\n\t\t\tconst segment = thetaStart + s / segments * thetaLength;\n\n\t\t\t// vertex\n\n\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t// normal\n\n\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t// uvs\n\n\t\t\tuv.x = ( vertices[ i ] / radius + 1 ) / 2;\n\t\t\tuv.y = ( vertices[ i + 1 ] / radius + 1 ) / 2;\n\n\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let i = 1; i <= segments; i ++ ) {\n\n\t\t\tindices.push( i, i + 1, 0 );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CircleGeometry( data.radius, data.segments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass CylinderGeometry extends BufferGeometry {\n\n\tconstructor( radiusTop = 1, radiusBottom = 1, height = 1, radialSegments = 32, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'CylinderGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradiusTop: radiusTop,\n\t\t\tradiusBottom: radiusBottom,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tconst scope = this;\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\theightSegments = Math.floor( heightSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet index = 0;\n\t\tconst indexArray = [];\n\t\tconst halfHeight = height / 2;\n\t\tlet groupStart = 0;\n\n\t\t// generate geometry\n\n\t\tgenerateTorso();\n\n\t\tif ( openEnded === false ) {\n\n\t\t\tif ( radiusTop > 0 ) generateCap( true );\n\t\t\tif ( radiusBottom > 0 ) generateCap( false );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\tfunction generateTorso() {\n\n\t\t\tconst normal = new Vector3();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\t// this will be used to calculate the normal\n\t\t\tconst slope = ( radiusBottom - radiusTop ) / height;\n\n\t\t\t// generate vertices, normals and uvs\n\n\t\t\tfor ( let y = 0; y <= heightSegments; y ++ ) {\n\n\t\t\t\tconst indexRow = [];\n\n\t\t\t\tconst v = y / heightSegments;\n\n\t\t\t\t// calculate the radius of the current row\n\n\t\t\t\tconst radius = v * ( radiusBottom - radiusTop ) + radiusTop;\n\n\t\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\t\tconst u = x / radialSegments;\n\n\t\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\t\tconst sinTheta = Math.sin( theta );\n\t\t\t\t\tconst cosTheta = Math.cos( theta );\n\n\t\t\t\t\t// vertex\n\n\t\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\t\tvertex.y = - v * height + halfHeight;\n\t\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t\t// normal\n\n\t\t\t\t\tnormal.set( sinTheta, slope, cosTheta ).normalize();\n\t\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t\t// uv\n\n\t\t\t\t\tuvs.push( u, 1 - v );\n\n\t\t\t\t\t// save index of vertex in respective row\n\n\t\t\t\t\tindexRow.push( index ++ );\n\n\t\t\t\t}\n\n\t\t\t\t// now save vertices of the row in our index array\n\n\t\t\t\tindexArray.push( indexRow );\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tfor ( let y = 0; y < heightSegments; y ++ ) {\n\n\t\t\t\t\t// we use the index array to access the correct indices\n\n\t\t\t\t\tconst a = indexArray[ y ][ x ];\n\t\t\t\t\tconst b = indexArray[ y + 1 ][ x ];\n\t\t\t\t\tconst c = indexArray[ y + 1 ][ x + 1 ];\n\t\t\t\t\tconst d = indexArray[ y ][ x + 1 ];\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tif ( radiusTop > 0 || y !== 0 ) {\n\n\t\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\t\tgroupCount += 3;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( radiusBottom > 0 || y !== heightSegments - 1 ) {\n\n\t\t\t\t\t\tindices.push( b, c, d );\n\t\t\t\t\t\tgroupCount += 3;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, 0 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t\tfunction generateCap( top ) {\n\n\t\t\t// save the index of the first center vertex\n\t\t\tconst centerIndexStart = index;\n\n\t\t\tconst uv = new Vector2();\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tlet groupCount = 0;\n\n\t\t\tconst radius = ( top === true ) ? radiusTop : radiusBottom;\n\t\t\tconst sign = ( top === true ) ? 1 : - 1;\n\n\t\t\t// first we generate the center vertex data of the cap.\n\t\t\t// because the geometry needs one set of uvs per face,\n\t\t\t// we must generate a center vertex per face/segment\n\n\t\t\tfor ( let x = 1; x <= radialSegments; x ++ ) {\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertices.push( 0, halfHeight * sign, 0 );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( 0.5, 0.5 );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// save the index of the last center vertex\n\t\t\tconst centerIndexEnd = index;\n\n\t\t\t// now we generate the surrounding vertices, normals and uvs\n\n\t\t\tfor ( let x = 0; x <= radialSegments; x ++ ) {\n\n\t\t\t\tconst u = x / radialSegments;\n\t\t\t\tconst theta = u * thetaLength + thetaStart;\n\n\t\t\t\tconst cosTheta = Math.cos( theta );\n\t\t\t\tconst sinTheta = Math.sin( theta );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * sinTheta;\n\t\t\t\tvertex.y = halfHeight * sign;\n\t\t\t\tvertex.z = radius * cosTheta;\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, sign, 0 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( cosTheta * 0.5 ) + 0.5;\n\t\t\t\tuv.y = ( sinTheta * 0.5 * sign ) + 0.5;\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t// increase index\n\n\t\t\t\tindex ++;\n\n\t\t\t}\n\n\t\t\t// generate indices\n\n\t\t\tfor ( let x = 0; x < radialSegments; x ++ ) {\n\n\t\t\t\tconst c = centerIndexStart + x;\n\t\t\t\tconst i = centerIndexEnd + x;\n\n\t\t\t\tif ( top === true ) {\n\n\t\t\t\t\t// face top\n\n\t\t\t\t\tindices.push( i, i + 1, c );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// face bottom\n\n\t\t\t\t\tindices.push( i + 1, i, c );\n\n\t\t\t\t}\n\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t\t// add a group to the geometry. this will ensure multi material support\n\n\t\t\tscope.addGroup( groupStart, groupCount, top === true ? 1 : 2 );\n\n\t\t\t// calculate new start value for groups\n\n\t\t\tgroupStart += groupCount;\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new CylinderGeometry( data.radiusTop, data.radiusBottom, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ConeGeometry extends CylinderGeometry {\n\n\tconstructor( radius = 1, height = 1, radialSegments = 32, heightSegments = 1, openEnded = false, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper( 0, radius, height, radialSegments, heightSegments, openEnded, thetaStart, thetaLength );\n\n\t\tthis.type = 'ConeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\theight: height,\n\t\t\tradialSegments: radialSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\topenEnded: openEnded,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new ConeGeometry( data.radius, data.height, data.radialSegments, data.heightSegments, data.openEnded, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass PolyhedronGeometry extends BufferGeometry {\n\n\tconstructor( vertices = [], indices = [], radius = 1, detail = 0 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PolyhedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tvertices: vertices,\n\t\t\tindices: indices,\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t\t// default buffer data\n\n\t\tconst vertexBuffer = [];\n\t\tconst uvBuffer = [];\n\n\t\t// the subdivision creates the vertex buffer data\n\n\t\tsubdivide( detail );\n\n\t\t// all vertices should lie on a conceptual sphere with a given radius\n\n\t\tapplyRadius( radius );\n\n\t\t// finally, create the uv data\n\n\t\tgenerateUVs();\n\n\t\t// build non-indexed geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertexBuffer, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( vertexBuffer.slice(), 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvBuffer, 2 ) );\n\n\t\tif ( detail === 0 ) {\n\n\t\t\tthis.computeVertexNormals(); // flat normals\n\n\t\t} else {\n\n\t\t\tthis.normalizeNormals(); // smooth normals\n\n\t\t}\n\n\t\t// helper functions\n\n\t\tfunction subdivide( detail ) {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\t// iterate over all faces and apply a subdivision with the given detail value\n\n\t\t\tfor ( let i = 0; i < indices.length; i += 3 ) {\n\n\t\t\t\t// get the vertices of the face\n\n\t\t\t\tgetVertexByIndex( indices[ i + 0 ], a );\n\t\t\t\tgetVertexByIndex( indices[ i + 1 ], b );\n\t\t\t\tgetVertexByIndex( indices[ i + 2 ], c );\n\n\t\t\t\t// perform subdivision\n\n\t\t\t\tsubdivideFace( a, b, c, detail );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction subdivideFace( a, b, c, detail ) {\n\n\t\t\tconst cols = detail + 1;\n\n\t\t\t// we use this multidimensional array as a data structure for creating the subdivision\n\n\t\t\tconst v = [];\n\n\t\t\t// construct all of the vertices for this subdivision\n\n\t\t\tfor ( let i = 0; i <= cols; i ++ ) {\n\n\t\t\t\tv[ i ] = [];\n\n\t\t\t\tconst aj = a.clone().lerp( c, i / cols );\n\t\t\t\tconst bj = b.clone().lerp( c, i / cols );\n\n\t\t\t\tconst rows = cols - i;\n\n\t\t\t\tfor ( let j = 0; j <= rows; j ++ ) {\n\n\t\t\t\t\tif ( j === 0 && i === cols ) {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tv[ i ][ j ] = aj.clone().lerp( bj, j / rows );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// construct all of the faces\n\n\t\t\tfor ( let i = 0; i < cols; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j < 2 * ( cols - i ) - 1; j ++ ) {\n\n\t\t\t\t\tconst k = Math.floor( j / 2 );\n\n\t\t\t\t\tif ( j % 2 === 0 ) {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\t\t\t\t\t\tpushVertex( v[ i ][ k ] );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tpushVertex( v[ i ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k + 1 ] );\n\t\t\t\t\t\tpushVertex( v[ i + 1 ][ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction applyRadius( radius ) {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\t// iterate over the entire buffer and apply the radius to each vertex\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tvertex.normalize().multiplyScalar( radius );\n\n\t\t\t\tvertexBuffer[ i + 0 ] = vertex.x;\n\t\t\t\tvertexBuffer[ i + 1 ] = vertex.y;\n\t\t\t\tvertexBuffer[ i + 2 ] = vertex.z;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tconst vertex = new Vector3();\n\n\t\t\tfor ( let i = 0; i < vertexBuffer.length; i += 3 ) {\n\n\t\t\t\tvertex.x = vertexBuffer[ i + 0 ];\n\t\t\t\tvertex.y = vertexBuffer[ i + 1 ];\n\t\t\t\tvertex.z = vertexBuffer[ i + 2 ];\n\n\t\t\t\tconst u = azimuth( vertex ) / 2 / Math.PI + 0.5;\n\t\t\t\tconst v = inclination( vertex ) / Math.PI + 0.5;\n\t\t\t\tuvBuffer.push( u, 1 - v );\n\n\t\t\t}\n\n\t\t\tcorrectUVs();\n\n\t\t\tcorrectSeam();\n\n\t\t}\n\n\t\tfunction correctSeam() {\n\n\t\t\t// handle case when face straddles the seam, see #3269\n\n\t\t\tfor ( let i = 0; i < uvBuffer.length; i += 6 ) {\n\n\t\t\t\t// uv data of a single face\n\n\t\t\t\tconst x0 = uvBuffer[ i + 0 ];\n\t\t\t\tconst x1 = uvBuffer[ i + 2 ];\n\t\t\t\tconst x2 = uvBuffer[ i + 4 ];\n\n\t\t\t\tconst max = Math.max( x0, x1, x2 );\n\t\t\t\tconst min = Math.min( x0, x1, x2 );\n\n\t\t\t\t// 0.9 is somewhat arbitrary\n\n\t\t\t\tif ( max > 0.9 && min < 0.1 ) {\n\n\t\t\t\t\tif ( x0 < 0.2 ) uvBuffer[ i + 0 ] += 1;\n\t\t\t\t\tif ( x1 < 0.2 ) uvBuffer[ i + 2 ] += 1;\n\t\t\t\t\tif ( x2 < 0.2 ) uvBuffer[ i + 4 ] += 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction pushVertex( vertex ) {\n\n\t\t\tvertexBuffer.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\tfunction getVertexByIndex( index, vertex ) {\n\n\t\t\tconst stride = index * 3;\n\n\t\t\tvertex.x = vertices[ stride + 0 ];\n\t\t\tvertex.y = vertices[ stride + 1 ];\n\t\t\tvertex.z = vertices[ stride + 2 ];\n\n\t\t}\n\n\t\tfunction correctUVs() {\n\n\t\t\tconst a = new Vector3();\n\t\t\tconst b = new Vector3();\n\t\t\tconst c = new Vector3();\n\n\t\t\tconst centroid = new Vector3();\n\n\t\t\tconst uvA = new Vector2();\n\t\t\tconst uvB = new Vector2();\n\t\t\tconst uvC = new Vector2();\n\n\t\t\tfor ( let i = 0, j = 0; i < vertexBuffer.length; i += 9, j += 6 ) {\n\n\t\t\t\ta.set( vertexBuffer[ i + 0 ], vertexBuffer[ i + 1 ], vertexBuffer[ i + 2 ] );\n\t\t\t\tb.set( vertexBuffer[ i + 3 ], vertexBuffer[ i + 4 ], vertexBuffer[ i + 5 ] );\n\t\t\t\tc.set( vertexBuffer[ i + 6 ], vertexBuffer[ i + 7 ], vertexBuffer[ i + 8 ] );\n\n\t\t\t\tuvA.set( uvBuffer[ j + 0 ], uvBuffer[ j + 1 ] );\n\t\t\t\tuvB.set( uvBuffer[ j + 2 ], uvBuffer[ j + 3 ] );\n\t\t\t\tuvC.set( uvBuffer[ j + 4 ], uvBuffer[ j + 5 ] );\n\n\t\t\t\tcentroid.copy( a ).add( b ).add( c ).divideScalar( 3 );\n\n\t\t\t\tconst azi = azimuth( centroid );\n\n\t\t\t\tcorrectUV( uvA, j + 0, a, azi );\n\t\t\t\tcorrectUV( uvB, j + 2, b, azi );\n\t\t\t\tcorrectUV( uvC, j + 4, c, azi );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction correctUV( uv, stride, vector, azimuth ) {\n\n\t\t\tif ( ( azimuth < 0 ) && ( uv.x === 1 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = uv.x - 1;\n\n\t\t\t}\n\n\t\t\tif ( ( vector.x === 0 ) && ( vector.z === 0 ) ) {\n\n\t\t\t\tuvBuffer[ stride ] = azimuth / 2 / Math.PI + 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Angle around the Y axis, counter-clockwise when looking from above.\n\n\t\tfunction azimuth( vector ) {\n\n\t\t\treturn Math.atan2( vector.z, - vector.x );\n\n\t\t}\n\n\n\t\t// Angle above the XZ plane.\n\n\t\tfunction inclination( vector ) {\n\n\t\t\treturn Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PolyhedronGeometry( data.vertices, data.indices, data.radius, data.details );\n\n\t}\n\n}\n\nclass DodecahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\t\tconst r = 1 / t;\n\n\t\tconst vertices = [\n\n\t\t\t// (±1, ±1, ±1)\n\t\t\t- 1, - 1, - 1,\t- 1, - 1, 1,\n\t\t\t- 1, 1, - 1, - 1, 1, 1,\n\t\t\t1, - 1, - 1, 1, - 1, 1,\n\t\t\t1, 1, - 1, 1, 1, 1,\n\n\t\t\t// (0, ±1/φ, ±φ)\n\t\t\t0, - r, - t, 0, - r, t,\n\t\t\t0, r, - t, 0, r, t,\n\n\t\t\t// (±1/φ, ±φ, 0)\n\t\t\t- r, - t, 0, - r, t, 0,\n\t\t\tr, - t, 0, r, t, 0,\n\n\t\t\t// (±φ, 0, ±1/φ)\n\t\t\t- t, 0, - r, t, 0, - r,\n\t\t\t- t, 0, r, t, 0, r\n\t\t];\n\n\t\tconst indices = [\n\t\t\t3, 11, 7, \t3, 7, 15, \t3, 15, 13,\n\t\t\t7, 19, 17, \t7, 17, 6, \t7, 6, 15,\n\t\t\t17, 4, 8, \t17, 8, 10, \t17, 10, 6,\n\t\t\t8, 0, 16, \t8, 16, 2, \t8, 2, 10,\n\t\t\t0, 12, 1, \t0, 1, 18, \t0, 18, 16,\n\t\t\t6, 10, 2, \t6, 2, 13, \t6, 13, 15,\n\t\t\t2, 16, 18, \t2, 18, 3, \t2, 3, 13,\n\t\t\t18, 1, 9, \t18, 9, 11, \t18, 11, 3,\n\t\t\t4, 14, 12, \t4, 12, 0, \t4, 0, 8,\n\t\t\t11, 9, 5, \t11, 5, 19, \t11, 19, 7,\n\t\t\t19, 5, 14, \t19, 14, 4, \t19, 4, 17,\n\t\t\t1, 12, 14, \t1, 14, 5, \t1, 5, 9\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'DodecahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new DodecahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nconst _v0 = /*@__PURE__*/ new Vector3();\nconst _v1$1 = /*@__PURE__*/ new Vector3();\nconst _normal$1 = /*@__PURE__*/ new Vector3();\nconst _triangle = /*@__PURE__*/ new Triangle();\n\nclass EdgesGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null, thresholdAngle = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'EdgesGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry,\n\t\t\tthresholdAngle: thresholdAngle\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\tconst precisionPoints = 4;\n\t\t\tconst precision = Math.pow( 10, precisionPoints );\n\t\t\tconst thresholdDot = Math.cos( DEG2RAD * thresholdAngle );\n\n\t\t\tconst indexAttr = geometry.getIndex();\n\t\t\tconst positionAttr = geometry.getAttribute( 'position' );\n\t\t\tconst indexCount = indexAttr ? indexAttr.count : positionAttr.count;\n\n\t\t\tconst indexArr = [ 0, 0, 0 ];\n\t\t\tconst vertKeys = [ 'a', 'b', 'c' ];\n\t\t\tconst hashes = new Array( 3 );\n\n\t\t\tconst edgeData = {};\n\t\t\tconst vertices = [];\n\t\t\tfor ( let i = 0; i < indexCount; i += 3 ) {\n\n\t\t\t\tif ( indexAttr ) {\n\n\t\t\t\t\tindexArr[ 0 ] = indexAttr.getX( i );\n\t\t\t\t\tindexArr[ 1 ] = indexAttr.getX( i + 1 );\n\t\t\t\t\tindexArr[ 2 ] = indexAttr.getX( i + 2 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tindexArr[ 0 ] = i;\n\t\t\t\t\tindexArr[ 1 ] = i + 1;\n\t\t\t\t\tindexArr[ 2 ] = i + 2;\n\n\t\t\t\t}\n\n\t\t\t\tconst { a, b, c } = _triangle;\n\t\t\t\ta.fromBufferAttribute( positionAttr, indexArr[ 0 ] );\n\t\t\t\tb.fromBufferAttribute( positionAttr, indexArr[ 1 ] );\n\t\t\t\tc.fromBufferAttribute( positionAttr, indexArr[ 2 ] );\n\t\t\t\t_triangle.getNormal( _normal$1 );\n\n\t\t\t\t// create hashes for the edge from the vertices\n\t\t\t\thashes[ 0 ] = `${ Math.round( a.x * precision ) },${ Math.round( a.y * precision ) },${ Math.round( a.z * precision ) }`;\n\t\t\t\thashes[ 1 ] = `${ Math.round( b.x * precision ) },${ Math.round( b.y * precision ) },${ Math.round( b.z * precision ) }`;\n\t\t\t\thashes[ 2 ] = `${ Math.round( c.x * precision ) },${ Math.round( c.y * precision ) },${ Math.round( c.z * precision ) }`;\n\n\t\t\t\t// skip degenerate triangles\n\t\t\t\tif ( hashes[ 0 ] === hashes[ 1 ] || hashes[ 1 ] === hashes[ 2 ] || hashes[ 2 ] === hashes[ 0 ] ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// iterate over every edge\n\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t// get the first and next vertex making up the edge\n\t\t\t\t\tconst jNext = ( j + 1 ) % 3;\n\t\t\t\t\tconst vecHash0 = hashes[ j ];\n\t\t\t\t\tconst vecHash1 = hashes[ jNext ];\n\t\t\t\t\tconst v0 = _triangle[ vertKeys[ j ] ];\n\t\t\t\t\tconst v1 = _triangle[ vertKeys[ jNext ] ];\n\n\t\t\t\t\tconst hash = `${ vecHash0 }_${ vecHash1 }`;\n\t\t\t\t\tconst reverseHash = `${ vecHash1 }_${ vecHash0 }`;\n\n\t\t\t\t\tif ( reverseHash in edgeData && edgeData[ reverseHash ] ) {\n\n\t\t\t\t\t\t// if we found a sibling edge add it into the vertex array if\n\t\t\t\t\t\t// it meets the angle threshold and delete the edge from the map.\n\t\t\t\t\t\tif ( _normal$1.dot( edgeData[ reverseHash ].normal ) <= thresholdDot ) {\n\n\t\t\t\t\t\t\tvertices.push( v0.x, v0.y, v0.z );\n\t\t\t\t\t\t\tvertices.push( v1.x, v1.y, v1.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tedgeData[ reverseHash ] = null;\n\n\t\t\t\t\t} else if ( ! ( hash in edgeData ) ) {\n\n\t\t\t\t\t\t// if we've already got an edge here then skip adding a new one\n\t\t\t\t\t\tedgeData[ hash ] = {\n\n\t\t\t\t\t\t\tindex0: indexArr[ j ],\n\t\t\t\t\t\t\tindex1: indexArr[ jNext ],\n\t\t\t\t\t\t\tnormal: _normal$1.clone(),\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// iterate over all remaining, unmatched edges and add them to the vertex array\n\t\t\tfor ( const key in edgeData ) {\n\n\t\t\t\tif ( edgeData[ key ] ) {\n\n\t\t\t\t\tconst { index0, index1 } = edgeData[ key ];\n\t\t\t\t\t_v0.fromBufferAttribute( positionAttr, index0 );\n\t\t\t\t\t_v1$1.fromBufferAttribute( positionAttr, index1 );\n\n\t\t\t\t\tvertices.push( _v0.x, _v0.y, _v0.z );\n\t\t\t\t\tvertices.push( _v1$1.x, _v1$1.y, _v1$1.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass Shape extends Path {\n\n\tconstructor( points ) {\n\n\t\tsuper( points );\n\n\t\tthis.uuid = generateUUID();\n\n\t\tthis.type = 'Shape';\n\n\t\tthis.holes = [];\n\n\t}\n\n\tgetPointsHoles( divisions ) {\n\n\t\tconst holesPts = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tholesPts[ i ] = this.holes[ i ].getPoints( divisions );\n\n\t\t}\n\n\t\treturn holesPts;\n\n\t}\n\n\t// get points of shape and holes (keypoints based on segments parameter)\n\n\textractPoints( divisions ) {\n\n\t\treturn {\n\n\t\t\tshape: this.getPoints( divisions ),\n\t\t\tholes: this.getPointsHoles( divisions )\n\n\t\t};\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = source.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = source.holes[ i ];\n\n\t\t\tthis.holes.push( hole.clone() );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.uuid = this.uuid;\n\t\tdata.holes = [];\n\n\t\tfor ( let i = 0, l = this.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = this.holes[ i ];\n\t\t\tdata.holes.push( hole.toJSON() );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tsuper.fromJSON( json );\n\n\t\tthis.uuid = json.uuid;\n\t\tthis.holes = [];\n\n\t\tfor ( let i = 0, l = json.holes.length; i < l; i ++ ) {\n\n\t\t\tconst hole = json.holes[ i ];\n\t\t\tthis.holes.push( new Path().fromJSON( hole ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/**\n * Port from https://github.com/mapbox/earcut (v2.2.4)\n */\n\nconst Earcut = {\n\n\ttriangulate: function ( data, holeIndices, dim = 2 ) {\n\n\t\tconst hasHoles = holeIndices && holeIndices.length;\n\t\tconst outerLen = hasHoles ? holeIndices[ 0 ] * dim : data.length;\n\t\tlet outerNode = linkedList( data, 0, outerLen, dim, true );\n\t\tconst triangles = [];\n\n\t\tif ( ! outerNode || outerNode.next === outerNode.prev ) return triangles;\n\n\t\tlet minX, minY, maxX, maxY, x, y, invSize;\n\n\t\tif ( hasHoles ) outerNode = eliminateHoles( data, holeIndices, outerNode, dim );\n\n\t\t// if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n\t\tif ( data.length > 80 * dim ) {\n\n\t\t\tminX = maxX = data[ 0 ];\n\t\t\tminY = maxY = data[ 1 ];\n\n\t\t\tfor ( let i = dim; i < outerLen; i += dim ) {\n\n\t\t\t\tx = data[ i ];\n\t\t\t\ty = data[ i + 1 ];\n\t\t\t\tif ( x < minX ) minX = x;\n\t\t\t\tif ( y < minY ) minY = y;\n\t\t\t\tif ( x > maxX ) maxX = x;\n\t\t\t\tif ( y > maxY ) maxY = y;\n\n\t\t\t}\n\n\t\t\t// minX, minY and invSize are later used to transform coords into integers for z-order calculation\n\t\t\tinvSize = Math.max( maxX - minX, maxY - minY );\n\t\t\tinvSize = invSize !== 0 ? 32767 / invSize : 0;\n\n\t\t}\n\n\t\tearcutLinked( outerNode, triangles, dim, minX, minY, invSize, 0 );\n\n\t\treturn triangles;\n\n\t}\n\n};\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList( data, start, end, dim, clockwise ) {\n\n\tlet i, last;\n\n\tif ( clockwise === ( signedArea( data, start, end, dim ) > 0 ) ) {\n\n\t\tfor ( i = start; i < end; i += dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t} else {\n\n\t\tfor ( i = end - dim; i >= start; i -= dim ) last = insertNode( i, data[ i ], data[ i + 1 ], last );\n\n\t}\n\n\tif ( last && equals$1( last, last.next ) ) {\n\n\t\tremoveNode( last );\n\t\tlast = last.next;\n\n\t}\n\n\treturn last;\n\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints( start, end ) {\n\n\tif ( ! start ) return start;\n\tif ( ! end ) end = start;\n\n\tlet p = start,\n\t\tagain;\n\tdo {\n\n\t\tagain = false;\n\n\t\tif ( ! p.steiner && ( equals$1( p, p.next ) || area( p.prev, p, p.next ) === 0 ) ) {\n\n\t\t\tremoveNode( p );\n\t\t\tp = end = p.prev;\n\t\t\tif ( p === p.next ) break;\n\t\t\tagain = true;\n\n\t\t} else {\n\n\t\t\tp = p.next;\n\n\t\t}\n\n\t} while ( again || p !== end );\n\n\treturn end;\n\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked( ear, triangles, dim, minX, minY, invSize, pass ) {\n\n\tif ( ! ear ) return;\n\n\t// interlink polygon nodes in z-order\n\tif ( ! pass && invSize ) indexCurve( ear, minX, minY, invSize );\n\n\tlet stop = ear,\n\t\tprev, next;\n\n\t// iterate through ears, slicing them one by one\n\twhile ( ear.prev !== ear.next ) {\n\n\t\tprev = ear.prev;\n\t\tnext = ear.next;\n\n\t\tif ( invSize ? isEarHashed( ear, minX, minY, invSize ) : isEar( ear ) ) {\n\n\t\t\t// cut off the triangle\n\t\t\ttriangles.push( prev.i / dim | 0 );\n\t\t\ttriangles.push( ear.i / dim | 0 );\n\t\t\ttriangles.push( next.i / dim | 0 );\n\n\t\t\tremoveNode( ear );\n\n\t\t\t// skipping the next vertex leads to less sliver triangles\n\t\t\tear = next.next;\n\t\t\tstop = next.next;\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tear = next;\n\n\t\t// if we looped through the whole remaining polygon and can't find any more ears\n\t\tif ( ear === stop ) {\n\n\t\t\t// try filtering points and slicing again\n\t\t\tif ( ! pass ) {\n\n\t\t\t\tearcutLinked( filterPoints( ear ), triangles, dim, minX, minY, invSize, 1 );\n\n\t\t\t\t// if this didn't work, try curing all small self-intersections locally\n\n\t\t\t} else if ( pass === 1 ) {\n\n\t\t\t\tear = cureLocalIntersections( filterPoints( ear ), triangles, dim );\n\t\t\t\tearcutLinked( ear, triangles, dim, minX, minY, invSize, 2 );\n\n\t\t\t\t// as a last resort, try splitting the remaining polygon into two\n\n\t\t\t} else if ( pass === 2 ) {\n\n\t\t\t\tsplitEarcut( ear, triangles, dim, minX, minY, invSize );\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar( ear ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\t// now make sure we don't have other points inside the potential ear\n\tconst ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst x0 = ax < bx ? ( ax < cx ? ax : cx ) : ( bx < cx ? bx : cx ),\n\t\ty0 = ay < by ? ( ay < cy ? ay : cy ) : ( by < cy ? by : cy ),\n\t\tx1 = ax > bx ? ( ax > cx ? ax : cx ) : ( bx > cx ? bx : cx ),\n\t\ty1 = ay > by ? ( ay > cy ? ay : cy ) : ( by > cy ? by : cy );\n\n\tlet p = c.next;\n\twhile ( p !== a ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) &&\n\t\t\tarea( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.next;\n\n\t}\n\n\treturn true;\n\n}\n\nfunction isEarHashed( ear, minX, minY, invSize ) {\n\n\tconst a = ear.prev,\n\t\tb = ear,\n\t\tc = ear.next;\n\n\tif ( area( a, b, c ) >= 0 ) return false; // reflex, can't be an ear\n\n\tconst ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n\t// triangle bbox; min & max are calculated like this for speed\n\tconst x0 = ax < bx ? ( ax < cx ? ax : cx ) : ( bx < cx ? bx : cx ),\n\t\ty0 = ay < by ? ( ay < cy ? ay : cy ) : ( by < cy ? by : cy ),\n\t\tx1 = ax > bx ? ( ax > cx ? ax : cx ) : ( bx > cx ? bx : cx ),\n\t\ty1 = ay > by ? ( ay > cy ? ay : cy ) : ( by > cy ? by : cy );\n\n\t// z-order range for the current triangle bbox;\n\tconst minZ = zOrder( x0, y0, minX, minY, invSize ),\n\t\tmaxZ = zOrder( x1, y1, minX, minY, invSize );\n\n\tlet p = ear.prevZ,\n\t\tn = ear.nextZ;\n\n\t// look for points inside the triangle in both directions\n\twhile ( p && p.z >= minZ && n && n.z <= maxZ ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t\tif ( n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, n.x, n.y ) && area( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\t// look for remaining points in decreasing z-order\n\twhile ( p && p.z >= minZ ) {\n\n\t\tif ( p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, p.x, p.y ) && area( p.prev, p, p.next ) >= 0 ) return false;\n\t\tp = p.prevZ;\n\n\t}\n\n\t// look for remaining points in increasing z-order\n\twhile ( n && n.z <= maxZ ) {\n\n\t\tif ( n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n\t\t\tpointInTriangle( ax, ay, bx, by, cx, cy, n.x, n.y ) && area( n.prev, n, n.next ) >= 0 ) return false;\n\t\tn = n.nextZ;\n\n\t}\n\n\treturn true;\n\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections( start, triangles, dim ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tconst a = p.prev,\n\t\t\tb = p.next.next;\n\n\t\tif ( ! equals$1( a, b ) && intersects( a, p, p.next, b ) && locallyInside( a, b ) && locallyInside( b, a ) ) {\n\n\t\t\ttriangles.push( a.i / dim | 0 );\n\t\t\ttriangles.push( p.i / dim | 0 );\n\t\t\ttriangles.push( b.i / dim | 0 );\n\n\t\t\t// remove two nodes involved\n\t\t\tremoveNode( p );\n\t\t\tremoveNode( p.next );\n\n\t\t\tp = start = b;\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn filterPoints( p );\n\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut( start, triangles, dim, minX, minY, invSize ) {\n\n\t// look for a valid diagonal that divides the polygon into two\n\tlet a = start;\n\tdo {\n\n\t\tlet b = a.next.next;\n\t\twhile ( b !== a.prev ) {\n\n\t\t\tif ( a.i !== b.i && isValidDiagonal( a, b ) ) {\n\n\t\t\t\t// split the polygon in two by the diagonal\n\t\t\t\tlet c = splitPolygon( a, b );\n\n\t\t\t\t// filter colinear points around the cuts\n\t\t\t\ta = filterPoints( a, a.next );\n\t\t\t\tc = filterPoints( c, c.next );\n\n\t\t\t\t// run earcut on each half\n\t\t\t\tearcutLinked( a, triangles, dim, minX, minY, invSize, 0 );\n\t\t\t\tearcutLinked( c, triangles, dim, minX, minY, invSize, 0 );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tb = b.next;\n\n\t\t}\n\n\t\ta = a.next;\n\n\t} while ( a !== start );\n\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles( data, holeIndices, outerNode, dim ) {\n\n\tconst queue = [];\n\tlet i, len, start, end, list;\n\n\tfor ( i = 0, len = holeIndices.length; i < len; i ++ ) {\n\n\t\tstart = holeIndices[ i ] * dim;\n\t\tend = i < len - 1 ? holeIndices[ i + 1 ] * dim : data.length;\n\t\tlist = linkedList( data, start, end, dim, false );\n\t\tif ( list === list.next ) list.steiner = true;\n\t\tqueue.push( getLeftmost( list ) );\n\n\t}\n\n\tqueue.sort( compareX );\n\n\t// process holes from left to right\n\tfor ( i = 0; i < queue.length; i ++ ) {\n\n\t\touterNode = eliminateHole( queue[ i ], outerNode );\n\n\t}\n\n\treturn outerNode;\n\n}\n\nfunction compareX( a, b ) {\n\n\treturn a.x - b.x;\n\n}\n\n// find a bridge between vertices that connects hole with an outer ring and link it\nfunction eliminateHole( hole, outerNode ) {\n\n\tconst bridge = findHoleBridge( hole, outerNode );\n\tif ( ! bridge ) {\n\n\t\treturn outerNode;\n\n\t}\n\n\tconst bridgeReverse = splitPolygon( bridge, hole );\n\n\t// filter collinear points around the cuts\n\tfilterPoints( bridgeReverse, bridgeReverse.next );\n\treturn filterPoints( bridge, bridge.next );\n\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge( hole, outerNode ) {\n\n\tlet p = outerNode,\n\t\tqx = - Infinity,\n\t\tm;\n\n\tconst hx = hole.x, hy = hole.y;\n\n\t// find a segment intersected by a ray from the hole's leftmost point to the left;\n\t// segment's endpoint with lesser x will be potential connection point\n\tdo {\n\n\t\tif ( hy <= p.y && hy >= p.next.y && p.next.y !== p.y ) {\n\n\t\t\tconst x = p.x + ( hy - p.y ) * ( p.next.x - p.x ) / ( p.next.y - p.y );\n\t\t\tif ( x <= hx && x > qx ) {\n\n\t\t\t\tqx = x;\n\t\t\t\tm = p.x < p.next.x ? p : p.next;\n\t\t\t\tif ( x === hx ) return m; // hole touches outer segment; pick leftmost endpoint\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== outerNode );\n\n\tif ( ! m ) return null;\n\n\t// look for points inside the triangle of hole point, segment intersection and endpoint;\n\t// if there are no points found, we have a valid connection;\n\t// otherwise choose the point of the minimum angle with the ray as connection point\n\n\tconst stop = m,\n\t\tmx = m.x,\n\t\tmy = m.y;\n\tlet tanMin = Infinity, tan;\n\n\tp = m;\n\n\tdo {\n\n\t\tif ( hx >= p.x && p.x >= mx && hx !== p.x &&\n\t\t\t\tpointInTriangle( hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y ) ) {\n\n\t\t\ttan = Math.abs( hy - p.y ) / ( hx - p.x ); // tangential\n\n\t\t\tif ( locallyInside( p, hole ) && ( tan < tanMin || ( tan === tanMin && ( p.x > m.x || ( p.x === m.x && sectorContainsSector( m, p ) ) ) ) ) ) {\n\n\t\t\t\tm = p;\n\t\t\t\ttanMin = tan;\n\n\t\t\t}\n\n\t\t}\n\n\t\tp = p.next;\n\n\t} while ( p !== stop );\n\n\treturn m;\n\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector( m, p ) {\n\n\treturn area( m.prev, m, p.prev ) < 0 && area( p.next, m, m.next ) < 0;\n\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve( start, minX, minY, invSize ) {\n\n\tlet p = start;\n\tdo {\n\n\t\tif ( p.z === 0 ) p.z = zOrder( p.x, p.y, minX, minY, invSize );\n\t\tp.prevZ = p.prev;\n\t\tp.nextZ = p.next;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\tp.prevZ.nextZ = null;\n\tp.prevZ = null;\n\n\tsortLinked( p );\n\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked( list ) {\n\n\tlet i, p, q, e, tail, numMerges, pSize, qSize,\n\t\tinSize = 1;\n\n\tdo {\n\n\t\tp = list;\n\t\tlist = null;\n\t\ttail = null;\n\t\tnumMerges = 0;\n\n\t\twhile ( p ) {\n\n\t\t\tnumMerges ++;\n\t\t\tq = p;\n\t\t\tpSize = 0;\n\t\t\tfor ( i = 0; i < inSize; i ++ ) {\n\n\t\t\t\tpSize ++;\n\t\t\t\tq = q.nextZ;\n\t\t\t\tif ( ! q ) break;\n\n\t\t\t}\n\n\t\t\tqSize = inSize;\n\n\t\t\twhile ( pSize > 0 || ( qSize > 0 && q ) ) {\n\n\t\t\t\tif ( pSize !== 0 && ( qSize === 0 || ! q || p.z <= q.z ) ) {\n\n\t\t\t\t\te = p;\n\t\t\t\t\tp = p.nextZ;\n\t\t\t\t\tpSize --;\n\n\t\t\t\t} else {\n\n\t\t\t\t\te = q;\n\t\t\t\t\tq = q.nextZ;\n\t\t\t\t\tqSize --;\n\n\t\t\t\t}\n\n\t\t\t\tif ( tail ) tail.nextZ = e;\n\t\t\t\telse list = e;\n\n\t\t\t\te.prevZ = tail;\n\t\t\t\ttail = e;\n\n\t\t\t}\n\n\t\t\tp = q;\n\n\t\t}\n\n\t\ttail.nextZ = null;\n\t\tinSize *= 2;\n\n\t} while ( numMerges > 1 );\n\n\treturn list;\n\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder( x, y, minX, minY, invSize ) {\n\n\t// coords are transformed into non-negative 15-bit integer range\n\tx = ( x - minX ) * invSize | 0;\n\ty = ( y - minY ) * invSize | 0;\n\n\tx = ( x | ( x << 8 ) ) & 0x00FF00FF;\n\tx = ( x | ( x << 4 ) ) & 0x0F0F0F0F;\n\tx = ( x | ( x << 2 ) ) & 0x33333333;\n\tx = ( x | ( x << 1 ) ) & 0x55555555;\n\n\ty = ( y | ( y << 8 ) ) & 0x00FF00FF;\n\ty = ( y | ( y << 4 ) ) & 0x0F0F0F0F;\n\ty = ( y | ( y << 2 ) ) & 0x33333333;\n\ty = ( y | ( y << 1 ) ) & 0x55555555;\n\n\treturn x | ( y << 1 );\n\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost( start ) {\n\n\tlet p = start,\n\t\tleftmost = start;\n\tdo {\n\n\t\tif ( p.x < leftmost.x || ( p.x === leftmost.x && p.y < leftmost.y ) ) leftmost = p;\n\t\tp = p.next;\n\n\t} while ( p !== start );\n\n\treturn leftmost;\n\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle( ax, ay, bx, by, cx, cy, px, py ) {\n\n\treturn ( cx - px ) * ( ay - py ) >= ( ax - px ) * ( cy - py ) &&\n           ( ax - px ) * ( by - py ) >= ( bx - px ) * ( ay - py ) &&\n           ( bx - px ) * ( cy - py ) >= ( cx - px ) * ( by - py );\n\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal( a, b ) {\n\n\treturn a.next.i !== b.i && a.prev.i !== b.i && ! intersectsPolygon( a, b ) && // dones't intersect other edges\n           ( locallyInside( a, b ) && locallyInside( b, a ) && middleInside( a, b ) && // locally visible\n            ( area( a.prev, a, b.prev ) || area( a, b.prev, b ) ) || // does not create opposite-facing sectors\n            equals$1( a, b ) && area( a.prev, a, a.next ) > 0 && area( b.prev, b, b.next ) > 0 ); // special zero-length case\n\n}\n\n// signed area of a triangle\nfunction area( p, q, r ) {\n\n\treturn ( q.y - p.y ) * ( r.x - q.x ) - ( q.x - p.x ) * ( r.y - q.y );\n\n}\n\n// check if two points are equal\nfunction equals$1( p1, p2 ) {\n\n\treturn p1.x === p2.x && p1.y === p2.y;\n\n}\n\n// check if two segments intersect\nfunction intersects( p1, q1, p2, q2 ) {\n\n\tconst o1 = sign$1( area( p1, q1, p2 ) );\n\tconst o2 = sign$1( area( p1, q1, q2 ) );\n\tconst o3 = sign$1( area( p2, q2, p1 ) );\n\tconst o4 = sign$1( area( p2, q2, q1 ) );\n\n\tif ( o1 !== o2 && o3 !== o4 ) return true; // general case\n\n\tif ( o1 === 0 && onSegment( p1, p2, q1 ) ) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n\tif ( o2 === 0 && onSegment( p1, q2, q1 ) ) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n\tif ( o3 === 0 && onSegment( p2, p1, q2 ) ) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n\tif ( o4 === 0 && onSegment( p2, q1, q2 ) ) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n\treturn false;\n\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment( p, q, r ) {\n\n\treturn q.x <= Math.max( p.x, r.x ) && q.x >= Math.min( p.x, r.x ) && q.y <= Math.max( p.y, r.y ) && q.y >= Math.min( p.y, r.y );\n\n}\n\nfunction sign$1( num ) {\n\n\treturn num > 0 ? 1 : num < 0 ? - 1 : 0;\n\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon( a, b ) {\n\n\tlet p = a;\n\tdo {\n\n\t\tif ( p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n\t\t\tintersects( p, p.next, a, b ) ) return true;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn false;\n\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside( a, b ) {\n\n\treturn area( a.prev, a, a.next ) < 0 ?\n\t\tarea( a, b, a.next ) >= 0 && area( a, a.prev, b ) >= 0 :\n\t\tarea( a, b, a.prev ) < 0 || area( a, a.next, b ) < 0;\n\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside( a, b ) {\n\n\tlet p = a,\n\t\tinside = false;\n\tconst px = ( a.x + b.x ) / 2,\n\t\tpy = ( a.y + b.y ) / 2;\n\tdo {\n\n\t\tif ( ( ( p.y > py ) !== ( p.next.y > py ) ) && p.next.y !== p.y &&\n\t\t\t( px < ( p.next.x - p.x ) * ( py - p.y ) / ( p.next.y - p.y ) + p.x ) )\n\t\t\tinside = ! inside;\n\t\tp = p.next;\n\n\t} while ( p !== a );\n\n\treturn inside;\n\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon( a, b ) {\n\n\tconst a2 = new Node$1( a.i, a.x, a.y ),\n\t\tb2 = new Node$1( b.i, b.x, b.y ),\n\t\tan = a.next,\n\t\tbp = b.prev;\n\n\ta.next = b;\n\tb.prev = a;\n\n\ta2.next = an;\n\tan.prev = a2;\n\n\tb2.next = a2;\n\ta2.prev = b2;\n\n\tbp.next = b2;\n\tb2.prev = bp;\n\n\treturn b2;\n\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode( i, x, y, last ) {\n\n\tconst p = new Node$1( i, x, y );\n\n\tif ( ! last ) {\n\n\t\tp.prev = p;\n\t\tp.next = p;\n\n\t} else {\n\n\t\tp.next = last.next;\n\t\tp.prev = last;\n\t\tlast.next.prev = p;\n\t\tlast.next = p;\n\n\t}\n\n\treturn p;\n\n}\n\nfunction removeNode( p ) {\n\n\tp.next.prev = p.prev;\n\tp.prev.next = p.next;\n\n\tif ( p.prevZ ) p.prevZ.nextZ = p.nextZ;\n\tif ( p.nextZ ) p.nextZ.prevZ = p.prevZ;\n\n}\n\nfunction Node$1( i, x, y ) {\n\n\t// vertex index in coordinates array\n\tthis.i = i;\n\n\t// vertex coordinates\n\tthis.x = x;\n\tthis.y = y;\n\n\t// previous and next vertex nodes in a polygon ring\n\tthis.prev = null;\n\tthis.next = null;\n\n\t// z-order curve value\n\tthis.z = 0;\n\n\t// previous and next nodes in z-order\n\tthis.prevZ = null;\n\tthis.nextZ = null;\n\n\t// indicates whether this is a steiner point\n\tthis.steiner = false;\n\n}\n\nfunction signedArea( data, start, end, dim ) {\n\n\tlet sum = 0;\n\tfor ( let i = start, j = end - dim; i < end; i += dim ) {\n\n\t\tsum += ( data[ j ] - data[ i ] ) * ( data[ i + 1 ] + data[ j + 1 ] );\n\t\tj = i;\n\n\t}\n\n\treturn sum;\n\n}\n\nclass ShapeUtils {\n\n\t// calculate area of the contour polygon\n\n\tstatic area( contour ) {\n\n\t\tconst n = contour.length;\n\t\tlet a = 0.0;\n\n\t\tfor ( let p = n - 1, q = 0; q < n; p = q ++ ) {\n\n\t\t\ta += contour[ p ].x * contour[ q ].y - contour[ q ].x * contour[ p ].y;\n\n\t\t}\n\n\t\treturn a * 0.5;\n\n\t}\n\n\tstatic isClockWise( pts ) {\n\n\t\treturn ShapeUtils.area( pts ) < 0;\n\n\t}\n\n\tstatic triangulateShape( contour, holes ) {\n\n\t\tconst vertices = []; // flat array of vertices like [ x0,y0, x1,y1, x2,y2, ... ]\n\t\tconst holeIndices = []; // array of hole indices\n\t\tconst faces = []; // final array of vertex indices like [ [ a,b,d ], [ b,c,d ] ]\n\n\t\tremoveDupEndPts( contour );\n\t\taddContour( vertices, contour );\n\n\t\t//\n\n\t\tlet holeIndex = contour.length;\n\n\t\tholes.forEach( removeDupEndPts );\n\n\t\tfor ( let i = 0; i < holes.length; i ++ ) {\n\n\t\t\tholeIndices.push( holeIndex );\n\t\t\tholeIndex += holes[ i ].length;\n\t\t\taddContour( vertices, holes[ i ] );\n\n\t\t}\n\n\t\t//\n\n\t\tconst triangles = Earcut.triangulate( vertices, holeIndices );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < triangles.length; i += 3 ) {\n\n\t\t\tfaces.push( triangles.slice( i, i + 3 ) );\n\n\t\t}\n\n\t\treturn faces;\n\n\t}\n\n}\n\nfunction removeDupEndPts( points ) {\n\n\tconst l = points.length;\n\n\tif ( l > 2 && points[ l - 1 ].equals( points[ 0 ] ) ) {\n\n\t\tpoints.pop();\n\n\t}\n\n}\n\nfunction addContour( vertices, contour ) {\n\n\tfor ( let i = 0; i < contour.length; i ++ ) {\n\n\t\tvertices.push( contour[ i ].x );\n\t\tvertices.push( contour[ i ].y );\n\n\t}\n\n}\n\n/**\n * Creates extruded geometry from a path shape.\n *\n * parameters = {\n *\n *  curveSegments: <int>, // number of points on the curves\n *  steps: <int>, // number of points for z-side extrusions / used for subdividing segments of extrude spline too\n *  depth: <float>, // Depth to extrude the shape\n *\n *  bevelEnabled: <bool>, // turn on bevel\n *  bevelThickness: <float>, // how deep into the original shape bevel goes\n *  bevelSize: <float>, // how far from shape outline (including bevelOffset) is bevel\n *  bevelOffset: <float>, // how far from shape outline does bevel start\n *  bevelSegments: <int>, // number of bevel layers\n *\n *  extrudePath: <THREE.Curve> // curve to extrude shape along\n *\n *  UVGenerator: <Object> // object that provides UV generator functions\n *\n * }\n */\n\n\nclass ExtrudeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0.5, 0.5 ), new Vector2( - 0.5, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), options = {} ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ExtrudeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\toptions: options\n\t\t};\n\n\t\tshapes = Array.isArray( shapes ) ? shapes : [ shapes ];\n\n\t\tconst scope = this;\n\n\t\tconst verticesArray = [];\n\t\tconst uvArray = [];\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\t\t\taddShape( shape );\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( verticesArray, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvArray, 2 ) );\n\n\t\tthis.computeVertexNormals();\n\n\t\t// functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst placeholder = [];\n\n\t\t\t// options\n\n\t\t\tconst curveSegments = options.curveSegments !== undefined ? options.curveSegments : 12;\n\t\t\tconst steps = options.steps !== undefined ? options.steps : 1;\n\t\t\tconst depth = options.depth !== undefined ? options.depth : 1;\n\n\t\t\tlet bevelEnabled = options.bevelEnabled !== undefined ? options.bevelEnabled : true;\n\t\t\tlet bevelThickness = options.bevelThickness !== undefined ? options.bevelThickness : 0.2;\n\t\t\tlet bevelSize = options.bevelSize !== undefined ? options.bevelSize : bevelThickness - 0.1;\n\t\t\tlet bevelOffset = options.bevelOffset !== undefined ? options.bevelOffset : 0;\n\t\t\tlet bevelSegments = options.bevelSegments !== undefined ? options.bevelSegments : 3;\n\n\t\t\tconst extrudePath = options.extrudePath;\n\n\t\t\tconst uvgen = options.UVGenerator !== undefined ? options.UVGenerator : WorldUVGenerator;\n\n\t\t\t//\n\n\t\t\tlet extrudePts, extrudeByPath = false;\n\t\t\tlet splineTube, binormal, normal, position2;\n\n\t\t\tif ( extrudePath ) {\n\n\t\t\t\textrudePts = extrudePath.getSpacedPoints( steps );\n\n\t\t\t\textrudeByPath = true;\n\t\t\t\tbevelEnabled = false; // bevels not supported for path extrusion\n\n\t\t\t\t// SETUP TNB variables\n\n\t\t\t\t// TODO1 - have a .isClosed in spline?\n\n\t\t\t\tsplineTube = extrudePath.computeFrenetFrames( steps, false );\n\n\t\t\t\t// console.log(splineTube, 'splineTube', splineTube.normals.length, 'steps', steps, 'extrudePts', extrudePts.length);\n\n\t\t\t\tbinormal = new Vector3();\n\t\t\t\tnormal = new Vector3();\n\t\t\t\tposition2 = new Vector3();\n\n\t\t\t}\n\n\t\t\t// Safeguards if bevels are not enabled\n\n\t\t\tif ( ! bevelEnabled ) {\n\n\t\t\t\tbevelSegments = 0;\n\t\t\t\tbevelThickness = 0;\n\t\t\t\tbevelSize = 0;\n\t\t\t\tbevelOffset = 0;\n\n\t\t\t}\n\n\t\t\t// Variables initialization\n\n\t\t\tconst shapePoints = shape.extractPoints( curveSegments );\n\n\t\t\tlet vertices = shapePoints.shape;\n\t\t\tconst holes = shapePoints.holes;\n\n\t\t\tconst reverse = ! ShapeUtils.isClockWise( vertices );\n\n\t\t\tif ( reverse ) {\n\n\t\t\t\tvertices = vertices.reverse();\n\n\t\t\t\t// Maybe we should also check if holes are in the opposite direction, just to be safe ...\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\t\tif ( ShapeUtils.isClockWise( ahole ) ) {\n\n\t\t\t\t\t\tholes[ h ] = ahole.reverse();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( vertices, holes );\n\n\t\t\t/* Vertices */\n\n\t\t\tconst contour = vertices; // vertices has all points but contour has only points of circumference\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\tvertices = vertices.concat( ahole );\n\n\t\t\t}\n\n\n\t\t\tfunction scalePt2( pt, vec, size ) {\n\n\t\t\t\tif ( ! vec ) console.error( 'THREE.ExtrudeGeometry: vec does not exist' );\n\n\t\t\t\treturn pt.clone().addScaledVector( vec, size );\n\n\t\t\t}\n\n\t\t\tconst vlen = vertices.length, flen = faces.length;\n\n\n\t\t\t// Find directions for point movement\n\n\n\t\t\tfunction getBevelVec( inPt, inPrev, inNext ) {\n\n\t\t\t\t// computes for inPt the corresponding point inPt' on a new contour\n\t\t\t\t//   shifted by 1 unit (length of normalized vector) to the left\n\t\t\t\t// if we walk along contour clockwise, this new contour is outside the old one\n\t\t\t\t//\n\t\t\t\t// inPt' is the intersection of the two lines parallel to the two\n\t\t\t\t//  adjacent edges of inPt at a distance of 1 unit on the left side.\n\n\t\t\t\tlet v_trans_x, v_trans_y, shrink_by; // resulting translation vector for inPt\n\n\t\t\t\t// good reading for geometry algorithms (here: line-line intersection)\n\t\t\t\t// http://geomalgorithms.com/a05-_intersect-1.html\n\n\t\t\t\tconst v_prev_x = inPt.x - inPrev.x,\n\t\t\t\t\tv_prev_y = inPt.y - inPrev.y;\n\t\t\t\tconst v_next_x = inNext.x - inPt.x,\n\t\t\t\t\tv_next_y = inNext.y - inPt.y;\n\n\t\t\t\tconst v_prev_lensq = ( v_prev_x * v_prev_x + v_prev_y * v_prev_y );\n\n\t\t\t\t// check for collinear edges\n\t\t\t\tconst collinear0 = ( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\tif ( Math.abs( collinear0 ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not collinear\n\n\t\t\t\t\t// length of vectors for normalizing\n\n\t\t\t\t\tconst v_prev_len = Math.sqrt( v_prev_lensq );\n\t\t\t\t\tconst v_next_len = Math.sqrt( v_next_x * v_next_x + v_next_y * v_next_y );\n\n\t\t\t\t\t// shift adjacent points by unit vectors to the left\n\n\t\t\t\t\tconst ptPrevShift_x = ( inPrev.x - v_prev_y / v_prev_len );\n\t\t\t\t\tconst ptPrevShift_y = ( inPrev.y + v_prev_x / v_prev_len );\n\n\t\t\t\t\tconst ptNextShift_x = ( inNext.x - v_next_y / v_next_len );\n\t\t\t\t\tconst ptNextShift_y = ( inNext.y + v_next_x / v_next_len );\n\n\t\t\t\t\t// scaling factor for v_prev to intersection point\n\n\t\t\t\t\tconst sf = ( ( ptNextShift_x - ptPrevShift_x ) * v_next_y -\n\t\t\t\t\t\t\t( ptNextShift_y - ptPrevShift_y ) * v_next_x ) /\n\t\t\t\t\t\t( v_prev_x * v_next_y - v_prev_y * v_next_x );\n\n\t\t\t\t\t// vector from inPt to intersection point\n\n\t\t\t\t\tv_trans_x = ( ptPrevShift_x + v_prev_x * sf - inPt.x );\n\t\t\t\t\tv_trans_y = ( ptPrevShift_y + v_prev_y * sf - inPt.y );\n\n\t\t\t\t\t// Don't normalize!, otherwise sharp corners become ugly\n\t\t\t\t\t//  but prevent crazy spikes\n\t\t\t\t\tconst v_trans_lensq = ( v_trans_x * v_trans_x + v_trans_y * v_trans_y );\n\t\t\t\t\tif ( v_trans_lensq <= 2 ) {\n\n\t\t\t\t\t\treturn new Vector2( v_trans_x, v_trans_y );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_trans_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// handle special case of collinear edges\n\n\t\t\t\t\tlet direction_eq = false; // assumes: opposite\n\n\t\t\t\t\tif ( v_prev_x > Number.EPSILON ) {\n\n\t\t\t\t\t\tif ( v_next_x > Number.EPSILON ) {\n\n\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( v_prev_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\tif ( v_next_x < - Number.EPSILON ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tif ( Math.sign( v_prev_y ) === Math.sign( v_next_y ) ) {\n\n\t\t\t\t\t\t\t\tdirection_eq = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( direction_eq ) {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight sequence\");\n\t\t\t\t\t\tv_trans_x = - v_prev_y;\n\t\t\t\t\t\tv_trans_y = v_prev_x;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// console.log(\"Warning: lines are a straight spike\");\n\t\t\t\t\t\tv_trans_x = v_prev_x;\n\t\t\t\t\t\tv_trans_y = v_prev_y;\n\t\t\t\t\t\tshrink_by = Math.sqrt( v_prev_lensq / 2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn new Vector2( v_trans_x / shrink_by, v_trans_y / shrink_by );\n\n\t\t\t}\n\n\n\t\t\tconst contourMovements = [];\n\n\t\t\tfor ( let i = 0, il = contour.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t// console.log('i,j,k', i, j , k)\n\n\t\t\t\tcontourMovements[ i ] = getBevelVec( contour[ i ], contour[ j ], contour[ k ] );\n\n\t\t\t}\n\n\t\t\tconst holesMovements = [];\n\t\t\tlet oneHoleMovements, verticesMovements = contourMovements.concat();\n\n\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\tconst ahole = holes[ h ];\n\n\t\t\t\toneHoleMovements = [];\n\n\t\t\t\tfor ( let i = 0, il = ahole.length, j = il - 1, k = i + 1; i < il; i ++, j ++, k ++ ) {\n\n\t\t\t\t\tif ( j === il ) j = 0;\n\t\t\t\t\tif ( k === il ) k = 0;\n\n\t\t\t\t\t//  (j)---(i)---(k)\n\t\t\t\t\toneHoleMovements[ i ] = getBevelVec( ahole[ i ], ahole[ j ], ahole[ k ] );\n\n\t\t\t\t}\n\n\t\t\t\tholesMovements.push( oneHoleMovements );\n\t\t\t\tverticesMovements = verticesMovements.concat( oneHoleMovements );\n\n\t\t\t}\n\n\n\t\t\t// Loop bevelSegments, 1 for the front, 1 for the back\n\n\t\t\tfor ( let b = 0; b < bevelSegments; b ++ ) {\n\n\t\t\t\t//for ( b = bevelSegments; b > 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\n\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tv( vert.x, vert.y, - z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst bs = bevelSize + bevelOffset;\n\n\t\t\t// Back facing vertices\n\n\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\tv( vert.x, vert.y, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ 0 ].y, extrudePts[ 0 ].x );\n\n\t\t\t\t\tnormal.copy( splineTube.normals[ 0 ] ).multiplyScalar( vert.x );\n\t\t\t\t\tbinormal.copy( splineTube.binormals[ 0 ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\tposition2.copy( extrudePts[ 0 ] ).add( normal ).add( binormal );\n\n\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Add stepped vertices...\n\t\t\t// Including front facing vertices\n\n\t\t\tfor ( let s = 1; s <= steps; s ++ ) {\n\n\t\t\t\tfor ( let i = 0; i < vlen; i ++ ) {\n\n\t\t\t\t\tconst vert = bevelEnabled ? scalePt2( vertices[ i ], verticesMovements[ i ], bs ) : vertices[ i ];\n\n\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\tv( vert.x, vert.y, depth / steps * s );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// v( vert.x, vert.y + extrudePts[ s - 1 ].y, extrudePts[ s - 1 ].x );\n\n\t\t\t\t\t\tnormal.copy( splineTube.normals[ s ] ).multiplyScalar( vert.x );\n\t\t\t\t\t\tbinormal.copy( splineTube.binormals[ s ] ).multiplyScalar( vert.y );\n\n\t\t\t\t\t\tposition2.copy( extrudePts[ s ] ).add( normal ).add( binormal );\n\n\t\t\t\t\t\tv( position2.x, position2.y, position2.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\t// Add bevel segments planes\n\n\t\t\t//for ( b = 1; b <= bevelSegments; b ++ ) {\n\t\t\tfor ( let b = bevelSegments - 1; b >= 0; b -- ) {\n\n\t\t\t\tconst t = b / bevelSegments;\n\t\t\t\tconst z = bevelThickness * Math.cos( t * Math.PI / 2 );\n\t\t\t\tconst bs = bevelSize * Math.sin( t * Math.PI / 2 ) + bevelOffset;\n\n\t\t\t\t// contract shape\n\n\t\t\t\tfor ( let i = 0, il = contour.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst vert = scalePt2( contour[ i ], contourMovements[ i ], bs );\n\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t}\n\n\t\t\t\t// expand holes\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\toneHoleMovements = holesMovements[ h ];\n\n\t\t\t\t\tfor ( let i = 0, il = ahole.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tconst vert = scalePt2( ahole[ i ], oneHoleMovements[ i ], bs );\n\n\t\t\t\t\t\tif ( ! extrudeByPath ) {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y, depth + z );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tv( vert.x, vert.y + extrudePts[ steps - 1 ].y, extrudePts[ steps - 1 ].x + z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t/* Faces */\n\n\t\t\t// Top and bottom faces\n\n\t\t\tbuildLidFaces();\n\n\t\t\t// Sides faces\n\n\t\t\tbuildSideFaces();\n\n\n\t\t\t/////  Internal functions\n\n\t\t\tfunction buildLidFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\n\t\t\t\tif ( bevelEnabled ) {\n\n\t\t\t\t\tlet layer = 0; // steps + 1\n\t\t\t\t\tlet offset = vlen * layer;\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ] + offset, face[ 1 ] + offset, face[ 0 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer = steps + bevelSegments * 2;\n\t\t\t\t\toffset = vlen * layer;\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + offset, face[ 1 ] + offset, face[ 2 ] + offset );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Bottom faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 2 ], face[ 1 ], face[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Top faces\n\n\t\t\t\t\tfor ( let i = 0; i < flen; i ++ ) {\n\n\t\t\t\t\t\tconst face = faces[ i ];\n\t\t\t\t\t\tf3( face[ 0 ] + vlen * steps, face[ 1 ] + vlen * steps, face[ 2 ] + vlen * steps );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 0 );\n\n\t\t\t}\n\n\t\t\t// Create faces for the z-sides of the shape\n\n\t\t\tfunction buildSideFaces() {\n\n\t\t\t\tconst start = verticesArray.length / 3;\n\t\t\t\tlet layeroffset = 0;\n\t\t\t\tsidewalls( contour, layeroffset );\n\t\t\t\tlayeroffset += contour.length;\n\n\t\t\t\tfor ( let h = 0, hl = holes.length; h < hl; h ++ ) {\n\n\t\t\t\t\tconst ahole = holes[ h ];\n\t\t\t\t\tsidewalls( ahole, layeroffset );\n\n\t\t\t\t\t//, true\n\t\t\t\t\tlayeroffset += ahole.length;\n\n\t\t\t\t}\n\n\n\t\t\t\tscope.addGroup( start, verticesArray.length / 3 - start, 1 );\n\n\n\t\t\t}\n\n\t\t\tfunction sidewalls( contour, layeroffset ) {\n\n\t\t\t\tlet i = contour.length;\n\n\t\t\t\twhile ( -- i >= 0 ) {\n\n\t\t\t\t\tconst j = i;\n\t\t\t\t\tlet k = i - 1;\n\t\t\t\t\tif ( k < 0 ) k = contour.length - 1;\n\n\t\t\t\t\t//console.log('b', i,j, i-1, k,vertices.length);\n\n\t\t\t\t\tfor ( let s = 0, sl = ( steps + bevelSegments * 2 ); s < sl; s ++ ) {\n\n\t\t\t\t\t\tconst slen1 = vlen * s;\n\t\t\t\t\t\tconst slen2 = vlen * ( s + 1 );\n\n\t\t\t\t\t\tconst a = layeroffset + j + slen1,\n\t\t\t\t\t\t\tb = layeroffset + k + slen1,\n\t\t\t\t\t\t\tc = layeroffset + k + slen2,\n\t\t\t\t\t\t\td = layeroffset + j + slen2;\n\n\t\t\t\t\t\tf4( a, b, c, d );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfunction v( x, y, z ) {\n\n\t\t\t\tplaceholder.push( x );\n\t\t\t\tplaceholder.push( y );\n\t\t\t\tplaceholder.push( z );\n\n\t\t\t}\n\n\n\t\t\tfunction f3( a, b, c ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateTopUV( scope, verticesArray, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\n\t\t\t}\n\n\t\t\tfunction f4( a, b, c, d ) {\n\n\t\t\t\taddVertex( a );\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( d );\n\n\t\t\t\taddVertex( b );\n\t\t\t\taddVertex( c );\n\t\t\t\taddVertex( d );\n\n\n\t\t\t\tconst nextIndex = verticesArray.length / 3;\n\t\t\t\tconst uvs = uvgen.generateSideWallUV( scope, verticesArray, nextIndex - 6, nextIndex - 3, nextIndex - 2, nextIndex - 1 );\n\n\t\t\t\taddUV( uvs[ 0 ] );\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t\taddUV( uvs[ 1 ] );\n\t\t\t\taddUV( uvs[ 2 ] );\n\t\t\t\taddUV( uvs[ 3 ] );\n\n\t\t\t}\n\n\t\t\tfunction addVertex( index ) {\n\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 0 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 1 ] );\n\t\t\t\tverticesArray.push( placeholder[ index * 3 + 2 ] );\n\n\t\t\t}\n\n\n\t\t\tfunction addUV( vector2 ) {\n\n\t\t\t\tuvArray.push( vector2.x );\n\t\t\t\tuvArray.push( vector2.y );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\t\tconst options = this.parameters.options;\n\n\t\treturn toJSON$1( shapes, options, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\tconst extrudePath = data.options.extrudePath;\n\n\t\tif ( extrudePath !== undefined ) {\n\n\t\t\tdata.options.extrudePath = new Curves[ extrudePath.type ]().fromJSON( extrudePath );\n\n\t\t}\n\n\t\treturn new ExtrudeGeometry( geometryShapes, data.options );\n\n\t}\n\n}\n\nconst WorldUVGenerator = {\n\n\tgenerateTopUV: function ( geometry, vertices, indexA, indexB, indexC ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\n\t\treturn [\n\t\t\tnew Vector2( a_x, a_y ),\n\t\t\tnew Vector2( b_x, b_y ),\n\t\t\tnew Vector2( c_x, c_y )\n\t\t];\n\n\t},\n\n\tgenerateSideWallUV: function ( geometry, vertices, indexA, indexB, indexC, indexD ) {\n\n\t\tconst a_x = vertices[ indexA * 3 ];\n\t\tconst a_y = vertices[ indexA * 3 + 1 ];\n\t\tconst a_z = vertices[ indexA * 3 + 2 ];\n\t\tconst b_x = vertices[ indexB * 3 ];\n\t\tconst b_y = vertices[ indexB * 3 + 1 ];\n\t\tconst b_z = vertices[ indexB * 3 + 2 ];\n\t\tconst c_x = vertices[ indexC * 3 ];\n\t\tconst c_y = vertices[ indexC * 3 + 1 ];\n\t\tconst c_z = vertices[ indexC * 3 + 2 ];\n\t\tconst d_x = vertices[ indexD * 3 ];\n\t\tconst d_y = vertices[ indexD * 3 + 1 ];\n\t\tconst d_z = vertices[ indexD * 3 + 2 ];\n\n\t\tif ( Math.abs( a_y - b_y ) < Math.abs( a_x - b_x ) ) {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_x, 1 - a_z ),\n\t\t\t\tnew Vector2( b_x, 1 - b_z ),\n\t\t\t\tnew Vector2( c_x, 1 - c_z ),\n\t\t\t\tnew Vector2( d_x, 1 - d_z )\n\t\t\t];\n\n\t\t} else {\n\n\t\t\treturn [\n\t\t\t\tnew Vector2( a_y, 1 - a_z ),\n\t\t\t\tnew Vector2( b_y, 1 - b_z ),\n\t\t\t\tnew Vector2( c_y, 1 - c_z ),\n\t\t\t\tnew Vector2( d_y, 1 - d_z )\n\t\t\t];\n\n\t\t}\n\n\t}\n\n};\n\nfunction toJSON$1( shapes, options, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\tdata.options = Object.assign( {}, options );\n\n\tif ( options.extrudePath !== undefined ) data.options.extrudePath = options.extrudePath.toJSON();\n\n\treturn data;\n\n}\n\nclass IcosahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst t = ( 1 + Math.sqrt( 5 ) ) / 2;\n\n\t\tconst vertices = [\n\t\t\t- 1, t, 0, \t1, t, 0, \t- 1, - t, 0, \t1, - t, 0,\n\t\t\t0, - 1, t, \t0, 1, t,\t0, - 1, - t, \t0, 1, - t,\n\t\t\tt, 0, - 1, \tt, 0, 1, \t- t, 0, - 1, \t- t, 0, 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 11, 5, \t0, 5, 1, \t0, 1, 7, \t0, 7, 10, \t0, 10, 11,\n\t\t\t1, 5, 9, \t5, 11, 4,\t11, 10, 2,\t10, 7, 6,\t7, 1, 8,\n\t\t\t3, 9, 4, \t3, 4, 2,\t3, 2, 6,\t3, 6, 8,\t3, 8, 9,\n\t\t\t4, 9, 5, \t2, 4, 11,\t6, 2, 10,\t8, 6, 7,\t9, 8, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'IcosahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new IcosahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass OctahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 0, 0, \t- 1, 0, 0,\t0, 1, 0,\n\t\t\t0, - 1, 0, \t0, 0, 1,\t0, 0, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t0, 2, 4,\t0, 4, 3,\t0, 3, 5,\n\t\t\t0, 5, 2,\t1, 2, 5,\t1, 5, 3,\n\t\t\t1, 3, 4,\t1, 4, 2\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'OctahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new OctahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass PlaneGeometry extends BufferGeometry {\n\n\tconstructor( width = 1, height = 1, widthSegments = 1, heightSegments = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'PlaneGeometry';\n\n\t\tthis.parameters = {\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments\n\t\t};\n\n\t\tconst width_half = width / 2;\n\t\tconst height_half = height / 2;\n\n\t\tconst gridX = Math.floor( widthSegments );\n\t\tconst gridY = Math.floor( heightSegments );\n\n\t\tconst gridX1 = gridX + 1;\n\t\tconst gridY1 = gridY + 1;\n\n\t\tconst segment_width = width / gridX;\n\t\tconst segment_height = height / gridY;\n\n\t\t//\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\tfor ( let iy = 0; iy < gridY1; iy ++ ) {\n\n\t\t\tconst y = iy * segment_height - height_half;\n\n\t\t\tfor ( let ix = 0; ix < gridX1; ix ++ ) {\n\n\t\t\t\tconst x = ix * segment_width - width_half;\n\n\t\t\t\tvertices.push( x, - y, 0 );\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\tuvs.push( ix / gridX );\n\t\t\t\tuvs.push( 1 - ( iy / gridY ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let iy = 0; iy < gridY; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < gridX; ix ++ ) {\n\n\t\t\t\tconst a = ix + gridX1 * iy;\n\t\t\t\tconst b = ix + gridX1 * ( iy + 1 );\n\t\t\t\tconst c = ( ix + 1 ) + gridX1 * ( iy + 1 );\n\t\t\t\tconst d = ( ix + 1 ) + gridX1 * iy;\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new PlaneGeometry( data.width, data.height, data.widthSegments, data.heightSegments );\n\n\t}\n\n}\n\nclass RingGeometry extends BufferGeometry {\n\n\tconstructor( innerRadius = 0.5, outerRadius = 1, thetaSegments = 32, phiSegments = 1, thetaStart = 0, thetaLength = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'RingGeometry';\n\n\t\tthis.parameters = {\n\t\t\tinnerRadius: innerRadius,\n\t\t\touterRadius: outerRadius,\n\t\t\tthetaSegments: thetaSegments,\n\t\t\tphiSegments: phiSegments,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\tthetaSegments = Math.max( 3, thetaSegments );\n\t\tphiSegments = Math.max( 1, phiSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// some helper variables\n\n\t\tlet radius = innerRadius;\n\t\tconst radiusStep = ( ( outerRadius - innerRadius ) / phiSegments );\n\t\tconst vertex = new Vector3();\n\t\tconst uv = new Vector2();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= phiSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= thetaSegments; i ++ ) {\n\n\t\t\t\t// values are generate from the inside of the ring to the outside\n\n\t\t\t\tconst segment = thetaStart + i / thetaSegments * thetaLength;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = radius * Math.cos( segment );\n\t\t\t\tvertex.y = radius * Math.sin( segment );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormals.push( 0, 0, 1 );\n\n\t\t\t\t// uv\n\n\t\t\t\tuv.x = ( vertex.x / outerRadius + 1 ) / 2;\n\t\t\t\tuv.y = ( vertex.y / outerRadius + 1 ) / 2;\n\n\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t}\n\n\t\t\t// increase the radius for next row of vertices\n\n\t\t\tradius += radiusStep;\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let j = 0; j < phiSegments; j ++ ) {\n\n\t\t\tconst thetaSegmentLevel = j * ( thetaSegments + 1 );\n\n\t\t\tfor ( let i = 0; i < thetaSegments; i ++ ) {\n\n\t\t\t\tconst segment = i + thetaSegmentLevel;\n\n\t\t\t\tconst a = segment;\n\t\t\t\tconst b = segment + thetaSegments + 1;\n\t\t\t\tconst c = segment + thetaSegments + 2;\n\t\t\t\tconst d = segment + 1;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new RingGeometry( data.innerRadius, data.outerRadius, data.thetaSegments, data.phiSegments, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass ShapeGeometry extends BufferGeometry {\n\n\tconstructor( shapes = new Shape( [ new Vector2( 0, 0.5 ), new Vector2( - 0.5, - 0.5 ), new Vector2( 0.5, - 0.5 ) ] ), curveSegments = 12 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ShapeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tshapes: shapes,\n\t\t\tcurveSegments: curveSegments\n\t\t};\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tlet groupStart = 0;\n\t\tlet groupCount = 0;\n\n\t\t// allow single and array values for \"shapes\" parameter\n\n\t\tif ( Array.isArray( shapes ) === false ) {\n\n\t\t\taddShape( shapes );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < shapes.length; i ++ ) {\n\n\t\t\t\taddShape( shapes[ i ] );\n\n\t\t\t\tthis.addGroup( groupStart, groupCount, i ); // enables MultiMaterial support\n\n\t\t\t\tgroupStart += groupCount;\n\t\t\t\tgroupCount = 0;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\n\t\t// helper functions\n\n\t\tfunction addShape( shape ) {\n\n\t\t\tconst indexOffset = vertices.length / 3;\n\t\t\tconst points = shape.extractPoints( curveSegments );\n\n\t\t\tlet shapeVertices = points.shape;\n\t\t\tconst shapeHoles = points.holes;\n\n\t\t\t// check direction of vertices\n\n\t\t\tif ( ShapeUtils.isClockWise( shapeVertices ) === false ) {\n\n\t\t\t\tshapeVertices = shapeVertices.reverse();\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\n\t\t\t\tif ( ShapeUtils.isClockWise( shapeHole ) === true ) {\n\n\t\t\t\t\tshapeHoles[ i ] = shapeHole.reverse();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst faces = ShapeUtils.triangulateShape( shapeVertices, shapeHoles );\n\n\t\t\t// join vertices of inner and outer paths to a single array\n\n\t\t\tfor ( let i = 0, l = shapeHoles.length; i < l; i ++ ) {\n\n\t\t\t\tconst shapeHole = shapeHoles[ i ];\n\t\t\t\tshapeVertices = shapeVertices.concat( shapeHole );\n\n\t\t\t}\n\n\t\t\t// vertices, normals, uvs\n\n\t\t\tfor ( let i = 0, l = shapeVertices.length; i < l; i ++ ) {\n\n\t\t\t\tconst vertex = shapeVertices[ i ];\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, 0 );\n\t\t\t\tnormals.push( 0, 0, 1 );\n\t\t\t\tuvs.push( vertex.x, vertex.y ); // world uvs\n\n\t\t\t}\n\n\t\t\t// indices\n\n\t\t\tfor ( let i = 0, l = faces.length; i < l; i ++ ) {\n\n\t\t\t\tconst face = faces[ i ];\n\n\t\t\t\tconst a = face[ 0 ] + indexOffset;\n\t\t\t\tconst b = face[ 1 ] + indexOffset;\n\t\t\t\tconst c = face[ 2 ] + indexOffset;\n\n\t\t\t\tindices.push( a, b, c );\n\t\t\t\tgroupCount += 3;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tconst shapes = this.parameters.shapes;\n\n\t\treturn toJSON( shapes, data );\n\n\t}\n\n\tstatic fromJSON( data, shapes ) {\n\n\t\tconst geometryShapes = [];\n\n\t\tfor ( let j = 0, jl = data.shapes.length; j < jl; j ++ ) {\n\n\t\t\tconst shape = shapes[ data.shapes[ j ] ];\n\n\t\t\tgeometryShapes.push( shape );\n\n\t\t}\n\n\t\treturn new ShapeGeometry( geometryShapes, data.curveSegments );\n\n\t}\n\n}\n\nfunction toJSON( shapes, data ) {\n\n\tdata.shapes = [];\n\n\tif ( Array.isArray( shapes ) ) {\n\n\t\tfor ( let i = 0, l = shapes.length; i < l; i ++ ) {\n\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\tdata.shapes.push( shape.uuid );\n\n\t\t}\n\n\t} else {\n\n\t\tdata.shapes.push( shapes.uuid );\n\n\t}\n\n\treturn data;\n\n}\n\nclass SphereGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, widthSegments = 32, heightSegments = 16, phiStart = 0, phiLength = Math.PI * 2, thetaStart = 0, thetaLength = Math.PI ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'SphereGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\twidthSegments: widthSegments,\n\t\t\theightSegments: heightSegments,\n\t\t\tphiStart: phiStart,\n\t\t\tphiLength: phiLength,\n\t\t\tthetaStart: thetaStart,\n\t\t\tthetaLength: thetaLength\n\t\t};\n\n\t\twidthSegments = Math.max( 3, Math.floor( widthSegments ) );\n\t\theightSegments = Math.max( 2, Math.floor( heightSegments ) );\n\n\t\tconst thetaEnd = Math.min( thetaStart + thetaLength, Math.PI );\n\n\t\tlet index = 0;\n\t\tconst grid = [];\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let iy = 0; iy <= heightSegments; iy ++ ) {\n\n\t\t\tconst verticesRow = [];\n\n\t\t\tconst v = iy / heightSegments;\n\n\t\t\t// special case for the poles\n\n\t\t\tlet uOffset = 0;\n\n\t\t\tif ( iy === 0 && thetaStart === 0 ) {\n\n\t\t\t\tuOffset = 0.5 / widthSegments;\n\n\t\t\t} else if ( iy === heightSegments && thetaEnd === Math.PI ) {\n\n\t\t\t\tuOffset = - 0.5 / widthSegments;\n\n\t\t\t}\n\n\t\t\tfor ( let ix = 0; ix <= widthSegments; ix ++ ) {\n\n\t\t\t\tconst u = ix / widthSegments;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = - radius * Math.cos( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\t\t\t\tvertex.y = radius * Math.cos( thetaStart + v * thetaLength );\n\t\t\t\tvertex.z = radius * Math.sin( phiStart + u * phiLength ) * Math.sin( thetaStart + v * thetaLength );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.copy( vertex ).normalize();\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( u + uOffset, 1 - v );\n\n\t\t\t\tverticesRow.push( index ++ );\n\n\t\t\t}\n\n\t\t\tgrid.push( verticesRow );\n\n\t\t}\n\n\t\t// indices\n\n\t\tfor ( let iy = 0; iy < heightSegments; iy ++ ) {\n\n\t\t\tfor ( let ix = 0; ix < widthSegments; ix ++ ) {\n\n\t\t\t\tconst a = grid[ iy ][ ix + 1 ];\n\t\t\t\tconst b = grid[ iy ][ ix ];\n\t\t\t\tconst c = grid[ iy + 1 ][ ix ];\n\t\t\t\tconst d = grid[ iy + 1 ][ ix + 1 ];\n\n\t\t\t\tif ( iy !== 0 || thetaStart > 0 ) indices.push( a, b, d );\n\t\t\t\tif ( iy !== heightSegments - 1 || thetaEnd < Math.PI ) indices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new SphereGeometry( data.radius, data.widthSegments, data.heightSegments, data.phiStart, data.phiLength, data.thetaStart, data.thetaLength );\n\n\t}\n\n}\n\nclass TetrahedronGeometry extends PolyhedronGeometry {\n\n\tconstructor( radius = 1, detail = 0 ) {\n\n\t\tconst vertices = [\n\t\t\t1, 1, 1, \t- 1, - 1, 1, \t- 1, 1, - 1, \t1, - 1, - 1\n\t\t];\n\n\t\tconst indices = [\n\t\t\t2, 1, 0, \t0, 3, 2,\t1, 3, 0,\t2, 3, 1\n\t\t];\n\n\t\tsuper( vertices, indices, radius, detail );\n\n\t\tthis.type = 'TetrahedronGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\tdetail: detail\n\t\t};\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TetrahedronGeometry( data.radius, data.detail );\n\n\t}\n\n}\n\nclass TorusGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, radialSegments = 12, tubularSegments = 48, arc = Math.PI * 2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TorusGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\tradialSegments: radialSegments,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tarc: arc\n\t\t};\n\n\t\tradialSegments = Math.floor( radialSegments );\n\t\ttubularSegments = Math.floor( tubularSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst center = new Vector3();\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tconst u = i / tubularSegments * arc;\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n\t\t\t\tvertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n\t\t\t\tvertex.z = tube * Math.sin( v );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal\n\n\t\t\t\tcenter.x = radius * Math.cos( u );\n\t\t\t\tcenter.y = radius * Math.sin( u );\n\t\t\t\tnormal.subVectors( vertex, center ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= radialSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= tubularSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( tubularSegments + 1 ) * j + i - 1;\n\t\t\t\tconst b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n\t\t\t\tconst c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n\t\t\t\tconst d = ( tubularSegments + 1 ) * j + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusGeometry( data.radius, data.tube, data.radialSegments, data.tubularSegments, data.arc );\n\n\t}\n\n}\n\nclass TorusKnotGeometry extends BufferGeometry {\n\n\tconstructor( radius = 1, tube = 0.4, tubularSegments = 64, radialSegments = 8, p = 2, q = 3 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TorusKnotGeometry';\n\n\t\tthis.parameters = {\n\t\t\tradius: radius,\n\t\t\ttube: tube,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradialSegments: radialSegments,\n\t\t\tp: p,\n\t\t\tq: q\n\t\t};\n\n\t\ttubularSegments = Math.floor( tubularSegments );\n\t\tradialSegments = Math.floor( radialSegments );\n\n\t\t// buffers\n\n\t\tconst indices = [];\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\n\t\tconst P1 = new Vector3();\n\t\tconst P2 = new Vector3();\n\n\t\tconst B = new Vector3();\n\t\tconst T = new Vector3();\n\t\tconst N = new Vector3();\n\n\t\t// generate vertices, normals and uvs\n\n\t\tfor ( let i = 0; i <= tubularSegments; ++ i ) {\n\n\t\t\t// the radian \"u\" is used to calculate the position on the torus curve of the current tubular segment\n\n\t\t\tconst u = i / tubularSegments * p * Math.PI * 2;\n\n\t\t\t// now we calculate two points. P1 is our current position on the curve, P2 is a little farther ahead.\n\t\t\t// these points are used to create a special \"coordinate space\", which is necessary to calculate the correct vertex positions\n\n\t\t\tcalculatePositionOnCurve( u, p, q, radius, P1 );\n\t\t\tcalculatePositionOnCurve( u + 0.01, p, q, radius, P2 );\n\n\t\t\t// calculate orthonormal basis\n\n\t\t\tT.subVectors( P2, P1 );\n\t\t\tN.addVectors( P2, P1 );\n\t\t\tB.crossVectors( T, N );\n\t\t\tN.crossVectors( B, T );\n\n\t\t\t// normalize B, N. T can be ignored, we don't use it\n\n\t\t\tB.normalize();\n\t\t\tN.normalize();\n\n\t\t\tfor ( let j = 0; j <= radialSegments; ++ j ) {\n\n\t\t\t\t// now calculate the vertices. they are nothing more than an extrusion of the torus curve.\n\t\t\t\t// because we extrude a shape in the xy-plane, there is no need to calculate a z-value.\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\t\t\t\tconst cx = - tube * Math.cos( v );\n\t\t\t\tconst cy = tube * Math.sin( v );\n\n\t\t\t\t// now calculate the final vertex position.\n\t\t\t\t// first we orient the extrusion with our basis vectors, then we add it to the current position on the curve\n\n\t\t\t\tvertex.x = P1.x + ( cx * N.x + cy * B.x );\n\t\t\t\tvertex.y = P1.y + ( cx * N.y + cy * B.y );\n\t\t\t\tvertex.z = P1.z + ( cx * N.z + cy * B.z );\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t\t// normal (P1 is always the center/origin of the extrusion, thus we can use it to calculate the normal)\n\n\t\t\t\tnormal.subVectors( vertex, P1 ).normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// uv\n\n\t\t\t\tuvs.push( i / tubularSegments );\n\t\t\t\tuvs.push( j / radialSegments );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// generate indices\n\n\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t// indices\n\n\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t// faces\n\n\t\t\t\tindices.push( a, b, d );\n\t\t\t\tindices.push( b, c, d );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// this function calculates the current position on the torus curve\n\n\t\tfunction calculatePositionOnCurve( u, p, q, radius, position ) {\n\n\t\t\tconst cu = Math.cos( u );\n\t\t\tconst su = Math.sin( u );\n\t\t\tconst quOverP = q / p * u;\n\t\t\tconst cs = Math.cos( quOverP );\n\n\t\t\tposition.x = radius * ( 2 + cs ) * 0.5 * cu;\n\t\t\tposition.y = radius * ( 2 + cs ) * su * 0.5;\n\t\t\tposition.z = radius * Math.sin( quOverP ) * 0.5;\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\treturn new TorusKnotGeometry( data.radius, data.tube, data.tubularSegments, data.radialSegments, data.p, data.q );\n\n\t}\n\n}\n\nclass TubeGeometry extends BufferGeometry {\n\n\tconstructor( path = new QuadraticBezierCurve3( new Vector3( - 1, - 1, 0 ), new Vector3( - 1, 1, 0 ), new Vector3( 1, 1, 0 ) ), tubularSegments = 64, radius = 1, radialSegments = 8, closed = false ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'TubeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tpath: path,\n\t\t\ttubularSegments: tubularSegments,\n\t\t\tradius: radius,\n\t\t\tradialSegments: radialSegments,\n\t\t\tclosed: closed\n\t\t};\n\n\t\tconst frames = path.computeFrenetFrames( tubularSegments, closed );\n\n\t\t// expose internals\n\n\t\tthis.tangents = frames.tangents;\n\t\tthis.normals = frames.normals;\n\t\tthis.binormals = frames.binormals;\n\n\t\t// helper variables\n\n\t\tconst vertex = new Vector3();\n\t\tconst normal = new Vector3();\n\t\tconst uv = new Vector2();\n\t\tlet P = new Vector3();\n\n\t\t// buffer\n\n\t\tconst vertices = [];\n\t\tconst normals = [];\n\t\tconst uvs = [];\n\t\tconst indices = [];\n\n\t\t// create buffer data\n\n\t\tgenerateBufferData();\n\n\t\t// build geometry\n\n\t\tthis.setIndex( indices );\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n\t\t// functions\n\n\t\tfunction generateBufferData() {\n\n\t\t\tfor ( let i = 0; i < tubularSegments; i ++ ) {\n\n\t\t\t\tgenerateSegment( i );\n\n\t\t\t}\n\n\t\t\t// if the geometry is not closed, generate the last row of vertices and normals\n\t\t\t// at the regular position on the given path\n\t\t\t//\n\t\t\t// if the geometry is closed, duplicate the first row of vertices and normals (uvs will differ)\n\n\t\t\tgenerateSegment( ( closed === false ) ? tubularSegments : 0 );\n\n\t\t\t// uvs are generated in a separate function.\n\t\t\t// this makes it easy compute correct values for closed geometries\n\n\t\t\tgenerateUVs();\n\n\t\t\t// finally create faces\n\n\t\t\tgenerateIndices();\n\n\t\t}\n\n\t\tfunction generateSegment( i ) {\n\n\t\t\t// we use getPointAt to sample evenly distributed points from the given path\n\n\t\t\tP = path.getPointAt( i / tubularSegments, P );\n\n\t\t\t// retrieve corresponding normal and binormal\n\n\t\t\tconst N = frames.normals[ i ];\n\t\t\tconst B = frames.binormals[ i ];\n\n\t\t\t// generate normals and vertices for the current segment\n\n\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\tconst v = j / radialSegments * Math.PI * 2;\n\n\t\t\t\tconst sin = Math.sin( v );\n\t\t\t\tconst cos = - Math.cos( v );\n\n\t\t\t\t// normal\n\n\t\t\t\tnormal.x = ( cos * N.x + sin * B.x );\n\t\t\t\tnormal.y = ( cos * N.y + sin * B.y );\n\t\t\t\tnormal.z = ( cos * N.z + sin * B.z );\n\t\t\t\tnormal.normalize();\n\n\t\t\t\tnormals.push( normal.x, normal.y, normal.z );\n\n\t\t\t\t// vertex\n\n\t\t\t\tvertex.x = P.x + radius * normal.x;\n\t\t\t\tvertex.y = P.y + radius * normal.y;\n\t\t\t\tvertex.z = P.z + radius * normal.z;\n\n\t\t\t\tvertices.push( vertex.x, vertex.y, vertex.z );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateIndices() {\n\n\t\t\tfor ( let j = 1; j <= tubularSegments; j ++ ) {\n\n\t\t\t\tfor ( let i = 1; i <= radialSegments; i ++ ) {\n\n\t\t\t\t\tconst a = ( radialSegments + 1 ) * ( j - 1 ) + ( i - 1 );\n\t\t\t\t\tconst b = ( radialSegments + 1 ) * j + ( i - 1 );\n\t\t\t\t\tconst c = ( radialSegments + 1 ) * j + i;\n\t\t\t\t\tconst d = ( radialSegments + 1 ) * ( j - 1 ) + i;\n\n\t\t\t\t\t// faces\n\n\t\t\t\t\tindices.push( a, b, d );\n\t\t\t\t\tindices.push( b, c, d );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction generateUVs() {\n\n\t\t\tfor ( let i = 0; i <= tubularSegments; i ++ ) {\n\n\t\t\t\tfor ( let j = 0; j <= radialSegments; j ++ ) {\n\n\t\t\t\t\tuv.x = i / tubularSegments;\n\t\t\t\t\tuv.y = j / radialSegments;\n\n\t\t\t\t\tuvs.push( uv.x, uv.y );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.path = this.parameters.path.toJSON();\n\n\t\treturn data;\n\n\t}\n\n\tstatic fromJSON( data ) {\n\n\t\t// This only works for built-in curves (e.g. CatmullRomCurve3).\n\t\t// User defined curves or instances of CurvePath will not be deserialized.\n\t\treturn new TubeGeometry(\n\t\t\tnew Curves[ data.path.type ]().fromJSON( data.path ),\n\t\t\tdata.tubularSegments,\n\t\t\tdata.radius,\n\t\t\tdata.radialSegments,\n\t\t\tdata.closed\n\t\t);\n\n\t}\n\n}\n\nclass WireframeGeometry extends BufferGeometry {\n\n\tconstructor( geometry = null ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'WireframeGeometry';\n\n\t\tthis.parameters = {\n\t\t\tgeometry: geometry\n\t\t};\n\n\t\tif ( geometry !== null ) {\n\n\t\t\t// buffer\n\n\t\t\tconst vertices = [];\n\t\t\tconst edges = new Set();\n\n\t\t\t// helper variables\n\n\t\t\tconst start = new Vector3();\n\t\t\tconst end = new Vector3();\n\n\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t// indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\t\t\t\tconst indices = geometry.index;\n\t\t\t\tlet groups = geometry.groups;\n\n\t\t\t\tif ( groups.length === 0 ) {\n\n\t\t\t\t\tgroups = [ { start: 0, count: indices.count, materialIndex: 0 } ];\n\n\t\t\t\t}\n\n\t\t\t\t// create a data structure that contains all edges without duplicates\n\n\t\t\t\tfor ( let o = 0, ol = groups.length; o < ol; ++ o ) {\n\n\t\t\t\t\tconst group = groups[ o ];\n\n\t\t\t\t\tconst groupStart = group.start;\n\t\t\t\t\tconst groupCount = group.count;\n\n\t\t\t\t\tfor ( let i = groupStart, l = ( groupStart + groupCount ); i < l; i += 3 ) {\n\n\t\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t\tconst index1 = indices.getX( i + j );\n\t\t\t\t\t\t\tconst index2 = indices.getX( i + ( j + 1 ) % 3 );\n\n\t\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// non-indexed BufferGeometry\n\n\t\t\t\tconst position = geometry.attributes.position;\n\n\t\t\t\tfor ( let i = 0, l = ( position.count / 3 ); i < l; i ++ ) {\n\n\t\t\t\t\tfor ( let j = 0; j < 3; j ++ ) {\n\n\t\t\t\t\t\t// three edges per triangle, an edge is represented as (index1, index2)\n\t\t\t\t\t\t// e.g. the first triangle has the following edges: (0,1),(1,2),(2,0)\n\n\t\t\t\t\t\tconst index1 = 3 * i + j;\n\t\t\t\t\t\tconst index2 = 3 * i + ( ( j + 1 ) % 3 );\n\n\t\t\t\t\t\tstart.fromBufferAttribute( position, index1 );\n\t\t\t\t\t\tend.fromBufferAttribute( position, index2 );\n\n\t\t\t\t\t\tif ( isUniqueEdge( start, end, edges ) === true ) {\n\n\t\t\t\t\t\t\tvertices.push( start.x, start.y, start.z );\n\t\t\t\t\t\t\tvertices.push( end.x, end.y, end.z );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// build geometry\n\n\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.parameters = Object.assign( {}, source.parameters );\n\n\t\treturn this;\n\n\t}\n\n}\n\nfunction isUniqueEdge( start, end, edges ) {\n\n\tconst hash1 = `${start.x},${start.y},${start.z}-${end.x},${end.y},${end.z}`;\n\tconst hash2 = `${end.x},${end.y},${end.z}-${start.x},${start.y},${start.z}`; // coincident edge\n\n\tif ( edges.has( hash1 ) === true || edges.has( hash2 ) === true ) {\n\n\t\treturn false;\n\n\t} else {\n\n\t\tedges.add( hash1 );\n\t\tedges.add( hash2 );\n\t\treturn true;\n\n\t}\n\n}\n\nvar Geometries$1 = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tBoxGeometry: BoxGeometry,\n\tCapsuleGeometry: CapsuleGeometry,\n\tCircleGeometry: CircleGeometry,\n\tConeGeometry: ConeGeometry,\n\tCylinderGeometry: CylinderGeometry,\n\tDodecahedronGeometry: DodecahedronGeometry,\n\tEdgesGeometry: EdgesGeometry,\n\tExtrudeGeometry: ExtrudeGeometry,\n\tIcosahedronGeometry: IcosahedronGeometry,\n\tLatheGeometry: LatheGeometry,\n\tOctahedronGeometry: OctahedronGeometry,\n\tPlaneGeometry: PlaneGeometry,\n\tPolyhedronGeometry: PolyhedronGeometry,\n\tRingGeometry: RingGeometry,\n\tShapeGeometry: ShapeGeometry,\n\tSphereGeometry: SphereGeometry,\n\tTetrahedronGeometry: TetrahedronGeometry,\n\tTorusGeometry: TorusGeometry,\n\tTorusKnotGeometry: TorusKnotGeometry,\n\tTubeGeometry: TubeGeometry,\n\tWireframeGeometry: WireframeGeometry\n});\n\nclass ShadowMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'ShadowMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShadowMaterial = true;\n\n\t\tthis.color = new Color( 0x000000 );\n\t\tthis.transparent = true;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass RawShaderMaterial extends ShaderMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'RawShaderMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isRawShaderMaterial = true;\n\n\t}\n\n}\n\nclass MeshStandardMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshStandardMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshStandardMaterial = true;\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.roughness = 1.0;\n\t\tthis.metalness = 0.0;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.roughnessMap = null;\n\n\t\tthis.metalnessMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.envMapIntensity = 1.0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'STANDARD': '' };\n\n\t\tthis.color.copy( source.color );\n\t\tthis.roughness = source.roughness;\n\t\tthis.metalness = source.metalness;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.roughnessMap = source.roughnessMap;\n\n\t\tthis.metalnessMap = source.metalnessMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.envMapIntensity = source.envMapIntensity;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshPhysicalMaterial extends MeshStandardMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshPhysicalMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhysicalMaterial = true;\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.anisotropyRotation = 0;\n\t\tthis.anisotropyMap = null;\n\n\t\tthis.clearcoatMap = null;\n\t\tthis.clearcoatRoughness = 0.0;\n\t\tthis.clearcoatRoughnessMap = null;\n\t\tthis.clearcoatNormalScale = new Vector2( 1, 1 );\n\t\tthis.clearcoatNormalMap = null;\n\n\t\tthis.ior = 1.5;\n\n\t\tObject.defineProperty( this, 'reflectivity', {\n\t\t\tget: function () {\n\n\t\t\t\treturn ( clamp$1( 2.5 * ( this.ior - 1 ) / ( this.ior + 1 ), 0, 1 ) );\n\n\t\t\t},\n\t\t\tset: function ( reflectivity ) {\n\n\t\t\t\tthis.ior = ( 1 + 0.4 * reflectivity ) / ( 1 - 0.4 * reflectivity );\n\n\t\t\t}\n\t\t} );\n\n\t\tthis.iridescenceMap = null;\n\t\tthis.iridescenceIOR = 1.3;\n\t\tthis.iridescenceThicknessRange = [ 100, 400 ];\n\t\tthis.iridescenceThicknessMap = null;\n\n\t\tthis.sheenColor = new Color( 0x000000 );\n\t\tthis.sheenColorMap = null;\n\t\tthis.sheenRoughness = 1.0;\n\t\tthis.sheenRoughnessMap = null;\n\n\t\tthis.transmissionMap = null;\n\n\t\tthis.thickness = 0;\n\t\tthis.thicknessMap = null;\n\t\tthis.attenuationDistance = Infinity;\n\t\tthis.attenuationColor = new Color( 1, 1, 1 );\n\n\t\tthis.specularIntensity = 1.0;\n\t\tthis.specularIntensityMap = null;\n\t\tthis.specularColor = new Color( 1, 1, 1 );\n\t\tthis.specularColorMap = null;\n\n\t\tthis._anisotropy = 0;\n\t\tthis._clearcoat = 0;\n\t\tthis._dispersion = 0;\n\t\tthis._iridescence = 0;\n\t\tthis._sheen = 0.0;\n\t\tthis._transmission = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget anisotropy() {\n\n\t\treturn this._anisotropy;\n\n\t}\n\n\tset anisotropy( value ) {\n\n\t\tif ( this._anisotropy > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._anisotropy = value;\n\n\t}\n\n\tget clearcoat() {\n\n\t\treturn this._clearcoat;\n\n\t}\n\n\tset clearcoat( value ) {\n\n\t\tif ( this._clearcoat > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._clearcoat = value;\n\n\t}\n\n\tget iridescence() {\n\n\t\treturn this._iridescence;\n\n\t}\n\n\tset iridescence( value ) {\n\n\t\tif ( this._iridescence > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._iridescence = value;\n\n\t}\n\n\tget dispersion() {\n\n\t\treturn this._dispersion;\n\n\t}\n\n\tset dispersion( value ) {\n\n\t\tif ( this._dispersion > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._dispersion = value;\n\n\t}\n\n\tget sheen() {\n\n\t\treturn this._sheen;\n\n\t}\n\n\tset sheen( value ) {\n\n\t\tif ( this._sheen > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._sheen = value;\n\n\t}\n\n\tget transmission() {\n\n\t\treturn this._transmission;\n\n\t}\n\n\tset transmission( value ) {\n\n\t\tif ( this._transmission > 0 !== value > 0 ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t\tthis._transmission = value;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = {\n\n\t\t\t'STANDARD': '',\n\t\t\t'PHYSICAL': ''\n\n\t\t};\n\n\t\tthis.anisotropy = source.anisotropy;\n\t\tthis.anisotropyRotation = source.anisotropyRotation;\n\t\tthis.anisotropyMap = source.anisotropyMap;\n\n\t\tthis.clearcoat = source.clearcoat;\n\t\tthis.clearcoatMap = source.clearcoatMap;\n\t\tthis.clearcoatRoughness = source.clearcoatRoughness;\n\t\tthis.clearcoatRoughnessMap = source.clearcoatRoughnessMap;\n\t\tthis.clearcoatNormalMap = source.clearcoatNormalMap;\n\t\tthis.clearcoatNormalScale.copy( source.clearcoatNormalScale );\n\n\t\tthis.dispersion = source.dispersion;\n\t\tthis.ior = source.ior;\n\n\t\tthis.iridescence = source.iridescence;\n\t\tthis.iridescenceMap = source.iridescenceMap;\n\t\tthis.iridescenceIOR = source.iridescenceIOR;\n\t\tthis.iridescenceThicknessRange = [ ...source.iridescenceThicknessRange ];\n\t\tthis.iridescenceThicknessMap = source.iridescenceThicknessMap;\n\n\t\tthis.sheen = source.sheen;\n\t\tthis.sheenColor.copy( source.sheenColor );\n\t\tthis.sheenColorMap = source.sheenColorMap;\n\t\tthis.sheenRoughness = source.sheenRoughness;\n\t\tthis.sheenRoughnessMap = source.sheenRoughnessMap;\n\n\t\tthis.transmission = source.transmission;\n\t\tthis.transmissionMap = source.transmissionMap;\n\n\t\tthis.thickness = source.thickness;\n\t\tthis.thicknessMap = source.thicknessMap;\n\t\tthis.attenuationDistance = source.attenuationDistance;\n\t\tthis.attenuationColor.copy( source.attenuationColor );\n\n\t\tthis.specularIntensity = source.specularIntensity;\n\t\tthis.specularIntensityMap = source.specularIntensityMap;\n\t\tthis.specularColor.copy( source.specularColor );\n\t\tthis.specularColorMap = source.specularColorMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshPhongMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshPhongMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhongMaterial = true;\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\t\tthis.specular = new Color( 0x111111 );\n\t\tthis.shininess = 30;\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.specular.copy( source.specular );\n\t\tthis.shininess = source.shininess;\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshToonMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshToonMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshToonMaterial = true;\n\n\t\tthis.defines = { 'TOON': '' };\n\n\t\tthis.color = new Color( 0xffffff );\n\n\t\tthis.map = null;\n\t\tthis.gradientMap = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\t\tthis.gradientMap = source.gradientMap;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshNormalMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshNormalMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshNormalMaterial = true;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshLambertMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshLambertMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshLambertMaterial = true;\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.map = null;\n\n\t\tthis.lightMap = null;\n\t\tthis.lightMapIntensity = 1.0;\n\n\t\tthis.aoMap = null;\n\t\tthis.aoMapIntensity = 1.0;\n\n\t\tthis.emissive = new Color( 0x000000 );\n\t\tthis.emissiveIntensity = 1.0;\n\t\tthis.emissiveMap = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.specularMap = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.envMap = null;\n\t\tthis.envMapRotation = new Euler();\n\t\tthis.combine = MultiplyOperation;\n\t\tthis.reflectivity = 1;\n\t\tthis.refractionRatio = 0.98;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\t\tthis.wireframeLinecap = 'round';\n\t\tthis.wireframeLinejoin = 'round';\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.map = source.map;\n\n\t\tthis.lightMap = source.lightMap;\n\t\tthis.lightMapIntensity = source.lightMapIntensity;\n\n\t\tthis.aoMap = source.aoMap;\n\t\tthis.aoMapIntensity = source.aoMapIntensity;\n\n\t\tthis.emissive.copy( source.emissive );\n\t\tthis.emissiveMap = source.emissiveMap;\n\t\tthis.emissiveIntensity = source.emissiveIntensity;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.specularMap = source.specularMap;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.envMap = source.envMap;\n\t\tthis.envMapRotation.copy( source.envMapRotation );\n\t\tthis.combine = source.combine;\n\t\tthis.reflectivity = source.reflectivity;\n\t\tthis.refractionRatio = source.refractionRatio;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\t\tthis.wireframeLinecap = source.wireframeLinecap;\n\t\tthis.wireframeLinejoin = source.wireframeLinejoin;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshDepthMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshDepthMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshDepthMaterial = true;\n\n\t\tthis.depthPacking = BasicDepthPacking;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.wireframe = false;\n\t\tthis.wireframeLinewidth = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.depthPacking = source.depthPacking;\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.wireframe = source.wireframe;\n\t\tthis.wireframeLinewidth = source.wireframeLinewidth;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshDistanceMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshDistanceMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshDistanceMaterial = true;\n\n\t\tthis.map = null;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.map = source.map;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass MeshMatcapMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'MeshMatcapMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshMatcapMaterial = true;\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.color = new Color( 0xffffff ); // diffuse\n\n\t\tthis.matcap = null;\n\n\t\tthis.map = null;\n\n\t\tthis.bumpMap = null;\n\t\tthis.bumpScale = 1;\n\n\t\tthis.normalMap = null;\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\t\tthis.normalScale = new Vector2( 1, 1 );\n\n\t\tthis.displacementMap = null;\n\t\tthis.displacementScale = 1;\n\t\tthis.displacementBias = 0;\n\n\t\tthis.alphaMap = null;\n\n\t\tthis.flatShading = false;\n\n\t\tthis.fog = true;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.defines = { 'MATCAP': '' };\n\n\t\tthis.color.copy( source.color );\n\n\t\tthis.matcap = source.matcap;\n\n\t\tthis.map = source.map;\n\n\t\tthis.bumpMap = source.bumpMap;\n\t\tthis.bumpScale = source.bumpScale;\n\n\t\tthis.normalMap = source.normalMap;\n\t\tthis.normalMapType = source.normalMapType;\n\t\tthis.normalScale.copy( source.normalScale );\n\n\t\tthis.displacementMap = source.displacementMap;\n\t\tthis.displacementScale = source.displacementScale;\n\t\tthis.displacementBias = source.displacementBias;\n\n\t\tthis.alphaMap = source.alphaMap;\n\n\t\tthis.flatShading = source.flatShading;\n\n\t\tthis.fog = source.fog;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass LineDashedMaterial extends LineBasicMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'LineDashedMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineDashedMaterial = true;\n\n\t\tthis.scale = 1;\n\t\tthis.dashSize = 3;\n\t\tthis.gapSize = 1;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.scale = source.scale;\n\t\tthis.dashSize = source.dashSize;\n\t\tthis.gapSize = source.gapSize;\n\n\t\treturn this;\n\n\t}\n\n}\n\n// converts an array to a specific type\nfunction convertArray( array, type, forceClone ) {\n\n\tif ( ! array || // let 'undefined' and 'null' pass\n\t\t! forceClone && array.constructor === type ) return array;\n\n\tif ( typeof type.BYTES_PER_ELEMENT === 'number' ) {\n\n\t\treturn new type( array ); // create typed array\n\n\t}\n\n\treturn Array.prototype.slice.call( array ); // create Array\n\n}\n\nfunction isTypedArray( object ) {\n\n\treturn ArrayBuffer.isView( object ) &&\n\t\t! ( object instanceof DataView );\n\n}\n\n// returns an array by which times and values can be sorted\nfunction getKeyframeOrder( times ) {\n\n\tfunction compareTime( i, j ) {\n\n\t\treturn times[ i ] - times[ j ];\n\n\t}\n\n\tconst n = times.length;\n\tconst result = new Array( n );\n\tfor ( let i = 0; i !== n; ++ i ) result[ i ] = i;\n\n\tresult.sort( compareTime );\n\n\treturn result;\n\n}\n\n// uses the array previously returned by 'getKeyframeOrder' to sort data\nfunction sortedArray( values, stride, order ) {\n\n\tconst nValues = values.length;\n\tconst result = new values.constructor( nValues );\n\n\tfor ( let i = 0, dstOffset = 0; dstOffset !== nValues; ++ i ) {\n\n\t\tconst srcOffset = order[ i ] * stride;\n\n\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\tresult[ dstOffset ++ ] = values[ srcOffset + j ];\n\n\t\t}\n\n\t}\n\n\treturn result;\n\n}\n\n// function for parsing AOS keyframe formats\nfunction flattenJSON( jsonKeys, times, values, valuePropertyName ) {\n\n\tlet i = 1, key = jsonKeys[ 0 ];\n\n\twhile ( key !== undefined && key[ valuePropertyName ] === undefined ) {\n\n\t\tkey = jsonKeys[ i ++ ];\n\n\t}\n\n\tif ( key === undefined ) return; // no data\n\n\tlet value = key[ valuePropertyName ];\n\tif ( value === undefined ) return; // no data\n\n\tif ( Array.isArray( value ) ) {\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalues.push.apply( values, value ); // push all elements\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t} else if ( value.toArray !== undefined ) {\n\n\t\t// ...assume THREE.Math-ish\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalue.toArray( values, values.length );\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t} else {\n\n\t\t// otherwise push as-is\n\n\t\tdo {\n\n\t\t\tvalue = key[ valuePropertyName ];\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\ttimes.push( key.time );\n\t\t\t\tvalues.push( value );\n\n\t\t\t}\n\n\t\t\tkey = jsonKeys[ i ++ ];\n\n\t\t} while ( key !== undefined );\n\n\t}\n\n}\n\nfunction subclip( sourceClip, name, startFrame, endFrame, fps = 30 ) {\n\n\tconst clip = sourceClip.clone();\n\n\tclip.name = name;\n\n\tconst tracks = [];\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tconst track = clip.tracks[ i ];\n\t\tconst valueSize = track.getValueSize();\n\n\t\tconst times = [];\n\t\tconst values = [];\n\n\t\tfor ( let j = 0; j < track.times.length; ++ j ) {\n\n\t\t\tconst frame = track.times[ j ] * fps;\n\n\t\t\tif ( frame < startFrame || frame >= endFrame ) continue;\n\n\t\t\ttimes.push( track.times[ j ] );\n\n\t\t\tfor ( let k = 0; k < valueSize; ++ k ) {\n\n\t\t\t\tvalues.push( track.values[ j * valueSize + k ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( times.length === 0 ) continue;\n\n\t\ttrack.times = convertArray( times, track.times.constructor );\n\t\ttrack.values = convertArray( values, track.values.constructor );\n\n\t\ttracks.push( track );\n\n\t}\n\n\tclip.tracks = tracks;\n\n\t// find minimum .times value across all tracks in the trimmed clip\n\n\tlet minStartTime = Infinity;\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tif ( minStartTime > clip.tracks[ i ].times[ 0 ] ) {\n\n\t\t\tminStartTime = clip.tracks[ i ].times[ 0 ];\n\n\t\t}\n\n\t}\n\n\t// shift all tracks such that clip begins at t=0\n\n\tfor ( let i = 0; i < clip.tracks.length; ++ i ) {\n\n\t\tclip.tracks[ i ].shift( - 1 * minStartTime );\n\n\t}\n\n\tclip.resetDuration();\n\n\treturn clip;\n\n}\n\nfunction makeClipAdditive( targetClip, referenceFrame = 0, referenceClip = targetClip, fps = 30 ) {\n\n\tif ( fps <= 0 ) fps = 30;\n\n\tconst numTracks = referenceClip.tracks.length;\n\tconst referenceTime = referenceFrame / fps;\n\n\t// Make each track's values relative to the values at the reference frame\n\tfor ( let i = 0; i < numTracks; ++ i ) {\n\n\t\tconst referenceTrack = referenceClip.tracks[ i ];\n\t\tconst referenceTrackType = referenceTrack.ValueTypeName;\n\n\t\t// Skip this track if it's non-numeric\n\t\tif ( referenceTrackType === 'bool' || referenceTrackType === 'string' ) continue;\n\n\t\t// Find the track in the target clip whose name and type matches the reference track\n\t\tconst targetTrack = targetClip.tracks.find( function ( track ) {\n\n\t\t\treturn track.name === referenceTrack.name\n\t\t\t\t&& track.ValueTypeName === referenceTrackType;\n\n\t\t} );\n\n\t\tif ( targetTrack === undefined ) continue;\n\n\t\tlet referenceOffset = 0;\n\t\tconst referenceValueSize = referenceTrack.getValueSize();\n\n\t\tif ( referenceTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\treferenceOffset = referenceValueSize / 3;\n\n\t\t}\n\n\t\tlet targetOffset = 0;\n\t\tconst targetValueSize = targetTrack.getValueSize();\n\n\t\tif ( targetTrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline ) {\n\n\t\t\ttargetOffset = targetValueSize / 3;\n\n\t\t}\n\n\t\tconst lastIndex = referenceTrack.times.length - 1;\n\t\tlet referenceValue;\n\n\t\t// Find the value to subtract out of the track\n\t\tif ( referenceTime <= referenceTrack.times[ 0 ] ) {\n\n\t\t\t// Reference frame is earlier than the first keyframe, so just use the first keyframe\n\t\t\tconst startIndex = referenceOffset;\n\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\treferenceValue = referenceTrack.values.slice( startIndex, endIndex );\n\n\t\t} else if ( referenceTime >= referenceTrack.times[ lastIndex ] ) {\n\n\t\t\t// Reference frame is after the last keyframe, so just use the last keyframe\n\t\t\tconst startIndex = lastIndex * referenceValueSize + referenceOffset;\n\t\t\tconst endIndex = startIndex + referenceValueSize - referenceOffset;\n\t\t\treferenceValue = referenceTrack.values.slice( startIndex, endIndex );\n\n\t\t} else {\n\n\t\t\t// Interpolate to the reference value\n\t\t\tconst interpolant = referenceTrack.createInterpolant();\n\t\t\tconst startIndex = referenceOffset;\n\t\t\tconst endIndex = referenceValueSize - referenceOffset;\n\t\t\tinterpolant.evaluate( referenceTime );\n\t\t\treferenceValue = interpolant.resultBuffer.slice( startIndex, endIndex );\n\n\t\t}\n\n\t\t// Conjugate the quaternion\n\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\tconst referenceQuat = new Quaternion().fromArray( referenceValue ).normalize().conjugate();\n\t\t\treferenceQuat.toArray( referenceValue );\n\n\t\t}\n\n\t\t// Subtract the reference value from all of the track values\n\n\t\tconst numTimes = targetTrack.times.length;\n\t\tfor ( let j = 0; j < numTimes; ++ j ) {\n\n\t\t\tconst valueStart = j * targetValueSize + targetOffset;\n\n\t\t\tif ( referenceTrackType === 'quaternion' ) {\n\n\t\t\t\t// Multiply the conjugate for quaternion track types\n\t\t\t\tQuaternion.multiplyQuaternionsFlat(\n\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\tvalueStart,\n\t\t\t\t\treferenceValue,\n\t\t\t\t\t0,\n\t\t\t\t\ttargetTrack.values,\n\t\t\t\t\tvalueStart\n\t\t\t\t);\n\n\t\t\t} else {\n\n\t\t\t\tconst valueEnd = targetValueSize - targetOffset * 2;\n\n\t\t\t\t// Subtract each value for all other numeric track types\n\t\t\t\tfor ( let k = 0; k < valueEnd; ++ k ) {\n\n\t\t\t\t\ttargetTrack.values[ valueStart + k ] -= referenceValue[ k ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttargetClip.blendMode = AdditiveAnimationBlendMode;\n\n\treturn targetClip;\n\n}\n\nconst AnimationUtils = {\n\tconvertArray: convertArray,\n\tisTypedArray: isTypedArray,\n\tgetKeyframeOrder: getKeyframeOrder,\n\tsortedArray: sortedArray,\n\tflattenJSON: flattenJSON,\n\tsubclip: subclip,\n\tmakeClipAdditive: makeClipAdditive\n};\n\n/**\n * Abstract base class of interpolants over parametric samples.\n *\n * The parameter domain is one dimensional, typically the time or a path\n * along a curve defined by the data.\n *\n * The sample values can have any dimensionality and derived classes may\n * apply special interpretations to the data.\n *\n * This class provides the interval seek in a Template Method, deferring\n * the actual interpolation to derived classes.\n *\n * Time complexity is O(1) for linear access crossing at most two points\n * and O(log N) for random access, where N is the number of positions.\n *\n * References:\n *\n * \t\thttp://www.oodesign.com/template-method-pattern.html\n *\n */\n\nclass Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tthis.parameterPositions = parameterPositions;\n\t\tthis._cachedIndex = 0;\n\n\t\tthis.resultBuffer = resultBuffer !== undefined ?\n\t\t\tresultBuffer : new sampleValues.constructor( sampleSize );\n\t\tthis.sampleValues = sampleValues;\n\t\tthis.valueSize = sampleSize;\n\n\t\tthis.settings = null;\n\t\tthis.DefaultSettings_ = {};\n\n\t}\n\n\tevaluate( t ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet i1 = this._cachedIndex,\n\t\t\tt1 = pp[ i1 ],\n\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\tvalidate_interval: {\n\n\t\t\tseek: {\n\n\t\t\t\tlet right;\n\n\t\t\t\tlinear_scan: {\n\n\t\t\t\t\t//- See http://jsperf.com/comparison-to-undefined/3\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\n\t\t\t\t\t//- \t\t\t\tif ( t >= t1 || t1 === undefined ) {\n\t\t\t\t\tforward_scan: if ( ! ( t < t1 ) ) {\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 + 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\t\t\t\tif ( t < t0 ) break forward_scan;\n\n\t\t\t\t\t\t\t\t// after end\n\n\t\t\t\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\t\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt0 = t1;\n\t\t\t\t\t\t\tt1 = pp[ ++ i1 ];\n\n\t\t\t\t\t\t\tif ( t < t1 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the right side of the index\n\t\t\t\t\t\tright = pp.length;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//- slower code:\n\t\t\t\t\t//-\t\t\t\t\tif ( t < t0 || t0 === undefined ) {\n\t\t\t\t\tif ( ! ( t >= t0 ) ) {\n\n\t\t\t\t\t\t// looping?\n\n\t\t\t\t\t\tconst t1global = pp[ 1 ];\n\n\t\t\t\t\t\tif ( t < t1global ) {\n\n\t\t\t\t\t\t\ti1 = 2; // + 1, using the scan for the details\n\t\t\t\t\t\t\tt0 = t1global;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// linear reverse scan\n\n\t\t\t\t\t\tfor ( let giveUpAt = i1 - 2; ; ) {\n\n\t\t\t\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\t\t\t\t// before start\n\n\t\t\t\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\t\t\t\treturn this.copySampleValue_( 0 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( i1 === giveUpAt ) break; // this loop\n\n\t\t\t\t\t\t\tt1 = t0;\n\t\t\t\t\t\t\tt0 = pp[ -- i1 - 1 ];\n\n\t\t\t\t\t\t\tif ( t >= t0 ) {\n\n\t\t\t\t\t\t\t\t// we have arrived at the sought interval\n\t\t\t\t\t\t\t\tbreak seek;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// prepare binary search on the left side of the index\n\t\t\t\t\t\tright = i1;\n\t\t\t\t\t\ti1 = 0;\n\t\t\t\t\t\tbreak linear_scan;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// the interval is valid\n\n\t\t\t\t\tbreak validate_interval;\n\n\t\t\t\t} // linear scan\n\n\t\t\t\t// binary search\n\n\t\t\t\twhile ( i1 < right ) {\n\n\t\t\t\t\tconst mid = ( i1 + right ) >>> 1;\n\n\t\t\t\t\tif ( t < pp[ mid ] ) {\n\n\t\t\t\t\t\tright = mid;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ti1 = mid + 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tt1 = pp[ i1 ];\n\t\t\t\tt0 = pp[ i1 - 1 ];\n\n\t\t\t\t// check boundary cases, again\n\n\t\t\t\tif ( t0 === undefined ) {\n\n\t\t\t\t\tthis._cachedIndex = 0;\n\t\t\t\t\treturn this.copySampleValue_( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tif ( t1 === undefined ) {\n\n\t\t\t\t\ti1 = pp.length;\n\t\t\t\t\tthis._cachedIndex = i1;\n\t\t\t\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t\t\t\t}\n\n\t\t\t} // seek\n\n\t\t\tthis._cachedIndex = i1;\n\n\t\t\tthis.intervalChanged_( i1, t0, t1 );\n\n\t\t} // validate_interval\n\n\t\treturn this.interpolate_( i1, t0, t, t1 );\n\n\t}\n\n\tgetSettings_() {\n\n\t\treturn this.settings || this.DefaultSettings_;\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// copies a sample value to the result buffer\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = index * stride;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t// Template methods for derived classes:\n\n\tinterpolate_( /* i1, t0, t, t1 */ ) {\n\n\t\tthrow new Error( 'call to abstract method' );\n\t\t// implementations shall return this.resultBuffer\n\n\t}\n\n\tintervalChanged_( /* i1, t0, t1 */ ) {\n\n\t\t// empty\n\n\t}\n\n}\n\n/**\n * Fast and simple cubic spline interpolant.\n *\n * It was derived from a Hermitian construction setting the first derivative\n * at each sample position to the linear slope between neighboring positions\n * over their parameter interval.\n */\n\nclass CubicInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t\tthis._weightPrev = - 0;\n\t\tthis._offsetPrev = - 0;\n\t\tthis._weightNext = - 0;\n\t\tthis._offsetNext = - 0;\n\n\t\tthis.DefaultSettings_ = {\n\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\n\t\t};\n\n\t}\n\n\tintervalChanged_( i1, t0, t1 ) {\n\n\t\tconst pp = this.parameterPositions;\n\t\tlet iPrev = i1 - 2,\n\t\t\tiNext = i1 + 1,\n\n\t\t\ttPrev = pp[ iPrev ],\n\t\t\ttNext = pp[ iNext ];\n\n\t\tif ( tPrev === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingStart ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(t0) = 0\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = 2 * t0 - t1;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiPrev = pp.length - 2;\n\t\t\t\t\ttPrev = t0 + pp[ iPrev ] - pp[ iPrev + 1 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(t0) = 0 a.k.a. Natural Spline\n\t\t\t\t\tiPrev = i1;\n\t\t\t\t\ttPrev = t1;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tNext === undefined ) {\n\n\t\t\tswitch ( this.getSettings_().endingEnd ) {\n\n\t\t\t\tcase ZeroSlopeEnding:\n\n\t\t\t\t\t// f'(tN) = 0\n\t\t\t\t\tiNext = i1;\n\t\t\t\t\ttNext = 2 * t1 - t0;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase WrapAroundEnding:\n\n\t\t\t\t\t// use the other end of the curve\n\t\t\t\t\tiNext = 1;\n\t\t\t\t\ttNext = t1 + pp[ 1 ] - pp[ 0 ];\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ZeroCurvatureEnding\n\n\t\t\t\t\t// f''(tN) = 0, a.k.a. Natural Spline\n\t\t\t\t\tiNext = i1 - 1;\n\t\t\t\t\ttNext = t0;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst halfDt = ( t1 - t0 ) * 0.5,\n\t\t\tstride = this.valueSize;\n\n\t\tthis._weightPrev = halfDt / ( t0 - tPrev );\n\t\tthis._weightNext = halfDt / ( tNext - t1 );\n\t\tthis._offsetPrev = iPrev * stride;\n\t\tthis._offsetNext = iNext * stride;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\to1 = i1 * stride,\t\to0 = o1 - stride,\n\t\t\toP = this._offsetPrev, \toN = this._offsetNext,\n\t\t\twP = this._weightPrev,\twN = this._weightNext,\n\n\t\t\tp = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tpp = p * p,\n\t\t\tppp = pp * p;\n\n\t\t// evaluate polynomials\n\n\t\tconst sP = - wP * ppp + 2 * wP * pp - wP * p;\n\t\tconst s0 = ( 1 + wP ) * ppp + ( - 1.5 - 2 * wP ) * pp + ( - 0.5 + wP ) * p + 1;\n\t\tconst s1 = ( - 1 - wN ) * ppp + ( 1.5 + wN ) * pp + 0.5 * p;\n\t\tconst sN = wN * ppp - wN * pp;\n\n\t\t// combine data linearly\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tsP * values[ oP + i ] +\n\t\t\t\t\ts0 * values[ o0 + i ] +\n\t\t\t\t\ts1 * values[ o1 + i ] +\n\t\t\t\t\tsN * values[ oN + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nclass LinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\toffset1 = i1 * stride,\n\t\t\toffset0 = offset1 - stride,\n\n\t\t\tweight1 = ( t - t0 ) / ( t1 - t0 ),\n\t\t\tweight0 = 1 - weight1;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tresult[ i ] =\n\t\t\t\t\tvalues[ offset0 + i ] * weight0 +\n\t\t\t\t\tvalues[ offset1 + i ] * weight1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n *\n * Interpolant that evaluates to the sample value at the position preceding\n * the parameter.\n */\n\nclass DiscreteInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1 /*, t0, t, t1 */ ) {\n\n\t\treturn this.copySampleValue_( i1 - 1 );\n\n\t}\n\n}\n\nclass KeyframeTrack {\n\n\tconstructor( name, times, values, interpolation ) {\n\n\t\tif ( name === undefined ) throw new Error( 'THREE.KeyframeTrack: track name is undefined' );\n\t\tif ( times === undefined || times.length === 0 ) throw new Error( 'THREE.KeyframeTrack: no keyframes in track named ' + name );\n\n\t\tthis.name = name;\n\n\t\tthis.times = convertArray( times, this.TimeBufferType );\n\t\tthis.values = convertArray( values, this.ValueBufferType );\n\n\t\tthis.setInterpolation( interpolation || this.DefaultInterpolation );\n\n\t}\n\n\t// Serialization (in static context, because of constructor invocation\n\t// and automatic invocation of .toJSON):\n\n\tstatic toJSON( track ) {\n\n\t\tconst trackType = track.constructor;\n\n\t\tlet json;\n\n\t\t// derived classes can define a static toJSON method\n\t\tif ( trackType.toJSON !== this.toJSON ) {\n\n\t\t\tjson = trackType.toJSON( track );\n\n\t\t} else {\n\n\t\t\t// by default, we assume the data can be serialized as-is\n\t\t\tjson = {\n\n\t\t\t\t'name': track.name,\n\t\t\t\t'times': convertArray( track.times, Array ),\n\t\t\t\t'values': convertArray( track.values, Array )\n\n\t\t\t};\n\n\t\t\tconst interpolation = track.getInterpolation();\n\n\t\t\tif ( interpolation !== track.DefaultInterpolation ) {\n\n\t\t\t\tjson.interpolation = interpolation;\n\n\t\t\t}\n\n\t\t}\n\n\t\tjson.type = track.ValueTypeName; // mandatory\n\n\t\treturn json;\n\n\t}\n\n\tInterpolantFactoryMethodDiscrete( result ) {\n\n\t\treturn new DiscreteInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new LinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tInterpolantFactoryMethodSmooth( result ) {\n\n\t\treturn new CubicInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n\tsetInterpolation( interpolation ) {\n\n\t\tlet factoryMethod;\n\n\t\tswitch ( interpolation ) {\n\n\t\t\tcase InterpolateDiscrete:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodDiscrete;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateLinear:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodLinear;\n\n\t\t\t\tbreak;\n\n\t\t\tcase InterpolateSmooth:\n\n\t\t\t\tfactoryMethod = this.InterpolantFactoryMethodSmooth;\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( factoryMethod === undefined ) {\n\n\t\t\tconst message = 'unsupported interpolation for ' +\n\t\t\t\tthis.ValueTypeName + ' keyframe track named ' + this.name;\n\n\t\t\tif ( this.createInterpolant === undefined ) {\n\n\t\t\t\t// fall back to default, unless the default itself is messed up\n\t\t\t\tif ( interpolation !== this.DefaultInterpolation ) {\n\n\t\t\t\t\tthis.setInterpolation( this.DefaultInterpolation );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( message ); // fatal, in this case\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconsole.warn( 'THREE.KeyframeTrack:', message );\n\t\t\treturn this;\n\n\t\t}\n\n\t\tthis.createInterpolant = factoryMethod;\n\n\t\treturn this;\n\n\t}\n\n\tgetInterpolation() {\n\n\t\tswitch ( this.createInterpolant ) {\n\n\t\t\tcase this.InterpolantFactoryMethodDiscrete:\n\n\t\t\t\treturn InterpolateDiscrete;\n\n\t\t\tcase this.InterpolantFactoryMethodLinear:\n\n\t\t\t\treturn InterpolateLinear;\n\n\t\t\tcase this.InterpolantFactoryMethodSmooth:\n\n\t\t\t\treturn InterpolateSmooth;\n\n\t\t}\n\n\t}\n\n\tgetValueSize() {\n\n\t\treturn this.values.length / this.times.length;\n\n\t}\n\n\t// move all keyframes either forwards or backwards in time\n\tshift( timeOffset ) {\n\n\t\tif ( timeOffset !== 0.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] += timeOffset;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// scale all keyframe times by a factor (useful for frame <-> seconds conversions)\n\tscale( timeScale ) {\n\n\t\tif ( timeScale !== 1.0 ) {\n\n\t\t\tconst times = this.times;\n\n\t\t\tfor ( let i = 0, n = times.length; i !== n; ++ i ) {\n\n\t\t\t\ttimes[ i ] *= timeScale;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// removes keyframes before and after animation without changing any values within the range [startTime, endTime].\n\t// IMPORTANT: We do not shift around keys to the start of the track time, because for interpolated keys this will change their values\n\ttrim( startTime, endTime ) {\n\n\t\tconst times = this.times,\n\t\t\tnKeys = times.length;\n\n\t\tlet from = 0,\n\t\t\tto = nKeys - 1;\n\n\t\twhile ( from !== nKeys && times[ from ] < startTime ) {\n\n\t\t\t++ from;\n\n\t\t}\n\n\t\twhile ( to !== - 1 && times[ to ] > endTime ) {\n\n\t\t\t-- to;\n\n\t\t}\n\n\t\t++ to; // inclusive -> exclusive bound\n\n\t\tif ( from !== 0 || to !== nKeys ) {\n\n\t\t\t// empty tracks are forbidden, so keep at least one keyframe\n\t\t\tif ( from >= to ) {\n\n\t\t\t\tto = Math.max( to, 1 );\n\t\t\t\tfrom = to - 1;\n\n\t\t\t}\n\n\t\t\tconst stride = this.getValueSize();\n\t\t\tthis.times = times.slice( from, to );\n\t\t\tthis.values = this.values.slice( from * stride, to * stride );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// ensure we do not get a GarbageInGarbageOut situation, make sure tracks are at least minimally viable\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tconst valueSize = this.getValueSize();\n\t\tif ( valueSize - Math.floor( valueSize ) !== 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Invalid value size in track.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tconst times = this.times,\n\t\t\tvalues = this.values,\n\n\t\t\tnKeys = times.length;\n\n\t\tif ( nKeys === 0 ) {\n\n\t\t\tconsole.error( 'THREE.KeyframeTrack: Track is empty.', this );\n\t\t\tvalid = false;\n\n\t\t}\n\n\t\tlet prevTime = null;\n\n\t\tfor ( let i = 0; i !== nKeys; i ++ ) {\n\n\t\t\tconst currTime = times[ i ];\n\n\t\t\tif ( typeof currTime === 'number' && isNaN( currTime ) ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Time is not a valid number.', this, i, currTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( prevTime !== null && prevTime > currTime ) {\n\n\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Out of order keys.', this, i, currTime, prevTime );\n\t\t\t\tvalid = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tprevTime = currTime;\n\n\t\t}\n\n\t\tif ( values !== undefined ) {\n\n\t\t\tif ( isTypedArray( values ) ) {\n\n\t\t\t\tfor ( let i = 0, n = values.length; i !== n; ++ i ) {\n\n\t\t\t\t\tconst value = values[ i ];\n\n\t\t\t\t\tif ( isNaN( value ) ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.KeyframeTrack: Value is not a valid number.', this, i, value );\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\t// removes equivalent sequential keys as common in morph target sequences\n\t// (0,0,0,0,1,1,1,0,0,0,0,0,0,0) --> (0,0,1,1,0,0)\n\toptimize() {\n\n\t\t// times or values may be shared with other tracks, so overwriting is unsafe\n\t\tconst times = this.times.slice(),\n\t\t\tvalues = this.values.slice(),\n\t\t\tstride = this.getValueSize(),\n\n\t\t\tsmoothInterpolation = this.getInterpolation() === InterpolateSmooth,\n\n\t\t\tlastIndex = times.length - 1;\n\n\t\tlet writeIndex = 1;\n\n\t\tfor ( let i = 1; i < lastIndex; ++ i ) {\n\n\t\t\tlet keep = false;\n\n\t\t\tconst time = times[ i ];\n\t\t\tconst timeNext = times[ i + 1 ];\n\n\t\t\t// remove adjacent keyframes scheduled at the same time\n\n\t\t\tif ( time !== timeNext && ( i !== 1 || time !== times[ 0 ] ) ) {\n\n\t\t\t\tif ( ! smoothInterpolation ) {\n\n\t\t\t\t\t// remove unnecessary keyframes same as their neighbors\n\n\t\t\t\t\tconst offset = i * stride,\n\t\t\t\t\t\toffsetP = offset - stride,\n\t\t\t\t\t\toffsetN = offset + stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tconst value = values[ offset + j ];\n\n\t\t\t\t\t\tif ( value !== values[ offsetP + j ] ||\n\t\t\t\t\t\t\tvalue !== values[ offsetN + j ] ) {\n\n\t\t\t\t\t\t\tkeep = true;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tkeep = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// in-place compaction\n\n\t\t\tif ( keep ) {\n\n\t\t\t\tif ( i !== writeIndex ) {\n\n\t\t\t\t\ttimes[ writeIndex ] = times[ i ];\n\n\t\t\t\t\tconst readOffset = i * stride,\n\t\t\t\t\t\twriteOffset = writeIndex * stride;\n\n\t\t\t\t\tfor ( let j = 0; j !== stride; ++ j ) {\n\n\t\t\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t++ writeIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// flush last keyframe (compaction looks ahead)\n\n\t\tif ( lastIndex > 0 ) {\n\n\t\t\ttimes[ writeIndex ] = times[ lastIndex ];\n\n\t\t\tfor ( let readOffset = lastIndex * stride, writeOffset = writeIndex * stride, j = 0; j !== stride; ++ j ) {\n\n\t\t\t\tvalues[ writeOffset + j ] = values[ readOffset + j ];\n\n\t\t\t}\n\n\t\t\t++ writeIndex;\n\n\t\t}\n\n\t\tif ( writeIndex !== times.length ) {\n\n\t\t\tthis.times = times.slice( 0, writeIndex );\n\t\t\tthis.values = values.slice( 0, writeIndex * stride );\n\n\t\t} else {\n\n\t\t\tthis.times = times;\n\t\t\tthis.values = values;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst times = this.times.slice();\n\t\tconst values = this.values.slice();\n\n\t\tconst TypedKeyframeTrack = this.constructor;\n\t\tconst track = new TypedKeyframeTrack( this.name, times, values );\n\n\t\t// Interpolant argument to constructor is not saved, so copy the factory method directly.\n\t\ttrack.createInterpolant = this.createInterpolant;\n\n\t\treturn track;\n\n\t}\n\n}\n\nKeyframeTrack.prototype.TimeBufferType = Float32Array;\nKeyframeTrack.prototype.ValueBufferType = Float32Array;\nKeyframeTrack.prototype.DefaultInterpolation = InterpolateLinear;\n\n/**\n * A Track of Boolean keyframe values.\n */\nclass BooleanKeyframeTrack extends KeyframeTrack {\n\n\t// No interpolation parameter because only InterpolateDiscrete is valid.\n\tconstructor( name, times, values ) {\n\n\t\tsuper( name, times, values );\n\n\t}\n\n}\n\nBooleanKeyframeTrack.prototype.ValueTypeName = 'bool';\nBooleanKeyframeTrack.prototype.ValueBufferType = Array;\nBooleanKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nBooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of keyframe values that represent color.\n */\nclass ColorKeyframeTrack extends KeyframeTrack {}\n\nColorKeyframeTrack.prototype.ValueTypeName = 'color';\n\n/**\n * A Track of numeric keyframe values.\n */\nclass NumberKeyframeTrack extends KeyframeTrack {}\n\nNumberKeyframeTrack.prototype.ValueTypeName = 'number';\n\n/**\n * Spherical linear unit quaternion interpolant.\n */\n\nclass QuaternionLinearInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tstride = this.valueSize,\n\n\t\t\talpha = ( t - t0 ) / ( t1 - t0 );\n\n\t\tlet offset = i1 * stride;\n\n\t\tfor ( let end = offset + stride; offset !== end; offset += 4 ) {\n\n\t\t\tQuaternion.slerpFlat( result, 0, values, offset - stride, values, offset, alpha );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\n/**\n * A Track of quaternion keyframe values.\n */\nclass QuaternionKeyframeTrack extends KeyframeTrack {\n\n\tInterpolantFactoryMethodLinear( result ) {\n\n\t\treturn new QuaternionLinearInterpolant( this.times, this.values, this.getValueSize(), result );\n\n\t}\n\n}\n\nQuaternionKeyframeTrack.prototype.ValueTypeName = 'quaternion';\n// ValueBufferType is inherited\n// DefaultInterpolation is inherited;\nQuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track that interpolates Strings\n */\nclass StringKeyframeTrack extends KeyframeTrack {\n\n\t// No interpolation parameter because only InterpolateDiscrete is valid.\n\tconstructor( name, times, values ) {\n\n\t\tsuper( name, times, values );\n\n\t}\n\n}\n\nStringKeyframeTrack.prototype.ValueTypeName = 'string';\nStringKeyframeTrack.prototype.ValueBufferType = Array;\nStringKeyframeTrack.prototype.DefaultInterpolation = InterpolateDiscrete;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodLinear = undefined;\nStringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth = undefined;\n\n/**\n * A Track of vectored keyframe values.\n */\nclass VectorKeyframeTrack extends KeyframeTrack {}\n\nVectorKeyframeTrack.prototype.ValueTypeName = 'vector';\n\nclass AnimationClip {\n\n\tconstructor( name = '', duration = - 1, tracks = [], blendMode = NormalAnimationBlendMode ) {\n\n\t\tthis.name = name;\n\t\tthis.tracks = tracks;\n\t\tthis.duration = duration;\n\t\tthis.blendMode = blendMode;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// this means it should figure out its duration by scanning the tracks\n\t\tif ( this.duration < 0 ) {\n\n\t\t\tthis.resetDuration();\n\n\t\t}\n\n\t}\n\n\n\tstatic parse( json ) {\n\n\t\tconst tracks = [],\n\t\t\tjsonTracks = json.tracks,\n\t\t\tframeTime = 1.0 / ( json.fps || 1.0 );\n\n\t\tfor ( let i = 0, n = jsonTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( parseKeyframeTrack( jsonTracks[ i ] ).scale( frameTime ) );\n\n\t\t}\n\n\t\tconst clip = new this( json.name, json.duration, tracks, json.blendMode );\n\t\tclip.uuid = json.uuid;\n\n\t\treturn clip;\n\n\t}\n\n\tstatic toJSON( clip ) {\n\n\t\tconst tracks = [],\n\t\t\tclipTracks = clip.tracks;\n\n\t\tconst json = {\n\n\t\t\t'name': clip.name,\n\t\t\t'duration': clip.duration,\n\t\t\t'tracks': tracks,\n\t\t\t'uuid': clip.uuid,\n\t\t\t'blendMode': clip.blendMode\n\n\t\t};\n\n\t\tfor ( let i = 0, n = clipTracks.length; i !== n; ++ i ) {\n\n\t\t\ttracks.push( KeyframeTrack.toJSON( clipTracks[ i ] ) );\n\n\t\t}\n\n\t\treturn json;\n\n\t}\n\n\tstatic CreateFromMorphTargetSequence( name, morphTargetSequence, fps, noLoop ) {\n\n\t\tconst numMorphTargets = morphTargetSequence.length;\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; i ++ ) {\n\n\t\t\tlet times = [];\n\t\t\tlet values = [];\n\n\t\t\ttimes.push(\n\t\t\t\t( i + numMorphTargets - 1 ) % numMorphTargets,\n\t\t\t\ti,\n\t\t\t\t( i + 1 ) % numMorphTargets );\n\n\t\t\tvalues.push( 0, 1, 0 );\n\n\t\t\tconst order = getKeyframeOrder( times );\n\t\t\ttimes = sortedArray( times, 1, order );\n\t\t\tvalues = sortedArray( values, 1, order );\n\n\t\t\t// if there is a key at the first frame, duplicate it as the\n\t\t\t// last frame as well for perfect loop.\n\t\t\tif ( ! noLoop && times[ 0 ] === 0 ) {\n\n\t\t\t\ttimes.push( numMorphTargets );\n\t\t\t\tvalues.push( values[ 0 ] );\n\n\t\t\t}\n\n\t\t\ttracks.push(\n\t\t\t\tnew NumberKeyframeTrack(\n\t\t\t\t\t'.morphTargetInfluences[' + morphTargetSequence[ i ].name + ']',\n\t\t\t\t\ttimes, values\n\t\t\t\t).scale( 1.0 / fps ) );\n\n\t\t}\n\n\t\treturn new this( name, - 1, tracks );\n\n\t}\n\n\tstatic findByName( objectOrClipArray, name ) {\n\n\t\tlet clipArray = objectOrClipArray;\n\n\t\tif ( ! Array.isArray( objectOrClipArray ) ) {\n\n\t\t\tconst o = objectOrClipArray;\n\t\t\tclipArray = o.geometry && o.geometry.animations || o.animations;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < clipArray.length; i ++ ) {\n\n\t\t\tif ( clipArray[ i ].name === name ) {\n\n\t\t\t\treturn clipArray[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tstatic CreateClipsFromMorphTargetSequences( morphTargets, fps, noLoop ) {\n\n\t\tconst animationToMorphTargets = {};\n\n\t\t// tested with https://regex101.com/ on trick sequences\n\t\t// such flamingo_flyA_003, flamingo_run1_003, crdeath0059\n\t\tconst pattern = /^([\\w-]*?)([\\d]+)$/;\n\n\t\t// sort morph target names into animation groups based\n\t\t// patterns like Walk_001, Walk_002, Run_001, Run_002\n\t\tfor ( let i = 0, il = morphTargets.length; i < il; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst parts = morphTarget.name.match( pattern );\n\n\t\t\tif ( parts && parts.length > 1 ) {\n\n\t\t\t\tconst name = parts[ 1 ];\n\n\t\t\t\tlet animationMorphTargets = animationToMorphTargets[ name ];\n\n\t\t\t\tif ( ! animationMorphTargets ) {\n\n\t\t\t\t\tanimationToMorphTargets[ name ] = animationMorphTargets = [];\n\n\t\t\t\t}\n\n\t\t\t\tanimationMorphTargets.push( morphTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst clips = [];\n\n\t\tfor ( const name in animationToMorphTargets ) {\n\n\t\t\tclips.push( this.CreateFromMorphTargetSequence( name, animationToMorphTargets[ name ], fps, noLoop ) );\n\n\t\t}\n\n\t\treturn clips;\n\n\t}\n\n\t// parse the animation.hierarchy format\n\tstatic parseAnimation( animation, bones ) {\n\n\t\tif ( ! animation ) {\n\n\t\t\tconsole.error( 'THREE.AnimationClip: No animation in JSONLoader data.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst addNonemptyTrack = function ( trackType, trackName, animationKeys, propertyName, destTracks ) {\n\n\t\t\t// only return track if there are actually keys.\n\t\t\tif ( animationKeys.length !== 0 ) {\n\n\t\t\t\tconst times = [];\n\t\t\t\tconst values = [];\n\n\t\t\t\tflattenJSON( animationKeys, times, values, propertyName );\n\n\t\t\t\t// empty keys are filtered out, so check again\n\t\t\t\tif ( times.length !== 0 ) {\n\n\t\t\t\t\tdestTracks.push( new trackType( trackName, times, values ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tconst tracks = [];\n\n\t\tconst clipName = animation.name || 'default';\n\t\tconst fps = animation.fps || 30;\n\t\tconst blendMode = animation.blendMode;\n\n\t\t// automatic length determination in AnimationClip.\n\t\tlet duration = animation.length || - 1;\n\n\t\tconst hierarchyTracks = animation.hierarchy || [];\n\n\t\tfor ( let h = 0; h < hierarchyTracks.length; h ++ ) {\n\n\t\t\tconst animationKeys = hierarchyTracks[ h ].keys;\n\n\t\t\t// skip empty tracks\n\t\t\tif ( ! animationKeys || animationKeys.length === 0 ) continue;\n\n\t\t\t// process morph targets\n\t\t\tif ( animationKeys[ 0 ].morphTargets ) {\n\n\t\t\t\t// figure out all morph targets used in this track\n\t\t\t\tconst morphTargetNames = {};\n\n\t\t\t\tlet k;\n\n\t\t\t\tfor ( k = 0; k < animationKeys.length; k ++ ) {\n\n\t\t\t\t\tif ( animationKeys[ k ].morphTargets ) {\n\n\t\t\t\t\t\tfor ( let m = 0; m < animationKeys[ k ].morphTargets.length; m ++ ) {\n\n\t\t\t\t\t\t\tmorphTargetNames[ animationKeys[ k ].morphTargets[ m ] ] = - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// create a track for each morph target with all zero\n\t\t\t\t// morphTargetInfluences except for the keys in which\n\t\t\t\t// the morphTarget is named.\n\t\t\t\tfor ( const morphTargetName in morphTargetNames ) {\n\n\t\t\t\t\tconst times = [];\n\t\t\t\t\tconst values = [];\n\n\t\t\t\t\tfor ( let m = 0; m !== animationKeys[ k ].morphTargets.length; ++ m ) {\n\n\t\t\t\t\t\tconst animationKey = animationKeys[ k ];\n\n\t\t\t\t\t\ttimes.push( animationKey.time );\n\t\t\t\t\t\tvalues.push( ( animationKey.morphTarget === morphTargetName ) ? 1 : 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( new NumberKeyframeTrack( '.morphTargetInfluence[' + morphTargetName + ']', times, values ) );\n\n\t\t\t\t}\n\n\t\t\t\tduration = morphTargetNames.length * fps;\n\n\t\t\t} else {\n\n\t\t\t\t// ...assume skeletal animation\n\n\t\t\t\tconst boneName = '.bones[' + bones[ h ].name + ']';\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.position',\n\t\t\t\t\tanimationKeys, 'pos', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tQuaternionKeyframeTrack, boneName + '.quaternion',\n\t\t\t\t\tanimationKeys, 'rot', tracks );\n\n\t\t\t\taddNonemptyTrack(\n\t\t\t\t\tVectorKeyframeTrack, boneName + '.scale',\n\t\t\t\t\tanimationKeys, 'scl', tracks );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( tracks.length === 0 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst clip = new this( clipName, duration, tracks, blendMode );\n\n\t\treturn clip;\n\n\t}\n\n\tresetDuration() {\n\n\t\tconst tracks = this.tracks;\n\t\tlet duration = 0;\n\n\t\tfor ( let i = 0, n = tracks.length; i !== n; ++ i ) {\n\n\t\t\tconst track = this.tracks[ i ];\n\n\t\t\tduration = Math.max( duration, track.times[ track.times.length - 1 ] );\n\n\t\t}\n\n\t\tthis.duration = duration;\n\n\t\treturn this;\n\n\t}\n\n\ttrim() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].trim( 0, this.duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tvalidate() {\n\n\t\tlet valid = true;\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tvalid = valid && this.tracks[ i ].validate();\n\n\t\t}\n\n\t\treturn valid;\n\n\t}\n\n\toptimize() {\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\tthis.tracks[ i ].optimize();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\tconst tracks = [];\n\n\t\tfor ( let i = 0; i < this.tracks.length; i ++ ) {\n\n\t\t\ttracks.push( this.tracks[ i ].clone() );\n\n\t\t}\n\n\t\treturn new this.constructor( this.name, this.duration, tracks, this.blendMode );\n\n\t}\n\n\ttoJSON() {\n\n\t\treturn this.constructor.toJSON( this );\n\n\t}\n\n}\n\nfunction getTrackTypeForValueTypeName( typeName ) {\n\n\tswitch ( typeName.toLowerCase() ) {\n\n\t\tcase 'scalar':\n\t\tcase 'double':\n\t\tcase 'float':\n\t\tcase 'number':\n\t\tcase 'integer':\n\n\t\t\treturn NumberKeyframeTrack;\n\n\t\tcase 'vector':\n\t\tcase 'vector2':\n\t\tcase 'vector3':\n\t\tcase 'vector4':\n\n\t\t\treturn VectorKeyframeTrack;\n\n\t\tcase 'color':\n\n\t\t\treturn ColorKeyframeTrack;\n\n\t\tcase 'quaternion':\n\n\t\t\treturn QuaternionKeyframeTrack;\n\n\t\tcase 'bool':\n\t\tcase 'boolean':\n\n\t\t\treturn BooleanKeyframeTrack;\n\n\t\tcase 'string':\n\n\t\t\treturn StringKeyframeTrack;\n\n\t}\n\n\tthrow new Error( 'THREE.KeyframeTrack: Unsupported typeName: ' + typeName );\n\n}\n\nfunction parseKeyframeTrack( json ) {\n\n\tif ( json.type === undefined ) {\n\n\t\tthrow new Error( 'THREE.KeyframeTrack: track type undefined, can not parse' );\n\n\t}\n\n\tconst trackType = getTrackTypeForValueTypeName( json.type );\n\n\tif ( json.times === undefined ) {\n\n\t\tconst times = [], values = [];\n\n\t\tflattenJSON( json.keys, times, values, 'value' );\n\n\t\tjson.times = times;\n\t\tjson.values = values;\n\n\t}\n\n\t// derived classes can define a static parse method\n\tif ( trackType.parse !== undefined ) {\n\n\t\treturn trackType.parse( json );\n\n\t} else {\n\n\t\t// by default, we assume a constructor compatible with the base\n\t\treturn new trackType( json.name, json.times, json.values, json.interpolation );\n\n\t}\n\n}\n\nconst Cache = {\n\n\tenabled: false,\n\n\tfiles: {},\n\n\tadd: function ( key, file ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Adding key:', key );\n\n\t\tthis.files[ key ] = file;\n\n\t},\n\n\tget: function ( key ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\t// console.log( 'THREE.Cache', 'Checking key:', key );\n\n\t\treturn this.files[ key ];\n\n\t},\n\n\tremove: function ( key ) {\n\n\t\tdelete this.files[ key ];\n\n\t},\n\n\tclear: function () {\n\n\t\tthis.files = {};\n\n\t}\n\n};\n\nclass LoadingManager {\n\n\tconstructor( onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet isLoading = false;\n\t\tlet itemsLoaded = 0;\n\t\tlet itemsTotal = 0;\n\t\tlet urlModifier = undefined;\n\t\tconst handlers = [];\n\n\t\t// Refer to #5689 for the reason why we don't set .onStart\n\t\t// in the constructor\n\n\t\tthis.onStart = undefined;\n\t\tthis.onLoad = onLoad;\n\t\tthis.onProgress = onProgress;\n\t\tthis.onError = onError;\n\n\t\tthis.itemStart = function ( url ) {\n\n\t\t\titemsTotal ++;\n\n\t\t\tif ( isLoading === false ) {\n\n\t\t\t\tif ( scope.onStart !== undefined ) {\n\n\t\t\t\t\tscope.onStart( url, itemsLoaded, itemsTotal );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tisLoading = true;\n\n\t\t};\n\n\t\tthis.itemEnd = function ( url ) {\n\n\t\t\titemsLoaded ++;\n\n\t\t\tif ( scope.onProgress !== undefined ) {\n\n\t\t\t\tscope.onProgress( url, itemsLoaded, itemsTotal );\n\n\t\t\t}\n\n\t\t\tif ( itemsLoaded === itemsTotal ) {\n\n\t\t\t\tisLoading = false;\n\n\t\t\t\tif ( scope.onLoad !== undefined ) {\n\n\t\t\t\t\tscope.onLoad();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.itemError = function ( url ) {\n\n\t\t\tif ( scope.onError !== undefined ) {\n\n\t\t\t\tscope.onError( url );\n\n\t\t\t}\n\n\t\t};\n\n\t\tthis.resolveURL = function ( url ) {\n\n\t\t\tif ( urlModifier ) {\n\n\t\t\t\treturn urlModifier( url );\n\n\t\t\t}\n\n\t\t\treturn url;\n\n\t\t};\n\n\t\tthis.setURLModifier = function ( transform ) {\n\n\t\t\turlModifier = transform;\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.addHandler = function ( regex, loader ) {\n\n\t\t\thandlers.push( regex, loader );\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.removeHandler = function ( regex ) {\n\n\t\t\tconst index = handlers.indexOf( regex );\n\n\t\t\tif ( index !== - 1 ) {\n\n\t\t\t\thandlers.splice( index, 2 );\n\n\t\t\t}\n\n\t\t\treturn this;\n\n\t\t};\n\n\t\tthis.getHandler = function ( file ) {\n\n\t\t\tfor ( let i = 0, l = handlers.length; i < l; i += 2 ) {\n\n\t\t\t\tconst regex = handlers[ i ];\n\t\t\t\tconst loader = handlers[ i + 1 ];\n\n\t\t\t\tif ( regex.global ) regex.lastIndex = 0; // see #17920\n\n\t\t\t\tif ( regex.test( file ) ) {\n\n\t\t\t\t\treturn loader;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn null;\n\n\t\t};\n\n\t}\n\n}\n\nconst DefaultLoadingManager = /*@__PURE__*/ new LoadingManager();\n\nclass Loader {\n\n\tconstructor( manager ) {\n\n\t\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n\t\tthis.crossOrigin = 'anonymous';\n\t\tthis.withCredentials = false;\n\t\tthis.path = '';\n\t\tthis.resourcePath = '';\n\t\tthis.requestHeader = {};\n\n\t}\n\n\tload( /* url, onLoad, onProgress, onError */ ) {}\n\n\tloadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.load( url, resolve, onProgress, reject );\n\n\t\t} );\n\n\t}\n\n\tparse( /* data */ ) {}\n\n\tsetCrossOrigin( crossOrigin ) {\n\n\t\tthis.crossOrigin = crossOrigin;\n\t\treturn this;\n\n\t}\n\n\tsetWithCredentials( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t}\n\n\tsetPath( path ) {\n\n\t\tthis.path = path;\n\t\treturn this;\n\n\t}\n\n\tsetResourcePath( resourcePath ) {\n\n\t\tthis.resourcePath = resourcePath;\n\t\treturn this;\n\n\t}\n\n\tsetRequestHeader( requestHeader ) {\n\n\t\tthis.requestHeader = requestHeader;\n\t\treturn this;\n\n\t}\n\n}\n\nLoader.DEFAULT_MATERIAL_NAME = '__DEFAULT';\n\nconst loading = {};\n\nclass HttpError extends Error {\n\n\tconstructor( message, response ) {\n\n\t\tsuper( message );\n\t\tthis.response = response;\n\n\t}\n\n}\n\nclass FileLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tthis.manager.itemStart( url );\n\n\t\t\tsetTimeout( () => {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Initialise array for duplicate requests\n\t\tloading[ url ] = [];\n\n\t\tloading[ url ].push( {\n\t\t\tonLoad: onLoad,\n\t\t\tonProgress: onProgress,\n\t\t\tonError: onError,\n\t\t} );\n\n\t\t// create request\n\t\tconst req = new Request( url, {\n\t\t\theaders: new Headers( this.requestHeader ),\n\t\t\tcredentials: this.withCredentials ? 'include' : 'same-origin',\n\t\t\t// An abort controller could be added within a future PR\n\t\t} );\n\n\t\t// record states ( avoid data race )\n\t\tconst mimeType = this.mimeType;\n\t\tconst responseType = this.responseType;\n\n\t\t// start the fetch\n\t\tfetch( req )\n\t\t\t.then( response => {\n\n\t\t\t\tif ( response.status === 200 || response.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( response.status === 0 ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Workaround: Checking if response.body === undefined for Alipay browser #23548\n\n\t\t\t\t\tif ( typeof ReadableStream === 'undefined' || response.body === undefined || response.body.getReader === undefined ) {\n\n\t\t\t\t\t\treturn response;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\t\tconst reader = response.body.getReader();\n\n\t\t\t\t\t// Nginx needs X-File-Size check\n\t\t\t\t\t// https://serverfault.com/questions/482875/why-does-nginx-remove-content-length-header-for-chunked-content\n\t\t\t\t\tconst contentLength = response.headers.get( 'X-File-Size' ) || response.headers.get( 'Content-Length' );\n\t\t\t\t\tconst total = contentLength ? parseInt( contentLength ) : 0;\n\t\t\t\t\tconst lengthComputable = total !== 0;\n\t\t\t\t\tlet loaded = 0;\n\n\t\t\t\t\t// periodically read data into the new stream tracking while download progress\n\t\t\t\t\tconst stream = new ReadableStream( {\n\t\t\t\t\t\tstart( controller ) {\n\n\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\tfunction readData() {\n\n\t\t\t\t\t\t\t\treader.read().then( ( { done, value } ) => {\n\n\t\t\t\t\t\t\t\t\tif ( done ) {\n\n\t\t\t\t\t\t\t\t\t\tcontroller.close();\n\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\tloaded += value.byteLength;\n\n\t\t\t\t\t\t\t\t\t\tconst event = new ProgressEvent( 'progress', { lengthComputable, loaded, total } );\n\t\t\t\t\t\t\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\t\t\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tcontroller.enqueue( value );\n\t\t\t\t\t\t\t\t\t\treadData();\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}, ( e ) => {\n\n\t\t\t\t\t\t\t\t\tcontroller.error( e );\n\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn new Response( stream );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new HttpError( `fetch for \"${response.url}\" responded with ${response.status}: ${response.statusText}`, response );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( response => {\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\n\t\t\t\t\t\treturn response.arrayBuffer();\n\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\treturn response.blob();\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\treturn response.text()\n\t\t\t\t\t\t\t.then( text => {\n\n\t\t\t\t\t\t\t\tconst parser = new DOMParser();\n\t\t\t\t\t\t\t\treturn parser.parseFromString( text, mimeType );\n\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\treturn response.json();\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( mimeType === undefined ) {\n\n\t\t\t\t\t\t\treturn response.text();\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// sniff encoding\n\t\t\t\t\t\t\tconst re = /charset=\"?([^;\"\\s]*)\"?/i;\n\t\t\t\t\t\t\tconst exec = re.exec( mimeType );\n\t\t\t\t\t\t\tconst label = exec && exec[ 1 ] ? exec[ 1 ].toLowerCase() : undefined;\n\t\t\t\t\t\t\tconst decoder = new TextDecoder( label );\n\t\t\t\t\t\t\treturn response.arrayBuffer().then( ab => decoder.decode( ab ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.then( data => {\n\n\t\t\t\t// Add to cache only on HTTP success, so that we do not cache\n\t\t\t\t// error response bodies as proper responses to requests.\n\t\t\t\tCache.add( url, data );\n\n\t\t\t\tconst callbacks = loading[ url ];\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( data );\n\n\t\t\t\t}\n\n\t\t\t} )\n\t\t\t.catch( err => {\n\n\t\t\t\t// Abort errors and other errors are handled the same\n\n\t\t\t\tconst callbacks = loading[ url ];\n\n\t\t\t\tif ( callbacks === undefined ) {\n\n\t\t\t\t\t// When onLoad was called and url was deleted in `loading`\n\t\t\t\t\tthis.manager.itemError( url );\n\t\t\t\t\tthrow err;\n\n\t\t\t\t}\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( let i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( err );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t} )\n\t\t\t.finally( () => {\n\n\t\t\t\tthis.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\tthis.manager.itemStart( url );\n\n\t}\n\n\tsetResponseType( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t}\n\n\tsetMimeType( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t}\n\n}\n\nclass AnimationLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst animations = [];\n\n\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\tconst clip = AnimationClip.parse( json[ i ] );\n\n\t\t\tanimations.push( clip );\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to block based textures loader (dds, pvr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass CompressedTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst images = [];\n\n\t\tconst texture = new CompressedTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( url[ i ], function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\timages[ i ] = {\n\t\t\t\t\twidth: texDatas.width,\n\t\t\t\t\theight: texDatas.height,\n\t\t\t\t\tformat: texDatas.format,\n\t\t\t\t\tmipmaps: texDatas.mipmaps\n\t\t\t\t};\n\n\t\t\t\tloaded += 1;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\tif ( texDatas.mipmapCount === 1 ) texture.minFilter = LinearFilter;\n\n\t\t\t\t\ttexture.image = images;\n\t\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\tif ( Array.isArray( url ) ) {\n\n\t\t\tfor ( let i = 0, il = url.length; i < il; ++ i ) {\n\n\t\t\t\tloadTexture( i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// compressed cubemap texture stored in a single DDS file\n\n\t\t\tloader.load( url, function ( buffer ) {\n\n\t\t\t\tconst texDatas = scope.parse( buffer, true );\n\n\t\t\t\tif ( texDatas.isCubemap ) {\n\n\t\t\t\t\tconst faces = texDatas.mipmaps.length / texDatas.mipmapCount;\n\n\t\t\t\t\tfor ( let f = 0; f < faces; f ++ ) {\n\n\t\t\t\t\t\timages[ f ] = { mipmaps: [] };\n\n\t\t\t\t\t\tfor ( let i = 0; i < texDatas.mipmapCount; i ++ ) {\n\n\t\t\t\t\t\t\timages[ f ].mipmaps.push( texDatas.mipmaps[ f * texDatas.mipmapCount + i ] );\n\t\t\t\t\t\t\timages[ f ].format = texDatas.format;\n\t\t\t\t\t\t\timages[ f ].width = texDatas.width;\n\t\t\t\t\t\t\timages[ f ].height = texDatas.height;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttexture.image = images;\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttexture.image.width = texDatas.width;\n\t\t\t\t\ttexture.image.height = texDatas.height;\n\t\t\t\t\ttexture.mipmaps = texDatas.mipmaps;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texDatas.mipmapCount === 1 ) {\n\n\t\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t\t}\n\n\t\t\t\ttexture.format = texDatas.format;\n\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t}, onProgress, onError );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass ImageLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst image = createElementNS( 'img' );\n\n\t\tfunction onImageLoad() {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tCache.add( url, this );\n\n\t\t\tif ( onLoad ) onLoad( this );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction onImageError( event ) {\n\n\t\t\tremoveEventListeners();\n\n\t\t\tif ( onError ) onError( event );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t}\n\n\t\tfunction removeEventListeners() {\n\n\t\t\timage.removeEventListener( 'load', onImageLoad, false );\n\t\t\timage.removeEventListener( 'error', onImageError, false );\n\n\t\t}\n\n\t\timage.addEventListener( 'load', onImageLoad, false );\n\t\timage.addEventListener( 'error', onImageError, false );\n\n\t\tif ( url.slice( 0, 5 ) !== 'data:' ) {\n\n\t\t\tif ( this.crossOrigin !== undefined ) image.crossOrigin = this.crossOrigin;\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\timage.src = url;\n\n\t\treturn image;\n\n\t}\n\n}\n\nclass CubeTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( urls, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new CubeTexture();\n\t\ttexture.colorSpace = SRGBColorSpace;\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tlet loaded = 0;\n\n\t\tfunction loadTexture( i ) {\n\n\t\t\tloader.load( urls[ i ], function ( image ) {\n\n\t\t\t\ttexture.images[ i ] = image;\n\n\t\t\t\tloaded ++;\n\n\t\t\t\tif ( loaded === 6 ) {\n\n\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\tif ( onLoad ) onLoad( texture );\n\n\t\t\t\t}\n\n\t\t\t}, undefined, onError );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < urls.length; ++ i ) {\n\n\t\t\tloadTexture( i );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Abstract Base class to load generic binary textures formats (rgbe, hdr, ...)\n *\n * Sub classes have to implement the parse() method which will be used in load().\n */\n\nclass DataTextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst texture = new DataTexture();\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setPath( this.path );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\tlet texData;\n\n\t\t\ttry {\n\n\t\t\t\ttexData = scope.parse( buffer );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( onError !== undefined ) {\n\n\t\t\t\t\tonError( error );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( texData.image !== undefined ) {\n\n\t\t\t\ttexture.image = texData.image;\n\n\t\t\t} else if ( texData.data !== undefined ) {\n\n\t\t\t\ttexture.image.width = texData.width;\n\t\t\t\ttexture.image.height = texData.height;\n\t\t\t\ttexture.image.data = texData.data;\n\n\t\t\t}\n\n\t\t\ttexture.wrapS = texData.wrapS !== undefined ? texData.wrapS : ClampToEdgeWrapping;\n\t\t\ttexture.wrapT = texData.wrapT !== undefined ? texData.wrapT : ClampToEdgeWrapping;\n\n\t\t\ttexture.magFilter = texData.magFilter !== undefined ? texData.magFilter : LinearFilter;\n\t\t\ttexture.minFilter = texData.minFilter !== undefined ? texData.minFilter : LinearFilter;\n\n\t\t\ttexture.anisotropy = texData.anisotropy !== undefined ? texData.anisotropy : 1;\n\n\t\t\tif ( texData.colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = texData.colorSpace;\n\n\t\t\t}\n\n\t\t\tif ( texData.flipY !== undefined ) {\n\n\t\t\t\ttexture.flipY = texData.flipY;\n\n\t\t\t}\n\n\t\t\tif ( texData.format !== undefined ) {\n\n\t\t\t\ttexture.format = texData.format;\n\n\t\t\t}\n\n\t\t\tif ( texData.type !== undefined ) {\n\n\t\t\t\ttexture.type = texData.type;\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmaps !== undefined ) {\n\n\t\t\t\ttexture.mipmaps = texData.mipmaps;\n\t\t\t\ttexture.minFilter = LinearMipmapLinearFilter; // presumably...\n\n\t\t\t}\n\n\t\t\tif ( texData.mipmapCount === 1 ) {\n\n\t\t\t\ttexture.minFilter = LinearFilter;\n\n\t\t\t}\n\n\t\t\tif ( texData.generateMipmaps !== undefined ) {\n\n\t\t\t\ttexture.generateMipmaps = texData.generateMipmaps;\n\n\t\t\t}\n\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad ) onLoad( texture, texData );\n\n\t\t}, onProgress, onError );\n\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass TextureLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst texture = new Texture();\n\n\t\tconst loader = new ImageLoader( this.manager );\n\t\tloader.setCrossOrigin( this.crossOrigin );\n\t\tloader.setPath( this.path );\n\n\t\tloader.load( url, function ( image ) {\n\n\t\t\ttexture.image = image;\n\t\t\ttexture.needsUpdate = true;\n\n\t\t\tif ( onLoad !== undefined ) {\n\n\t\t\t\tonLoad( texture );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\treturn texture;\n\n\t}\n\n}\n\nclass Light extends Object3D {\n\n\tconstructor( color, intensity = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.isLight = true;\n\n\t\tthis.type = 'Light';\n\n\t\tthis.color = new Color( color );\n\t\tthis.intensity = intensity;\n\n\t}\n\n\tdispose() {\n\n\t\t// Empty here in base class; some subclasses override.\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.color.copy( source.color );\n\t\tthis.intensity = source.intensity;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.color = this.color.getHex();\n\t\tdata.object.intensity = this.intensity;\n\n\t\tif ( this.groundColor !== undefined ) data.object.groundColor = this.groundColor.getHex();\n\n\t\tif ( this.distance !== undefined ) data.object.distance = this.distance;\n\t\tif ( this.angle !== undefined ) data.object.angle = this.angle;\n\t\tif ( this.decay !== undefined ) data.object.decay = this.decay;\n\t\tif ( this.penumbra !== undefined ) data.object.penumbra = this.penumbra;\n\n\t\tif ( this.shadow !== undefined ) data.object.shadow = this.shadow.toJSON();\n\t\tif ( this.target !== undefined ) data.object.target = this.target.uuid;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass HemisphereLight extends Light {\n\n\tconstructor( skyColor, groundColor, intensity ) {\n\n\t\tsuper( skyColor, intensity );\n\n\t\tthis.isHemisphereLight = true;\n\n\t\tthis.type = 'HemisphereLight';\n\n\t\tthis.position.copy( Object3D.DEFAULT_UP );\n\t\tthis.updateMatrix();\n\n\t\tthis.groundColor = new Color( groundColor );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.groundColor.copy( source.groundColor );\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _projScreenMatrix$2 = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld$1 = /*@__PURE__*/ new Vector3();\nconst _lookTarget$1 = /*@__PURE__*/ new Vector3();\n\nclass LightShadow {\n\n\tconstructor( camera ) {\n\n\t\tthis.camera = camera;\n\n\t\tthis.intensity = 1;\n\n\t\tthis.bias = 0;\n\t\tthis.normalBias = 0;\n\t\tthis.radius = 1;\n\t\tthis.blurSamples = 8;\n\n\t\tthis.mapSize = new Vector2( 512, 512 );\n\n\t\tthis.map = null;\n\t\tthis.mapPass = null;\n\t\tthis.matrix = new Matrix4();\n\n\t\tthis.autoUpdate = true;\n\t\tthis.needsUpdate = false;\n\n\t\tthis._frustum = new Frustum();\n\t\tthis._frameExtents = new Vector2( 1, 1 );\n\n\t\tthis._viewportCount = 1;\n\n\t\tthis._viewports = [\n\n\t\t\tnew Vector4( 0, 0, 1, 1 )\n\n\t\t];\n\n\t}\n\n\tgetViewportCount() {\n\n\t\treturn this._viewportCount;\n\n\t}\n\n\tgetFrustum() {\n\n\t\treturn this._frustum;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst shadowCamera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\t_lightPositionWorld$1.setFromMatrixPosition( light.matrixWorld );\n\t\tshadowCamera.position.copy( _lightPositionWorld$1 );\n\n\t\t_lookTarget$1.setFromMatrixPosition( light.target.matrixWorld );\n\t\tshadowCamera.lookAt( _lookTarget$1 );\n\t\tshadowCamera.updateMatrixWorld();\n\n\t\t_projScreenMatrix$2.multiplyMatrices( shadowCamera.projectionMatrix, shadowCamera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix$2 );\n\n\t\tshadowMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\n\t\tshadowMatrix.multiply( _projScreenMatrix$2 );\n\n\t}\n\n\tgetViewport( viewportIndex ) {\n\n\t\treturn this._viewports[ viewportIndex ];\n\n\t}\n\n\tgetFrameExtents() {\n\n\t\treturn this._frameExtents;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this.map ) {\n\n\t\t\tthis.map.dispose();\n\n\t\t}\n\n\t\tif ( this.mapPass ) {\n\n\t\t\tthis.mapPass.dispose();\n\n\t\t}\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.camera = source.camera.clone();\n\n\t\tthis.intensity = source.intensity;\n\n\t\tthis.bias = source.bias;\n\t\tthis.radius = source.radius;\n\n\t\tthis.mapSize.copy( source.mapSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst object = {};\n\n\t\tif ( this.intensity !== 1 ) object.intensity = this.intensity;\n\t\tif ( this.bias !== 0 ) object.bias = this.bias;\n\t\tif ( this.normalBias !== 0 ) object.normalBias = this.normalBias;\n\t\tif ( this.radius !== 1 ) object.radius = this.radius;\n\t\tif ( this.mapSize.x !== 512 || this.mapSize.y !== 512 ) object.mapSize = this.mapSize.toArray();\n\n\t\tobject.camera = this.camera.toJSON( false ).object;\n\t\tdelete object.camera.matrix;\n\n\t\treturn object;\n\n\t}\n\n}\n\nclass SpotLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 50, 1, 0.5, 500 ) );\n\n\t\tthis.isSpotLightShadow = true;\n\n\t\tthis.focus = 1;\n\n\t}\n\n\tupdateMatrices( light ) {\n\n\t\tconst camera = this.camera;\n\n\t\tconst fov = RAD2DEG * 2 * light.angle * this.focus;\n\t\tconst aspect = this.mapSize.width / this.mapSize.height;\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( fov !== camera.fov || aspect !== camera.aspect || far !== camera.far ) {\n\n\t\t\tcamera.fov = fov;\n\t\t\tcamera.aspect = aspect;\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\tsuper.updateMatrices( light );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.focus = source.focus;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass SpotLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, angle = Math.PI / 3, penumbra = 0, decay = 2 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isSpotLight = true;\n\n\t\tthis.type = 'SpotLight';\n\n\t\tthis.position.copy( Object3D.DEFAULT_UP );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.distance = distance;\n\t\tthis.angle = angle;\n\t\tthis.penumbra = penumbra;\n\t\tthis.decay = decay;\n\n\t\tthis.map = null;\n\n\t\tthis.shadow = new SpotLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// by convention for a spotlight, luminous power (lm) = π * luminous intensity (cd)\n\t\treturn this.intensity * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / Math.PI;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.distance = source.distance;\n\t\tthis.angle = source.angle;\n\t\tthis.penumbra = source.penumbra;\n\t\tthis.decay = source.decay;\n\n\t\tthis.target = source.target.clone();\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _projScreenMatrix$1 = /*@__PURE__*/ new Matrix4();\nconst _lightPositionWorld = /*@__PURE__*/ new Vector3();\nconst _lookTarget = /*@__PURE__*/ new Vector3();\n\nclass PointLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new PerspectiveCamera( 90, 1, 0.5, 500 ) );\n\n\t\tthis.isPointLightShadow = true;\n\n\t\tthis._frameExtents = new Vector2( 4, 2 );\n\n\t\tthis._viewportCount = 6;\n\n\t\tthis._viewports = [\n\t\t\t// These viewports map a cube-map onto a 2D texture with the\n\t\t\t// following orientation:\n\t\t\t//\n\t\t\t//  xzXZ\n\t\t\t//   y Y\n\t\t\t//\n\t\t\t// X - Positive x direction\n\t\t\t// x - Negative x direction\n\t\t\t// Y - Positive y direction\n\t\t\t// y - Negative y direction\n\t\t\t// Z - Positive z direction\n\t\t\t// z - Negative z direction\n\n\t\t\t// positive X\n\t\t\tnew Vector4( 2, 1, 1, 1 ),\n\t\t\t// negative X\n\t\t\tnew Vector4( 0, 1, 1, 1 ),\n\t\t\t// positive Z\n\t\t\tnew Vector4( 3, 1, 1, 1 ),\n\t\t\t// negative Z\n\t\t\tnew Vector4( 1, 1, 1, 1 ),\n\t\t\t// positive Y\n\t\t\tnew Vector4( 3, 0, 1, 1 ),\n\t\t\t// negative Y\n\t\t\tnew Vector4( 1, 0, 1, 1 )\n\t\t];\n\n\t\tthis._cubeDirections = [\n\t\t\tnew Vector3( 1, 0, 0 ), new Vector3( - 1, 0, 0 ), new Vector3( 0, 0, 1 ),\n\t\t\tnew Vector3( 0, 0, - 1 ), new Vector3( 0, 1, 0 ), new Vector3( 0, - 1, 0 )\n\t\t];\n\n\t\tthis._cubeUps = [\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ), new Vector3( 0, 1, 0 ),\n\t\t\tnew Vector3( 0, 1, 0 ), new Vector3( 0, 0, 1 ),\tnew Vector3( 0, 0, - 1 )\n\t\t];\n\n\t}\n\n\tupdateMatrices( light, viewportIndex = 0 ) {\n\n\t\tconst camera = this.camera;\n\t\tconst shadowMatrix = this.matrix;\n\n\t\tconst far = light.distance || camera.far;\n\n\t\tif ( far !== camera.far ) {\n\n\t\t\tcamera.far = far;\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t_lightPositionWorld.setFromMatrixPosition( light.matrixWorld );\n\t\tcamera.position.copy( _lightPositionWorld );\n\n\t\t_lookTarget.copy( camera.position );\n\t\t_lookTarget.add( this._cubeDirections[ viewportIndex ] );\n\t\tcamera.up.copy( this._cubeUps[ viewportIndex ] );\n\t\tcamera.lookAt( _lookTarget );\n\t\tcamera.updateMatrixWorld();\n\n\t\tshadowMatrix.makeTranslation( - _lightPositionWorld.x, - _lightPositionWorld.y, - _lightPositionWorld.z );\n\n\t\t_projScreenMatrix$1.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\tthis._frustum.setFromProjectionMatrix( _projScreenMatrix$1 );\n\n\t}\n\n}\n\nclass PointLight extends Light {\n\n\tconstructor( color, intensity, distance = 0, decay = 2 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isPointLight = true;\n\n\t\tthis.type = 'PointLight';\n\n\t\tthis.distance = distance;\n\t\tthis.decay = decay;\n\n\t\tthis.shadow = new PointLightShadow();\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in candela)\n\t\t// for an isotropic light source, luminous power (lm) = 4 π luminous intensity (cd)\n\t\treturn this.intensity * 4 * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in candela) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( 4 * Math.PI );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.distance = source.distance;\n\t\tthis.decay = source.decay;\n\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass OrthographicCamera extends Camera {\n\n\tconstructor( left = - 1, right = 1, top = 1, bottom = - 1, near = 0.1, far = 2000 ) {\n\n\t\tsuper();\n\n\t\tthis.isOrthographicCamera = true;\n\n\t\tthis.type = 'OrthographicCamera';\n\n\t\tthis.zoom = 1;\n\t\tthis.view = null;\n\n\t\tthis.left = left;\n\t\tthis.right = right;\n\t\tthis.top = top;\n\t\tthis.bottom = bottom;\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.left = source.left;\n\t\tthis.right = source.right;\n\t\tthis.top = source.top;\n\t\tthis.bottom = source.bottom;\n\t\tthis.near = source.near;\n\t\tthis.far = source.far;\n\n\t\tthis.zoom = source.zoom;\n\t\tthis.view = source.view === null ? null : Object.assign( {}, source.view );\n\n\t\treturn this;\n\n\t}\n\n\tsetViewOffset( fullWidth, fullHeight, x, y, width, height ) {\n\n\t\tif ( this.view === null ) {\n\n\t\t\tthis.view = {\n\t\t\t\tenabled: true,\n\t\t\t\tfullWidth: 1,\n\t\t\t\tfullHeight: 1,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\twidth: 1,\n\t\t\t\theight: 1\n\t\t\t};\n\n\t\t}\n\n\t\tthis.view.enabled = true;\n\t\tthis.view.fullWidth = fullWidth;\n\t\tthis.view.fullHeight = fullHeight;\n\t\tthis.view.offsetX = x;\n\t\tthis.view.offsetY = y;\n\t\tthis.view.width = width;\n\t\tthis.view.height = height;\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tclearViewOffset() {\n\n\t\tif ( this.view !== null ) {\n\n\t\t\tthis.view.enabled = false;\n\n\t\t}\n\n\t\tthis.updateProjectionMatrix();\n\n\t}\n\n\tupdateProjectionMatrix() {\n\n\t\tconst dx = ( this.right - this.left ) / ( 2 * this.zoom );\n\t\tconst dy = ( this.top - this.bottom ) / ( 2 * this.zoom );\n\t\tconst cx = ( this.right + this.left ) / 2;\n\t\tconst cy = ( this.top + this.bottom ) / 2;\n\n\t\tlet left = cx - dx;\n\t\tlet right = cx + dx;\n\t\tlet top = cy + dy;\n\t\tlet bottom = cy - dy;\n\n\t\tif ( this.view !== null && this.view.enabled ) {\n\n\t\t\tconst scaleW = ( this.right - this.left ) / this.view.fullWidth / this.zoom;\n\t\t\tconst scaleH = ( this.top - this.bottom ) / this.view.fullHeight / this.zoom;\n\n\t\t\tleft += scaleW * this.view.offsetX;\n\t\t\tright = left + scaleW * this.view.width;\n\t\t\ttop -= scaleH * this.view.offsetY;\n\t\t\tbottom = top - scaleH * this.view.height;\n\n\t\t}\n\n\t\tthis.projectionMatrix.makeOrthographic( left, right, top, bottom, this.near, this.far, this.coordinateSystem );\n\n\t\tthis.projectionMatrixInverse.copy( this.projectionMatrix ).invert();\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.zoom = this.zoom;\n\t\tdata.object.left = this.left;\n\t\tdata.object.right = this.right;\n\t\tdata.object.top = this.top;\n\t\tdata.object.bottom = this.bottom;\n\t\tdata.object.near = this.near;\n\t\tdata.object.far = this.far;\n\n\t\tif ( this.view !== null ) data.object.view = Object.assign( {}, this.view );\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass DirectionalLightShadow extends LightShadow {\n\n\tconstructor() {\n\n\t\tsuper( new OrthographicCamera( - 5, 5, 5, - 5, 0.5, 500 ) );\n\n\t\tthis.isDirectionalLightShadow = true;\n\n\t}\n\n}\n\nclass DirectionalLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isDirectionalLight = true;\n\n\t\tthis.type = 'DirectionalLight';\n\n\t\tthis.position.copy( Object3D.DEFAULT_UP );\n\t\tthis.updateMatrix();\n\n\t\tthis.target = new Object3D();\n\n\t\tthis.shadow = new DirectionalLightShadow();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadow.dispose();\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.target = source.target.clone();\n\t\tthis.shadow = source.shadow.clone();\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass AmbientLight extends Light {\n\n\tconstructor( color, intensity ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isAmbientLight = true;\n\n\t\tthis.type = 'AmbientLight';\n\n\t}\n\n}\n\nclass RectAreaLight extends Light {\n\n\tconstructor( color, intensity, width = 10, height = 10 ) {\n\n\t\tsuper( color, intensity );\n\n\t\tthis.isRectAreaLight = true;\n\n\t\tthis.type = 'RectAreaLight';\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t}\n\n\tget power() {\n\n\t\t// compute the light's luminous power (in lumens) from its intensity (in nits)\n\t\treturn this.intensity * this.width * this.height * Math.PI;\n\n\t}\n\n\tset power( power ) {\n\n\t\t// set the light's intensity (in nits) from the desired luminous power (in lumens)\n\t\tthis.intensity = power / ( this.width * this.height * Math.PI );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.width = source.width;\n\t\tthis.height = source.height;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.width = this.width;\n\t\tdata.object.height = this.height;\n\n\t\treturn data;\n\n\t}\n\n}\n\n/**\n * Primary reference:\n *   https://graphics.stanford.edu/papers/envmap/envmap.pdf\n *\n * Secondary reference:\n *   https://www.ppsloan.org/publications/StupidSH36.pdf\n */\n\n// 3-band SH defined by 9 coefficients\n\nclass SphericalHarmonics3 {\n\n\tconstructor() {\n\n\t\tthis.isSphericalHarmonics3 = true;\n\n\t\tthis.coefficients = [];\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients.push( new Vector3() );\n\n\t\t}\n\n\t}\n\n\tset( coefficients ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].copy( coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tzero() {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].set( 0, 0, 0 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// get the radiance in the direction of the normal\n\t// target is a Vector3\n\tgetAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.282095 );\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 0.488603 * y );\n\t\ttarget.addScaledVector( coeff[ 2 ], 0.488603 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 0.488603 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 1.092548 * ( x * y ) );\n\t\ttarget.addScaledVector( coeff[ 5 ], 1.092548 * ( y * z ) );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.315392 * ( 3.0 * z * z - 1.0 ) );\n\t\ttarget.addScaledVector( coeff[ 7 ], 1.092548 * ( x * z ) );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.546274 * ( x * x - y * y ) );\n\n\t\treturn target;\n\n\t}\n\n\t// get the irradiance (radiance convolved with cosine lobe) in the direction of the normal\n\t// target is a Vector3\n\t// https://graphics.stanford.edu/papers/envmap/envmap.pdf\n\tgetIrradianceAt( normal, target ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\tconst coeff = this.coefficients;\n\n\t\t// band 0\n\t\ttarget.copy( coeff[ 0 ] ).multiplyScalar( 0.886227 ); // π * 0.282095\n\n\t\t// band 1\n\t\ttarget.addScaledVector( coeff[ 1 ], 2.0 * 0.511664 * y ); // ( 2 * π / 3 ) * 0.488603\n\t\ttarget.addScaledVector( coeff[ 2 ], 2.0 * 0.511664 * z );\n\t\ttarget.addScaledVector( coeff[ 3 ], 2.0 * 0.511664 * x );\n\n\t\t// band 2\n\t\ttarget.addScaledVector( coeff[ 4 ], 2.0 * 0.429043 * x * y ); // ( π / 4 ) * 1.092548\n\t\ttarget.addScaledVector( coeff[ 5 ], 2.0 * 0.429043 * y * z );\n\t\ttarget.addScaledVector( coeff[ 6 ], 0.743125 * z * z - 0.247708 ); // ( π / 4 ) * 0.315392 * 3\n\t\ttarget.addScaledVector( coeff[ 7 ], 2.0 * 0.429043 * x * z );\n\t\ttarget.addScaledVector( coeff[ 8 ], 0.429043 * ( x * x - y * y ) ); // ( π / 4 ) * 0.546274\n\n\t\treturn target;\n\n\t}\n\n\tadd( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].add( sh.coefficients[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\taddScaledSH( sh, s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].addScaledVector( sh.coefficients[ i ], s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tscale( s ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].multiplyScalar( s );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tlerp( sh, alpha ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.coefficients[ i ].lerp( sh.coefficients[ i ], alpha );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tequals( sh ) {\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tif ( ! this.coefficients[ i ].equals( sh.coefficients[ i ] ) ) {\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tcopy( sh ) {\n\n\t\treturn this.set( sh.coefficients );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].fromArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\ttoArray( array = [], offset = 0 ) {\n\n\t\tconst coefficients = this.coefficients;\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tcoefficients[ i ].toArray( array, offset + ( i * 3 ) );\n\n\t\t}\n\n\t\treturn array;\n\n\t}\n\n\t// evaluate the basis functions\n\t// shBasis is an Array[ 9 ]\n\tstatic getBasisAt( normal, shBasis ) {\n\n\t\t// normal is assumed to be unit length\n\n\t\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t\t// band 0\n\t\tshBasis[ 0 ] = 0.282095;\n\n\t\t// band 1\n\t\tshBasis[ 1 ] = 0.488603 * y;\n\t\tshBasis[ 2 ] = 0.488603 * z;\n\t\tshBasis[ 3 ] = 0.488603 * x;\n\n\t\t// band 2\n\t\tshBasis[ 4 ] = 1.092548 * x * y;\n\t\tshBasis[ 5 ] = 1.092548 * y * z;\n\t\tshBasis[ 6 ] = 0.315392 * ( 3 * z * z - 1 );\n\t\tshBasis[ 7 ] = 1.092548 * x * z;\n\t\tshBasis[ 8 ] = 0.546274 * ( x * x - y * y );\n\n\t}\n\n}\n\nclass LightProbe extends Light {\n\n\tconstructor( sh = new SphericalHarmonics3(), intensity = 1 ) {\n\n\t\tsuper( undefined, intensity );\n\n\t\tthis.isLightProbe = true;\n\n\t\tthis.sh = sh;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.sh.copy( source.sh );\n\n\t\treturn this;\n\n\t}\n\n\tfromJSON( json ) {\n\n\t\tthis.intensity = json.intensity; // TODO: Move this bit to Light.fromJSON();\n\t\tthis.sh.fromArray( json.sh );\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst data = super.toJSON( meta );\n\n\t\tdata.object.sh = this.sh.toArray();\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass MaterialLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\t\tthis.textures = {};\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst textures = this.textures;\n\n\t\tfunction getTexture( name ) {\n\n\t\t\tif ( textures[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.MaterialLoader: Undefined texture', name );\n\n\t\t\t}\n\n\t\t\treturn textures[ name ];\n\n\t\t}\n\n\t\tconst material = this.createMaterialFromType( json.type );\n\n\t\tif ( json.uuid !== undefined ) material.uuid = json.uuid;\n\t\tif ( json.name !== undefined ) material.name = json.name;\n\t\tif ( json.color !== undefined && material.color !== undefined ) material.color.setHex( json.color );\n\t\tif ( json.roughness !== undefined ) material.roughness = json.roughness;\n\t\tif ( json.metalness !== undefined ) material.metalness = json.metalness;\n\t\tif ( json.sheen !== undefined ) material.sheen = json.sheen;\n\t\tif ( json.sheenColor !== undefined ) material.sheenColor = new Color().setHex( json.sheenColor );\n\t\tif ( json.sheenRoughness !== undefined ) material.sheenRoughness = json.sheenRoughness;\n\t\tif ( json.emissive !== undefined && material.emissive !== undefined ) material.emissive.setHex( json.emissive );\n\t\tif ( json.specular !== undefined && material.specular !== undefined ) material.specular.setHex( json.specular );\n\t\tif ( json.specularIntensity !== undefined ) material.specularIntensity = json.specularIntensity;\n\t\tif ( json.specularColor !== undefined && material.specularColor !== undefined ) material.specularColor.setHex( json.specularColor );\n\t\tif ( json.shininess !== undefined ) material.shininess = json.shininess;\n\t\tif ( json.clearcoat !== undefined ) material.clearcoat = json.clearcoat;\n\t\tif ( json.clearcoatRoughness !== undefined ) material.clearcoatRoughness = json.clearcoatRoughness;\n\t\tif ( json.dispersion !== undefined ) material.dispersion = json.dispersion;\n\t\tif ( json.iridescence !== undefined ) material.iridescence = json.iridescence;\n\t\tif ( json.iridescenceIOR !== undefined ) material.iridescenceIOR = json.iridescenceIOR;\n\t\tif ( json.iridescenceThicknessRange !== undefined ) material.iridescenceThicknessRange = json.iridescenceThicknessRange;\n\t\tif ( json.transmission !== undefined ) material.transmission = json.transmission;\n\t\tif ( json.thickness !== undefined ) material.thickness = json.thickness;\n\t\tif ( json.attenuationDistance !== undefined ) material.attenuationDistance = json.attenuationDistance;\n\t\tif ( json.attenuationColor !== undefined && material.attenuationColor !== undefined ) material.attenuationColor.setHex( json.attenuationColor );\n\t\tif ( json.anisotropy !== undefined ) material.anisotropy = json.anisotropy;\n\t\tif ( json.anisotropyRotation !== undefined ) material.anisotropyRotation = json.anisotropyRotation;\n\t\tif ( json.fog !== undefined ) material.fog = json.fog;\n\t\tif ( json.flatShading !== undefined ) material.flatShading = json.flatShading;\n\t\tif ( json.blending !== undefined ) material.blending = json.blending;\n\t\tif ( json.combine !== undefined ) material.combine = json.combine;\n\t\tif ( json.side !== undefined ) material.side = json.side;\n\t\tif ( json.shadowSide !== undefined ) material.shadowSide = json.shadowSide;\n\t\tif ( json.opacity !== undefined ) material.opacity = json.opacity;\n\t\tif ( json.transparent !== undefined ) material.transparent = json.transparent;\n\t\tif ( json.alphaTest !== undefined ) material.alphaTest = json.alphaTest;\n\t\tif ( json.alphaHash !== undefined ) material.alphaHash = json.alphaHash;\n\t\tif ( json.depthFunc !== undefined ) material.depthFunc = json.depthFunc;\n\t\tif ( json.depthTest !== undefined ) material.depthTest = json.depthTest;\n\t\tif ( json.depthWrite !== undefined ) material.depthWrite = json.depthWrite;\n\t\tif ( json.colorWrite !== undefined ) material.colorWrite = json.colorWrite;\n\t\tif ( json.blendSrc !== undefined ) material.blendSrc = json.blendSrc;\n\t\tif ( json.blendDst !== undefined ) material.blendDst = json.blendDst;\n\t\tif ( json.blendEquation !== undefined ) material.blendEquation = json.blendEquation;\n\t\tif ( json.blendSrcAlpha !== undefined ) material.blendSrcAlpha = json.blendSrcAlpha;\n\t\tif ( json.blendDstAlpha !== undefined ) material.blendDstAlpha = json.blendDstAlpha;\n\t\tif ( json.blendEquationAlpha !== undefined ) material.blendEquationAlpha = json.blendEquationAlpha;\n\t\tif ( json.blendColor !== undefined && material.blendColor !== undefined ) material.blendColor.setHex( json.blendColor );\n\t\tif ( json.blendAlpha !== undefined ) material.blendAlpha = json.blendAlpha;\n\t\tif ( json.stencilWriteMask !== undefined ) material.stencilWriteMask = json.stencilWriteMask;\n\t\tif ( json.stencilFunc !== undefined ) material.stencilFunc = json.stencilFunc;\n\t\tif ( json.stencilRef !== undefined ) material.stencilRef = json.stencilRef;\n\t\tif ( json.stencilFuncMask !== undefined ) material.stencilFuncMask = json.stencilFuncMask;\n\t\tif ( json.stencilFail !== undefined ) material.stencilFail = json.stencilFail;\n\t\tif ( json.stencilZFail !== undefined ) material.stencilZFail = json.stencilZFail;\n\t\tif ( json.stencilZPass !== undefined ) material.stencilZPass = json.stencilZPass;\n\t\tif ( json.stencilWrite !== undefined ) material.stencilWrite = json.stencilWrite;\n\n\t\tif ( json.wireframe !== undefined ) material.wireframe = json.wireframe;\n\t\tif ( json.wireframeLinewidth !== undefined ) material.wireframeLinewidth = json.wireframeLinewidth;\n\t\tif ( json.wireframeLinecap !== undefined ) material.wireframeLinecap = json.wireframeLinecap;\n\t\tif ( json.wireframeLinejoin !== undefined ) material.wireframeLinejoin = json.wireframeLinejoin;\n\n\t\tif ( json.rotation !== undefined ) material.rotation = json.rotation;\n\n\t\tif ( json.linewidth !== undefined ) material.linewidth = json.linewidth;\n\t\tif ( json.dashSize !== undefined ) material.dashSize = json.dashSize;\n\t\tif ( json.gapSize !== undefined ) material.gapSize = json.gapSize;\n\t\tif ( json.scale !== undefined ) material.scale = json.scale;\n\n\t\tif ( json.polygonOffset !== undefined ) material.polygonOffset = json.polygonOffset;\n\t\tif ( json.polygonOffsetFactor !== undefined ) material.polygonOffsetFactor = json.polygonOffsetFactor;\n\t\tif ( json.polygonOffsetUnits !== undefined ) material.polygonOffsetUnits = json.polygonOffsetUnits;\n\n\t\tif ( json.dithering !== undefined ) material.dithering = json.dithering;\n\n\t\tif ( json.alphaToCoverage !== undefined ) material.alphaToCoverage = json.alphaToCoverage;\n\t\tif ( json.premultipliedAlpha !== undefined ) material.premultipliedAlpha = json.premultipliedAlpha;\n\t\tif ( json.forceSinglePass !== undefined ) material.forceSinglePass = json.forceSinglePass;\n\n\t\tif ( json.visible !== undefined ) material.visible = json.visible;\n\n\t\tif ( json.toneMapped !== undefined ) material.toneMapped = json.toneMapped;\n\n\t\tif ( json.userData !== undefined ) material.userData = json.userData;\n\n\t\tif ( json.vertexColors !== undefined ) {\n\n\t\t\tif ( typeof json.vertexColors === 'number' ) {\n\n\t\t\t\tmaterial.vertexColors = ( json.vertexColors > 0 ) ? true : false;\n\n\t\t\t} else {\n\n\t\t\t\tmaterial.vertexColors = json.vertexColors;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Shader Material\n\n\t\tif ( json.uniforms !== undefined ) {\n\n\t\t\tfor ( const name in json.uniforms ) {\n\n\t\t\t\tconst uniform = json.uniforms[ name ];\n\n\t\t\t\tmaterial.uniforms[ name ] = {};\n\n\t\t\t\tswitch ( uniform.type ) {\n\n\t\t\t\t\tcase 't':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = getTexture( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Color().setHex( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v2':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector2().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'v4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Vector4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm3':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix3().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'm4':\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = new Matrix4().fromArray( uniform.value );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmaterial.uniforms[ name ].value = uniform.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json.defines !== undefined ) material.defines = json.defines;\n\t\tif ( json.vertexShader !== undefined ) material.vertexShader = json.vertexShader;\n\t\tif ( json.fragmentShader !== undefined ) material.fragmentShader = json.fragmentShader;\n\t\tif ( json.glslVersion !== undefined ) material.glslVersion = json.glslVersion;\n\n\t\tif ( json.extensions !== undefined ) {\n\n\t\t\tfor ( const key in json.extensions ) {\n\n\t\t\t\tmaterial.extensions[ key ] = json.extensions[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json.lights !== undefined ) material.lights = json.lights;\n\t\tif ( json.clipping !== undefined ) material.clipping = json.clipping;\n\n\t\t// for PointsMaterial\n\n\t\tif ( json.size !== undefined ) material.size = json.size;\n\t\tif ( json.sizeAttenuation !== undefined ) material.sizeAttenuation = json.sizeAttenuation;\n\n\t\t// maps\n\n\t\tif ( json.map !== undefined ) material.map = getTexture( json.map );\n\t\tif ( json.matcap !== undefined ) material.matcap = getTexture( json.matcap );\n\n\t\tif ( json.alphaMap !== undefined ) material.alphaMap = getTexture( json.alphaMap );\n\n\t\tif ( json.bumpMap !== undefined ) material.bumpMap = getTexture( json.bumpMap );\n\t\tif ( json.bumpScale !== undefined ) material.bumpScale = json.bumpScale;\n\n\t\tif ( json.normalMap !== undefined ) material.normalMap = getTexture( json.normalMap );\n\t\tif ( json.normalMapType !== undefined ) material.normalMapType = json.normalMapType;\n\t\tif ( json.normalScale !== undefined ) {\n\n\t\t\tlet normalScale = json.normalScale;\n\n\t\t\tif ( Array.isArray( normalScale ) === false ) {\n\n\t\t\t\t// Blender exporter used to export a scalar. See #7459\n\n\t\t\t\tnormalScale = [ normalScale, normalScale ];\n\n\t\t\t}\n\n\t\t\tmaterial.normalScale = new Vector2().fromArray( normalScale );\n\n\t\t}\n\n\t\tif ( json.displacementMap !== undefined ) material.displacementMap = getTexture( json.displacementMap );\n\t\tif ( json.displacementScale !== undefined ) material.displacementScale = json.displacementScale;\n\t\tif ( json.displacementBias !== undefined ) material.displacementBias = json.displacementBias;\n\n\t\tif ( json.roughnessMap !== undefined ) material.roughnessMap = getTexture( json.roughnessMap );\n\t\tif ( json.metalnessMap !== undefined ) material.metalnessMap = getTexture( json.metalnessMap );\n\n\t\tif ( json.emissiveMap !== undefined ) material.emissiveMap = getTexture( json.emissiveMap );\n\t\tif ( json.emissiveIntensity !== undefined ) material.emissiveIntensity = json.emissiveIntensity;\n\n\t\tif ( json.specularMap !== undefined ) material.specularMap = getTexture( json.specularMap );\n\t\tif ( json.specularIntensityMap !== undefined ) material.specularIntensityMap = getTexture( json.specularIntensityMap );\n\t\tif ( json.specularColorMap !== undefined ) material.specularColorMap = getTexture( json.specularColorMap );\n\n\t\tif ( json.envMap !== undefined ) material.envMap = getTexture( json.envMap );\n\t\tif ( json.envMapRotation !== undefined ) material.envMapRotation.fromArray( json.envMapRotation );\n\t\tif ( json.envMapIntensity !== undefined ) material.envMapIntensity = json.envMapIntensity;\n\n\t\tif ( json.reflectivity !== undefined ) material.reflectivity = json.reflectivity;\n\t\tif ( json.refractionRatio !== undefined ) material.refractionRatio = json.refractionRatio;\n\n\t\tif ( json.lightMap !== undefined ) material.lightMap = getTexture( json.lightMap );\n\t\tif ( json.lightMapIntensity !== undefined ) material.lightMapIntensity = json.lightMapIntensity;\n\n\t\tif ( json.aoMap !== undefined ) material.aoMap = getTexture( json.aoMap );\n\t\tif ( json.aoMapIntensity !== undefined ) material.aoMapIntensity = json.aoMapIntensity;\n\n\t\tif ( json.gradientMap !== undefined ) material.gradientMap = getTexture( json.gradientMap );\n\n\t\tif ( json.clearcoatMap !== undefined ) material.clearcoatMap = getTexture( json.clearcoatMap );\n\t\tif ( json.clearcoatRoughnessMap !== undefined ) material.clearcoatRoughnessMap = getTexture( json.clearcoatRoughnessMap );\n\t\tif ( json.clearcoatNormalMap !== undefined ) material.clearcoatNormalMap = getTexture( json.clearcoatNormalMap );\n\t\tif ( json.clearcoatNormalScale !== undefined ) material.clearcoatNormalScale = new Vector2().fromArray( json.clearcoatNormalScale );\n\n\t\tif ( json.iridescenceMap !== undefined ) material.iridescenceMap = getTexture( json.iridescenceMap );\n\t\tif ( json.iridescenceThicknessMap !== undefined ) material.iridescenceThicknessMap = getTexture( json.iridescenceThicknessMap );\n\n\t\tif ( json.transmissionMap !== undefined ) material.transmissionMap = getTexture( json.transmissionMap );\n\t\tif ( json.thicknessMap !== undefined ) material.thicknessMap = getTexture( json.thicknessMap );\n\n\t\tif ( json.anisotropyMap !== undefined ) material.anisotropyMap = getTexture( json.anisotropyMap );\n\n\t\tif ( json.sheenColorMap !== undefined ) material.sheenColorMap = getTexture( json.sheenColorMap );\n\t\tif ( json.sheenRoughnessMap !== undefined ) material.sheenRoughnessMap = getTexture( json.sheenRoughnessMap );\n\n\t\treturn material;\n\n\t}\n\n\tsetTextures( value ) {\n\n\t\tthis.textures = value;\n\t\treturn this;\n\n\t}\n\n\tcreateMaterialFromType( type ) {\n\n\t\treturn MaterialLoader.createMaterialFromType( type );\n\n\t}\n\n\tstatic createMaterialFromType( type ) {\n\n\t\tconst materialLib = {\n\t\t\tShadowMaterial,\n\t\t\tSpriteMaterial,\n\t\t\tRawShaderMaterial,\n\t\t\tShaderMaterial,\n\t\t\tPointsMaterial,\n\t\t\tMeshPhysicalMaterial,\n\t\t\tMeshStandardMaterial,\n\t\t\tMeshPhongMaterial,\n\t\t\tMeshToonMaterial,\n\t\t\tMeshNormalMaterial,\n\t\t\tMeshLambertMaterial,\n\t\t\tMeshDepthMaterial,\n\t\t\tMeshDistanceMaterial,\n\t\t\tMeshBasicMaterial,\n\t\t\tMeshMatcapMaterial,\n\t\t\tLineDashedMaterial,\n\t\t\tLineBasicMaterial,\n\t\t\tMaterial\n\t\t};\n\n\t\treturn new materialLib[ type ]();\n\n\t}\n\n}\n\nclass LoaderUtils {\n\n\tstatic decodeText( array ) { // @deprecated, r165\n\n\t\tconsole.warn( 'THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead.' );\n\n\t\tif ( typeof TextDecoder !== 'undefined' ) {\n\n\t\t\treturn new TextDecoder().decode( array );\n\n\t\t}\n\n\t\t// Avoid the String.fromCharCode.apply(null, array) shortcut, which\n\t\t// throws a \"maximum call stack size exceeded\" error for large arrays.\n\n\t\tlet s = '';\n\n\t\tfor ( let i = 0, il = array.length; i < il; i ++ ) {\n\n\t\t\t// Implicitly assumes little-endian.\n\t\t\ts += String.fromCharCode( array[ i ] );\n\n\t\t}\n\n\t\ttry {\n\n\t\t\t// merges multi-byte utf-8 characters.\n\n\t\t\treturn decodeURIComponent( escape( s ) );\n\n\t\t} catch ( e ) { // see #16358\n\n\t\t\treturn s;\n\n\t\t}\n\n\t}\n\n\tstatic extractUrlBase( url ) {\n\n\t\tconst index = url.lastIndexOf( '/' );\n\n\t\tif ( index === - 1 ) return './';\n\n\t\treturn url.slice( 0, index + 1 );\n\n\t}\n\n\tstatic resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n}\n\nclass InstancedBufferGeometry extends BufferGeometry {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isInstancedBufferGeometry = true;\n\n\t\tthis.type = 'InstancedBufferGeometry';\n\t\tthis.instanceCount = Infinity;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.instanceCount = source.instanceCount;\n\n\t\treturn this;\n\n\t}\n\n\ttoJSON() {\n\n\t\tconst data = super.toJSON();\n\n\t\tdata.instanceCount = this.instanceCount;\n\n\t\tdata.isInstancedBufferGeometry = true;\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass BufferGeometryLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( scope.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst interleavedBufferMap = {};\n\t\tconst arrayBufferMap = {};\n\n\t\tfunction getInterleavedBuffer( json, uuid ) {\n\n\t\t\tif ( interleavedBufferMap[ uuid ] !== undefined ) return interleavedBufferMap[ uuid ];\n\n\t\t\tconst interleavedBuffers = json.interleavedBuffers;\n\t\t\tconst interleavedBuffer = interleavedBuffers[ uuid ];\n\n\t\t\tconst buffer = getArrayBuffer( json, interleavedBuffer.buffer );\n\n\t\t\tconst array = getTypedArray( interleavedBuffer.type, buffer );\n\t\t\tconst ib = new InterleavedBuffer( array, interleavedBuffer.stride );\n\t\t\tib.uuid = interleavedBuffer.uuid;\n\n\t\t\tinterleavedBufferMap[ uuid ] = ib;\n\n\t\t\treturn ib;\n\n\t\t}\n\n\t\tfunction getArrayBuffer( json, uuid ) {\n\n\t\t\tif ( arrayBufferMap[ uuid ] !== undefined ) return arrayBufferMap[ uuid ];\n\n\t\t\tconst arrayBuffers = json.arrayBuffers;\n\t\t\tconst arrayBuffer = arrayBuffers[ uuid ];\n\n\t\t\tconst ab = new Uint32Array( arrayBuffer ).buffer;\n\n\t\t\tarrayBufferMap[ uuid ] = ab;\n\n\t\t\treturn ab;\n\n\t\t}\n\n\t\tconst geometry = json.isInstancedBufferGeometry ? new InstancedBufferGeometry() : new BufferGeometry();\n\n\t\tconst index = json.data.index;\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst typedArray = getTypedArray( index.type, index.array );\n\t\t\tgeometry.setIndex( new BufferAttribute( typedArray, 1 ) );\n\n\t\t}\n\n\t\tconst attributes = json.data.attributes;\n\n\t\tfor ( const key in attributes ) {\n\n\t\t\tconst attribute = attributes[ key ];\n\t\t\tlet bufferAttribute;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t} else {\n\n\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\tconst bufferAttributeConstr = attribute.isInstancedBufferAttribute ? InstancedBufferAttribute : BufferAttribute;\n\t\t\t\tbufferAttribute = new bufferAttributeConstr( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t}\n\n\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\tif ( attribute.usage !== undefined ) bufferAttribute.setUsage( attribute.usage );\n\n\t\t\tgeometry.setAttribute( key, bufferAttribute );\n\n\t\t}\n\n\t\tconst morphAttributes = json.data.morphAttributes;\n\n\t\tif ( morphAttributes ) {\n\n\t\t\tfor ( const key in morphAttributes ) {\n\n\t\t\t\tconst attributeArray = morphAttributes[ key ];\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst attribute = attributeArray[ i ];\n\t\t\t\t\tlet bufferAttribute;\n\n\t\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\t\t\tconst interleavedBuffer = getInterleavedBuffer( json.data, attribute.data );\n\t\t\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( interleavedBuffer, attribute.itemSize, attribute.offset, attribute.normalized );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst typedArray = getTypedArray( attribute.type, attribute.array );\n\t\t\t\t\t\tbufferAttribute = new BufferAttribute( typedArray, attribute.itemSize, attribute.normalized );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attribute.name !== undefined ) bufferAttribute.name = attribute.name;\n\t\t\t\t\tarray.push( bufferAttribute );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.morphAttributes[ key ] = array;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst morphTargetsRelative = json.data.morphTargetsRelative;\n\n\t\tif ( morphTargetsRelative ) {\n\n\t\t\tgeometry.morphTargetsRelative = true;\n\n\t\t}\n\n\t\tconst groups = json.data.groups || json.data.drawcalls || json.data.offsets;\n\n\t\tif ( groups !== undefined ) {\n\n\t\t\tfor ( let i = 0, n = groups.length; i !== n; ++ i ) {\n\n\t\t\t\tconst group = groups[ i ];\n\n\t\t\t\tgeometry.addGroup( group.start, group.count, group.materialIndex );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst boundingSphere = json.data.boundingSphere;\n\n\t\tif ( boundingSphere !== undefined ) {\n\n\t\t\tconst center = new Vector3();\n\n\t\t\tif ( boundingSphere.center !== undefined ) {\n\n\t\t\t\tcenter.fromArray( boundingSphere.center );\n\n\t\t\t}\n\n\t\t\tgeometry.boundingSphere = new Sphere( center, boundingSphere.radius );\n\n\t\t}\n\n\t\tif ( json.name ) geometry.name = json.name;\n\t\tif ( json.userData ) geometry.userData = json.userData;\n\n\t\treturn geometry;\n\n\t}\n\n}\n\nclass ObjectLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( text ) {\n\n\t\t\tlet json = null;\n\n\t\t\ttry {\n\n\t\t\t\tjson = JSON.parse( text );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( error );\n\n\t\t\t\tconsole.error( 'THREE:ObjectLoader: Can\\'t parse ' + url + '.', error.message );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tconst metadata = json.metadata;\n\n\t\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\t\tif ( onError !== undefined ) onError( new Error( 'THREE.ObjectLoader: Can\\'t load ' + url ) );\n\n\t\t\t\tconsole.error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tscope.parse( json, onLoad );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tasync loadAsync( url, onProgress ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( this.path === '' ) ? LoaderUtils.extractUrlBase( url ) : this.path;\n\t\tthis.resourcePath = this.resourcePath || path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tconst text = await loader.loadAsync( url, onProgress );\n\n\t\tconst json = JSON.parse( text );\n\n\t\tconst metadata = json.metadata;\n\n\t\tif ( metadata === undefined || metadata.type === undefined || metadata.type.toLowerCase() === 'geometry' ) {\n\n\t\t\tthrow new Error( 'THREE.ObjectLoader: Can\\'t load ' + url );\n\n\t\t}\n\n\t\treturn await scope.parseAsync( json );\n\n\t}\n\n\tparse( json, onLoad ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = this.parseImages( json.images, function () {\n\n\t\t\tif ( onLoad !== undefined ) onLoad( object );\n\n\t\t} );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\t\tthis.bindLightTargets( object );\n\n\t\t//\n\n\t\tif ( onLoad !== undefined ) {\n\n\t\t\tlet hasImages = false;\n\n\t\t\tfor ( const uuid in images ) {\n\n\t\t\t\tif ( images[ uuid ].data instanceof HTMLImageElement ) {\n\n\t\t\t\t\thasImages = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( hasImages === false ) onLoad( object );\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tasync parseAsync( json ) {\n\n\t\tconst animations = this.parseAnimations( json.animations );\n\t\tconst shapes = this.parseShapes( json.shapes );\n\t\tconst geometries = this.parseGeometries( json.geometries, shapes );\n\n\t\tconst images = await this.parseImagesAsync( json.images );\n\n\t\tconst textures = this.parseTextures( json.textures, images );\n\t\tconst materials = this.parseMaterials( json.materials, textures );\n\n\t\tconst object = this.parseObject( json.object, geometries, materials, textures, animations );\n\t\tconst skeletons = this.parseSkeletons( json.skeletons, object );\n\n\t\tthis.bindSkeletons( object, skeletons );\n\t\tthis.bindLightTargets( object );\n\n\t\treturn object;\n\n\t}\n\n\tparseShapes( json ) {\n\n\t\tconst shapes = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst shape = new Shape().fromJSON( json[ i ] );\n\n\t\t\t\tshapes[ shape.uuid ] = shape;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn shapes;\n\n\t}\n\n\tparseSkeletons( json, object ) {\n\n\t\tconst skeletons = {};\n\t\tconst bones = {};\n\n\t\t// generate bone lookup table\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isBone ) bones[ child.uuid ] = child;\n\n\t\t} );\n\n\t\t// create skeletons\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst skeleton = new Skeleton().fromJSON( json[ i ], bones );\n\n\t\t\t\tskeletons[ skeleton.uuid ] = skeleton;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn skeletons;\n\n\t}\n\n\tparseGeometries( json, shapes ) {\n\n\t\tconst geometries = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst bufferGeometryLoader = new BufferGeometryLoader();\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tlet geometry;\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tswitch ( data.type ) {\n\n\t\t\t\t\tcase 'BufferGeometry':\n\t\t\t\t\tcase 'InstancedBufferGeometry':\n\n\t\t\t\t\t\tgeometry = bufferGeometryLoader.parse( data );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( data.type in Geometries$1 ) {\n\n\t\t\t\t\t\t\tgeometry = Geometries$1[ data.type ].fromJSON( data, shapes );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( `THREE.ObjectLoader: Unsupported geometry type \"${ data.type }\"` );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) geometry.name = data.name;\n\t\t\t\tif ( data.userData !== undefined ) geometry.userData = data.userData;\n\n\t\t\t\tgeometries[ data.uuid ] = geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn geometries;\n\n\t}\n\n\tparseMaterials( json, textures ) {\n\n\t\tconst cache = {}; // MultiMaterial\n\t\tconst materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst loader = new MaterialLoader();\n\t\t\tloader.setTextures( textures );\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( cache[ data.uuid ] === undefined ) {\n\n\t\t\t\t\tcache[ data.uuid ] = loader.parse( data );\n\n\t\t\t\t}\n\n\t\t\t\tmaterials[ data.uuid ] = cache[ data.uuid ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t}\n\n\tparseAnimations( json ) {\n\n\t\tconst animations = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < json.length; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tconst clip = AnimationClip.parse( data );\n\n\t\t\t\tanimations[ clip.uuid ] = clip;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animations;\n\n\t}\n\n\tparseImages( json, onLoad ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tfunction loadImage( url ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\treturn loader.load( url, function () {\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, undefined, function () {\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t} );\n\n\t\t}\n\n\t\tfunction deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn loadImage( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tconst manager = new LoadingManager( onLoad );\n\n\t\t\tloader = new ImageLoader( manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\tconst imageArray = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timageArray.push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timageArray.push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\timages[ image.uuid ] = new Source( imageArray );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = deserializeImage( image.url );\n\t\t\t\t\timages[ image.uuid ] = new Source( deserializedImage );\n\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tasync parseImagesAsync( json ) {\n\n\t\tconst scope = this;\n\t\tconst images = {};\n\n\t\tlet loader;\n\n\t\tasync function deserializeImage( image ) {\n\n\t\t\tif ( typeof image === 'string' ) {\n\n\t\t\t\tconst url = image;\n\n\t\t\t\tconst path = /^(\\/\\/)|([a-z]+:(\\/\\/)?)/i.test( url ) ? url : scope.resourcePath + url;\n\n\t\t\t\treturn await loader.loadAsync( path );\n\n\t\t\t} else {\n\n\t\t\t\tif ( image.data ) {\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdata: getTypedArray( image.type, image.data ),\n\t\t\t\t\t\twidth: image.width,\n\t\t\t\t\t\theight: image.height\n\t\t\t\t\t};\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( json !== undefined && json.length > 0 ) {\n\n\t\t\tloader = new ImageLoader( this.manager );\n\t\t\tloader.setCrossOrigin( this.crossOrigin );\n\n\t\t\tfor ( let i = 0, il = json.length; i < il; i ++ ) {\n\n\t\t\t\tconst image = json[ i ];\n\t\t\t\tconst url = image.url;\n\n\t\t\t\tif ( Array.isArray( url ) ) {\n\n\t\t\t\t\t// load array of images e.g CubeTexture\n\n\t\t\t\t\tconst imageArray = [];\n\n\t\t\t\t\tfor ( let j = 0, jl = url.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tconst currentUrl = url[ j ];\n\n\t\t\t\t\t\tconst deserializedImage = await deserializeImage( currentUrl );\n\n\t\t\t\t\t\tif ( deserializedImage !== null ) {\n\n\t\t\t\t\t\t\tif ( deserializedImage instanceof HTMLImageElement ) {\n\n\t\t\t\t\t\t\t\timageArray.push( deserializedImage );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// special case: handle array of data textures for cube textures\n\n\t\t\t\t\t\t\t\timageArray.push( new DataTexture( deserializedImage.data, deserializedImage.width, deserializedImage.height ) );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\timages[ image.uuid ] = new Source( imageArray );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// load single image\n\n\t\t\t\t\tconst deserializedImage = await deserializeImage( image.url );\n\t\t\t\t\timages[ image.uuid ] = new Source( deserializedImage );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\tparseTextures( json, images ) {\n\n\t\tfunction parseConstant( value, type ) {\n\n\t\t\tif ( typeof value === 'number' ) return value;\n\n\t\t\tconsole.warn( 'THREE.ObjectLoader.parseTexture: Constant should be in numeric form.', value );\n\n\t\t\treturn type[ value ];\n\n\t\t}\n\n\t\tconst textures = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tif ( data.image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No \"image\" specified for', data.uuid );\n\n\t\t\t\t}\n\n\t\t\t\tif ( images[ data.image ] === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined image', data.image );\n\n\t\t\t\t}\n\n\t\t\t\tconst source = images[ data.image ];\n\t\t\t\tconst image = source.data;\n\n\t\t\t\tlet texture;\n\n\t\t\t\tif ( Array.isArray( image ) ) {\n\n\t\t\t\t\ttexture = new CubeTexture();\n\n\t\t\t\t\tif ( image.length === 6 ) texture.needsUpdate = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( image && image.data ) {\n\n\t\t\t\t\t\ttexture = new DataTexture();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttexture = new Texture();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( image ) texture.needsUpdate = true; // textures can have undefined image data\n\n\t\t\t\t}\n\n\t\t\t\ttexture.source = source;\n\n\t\t\t\ttexture.uuid = data.uuid;\n\n\t\t\t\tif ( data.name !== undefined ) texture.name = data.name;\n\n\t\t\t\tif ( data.mapping !== undefined ) texture.mapping = parseConstant( data.mapping, TEXTURE_MAPPING );\n\t\t\t\tif ( data.channel !== undefined ) texture.channel = data.channel;\n\n\t\t\t\tif ( data.offset !== undefined ) texture.offset.fromArray( data.offset );\n\t\t\t\tif ( data.repeat !== undefined ) texture.repeat.fromArray( data.repeat );\n\t\t\t\tif ( data.center !== undefined ) texture.center.fromArray( data.center );\n\t\t\t\tif ( data.rotation !== undefined ) texture.rotation = data.rotation;\n\n\t\t\t\tif ( data.wrap !== undefined ) {\n\n\t\t\t\t\ttexture.wrapS = parseConstant( data.wrap[ 0 ], TEXTURE_WRAPPING );\n\t\t\t\t\ttexture.wrapT = parseConstant( data.wrap[ 1 ], TEXTURE_WRAPPING );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.format !== undefined ) texture.format = data.format;\n\t\t\t\tif ( data.internalFormat !== undefined ) texture.internalFormat = data.internalFormat;\n\t\t\t\tif ( data.type !== undefined ) texture.type = data.type;\n\t\t\t\tif ( data.colorSpace !== undefined ) texture.colorSpace = data.colorSpace;\n\n\t\t\t\tif ( data.minFilter !== undefined ) texture.minFilter = parseConstant( data.minFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.magFilter !== undefined ) texture.magFilter = parseConstant( data.magFilter, TEXTURE_FILTER );\n\t\t\t\tif ( data.anisotropy !== undefined ) texture.anisotropy = data.anisotropy;\n\n\t\t\t\tif ( data.flipY !== undefined ) texture.flipY = data.flipY;\n\n\t\t\t\tif ( data.generateMipmaps !== undefined ) texture.generateMipmaps = data.generateMipmaps;\n\t\t\t\tif ( data.premultiplyAlpha !== undefined ) texture.premultiplyAlpha = data.premultiplyAlpha;\n\t\t\t\tif ( data.unpackAlignment !== undefined ) texture.unpackAlignment = data.unpackAlignment;\n\t\t\t\tif ( data.compareFunction !== undefined ) texture.compareFunction = data.compareFunction;\n\n\t\t\t\tif ( data.userData !== undefined ) texture.userData = data.userData;\n\n\t\t\t\ttextures[ data.uuid ] = texture;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textures;\n\n\t}\n\n\tparseObject( data, geometries, materials, textures, animations ) {\n\n\t\tlet object;\n\n\t\tfunction getGeometry( name ) {\n\n\t\t\tif ( geometries[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined geometry', name );\n\n\t\t\t}\n\n\t\t\treturn geometries[ name ];\n\n\t\t}\n\n\t\tfunction getMaterial( name ) {\n\n\t\t\tif ( name === undefined ) return undefined;\n\n\t\t\tif ( Array.isArray( name ) ) {\n\n\t\t\t\tconst array = [];\n\n\t\t\t\tfor ( let i = 0, l = name.length; i < l; i ++ ) {\n\n\t\t\t\t\tconst uuid = name[ i ];\n\n\t\t\t\t\tif ( materials[ uuid ] === undefined ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', uuid );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tarray.push( materials[ uuid ] );\n\n\t\t\t\t}\n\n\t\t\t\treturn array;\n\n\t\t\t}\n\n\t\t\tif ( materials[ name ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined material', name );\n\n\t\t\t}\n\n\t\t\treturn materials[ name ];\n\n\t\t}\n\n\t\tfunction getTexture( uuid ) {\n\n\t\t\tif ( textures[ uuid ] === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.ObjectLoader: Undefined texture', uuid );\n\n\t\t\t}\n\n\t\t\treturn textures[ uuid ];\n\n\t\t}\n\n\t\tlet geometry, material;\n\n\t\tswitch ( data.type ) {\n\n\t\t\tcase 'Scene':\n\n\t\t\t\tobject = new Scene();\n\n\t\t\t\tif ( data.background !== undefined ) {\n\n\t\t\t\t\tif ( Number.isInteger( data.background ) ) {\n\n\t\t\t\t\t\tobject.background = new Color( data.background );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tobject.background = getTexture( data.background );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.environment !== undefined ) {\n\n\t\t\t\t\tobject.environment = getTexture( data.environment );\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.fog !== undefined ) {\n\n\t\t\t\t\tif ( data.fog.type === 'Fog' ) {\n\n\t\t\t\t\t\tobject.fog = new Fog( data.fog.color, data.fog.near, data.fog.far );\n\n\t\t\t\t\t} else if ( data.fog.type === 'FogExp2' ) {\n\n\t\t\t\t\t\tobject.fog = new FogExp2( data.fog.color, data.fog.density );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( data.fog.name !== '' ) {\n\n\t\t\t\t\t\tobject.fog.name = data.fog.name;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( data.backgroundBlurriness !== undefined ) object.backgroundBlurriness = data.backgroundBlurriness;\n\t\t\t\tif ( data.backgroundIntensity !== undefined ) object.backgroundIntensity = data.backgroundIntensity;\n\t\t\t\tif ( data.backgroundRotation !== undefined ) object.backgroundRotation.fromArray( data.backgroundRotation );\n\n\t\t\t\tif ( data.environmentIntensity !== undefined ) object.environmentIntensity = data.environmentIntensity;\n\t\t\t\tif ( data.environmentRotation !== undefined ) object.environmentRotation.fromArray( data.environmentRotation );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PerspectiveCamera':\n\n\t\t\t\tobject = new PerspectiveCamera( data.fov, data.aspect, data.near, data.far );\n\n\t\t\t\tif ( data.focus !== undefined ) object.focus = data.focus;\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.filmGauge !== undefined ) object.filmGauge = data.filmGauge;\n\t\t\t\tif ( data.filmOffset !== undefined ) object.filmOffset = data.filmOffset;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'OrthographicCamera':\n\n\t\t\t\tobject = new OrthographicCamera( data.left, data.right, data.top, data.bottom, data.near, data.far );\n\n\t\t\t\tif ( data.zoom !== undefined ) object.zoom = data.zoom;\n\t\t\t\tif ( data.view !== undefined ) object.view = Object.assign( {}, data.view );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'AmbientLight':\n\n\t\t\t\tobject = new AmbientLight( data.color, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'DirectionalLight':\n\n\t\t\t\tobject = new DirectionalLight( data.color, data.intensity );\n\t\t\t\tobject.target = data.target || '';\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointLight':\n\n\t\t\t\tobject = new PointLight( data.color, data.intensity, data.distance, data.decay );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'RectAreaLight':\n\n\t\t\t\tobject = new RectAreaLight( data.color, data.intensity, data.width, data.height );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SpotLight':\n\n\t\t\t\tobject = new SpotLight( data.color, data.intensity, data.distance, data.angle, data.penumbra, data.decay );\n\t\t\t\tobject.target = data.target || '';\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'HemisphereLight':\n\n\t\t\t\tobject = new HemisphereLight( data.color, data.groundColor, data.intensity );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LightProbe':\n\n\t\t\t\tobject = new LightProbe().fromJSON( data );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'SkinnedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t \tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new SkinnedMesh( geometry, material );\n\n\t\t\t\tif ( data.bindMode !== undefined ) object.bindMode = data.bindMode;\n\t\t\t\tif ( data.bindMatrix !== undefined ) object.bindMatrix.fromArray( data.bindMatrix );\n\t\t\t\tif ( data.skeleton !== undefined ) object.skeleton = data.skeleton;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Mesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new Mesh( geometry, material );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'InstancedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\t\t\t\tconst count = data.count;\n\t\t\t\tconst instanceMatrix = data.instanceMatrix;\n\t\t\t\tconst instanceColor = data.instanceColor;\n\n\t\t\t\tobject = new InstancedMesh( geometry, material, count );\n\t\t\t\tobject.instanceMatrix = new InstancedBufferAttribute( new Float32Array( instanceMatrix.array ), 16 );\n\t\t\t\tif ( instanceColor !== undefined ) object.instanceColor = new InstancedBufferAttribute( new Float32Array( instanceColor.array ), instanceColor.itemSize );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'BatchedMesh':\n\n\t\t\t\tgeometry = getGeometry( data.geometry );\n\t\t\t\tmaterial = getMaterial( data.material );\n\n\t\t\t\tobject = new BatchedMesh( data.maxInstanceCount, data.maxVertexCount, data.maxIndexCount, material );\n\t\t\t\tobject.geometry = geometry;\n\t\t\t\tobject.perObjectFrustumCulled = data.perObjectFrustumCulled;\n\t\t\t\tobject.sortObjects = data.sortObjects;\n\n\t\t\t\tobject._drawRanges = data.drawRanges;\n\t\t\t\tobject._reservedRanges = data.reservedRanges;\n\n\t\t\t\tobject._visibility = data.visibility;\n\t\t\t\tobject._active = data.active;\n\t\t\t\tobject._bounds = data.bounds.map( bound => {\n\n\t\t\t\t\tconst box = new Box3();\n\t\t\t\t\tbox.min.fromArray( bound.boxMin );\n\t\t\t\t\tbox.max.fromArray( bound.boxMax );\n\n\t\t\t\t\tconst sphere = new Sphere();\n\t\t\t\t\tsphere.radius = bound.sphereRadius;\n\t\t\t\t\tsphere.center.fromArray( bound.sphereCenter );\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tboxInitialized: bound.boxInitialized,\n\t\t\t\t\t\tbox: box,\n\n\t\t\t\t\t\tsphereInitialized: bound.sphereInitialized,\n\t\t\t\t\t\tsphere: sphere\n\t\t\t\t\t};\n\n\t\t\t\t} );\n\n\t\t\t\tobject._maxInstanceCount = data.maxInstanceCount;\n\t\t\t\tobject._maxVertexCount = data.maxVertexCount;\n\t\t\t\tobject._maxIndexCount = data.maxIndexCount;\n\n\t\t\t\tobject._geometryInitialized = data.geometryInitialized;\n\t\t\t\tobject._geometryCount = data.geometryCount;\n\n\t\t\t\tobject._matricesTexture = getTexture( data.matricesTexture.uuid );\n\t\t\t\tif ( data.colorsTexture !== undefined ) object._colorsTexture = getTexture( data.colorsTexture.uuid );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LOD':\n\n\t\t\t\tobject = new LOD();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Line':\n\n\t\t\t\tobject = new Line( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineLoop':\n\n\t\t\t\tobject = new LineLoop( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'LineSegments':\n\n\t\t\t\tobject = new LineSegments( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'PointCloud':\n\t\t\tcase 'Points':\n\n\t\t\t\tobject = new Points( getGeometry( data.geometry ), getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Sprite':\n\n\t\t\t\tobject = new Sprite( getMaterial( data.material ) );\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Group':\n\n\t\t\t\tobject = new Group();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'Bone':\n\n\t\t\t\tobject = new Bone();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tobject = new Object3D();\n\n\t\t}\n\n\t\tobject.uuid = data.uuid;\n\n\t\tif ( data.name !== undefined ) object.name = data.name;\n\n\t\tif ( data.matrix !== undefined ) {\n\n\t\t\tobject.matrix.fromArray( data.matrix );\n\n\t\t\tif ( data.matrixAutoUpdate !== undefined ) object.matrixAutoUpdate = data.matrixAutoUpdate;\n\t\t\tif ( object.matrixAutoUpdate ) object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n\t\t} else {\n\n\t\t\tif ( data.position !== undefined ) object.position.fromArray( data.position );\n\t\t\tif ( data.rotation !== undefined ) object.rotation.fromArray( data.rotation );\n\t\t\tif ( data.quaternion !== undefined ) object.quaternion.fromArray( data.quaternion );\n\t\t\tif ( data.scale !== undefined ) object.scale.fromArray( data.scale );\n\n\t\t}\n\n\t\tif ( data.up !== undefined ) object.up.fromArray( data.up );\n\n\t\tif ( data.castShadow !== undefined ) object.castShadow = data.castShadow;\n\t\tif ( data.receiveShadow !== undefined ) object.receiveShadow = data.receiveShadow;\n\n\t\tif ( data.shadow ) {\n\n\t\t\tif ( data.shadow.intensity !== undefined ) object.shadow.intensity = data.shadow.intensity;\n\t\t\tif ( data.shadow.bias !== undefined ) object.shadow.bias = data.shadow.bias;\n\t\t\tif ( data.shadow.normalBias !== undefined ) object.shadow.normalBias = data.shadow.normalBias;\n\t\t\tif ( data.shadow.radius !== undefined ) object.shadow.radius = data.shadow.radius;\n\t\t\tif ( data.shadow.mapSize !== undefined ) object.shadow.mapSize.fromArray( data.shadow.mapSize );\n\t\t\tif ( data.shadow.camera !== undefined ) object.shadow.camera = this.parseObject( data.shadow.camera );\n\n\t\t}\n\n\t\tif ( data.visible !== undefined ) object.visible = data.visible;\n\t\tif ( data.frustumCulled !== undefined ) object.frustumCulled = data.frustumCulled;\n\t\tif ( data.renderOrder !== undefined ) object.renderOrder = data.renderOrder;\n\t\tif ( data.userData !== undefined ) object.userData = data.userData;\n\t\tif ( data.layers !== undefined ) object.layers.mask = data.layers;\n\n\t\tif ( data.children !== undefined ) {\n\n\t\t\tconst children = data.children;\n\n\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\tobject.add( this.parseObject( children[ i ], geometries, materials, textures, animations ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.animations !== undefined ) {\n\n\t\t\tconst objectAnimations = data.animations;\n\n\t\t\tfor ( let i = 0; i < objectAnimations.length; i ++ ) {\n\n\t\t\t\tconst uuid = objectAnimations[ i ];\n\n\t\t\t\tobject.animations.push( animations[ uuid ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( data.type === 'LOD' ) {\n\n\t\t\tif ( data.autoUpdate !== undefined ) object.autoUpdate = data.autoUpdate;\n\n\t\t\tconst levels = data.levels;\n\n\t\t\tfor ( let l = 0; l < levels.length; l ++ ) {\n\n\t\t\t\tconst level = levels[ l ];\n\t\t\t\tconst child = object.getObjectByProperty( 'uuid', level.object );\n\n\t\t\t\tif ( child !== undefined ) {\n\n\t\t\t\t\tobject.addLevel( child, level.distance, level.hysteresis );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn object;\n\n\t}\n\n\tbindSkeletons( object, skeletons ) {\n\n\t\tif ( Object.keys( skeletons ).length === 0 ) return;\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isSkinnedMesh === true && child.skeleton !== undefined ) {\n\n\t\t\t\tconst skeleton = skeletons[ child.skeleton ];\n\n\t\t\t\tif ( skeleton === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.ObjectLoader: No skeleton found with UUID:', child.skeleton );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tchild.bind( skeleton, child.bindMatrix );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tbindLightTargets( object ) {\n\n\t\tobject.traverse( function ( child ) {\n\n\t\t\tif ( child.isDirectionalLight || child.isSpotLight ) {\n\n\t\t\t\tconst uuid = child.target;\n\n\t\t\t\tconst target = object.getObjectByProperty( 'uuid', uuid );\n\n\t\t\t\tif ( target !== undefined ) {\n\n\t\t\t\t\tchild.target = target;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tchild.target = new Object3D();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n}\n\nconst TEXTURE_MAPPING = {\n\tUVMapping: UVMapping,\n\tCubeReflectionMapping: CubeReflectionMapping,\n\tCubeRefractionMapping: CubeRefractionMapping,\n\tEquirectangularReflectionMapping: EquirectangularReflectionMapping,\n\tEquirectangularRefractionMapping: EquirectangularRefractionMapping,\n\tCubeUVReflectionMapping: CubeUVReflectionMapping\n};\n\nconst TEXTURE_WRAPPING = {\n\tRepeatWrapping: RepeatWrapping,\n\tClampToEdgeWrapping: ClampToEdgeWrapping,\n\tMirroredRepeatWrapping: MirroredRepeatWrapping\n};\n\nconst TEXTURE_FILTER = {\n\tNearestFilter: NearestFilter,\n\tNearestMipmapNearestFilter: NearestMipmapNearestFilter,\n\tNearestMipmapLinearFilter: NearestMipmapLinearFilter,\n\tLinearFilter: LinearFilter,\n\tLinearMipmapNearestFilter: LinearMipmapNearestFilter,\n\tLinearMipmapLinearFilter: LinearMipmapLinearFilter\n};\n\nclass ImageBitmapLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.isImageBitmapLoader = true;\n\n\t\tif ( typeof createImageBitmap === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: createImageBitmap() not supported.' );\n\n\t\t}\n\n\t\tif ( typeof fetch === 'undefined' ) {\n\n\t\t\tconsole.warn( 'THREE.ImageBitmapLoader: fetch() not supported.' );\n\n\t\t}\n\n\t\tthis.options = { premultiplyAlpha: 'none' };\n\n\t}\n\n\tsetOptions( options ) {\n\n\t\tthis.options = options;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tconst scope = this;\n\n\t\tconst cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\t// If cached is a promise, wait for it to resolve\n\t\t\tif ( cached.then ) {\n\n\t\t\t\tcached.then( imageBitmap => {\n\n\t\t\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t} ).catch( e => {\n\n\t\t\t\t\tif ( onError ) onError( e );\n\n\t\t\t\t} );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\t// If cached is not a promise (i.e., it's already an imageBitmap)\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\tconst fetchOptions = {};\n\t\tfetchOptions.credentials = ( this.crossOrigin === 'anonymous' ) ? 'same-origin' : 'include';\n\t\tfetchOptions.headers = this.requestHeader;\n\n\t\tconst promise = fetch( url, fetchOptions ).then( function ( res ) {\n\n\t\t\treturn res.blob();\n\n\t\t} ).then( function ( blob ) {\n\n\t\t\treturn createImageBitmap( blob, Object.assign( scope.options, { colorSpaceConversion: 'none' } ) );\n\n\t\t} ).then( function ( imageBitmap ) {\n\n\t\t\tCache.add( url, imageBitmap );\n\n\t\t\tif ( onLoad ) onLoad( imageBitmap );\n\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t\treturn imageBitmap;\n\n\t\t} ).catch( function ( e ) {\n\n\t\t\tif ( onError ) onError( e );\n\n\t\t\tCache.remove( url );\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t} );\n\n\t\tCache.add( url, promise );\n\t\tscope.manager.itemStart( url );\n\n\t}\n\n}\n\nlet _context;\n\nclass AudioContext {\n\n\tstatic getContext() {\n\n\t\tif ( _context === undefined ) {\n\n\t\t\t_context = new ( window.AudioContext || window.webkitAudioContext )();\n\n\t\t}\n\n\t\treturn _context;\n\n\t}\n\n\tstatic setContext( value ) {\n\n\t\t_context = value;\n\n\t}\n\n}\n\nclass AudioLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\t// Create a copy of the buffer. The `decodeAudioData` method\n\t\t\t\t// detaches the buffer when complete, preventing reuse.\n\t\t\t\tconst bufferCopy = buffer.slice( 0 );\n\n\t\t\t\tconst context = AudioContext.getContext();\n\t\t\t\tcontext.decodeAudioData( bufferCopy, function ( audioBuffer ) {\n\n\t\t\t\t\tonLoad( audioBuffer );\n\n\t\t\t\t} ).catch( handleError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\thandleError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t\tfunction handleError( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\n\t\t}\n\n\t}\n\n}\n\nconst _eyeRight = /*@__PURE__*/ new Matrix4();\nconst _eyeLeft = /*@__PURE__*/ new Matrix4();\nconst _projectionMatrix = /*@__PURE__*/ new Matrix4();\n\nclass StereoCamera {\n\n\tconstructor() {\n\n\t\tthis.type = 'StereoCamera';\n\n\t\tthis.aspect = 1;\n\n\t\tthis.eyeSep = 0.064;\n\n\t\tthis.cameraL = new PerspectiveCamera();\n\t\tthis.cameraL.layers.enable( 1 );\n\t\tthis.cameraL.matrixAutoUpdate = false;\n\n\t\tthis.cameraR = new PerspectiveCamera();\n\t\tthis.cameraR.layers.enable( 2 );\n\t\tthis.cameraR.matrixAutoUpdate = false;\n\n\t\tthis._cache = {\n\t\t\tfocus: null,\n\t\t\tfov: null,\n\t\t\taspect: null,\n\t\t\tnear: null,\n\t\t\tfar: null,\n\t\t\tzoom: null,\n\t\t\teyeSep: null\n\t\t};\n\n\t}\n\n\tupdate( camera ) {\n\n\t\tconst cache = this._cache;\n\n\t\tconst needsUpdate = cache.focus !== camera.focus || cache.fov !== camera.fov ||\n\t\t\tcache.aspect !== camera.aspect * this.aspect || cache.near !== camera.near ||\n\t\t\tcache.far !== camera.far || cache.zoom !== camera.zoom || cache.eyeSep !== this.eyeSep;\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tcache.focus = camera.focus;\n\t\t\tcache.fov = camera.fov;\n\t\t\tcache.aspect = camera.aspect * this.aspect;\n\t\t\tcache.near = camera.near;\n\t\t\tcache.far = camera.far;\n\t\t\tcache.zoom = camera.zoom;\n\t\t\tcache.eyeSep = this.eyeSep;\n\n\t\t\t// Off-axis stereoscopic effect based on\n\t\t\t// http://paulbourke.net/stereographics/stereorender/\n\n\t\t\t_projectionMatrix.copy( camera.projectionMatrix );\n\t\t\tconst eyeSepHalf = cache.eyeSep / 2;\n\t\t\tconst eyeSepOnProjection = eyeSepHalf * cache.near / cache.focus;\n\t\t\tconst ymax = ( cache.near * Math.tan( DEG2RAD * cache.fov * 0.5 ) ) / cache.zoom;\n\t\t\tlet xmin, xmax;\n\n\t\t\t// translate xOffset\n\n\t\t\t_eyeLeft.elements[ 12 ] = - eyeSepHalf;\n\t\t\t_eyeRight.elements[ 12 ] = eyeSepHalf;\n\n\t\t\t// for left eye\n\n\t\t\txmin = - ymax * cache.aspect + eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect + eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraL.projectionMatrix.copy( _projectionMatrix );\n\n\t\t\t// for right eye\n\n\t\t\txmin = - ymax * cache.aspect - eyeSepOnProjection;\n\t\t\txmax = ymax * cache.aspect - eyeSepOnProjection;\n\n\t\t\t_projectionMatrix.elements[ 0 ] = 2 * cache.near / ( xmax - xmin );\n\t\t\t_projectionMatrix.elements[ 8 ] = ( xmax + xmin ) / ( xmax - xmin );\n\n\t\t\tthis.cameraR.projectionMatrix.copy( _projectionMatrix );\n\n\t\t}\n\n\t\tthis.cameraL.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeLeft );\n\t\tthis.cameraR.matrixWorld.copy( camera.matrixWorld ).multiply( _eyeRight );\n\n\t}\n\n}\n\nclass ArrayCamera extends PerspectiveCamera {\n\n\tconstructor( array = [] ) {\n\n\t\tsuper();\n\n\t\tthis.isArrayCamera = true;\n\n\t\tthis.cameras = array;\n\n\t}\n\n}\n\nclass Clock {\n\n\tconstructor( autoStart = true ) {\n\n\t\tthis.autoStart = autoStart;\n\n\t\tthis.startTime = 0;\n\t\tthis.oldTime = 0;\n\t\tthis.elapsedTime = 0;\n\n\t\tthis.running = false;\n\n\t}\n\n\tstart() {\n\n\t\tthis.startTime = now();\n\n\t\tthis.oldTime = this.startTime;\n\t\tthis.elapsedTime = 0;\n\t\tthis.running = true;\n\n\t}\n\n\tstop() {\n\n\t\tthis.getElapsedTime();\n\t\tthis.running = false;\n\t\tthis.autoStart = false;\n\n\t}\n\n\tgetElapsedTime() {\n\n\t\tthis.getDelta();\n\t\treturn this.elapsedTime;\n\n\t}\n\n\tgetDelta() {\n\n\t\tlet diff = 0;\n\n\t\tif ( this.autoStart && ! this.running ) {\n\n\t\t\tthis.start();\n\t\t\treturn 0;\n\n\t\t}\n\n\t\tif ( this.running ) {\n\n\t\t\tconst newTime = now();\n\n\t\t\tdiff = ( newTime - this.oldTime ) / 1000;\n\t\t\tthis.oldTime = newTime;\n\n\t\t\tthis.elapsedTime += diff;\n\n\t\t}\n\n\t\treturn diff;\n\n\t}\n\n}\n\nfunction now() {\n\n\treturn performance.now();\n\n}\n\nconst _position$1 = /*@__PURE__*/ new Vector3();\nconst _quaternion$1 = /*@__PURE__*/ new Quaternion();\nconst _scale$1 = /*@__PURE__*/ new Vector3();\nconst _orientation$1 = /*@__PURE__*/ new Vector3();\n\nclass AudioListener extends Object3D {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.type = 'AudioListener';\n\n\t\tthis.context = AudioContext.getContext();\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( this.context.destination );\n\n\t\tthis.filter = null;\n\n\t\tthis.timeDelta = 0;\n\n\t\t// private\n\n\t\tthis._clock = new Clock();\n\n\t}\n\n\tgetInput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tremoveFilter() {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\t\t\tthis.gain.connect( this.context.destination );\n\t\t\tthis.filter = null;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.filter;\n\n\t}\n\n\tsetFilter( value ) {\n\n\t\tif ( this.filter !== null ) {\n\n\t\t\tthis.gain.disconnect( this.filter );\n\t\t\tthis.filter.disconnect( this.context.destination );\n\n\t\t} else {\n\n\t\t\tthis.gain.disconnect( this.context.destination );\n\n\t\t}\n\n\t\tthis.filter = value;\n\t\tthis.gain.connect( this.filter );\n\t\tthis.filter.connect( this.context.destination );\n\n\t\treturn this;\n\n\t}\n\n\tgetMasterVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetMasterVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tconst listener = this.context.listener;\n\t\tconst up = this.up;\n\n\t\tthis.timeDelta = this._clock.getDelta();\n\n\t\tthis.matrixWorld.decompose( _position$1, _quaternion$1, _scale$1 );\n\n\t\t_orientation$1.set( 0, 0, - 1 ).applyQuaternion( _quaternion$1 );\n\n\t\tif ( listener.positionX ) {\n\n\t\t\t// code path for Chrome (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.timeDelta;\n\n\t\t\tlistener.positionX.linearRampToValueAtTime( _position$1.x, endTime );\n\t\t\tlistener.positionY.linearRampToValueAtTime( _position$1.y, endTime );\n\t\t\tlistener.positionZ.linearRampToValueAtTime( _position$1.z, endTime );\n\t\t\tlistener.forwardX.linearRampToValueAtTime( _orientation$1.x, endTime );\n\t\t\tlistener.forwardY.linearRampToValueAtTime( _orientation$1.y, endTime );\n\t\t\tlistener.forwardZ.linearRampToValueAtTime( _orientation$1.z, endTime );\n\t\t\tlistener.upX.linearRampToValueAtTime( up.x, endTime );\n\t\t\tlistener.upY.linearRampToValueAtTime( up.y, endTime );\n\t\t\tlistener.upZ.linearRampToValueAtTime( up.z, endTime );\n\n\t\t} else {\n\n\t\t\tlistener.setPosition( _position$1.x, _position$1.y, _position$1.z );\n\t\t\tlistener.setOrientation( _orientation$1.x, _orientation$1.y, _orientation$1.z, up.x, up.y, up.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass Audio extends Object3D {\n\n\tconstructor( listener ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'Audio';\n\n\t\tthis.listener = listener;\n\t\tthis.context = listener.context;\n\n\t\tthis.gain = this.context.createGain();\n\t\tthis.gain.connect( listener.getInput() );\n\n\t\tthis.autoplay = false;\n\n\t\tthis.buffer = null;\n\t\tthis.detune = 0;\n\t\tthis.loop = false;\n\t\tthis.loopStart = 0;\n\t\tthis.loopEnd = 0;\n\t\tthis.offset = 0;\n\t\tthis.duration = undefined;\n\t\tthis.playbackRate = 1;\n\t\tthis.isPlaying = false;\n\t\tthis.hasPlaybackControl = true;\n\t\tthis.source = null;\n\t\tthis.sourceType = 'empty';\n\n\t\tthis._startedAt = 0;\n\t\tthis._progress = 0;\n\t\tthis._connected = false;\n\n\t\tthis.filters = [];\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.gain;\n\n\t}\n\n\tsetNodeSource( audioNode ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'audioNode';\n\t\tthis.source = audioNode;\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaElementSource( mediaElement ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaNode';\n\t\tthis.source = this.context.createMediaElementSource( mediaElement );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetMediaStreamSource( mediaStream ) {\n\n\t\tthis.hasPlaybackControl = false;\n\t\tthis.sourceType = 'mediaStreamNode';\n\t\tthis.source = this.context.createMediaStreamSource( mediaStream );\n\t\tthis.connect();\n\n\t\treturn this;\n\n\t}\n\n\tsetBuffer( audioBuffer ) {\n\n\t\tthis.buffer = audioBuffer;\n\t\tthis.sourceType = 'buffer';\n\n\t\tif ( this.autoplay ) this.play();\n\n\t\treturn this;\n\n\t}\n\n\tplay( delay = 0 ) {\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: Audio is already playing.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._startedAt = this.context.currentTime + delay;\n\n\t\tconst source = this.context.createBufferSource();\n\t\tsource.buffer = this.buffer;\n\t\tsource.loop = this.loop;\n\t\tsource.loopStart = this.loopStart;\n\t\tsource.loopEnd = this.loopEnd;\n\t\tsource.onended = this.onEnded.bind( this );\n\t\tsource.start( this._startedAt, this._progress + this.offset, this.duration );\n\n\t\tthis.isPlaying = true;\n\n\t\tthis.source = source;\n\n\t\tthis.setDetune( this.detune );\n\t\tthis.setPlaybackRate( this.playbackRate );\n\n\t\treturn this.connect();\n\n\t}\n\n\tpause() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\t// update current progress\n\n\t\t\tthis._progress += Math.max( this.context.currentTime - this._startedAt, 0 ) * this.playbackRate;\n\n\t\t\tif ( this.loop === true ) {\n\n\t\t\t\t// ensure _progress does not exceed duration with looped audios\n\n\t\t\t\tthis._progress = this._progress % ( this.duration || this.buffer.duration );\n\n\t\t\t}\n\n\t\t\tthis.source.stop();\n\t\t\tthis.source.onended = null;\n\n\t\t\tthis.isPlaying = false;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tstop( delay = 0 ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._progress = 0;\n\n\t\tif ( this.source !== null ) {\n\n\t\t\tthis.source.stop( this.context.currentTime + delay );\n\t\t\tthis.source.onended = null;\n\n\t\t}\n\n\t\tthis.isPlaying = false;\n\n\t\treturn this;\n\n\t}\n\n\tconnect() {\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.connect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].connect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].connect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.connect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = true;\n\n\t\treturn this;\n\n\t}\n\n\tdisconnect() {\n\n\t\tif ( this._connected === false ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.filters.length > 0 ) {\n\n\t\t\tthis.source.disconnect( this.filters[ 0 ] );\n\n\t\t\tfor ( let i = 1, l = this.filters.length; i < l; i ++ ) {\n\n\t\t\t\tthis.filters[ i - 1 ].disconnect( this.filters[ i ] );\n\n\t\t\t}\n\n\t\t\tthis.filters[ this.filters.length - 1 ].disconnect( this.getOutput() );\n\n\t\t} else {\n\n\t\t\tthis.source.disconnect( this.getOutput() );\n\n\t\t}\n\n\t\tthis._connected = false;\n\n\t\treturn this;\n\n\t}\n\n\tgetFilters() {\n\n\t\treturn this.filters;\n\n\t}\n\n\tsetFilters( value ) {\n\n\t\tif ( ! value ) value = [];\n\n\t\tif ( this._connected === true ) {\n\n\t\t\tthis.disconnect();\n\t\t\tthis.filters = value.slice();\n\t\t\tthis.connect();\n\n\t\t} else {\n\n\t\t\tthis.filters = value.slice();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetDetune( value ) {\n\n\t\tthis.detune = value;\n\n\t\tif ( this.isPlaying === true && this.source.detune !== undefined ) {\n\n\t\t\tthis.source.detune.setTargetAtTime( this.detune, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetDetune() {\n\n\t\treturn this.detune;\n\n\t}\n\n\tgetFilter() {\n\n\t\treturn this.getFilters()[ 0 ];\n\n\t}\n\n\tsetFilter( filter ) {\n\n\t\treturn this.setFilters( filter ? [ filter ] : [] );\n\n\t}\n\n\tsetPlaybackRate( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.playbackRate = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.playbackRate.setTargetAtTime( this.playbackRate, this.context.currentTime, 0.01 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetPlaybackRate() {\n\n\t\treturn this.playbackRate;\n\n\t}\n\n\tonEnded() {\n\n\t\tthis.isPlaying = false;\n\n\t}\n\n\tgetLoop() {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn this.loop;\n\n\t}\n\n\tsetLoop( value ) {\n\n\t\tif ( this.hasPlaybackControl === false ) {\n\n\t\t\tconsole.warn( 'THREE.Audio: this Audio has no playback control.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis.loop = value;\n\n\t\tif ( this.isPlaying === true ) {\n\n\t\t\tthis.source.loop = this.loop;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopStart( value ) {\n\n\t\tthis.loopStart = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoopEnd( value ) {\n\n\t\tthis.loopEnd = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetVolume() {\n\n\t\treturn this.gain.gain.value;\n\n\t}\n\n\tsetVolume( value ) {\n\n\t\tthis.gain.gain.setTargetAtTime( value, this.context.currentTime, 0.01 );\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _position = /*@__PURE__*/ new Vector3();\nconst _quaternion = /*@__PURE__*/ new Quaternion();\nconst _scale = /*@__PURE__*/ new Vector3();\nconst _orientation = /*@__PURE__*/ new Vector3();\n\nclass PositionalAudio extends Audio {\n\n\tconstructor( listener ) {\n\n\t\tsuper( listener );\n\n\t\tthis.panner = this.context.createPanner();\n\t\tthis.panner.panningModel = 'HRTF';\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tconnect() {\n\n\t\tsuper.connect();\n\n\t\tthis.panner.connect( this.gain );\n\n\t}\n\n\tdisconnect() {\n\n\t\tsuper.disconnect();\n\n\t\tthis.panner.disconnect( this.gain );\n\n\t}\n\n\tgetOutput() {\n\n\t\treturn this.panner;\n\n\t}\n\n\tgetRefDistance() {\n\n\t\treturn this.panner.refDistance;\n\n\t}\n\n\tsetRefDistance( value ) {\n\n\t\tthis.panner.refDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetRolloffFactor() {\n\n\t\treturn this.panner.rolloffFactor;\n\n\t}\n\n\tsetRolloffFactor( value ) {\n\n\t\tthis.panner.rolloffFactor = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetDistanceModel() {\n\n\t\treturn this.panner.distanceModel;\n\n\t}\n\n\tsetDistanceModel( value ) {\n\n\t\tthis.panner.distanceModel = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetMaxDistance() {\n\n\t\treturn this.panner.maxDistance;\n\n\t}\n\n\tsetMaxDistance( value ) {\n\n\t\tthis.panner.maxDistance = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetDirectionalCone( coneInnerAngle, coneOuterAngle, coneOuterGain ) {\n\n\t\tthis.panner.coneInnerAngle = coneInnerAngle;\n\t\tthis.panner.coneOuterAngle = coneOuterAngle;\n\t\tthis.panner.coneOuterGain = coneOuterGain;\n\n\t\treturn this;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t\tif ( this.hasPlaybackControl === true && this.isPlaying === false ) return;\n\n\t\tthis.matrixWorld.decompose( _position, _quaternion, _scale );\n\n\t\t_orientation.set( 0, 0, 1 ).applyQuaternion( _quaternion );\n\n\t\tconst panner = this.panner;\n\n\t\tif ( panner.positionX ) {\n\n\t\t\t// code path for Chrome and Firefox (see #14393)\n\n\t\t\tconst endTime = this.context.currentTime + this.listener.timeDelta;\n\n\t\t\tpanner.positionX.linearRampToValueAtTime( _position.x, endTime );\n\t\t\tpanner.positionY.linearRampToValueAtTime( _position.y, endTime );\n\t\t\tpanner.positionZ.linearRampToValueAtTime( _position.z, endTime );\n\t\t\tpanner.orientationX.linearRampToValueAtTime( _orientation.x, endTime );\n\t\t\tpanner.orientationY.linearRampToValueAtTime( _orientation.y, endTime );\n\t\t\tpanner.orientationZ.linearRampToValueAtTime( _orientation.z, endTime );\n\n\t\t} else {\n\n\t\t\tpanner.setPosition( _position.x, _position.y, _position.z );\n\t\t\tpanner.setOrientation( _orientation.x, _orientation.y, _orientation.z );\n\n\t\t}\n\n\t}\n\n}\n\nclass AudioAnalyser {\n\n\tconstructor( audio, fftSize = 2048 ) {\n\n\t\tthis.analyser = audio.context.createAnalyser();\n\t\tthis.analyser.fftSize = fftSize;\n\n\t\tthis.data = new Uint8Array( this.analyser.frequencyBinCount );\n\n\t\taudio.getOutput().connect( this.analyser );\n\n\t}\n\n\n\tgetFrequencyData() {\n\n\t\tthis.analyser.getByteFrequencyData( this.data );\n\n\t\treturn this.data;\n\n\t}\n\n\tgetAverageFrequency() {\n\n\t\tlet value = 0;\n\t\tconst data = this.getFrequencyData();\n\n\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\tvalue += data[ i ];\n\n\t\t}\n\n\t\treturn value / data.length;\n\n\t}\n\n}\n\nclass PropertyMixer {\n\n\tconstructor( binding, typeName, valueSize ) {\n\n\t\tthis.binding = binding;\n\t\tthis.valueSize = valueSize;\n\n\t\tlet mixFunction,\n\t\t\tmixFunctionAdditive,\n\t\t\tsetIdentity;\n\n\t\t// buffer layout: [ incoming | accu0 | accu1 | orig | addAccu | (optional work) ]\n\t\t//\n\t\t// interpolators can use .buffer as their .result\n\t\t// the data then goes to 'incoming'\n\t\t//\n\t\t// 'accu0' and 'accu1' are used frame-interleaved for\n\t\t// the cumulative result and are compared to detect\n\t\t// changes\n\t\t//\n\t\t// 'orig' stores the original state of the property\n\t\t//\n\t\t// 'add' is used for additive cumulative results\n\t\t//\n\t\t// 'work' is optional and is only present for quaternion types. It is used\n\t\t// to store intermediate quaternion multiplication results\n\n\t\tswitch ( typeName ) {\n\n\t\t\tcase 'quaternion':\n\t\t\t\tmixFunction = this._slerp;\n\t\t\t\tmixFunctionAdditive = this._slerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityQuaternion;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 6 );\n\t\t\t\tthis._workIndex = 5;\n\t\t\t\tbreak;\n\n\t\t\tcase 'string':\n\t\t\tcase 'bool':\n\t\t\t\tmixFunction = this._select;\n\n\t\t\t\t// Use the regular mix function and for additive on these types,\n\t\t\t\t// additive is not relevant for non-numeric types\n\t\t\t\tmixFunctionAdditive = this._select;\n\n\t\t\t\tsetIdentity = this._setAdditiveIdentityOther;\n\n\t\t\t\tthis.buffer = new Array( valueSize * 5 );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tmixFunction = this._lerp;\n\t\t\t\tmixFunctionAdditive = this._lerpAdditive;\n\t\t\t\tsetIdentity = this._setAdditiveIdentityNumeric;\n\n\t\t\t\tthis.buffer = new Float64Array( valueSize * 5 );\n\n\t\t}\n\n\t\tthis._mixBufferRegion = mixFunction;\n\t\tthis._mixBufferRegionAdditive = mixFunctionAdditive;\n\t\tthis._setIdentity = setIdentity;\n\t\tthis._origIndex = 3;\n\t\tthis._addIndex = 4;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tthis.useCount = 0;\n\t\tthis.referenceCount = 0;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'accu<i>'\n\taccumulate( accuIndex, weight ) {\n\n\t\t// note: happily accumulating nothing when weight = 0, the caller knows\n\t\t// the weight and shouldn't have made the call in the first place\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = accuIndex * stride + stride;\n\n\t\tlet currentWeight = this.cumulativeWeight;\n\n\t\tif ( currentWeight === 0 ) {\n\n\t\t\t// accuN := incoming * weight\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ offset + i ] = buffer[ i ];\n\n\t\t\t}\n\n\t\t\tcurrentWeight = weight;\n\n\t\t} else {\n\n\t\t\t// accuN := accuN + incoming * weight\n\n\t\t\tcurrentWeight += weight;\n\t\t\tconst mix = weight / currentWeight;\n\t\t\tthis._mixBufferRegion( buffer, offset, 0, mix, stride );\n\n\t\t}\n\n\t\tthis.cumulativeWeight = currentWeight;\n\n\t}\n\n\t// accumulate data in the 'incoming' region into 'add'\n\taccumulateAdditive( weight ) {\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\t\t\toffset = stride * this._addIndex;\n\n\t\tif ( this.cumulativeWeightAdditive === 0 ) {\n\n\t\t\t// add = identity\n\n\t\t\tthis._setIdentity();\n\n\t\t}\n\n\t\t// add := add + incoming * weight\n\n\t\tthis._mixBufferRegionAdditive( buffer, offset, 0, weight, stride );\n\t\tthis.cumulativeWeightAdditive += weight;\n\n\t}\n\n\t// apply the state of 'accu<i>' to the binding when accus differ\n\tapply( accuIndex ) {\n\n\t\tconst stride = this.valueSize,\n\t\t\tbuffer = this.buffer,\n\t\t\toffset = accuIndex * stride + stride,\n\n\t\t\tweight = this.cumulativeWeight,\n\t\t\tweightAdditive = this.cumulativeWeightAdditive,\n\n\t\t\tbinding = this.binding;\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t\tif ( weight < 1 ) {\n\n\t\t\t// accuN := accuN + original * ( 1 - cumulativeWeight )\n\n\t\t\tconst originalValueOffset = stride * this._origIndex;\n\n\t\t\tthis._mixBufferRegion(\n\t\t\t\tbuffer, offset, originalValueOffset, 1 - weight, stride );\n\n\t\t}\n\n\t\tif ( weightAdditive > 0 ) {\n\n\t\t\t// accuN := accuN + additive accuN\n\n\t\t\tthis._mixBufferRegionAdditive( buffer, offset, this._addIndex * stride, 1, stride );\n\n\t\t}\n\n\t\tfor ( let i = stride, e = stride + stride; i !== e; ++ i ) {\n\n\t\t\tif ( buffer[ i ] !== buffer[ i + stride ] ) {\n\n\t\t\t\t// value has changed -> update scene graph\n\n\t\t\t\tbinding.setValue( buffer, offset );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remember the state of the bound property and copy it to both accus\n\tsaveOriginalState() {\n\n\t\tconst binding = this.binding;\n\n\t\tconst buffer = this.buffer,\n\t\t\tstride = this.valueSize,\n\n\t\t\toriginalValueOffset = stride * this._origIndex;\n\n\t\tbinding.getValue( buffer, originalValueOffset );\n\n\t\t// accu[0..1] := orig -- initially detect changes against the original\n\t\tfor ( let i = stride, e = originalValueOffset; i !== e; ++ i ) {\n\n\t\t\tbuffer[ i ] = buffer[ originalValueOffset + ( i % stride ) ];\n\n\t\t}\n\n\t\t// Add to identity for additive\n\t\tthis._setIdentity();\n\n\t\tthis.cumulativeWeight = 0;\n\t\tthis.cumulativeWeightAdditive = 0;\n\n\t}\n\n\t// apply the state previously taken via 'saveOriginalState' to the binding\n\trestoreOriginalState() {\n\n\t\tconst originalValueOffset = this.valueSize * 3;\n\t\tthis.binding.setValue( this.buffer, originalValueOffset );\n\n\t}\n\n\t_setAdditiveIdentityNumeric() {\n\n\t\tconst startIndex = this._addIndex * this.valueSize;\n\t\tconst endIndex = startIndex + this.valueSize;\n\n\t\tfor ( let i = startIndex; i < endIndex; i ++ ) {\n\n\t\t\tthis.buffer[ i ] = 0;\n\n\t\t}\n\n\t}\n\n\t_setAdditiveIdentityQuaternion() {\n\n\t\tthis._setAdditiveIdentityNumeric();\n\t\tthis.buffer[ this._addIndex * this.valueSize + 3 ] = 1;\n\n\t}\n\n\t_setAdditiveIdentityOther() {\n\n\t\tconst startIndex = this._origIndex * this.valueSize;\n\t\tconst targetIndex = this._addIndex * this.valueSize;\n\n\t\tfor ( let i = 0; i < this.valueSize; i ++ ) {\n\n\t\t\tthis.buffer[ targetIndex + i ] = this.buffer[ startIndex + i ];\n\n\t\t}\n\n\t}\n\n\n\t// mix functions\n\n\t_select( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tif ( t >= 0.5 ) {\n\n\t\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\t\tbuffer[ dstOffset + i ] = buffer[ srcOffset + i ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_slerp( buffer, dstOffset, srcOffset, t ) {\n\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, srcOffset, t );\n\n\t}\n\n\t_slerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst workOffset = this._workIndex * stride;\n\n\t\t// Store result in intermediate buffer offset\n\t\tQuaternion.multiplyQuaternionsFlat( buffer, workOffset, buffer, dstOffset, buffer, srcOffset );\n\n\t\t// Slerp to the intermediate result\n\t\tQuaternion.slerpFlat( buffer, dstOffset, buffer, dstOffset, buffer, workOffset, t );\n\n\t}\n\n\t_lerp( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tconst s = 1 - t;\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] * s + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n\t_lerpAdditive( buffer, dstOffset, srcOffset, t, stride ) {\n\n\t\tfor ( let i = 0; i !== stride; ++ i ) {\n\n\t\t\tconst j = dstOffset + i;\n\n\t\t\tbuffer[ j ] = buffer[ j ] + buffer[ srcOffset + i ] * t;\n\n\t\t}\n\n\t}\n\n}\n\n// Characters [].:/ are reserved for track binding syntax.\nconst _RESERVED_CHARS_RE = '\\\\[\\\\]\\\\.:\\\\/';\nconst _reservedRe = new RegExp( '[' + _RESERVED_CHARS_RE + ']', 'g' );\n\n// Attempts to allow node names from any language. ES5's `\\w` regexp matches\n// only latin characters, and the unicode \\p{L} is not yet supported. So\n// instead, we exclude reserved characters and match everything else.\nconst _wordChar = '[^' + _RESERVED_CHARS_RE + ']';\nconst _wordCharOrDot = '[^' + _RESERVED_CHARS_RE.replace( '\\\\.', '' ) + ']';\n\n// Parent directories, delimited by '/' or ':'. Currently unused, but must\n// be matched to parse the rest of the track name.\nconst _directoryRe = /*@__PURE__*/ /((?:WC+[\\/:])*)/.source.replace( 'WC', _wordChar );\n\n// Target node. May contain word characters (a-zA-Z0-9_) and '.' or '-'.\nconst _nodeRe = /*@__PURE__*/ /(WCOD+)?/.source.replace( 'WCOD', _wordCharOrDot );\n\n// Object on target node, and accessor. May not contain reserved\n// characters. Accessor may contain any character except closing bracket.\nconst _objectRe = /*@__PURE__*/ /(?:\\.(WC+)(?:\\[(.+)\\])?)?/.source.replace( 'WC', _wordChar );\n\n// Property and accessor. May not contain reserved characters. Accessor may\n// contain any non-bracket characters.\nconst _propertyRe = /*@__PURE__*/ /\\.(WC+)(?:\\[(.+)\\])?/.source.replace( 'WC', _wordChar );\n\nconst _trackRe = new RegExp( ''\n\t+ '^'\n\t+ _directoryRe\n\t+ _nodeRe\n\t+ _objectRe\n\t+ _propertyRe\n\t+ '$'\n);\n\nconst _supportedObjectNames = [ 'material', 'materials', 'bones', 'map' ];\n\nclass Composite {\n\n\tconstructor( targetGroup, path, optionalParsedPath ) {\n\n\t\tconst parsedPath = optionalParsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis._targetGroup = targetGroup;\n\t\tthis._bindings = targetGroup.subscribe_( path, parsedPath );\n\n\t}\n\n\tgetValue( array, offset ) {\n\n\t\tthis.bind(); // bind all binding\n\n\t\tconst firstValidIndex = this._targetGroup.nCachedObjects_,\n\t\t\tbinding = this._bindings[ firstValidIndex ];\n\n\t\t// and only call .getValue on the first\n\t\tif ( binding !== undefined ) binding.getValue( array, offset );\n\n\t}\n\n\tsetValue( array, offset ) {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].setValue( array, offset );\n\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].bind();\n\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tconst bindings = this._bindings;\n\n\t\tfor ( let i = this._targetGroup.nCachedObjects_, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tbindings[ i ].unbind();\n\n\t\t}\n\n\t}\n\n}\n\n// Note: This class uses a State pattern on a per-method basis:\n// 'bind' sets 'this.getValue' / 'setValue' and shadows the\n// prototype version of these methods with one that represents\n// the bound state. When the property is not found, the methods\n// become no-ops.\nclass PropertyBinding {\n\n\tconstructor( rootNode, path, parsedPath ) {\n\n\t\tthis.path = path;\n\t\tthis.parsedPath = parsedPath || PropertyBinding.parseTrackName( path );\n\n\t\tthis.node = PropertyBinding.findNode( rootNode, this.parsedPath.nodeName );\n\n\t\tthis.rootNode = rootNode;\n\n\t\t// initial state of these methods that calls 'bind'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n\n\tstatic create( root, path, parsedPath ) {\n\n\t\tif ( ! ( root && root.isAnimationObjectGroup ) ) {\n\n\t\t\treturn new PropertyBinding( root, path, parsedPath );\n\n\t\t} else {\n\n\t\t\treturn new PropertyBinding.Composite( root, path, parsedPath );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Replaces spaces with underscores and removes unsupported characters from\n\t * node names, to ensure compatibility with parseTrackName().\n\t *\n\t * @param {string} name Node name to be sanitized.\n\t * @return {string}\n\t */\n\tstatic sanitizeNodeName( name ) {\n\n\t\treturn name.replace( /\\s/g, '_' ).replace( _reservedRe, '' );\n\n\t}\n\n\tstatic parseTrackName( trackName ) {\n\n\t\tconst matches = _trackRe.exec( trackName );\n\n\t\tif ( matches === null ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: Cannot parse trackName: ' + trackName );\n\n\t\t}\n\n\t\tconst results = {\n\t\t\t// directoryName: matches[ 1 ], // (tschw) currently unused\n\t\t\tnodeName: matches[ 2 ],\n\t\t\tobjectName: matches[ 3 ],\n\t\t\tobjectIndex: matches[ 4 ],\n\t\t\tpropertyName: matches[ 5 ], // required\n\t\t\tpropertyIndex: matches[ 6 ]\n\t\t};\n\n\t\tconst lastDot = results.nodeName && results.nodeName.lastIndexOf( '.' );\n\n\t\tif ( lastDot !== undefined && lastDot !== - 1 ) {\n\n\t\t\tconst objectName = results.nodeName.substring( lastDot + 1 );\n\n\t\t\t// Object names must be checked against an allowlist. Otherwise, there\n\t\t\t// is no way to parse 'foo.bar.baz': 'baz' must be a property, but\n\t\t\t// 'bar' could be the objectName, or part of a nodeName (which can\n\t\t\t// include '.' characters).\n\t\t\tif ( _supportedObjectNames.indexOf( objectName ) !== - 1 ) {\n\n\t\t\t\tresults.nodeName = results.nodeName.substring( 0, lastDot );\n\t\t\t\tresults.objectName = objectName;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( results.propertyName === null || results.propertyName.length === 0 ) {\n\n\t\t\tthrow new Error( 'PropertyBinding: can not parse propertyName from trackName: ' + trackName );\n\n\t\t}\n\n\t\treturn results;\n\n\t}\n\n\tstatic findNode( root, nodeName ) {\n\n\t\tif ( nodeName === undefined || nodeName === '' || nodeName === '.' || nodeName === - 1 || nodeName === root.name || nodeName === root.uuid ) {\n\n\t\t\treturn root;\n\n\t\t}\n\n\t\t// search into skeleton bones.\n\t\tif ( root.skeleton ) {\n\n\t\t\tconst bone = root.skeleton.getBoneByName( nodeName );\n\n\t\t\tif ( bone !== undefined ) {\n\n\t\t\t\treturn bone;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// search into node subtree.\n\t\tif ( root.children ) {\n\n\t\t\tconst searchNodeSubtree = function ( children ) {\n\n\t\t\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\t\t\tconst childNode = children[ i ];\n\n\t\t\t\t\tif ( childNode.name === nodeName || childNode.uuid === nodeName ) {\n\n\t\t\t\t\t\treturn childNode;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = searchNodeSubtree( childNode.children );\n\n\t\t\t\t\tif ( result ) return result;\n\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t};\n\n\t\t\tconst subTreeNode = searchNodeSubtree( root.children );\n\n\t\t\tif ( subTreeNode ) {\n\n\t\t\t\treturn subTreeNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// these are used to \"bind\" a nonexistent property\n\t_getValue_unavailable() {}\n\t_setValue_unavailable() {}\n\n\t// Getters\n\n\t_getValue_direct( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.targetObject[ this.propertyName ];\n\n\t}\n\n\t_getValue_array( buffer, offset ) {\n\n\t\tconst source = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = source.length; i !== n; ++ i ) {\n\n\t\t\tbuffer[ offset ++ ] = source[ i ];\n\n\t\t}\n\n\t}\n\n\t_getValue_arrayElement( buffer, offset ) {\n\n\t\tbuffer[ offset ] = this.resolvedProperty[ this.propertyIndex ];\n\n\t}\n\n\t_getValue_toArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.toArray( buffer, offset );\n\n\t}\n\n\t// Direct\n\n\t_setValue_direct( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_direct_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_direct_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.targetObject[ this.propertyName ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// EntireArray\n\n\t_setValue_array( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t}\n\n\t_setValue_array_setNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_array_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tconst dest = this.resolvedProperty;\n\n\t\tfor ( let i = 0, n = dest.length; i !== n; ++ i ) {\n\n\t\t\tdest[ i ] = buffer[ offset ++ ];\n\n\t\t}\n\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// ArrayElement\n\n\t_setValue_arrayElement( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\n\t}\n\n\t_setValue_arrayElement_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_arrayElement_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty[ this.propertyIndex ] = buffer[ offset ];\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t// HasToFromArray\n\n\t_setValue_fromArray( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\n\t}\n\n\t_setValue_fromArray_setNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.needsUpdate = true;\n\n\t}\n\n\t_setValue_fromArray_setMatrixWorldNeedsUpdate( buffer, offset ) {\n\n\t\tthis.resolvedProperty.fromArray( buffer, offset );\n\t\tthis.targetObject.matrixWorldNeedsUpdate = true;\n\n\t}\n\n\t_getValue_unbound( targetArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.getValue( targetArray, offset );\n\n\t}\n\n\t_setValue_unbound( sourceArray, offset ) {\n\n\t\tthis.bind();\n\t\tthis.setValue( sourceArray, offset );\n\n\t}\n\n\t// create getter / setter pair for a property in the scene graph\n\tbind() {\n\n\t\tlet targetObject = this.node;\n\t\tconst parsedPath = this.parsedPath;\n\n\t\tconst objectName = parsedPath.objectName;\n\t\tconst propertyName = parsedPath.propertyName;\n\t\tlet propertyIndex = parsedPath.propertyIndex;\n\n\t\tif ( ! targetObject ) {\n\n\t\t\ttargetObject = PropertyBinding.findNode( this.rootNode, parsedPath.nodeName );\n\n\t\t\tthis.node = targetObject;\n\n\t\t}\n\n\t\t// set fail state so we can just 'return' on error\n\t\tthis.getValue = this._getValue_unavailable;\n\t\tthis.setValue = this._setValue_unavailable;\n\n\t\t// ensure there is a value node\n\t\tif ( ! targetObject ) {\n\n\t\t\tconsole.warn( 'THREE.PropertyBinding: No target node found for track: ' + this.path + '.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( objectName ) {\n\n\t\t\tlet objectIndex = parsedPath.objectIndex;\n\n\t\t\t// special cases were we need to reach deeper into the hierarchy to get the face materials....\n\t\t\tswitch ( objectName ) {\n\n\t\t\t\tcase 'materials':\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.materials ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.materials;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bones':\n\n\t\t\t\t\tif ( ! targetObject.skeleton ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// potential future optimization: skip this if propertyIndex is already an integer\n\t\t\t\t\t// and convert the integer string to a true integer.\n\n\t\t\t\t\ttargetObject = targetObject.skeleton.bones;\n\n\t\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\t\tfor ( let i = 0; i < targetObject.length; i ++ ) {\n\n\t\t\t\t\t\tif ( targetObject[ i ].name === objectIndex ) {\n\n\t\t\t\t\t\t\tobjectIndex = i;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'map':\n\n\t\t\t\t\tif ( 'map' in targetObject ) {\n\n\t\t\t\t\t\ttargetObject = targetObject.map;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material as node does not have a material.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! targetObject.material.map ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject.material.map;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif ( targetObject[ objectName ] === undefined ) {\n\n\t\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to objectName of node undefined.', this );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetObject = targetObject[ objectName ];\n\n\t\t\t}\n\n\n\t\t\tif ( objectIndex !== undefined ) {\n\n\t\t\t\tif ( targetObject[ objectIndex ] === undefined ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.', this, targetObject );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\ttargetObject = targetObject[ objectIndex ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// resolve property\n\t\tconst nodeProperty = targetObject[ propertyName ];\n\n\t\tif ( nodeProperty === undefined ) {\n\n\t\t\tconst nodeName = parsedPath.nodeName;\n\n\t\t\tconsole.error( 'THREE.PropertyBinding: Trying to update property for track: ' + nodeName +\n\t\t\t\t'.' + propertyName + ' but it wasn\\'t found.', targetObject );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// determine versioning scheme\n\t\tlet versioning = this.Versioning.None;\n\n\t\tthis.targetObject = targetObject;\n\n\t\tif ( targetObject.needsUpdate !== undefined ) { // material\n\n\t\t\tversioning = this.Versioning.NeedsUpdate;\n\n\t\t} else if ( targetObject.matrixWorldNeedsUpdate !== undefined ) { // node transform\n\n\t\t\tversioning = this.Versioning.MatrixWorldNeedsUpdate;\n\n\t\t}\n\n\t\t// determine how the property gets bound\n\t\tlet bindingType = this.BindingType.Direct;\n\n\t\tif ( propertyIndex !== undefined ) {\n\n\t\t\t// access a sub element of the property array (only primitives are supported right now)\n\n\t\t\tif ( propertyName === 'morphTargetInfluences' ) {\n\n\t\t\t\t// potential optimization, skip this if propertyIndex is already an integer, and convert the integer string to a true integer.\n\n\t\t\t\t// support resolving morphTarget names into indices.\n\t\t\t\tif ( ! targetObject.geometry ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ! targetObject.geometry.morphAttributes ) {\n\n\t\t\t\t\tconsole.error( 'THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.', this );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( targetObject.morphTargetDictionary[ propertyIndex ] !== undefined ) {\n\n\t\t\t\t\tpropertyIndex = targetObject.morphTargetDictionary[ propertyIndex ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingType = this.BindingType.ArrayElement;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\t\t\tthis.propertyIndex = propertyIndex;\n\n\t\t} else if ( nodeProperty.fromArray !== undefined && nodeProperty.toArray !== undefined ) {\n\n\t\t\t// must use copy for Object3D.Euler/Quaternion\n\n\t\t\tbindingType = this.BindingType.HasFromToArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else if ( Array.isArray( nodeProperty ) ) {\n\n\t\t\tbindingType = this.BindingType.EntireArray;\n\n\t\t\tthis.resolvedProperty = nodeProperty;\n\n\t\t} else {\n\n\t\t\tthis.propertyName = propertyName;\n\n\t\t}\n\n\t\t// select getter / setter\n\t\tthis.getValue = this.GetterByBindingType[ bindingType ];\n\t\tthis.setValue = this.SetterByBindingTypeAndVersioning[ bindingType ][ versioning ];\n\n\t}\n\n\tunbind() {\n\n\t\tthis.node = null;\n\n\t\t// back to the prototype version of getValue / setValue\n\t\t// note: avoiding to mutate the shape of 'this' via 'delete'\n\t\tthis.getValue = this._getValue_unbound;\n\t\tthis.setValue = this._setValue_unbound;\n\n\t}\n\n}\n\nPropertyBinding.Composite = Composite;\n\nPropertyBinding.prototype.BindingType = {\n\tDirect: 0,\n\tEntireArray: 1,\n\tArrayElement: 2,\n\tHasFromToArray: 3\n};\n\nPropertyBinding.prototype.Versioning = {\n\tNone: 0,\n\tNeedsUpdate: 1,\n\tMatrixWorldNeedsUpdate: 2\n};\n\nPropertyBinding.prototype.GetterByBindingType = [\n\n\tPropertyBinding.prototype._getValue_direct,\n\tPropertyBinding.prototype._getValue_array,\n\tPropertyBinding.prototype._getValue_arrayElement,\n\tPropertyBinding.prototype._getValue_toArray,\n\n];\n\nPropertyBinding.prototype.SetterByBindingTypeAndVersioning = [\n\n\t[\n\t\t// Direct\n\t\tPropertyBinding.prototype._setValue_direct,\n\t\tPropertyBinding.prototype._setValue_direct_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// EntireArray\n\n\t\tPropertyBinding.prototype._setValue_array,\n\t\tPropertyBinding.prototype._setValue_array_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// ArrayElement\n\t\tPropertyBinding.prototype._setValue_arrayElement,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate,\n\n\t], [\n\n\t\t// HasToFromArray\n\t\tPropertyBinding.prototype._setValue_fromArray,\n\t\tPropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,\n\t\tPropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate,\n\n\t]\n\n];\n\n/**\n *\n * A group of objects that receives a shared animation state.\n *\n * Usage:\n *\n *  - Add objects you would otherwise pass as 'root' to the\n *    constructor or the .clipAction method of AnimationMixer.\n *\n *  - Instead pass this object as 'root'.\n *\n *  - You can also add and remove objects later when the mixer\n *    is running.\n *\n * Note:\n *\n *    Objects of this class appear as one object to the mixer,\n *    so cache control of the individual objects must be done\n *    on the group.\n *\n * Limitation:\n *\n *  - The animated properties must be compatible among the\n *    all objects in the group.\n *\n *  - A single property can either be controlled through a\n *    target group or directly, but not both.\n */\n\nclass AnimationObjectGroup {\n\n\tconstructor() {\n\n\t\tthis.isAnimationObjectGroup = true;\n\n\t\tthis.uuid = generateUUID();\n\n\t\t// cached objects followed by the active ones\n\t\tthis._objects = Array.prototype.slice.call( arguments );\n\n\t\tthis.nCachedObjects_ = 0; // threshold\n\t\t// note: read by PropertyBinding.Composite\n\n\t\tconst indices = {};\n\t\tthis._indicesByUUID = indices; // for bookkeeping\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tindices[ arguments[ i ].uuid ] = i;\n\n\t\t}\n\n\t\tthis._paths = []; // inside: string\n\t\tthis._parsedPaths = []; // inside: { we don't care, here }\n\t\tthis._bindings = []; // inside: Array< PropertyBinding >\n\t\tthis._bindingsIndicesByPath = {}; // inside: indices in these arrays\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tobjects: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._objects.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn this.total - scope.nCachedObjects_;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tget bindingsPerObject() {\n\n\t\t\t\treturn scope._bindings.length;\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\tadd() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tpaths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet knownObject = undefined,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid;\n\t\t\tlet index = indicesByUUID[ uuid ];\n\n\t\t\tif ( index === undefined ) {\n\n\t\t\t\t// unknown object -> add it to the ACTIVE region\n\n\t\t\t\tindex = nObjects ++;\n\t\t\t\tindicesByUUID[ uuid ] = index;\n\t\t\t\tobjects.push( object );\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tbindings[ j ].push( new PropertyBinding( object, paths[ j ], parsedPaths[ j ] ) );\n\n\t\t\t\t}\n\n\t\t\t} else if ( index < nCachedObjects ) {\n\n\t\t\t\tknownObject = objects[ index ];\n\n\t\t\t\t// move existing object to the ACTIVE region\n\n\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ];\n\n\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = firstActiveIndex;\n\t\t\t\tobjects[ firstActiveIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ];\n\n\t\t\t\t\tlet binding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\n\t\t\t\t\tif ( binding === undefined ) {\n\n\t\t\t\t\t\t// since we do not bother to create new bindings\n\t\t\t\t\t\t// for objects that are cached, the binding may\n\t\t\t\t\t\t// or may not exist\n\n\t\t\t\t\t\tbinding = new PropertyBinding( object, paths[ j ], parsedPaths[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t} else if ( objects[ index ] !== knownObject ) {\n\n\t\t\t\tconsole.error( 'THREE.AnimationObjectGroup: Different objects with the same UUID ' +\n\t\t\t\t\t'detected. Clean the caches or recreate your infrastructure when reloading scenes.' );\n\n\t\t\t} // else the object is already where we want it to be\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\tremove() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined && index >= nCachedObjects ) {\n\n\t\t\t\t// move existing object into the CACHED region\n\n\t\t\t\tconst lastCachedIndex = nCachedObjects ++,\n\t\t\t\t\tfirstActiveObject = objects[ lastCachedIndex ];\n\n\t\t\t\tindicesByUUID[ firstActiveObject.uuid ] = index;\n\t\t\t\tobjects[ index ] = firstActiveObject;\n\n\t\t\t\tindicesByUUID[ uuid ] = lastCachedIndex;\n\t\t\t\tobjects[ lastCachedIndex ] = object;\n\n\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\tfirstActive = bindingsForPath[ lastCachedIndex ],\n\t\t\t\t\t\tbinding = bindingsForPath[ index ];\n\n\t\t\t\t\tbindingsForPath[ index ] = firstActive;\n\t\t\t\t\tbindingsForPath[ lastCachedIndex ] = binding;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// remove & forget\n\tuncache() {\n\n\t\tconst objects = this._objects,\n\t\t\tindicesByUUID = this._indicesByUUID,\n\t\t\tbindings = this._bindings,\n\t\t\tnBindings = bindings.length;\n\n\t\tlet nCachedObjects = this.nCachedObjects_,\n\t\t\tnObjects = objects.length;\n\n\t\tfor ( let i = 0, n = arguments.length; i !== n; ++ i ) {\n\n\t\t\tconst object = arguments[ i ],\n\t\t\t\tuuid = object.uuid,\n\t\t\t\tindex = indicesByUUID[ uuid ];\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tdelete indicesByUUID[ uuid ];\n\n\t\t\t\tif ( index < nCachedObjects ) {\n\n\t\t\t\t\t// object is cached, shrink the CACHED region\n\n\t\t\t\t\tconst firstActiveIndex = -- nCachedObjects,\n\t\t\t\t\t\tlastCachedObject = objects[ firstActiveIndex ],\n\t\t\t\t\t\tlastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\t// last cached object takes this object's place\n\t\t\t\t\tindicesByUUID[ lastCachedObject.uuid ] = index;\n\t\t\t\t\tobjects[ index ] = lastCachedObject;\n\n\t\t\t\t\t// last object goes to the activated slot and pop\n\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = firstActiveIndex;\n\t\t\t\t\tobjects[ firstActiveIndex ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ],\n\t\t\t\t\t\t\tlastCached = bindingsForPath[ firstActiveIndex ],\n\t\t\t\t\t\t\tlast = bindingsForPath[ lastIndex ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = lastCached;\n\t\t\t\t\t\tbindingsForPath[ firstActiveIndex ] = last;\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// object is active, just swap with the last and pop\n\n\t\t\t\t\tconst lastIndex = -- nObjects,\n\t\t\t\t\t\tlastObject = objects[ lastIndex ];\n\n\t\t\t\t\tif ( lastIndex > 0 ) {\n\n\t\t\t\t\t\tindicesByUUID[ lastObject.uuid ] = index;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobjects[ index ] = lastObject;\n\t\t\t\t\tobjects.pop();\n\n\t\t\t\t\t// accounting is done, now do the same for all bindings\n\n\t\t\t\t\tfor ( let j = 0, m = nBindings; j !== m; ++ j ) {\n\n\t\t\t\t\t\tconst bindingsForPath = bindings[ j ];\n\n\t\t\t\t\t\tbindingsForPath[ index ] = bindingsForPath[ lastIndex ];\n\t\t\t\t\t\tbindingsForPath.pop();\n\n\t\t\t\t\t}\n\n\t\t\t\t} // cached or active\n\n\t\t\t} // if object is known\n\n\t\t} // for arguments\n\n\t\tthis.nCachedObjects_ = nCachedObjects;\n\n\t}\n\n\t// Internal interface used by befriended PropertyBinding.Composite:\n\n\tsubscribe_( path, parsedPath ) {\n\n\t\t// returns an array of bindings for the given path that is changed\n\t\t// according to the contained objects in the group\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath;\n\t\tlet index = indicesByPath[ path ];\n\t\tconst bindings = this._bindings;\n\n\t\tif ( index !== undefined ) return bindings[ index ];\n\n\t\tconst paths = this._paths,\n\t\t\tparsedPaths = this._parsedPaths,\n\t\t\tobjects = this._objects,\n\t\t\tnObjects = objects.length,\n\t\t\tnCachedObjects = this.nCachedObjects_,\n\t\t\tbindingsForPath = new Array( nObjects );\n\n\t\tindex = bindings.length;\n\n\t\tindicesByPath[ path ] = index;\n\n\t\tpaths.push( path );\n\t\tparsedPaths.push( parsedPath );\n\t\tbindings.push( bindingsForPath );\n\n\t\tfor ( let i = nCachedObjects, n = objects.length; i !== n; ++ i ) {\n\n\t\t\tconst object = objects[ i ];\n\t\t\tbindingsForPath[ i ] = new PropertyBinding( object, path, parsedPath );\n\n\t\t}\n\n\t\treturn bindingsForPath;\n\n\t}\n\n\tunsubscribe_( path ) {\n\n\t\t// tells the group to forget about a property path and no longer\n\t\t// update the array previously obtained with 'subscribe_'\n\n\t\tconst indicesByPath = this._bindingsIndicesByPath,\n\t\t\tindex = indicesByPath[ path ];\n\n\t\tif ( index !== undefined ) {\n\n\t\t\tconst paths = this._paths,\n\t\t\t\tparsedPaths = this._parsedPaths,\n\t\t\t\tbindings = this._bindings,\n\t\t\t\tlastBindingsIndex = bindings.length - 1,\n\t\t\t\tlastBindings = bindings[ lastBindingsIndex ],\n\t\t\t\tlastBindingsPath = path[ lastBindingsIndex ];\n\n\t\t\tindicesByPath[ lastBindingsPath ] = index;\n\n\t\t\tbindings[ index ] = lastBindings;\n\t\t\tbindings.pop();\n\n\t\t\tparsedPaths[ index ] = parsedPaths[ lastBindingsIndex ];\n\t\t\tparsedPaths.pop();\n\n\t\t\tpaths[ index ] = paths[ lastBindingsIndex ];\n\t\t\tpaths.pop();\n\n\t\t}\n\n\t}\n\n}\n\nclass AnimationAction {\n\n\tconstructor( mixer, clip, localRoot = null, blendMode = clip.blendMode ) {\n\n\t\tthis._mixer = mixer;\n\t\tthis._clip = clip;\n\t\tthis._localRoot = localRoot;\n\t\tthis.blendMode = blendMode;\n\n\t\tconst tracks = clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tinterpolants = new Array( nTracks );\n\n\t\tconst interpolantSettings = {\n\t\t\tendingStart: ZeroCurvatureEnding,\n\t\t\tendingEnd: ZeroCurvatureEnding\n\t\t};\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst interpolant = tracks[ i ].createInterpolant( null );\n\t\t\tinterpolants[ i ] = interpolant;\n\t\t\tinterpolant.settings = interpolantSettings;\n\n\t\t}\n\n\t\tthis._interpolantSettings = interpolantSettings;\n\n\t\tthis._interpolants = interpolants; // bound by the mixer\n\n\t\t// inside: PropertyMixer (managed by the mixer)\n\t\tthis._propertyBindings = new Array( nTracks );\n\n\t\tthis._cacheIndex = null; // for the memory manager\n\t\tthis._byClipCacheIndex = null; // for the memory manager\n\n\t\tthis._timeScaleInterpolant = null;\n\t\tthis._weightInterpolant = null;\n\n\t\tthis.loop = LoopRepeat;\n\t\tthis._loopCount = - 1;\n\n\t\t// global mixer time when the action is to be started\n\t\t// it's set back to 'null' upon start of the action\n\t\tthis._startTime = null;\n\n\t\t// scaled local time of the action\n\t\t// gets clamped or wrapped to 0..clip.duration according to loop\n\t\tthis.time = 0;\n\n\t\tthis.timeScale = 1;\n\t\tthis._effectiveTimeScale = 1;\n\n\t\tthis.weight = 1;\n\t\tthis._effectiveWeight = 1;\n\n\t\tthis.repetitions = Infinity; // no. of repetitions when looping\n\n\t\tthis.paused = false; // true -> zero effective time scale\n\t\tthis.enabled = true; // false -> zero effective weight\n\n\t\tthis.clampWhenFinished = false;// keep feeding the last frame?\n\n\t\tthis.zeroSlopeAtStart = true;// for smooth interpolation w/o separate\n\t\tthis.zeroSlopeAtEnd = true;// clips for start, loop and end\n\n\t}\n\n\t// State & Scheduling\n\n\tplay() {\n\n\t\tthis._mixer._activateAction( this );\n\n\t\treturn this;\n\n\t}\n\n\tstop() {\n\n\t\tthis._mixer._deactivateAction( this );\n\n\t\treturn this.reset();\n\n\t}\n\n\treset() {\n\n\t\tthis.paused = false;\n\t\tthis.enabled = true;\n\n\t\tthis.time = 0; // restart clip\n\t\tthis._loopCount = - 1;// forget previous loops\n\t\tthis._startTime = null;// forget scheduling\n\n\t\treturn this.stopFading().stopWarping();\n\n\t}\n\n\tisRunning() {\n\n\t\treturn this.enabled && ! this.paused && this.timeScale !== 0 &&\n\t\t\tthis._startTime === null && this._mixer._isActiveAction( this );\n\n\t}\n\n\t// return true when play has been called\n\tisScheduled() {\n\n\t\treturn this._mixer._isActiveAction( this );\n\n\t}\n\n\tstartAt( time ) {\n\n\t\tthis._startTime = time;\n\n\t\treturn this;\n\n\t}\n\n\tsetLoop( mode, repetitions ) {\n\n\t\tthis.loop = mode;\n\t\tthis.repetitions = repetitions;\n\n\t\treturn this;\n\n\t}\n\n\t// Weight\n\n\t// set the weight stopping any scheduled fading\n\t// although .enabled = false yields an effective weight of zero, this\n\t// method does *not* change .enabled, because it would be confusing\n\tsetEffectiveWeight( weight ) {\n\n\t\tthis.weight = weight;\n\n\t\t// note: same logic as when updated at runtime\n\t\tthis._effectiveWeight = this.enabled ? weight : 0;\n\n\t\treturn this.stopFading();\n\n\t}\n\n\t// return the weight considering fading and .enabled\n\tgetEffectiveWeight() {\n\n\t\treturn this._effectiveWeight;\n\n\t}\n\n\tfadeIn( duration ) {\n\n\t\treturn this._scheduleFading( duration, 0, 1 );\n\n\t}\n\n\tfadeOut( duration ) {\n\n\t\treturn this._scheduleFading( duration, 1, 0 );\n\n\t}\n\n\tcrossFadeFrom( fadeOutAction, duration, warp ) {\n\n\t\tfadeOutAction.fadeOut( duration );\n\t\tthis.fadeIn( duration );\n\n\t\tif ( warp ) {\n\n\t\t\tconst fadeInDuration = this._clip.duration,\n\t\t\t\tfadeOutDuration = fadeOutAction._clip.duration,\n\n\t\t\t\tstartEndRatio = fadeOutDuration / fadeInDuration,\n\t\t\t\tendStartRatio = fadeInDuration / fadeOutDuration;\n\n\t\t\tfadeOutAction.warp( 1.0, startEndRatio, duration );\n\t\t\tthis.warp( endStartRatio, 1.0, duration );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tcrossFadeTo( fadeInAction, duration, warp ) {\n\n\t\treturn fadeInAction.crossFadeFrom( this, duration, warp );\n\n\t}\n\n\tstopFading() {\n\n\t\tconst weightInterpolant = this._weightInterpolant;\n\n\t\tif ( weightInterpolant !== null ) {\n\n\t\t\tthis._weightInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( weightInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Time Scale Control\n\n\t// set the time scale stopping any scheduled warping\n\t// although .paused = true yields an effective time scale of zero, this\n\t// method does *not* change .paused, because it would be confusing\n\tsetEffectiveTimeScale( timeScale ) {\n\n\t\tthis.timeScale = timeScale;\n\t\tthis._effectiveTimeScale = this.paused ? 0 : timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\t// return the time scale considering warping and .paused\n\tgetEffectiveTimeScale() {\n\n\t\treturn this._effectiveTimeScale;\n\n\t}\n\n\tsetDuration( duration ) {\n\n\t\tthis.timeScale = this._clip.duration / duration;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\tsyncWith( action ) {\n\n\t\tthis.time = action.time;\n\t\tthis.timeScale = action.timeScale;\n\n\t\treturn this.stopWarping();\n\n\t}\n\n\thalt( duration ) {\n\n\t\treturn this.warp( this._effectiveTimeScale, 0, duration );\n\n\t}\n\n\twarp( startTimeScale, endTimeScale, duration ) {\n\n\t\tconst mixer = this._mixer,\n\t\t\tnow = mixer.time,\n\t\t\ttimeScale = this.timeScale;\n\n\t\tlet interpolant = this._timeScaleInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._timeScaleInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\ttimes[ 1 ] = now + duration;\n\n\t\tvalues[ 0 ] = startTimeScale / timeScale;\n\t\tvalues[ 1 ] = endTimeScale / timeScale;\n\n\t\treturn this;\n\n\t}\n\n\tstopWarping() {\n\n\t\tconst timeScaleInterpolant = this._timeScaleInterpolant;\n\n\t\tif ( timeScaleInterpolant !== null ) {\n\n\t\t\tthis._timeScaleInterpolant = null;\n\t\t\tthis._mixer._takeBackControlInterpolant( timeScaleInterpolant );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Object Accessors\n\n\tgetMixer() {\n\n\t\treturn this._mixer;\n\n\t}\n\n\tgetClip() {\n\n\t\treturn this._clip;\n\n\t}\n\n\tgetRoot() {\n\n\t\treturn this._localRoot || this._mixer._root;\n\n\t}\n\n\t// Interna\n\n\t_update( time, deltaTime, timeDirection, accuIndex ) {\n\n\t\t// called by the mixer\n\n\t\tif ( ! this.enabled ) {\n\n\t\t\t// call ._updateWeight() to update ._effectiveWeight\n\n\t\t\tthis._updateWeight( time );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst startTime = this._startTime;\n\n\t\tif ( startTime !== null ) {\n\n\t\t\t// check for scheduled start of action\n\n\t\t\tconst timeRunning = ( time - startTime ) * timeDirection;\n\t\t\tif ( timeRunning < 0 || timeDirection === 0 ) {\n\n\t\t\t\tdeltaTime = 0;\n\n\t\t\t} else {\n\n\n\t\t\t\tthis._startTime = null; // unschedule\n\t\t\t\tdeltaTime = timeDirection * timeRunning;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// apply time scale and advance time\n\n\t\tdeltaTime *= this._updateTimeScale( time );\n\t\tconst clipTime = this._updateTime( deltaTime );\n\n\t\t// note: _updateTime may disable the action resulting in\n\t\t// an effective weight of 0\n\n\t\tconst weight = this._updateWeight( time );\n\n\t\tif ( weight > 0 ) {\n\n\t\t\tconst interpolants = this._interpolants;\n\t\t\tconst propertyMixers = this._propertyBindings;\n\n\t\t\tswitch ( this.blendMode ) {\n\n\t\t\t\tcase AdditiveAnimationBlendMode:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulateAdditive( weight );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NormalAnimationBlendMode:\n\t\t\t\tdefault:\n\n\t\t\t\t\tfor ( let j = 0, m = interpolants.length; j !== m; ++ j ) {\n\n\t\t\t\t\t\tinterpolants[ j ].evaluate( clipTime );\n\t\t\t\t\t\tpropertyMixers[ j ].accumulate( accuIndex, weight );\n\n\t\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_updateWeight( time ) {\n\n\t\tlet weight = 0;\n\n\t\tif ( this.enabled ) {\n\n\t\t\tweight = this.weight;\n\t\t\tconst interpolant = this._weightInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\tweight *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopFading();\n\n\t\t\t\t\tif ( interpolantValue === 0 ) {\n\n\t\t\t\t\t\t// faded out, disable\n\t\t\t\t\t\tthis.enabled = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveWeight = weight;\n\t\treturn weight;\n\n\t}\n\n\t_updateTimeScale( time ) {\n\n\t\tlet timeScale = 0;\n\n\t\tif ( ! this.paused ) {\n\n\t\t\ttimeScale = this.timeScale;\n\n\t\t\tconst interpolant = this._timeScaleInterpolant;\n\n\t\t\tif ( interpolant !== null ) {\n\n\t\t\t\tconst interpolantValue = interpolant.evaluate( time )[ 0 ];\n\n\t\t\t\ttimeScale *= interpolantValue;\n\n\t\t\t\tif ( time > interpolant.parameterPositions[ 1 ] ) {\n\n\t\t\t\t\tthis.stopWarping();\n\n\t\t\t\t\tif ( timeScale === 0 ) {\n\n\t\t\t\t\t\t// motion has halted, pause\n\t\t\t\t\t\tthis.paused = true;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// warp done - apply final time scale\n\t\t\t\t\t\tthis.timeScale = timeScale;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._effectiveTimeScale = timeScale;\n\t\treturn timeScale;\n\n\t}\n\n\t_updateTime( deltaTime ) {\n\n\t\tconst duration = this._clip.duration;\n\t\tconst loop = this.loop;\n\n\t\tlet time = this.time + deltaTime;\n\t\tlet loopCount = this._loopCount;\n\n\t\tconst pingPong = ( loop === LoopPingPong );\n\n\t\tif ( deltaTime === 0 ) {\n\n\t\t\tif ( loopCount === - 1 ) return time;\n\n\t\t\treturn ( pingPong && ( loopCount & 1 ) === 1 ) ? duration - time : time;\n\n\t\t}\n\n\t\tif ( loop === LoopOnce ) {\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tthis._loopCount = 0;\n\t\t\t\tthis._setEndings( true, true, false );\n\n\t\t\t}\n\n\t\t\thandle_stop: {\n\n\t\t\t\tif ( time >= duration ) {\n\n\t\t\t\t\ttime = duration;\n\n\t\t\t\t} else if ( time < 0 ) {\n\n\t\t\t\t\ttime = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tbreak handle_stop;\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\telse this.enabled = false;\n\n\t\t\t\tthis.time = time;\n\n\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\tdirection: deltaTime < 0 ? - 1 : 1\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else { // repetitive Repeat or PingPong\n\n\t\t\tif ( loopCount === - 1 ) {\n\n\t\t\t\t// just started\n\n\t\t\t\tif ( deltaTime >= 0 ) {\n\n\t\t\t\t\tloopCount = 0;\n\n\t\t\t\t\tthis._setEndings( true, this.repetitions === 0, pingPong );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// when looping in reverse direction, the initial\n\t\t\t\t\t// transition through zero counts as a repetition,\n\t\t\t\t\t// so leave loopCount at -1\n\n\t\t\t\t\tthis._setEndings( this.repetitions === 0, true, pingPong );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( time >= duration || time < 0 ) {\n\n\t\t\t\t// wrap around\n\n\t\t\t\tconst loopDelta = Math.floor( time / duration ); // signed\n\t\t\t\ttime -= duration * loopDelta;\n\n\t\t\t\tloopCount += Math.abs( loopDelta );\n\n\t\t\t\tconst pending = this.repetitions - loopCount;\n\n\t\t\t\tif ( pending <= 0 ) {\n\n\t\t\t\t\t// have to stop (switch state, clamp time, fire event)\n\n\t\t\t\t\tif ( this.clampWhenFinished ) this.paused = true;\n\t\t\t\t\telse this.enabled = false;\n\n\t\t\t\t\ttime = deltaTime > 0 ? duration : 0;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'finished', action: this,\n\t\t\t\t\t\tdirection: deltaTime > 0 ? 1 : - 1\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// keep running\n\n\t\t\t\t\tif ( pending === 1 ) {\n\n\t\t\t\t\t\t// entering the last round\n\n\t\t\t\t\t\tconst atStart = deltaTime < 0;\n\t\t\t\t\t\tthis._setEndings( atStart, ! atStart, pingPong );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthis._setEndings( false, false, pingPong );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._loopCount = loopCount;\n\n\t\t\t\t\tthis.time = time;\n\n\t\t\t\t\tthis._mixer.dispatchEvent( {\n\t\t\t\t\t\ttype: 'loop', action: this, loopDelta: loopDelta\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis.time = time;\n\n\t\t\t}\n\n\t\t\tif ( pingPong && ( loopCount & 1 ) === 1 ) {\n\n\t\t\t\t// invert time for the \"pong round\"\n\n\t\t\t\treturn duration - time;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn time;\n\n\t}\n\n\t_setEndings( atStart, atEnd, pingPong ) {\n\n\t\tconst settings = this._interpolantSettings;\n\n\t\tif ( pingPong ) {\n\n\t\t\tsettings.endingStart = ZeroSlopeEnding;\n\t\t\tsettings.endingEnd = ZeroSlopeEnding;\n\n\t\t} else {\n\n\t\t\t// assuming for LoopOnce atStart == atEnd == true\n\n\t\t\tif ( atStart ) {\n\n\t\t\t\tsettings.endingStart = this.zeroSlopeAtStart ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingStart = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t\tif ( atEnd ) {\n\n\t\t\t\tsettings.endingEnd = this.zeroSlopeAtEnd ? ZeroSlopeEnding : ZeroCurvatureEnding;\n\n\t\t\t} else {\n\n\t\t\t\tsettings.endingEnd \t = WrapAroundEnding;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_scheduleFading( duration, weightNow, weightThen ) {\n\n\t\tconst mixer = this._mixer, now = mixer.time;\n\t\tlet interpolant = this._weightInterpolant;\n\n\t\tif ( interpolant === null ) {\n\n\t\t\tinterpolant = mixer._lendControlInterpolant();\n\t\t\tthis._weightInterpolant = interpolant;\n\n\t\t}\n\n\t\tconst times = interpolant.parameterPositions,\n\t\t\tvalues = interpolant.sampleValues;\n\n\t\ttimes[ 0 ] = now;\n\t\tvalues[ 0 ] = weightNow;\n\t\ttimes[ 1 ] = now + duration;\n\t\tvalues[ 1 ] = weightThen;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _controlInterpolantsResultBuffer = new Float32Array( 1 );\n\n\nclass AnimationMixer extends EventDispatcher {\n\n\tconstructor( root ) {\n\n\t\tsuper();\n\n\t\tthis._root = root;\n\t\tthis._initMemoryManager();\n\t\tthis._accuIndex = 0;\n\t\tthis.time = 0;\n\t\tthis.timeScale = 1.0;\n\n\t}\n\n\t_bindAction( action, prototypeAction ) {\n\n\t\tconst root = action._localRoot || this._root,\n\t\t\ttracks = action._clip.tracks,\n\t\t\tnTracks = tracks.length,\n\t\t\tbindings = action._propertyBindings,\n\t\t\tinterpolants = action._interpolants,\n\t\t\trootUuid = root.uuid,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName;\n\n\t\tlet bindingsByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingsByName === undefined ) {\n\n\t\t\tbindingsByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingsByName;\n\n\t\t}\n\n\t\tfor ( let i = 0; i !== nTracks; ++ i ) {\n\n\t\t\tconst track = tracks[ i ],\n\t\t\t\ttrackName = track.name;\n\n\t\t\tlet binding = bindingsByName[ trackName ];\n\n\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t} else {\n\n\t\t\t\tbinding = bindings[ i ];\n\n\t\t\t\tif ( binding !== undefined ) {\n\n\t\t\t\t\t// existing binding, make sure the cache knows\n\n\t\t\t\t\tif ( binding._cacheIndex === null ) {\n\n\t\t\t\t\t\t++ binding.referenceCount;\n\t\t\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\tconst path = prototypeAction && prototypeAction.\n\t\t\t\t\t_propertyBindings[ i ].binding.parsedPath;\n\n\t\t\t\tbinding = new PropertyMixer(\n\t\t\t\t\tPropertyBinding.create( root, trackName, path ),\n\t\t\t\t\ttrack.ValueTypeName, track.getValueSize() );\n\n\t\t\t\t++ binding.referenceCount;\n\t\t\t\tthis._addInactiveBinding( binding, rootUuid, trackName );\n\n\t\t\t\tbindings[ i ] = binding;\n\n\t\t\t}\n\n\t\t\tinterpolants[ i ].resultBuffer = binding.buffer;\n\n\t\t}\n\n\t}\n\n\t_activateAction( action ) {\n\n\t\tif ( ! this._isActiveAction( action ) ) {\n\n\t\t\tif ( action._cacheIndex === null ) {\n\n\t\t\t\t// this action has been forgotten by the cache, but the user\n\t\t\t\t// appears to be still using it -> rebind\n\n\t\t\t\tconst rootUuid = ( action._localRoot || this._root ).uuid,\n\t\t\t\t\tclipUuid = action._clip.uuid,\n\t\t\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\t\t\tthis._bindAction( action,\n\t\t\t\t\tactionsForClip && actionsForClip.knownActions[ 0 ] );\n\n\t\t\t\tthis._addInactiveAction( action, clipUuid, rootUuid );\n\n\t\t\t}\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// increment reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( binding.useCount ++ === 0 ) {\n\n\t\t\t\t\tthis._lendBinding( binding );\n\t\t\t\t\tbinding.saveOriginalState();\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._lendAction( action );\n\n\t\t}\n\n\t}\n\n\t_deactivateAction( action ) {\n\n\t\tif ( this._isActiveAction( action ) ) {\n\n\t\t\tconst bindings = action._propertyBindings;\n\n\t\t\t// decrement reference counts / sort out state\n\t\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\t\tconst binding = bindings[ i ];\n\n\t\t\t\tif ( -- binding.useCount === 0 ) {\n\n\t\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\t\tthis._takeBackBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._takeBackAction( action );\n\n\t\t}\n\n\t}\n\n\t// Memory manager\n\n\t_initMemoryManager() {\n\n\t\tthis._actions = []; // 'nActiveActions' followed by inactive ones\n\t\tthis._nActiveActions = 0;\n\n\t\tthis._actionsByClip = {};\n\t\t// inside:\n\t\t// {\n\t\t// \tknownActions: Array< AnimationAction > - used as prototypes\n\t\t// \tactionByRoot: AnimationAction - lookup\n\t\t// }\n\n\n\t\tthis._bindings = []; // 'nActiveBindings' followed by inactive ones\n\t\tthis._nActiveBindings = 0;\n\n\t\tthis._bindingsByRootAndName = {}; // inside: Map< name, PropertyMixer >\n\n\n\t\tthis._controlInterpolants = []; // same game as above\n\t\tthis._nActiveControlInterpolants = 0;\n\n\t\tconst scope = this;\n\n\t\tthis.stats = {\n\n\t\t\tactions: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._actions.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveActions;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tbindings: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._bindings.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveBindings;\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontrolInterpolants: {\n\t\t\t\tget total() {\n\n\t\t\t\t\treturn scope._controlInterpolants.length;\n\n\t\t\t\t},\n\t\t\t\tget inUse() {\n\n\t\t\t\t\treturn scope._nActiveControlInterpolants;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t// Memory management for AnimationAction objects\n\n\t_isActiveAction( action ) {\n\n\t\tconst index = action._cacheIndex;\n\t\treturn index !== null && index < this._nActiveActions;\n\n\t}\n\n\t_addInactiveAction( action, clipUuid, rootUuid ) {\n\n\t\tconst actions = this._actions,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tlet actionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip === undefined ) {\n\n\t\t\tactionsForClip = {\n\n\t\t\t\tknownActions: [ action ],\n\t\t\t\tactionByRoot: {}\n\n\t\t\t};\n\n\t\t\taction._byClipCacheIndex = 0;\n\n\t\t\tactionsByClip[ clipUuid ] = actionsForClip;\n\n\t\t} else {\n\n\t\t\tconst knownActions = actionsForClip.knownActions;\n\n\t\t\taction._byClipCacheIndex = knownActions.length;\n\t\t\tknownActions.push( action );\n\n\t\t}\n\n\t\taction._cacheIndex = actions.length;\n\t\tactions.push( action );\n\n\t\tactionsForClip.actionByRoot[ rootUuid ] = action;\n\n\t}\n\n\t_removeInactiveAction( action ) {\n\n\t\tconst actions = this._actions,\n\t\t\tlastInactiveAction = actions[ actions.length - 1 ],\n\t\t\tcacheIndex = action._cacheIndex;\n\n\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\tactions.pop();\n\n\t\taction._cacheIndex = null;\n\n\n\t\tconst clipUuid = action._clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ],\n\t\t\tknownActionsForClip = actionsForClip.knownActions,\n\n\t\t\tlastKnownAction =\n\t\t\t\tknownActionsForClip[ knownActionsForClip.length - 1 ],\n\n\t\t\tbyClipCacheIndex = action._byClipCacheIndex;\n\n\t\tlastKnownAction._byClipCacheIndex = byClipCacheIndex;\n\t\tknownActionsForClip[ byClipCacheIndex ] = lastKnownAction;\n\t\tknownActionsForClip.pop();\n\n\t\taction._byClipCacheIndex = null;\n\n\n\t\tconst actionByRoot = actionsForClip.actionByRoot,\n\t\t\trootUuid = ( action._localRoot || this._root ).uuid;\n\n\t\tdelete actionByRoot[ rootUuid ];\n\n\t\tif ( knownActionsForClip.length === 0 ) {\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t\tthis._removeInactiveBindingsForAction( action );\n\n\t}\n\n\t_removeInactiveBindingsForAction( action ) {\n\n\t\tconst bindings = action._propertyBindings;\n\n\t\tfor ( let i = 0, n = bindings.length; i !== n; ++ i ) {\n\n\t\t\tconst binding = bindings[ i ];\n\n\t\t\tif ( -- binding.referenceCount === 0 ) {\n\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_lendAction( action ) {\n\n\t\t// [ active actions |  inactive actions  ]\n\t\t// [  active actions >| inactive actions ]\n\t\t//                 s        a\n\t\t//                  <-swap->\n\t\t//                 a        s\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveActions ++,\n\n\t\t\tfirstInactiveAction = actions[ lastActiveIndex ];\n\n\t\taction._cacheIndex = lastActiveIndex;\n\t\tactions[ lastActiveIndex ] = action;\n\n\t\tfirstInactiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = firstInactiveAction;\n\n\t}\n\n\t_takeBackAction( action ) {\n\n\t\t// [  active actions  | inactive actions ]\n\t\t// [ active actions |< inactive actions  ]\n\t\t//        a        s\n\t\t//         <-swap->\n\t\t//        s        a\n\n\t\tconst actions = this._actions,\n\t\t\tprevIndex = action._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveActions,\n\n\t\t\tlastActiveAction = actions[ firstInactiveIndex ];\n\n\t\taction._cacheIndex = firstInactiveIndex;\n\t\tactions[ firstInactiveIndex ] = action;\n\n\t\tlastActiveAction._cacheIndex = prevIndex;\n\t\tactions[ prevIndex ] = lastActiveAction;\n\n\t}\n\n\t// Memory management for PropertyMixer objects\n\n\t_addInactiveBinding( binding, rootUuid, trackName ) {\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindings = this._bindings;\n\n\t\tlet bindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName === undefined ) {\n\n\t\t\tbindingByName = {};\n\t\t\tbindingsByRoot[ rootUuid ] = bindingByName;\n\n\t\t}\n\n\t\tbindingByName[ trackName ] = binding;\n\n\t\tbinding._cacheIndex = bindings.length;\n\t\tbindings.push( binding );\n\n\t}\n\n\t_removeInactiveBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tpropBinding = binding.binding,\n\t\t\trootUuid = propBinding.rootNode.uuid,\n\t\t\ttrackName = propBinding.path,\n\t\t\tbindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ],\n\n\t\t\tlastInactiveBinding = bindings[ bindings.length - 1 ],\n\t\t\tcacheIndex = binding._cacheIndex;\n\n\t\tlastInactiveBinding._cacheIndex = cacheIndex;\n\t\tbindings[ cacheIndex ] = lastInactiveBinding;\n\t\tbindings.pop();\n\n\t\tdelete bindingByName[ trackName ];\n\n\t\tif ( Object.keys( bindingByName ).length === 0 ) {\n\n\t\t\tdelete bindingsByRoot[ rootUuid ];\n\n\t\t}\n\n\t}\n\n\t_lendBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tlastActiveIndex = this._nActiveBindings ++,\n\n\t\t\tfirstInactiveBinding = bindings[ lastActiveIndex ];\n\n\t\tbinding._cacheIndex = lastActiveIndex;\n\t\tbindings[ lastActiveIndex ] = binding;\n\n\t\tfirstInactiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = firstInactiveBinding;\n\n\t}\n\n\t_takeBackBinding( binding ) {\n\n\t\tconst bindings = this._bindings,\n\t\t\tprevIndex = binding._cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveBindings,\n\n\t\t\tlastActiveBinding = bindings[ firstInactiveIndex ];\n\n\t\tbinding._cacheIndex = firstInactiveIndex;\n\t\tbindings[ firstInactiveIndex ] = binding;\n\n\t\tlastActiveBinding._cacheIndex = prevIndex;\n\t\tbindings[ prevIndex ] = lastActiveBinding;\n\n\t}\n\n\n\t// Memory management of Interpolants for weight and time scale\n\n\t_lendControlInterpolant() {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tlastActiveIndex = this._nActiveControlInterpolants ++;\n\n\t\tlet interpolant = interpolants[ lastActiveIndex ];\n\n\t\tif ( interpolant === undefined ) {\n\n\t\t\tinterpolant = new LinearInterpolant(\n\t\t\t\tnew Float32Array( 2 ), new Float32Array( 2 ),\n\t\t\t\t1, _controlInterpolantsResultBuffer );\n\n\t\t\tinterpolant.__cacheIndex = lastActiveIndex;\n\t\t\tinterpolants[ lastActiveIndex ] = interpolant;\n\n\t\t}\n\n\t\treturn interpolant;\n\n\t}\n\n\t_takeBackControlInterpolant( interpolant ) {\n\n\t\tconst interpolants = this._controlInterpolants,\n\t\t\tprevIndex = interpolant.__cacheIndex,\n\n\t\t\tfirstInactiveIndex = -- this._nActiveControlInterpolants,\n\n\t\t\tlastActiveInterpolant = interpolants[ firstInactiveIndex ];\n\n\t\tinterpolant.__cacheIndex = firstInactiveIndex;\n\t\tinterpolants[ firstInactiveIndex ] = interpolant;\n\n\t\tlastActiveInterpolant.__cacheIndex = prevIndex;\n\t\tinterpolants[ prevIndex ] = lastActiveInterpolant;\n\n\t}\n\n\t// return an action for a clip optionally using a custom root target\n\t// object (this method allocates a lot of dynamic memory in case a\n\t// previously unknown clip/root combination is specified)\n\tclipAction( clip, optionalRoot, blendMode ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid;\n\n\t\tlet clipObject = typeof clip === 'string' ? AnimationClip.findByName( root, clip ) : clip;\n\n\t\tconst clipUuid = clipObject !== null ? clipObject.uuid : clip;\n\n\t\tconst actionsForClip = this._actionsByClip[ clipUuid ];\n\t\tlet prototypeAction = null;\n\n\t\tif ( blendMode === undefined ) {\n\n\t\t\tif ( clipObject !== null ) {\n\n\t\t\t\tblendMode = clipObject.blendMode;\n\n\t\t\t} else {\n\n\t\t\t\tblendMode = NormalAnimationBlendMode;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\tconst existingAction = actionsForClip.actionByRoot[ rootUuid ];\n\n\t\t\tif ( existingAction !== undefined && existingAction.blendMode === blendMode ) {\n\n\t\t\t\treturn existingAction;\n\n\t\t\t}\n\n\t\t\t// we know the clip, so we don't have to parse all\n\t\t\t// the bindings again but can just copy\n\t\t\tprototypeAction = actionsForClip.knownActions[ 0 ];\n\n\t\t\t// also, take the clip from the prototype action\n\t\t\tif ( clipObject === null )\n\t\t\t\tclipObject = prototypeAction._clip;\n\n\t\t}\n\n\t\t// clip must be known when specified via string\n\t\tif ( clipObject === null ) return null;\n\n\t\t// allocate all resources required to run it\n\t\tconst newAction = new AnimationAction( this, clipObject, optionalRoot, blendMode );\n\n\t\tthis._bindAction( newAction, prototypeAction );\n\n\t\t// and make the action known to the memory manager\n\t\tthis._addInactiveAction( newAction, clipUuid, rootUuid );\n\n\t\treturn newAction;\n\n\t}\n\n\t// get an existing action\n\texistingAction( clip, optionalRoot ) {\n\n\t\tconst root = optionalRoot || this._root,\n\t\t\trootUuid = root.uuid,\n\n\t\t\tclipObject = typeof clip === 'string' ?\n\t\t\t\tAnimationClip.findByName( root, clip ) : clip,\n\n\t\t\tclipUuid = clipObject ? clipObject.uuid : clip,\n\n\t\t\tactionsForClip = this._actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\treturn actionsForClip.actionByRoot[ rootUuid ] || null;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t// deactivates all previously scheduled actions\n\tstopAllAction() {\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions;\n\n\t\tfor ( let i = nActions - 1; i >= 0; -- i ) {\n\n\t\t\tactions[ i ].stop();\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// advance the time and update apply the animation\n\tupdate( deltaTime ) {\n\n\t\tdeltaTime *= this.timeScale;\n\n\t\tconst actions = this._actions,\n\t\t\tnActions = this._nActiveActions,\n\n\t\t\ttime = this.time += deltaTime,\n\t\t\ttimeDirection = Math.sign( deltaTime ),\n\n\t\t\taccuIndex = this._accuIndex ^= 1;\n\n\t\t// run active actions\n\n\t\tfor ( let i = 0; i !== nActions; ++ i ) {\n\n\t\t\tconst action = actions[ i ];\n\n\t\t\taction._update( time, deltaTime, timeDirection, accuIndex );\n\n\t\t}\n\n\t\t// update scene graph\n\n\t\tconst bindings = this._bindings,\n\t\t\tnBindings = this._nActiveBindings;\n\n\t\tfor ( let i = 0; i !== nBindings; ++ i ) {\n\n\t\t\tbindings[ i ].apply( accuIndex );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t// Allows you to seek to a specific time in an animation.\n\tsetTime( timeInSeconds ) {\n\n\t\tthis.time = 0; // Zero out time attribute for AnimationMixer object;\n\t\tfor ( let i = 0; i < this._actions.length; i ++ ) {\n\n\t\t\tthis._actions[ i ].time = 0; // Zero out time attribute for all associated AnimationAction objects.\n\n\t\t}\n\n\t\treturn this.update( timeInSeconds ); // Update used to set exact time. Returns \"this\" AnimationMixer object.\n\n\t}\n\n\t// return this mixer's root target object\n\tgetRoot() {\n\n\t\treturn this._root;\n\n\t}\n\n\t// free all resources specific to a particular clip\n\tuncacheClip( clip ) {\n\n\t\tconst actions = this._actions,\n\t\t\tclipUuid = clip.uuid,\n\t\t\tactionsByClip = this._actionsByClip,\n\t\t\tactionsForClip = actionsByClip[ clipUuid ];\n\n\t\tif ( actionsForClip !== undefined ) {\n\n\t\t\t// note: just calling _removeInactiveAction would mess up the\n\t\t\t// iteration state and also require updating the state we can\n\t\t\t// just throw away\n\n\t\t\tconst actionsToRemove = actionsForClip.knownActions;\n\n\t\t\tfor ( let i = 0, n = actionsToRemove.length; i !== n; ++ i ) {\n\n\t\t\t\tconst action = actionsToRemove[ i ];\n\n\t\t\t\tthis._deactivateAction( action );\n\n\t\t\t\tconst cacheIndex = action._cacheIndex,\n\t\t\t\t\tlastInactiveAction = actions[ actions.length - 1 ];\n\n\t\t\t\taction._cacheIndex = null;\n\t\t\t\taction._byClipCacheIndex = null;\n\n\t\t\t\tlastInactiveAction._cacheIndex = cacheIndex;\n\t\t\t\tactions[ cacheIndex ] = lastInactiveAction;\n\t\t\t\tactions.pop();\n\n\t\t\t\tthis._removeInactiveBindingsForAction( action );\n\n\t\t\t}\n\n\t\t\tdelete actionsByClip[ clipUuid ];\n\n\t\t}\n\n\t}\n\n\t// free all resources specific to a particular root target object\n\tuncacheRoot( root ) {\n\n\t\tconst rootUuid = root.uuid,\n\t\t\tactionsByClip = this._actionsByClip;\n\n\t\tfor ( const clipUuid in actionsByClip ) {\n\n\t\t\tconst actionByRoot = actionsByClip[ clipUuid ].actionByRoot,\n\t\t\t\taction = actionByRoot[ rootUuid ];\n\n\t\t\tif ( action !== undefined ) {\n\n\t\t\t\tthis._deactivateAction( action );\n\t\t\t\tthis._removeInactiveAction( action );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst bindingsByRoot = this._bindingsByRootAndName,\n\t\t\tbindingByName = bindingsByRoot[ rootUuid ];\n\n\t\tif ( bindingByName !== undefined ) {\n\n\t\t\tfor ( const trackName in bindingByName ) {\n\n\t\t\t\tconst binding = bindingByName[ trackName ];\n\t\t\t\tbinding.restoreOriginalState();\n\t\t\t\tthis._removeInactiveBinding( binding );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// remove a targeted clip from the cache\n\tuncacheAction( clip, optionalRoot ) {\n\n\t\tconst action = this.existingAction( clip, optionalRoot );\n\n\t\tif ( action !== null ) {\n\n\t\t\tthis._deactivateAction( action );\n\t\t\tthis._removeInactiveAction( action );\n\n\t\t}\n\n\t}\n\n}\n\nlet Uniform$1 = class Uniform {\n\n\tconstructor( value ) {\n\n\t\tthis.value = value;\n\n\t}\n\n\tclone() {\n\n\t\treturn new Uniform( this.value.clone === undefined ? this.value : this.value.clone() );\n\n\t}\n\n};\n\nlet _id$8 = 0;\n\nlet UniformsGroup$1 = class UniformsGroup extends EventDispatcher {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isUniformsGroup = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _id$8 ++ } );\n\n\t\tthis.name = '';\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.uniforms = [];\n\n\t}\n\n\tadd( uniform ) {\n\n\t\tthis.uniforms.push( uniform );\n\n\t\treturn this;\n\n\t}\n\n\tremove( uniform ) {\n\n\t\tconst index = this.uniforms.indexOf( uniform );\n\n\t\tif ( index !== - 1 ) this.uniforms.splice( index, 1 );\n\n\t\treturn this;\n\n\t}\n\n\tsetName( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.name = source.name;\n\t\tthis.usage = source.usage;\n\n\t\tconst uniformsSource = source.uniforms;\n\n\t\tthis.uniforms.length = 0;\n\n\t\tfor ( let i = 0, l = uniformsSource.length; i < l; i ++ ) {\n\n\t\t\tconst uniforms = Array.isArray( uniformsSource[ i ] ) ? uniformsSource[ i ] : [ uniformsSource[ i ] ];\n\n\t\t\tfor ( let j = 0; j < uniforms.length; j ++ ) {\n\n\t\t\t\tthis.uniforms.push( uniforms[ j ].clone() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n};\n\nclass InstancedInterleavedBuffer extends InterleavedBuffer {\n\n\tconstructor( array, stride, meshPerAttribute = 1 ) {\n\n\t\tsuper( array, stride );\n\n\t\tthis.isInstancedInterleavedBuffer = true;\n\n\t\tthis.meshPerAttribute = meshPerAttribute;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.meshPerAttribute = source.meshPerAttribute;\n\n\t\treturn this;\n\n\t}\n\n\tclone( data ) {\n\n\t\tconst ib = super.clone( data );\n\n\t\tib.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn ib;\n\n\t}\n\n\ttoJSON( data ) {\n\n\t\tconst json = super.toJSON( data );\n\n\t\tjson.isInstancedInterleavedBuffer = true;\n\t\tjson.meshPerAttribute = this.meshPerAttribute;\n\n\t\treturn json;\n\n\t}\n\n}\n\nclass GLBufferAttribute {\n\n\tconstructor( buffer, type, itemSize, elementSize, count ) {\n\n\t\tthis.isGLBufferAttribute = true;\n\n\t\tthis.name = '';\n\n\t\tthis.buffer = buffer;\n\t\tthis.type = type;\n\t\tthis.itemSize = itemSize;\n\t\tthis.elementSize = elementSize;\n\t\tthis.count = count;\n\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tsetBuffer( buffer ) {\n\n\t\tthis.buffer = buffer;\n\n\t\treturn this;\n\n\t}\n\n\tsetType( type, elementSize ) {\n\n\t\tthis.type = type;\n\t\tthis.elementSize = elementSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetItemSize( itemSize ) {\n\n\t\tthis.itemSize = itemSize;\n\n\t\treturn this;\n\n\t}\n\n\tsetCount( count ) {\n\n\t\tthis.count = count;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _matrix = /*@__PURE__*/ new Matrix4();\n\nclass Raycaster {\n\n\tconstructor( origin, direction, near = 0, far = Infinity ) {\n\n\t\tthis.ray = new Ray( origin, direction );\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.near = near;\n\t\tthis.far = far;\n\t\tthis.camera = null;\n\t\tthis.layers = new Layers();\n\n\t\tthis.params = {\n\t\t\tMesh: {},\n\t\t\tLine: { threshold: 1 },\n\t\t\tLOD: {},\n\t\t\tPoints: { threshold: 1 },\n\t\t\tSprite: {}\n\t\t};\n\n\t}\n\n\tset( origin, direction ) {\n\n\t\t// direction is assumed to be normalized (for accurate distance calculations)\n\n\t\tthis.ray.set( origin, direction );\n\n\t}\n\n\tsetFromCamera( coords, camera ) {\n\n\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\tthis.ray.origin.setFromMatrixPosition( camera.matrixWorld );\n\t\t\tthis.ray.direction.set( coords.x, coords.y, 0.5 ).unproject( camera ).sub( this.ray.origin ).normalize();\n\t\t\tthis.camera = camera;\n\n\t\t} else if ( camera.isOrthographicCamera ) {\n\n\t\t\tthis.ray.origin.set( coords.x, coords.y, ( camera.near + camera.far ) / ( camera.near - camera.far ) ).unproject( camera ); // set origin in plane of camera\n\t\t\tthis.ray.direction.set( 0, 0, - 1 ).transformDirection( camera.matrixWorld );\n\t\t\tthis.camera = camera;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Raycaster: Unsupported camera type: ' + camera.type );\n\n\t\t}\n\n\t}\n\n\tsetFromXRController( controller ) {\n\n\t\t_matrix.identity().extractRotation( controller.matrixWorld );\n\n\t\tthis.ray.origin.setFromMatrixPosition( controller.matrixWorld );\n\t\tthis.ray.direction.set( 0, 0, - 1 ).applyMatrix4( _matrix );\n\n\t\treturn this;\n\n\t}\n\n\tintersectObject( object, recursive = true, intersects = [] ) {\n\n\t\tintersect( object, this, intersects, recursive );\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n\tintersectObjects( objects, recursive = true, intersects = [] ) {\n\n\t\tfor ( let i = 0, l = objects.length; i < l; i ++ ) {\n\n\t\t\tintersect( objects[ i ], this, intersects, recursive );\n\n\t\t}\n\n\t\tintersects.sort( ascSort );\n\n\t\treturn intersects;\n\n\t}\n\n}\n\nfunction ascSort( a, b ) {\n\n\treturn a.distance - b.distance;\n\n}\n\nfunction intersect( object, raycaster, intersects, recursive ) {\n\n\tlet propagate = true;\n\n\tif ( object.layers.test( raycaster.layers ) ) {\n\n\t\tconst result = object.raycast( raycaster, intersects );\n\n\t\tif ( result === false ) propagate = false;\n\n\t}\n\n\tif ( propagate === true && recursive === true ) {\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tintersect( children[ i ], raycaster, intersects, true );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Spherical_coordinate_system\n *\n * phi (the polar angle) is measured from the positive y-axis. The positive y-axis is up.\n * theta (the azimuthal angle) is measured from the positive z-axis.\n */\nclass Spherical {\n\n\tconstructor( radius = 1, phi = 0, theta = 0 ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi; // polar angle\n\t\tthis.theta = theta; // azimuthal angle\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, phi, theta ) {\n\n\t\tthis.radius = radius;\n\t\tthis.phi = phi;\n\t\tthis.theta = theta;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.phi = other.phi;\n\t\tthis.theta = other.theta;\n\n\t\treturn this;\n\n\t}\n\n\t// restrict phi to be between EPS and PI-EPS\n\tmakeSafe() {\n\n\t\tconst EPS = 0.000001;\n\t\tthis.phi = Math.max( EPS, Math.min( Math.PI - EPS, this.phi ) );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + y * y + z * z );\n\n\t\tif ( this.radius === 0 ) {\n\n\t\t\tthis.theta = 0;\n\t\t\tthis.phi = 0;\n\n\t\t} else {\n\n\t\t\tthis.theta = Math.atan2( x, z );\n\t\t\tthis.phi = Math.acos( clamp$1( y / this.radius, - 1, 1 ) );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\n/**\n * Ref: https://en.wikipedia.org/wiki/Cylindrical_coordinate_system\n */\n\nclass Cylindrical {\n\n\tconstructor( radius = 1, theta = 0, y = 0 ) {\n\n\t\tthis.radius = radius; // distance from the origin to a point in the x-z plane\n\t\tthis.theta = theta; // counterclockwise angle in the x-z plane measured in radians from the positive z-axis\n\t\tthis.y = y; // height above the x-z plane\n\n\t\treturn this;\n\n\t}\n\n\tset( radius, theta, y ) {\n\n\t\tthis.radius = radius;\n\t\tthis.theta = theta;\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tcopy( other ) {\n\n\t\tthis.radius = other.radius;\n\t\tthis.theta = other.theta;\n\t\tthis.y = other.y;\n\n\t\treturn this;\n\n\t}\n\n\tsetFromVector3( v ) {\n\n\t\treturn this.setFromCartesianCoords( v.x, v.y, v.z );\n\n\t}\n\n\tsetFromCartesianCoords( x, y, z ) {\n\n\t\tthis.radius = Math.sqrt( x * x + z * z );\n\t\tthis.theta = Math.atan2( x, z );\n\t\tthis.y = y;\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nclass Matrix2 {\n\n\tconstructor( n11, n12, n21, n22 ) {\n\n\t\tMatrix2.prototype.isMatrix2 = true;\n\n\t\tthis.elements = [\n\t\t\t1, 0,\n\t\t\t0, 1,\n\t\t];\n\n\t\tif ( n11 !== undefined ) {\n\n\t\t\tthis.set( n11, n12, n21, n22 );\n\n\t\t}\n\n\t}\n\n\tidentity() {\n\n\t\tthis.set(\n\t\t\t1, 0,\n\t\t\t0, 1,\n\t\t);\n\n\t\treturn this;\n\n\t}\n\n\tfromArray( array, offset = 0 ) {\n\n\t\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\t\tthis.elements[ i ] = array[ i + offset ];\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tset( n11, n12, n21, n22 ) {\n\n\t\tconst te = this.elements;\n\n\t\tte[ 0 ] = n11; te[ 2 ] = n12;\n\t\tte[ 1 ] = n21; te[ 3 ] = n22;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _vector$4 = /*@__PURE__*/ new Vector2();\n\nclass Box2 {\n\n\tconstructor( min = new Vector2( + Infinity, + Infinity ), max = new Vector2( - Infinity, - Infinity ) ) {\n\n\t\tthis.isBox2 = true;\n\n\t\tthis.min = min;\n\t\tthis.max = max;\n\n\t}\n\n\tset( min, max ) {\n\n\t\tthis.min.copy( min );\n\t\tthis.max.copy( max );\n\n\t\treturn this;\n\n\t}\n\n\tsetFromPoints( points ) {\n\n\t\tthis.makeEmpty();\n\n\t\tfor ( let i = 0, il = points.length; i < il; i ++ ) {\n\n\t\t\tthis.expandByPoint( points[ i ] );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetFromCenterAndSize( center, size ) {\n\n\t\tconst halfSize = _vector$4.copy( size ).multiplyScalar( 0.5 );\n\t\tthis.min.copy( center ).sub( halfSize );\n\t\tthis.max.copy( center ).add( halfSize );\n\n\t\treturn this;\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n\tcopy( box ) {\n\n\t\tthis.min.copy( box.min );\n\t\tthis.max.copy( box.max );\n\n\t\treturn this;\n\n\t}\n\n\tmakeEmpty() {\n\n\t\tthis.min.x = this.min.y = + Infinity;\n\t\tthis.max.x = this.max.y = - Infinity;\n\n\t\treturn this;\n\n\t}\n\n\tisEmpty() {\n\n\t\t// this is a more robust check for empty than ( volume <= 0 ) because volume can get positive with two negative axes\n\n\t\treturn ( this.max.x < this.min.x ) || ( this.max.y < this.min.y );\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.addVectors( this.min, this.max ).multiplyScalar( 0.5 );\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn this.isEmpty() ? target.set( 0, 0 ) : target.subVectors( this.max, this.min );\n\n\t}\n\n\texpandByPoint( point ) {\n\n\t\tthis.min.min( point );\n\t\tthis.max.max( point );\n\n\t\treturn this;\n\n\t}\n\n\texpandByVector( vector ) {\n\n\t\tthis.min.sub( vector );\n\t\tthis.max.add( vector );\n\n\t\treturn this;\n\n\t}\n\n\texpandByScalar( scalar ) {\n\n\t\tthis.min.addScalar( - scalar );\n\t\tthis.max.addScalar( scalar );\n\n\t\treturn this;\n\n\t}\n\n\tcontainsPoint( point ) {\n\n\t\treturn point.x >= this.min.x && point.x <= this.max.x &&\n\t\t\tpoint.y >= this.min.y && point.y <= this.max.y;\n\n\t}\n\n\tcontainsBox( box ) {\n\n\t\treturn this.min.x <= box.min.x && box.max.x <= this.max.x &&\n\t\t\tthis.min.y <= box.min.y && box.max.y <= this.max.y;\n\n\t}\n\n\tgetParameter( point, target ) {\n\n\t\t// This can potentially have a divide by zero if the box\n\t\t// has a size dimension of 0.\n\n\t\treturn target.set(\n\t\t\t( point.x - this.min.x ) / ( this.max.x - this.min.x ),\n\t\t\t( point.y - this.min.y ) / ( this.max.y - this.min.y )\n\t\t);\n\n\t}\n\n\tintersectsBox( box ) {\n\n\t\t// using 4 splitting planes to rule out intersections\n\n\t\treturn box.max.x >= this.min.x && box.min.x <= this.max.x &&\n\t\t\tbox.max.y >= this.min.y && box.min.y <= this.max.y;\n\n\t}\n\n\tclampPoint( point, target ) {\n\n\t\treturn target.copy( point ).clamp( this.min, this.max );\n\n\t}\n\n\tdistanceToPoint( point ) {\n\n\t\treturn this.clampPoint( point, _vector$4 ).distanceTo( point );\n\n\t}\n\n\tintersect( box ) {\n\n\t\tthis.min.max( box.min );\n\t\tthis.max.min( box.max );\n\n\t\tif ( this.isEmpty() ) this.makeEmpty();\n\n\t\treturn this;\n\n\t}\n\n\tunion( box ) {\n\n\t\tthis.min.min( box.min );\n\t\tthis.max.max( box.max );\n\n\t\treturn this;\n\n\t}\n\n\ttranslate( offset ) {\n\n\t\tthis.min.add( offset );\n\t\tthis.max.add( offset );\n\n\t\treturn this;\n\n\t}\n\n\tequals( box ) {\n\n\t\treturn box.min.equals( this.min ) && box.max.equals( this.max );\n\n\t}\n\n}\n\nconst _startP = /*@__PURE__*/ new Vector3();\nconst _startEnd = /*@__PURE__*/ new Vector3();\n\nclass Line3 {\n\n\tconstructor( start = new Vector3(), end = new Vector3() ) {\n\n\t\tthis.start = start;\n\t\tthis.end = end;\n\n\t}\n\n\tset( start, end ) {\n\n\t\tthis.start.copy( start );\n\t\tthis.end.copy( end );\n\n\t\treturn this;\n\n\t}\n\n\tcopy( line ) {\n\n\t\tthis.start.copy( line.start );\n\t\tthis.end.copy( line.end );\n\n\t\treturn this;\n\n\t}\n\n\tgetCenter( target ) {\n\n\t\treturn target.addVectors( this.start, this.end ).multiplyScalar( 0.5 );\n\n\t}\n\n\tdelta( target ) {\n\n\t\treturn target.subVectors( this.end, this.start );\n\n\t}\n\n\tdistanceSq() {\n\n\t\treturn this.start.distanceToSquared( this.end );\n\n\t}\n\n\tdistance() {\n\n\t\treturn this.start.distanceTo( this.end );\n\n\t}\n\n\tat( t, target ) {\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tclosestPointToPointParameter( point, clampToLine ) {\n\n\t\t_startP.subVectors( point, this.start );\n\t\t_startEnd.subVectors( this.end, this.start );\n\n\t\tconst startEnd2 = _startEnd.dot( _startEnd );\n\t\tconst startEnd_startP = _startEnd.dot( _startP );\n\n\t\tlet t = startEnd_startP / startEnd2;\n\n\t\tif ( clampToLine ) {\n\n\t\t\tt = clamp$1( t, 0, 1 );\n\n\t\t}\n\n\t\treturn t;\n\n\t}\n\n\tclosestPointToPoint( point, clampToLine, target ) {\n\n\t\tconst t = this.closestPointToPointParameter( point, clampToLine );\n\n\t\treturn this.delta( target ).multiplyScalar( t ).add( this.start );\n\n\t}\n\n\tapplyMatrix4( matrix ) {\n\n\t\tthis.start.applyMatrix4( matrix );\n\t\tthis.end.applyMatrix4( matrix );\n\n\t\treturn this;\n\n\t}\n\n\tequals( line ) {\n\n\t\treturn line.start.equals( this.start ) && line.end.equals( this.end );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor().copy( this );\n\n\t}\n\n}\n\nconst _vector$3 = /*@__PURE__*/ new Vector3();\n\nclass SpotLightHelper extends Object3D {\n\n\tconstructor( light, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'SpotLightHelper';\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst positions = [\n\t\t\t0, 0, 0, \t0, 0, 1,\n\t\t\t0, 0, 0, \t1, 0, 1,\n\t\t\t0, 0, 0,\t- 1, 0, 1,\n\t\t\t0, 0, 0, \t0, 1, 1,\n\t\t\t0, 0, 0, \t0, - 1, 1\n\t\t];\n\n\t\tfor ( let i = 0, j = 1, l = 32; i < l; i ++, j ++ ) {\n\n\t\t\tconst p1 = ( i / l ) * Math.PI * 2;\n\t\t\tconst p2 = ( j / l ) * Math.PI * 2;\n\n\t\t\tpositions.push(\n\t\t\t\tMath.cos( p1 ), Math.sin( p1 ), 1,\n\t\t\t\tMath.cos( p2 ), Math.sin( p2 ), 1\n\t\t\t);\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.cone = new LineSegments( geometry, material );\n\t\tthis.add( this.cone );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\t\tthis.light.target.updateWorldMatrix( true, false );\n\n\t\t// update the local matrix based on the parent and light target transforms\n\t\tif ( this.parent ) {\n\n\t\t\tthis.parent.updateWorldMatrix( true );\n\n\t\t\tthis.matrix\n\t\t\t\t.copy( this.parent.matrixWorld )\n\t\t\t\t.invert()\n\t\t\t\t.multiply( this.light.matrixWorld );\n\n\t\t} else {\n\n\t\t\tthis.matrix.copy( this.light.matrixWorld );\n\n\t\t}\n\n\t\tthis.matrixWorld.copy( this.light.matrixWorld );\n\n\t\tconst coneLength = this.light.distance ? this.light.distance : 1000;\n\t\tconst coneWidth = coneLength * Math.tan( this.light.angle );\n\n\t\tthis.cone.scale.set( coneWidth, coneWidth, coneLength );\n\n\t\t_vector$3.setFromMatrixPosition( this.light.target.matrixWorld );\n\n\t\tthis.cone.lookAt( _vector$3 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.cone.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.cone.material.color.copy( this.light.color );\n\n\t\t}\n\n\t}\n\n}\n\nconst _vector$2 = /*@__PURE__*/ new Vector3();\nconst _boneMatrix = /*@__PURE__*/ new Matrix4();\nconst _matrixWorldInv = /*@__PURE__*/ new Matrix4();\n\n\nclass SkeletonHelper extends LineSegments {\n\n\tconstructor( object ) {\n\n\t\tconst bones = getBoneList( object );\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst color1 = new Color( 0, 0, 1 );\n\t\tconst color2 = new Color( 0, 1, 0 );\n\n\t\tfor ( let i = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tcolors.push( color1.r, color1.g, color1.b );\n\t\t\t\tcolors.push( color2.r, color2.g, color2.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, depthTest: false, depthWrite: false, toneMapped: false, transparent: true } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.isSkeletonHelper = true;\n\n\t\tthis.type = 'SkeletonHelper';\n\n\t\tthis.root = object;\n\t\tthis.bones = bones;\n\n\t\tthis.matrix = object.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst bones = this.bones;\n\n\t\tconst geometry = this.geometry;\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t_matrixWorldInv.copy( this.root.matrixWorld ).invert();\n\n\t\tfor ( let i = 0, j = 0; i < bones.length; i ++ ) {\n\n\t\t\tconst bone = bones[ i ];\n\n\t\t\tif ( bone.parent && bone.parent.isBone ) {\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\t_boneMatrix.multiplyMatrices( _matrixWorldInv, bone.parent.matrixWorld );\n\t\t\t\t_vector$2.setFromMatrixPosition( _boneMatrix );\n\t\t\t\tposition.setXYZ( j + 1, _vector$2.x, _vector$2.y, _vector$2.z );\n\n\t\t\t\tj += 2;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction getBoneList( object ) {\n\n\tconst boneList = [];\n\n\tif ( object.isBone === true ) {\n\n\t\tboneList.push( object );\n\n\t}\n\n\tfor ( let i = 0; i < object.children.length; i ++ ) {\n\n\t\tboneList.push.apply( boneList, getBoneList( object.children[ i ] ) );\n\n\t}\n\n\treturn boneList;\n\n}\n\nclass PointLightHelper extends Mesh {\n\n\tconstructor( light, sphereSize, color ) {\n\n\t\tconst geometry = new SphereGeometry( sphereSize, 4, 2 );\n\t\tconst material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.light = light;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'PointLightHelper';\n\n\t\tthis.matrix = this.light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\n\t\t/*\n\t// TODO: delete this comment?\n\tconst distanceGeometry = new THREE.IcosahedronGeometry( 1, 2 );\n\tconst distanceMaterial = new THREE.MeshBasicMaterial( { color: hexColor, fog: false, wireframe: true, opacity: 0.1, transparent: true } );\n\n\tthis.lightSphere = new THREE.Mesh( bulbGeometry, bulbMaterial );\n\tthis.lightDistance = new THREE.Mesh( distanceGeometry, distanceMaterial );\n\n\tconst d = light.distance;\n\n\tif ( d === 0.0 ) {\n\n\t\tthis.lightDistance.visible = false;\n\n\t} else {\n\n\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t}\n\n\tthis.add( this.lightDistance );\n\t*/\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\t/*\n\t\tconst d = this.light.distance;\n\n\t\tif ( d === 0.0 ) {\n\n\t\t\tthis.lightDistance.visible = false;\n\n\t\t} else {\n\n\t\t\tthis.lightDistance.visible = true;\n\t\t\tthis.lightDistance.scale.set( d, d, d );\n\n\t\t}\n\t\t*/\n\n\t}\n\n}\n\nconst _vector$1 = /*@__PURE__*/ new Vector3();\nconst _color1 = /*@__PURE__*/ new Color();\nconst _color2 = /*@__PURE__*/ new Color();\n\nclass HemisphereLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'HemisphereLightHelper';\n\n\t\tconst geometry = new OctahedronGeometry( size );\n\t\tgeometry.rotateY( Math.PI * 0.5 );\n\n\t\tthis.material = new MeshBasicMaterial( { wireframe: true, fog: false, toneMapped: false } );\n\t\tif ( this.color === undefined ) this.material.vertexColors = true;\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\t\tconst colors = new Float32Array( position.count * 3 );\n\n\t\tgeometry.setAttribute( 'color', new BufferAttribute( colors, 3 ) );\n\n\t\tthis.add( new Mesh( geometry, this.material ) );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tconst mesh = this.children[ 0 ];\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tconst colors = mesh.geometry.getAttribute( 'color' );\n\n\t\t\t_color1.copy( this.light.color );\n\t\t\t_color2.copy( this.light.groundColor );\n\n\t\t\tfor ( let i = 0, l = colors.count; i < l; i ++ ) {\n\n\t\t\t\tconst color = ( i < ( l / 2 ) ) ? _color1 : _color2;\n\n\t\t\t\tcolors.setXYZ( i, color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t\tcolors.needsUpdate = true;\n\n\t\t}\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\n\t\tmesh.lookAt( _vector$1.setFromMatrixPosition( this.light.matrixWorld ).negate() );\n\n\t}\n\n}\n\nclass GridHelper extends LineSegments {\n\n\tconstructor( size = 10, divisions = 10, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst center = divisions / 2;\n\t\tconst step = size / divisions;\n\t\tconst halfSize = size / 2;\n\n\t\tconst vertices = [], colors = [];\n\n\t\tfor ( let i = 0, j = 0, k = - halfSize; i <= divisions; i ++, k += step ) {\n\n\t\t\tvertices.push( - halfSize, 0, k, halfSize, 0, k );\n\t\t\tvertices.push( k, 0, - halfSize, k, 0, halfSize );\n\n\t\t\tconst color = i === center ? color1 : color2;\n\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\t\t\tcolor.toArray( colors, j ); j += 3;\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'GridHelper';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass PolarGridHelper extends LineSegments {\n\n\tconstructor( radius = 10, sectors = 16, rings = 8, divisions = 64, color1 = 0x444444, color2 = 0x888888 ) {\n\n\t\tcolor1 = new Color( color1 );\n\t\tcolor2 = new Color( color2 );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\t// create the sectors\n\n\t\tif ( sectors > 1 ) {\n\n\t\t\tfor ( let i = 0; i < sectors; i ++ ) {\n\n\t\t\t\tconst v = ( i / sectors ) * ( Math.PI * 2 );\n\n\t\t\t\tconst x = Math.sin( v ) * radius;\n\t\t\t\tconst z = Math.cos( v ) * radius;\n\n\t\t\t\tvertices.push( 0, 0, 0 );\n\t\t\t\tvertices.push( x, 0, z );\n\n\t\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// create the rings\n\n\t\tfor ( let i = 0; i < rings; i ++ ) {\n\n\t\t\tconst color = ( i & 1 ) ? color1 : color2;\n\n\t\t\tconst r = radius - ( radius / rings * i );\n\n\t\t\tfor ( let j = 0; j < divisions; j ++ ) {\n\n\t\t\t\t// first vertex\n\n\t\t\t\tlet v = ( j / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tlet x = Math.sin( v ) * r;\n\t\t\t\tlet z = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t\t// second vertex\n\n\t\t\t\tv = ( ( j + 1 ) / divisions ) * ( Math.PI * 2 );\n\n\t\t\t\tx = Math.sin( v ) * r;\n\t\t\t\tz = Math.cos( v ) * r;\n\n\t\t\t\tvertices.push( x, 0, z );\n\t\t\t\tcolors.push( color.r, color.g, color.b );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'PolarGridHelper';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nconst _v1 = /*@__PURE__*/ new Vector3();\nconst _v2 = /*@__PURE__*/ new Vector3();\nconst _v3 = /*@__PURE__*/ new Vector3();\n\nclass DirectionalLightHelper extends Object3D {\n\n\tconstructor( light, size, color ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\n\t\tthis.matrix = light.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.color = color;\n\n\t\tthis.type = 'DirectionalLightHelper';\n\n\t\tif ( size === undefined ) size = 1;\n\n\t\tlet geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [\n\t\t\t- size, size, 0,\n\t\t\tsize, size, 0,\n\t\t\tsize, - size, 0,\n\t\t\t- size, - size, 0,\n\t\t\t- size, size, 0\n\t\t], 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { fog: false, toneMapped: false } );\n\n\t\tthis.lightPlane = new Line( geometry, material );\n\t\tthis.add( this.lightPlane );\n\n\t\tgeometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 0, 1 ], 3 ) );\n\n\t\tthis.targetLine = new Line( geometry, material );\n\t\tthis.add( this.targetLine );\n\n\t\tthis.update();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lightPlane.geometry.dispose();\n\t\tthis.lightPlane.material.dispose();\n\t\tthis.targetLine.geometry.dispose();\n\t\tthis.targetLine.material.dispose();\n\n\t}\n\n\tupdate() {\n\n\t\tthis.light.updateWorldMatrix( true, false );\n\t\tthis.light.target.updateWorldMatrix( true, false );\n\n\t\t_v1.setFromMatrixPosition( this.light.matrixWorld );\n\t\t_v2.setFromMatrixPosition( this.light.target.matrixWorld );\n\t\t_v3.subVectors( _v2, _v1 );\n\n\t\tthis.lightPlane.lookAt( _v2 );\n\n\t\tif ( this.color !== undefined ) {\n\n\t\t\tthis.lightPlane.material.color.set( this.color );\n\t\t\tthis.targetLine.material.color.set( this.color );\n\n\t\t} else {\n\n\t\t\tthis.lightPlane.material.color.copy( this.light.color );\n\t\t\tthis.targetLine.material.color.copy( this.light.color );\n\n\t\t}\n\n\t\tthis.targetLine.lookAt( _v2 );\n\t\tthis.targetLine.scale.z = _v3.length();\n\n\t}\n\n}\n\nconst _vector = /*@__PURE__*/ new Vector3();\nconst _camera$1 = /*@__PURE__*/ new Camera();\n\n/**\n *\t- shows frustum, line of sight and up of the camera\n *\t- suitable for fast updates\n * \t- based on frustum visualization in lightgl.js shadowmap example\n *\t\thttps://github.com/evanw/lightgl.js/blob/master/tests/shadowmap.html\n */\n\nclass CameraHelper extends LineSegments {\n\n\tconstructor( camera ) {\n\n\t\tconst geometry = new BufferGeometry();\n\t\tconst material = new LineBasicMaterial( { color: 0xffffff, vertexColors: true, toneMapped: false } );\n\n\t\tconst vertices = [];\n\t\tconst colors = [];\n\n\t\tconst pointMap = {};\n\n\t\t// near\n\n\t\taddLine( 'n1', 'n2' );\n\t\taddLine( 'n2', 'n4' );\n\t\taddLine( 'n4', 'n3' );\n\t\taddLine( 'n3', 'n1' );\n\n\t\t// far\n\n\t\taddLine( 'f1', 'f2' );\n\t\taddLine( 'f2', 'f4' );\n\t\taddLine( 'f4', 'f3' );\n\t\taddLine( 'f3', 'f1' );\n\n\t\t// sides\n\n\t\taddLine( 'n1', 'f1' );\n\t\taddLine( 'n2', 'f2' );\n\t\taddLine( 'n3', 'f3' );\n\t\taddLine( 'n4', 'f4' );\n\n\t\t// cone\n\n\t\taddLine( 'p', 'n1' );\n\t\taddLine( 'p', 'n2' );\n\t\taddLine( 'p', 'n3' );\n\t\taddLine( 'p', 'n4' );\n\n\t\t// up\n\n\t\taddLine( 'u1', 'u2' );\n\t\taddLine( 'u2', 'u3' );\n\t\taddLine( 'u3', 'u1' );\n\n\t\t// target\n\n\t\taddLine( 'c', 't' );\n\t\taddLine( 'p', 'c' );\n\n\t\t// cross\n\n\t\taddLine( 'cn1', 'cn2' );\n\t\taddLine( 'cn3', 'cn4' );\n\n\t\taddLine( 'cf1', 'cf2' );\n\t\taddLine( 'cf3', 'cf4' );\n\n\t\tfunction addLine( a, b ) {\n\n\t\t\taddPoint( a );\n\t\t\taddPoint( b );\n\n\t\t}\n\n\t\tfunction addPoint( id ) {\n\n\t\t\tvertices.push( 0, 0, 0 );\n\t\t\tcolors.push( 0, 0, 0 );\n\n\t\t\tif ( pointMap[ id ] === undefined ) {\n\n\t\t\t\tpointMap[ id ] = [];\n\n\t\t\t}\n\n\t\t\tpointMap[ id ].push( ( vertices.length / 3 ) - 1 );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'CameraHelper';\n\n\t\tthis.camera = camera;\n\t\tif ( this.camera.updateProjectionMatrix ) this.camera.updateProjectionMatrix();\n\n\t\tthis.matrix = camera.matrixWorld;\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.pointMap = pointMap;\n\n\t\tthis.update();\n\n\t\t// colors\n\n\t\tconst colorFrustum = new Color( 0xffaa00 );\n\t\tconst colorCone = new Color( 0xff0000 );\n\t\tconst colorUp = new Color( 0x00aaff );\n\t\tconst colorTarget = new Color( 0xffffff );\n\t\tconst colorCross = new Color( 0x333333 );\n\n\t\tthis.setColors( colorFrustum, colorCone, colorUp, colorTarget, colorCross );\n\n\t}\n\n\tsetColors( frustum, cone, up, target, cross ) {\n\n\t\tconst geometry = this.geometry;\n\n\t\tconst colorAttribute = geometry.getAttribute( 'color' );\n\n\t\t// near\n\n\t\tcolorAttribute.setXYZ( 0, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 1, frustum.r, frustum.g, frustum.b ); // n1, n2\n\t\tcolorAttribute.setXYZ( 2, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 3, frustum.r, frustum.g, frustum.b ); // n2, n4\n\t\tcolorAttribute.setXYZ( 4, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 5, frustum.r, frustum.g, frustum.b ); // n4, n3\n\t\tcolorAttribute.setXYZ( 6, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 7, frustum.r, frustum.g, frustum.b ); // n3, n1\n\n\t\t// far\n\n\t\tcolorAttribute.setXYZ( 8, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 9, frustum.r, frustum.g, frustum.b ); // f1, f2\n\t\tcolorAttribute.setXYZ( 10, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 11, frustum.r, frustum.g, frustum.b ); // f2, f4\n\t\tcolorAttribute.setXYZ( 12, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 13, frustum.r, frustum.g, frustum.b ); // f4, f3\n\t\tcolorAttribute.setXYZ( 14, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 15, frustum.r, frustum.g, frustum.b ); // f3, f1\n\n\t\t// sides\n\n\t\tcolorAttribute.setXYZ( 16, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 17, frustum.r, frustum.g, frustum.b ); // n1, f1\n\t\tcolorAttribute.setXYZ( 18, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 19, frustum.r, frustum.g, frustum.b ); // n2, f2\n\t\tcolorAttribute.setXYZ( 20, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 21, frustum.r, frustum.g, frustum.b ); // n3, f3\n\t\tcolorAttribute.setXYZ( 22, frustum.r, frustum.g, frustum.b ); colorAttribute.setXYZ( 23, frustum.r, frustum.g, frustum.b ); // n4, f4\n\n\t\t// cone\n\n\t\tcolorAttribute.setXYZ( 24, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 25, cone.r, cone.g, cone.b ); // p, n1\n\t\tcolorAttribute.setXYZ( 26, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 27, cone.r, cone.g, cone.b ); // p, n2\n\t\tcolorAttribute.setXYZ( 28, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 29, cone.r, cone.g, cone.b ); // p, n3\n\t\tcolorAttribute.setXYZ( 30, cone.r, cone.g, cone.b ); colorAttribute.setXYZ( 31, cone.r, cone.g, cone.b ); // p, n4\n\n\t\t// up\n\n\t\tcolorAttribute.setXYZ( 32, up.r, up.g, up.b ); colorAttribute.setXYZ( 33, up.r, up.g, up.b ); // u1, u2\n\t\tcolorAttribute.setXYZ( 34, up.r, up.g, up.b ); colorAttribute.setXYZ( 35, up.r, up.g, up.b ); // u2, u3\n\t\tcolorAttribute.setXYZ( 36, up.r, up.g, up.b ); colorAttribute.setXYZ( 37, up.r, up.g, up.b ); // u3, u1\n\n\t\t// target\n\n\t\tcolorAttribute.setXYZ( 38, target.r, target.g, target.b ); colorAttribute.setXYZ( 39, target.r, target.g, target.b ); // c, t\n\t\tcolorAttribute.setXYZ( 40, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 41, cross.r, cross.g, cross.b ); // p, c\n\n\t\t// cross\n\n\t\tcolorAttribute.setXYZ( 42, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 43, cross.r, cross.g, cross.b ); // cn1, cn2\n\t\tcolorAttribute.setXYZ( 44, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 45, cross.r, cross.g, cross.b ); // cn3, cn4\n\n\t\tcolorAttribute.setXYZ( 46, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 47, cross.r, cross.g, cross.b ); // cf1, cf2\n\t\tcolorAttribute.setXYZ( 48, cross.r, cross.g, cross.b ); colorAttribute.setXYZ( 49, cross.r, cross.g, cross.b ); // cf3, cf4\n\n\t\tcolorAttribute.needsUpdate = true;\n\n\t}\n\n\tupdate() {\n\n\t\tconst geometry = this.geometry;\n\t\tconst pointMap = this.pointMap;\n\n\t\tconst w = 1, h = 1;\n\n\t\t// we need just camera projection matrix inverse\n\t\t// world matrix must be identity\n\n\t\t_camera$1.projectionMatrixInverse.copy( this.camera.projectionMatrixInverse );\n\n\t\t// center / target\n\n\t\tsetPoint( 'c', pointMap, geometry, _camera$1, 0, 0, - 1 );\n\t\tsetPoint( 't', pointMap, geometry, _camera$1, 0, 0, 1 );\n\n\t\t// near\n\n\t\tsetPoint( 'n1', pointMap, geometry, _camera$1, - w, - h, - 1 );\n\t\tsetPoint( 'n2', pointMap, geometry, _camera$1, w, - h, - 1 );\n\t\tsetPoint( 'n3', pointMap, geometry, _camera$1, - w, h, - 1 );\n\t\tsetPoint( 'n4', pointMap, geometry, _camera$1, w, h, - 1 );\n\n\t\t// far\n\n\t\tsetPoint( 'f1', pointMap, geometry, _camera$1, - w, - h, 1 );\n\t\tsetPoint( 'f2', pointMap, geometry, _camera$1, w, - h, 1 );\n\t\tsetPoint( 'f3', pointMap, geometry, _camera$1, - w, h, 1 );\n\t\tsetPoint( 'f4', pointMap, geometry, _camera$1, w, h, 1 );\n\n\t\t// up\n\n\t\tsetPoint( 'u1', pointMap, geometry, _camera$1, w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u2', pointMap, geometry, _camera$1, - w * 0.7, h * 1.1, - 1 );\n\t\tsetPoint( 'u3', pointMap, geometry, _camera$1, 0, h * 2, - 1 );\n\n\t\t// cross\n\n\t\tsetPoint( 'cf1', pointMap, geometry, _camera$1, - w, 0, 1 );\n\t\tsetPoint( 'cf2', pointMap, geometry, _camera$1, w, 0, 1 );\n\t\tsetPoint( 'cf3', pointMap, geometry, _camera$1, 0, - h, 1 );\n\t\tsetPoint( 'cf4', pointMap, geometry, _camera$1, 0, h, 1 );\n\n\t\tsetPoint( 'cn1', pointMap, geometry, _camera$1, - w, 0, - 1 );\n\t\tsetPoint( 'cn2', pointMap, geometry, _camera$1, w, 0, - 1 );\n\t\tsetPoint( 'cn3', pointMap, geometry, _camera$1, 0, - h, - 1 );\n\t\tsetPoint( 'cn4', pointMap, geometry, _camera$1, 0, h, - 1 );\n\n\t\tgeometry.getAttribute( 'position' ).needsUpdate = true;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\n\nfunction setPoint( point, pointMap, geometry, camera, x, y, z ) {\n\n\t_vector.set( x, y, z ).unproject( camera );\n\n\tconst points = pointMap[ point ];\n\n\tif ( points !== undefined ) {\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tfor ( let i = 0, l = points.length; i < l; i ++ ) {\n\n\t\t\tposition.setXYZ( points[ i ], _vector.x, _vector.y, _vector.z );\n\n\t\t}\n\n\t}\n\n}\n\nconst _box = /*@__PURE__*/ new Box3();\n\nclass BoxHelper extends LineSegments {\n\n\tconstructor( object, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\t\tconst positions = new Float32Array( 8 * 3 );\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\t\tgeometry.setAttribute( 'position', new BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.object = object;\n\t\tthis.type = 'BoxHelper';\n\n\t\tthis.matrixAutoUpdate = false;\n\n\t\tthis.update();\n\n\t}\n\n\tupdate( object ) {\n\n\t\tif ( object !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.BoxHelper: .update() has no longer arguments.' );\n\n\t\t}\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\t_box.setFromObject( this.object );\n\n\t\t}\n\n\t\tif ( _box.isEmpty() ) return;\n\n\t\tconst min = _box.min;\n\t\tconst max = _box.max;\n\n\t\t/*\n\t\t\t5____4\n\t\t1/___0/|\n\t\t| 6__|_7\n\t\t2/___3/\n\n\t\t0: max.x, max.y, max.z\n\t\t1: min.x, max.y, max.z\n\t\t2: min.x, min.y, max.z\n\t\t3: max.x, min.y, max.z\n\t\t4: max.x, max.y, min.z\n\t\t5: min.x, max.y, min.z\n\t\t6: min.x, min.y, min.z\n\t\t7: max.x, min.y, min.z\n\t\t*/\n\n\t\tconst position = this.geometry.attributes.position;\n\t\tconst array = position.array;\n\n\t\tarray[ 0 ] = max.x; array[ 1 ] = max.y; array[ 2 ] = max.z;\n\t\tarray[ 3 ] = min.x; array[ 4 ] = max.y; array[ 5 ] = max.z;\n\t\tarray[ 6 ] = min.x; array[ 7 ] = min.y; array[ 8 ] = max.z;\n\t\tarray[ 9 ] = max.x; array[ 10 ] = min.y; array[ 11 ] = max.z;\n\t\tarray[ 12 ] = max.x; array[ 13 ] = max.y; array[ 14 ] = min.z;\n\t\tarray[ 15 ] = min.x; array[ 16 ] = max.y; array[ 17 ] = min.z;\n\t\tarray[ 18 ] = min.x; array[ 19 ] = min.y; array[ 20 ] = min.z;\n\t\tarray[ 21 ] = max.x; array[ 22 ] = min.y; array[ 23 ] = min.z;\n\n\t\tposition.needsUpdate = true;\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tsetFromObject( object ) {\n\n\t\tthis.object = object;\n\t\tthis.update();\n\n\t\treturn this;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.object = source.object;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass Box3Helper extends LineSegments {\n\n\tconstructor( box, color = 0xffff00 ) {\n\n\t\tconst indices = new Uint16Array( [ 0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7 ] );\n\n\t\tconst positions = [ 1, 1, 1, - 1, 1, 1, - 1, - 1, 1, 1, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 1, - 1, 1, - 1, - 1 ];\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tgeometry.setIndex( new BufferAttribute( indices, 1 ) );\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.box = box;\n\n\t\tthis.type = 'Box3Helper';\n\n\t\tthis.geometry.computeBoundingSphere();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst box = this.box;\n\n\t\tif ( box.isEmpty() ) return;\n\n\t\tbox.getCenter( this.position );\n\n\t\tbox.getSize( this.scale );\n\n\t\tthis.scale.multiplyScalar( 0.5 );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass PlaneHelper extends Line {\n\n\tconstructor( plane, size = 1, hex = 0xffff00 ) {\n\n\t\tconst color = hex;\n\n\t\tconst positions = [ 1, - 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, - 1, 0, 1, 1, 0 ];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\t\tgeometry.computeBoundingSphere();\n\n\t\tsuper( geometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\n\t\tthis.type = 'PlaneHelper';\n\n\t\tthis.plane = plane;\n\n\t\tthis.size = size;\n\n\t\tconst positions2 = [ 1, 1, 0, - 1, 1, 0, - 1, - 1, 0, 1, 1, 0, - 1, - 1, 0, 1, - 1, 0 ];\n\n\t\tconst geometry2 = new BufferGeometry();\n\t\tgeometry2.setAttribute( 'position', new Float32BufferAttribute( positions2, 3 ) );\n\t\tgeometry2.computeBoundingSphere();\n\n\t\tthis.add( new Mesh( geometry2, new MeshBasicMaterial( { color: color, opacity: 0.2, transparent: true, depthWrite: false, toneMapped: false } ) ) );\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tthis.position.set( 0, 0, 0 );\n\n\t\tthis.scale.set( 0.5 * this.size, 0.5 * this.size, 1 );\n\n\t\tthis.lookAt( this.plane.normal );\n\n\t\tthis.translateZ( - this.plane.constant );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\t\tthis.children[ 0 ].geometry.dispose();\n\t\tthis.children[ 0 ].material.dispose();\n\n\t}\n\n}\n\nconst _axis = /*@__PURE__*/ new Vector3();\nlet _lineGeometry, _coneGeometry;\n\nclass ArrowHelper extends Object3D {\n\n\t// dir is assumed to be normalized\n\n\tconstructor( dir = new Vector3( 0, 0, 1 ), origin = new Vector3( 0, 0, 0 ), length = 1, color = 0xffff00, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tsuper();\n\n\t\tthis.type = 'ArrowHelper';\n\n\t\tif ( _lineGeometry === undefined ) {\n\n\t\t\t_lineGeometry = new BufferGeometry();\n\t\t\t_lineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 0, 1, 0 ], 3 ) );\n\n\t\t\t_coneGeometry = new CylinderGeometry( 0, 0.5, 1, 5, 1 );\n\t\t\t_coneGeometry.translate( 0, - 0.5, 0 );\n\n\t\t}\n\n\t\tthis.position.copy( origin );\n\n\t\tthis.line = new Line( _lineGeometry, new LineBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.line.matrixAutoUpdate = false;\n\t\tthis.add( this.line );\n\n\t\tthis.cone = new Mesh( _coneGeometry, new MeshBasicMaterial( { color: color, toneMapped: false } ) );\n\t\tthis.cone.matrixAutoUpdate = false;\n\t\tthis.add( this.cone );\n\n\t\tthis.setDirection( dir );\n\t\tthis.setLength( length, headLength, headWidth );\n\n\t}\n\n\tsetDirection( dir ) {\n\n\t\t// dir is assumed to be normalized\n\n\t\tif ( dir.y > 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 0, 0, 0, 1 );\n\n\t\t} else if ( dir.y < - 0.99999 ) {\n\n\t\t\tthis.quaternion.set( 1, 0, 0, 0 );\n\n\t\t} else {\n\n\t\t\t_axis.set( dir.z, 0, - dir.x ).normalize();\n\n\t\t\tconst radians = Math.acos( dir.y );\n\n\t\t\tthis.quaternion.setFromAxisAngle( _axis, radians );\n\n\t\t}\n\n\t}\n\n\tsetLength( length, headLength = length * 0.2, headWidth = headLength * 0.2 ) {\n\n\t\tthis.line.scale.set( 1, Math.max( 0.0001, length - headLength ), 1 ); // see #17458\n\t\tthis.line.updateMatrix();\n\n\t\tthis.cone.scale.set( headWidth, headLength, headWidth );\n\t\tthis.cone.position.y = length;\n\t\tthis.cone.updateMatrix();\n\n\t}\n\n\tsetColor( color ) {\n\n\t\tthis.line.material.color.set( color );\n\t\tthis.cone.material.color.set( color );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source, false );\n\n\t\tthis.line.copy( source.line );\n\t\tthis.cone.copy( source.cone );\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.line.geometry.dispose();\n\t\tthis.line.material.dispose();\n\t\tthis.cone.geometry.dispose();\n\t\tthis.cone.material.dispose();\n\n\t}\n\n}\n\nclass AxesHelper extends LineSegments {\n\n\tconstructor( size = 1 ) {\n\n\t\tconst vertices = [\n\t\t\t0, 0, 0,\tsize, 0, 0,\n\t\t\t0, 0, 0,\t0, size, 0,\n\t\t\t0, 0, 0,\t0, 0, size\n\t\t];\n\n\t\tconst colors = [\n\t\t\t1, 0, 0,\t1, 0.6, 0,\n\t\t\t0, 1, 0,\t0.6, 1, 0,\n\t\t\t0, 0, 1,\t0, 0.6, 1\n\t\t];\n\n\t\tconst geometry = new BufferGeometry();\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\t\tgeometry.setAttribute( 'color', new Float32BufferAttribute( colors, 3 ) );\n\n\t\tconst material = new LineBasicMaterial( { vertexColors: true, toneMapped: false } );\n\n\t\tsuper( geometry, material );\n\n\t\tthis.type = 'AxesHelper';\n\n\t}\n\n\tsetColors( xAxisColor, yAxisColor, zAxisColor ) {\n\n\t\tconst color = new Color();\n\t\tconst array = this.geometry.attributes.color.array;\n\n\t\tcolor.set( xAxisColor );\n\t\tcolor.toArray( array, 0 );\n\t\tcolor.toArray( array, 3 );\n\n\t\tcolor.set( yAxisColor );\n\t\tcolor.toArray( array, 6 );\n\t\tcolor.toArray( array, 9 );\n\n\t\tcolor.set( zAxisColor );\n\t\tcolor.toArray( array, 12 );\n\t\tcolor.toArray( array, 15 );\n\n\t\tthis.geometry.attributes.color.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.geometry.dispose();\n\t\tthis.material.dispose();\n\n\t}\n\n}\n\nclass ShapePath {\n\n\tconstructor() {\n\n\t\tthis.type = 'ShapePath';\n\n\t\tthis.color = new Color();\n\n\t\tthis.subPaths = [];\n\t\tthis.currentPath = null;\n\n\t}\n\n\tmoveTo( x, y ) {\n\n\t\tthis.currentPath = new Path();\n\t\tthis.subPaths.push( this.currentPath );\n\t\tthis.currentPath.moveTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tlineTo( x, y ) {\n\n\t\tthis.currentPath.lineTo( x, y );\n\n\t\treturn this;\n\n\t}\n\n\tquadraticCurveTo( aCPx, aCPy, aX, aY ) {\n\n\t\tthis.currentPath.quadraticCurveTo( aCPx, aCPy, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tbezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY ) {\n\n\t\tthis.currentPath.bezierCurveTo( aCP1x, aCP1y, aCP2x, aCP2y, aX, aY );\n\n\t\treturn this;\n\n\t}\n\n\tsplineThru( pts ) {\n\n\t\tthis.currentPath.splineThru( pts );\n\n\t\treturn this;\n\n\t}\n\n\ttoShapes( isCCW ) {\n\n\t\tfunction toShapesNoHoles( inSubpaths ) {\n\n\t\t\tconst shapes = [];\n\n\t\t\tfor ( let i = 0, l = inSubpaths.length; i < l; i ++ ) {\n\n\t\t\t\tconst tmpPath = inSubpaths[ i ];\n\n\t\t\t\tconst tmpShape = new Shape();\n\t\t\t\ttmpShape.curves = tmpPath.curves;\n\n\t\t\t\tshapes.push( tmpShape );\n\n\t\t\t}\n\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tfunction isPointInsidePolygon( inPt, inPolygon ) {\n\n\t\t\tconst polyLen = inPolygon.length;\n\n\t\t\t// inPt on polygon contour => immediate success    or\n\t\t\t// toggling of inside/outside at every single! intersection point of an edge\n\t\t\t//  with the horizontal line through inPt, left of inPt\n\t\t\t//  not counting lowerY endpoints of edges and whole edges on that line\n\t\t\tlet inside = false;\n\t\t\tfor ( let p = polyLen - 1, q = 0; q < polyLen; p = q ++ ) {\n\n\t\t\t\tlet edgeLowPt = inPolygon[ p ];\n\t\t\t\tlet edgeHighPt = inPolygon[ q ];\n\n\t\t\t\tlet edgeDx = edgeHighPt.x - edgeLowPt.x;\n\t\t\t\tlet edgeDy = edgeHighPt.y - edgeLowPt.y;\n\n\t\t\t\tif ( Math.abs( edgeDy ) > Number.EPSILON ) {\n\n\t\t\t\t\t// not parallel\n\t\t\t\t\tif ( edgeDy < 0 ) {\n\n\t\t\t\t\t\tedgeLowPt = inPolygon[ q ]; edgeDx = - edgeDx;\n\t\t\t\t\t\tedgeHighPt = inPolygon[ p ]; edgeDy = - edgeDy;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ( inPt.y < edgeLowPt.y ) || ( inPt.y > edgeHighPt.y ) ) \t\tcontinue;\n\n\t\t\t\t\tif ( inPt.y === edgeLowPt.y ) {\n\n\t\t\t\t\t\tif ( inPt.x === edgeLowPt.x )\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\t// continue;\t\t\t\t// no intersection or edgeLowPt => doesn't count !!!\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconst perpEdge = edgeDy * ( inPt.x - edgeLowPt.x ) - edgeDx * ( inPt.y - edgeLowPt.y );\n\t\t\t\t\t\tif ( perpEdge === 0 )\t\t\t\treturn\ttrue;\t\t// inPt is on contour ?\n\t\t\t\t\t\tif ( perpEdge < 0 ) \t\t\t\tcontinue;\n\t\t\t\t\t\tinside = ! inside;\t\t// true intersection left of inPt\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// parallel or collinear\n\t\t\t\t\tif ( inPt.y !== edgeLowPt.y ) \t\tcontinue;\t\t\t// parallel\n\t\t\t\t\t// edge lies on the same horizontal line as inPt\n\t\t\t\t\tif ( ( ( edgeHighPt.x <= inPt.x ) && ( inPt.x <= edgeLowPt.x ) ) ||\n\t\t\t\t\t\t ( ( edgeLowPt.x <= inPt.x ) && ( inPt.x <= edgeHighPt.x ) ) )\t\treturn\ttrue;\t// inPt: Point on contour !\n\t\t\t\t\t// continue;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn\tinside;\n\n\t\t}\n\n\t\tconst isClockWise = ShapeUtils.isClockWise;\n\n\t\tconst subPaths = this.subPaths;\n\t\tif ( subPaths.length === 0 ) return [];\n\n\t\tlet solid, tmpPath, tmpShape;\n\t\tconst shapes = [];\n\n\t\tif ( subPaths.length === 1 ) {\n\n\t\t\ttmpPath = subPaths[ 0 ];\n\t\t\ttmpShape = new Shape();\n\t\t\ttmpShape.curves = tmpPath.curves;\n\t\t\tshapes.push( tmpShape );\n\t\t\treturn shapes;\n\n\t\t}\n\n\t\tlet holesFirst = ! isClockWise( subPaths[ 0 ].getPoints() );\n\t\tholesFirst = isCCW ? ! holesFirst : holesFirst;\n\n\t\t// console.log(\"Holes first\", holesFirst);\n\n\t\tconst betterShapeHoles = [];\n\t\tconst newShapes = [];\n\t\tlet newShapeHoles = [];\n\t\tlet mainIdx = 0;\n\t\tlet tmpPoints;\n\n\t\tnewShapes[ mainIdx ] = undefined;\n\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\tfor ( let i = 0, l = subPaths.length; i < l; i ++ ) {\n\n\t\t\ttmpPath = subPaths[ i ];\n\t\t\ttmpPoints = tmpPath.getPoints();\n\t\t\tsolid = isClockWise( tmpPoints );\n\t\t\tsolid = isCCW ? ! solid : solid;\n\n\t\t\tif ( solid ) {\n\n\t\t\t\tif ( ( ! holesFirst ) && ( newShapes[ mainIdx ] ) )\tmainIdx ++;\n\n\t\t\t\tnewShapes[ mainIdx ] = { s: new Shape(), p: tmpPoints };\n\t\t\t\tnewShapes[ mainIdx ].s.curves = tmpPath.curves;\n\n\t\t\t\tif ( holesFirst )\tmainIdx ++;\n\t\t\t\tnewShapeHoles[ mainIdx ] = [];\n\n\t\t\t\t//console.log('cw', i);\n\n\t\t\t} else {\n\n\t\t\t\tnewShapeHoles[ mainIdx ].push( { h: tmpPath, p: tmpPoints[ 0 ] } );\n\n\t\t\t\t//console.log('ccw', i);\n\n\t\t\t}\n\n\t\t}\n\n\t\t// only Holes? -> probably all Shapes with wrong orientation\n\t\tif ( ! newShapes[ 0 ] )\treturn\ttoShapesNoHoles( subPaths );\n\n\n\t\tif ( newShapes.length > 1 ) {\n\n\t\t\tlet ambiguous = false;\n\t\t\tlet toChange = 0;\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tbetterShapeHoles[ sIdx ] = [];\n\n\t\t\t}\n\n\t\t\tfor ( let sIdx = 0, sLen = newShapes.length; sIdx < sLen; sIdx ++ ) {\n\n\t\t\t\tconst sho = newShapeHoles[ sIdx ];\n\n\t\t\t\tfor ( let hIdx = 0; hIdx < sho.length; hIdx ++ ) {\n\n\t\t\t\t\tconst ho = sho[ hIdx ];\n\t\t\t\t\tlet hole_unassigned = true;\n\n\t\t\t\t\tfor ( let s2Idx = 0; s2Idx < newShapes.length; s2Idx ++ ) {\n\n\t\t\t\t\t\tif ( isPointInsidePolygon( ho.p, newShapes[ s2Idx ].p ) ) {\n\n\t\t\t\t\t\t\tif ( sIdx !== s2Idx )\ttoChange ++;\n\n\t\t\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\t\t\thole_unassigned = false;\n\t\t\t\t\t\t\t\tbetterShapeHoles[ s2Idx ].push( ho );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tambiguous = true;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( hole_unassigned ) {\n\n\t\t\t\t\t\tbetterShapeHoles[ sIdx ].push( ho );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( toChange > 0 && ambiguous === false ) {\n\n\t\t\t\tnewShapeHoles = betterShapeHoles;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet tmpHoles;\n\n\t\tfor ( let i = 0, il = newShapes.length; i < il; i ++ ) {\n\n\t\t\ttmpShape = newShapes[ i ].s;\n\t\t\tshapes.push( tmpShape );\n\t\t\ttmpHoles = newShapeHoles[ i ];\n\n\t\t\tfor ( let j = 0, jl = tmpHoles.length; j < jl; j ++ ) {\n\n\t\t\t\ttmpShape.holes.push( tmpHoles[ j ].h );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//console.log(\"shape\", shapes);\n\n\t\treturn shapes;\n\n\t}\n\n}\n\nclass Controls extends EventDispatcher {\n\n\tconstructor( object, domElement = null ) {\n\n\t\tsuper();\n\n\t\tthis.object = object;\n\t\tthis.domElement = domElement;\n\n\t\tthis.enabled = true;\n\n\t\tthis.state = - 1;\n\n\t\tthis.keys = {};\n\t\tthis.mouseButtons = { LEFT: null, MIDDLE: null, RIGHT: null };\n\t\tthis.touches = { ONE: null, TWO: null };\n\n\t}\n\n\tconnect() {}\n\n\tdisconnect() {}\n\n\tdispose() {}\n\n\tupdate( /* delta */ ) {}\n\n}\n\nclass WebGLMultipleRenderTargets extends WebGLRenderTarget { // @deprecated, r162\n\n\tconstructor( width = 1, height = 1, count = 1, options = {} ) {\n\n\t\tconsole.warn( 'THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the \"count\" parameter to enable MRT.' );\n\n\t\tsuper( width, height, { ...options, count } );\n\n\t\tthis.isWebGLMultipleRenderTargets = true;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this.textures;\n\n\t}\n\n}\n\nconst refreshUniforms = [\n\t'alphaMap',\n\t'alphaTest',\n\t'anisotropy',\n\t'anisotropyMap',\n\t'anisotropyRotation',\n\t'aoMap',\n\t'attenuationColor',\n\t'attenuationDistance',\n\t'bumpMap',\n\t'clearcoat',\n\t'clearcoatMap',\n\t'clearcoatNormalMap',\n\t'clearcoatNormalScale',\n\t'clearcoatRoughness',\n\t'color',\n\t'dispersion',\n\t'displacementMap',\n\t'emissive',\n\t'emissiveMap',\n\t'envMap',\n\t'gradientMap',\n\t'ior',\n\t'iridescence',\n\t'iridescenceIOR',\n\t'iridescenceMap',\n\t'iridescenceThicknessMap',\n\t'lightMap',\n\t'map',\n\t'matcap',\n\t'metalness',\n\t'metalnessMap',\n\t'normalMap',\n\t'normalScale',\n\t'opacity',\n\t'roughness',\n\t'roughnessMap',\n\t'sheen',\n\t'sheenColor',\n\t'sheenColorMap',\n\t'sheenRoughnessMap',\n\t'shininess',\n\t'specular',\n\t'specularColor',\n\t'specularColorMap',\n\t'specularIntensity',\n\t'specularIntensityMap',\n\t'specularMap',\n\t'thickness',\n\t'transmission',\n\t'transmissionMap'\n];\n\nclass NodeMaterialObserver {\n\n\tconstructor( builder ) {\n\n\t\tthis.renderObjects = new WeakMap();\n\t\tthis.hasNode = this.containsNode( builder );\n\t\tthis.hasAnimation = builder.object.isSkinnedMesh === true;\n\t\tthis.refreshUniforms = refreshUniforms;\n\t\tthis.renderId = 0;\n\n\t}\n\n\tfirstInitialization( renderObject ) {\n\n\t\tconst hasInitialized = this.renderObjects.has( renderObject );\n\n\t\tif ( hasInitialized === false ) {\n\n\t\t\tthis.getRenderObjectData( renderObject );\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetRenderObjectData( renderObject ) {\n\n\t\tlet data = this.renderObjects.get( renderObject );\n\n\t\tif ( data === undefined ) {\n\n\t\t\tconst { geometry, material } = renderObject;\n\n\t\t\tdata = {\n\t\t\t\tmaterial: this.getMaterialData( material ),\n\t\t\t\tgeometry: {\n\t\t\t\t\tattributes: this.getAttributesData( geometry.attributes ),\n\t\t\t\t\tindexVersion: geometry.index ? geometry.index.version : null,\n\t\t\t\t\tdrawRange: { start: geometry.drawRange.start, count: geometry.drawRange.count }\n\t\t\t\t},\n\t\t\t\tworldMatrix: renderObject.object.matrixWorld.clone()\n\t\t\t};\n\n\t\t\tif ( renderObject.object.center ) {\n\n\t\t\t\tdata.center = renderObject.object.center.clone();\n\n\t\t\t}\n\n\t\t\tif ( renderObject.object.morphTargetInfluences ) {\n\n\t\t\t\tdata.morphTargetInfluences = renderObject.object.morphTargetInfluences.slice();\n\n\t\t\t}\n\n\t\t\tif ( renderObject.bundle !== null ) {\n\n\t\t\t\tdata.version = renderObject.bundle.version;\n\n\t\t\t}\n\n\t\t\tif ( data.material.transmission > 0 ) {\n\n\t\t\t\tconst { width, height } = renderObject.context;\n\n\t\t\t\tdata.bufferWidth = width;\n\t\t\t\tdata.bufferHeight = height;\n\n\t\t\t}\n\n\t\t\tthis.renderObjects.set( renderObject, data );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tgetAttributesData( attributes ) {\n\n\t\tconst attributesData = {};\n\n\t\tfor ( const name in attributes ) {\n\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tattributesData[ name ] = {\n\t\t\t\tversion: attribute.version\n\t\t\t};\n\n\t\t}\n\n\t\treturn attributesData;\n\n\t}\n\n\tcontainsNode( builder ) {\n\n\t\tconst material = builder.material;\n\n\t\tfor ( const property in material ) {\n\n\t\t\tif ( material[ property ] && material[ property ].isNode )\n\t\t\t\treturn true;\n\n\t\t}\n\n\t\tif ( builder.renderer.nodes.modelViewMatrix !== null || builder.renderer.nodes.modelNormalViewMatrix !== null )\n\t\t\treturn true;\n\n\t\treturn false;\n\n\t}\n\n\tgetMaterialData( material ) {\n\n\t\tconst data = {};\n\n\t\tfor ( const property of this.refreshUniforms ) {\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tif ( value === null || value === undefined ) continue;\n\n\t\t\tif ( typeof value === 'object' && value.clone !== undefined ) {\n\n\t\t\t\tif ( value.isTexture === true ) {\n\n\t\t\t\t\tdata[ property ] = { id: value.id, version: value.version };\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdata[ property ] = value.clone();\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tdata[ property ] = value;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tequals( renderObject ) {\n\n\t\tconst { object, material, geometry } = renderObject;\n\n\t\tconst renderObjectData = this.getRenderObjectData( renderObject );\n\n\t\t// world matrix\n\n\t\tif ( renderObjectData.worldMatrix.equals( object.matrixWorld ) !== true ) {\n\n\t\t\trenderObjectData.worldMatrix.copy( object.matrixWorld );\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// material\n\n\t\tconst materialData = renderObjectData.material;\n\n\t\tfor ( const property in materialData ) {\n\n\t\t\tconst value = materialData[ property ];\n\t\t\tconst mtlValue = material[ property ];\n\n\t\t\tif ( value.equals !== undefined ) {\n\n\t\t\t\tif ( value.equals( mtlValue ) === false ) {\n\n\t\t\t\t\tvalue.copy( mtlValue );\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t} else if ( mtlValue.isTexture === true ) {\n\n\t\t\t\tif ( value.id !== mtlValue.id || value.version !== mtlValue.version ) {\n\n\t\t\t\t\tvalue.id = mtlValue.id;\n\t\t\t\t\tvalue.version = mtlValue.version;\n\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\n\t\t\t} else if ( value !== mtlValue ) {\n\n\t\t\t\tmaterialData[ property ] = mtlValue;\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialData.transmission > 0 ) {\n\n\t\t\tconst { width, height } = renderObject.context;\n\n\t\t\tif ( renderObjectData.bufferWidth !== width || renderObjectData.bufferHeight !== height ) {\n\n\t\t\t\trenderObjectData.bufferWidth = width;\n\t\t\t\trenderObjectData.bufferHeight = height;\n\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// geometry\n\n\t\tconst storedGeometryData = renderObjectData.geometry;\n\t\tconst attributes = geometry.attributes;\n\t\tconst storedAttributes = storedGeometryData.attributes;\n\n\t\tconst storedAttributeNames = Object.keys( storedAttributes );\n\t\tconst currentAttributeNames = Object.keys( attributes );\n\n\t\tif ( storedAttributeNames.length !== currentAttributeNames.length ) {\n\n\t\t\trenderObjectData.geometry.attributes = this.getAttributesData( attributes );\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// Compare each attribute\n\t\tfor ( const name of storedAttributeNames ) {\n\n\t\t\tconst storedAttributeData = storedAttributes[ name ];\n\t\t\tconst attribute = attributes[ name ];\n\n\t\t\tif ( attribute === undefined ) {\n\n\t\t\t\t// Attribute was removed\n\t\t\t\tdelete storedAttributes[ name ];\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t\tif ( storedAttributeData.version !== attribute.version ) {\n\n\t\t\t\tstoredAttributeData.version = attribute.version;\n\t\t\t\treturn false;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Check index\n\t\tconst index = geometry.index;\n\t\tconst storedIndexVersion = storedGeometryData.indexVersion;\n\t\tconst currentIndexVersion = index ? index.version : null;\n\n\t\tif ( storedIndexVersion !== currentIndexVersion ) {\n\n\t\t\tstoredGeometryData.indexVersion = currentIndexVersion;\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// Check drawRange\n\t\tif ( storedGeometryData.drawRange.start !== geometry.drawRange.start || storedGeometryData.drawRange.count !== geometry.drawRange.count ) {\n\n\t\t\tstoredGeometryData.drawRange.start = geometry.drawRange.start;\n\t\t\tstoredGeometryData.drawRange.count = geometry.drawRange.count;\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// morph targets\n\n\t\tif ( renderObjectData.morphTargetInfluences ) {\n\n\t\t\tlet morphChanged = false;\n\n\t\t\tfor ( let i = 0; i < renderObjectData.morphTargetInfluences.length; i ++ ) {\n\n\t\t\t\tif ( renderObjectData.morphTargetInfluences[ i ] !== object.morphTargetInfluences[ i ] ) {\n\n\t\t\t\t\tmorphChanged = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( morphChanged ) return true;\n\n\t\t}\n\n\t\t// center\n\n\t\tif ( renderObjectData.center ) {\n\n\t\t\tif ( renderObjectData.center.equals( object.center ) === false ) {\n\n\t\t\t\trenderObjectData.center.copy( object.center );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// bundle\n\n\t\tif ( renderObject.bundle !== null ) {\n\n\t\t\trenderObjectData.version = renderObject.bundle.version;\n\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tneedsRefresh( renderObject, nodeFrame ) {\n\n\t\tif ( this.hasNode || this.hasAnimation || this.firstInitialization( renderObject ) )\n\t\t\treturn true;\n\n\t\tconst { renderId } = nodeFrame;\n\n\t\tif ( this.renderId !== renderId ) {\n\n\t\t\tthis.renderId = renderId;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\tconst isStatic = renderObject.object.static === true;\n\t\tconst isBundle = renderObject.bundle !== null && renderObject.bundle.static === true && this.getRenderObjectData( renderObject ).version === renderObject.bundle.version;\n\n\t\tif ( isStatic || isBundle )\n\t\t\treturn false;\n\n\t\tconst notEqual = this.equals( renderObject ) !== true;\n\n\t\treturn notEqual;\n\n\t}\n\n}\n\n// cyrb53 (c) 2018 bryc (github.com/bryc). License: Public domain. Attribution appreciated.\n// A fast and simple 64-bit (or 53-bit) string hash function with decent collision resistance.\n// Largely inspired by MurmurHash2/3, but with a focus on speed/simplicity.\n// See https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript/52171480#52171480\n// https://github.com/bryc/code/blob/master/jshash/experimental/cyrb53.js\nfunction cyrb53( value, seed = 0 ) {\n\n\tlet h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\n\n\tif ( value instanceof Array ) {\n\n\t\tfor ( let i = 0, val; i < value.length; i ++ ) {\n\n\t\t\tval = value[ i ];\n\t\t\th1 = Math.imul( h1 ^ val, 2654435761 );\n\t\t\th2 = Math.imul( h2 ^ val, 1597334677 );\n\n\t\t}\n\n\t} else {\n\n\t\tfor ( let i = 0, ch; i < value.length; i ++ ) {\n\n\t\t\tch = value.charCodeAt( i );\n\t\t\th1 = Math.imul( h1 ^ ch, 2654435761 );\n\t\t\th2 = Math.imul( h2 ^ ch, 1597334677 );\n\n\t\t}\n\n\t}\n\n\th1 = Math.imul( h1 ^ ( h1 >>> 16 ), 2246822507 );\n\th1 ^= Math.imul( h2 ^ ( h2 >>> 13 ), 3266489909 );\n\th2 = Math.imul( h2 ^ ( h2 >>> 16 ), 2246822507 );\n\th2 ^= Math.imul( h1 ^ ( h1 >>> 13 ), 3266489909 );\n\n\treturn 4294967296 * ( 2097151 & h2 ) + ( h1 >>> 0 );\n\n}\n\nconst hashString = ( str ) => cyrb53( str );\nconst hashArray = ( array ) => cyrb53( array );\nconst hash$1 = ( ...params ) => cyrb53( params );\n\nfunction getCacheKey$1( object, force = false ) {\n\n\tconst values = [];\n\n\tif ( object.isNode === true ) {\n\n\t\tvalues.push( object.id );\n\t\tobject = object.getSelf();\n\n\t}\n\n\tfor ( const { property, childNode } of getNodeChildren( object ) ) {\n\n\t\tvalues.push( values, cyrb53( property.slice( 0, - 4 ) ), childNode.getCacheKey( force ) );\n\n\t}\n\n\treturn cyrb53( values );\n\n}\n\nfunction* getNodeChildren( node, toJSON = false ) {\n\n\tfor ( const property in node ) {\n\n\t\t// Ignore private properties.\n\t\tif ( property.startsWith( '_' ) === true ) continue;\n\n\t\tconst object = node[ property ];\n\n\t\tif ( Array.isArray( object ) === true ) {\n\n\t\t\tfor ( let i = 0; i < object.length; i ++ ) {\n\n\t\t\t\tconst child = object[ i ];\n\n\t\t\t\tif ( child && ( child.isNode === true || toJSON && typeof child.toJSON === 'function' ) ) {\n\n\t\t\t\t\tyield { property, index: i, childNode: child };\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( object && object.isNode === true ) {\n\n\t\t\tyield { property, childNode: object };\n\n\t\t} else if ( typeof object === 'object' ) {\n\n\t\t\tfor ( const subProperty in object ) {\n\n\t\t\t\tconst child = object[ subProperty ];\n\n\t\t\t\tif ( child && ( child.isNode === true || toJSON && typeof child.toJSON === 'function' ) ) {\n\n\t\t\t\t\tyield { property, index: subProperty, childNode: child };\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction getValueType( value ) {\n\n\tif ( value === undefined || value === null ) return null;\n\n\tconst typeOf = typeof value;\n\n\tif ( value.isNode === true ) {\n\n\t\treturn 'node';\n\n\t} else if ( typeOf === 'number' ) {\n\n\t\treturn 'float';\n\n\t} else if ( typeOf === 'boolean' ) {\n\n\t\treturn 'bool';\n\n\t} else if ( typeOf === 'string' ) {\n\n\t\treturn 'string';\n\n\t} else if ( typeOf === 'function' ) {\n\n\t\treturn 'shader';\n\n\t} else if ( value.isVector2 === true ) {\n\n\t\treturn 'vec2';\n\n\t} else if ( value.isVector3 === true ) {\n\n\t\treturn 'vec3';\n\n\t} else if ( value.isVector4 === true ) {\n\n\t\treturn 'vec4';\n\n\t} else if ( value.isMatrix3 === true ) {\n\n\t\treturn 'mat3';\n\n\t} else if ( value.isMatrix4 === true ) {\n\n\t\treturn 'mat4';\n\n\t} else if ( value.isColor === true ) {\n\n\t\treturn 'color';\n\n\t} else if ( value instanceof ArrayBuffer ) {\n\n\t\treturn 'ArrayBuffer';\n\n\t}\n\n\treturn null;\n\n}\n\nfunction getValueFromType( type, ...params ) {\n\n\tconst last4 = type ? type.slice( - 4 ) : undefined;\n\n\tif ( params.length === 1 ) { // ensure same behaviour as in NodeBuilder.format()\n\n\t\tif ( last4 === 'vec2' ) params = [ params[ 0 ], params[ 0 ] ];\n\t\telse if ( last4 === 'vec3' ) params = [ params[ 0 ], params[ 0 ], params[ 0 ] ];\n\t\telse if ( last4 === 'vec4' ) params = [ params[ 0 ], params[ 0 ], params[ 0 ], params[ 0 ] ];\n\n\t}\n\n\tif ( type === 'color' ) {\n\n\t\treturn new Color( ...params );\n\n\t} else if ( last4 === 'vec2' ) {\n\n\t\treturn new Vector2( ...params );\n\n\t} else if ( last4 === 'vec3' ) {\n\n\t\treturn new Vector3( ...params );\n\n\t} else if ( last4 === 'vec4' ) {\n\n\t\treturn new Vector4( ...params );\n\n\t} else if ( last4 === 'mat3' ) {\n\n\t\treturn new Matrix3( ...params );\n\n\t} else if ( last4 === 'mat4' ) {\n\n\t\treturn new Matrix4( ...params );\n\n\t} else if ( type === 'bool' ) {\n\n\t\treturn params[ 0 ] || false;\n\n\t} else if ( ( type === 'float' ) || ( type === 'int' ) || ( type === 'uint' ) ) {\n\n\t\treturn params[ 0 ] || 0;\n\n\t} else if ( type === 'string' ) {\n\n\t\treturn params[ 0 ] || '';\n\n\t} else if ( type === 'ArrayBuffer' ) {\n\n\t\treturn base64ToArrayBuffer( params[ 0 ] );\n\n\t}\n\n\treturn null;\n\n}\n\nfunction arrayBufferToBase64( arrayBuffer ) {\n\n\tlet chars = '';\n\n\tconst array = new Uint8Array( arrayBuffer );\n\n\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\tchars += String.fromCharCode( array[ i ] );\n\n\t}\n\n\treturn btoa( chars );\n\n}\n\nfunction base64ToArrayBuffer( base64 ) {\n\n\treturn Uint8Array.from( atob( base64 ), c => c.charCodeAt( 0 ) ).buffer;\n\n}\n\nvar NodeUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tarrayBufferToBase64: arrayBufferToBase64,\n\tbase64ToArrayBuffer: base64ToArrayBuffer,\n\tgetCacheKey: getCacheKey$1,\n\tgetNodeChildren: getNodeChildren,\n\tgetValueFromType: getValueFromType,\n\tgetValueType: getValueType,\n\thash: hash$1,\n\thashArray: hashArray,\n\thashString: hashString\n});\n\nconst NodeShaderStage = {\n\tVERTEX: 'vertex',\n\tFRAGMENT: 'fragment'\n};\n\nconst NodeUpdateType = {\n\tNONE: 'none',\n\tFRAME: 'frame',\n\tRENDER: 'render',\n\tOBJECT: 'object'\n};\n\nconst NodeType = {\n\tBOOLEAN: 'bool',\n\tINTEGER: 'int',\n\tFLOAT: 'float',\n\tVECTOR2: 'vec2',\n\tVECTOR3: 'vec3',\n\tVECTOR4: 'vec4',\n\tMATRIX2: 'mat2',\n\tMATRIX3: 'mat3',\n\tMATRIX4: 'mat4'\n};\n\nconst defaultShaderStages = [ 'fragment', 'vertex' ];\nconst defaultBuildStages = [ 'setup', 'analyze', 'generate' ];\nconst shaderStages = [ ...defaultShaderStages, 'compute' ];\nconst vectorComponents = [ 'x', 'y', 'z', 'w' ];\n\nlet _nodeId = 0;\n\nclass Node extends EventDispatcher {\n\n\tstatic get type() {\n\n\t\treturn 'Node';\n\n\t}\n\n\tconstructor( nodeType = null ) {\n\n\t\tsuper();\n\n\t\tthis.nodeType = nodeType;\n\n\t\tthis.updateType = NodeUpdateType.NONE;\n\t\tthis.updateBeforeType = NodeUpdateType.NONE;\n\t\tthis.updateAfterType = NodeUpdateType.NONE;\n\n\t\tthis.uuid = MathUtils.generateUUID();\n\n\t\tthis.version = 0;\n\n\t\tthis._cacheKey = null;\n\t\tthis._cacheKeyVersion = 0;\n\n\t\tthis.global = false;\n\n\t\tthis.isNode = true;\n\n\t\tObject.defineProperty( this, 'id', { value: _nodeId ++ } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) {\n\n\t\t\tthis.version ++;\n\n\t\t}\n\n\t}\n\n\tget type() {\n\n\t\treturn this.constructor.type;\n\n\t}\n\n\tonUpdate( callback, updateType ) {\n\n\t\tthis.updateType = updateType;\n\t\tthis.update = callback.bind( this.getSelf() );\n\n\t\treturn this;\n\n\t}\n\n\tonFrameUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.FRAME );\n\n\t}\n\n\tonRenderUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.RENDER );\n\n\t}\n\n\tonObjectUpdate( callback ) {\n\n\t\treturn this.onUpdate( callback, NodeUpdateType.OBJECT );\n\n\t}\n\n\tonReference( callback ) {\n\n\t\tthis.updateReference = callback.bind( this.getSelf() );\n\n\t\treturn this;\n\n\t}\n\n\tgetSelf() {\n\n\t\t// Returns non-node object.\n\n\t\treturn this.self || this;\n\n\t}\n\n\tupdateReference( /*state*/ ) {\n\n\t\treturn this;\n\n\t}\n\n\tisGlobal( /*builder*/ ) {\n\n\t\treturn this.global;\n\n\t}\n\n\t* getChildren() {\n\n\t\tfor ( const { childNode } of getNodeChildren( this ) ) {\n\n\t\t\tyield childNode;\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\ttraverse( callback ) {\n\n\t\tcallback( this );\n\n\t\tfor ( const childNode of this.getChildren() ) {\n\n\t\t\tchildNode.traverse( callback );\n\n\t\t}\n\n\t}\n\n\tgetCacheKey( force = false ) {\n\n\t\tforce = force || this.version !== this._cacheKeyVersion;\n\n\t\tif ( force === true || this._cacheKey === null ) {\n\n\t\t\tthis._cacheKey = getCacheKey$1( this, force );\n\t\t\tthis._cacheKeyVersion = this.version;\n\n\t\t}\n\n\t\treturn this._cacheKey;\n\n\t}\n\n\tgetScope() {\n\n\t\treturn this;\n\n\t}\n\n\tgetHash( /*builder*/ ) {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetUpdateType() {\n\n\t\treturn this.updateType;\n\n\t}\n\n\tgetUpdateBeforeType() {\n\n\t\treturn this.updateBeforeType;\n\n\t}\n\n\tgetUpdateAfterType() {\n\n\t\treturn this.updateAfterType;\n\n\t}\n\n\tgetElementType( builder ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst elementType = builder.getElementType( type );\n\n\t\treturn elementType;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\tif ( nodeProperties.outputNode ) {\n\n\t\t\treturn nodeProperties.outputNode.getNodeType( builder );\n\n\t\t}\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tgetShared( builder ) {\n\n\t\tconst hash = this.getHash( builder );\n\t\tconst nodeFromHash = builder.getNodeFromHash( hash );\n\n\t\treturn nodeFromHash || this;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\tlet index = 0;\n\n\t\tfor ( const childNode of this.getChildren() ) {\n\n\t\t\tnodeProperties[ 'node' + index ++ ] = childNode;\n\n\t\t}\n\n\t\t// return a outputNode if exists\n\t\treturn null;\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tconst usageCount = builder.increaseUsage( this );\n\n\t\tif ( usageCount === 1 ) {\n\n\t\t\t// node flow children\n\n\t\t\tconst nodeProperties = builder.getNodeProperties( this );\n\n\t\t\tfor ( const childNode of Object.values( nodeProperties ) ) {\n\n\t\t\t\tif ( childNode && childNode.isNode === true ) {\n\n\t\t\t\t\tchildNode.build( builder );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { outputNode } = builder.getNodeProperties( this );\n\n\t\tif ( outputNode && outputNode.isNode === true ) {\n\n\t\t\treturn outputNode.build( builder, output );\n\n\t\t}\n\n\t}\n\n\tupdateBefore( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tupdateAfter( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tbuild( builder, output = null ) {\n\n\t\tconst refNode = this.getShared( builder );\n\n\t\tif ( this !== refNode ) {\n\n\t\t\treturn refNode.build( builder, output );\n\n\t\t}\n\n\t\tbuilder.addNode( this );\n\t\tbuilder.addChain( this );\n\n\t\t/* Build stages expected results:\n\t\t\t- \"setup\"\t\t-> Node\n\t\t\t- \"analyze\"\t\t-> null\n\t\t\t- \"generate\"\t-> String\n\t\t*/\n\t\tlet result = null;\n\n\t\tconst buildStage = builder.getBuildStage();\n\n\t\tif ( buildStage === 'setup' ) {\n\n\t\t\tthis.updateReference( builder );\n\n\t\t\tconst properties = builder.getNodeProperties( this );\n\n\t\t\tif ( properties.initialized !== true ) {\n\n\t\t\t\tconst stackNodesBeforeSetup = builder.stack.nodes.length;\n\n\t\t\t\tproperties.initialized = true;\n\t\t\t\tproperties.outputNode = this.setup( builder );\n\n\t\t\t\tif ( properties.outputNode !== null && builder.stack.nodes.length !== stackNodesBeforeSetup ) ;\n\n\t\t\t\tfor ( const childNode of Object.values( properties ) ) {\n\n\t\t\t\t\tif ( childNode && childNode.isNode === true ) {\n\n\t\t\t\t\t\tchildNode.build( builder );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( buildStage === 'analyze' ) {\n\n\t\t\tthis.analyze( builder );\n\n\t\t} else if ( buildStage === 'generate' ) {\n\n\t\t\tconst isGenerateOnce = this.generate.length === 1;\n\n\t\t\tif ( isGenerateOnce ) {\n\n\t\t\t\tconst type = this.getNodeType( builder );\n\t\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\t\tresult = nodeData.snippet;\n\n\t\t\t\tif ( result === undefined ) {\n\n\t\t\t\t\tresult = this.generate( builder ) || '';\n\n\t\t\t\t\tnodeData.snippet = result;\n\n\t\t\t\t} else if ( nodeData.flowCodes !== undefined && builder.context.nodeBlock !== undefined ) {\n\n\t\t\t\t\tbuilder.addFlowCodeHierarchy( this, builder.context.nodeBlock );\n\n\t\t\t\t}\n\n\t\t\t\tresult = builder.format( result, type, output );\n\n\t\t\t} else {\n\n\t\t\t\tresult = this.generate( builder, output ) || '';\n\n\t\t\t}\n\n\t\t}\n\n\t\tbuilder.removeChain( this );\n\t\tbuilder.addSequentialNode( this );\n\n\t\treturn result;\n\n\t}\n\n\tgetSerializeChildren() {\n\n\t\treturn getNodeChildren( this );\n\n\t}\n\n\tserialize( json ) {\n\n\t\tconst nodeChildren = this.getSerializeChildren();\n\n\t\tconst inputNodes = {};\n\n\t\tfor ( const { property, index, childNode } of nodeChildren ) {\n\n\t\t\tif ( index !== undefined ) {\n\n\t\t\t\tif ( inputNodes[ property ] === undefined ) {\n\n\t\t\t\t\tinputNodes[ property ] = Number.isInteger( index ) ? [] : {};\n\n\t\t\t\t}\n\n\t\t\t\tinputNodes[ property ][ index ] = childNode.toJSON( json.meta ).uuid;\n\n\t\t\t} else {\n\n\t\t\t\tinputNodes[ property ] = childNode.toJSON( json.meta ).uuid;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( Object.keys( inputNodes ).length > 0 ) {\n\n\t\t\tjson.inputNodes = inputNodes;\n\n\t\t}\n\n\t}\n\n\tdeserialize( json ) {\n\n\t\tif ( json.inputNodes !== undefined ) {\n\n\t\t\tconst nodes = json.meta.nodes;\n\n\t\t\tfor ( const property in json.inputNodes ) {\n\n\t\t\t\tif ( Array.isArray( json.inputNodes[ property ] ) ) {\n\n\t\t\t\t\tconst inputArray = [];\n\n\t\t\t\t\tfor ( const uuid of json.inputNodes[ property ] ) {\n\n\t\t\t\t\t\tinputArray.push( nodes[ uuid ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[ property ] = inputArray;\n\n\t\t\t\t} else if ( typeof json.inputNodes[ property ] === 'object' ) {\n\n\t\t\t\t\tconst inputObject = {};\n\n\t\t\t\t\tfor ( const subProperty in json.inputNodes[ property ] ) {\n\n\t\t\t\t\t\tconst uuid = json.inputNodes[ property ][ subProperty ];\n\n\t\t\t\t\t\tinputObject[ subProperty ] = nodes[ uuid ];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[ property ] = inputObject;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst uuid = json.inputNodes[ property ];\n\n\t\t\t\t\tthis[ property ] = nodes[ uuid ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst { uuid, type } = this;\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t}\n\n\t\t// serialize\n\n\t\tlet data = meta.nodes[ uuid ];\n\n\t\tif ( data === undefined ) {\n\n\t\t\tdata = {\n\t\t\t\tuuid,\n\t\t\t\ttype,\n\t\t\t\tmeta,\n\t\t\t\tmetadata: {\n\t\t\t\t\tversion: 4.6,\n\t\t\t\t\ttype: 'Node',\n\t\t\t\t\tgenerator: 'Node.toJSON'\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ( isRoot !== true ) meta.nodes[ data.uuid ] = data;\n\n\t\t\tthis.serialize( data );\n\n\t\t\tdelete data.meta;\n\n\t\t}\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\t\t\tif ( nodes.length > 0 ) data.nodes = nodes;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n}\n\nclass ArrayElementNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ArrayElementNode';\n\n\t} // @TODO: If extending from TempNode it breaks webgpu_compute\n\n\tconstructor( node, indexNode ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.indexNode = indexNode;\n\n\t\tthis.isArrayElementNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getElementType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeSnippet = this.node.build( builder );\n\t\tconst indexSnippet = this.indexNode.build( builder, 'uint' );\n\n\t\treturn `${nodeSnippet}[ ${indexSnippet} ]`;\n\n\t}\n\n}\n\nclass ConvertNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ConvertNode';\n\n\t}\n\n\tconstructor( node, convertTo ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.convertTo = convertTo;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst requestType = this.node.getNodeType( builder );\n\n\t\tlet convertTo = null;\n\n\t\tfor ( const overloadingType of this.convertTo.split( '|' ) ) {\n\n\t\t\tif ( convertTo === null || builder.getTypeLength( requestType ) === builder.getTypeLength( overloadingType ) ) {\n\n\t\t\t\tconvertTo = overloadingType;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn convertTo;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.convertTo = this.convertTo;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.convertTo = data.convertTo;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst node = this.node;\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst snippet = node.build( builder, type );\n\n\t\treturn builder.format( snippet, type, output );\n\n\t}\n\n}\n\nclass TempNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'TempNode';\n\n\t}\n\n\tconstructor( type ) {\n\n\t\tsuper( type );\n\n\t\tthis.isTempNode = true;\n\n\t}\n\n\thasDependencies( builder ) {\n\n\t\treturn builder.getDataFromNode( this ).usageCount > 1;\n\n\t}\n\n\tbuild( builder, output ) {\n\n\t\tconst buildStage = builder.getBuildStage();\n\n\t\tif ( buildStage === 'generate' ) {\n\n\t\t\tconst type = builder.getVectorType( this.getNodeType( builder, output ) );\n\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\tif ( nodeData.propertyName !== undefined ) {\n\n\t\t\t\treturn builder.format( nodeData.propertyName, type, output );\n\n\t\t\t} else if ( type !== 'void' && output !== 'void' && this.hasDependencies( builder ) ) {\n\n\t\t\t\tconst snippet = super.build( builder, type );\n\n\t\t\t\tconst nodeVar = builder.getVarFromNode( this, null, type );\n\t\t\t\tconst propertyName = builder.getPropertyName( nodeVar );\n\n\t\t\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}`, this );\n\n\t\t\t\tnodeData.snippet = snippet;\n\t\t\t\tnodeData.propertyName = propertyName;\n\n\t\t\t\treturn builder.format( nodeData.propertyName, type, output );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.build( builder, output );\n\n\t}\n\n}\n\nclass JoinNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'JoinNode';\n\n\t}\n\n\tconstructor( nodes = [], nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.nodes = nodes;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.nodeType !== null ) {\n\n\t\t\treturn builder.getVectorType( this.nodeType );\n\n\t\t}\n\n\t\treturn builder.getTypeFromLength( this.nodes.reduce( ( count, cur ) => count + builder.getTypeLength( cur.getNodeType( builder ) ), 0 ) );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst nodes = this.nodes;\n\n\t\tconst primitiveType = builder.getComponentType( type );\n\n\t\tconst snippetValues = [];\n\n\t\tfor ( const input of nodes ) {\n\n\t\t\tlet inputSnippet = input.build( builder );\n\n\t\t\tconst inputPrimitiveType = builder.getComponentType( input.getNodeType( builder ) );\n\n\t\t\tif ( inputPrimitiveType !== primitiveType ) {\n\n\t\t\t\tinputSnippet = builder.format( inputSnippet, inputPrimitiveType, primitiveType );\n\n\t\t\t}\n\n\t\t\tsnippetValues.push( inputSnippet );\n\n\t\t}\n\n\t\tconst snippet = `${ builder.getType( type ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t\treturn builder.format( snippet, type, output );\n\n\t}\n\n}\n\nconst stringVectorComponents = vectorComponents.join( '' );\n\nclass SplitNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SplitNode';\n\n\t}\n\n\tconstructor( node, components = 'x' ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.components = components;\n\n\t\tthis.isSplitNode = true;\n\n\t}\n\n\tgetVectorLength() {\n\n\t\tlet vectorLength = this.components.length;\n\n\t\tfor ( const c of this.components ) {\n\n\t\t\tvectorLength = Math.max( vectorComponents.indexOf( c ) + 1, vectorLength );\n\n\t\t}\n\n\t\treturn vectorLength;\n\n\t}\n\n\tgetComponentType( builder ) {\n\n\t\treturn builder.getComponentType( this.node.getNodeType( builder ) );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn builder.getTypeFromLength( this.components.length, this.getComponentType( builder ) );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst node = this.node;\n\t\tconst nodeTypeLength = builder.getTypeLength( node.getNodeType( builder ) );\n\n\t\tlet snippet = null;\n\n\t\tif ( nodeTypeLength > 1 ) {\n\n\t\t\tlet type = null;\n\n\t\t\tconst componentsLength = this.getVectorLength();\n\n\t\t\tif ( componentsLength >= nodeTypeLength ) {\n\n\t\t\t\t// needed expand the input node\n\n\t\t\t\ttype = builder.getTypeFromLength( this.getVectorLength(), this.getComponentType( builder ) );\n\n\t\t\t}\n\n\t\t\tconst nodeSnippet = node.build( builder, type );\n\n\t\t\tif ( this.components.length === nodeTypeLength && this.components === stringVectorComponents.slice( 0, this.components.length ) ) {\n\n\t\t\t\t// unnecessary swizzle\n\n\t\t\t\tsnippet = builder.format( nodeSnippet, type, output );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = builder.format( `${nodeSnippet}.${this.components}`, this.getNodeType( builder ), output );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// ignore .components if .node returns float/integer\n\n\t\t\tsnippet = node.build( builder, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.components = this.components;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.components = data.components;\n\n\t}\n\n}\n\nclass SetNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'SetNode';\n\n\t}\n\n\tconstructor( sourceNode, components, targetNode ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.components = components;\n\t\tthis.targetNode = targetNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.sourceNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { sourceNode, components, targetNode } = this;\n\n\t\tconst sourceType = this.getNodeType( builder );\n\t\tconst targetType = builder.getTypeFromLength( components.length, targetNode.getNodeType( builder ) );\n\n\t\tconst targetSnippet = targetNode.build( builder, targetType );\n\t\tconst sourceSnippet = sourceNode.build( builder, sourceType );\n\n\t\tconst length = builder.getTypeLength( sourceType );\n\t\tconst snippetValues = [];\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst component = vectorComponents[ i ];\n\n\t\t\tif ( component === components[ 0 ] ) {\n\n\t\t\t\tsnippetValues.push( targetSnippet );\n\n\t\t\t\ti += components.length - 1;\n\n\t\t\t} else {\n\n\t\t\t\tsnippetValues.push( sourceSnippet + '.' + component );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `${ builder.getType( sourceType ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t}\n\n}\n\nclass FlipNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'FlipNode';\n\n\t}\n\n\tconstructor( sourceNode, components ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.components = components;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.sourceNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { components, sourceNode } = this;\n\n\t\tconst sourceType = this.getNodeType( builder );\n\t\tconst sourceSnippet = sourceNode.build( builder );\n\n\t\tconst sourceCache = builder.getVarFromNode( this );\n\t\tconst sourceProperty = builder.getPropertyName( sourceCache );\n\n\t\tbuilder.addLineFlowCode( sourceProperty + ' = ' + sourceSnippet, this );\n\n\t\tconst length = builder.getTypeLength( sourceType );\n\t\tconst snippetValues = [];\n\n\t\tlet componentIndex = 0;\n\n\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\tconst component = vectorComponents[ i ];\n\n\t\t\tif ( component === components[ componentIndex ] ) {\n\n\t\t\t\tsnippetValues.push( '1.0 - ' + ( sourceProperty + '.' + component ) );\n\n\t\t\t\tcomponentIndex ++;\n\n\t\t\t} else {\n\n\t\t\t\tsnippetValues.push( sourceProperty + '.' + component );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `${ builder.getType( sourceType ) }( ${ snippetValues.join( ', ' ) } )`;\n\n\t}\n\n}\n\nclass InputNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'InputNode';\n\n\t}\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.isInputNode = true;\n\n\t\tthis.value = value;\n\t\tthis.precision = null;\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\tif ( this.nodeType === null ) {\n\n\t\t\treturn getValueType( this.value );\n\n\t\t}\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\treturn this.getNodeType( builder );\n\n\t}\n\n\tsetPrecision( precision ) {\n\n\t\tthis.precision = precision;\n\n\t\treturn this;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.value = this.value;\n\n\t\tif ( this.value && this.value.toArray ) data.value = this.value.toArray();\n\n\t\tdata.valueType = getValueType( this.value );\n\t\tdata.nodeType = this.nodeType;\n\n\t\tif ( data.valueType === 'ArrayBuffer' ) data.value = arrayBufferToBase64( data.value );\n\n\t\tdata.precision = this.precision;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.nodeType = data.nodeType;\n\t\tthis.value = Array.isArray( data.value ) ? getValueFromType( data.valueType, ...data.value ) : data.value;\n\n\t\tthis.precision = data.precision || null;\n\n\t\tif ( this.value && this.value.fromArray ) this.value = this.value.fromArray( data.value );\n\n\t}\n\n\tgenerate( /*builder, output*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nclass ConstNode extends InputNode {\n\n\tstatic get type() {\n\n\t\treturn 'ConstNode';\n\n\t}\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( value, nodeType );\n\n\t\tthis.isConstNode = true;\n\n\t}\n\n\tgenerateConst( builder ) {\n\n\t\treturn builder.generateConst( this.getNodeType( builder ), this.value );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\treturn builder.format( this.generateConst( builder ), type, output );\n\n\t}\n\n}\n\n//\n\nlet currentStack = null;\n\nconst NodeElements = new Map();\n\nfunction addMethodChaining( name, nodeElement ) {\n\n\tif ( NodeElements.has( name ) ) {\n\n\t\tconsole.warn( `Redefinition of method chaining ${ name }` );\n\t\treturn;\n\n\t}\n\n\tif ( typeof nodeElement !== 'function' ) throw new Error( `Node element ${ name } is not a function` );\n\n\tNodeElements.set( name, nodeElement );\n\n}\n\nconst parseSwizzle = ( props ) => props.replace( /r|s/g, 'x' ).replace( /g|t/g, 'y' ).replace( /b|p/g, 'z' ).replace( /a|q/g, 'w' );\nconst parseSwizzleAndSort = ( props ) => parseSwizzle( props ).split( '' ).sort().join( '' );\n\nconst shaderNodeHandler = {\n\n\tsetup( NodeClosure, params ) {\n\n\t\tconst inputs = params.shift();\n\n\t\treturn NodeClosure( nodeObjects( inputs ), ...params );\n\n\t},\n\n\tget( node, prop, nodeObj ) {\n\n\t\tif ( typeof prop === 'string' && node[ prop ] === undefined ) {\n\n\t\t\tif ( node.isStackNode !== true && prop === 'assign' ) {\n\n\t\t\t\treturn ( ...params ) => {\n\n\t\t\t\t\tcurrentStack.assign( nodeObj, ...params );\n\n\t\t\t\t\treturn nodeObj;\n\n\t\t\t\t};\n\n\t\t\t} else if ( NodeElements.has( prop ) ) {\n\n\t\t\t\tconst nodeElement = NodeElements.get( prop );\n\n\t\t\t\treturn node.isStackNode ? ( ...params ) => nodeObj.add( nodeElement( ...params ) ) : ( ...params ) => nodeElement( nodeObj, ...params );\n\n\t\t\t} else if ( prop === 'self' ) {\n\n\t\t\t\treturn node;\n\n\t\t\t} else if ( prop.endsWith( 'Assign' ) && NodeElements.has( prop.slice( 0, prop.length - 'Assign'.length ) ) ) {\n\n\t\t\t\tconst nodeElement = NodeElements.get( prop.slice( 0, prop.length - 'Assign'.length ) );\n\n\t\t\t\treturn node.isStackNode ? ( ...params ) => nodeObj.assign( params[ 0 ], nodeElement( ...params ) ) : ( ...params ) => nodeObj.assign( nodeElement( nodeObj, ...params ) );\n\n\t\t\t} else if ( /^[xyzwrgbastpq]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// accessing properties ( swizzle )\n\n\t\t\t\tprop = parseSwizzle( prop );\n\n\t\t\t\treturn nodeObject( new SplitNode( nodeObj, prop ) );\n\n\t\t\t} else if ( /^set[XYZWRGBASTPQ]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// set properties ( swizzle ) and sort to xyzw sequence\n\n\t\t\t\tprop = parseSwizzleAndSort( prop.slice( 3 ).toLowerCase() );\n\n\t\t\t\treturn ( value ) => nodeObject( new SetNode( node, prop, value ) );\n\n\t\t\t} else if ( /^flip[XYZWRGBASTPQ]{1,4}$/.test( prop ) === true ) {\n\n\t\t\t\t// set properties ( swizzle ) and sort to xyzw sequence\n\n\t\t\t\tprop = parseSwizzleAndSort( prop.slice( 4 ).toLowerCase() );\n\n\t\t\t\treturn () => nodeObject( new FlipNode( nodeObject( node ), prop ) );\n\n\t\t\t} else if ( prop === 'width' || prop === 'height' || prop === 'depth' ) {\n\n\t\t\t\t// accessing property\n\n\t\t\t\tif ( prop === 'width' ) prop = 'x';\n\t\t\t\telse if ( prop === 'height' ) prop = 'y';\n\t\t\t\telse if ( prop === 'depth' ) prop = 'z';\n\n\t\t\t\treturn nodeObject( new SplitNode( node, prop ) );\n\n\t\t\t} else if ( /^\\d+$/.test( prop ) === true ) {\n\n\t\t\t\t// accessing array\n\n\t\t\t\treturn nodeObject( new ArrayElementNode( nodeObj, new ConstNode( Number( prop ), 'uint' ) ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Reflect.get( node, prop, nodeObj );\n\n\t},\n\n\tset( node, prop, value, nodeObj ) {\n\n\t\tif ( typeof prop === 'string' && node[ prop ] === undefined ) {\n\n\t\t\t// setting properties\n\n\t\t\tif ( /^[xyzwrgbastpq]{1,4}$/.test( prop ) === true || prop === 'width' || prop === 'height' || prop === 'depth' || /^\\d+$/.test( prop ) === true ) {\n\n\t\t\t\tnodeObj[ prop ].assign( value );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Reflect.set( node, prop, value, nodeObj );\n\n\t}\n\n};\n\nconst nodeObjectsCacheMap = new WeakMap();\nconst nodeBuilderFunctionsCacheMap = new WeakMap();\n\nconst ShaderNodeObject = function ( obj, altType = null ) {\n\n\tconst type = getValueType( obj );\n\n\tif ( type === 'node' ) {\n\n\t\tlet nodeObject = nodeObjectsCacheMap.get( obj );\n\n\t\tif ( nodeObject === undefined ) {\n\n\t\t\tnodeObject = new Proxy( obj, shaderNodeHandler );\n\n\t\t\tnodeObjectsCacheMap.set( obj, nodeObject );\n\t\t\tnodeObjectsCacheMap.set( nodeObject, nodeObject );\n\n\t\t}\n\n\t\treturn nodeObject;\n\n\t} else if ( ( altType === null && ( type === 'float' || type === 'boolean' ) ) || ( type && type !== 'shader' && type !== 'string' ) ) {\n\n\t\treturn nodeObject( getConstNode( obj, altType ) );\n\n\t} else if ( type === 'shader' ) {\n\n\t\treturn Fn( obj );\n\n\t}\n\n\treturn obj;\n\n};\n\nconst ShaderNodeObjects = function ( objects, altType = null ) {\n\n\tfor ( const name in objects ) {\n\n\t\tobjects[ name ] = nodeObject( objects[ name ], altType );\n\n\t}\n\n\treturn objects;\n\n};\n\nconst ShaderNodeArray = function ( array, altType = null ) {\n\n\tconst len = array.length;\n\n\tfor ( let i = 0; i < len; i ++ ) {\n\n\t\tarray[ i ] = nodeObject( array[ i ], altType );\n\n\t}\n\n\treturn array;\n\n};\n\nconst ShaderNodeProxy = function ( NodeClass, scope = null, factor = null, settings = null ) {\n\n\tconst assignNode = ( node ) => nodeObject( settings !== null ? Object.assign( node, settings ) : node );\n\n\tif ( scope === null ) {\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( ...nodeArray( params ) ) );\n\n\t\t};\n\n\t} else if ( factor !== null ) {\n\n\t\tfactor = nodeObject( factor );\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( scope, ...nodeArray( params ), factor ) );\n\n\t\t};\n\n\t} else {\n\n\t\treturn ( ...params ) => {\n\n\t\t\treturn assignNode( new NodeClass( scope, ...nodeArray( params ) ) );\n\n\t\t};\n\n\t}\n\n};\n\nconst ShaderNodeImmutable = function ( NodeClass, ...params ) {\n\n\treturn nodeObject( new NodeClass( ...nodeArray( params ) ) );\n\n};\n\nclass ShaderCallNodeInternal extends Node {\n\n\tconstructor( shaderNode, inputNodes ) {\n\n\t\tsuper();\n\n\t\tthis.shaderNode = shaderNode;\n\t\tthis.inputNodes = inputNodes;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.shaderNode.nodeType || this.getOutputNode( builder ).getNodeType( builder );\n\n\t}\n\n\tcall( builder ) {\n\n\t\tconst { shaderNode, inputNodes } = this;\n\n\t\tconst properties = builder.getNodeProperties( shaderNode );\n\t\tif ( properties.onceOutput ) return properties.onceOutput;\n\n\t\t//\n\n\t\tlet result = null;\n\n\t\tif ( shaderNode.layout ) {\n\n\t\t\tlet functionNodesCacheMap = nodeBuilderFunctionsCacheMap.get( builder.constructor );\n\n\t\t\tif ( functionNodesCacheMap === undefined ) {\n\n\t\t\t\tfunctionNodesCacheMap = new WeakMap();\n\n\t\t\t\tnodeBuilderFunctionsCacheMap.set( builder.constructor, functionNodesCacheMap );\n\n\t\t\t}\n\n\t\t\tlet functionNode = functionNodesCacheMap.get( shaderNode );\n\n\t\t\tif ( functionNode === undefined ) {\n\n\t\t\t\tfunctionNode = nodeObject( builder.buildFunctionNode( shaderNode ) );\n\n\t\t\t\tfunctionNodesCacheMap.set( shaderNode, functionNode );\n\n\t\t\t}\n\n\t\t\tif ( builder.currentFunctionNode !== null ) {\n\n\t\t\t\tbuilder.currentFunctionNode.includes.push( functionNode );\n\n\t\t\t}\n\n\t\t\tresult = nodeObject( functionNode.call( inputNodes ) );\n\n\t\t} else {\n\n\t\t\tconst jsFunc = shaderNode.jsFunc;\n\t\t\tconst outputNode = inputNodes !== null ? jsFunc( inputNodes, builder ) : jsFunc( builder );\n\n\t\t\tresult = nodeObject( outputNode );\n\n\t\t}\n\n\t\tif ( shaderNode.once ) {\n\n\t\t\tproperties.onceOutput = result;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tgetOutputNode( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tif ( properties.outputNode === null ) {\n\n\t\t\tproperties.outputNode = this.setupOutput( builder );\n\n\t\t}\n\n\t\treturn properties.outputNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\treturn this.getOutputNode( builder );\n\n\t}\n\n\tsetupOutput( builder ) {\n\n\t\tbuilder.addStack();\n\n\t\tbuilder.stack.outputNode = this.call( builder );\n\n\t\treturn builder.removeStack();\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst outputNode = this.getOutputNode( builder );\n\n\t\treturn outputNode.build( builder, output );\n\n\t}\n\n}\n\nclass ShaderNodeInternal extends Node {\n\n\tconstructor( jsFunc, nodeType ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.jsFunc = jsFunc;\n\t\tthis.layout = null;\n\n\t\tthis.global = true;\n\n\t\tthis.once = false;\n\n\t}\n\n\tsetLayout( layout ) {\n\n\t\tthis.layout = layout;\n\n\t\treturn this;\n\n\t}\n\n\tcall( inputs = null ) {\n\n\t\tnodeObjects( inputs );\n\n\t\treturn nodeObject( new ShaderCallNodeInternal( this, inputs ) );\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.call();\n\n\t}\n\n}\n\nconst bools = [ false, true ];\nconst uints = [ 0, 1, 2, 3 ];\nconst ints = [ - 1, - 2 ];\nconst floats = [ 0.5, 1.5, 1 / 3, 1e-6, 1e6, Math.PI, Math.PI * 2, 1 / Math.PI, 2 / Math.PI, 1 / ( Math.PI * 2 ), Math.PI / 2 ];\n\nconst boolsCacheMap = new Map();\nfor ( const bool of bools ) boolsCacheMap.set( bool, new ConstNode( bool ) );\n\nconst uintsCacheMap = new Map();\nfor ( const uint of uints ) uintsCacheMap.set( uint, new ConstNode( uint, 'uint' ) );\n\nconst intsCacheMap = new Map( [ ...uintsCacheMap ].map( el => new ConstNode( el.value, 'int' ) ) );\nfor ( const int of ints ) intsCacheMap.set( int, new ConstNode( int, 'int' ) );\n\nconst floatsCacheMap = new Map( [ ...intsCacheMap ].map( el => new ConstNode( el.value ) ) );\nfor ( const float of floats ) floatsCacheMap.set( float, new ConstNode( float ) );\nfor ( const float of floats ) floatsCacheMap.set( - float, new ConstNode( - float ) );\n\nconst cacheMaps = { bool: boolsCacheMap, uint: uintsCacheMap, ints: intsCacheMap, float: floatsCacheMap };\n\nconst constNodesCacheMap = new Map( [ ...boolsCacheMap, ...floatsCacheMap ] );\n\nconst getConstNode = ( value, type ) => {\n\n\tif ( constNodesCacheMap.has( value ) ) {\n\n\t\treturn constNodesCacheMap.get( value );\n\n\t} else if ( value.isNode === true ) {\n\n\t\treturn value;\n\n\t} else {\n\n\t\treturn new ConstNode( value, type );\n\n\t}\n\n};\n\nconst safeGetNodeType = ( node ) => {\n\n\ttry {\n\n\t\treturn node.getNodeType();\n\n\t} catch ( _ ) {\n\n\t\treturn undefined;\n\n\t}\n\n};\n\nconst ConvertType = function ( type, cacheMap = null ) {\n\n\treturn ( ...params ) => {\n\n\t\tif ( params.length === 0 || ( ! [ 'bool', 'float', 'int', 'uint' ].includes( type ) && params.every( param => typeof param !== 'object' ) ) ) {\n\n\t\t\tparams = [ getValueFromType( type, ...params ) ];\n\n\t\t}\n\n\t\tif ( params.length === 1 && cacheMap !== null && cacheMap.has( params[ 0 ] ) ) {\n\n\t\t\treturn nodeObject( cacheMap.get( params[ 0 ] ) );\n\n\t\t}\n\n\t\tif ( params.length === 1 ) {\n\n\t\t\tconst node = getConstNode( params[ 0 ], type );\n\t\t\tif ( safeGetNodeType( node ) === type ) return nodeObject( node );\n\t\t\treturn nodeObject( new ConvertNode( node, type ) );\n\n\t\t}\n\n\t\tconst nodes = params.map( param => getConstNode( param ) );\n\t\treturn nodeObject( new JoinNode( nodes, type ) );\n\n\t};\n\n};\n\n// exports\n\nconst defined = ( v ) => typeof v === 'object' && v !== null ? v.value : v; // TODO: remove boolean conversion and defined function\n\n// utils\n\nconst getConstNodeType = ( value ) => ( value !== undefined && value !== null ) ? ( value.nodeType || value.convertTo || ( typeof value === 'string' ? value : null ) ) : null;\n\n// shader node base\n\nfunction ShaderNode( jsFunc, nodeType ) {\n\n\treturn new Proxy( new ShaderNodeInternal( jsFunc, nodeType ), shaderNodeHandler );\n\n}\n\nconst nodeObject = ( val, altType = null ) => /* new */ ShaderNodeObject( val, altType );\nconst nodeObjects = ( val, altType = null ) => new ShaderNodeObjects( val, altType );\nconst nodeArray = ( val, altType = null ) => new ShaderNodeArray( val, altType );\nconst nodeProxy = ( ...params ) => new ShaderNodeProxy( ...params );\nconst nodeImmutable = ( ...params ) => new ShaderNodeImmutable( ...params );\n\nconst Fn = ( jsFunc, nodeType ) => {\n\n\tconst shaderNode = new ShaderNode( jsFunc, nodeType );\n\n\tconst fn = ( ...params ) => {\n\n\t\tlet inputs;\n\n\t\tnodeObjects( params );\n\n\t\tif ( params[ 0 ] && params[ 0 ].isNode ) {\n\n\t\t\tinputs = [ ...params ];\n\n\t\t} else {\n\n\t\t\tinputs = params[ 0 ];\n\n\t\t}\n\n\t\treturn shaderNode.call( inputs );\n\n\t};\n\n\tfn.shaderNode = shaderNode;\n\n\tfn.setLayout = ( layout ) => {\n\n\t\tshaderNode.setLayout( layout );\n\n\t\treturn fn;\n\n\t};\n\n\tfn.once = () => {\n\n\t\tshaderNode.once = true;\n\n\t\treturn fn;\n\n\t};\n\n\treturn fn;\n\n};\n\nconst tslFn = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ShaderNode: tslFn() has been renamed to Fn().' );\n\treturn Fn( ...params );\n\n};\n\n//\n\naddMethodChaining( 'toGlobal', ( node ) => {\n\n\tnode.global = true;\n\n\treturn node;\n\n} );\n\n//\n\nconst setCurrentStack = ( stack ) => {\n\n\tcurrentStack = stack;\n\n};\n\nconst getCurrentStack = () => currentStack;\n\nconst If = ( ...params ) => currentStack.If( ...params );\n\nfunction append( node ) {\n\n\tif ( currentStack ) currentStack.add( node );\n\n\treturn node;\n\n}\n\naddMethodChaining( 'append', append );\n\n// types\n\nconst color = new ConvertType( 'color' );\n\nconst float = new ConvertType( 'float', cacheMaps.float );\nconst int = new ConvertType( 'int', cacheMaps.ints );\nconst uint = new ConvertType( 'uint', cacheMaps.uint );\nconst bool = new ConvertType( 'bool', cacheMaps.bool );\n\nconst vec2 = new ConvertType( 'vec2' );\nconst ivec2 = new ConvertType( 'ivec2' );\nconst uvec2 = new ConvertType( 'uvec2' );\nconst bvec2 = new ConvertType( 'bvec2' );\n\nconst vec3 = new ConvertType( 'vec3' );\nconst ivec3 = new ConvertType( 'ivec3' );\nconst uvec3 = new ConvertType( 'uvec3' );\nconst bvec3 = new ConvertType( 'bvec3' );\n\nconst vec4 = new ConvertType( 'vec4' );\nconst ivec4 = new ConvertType( 'ivec4' );\nconst uvec4 = new ConvertType( 'uvec4' );\nconst bvec4 = new ConvertType( 'bvec4' );\n\nconst mat2 = new ConvertType( 'mat2' );\nconst mat3 = new ConvertType( 'mat3' );\nconst mat4 = new ConvertType( 'mat4' );\n\nconst string = ( value = '' ) => nodeObject( new ConstNode( value, 'string' ) );\nconst arrayBuffer = ( value ) => nodeObject( new ConstNode( value, 'ArrayBuffer' ) );\n\naddMethodChaining( 'toColor', color );\naddMethodChaining( 'toFloat', float );\naddMethodChaining( 'toInt', int );\naddMethodChaining( 'toUint', uint );\naddMethodChaining( 'toBool', bool );\naddMethodChaining( 'toVec2', vec2 );\naddMethodChaining( 'toIVec2', ivec2 );\naddMethodChaining( 'toUVec2', uvec2 );\naddMethodChaining( 'toBVec2', bvec2 );\naddMethodChaining( 'toVec3', vec3 );\naddMethodChaining( 'toIVec3', ivec3 );\naddMethodChaining( 'toUVec3', uvec3 );\naddMethodChaining( 'toBVec3', bvec3 );\naddMethodChaining( 'toVec4', vec4 );\naddMethodChaining( 'toIVec4', ivec4 );\naddMethodChaining( 'toUVec4', uvec4 );\naddMethodChaining( 'toBVec4', bvec4 );\naddMethodChaining( 'toMat2', mat2 );\naddMethodChaining( 'toMat3', mat3 );\naddMethodChaining( 'toMat4', mat4 );\n\n// basic nodes\n\nconst element = /*@__PURE__*/ nodeProxy( ArrayElementNode );\nconst convert = ( node, types ) => nodeObject( new ConvertNode( nodeObject( node ), types ) );\nconst split = ( node, channels ) => nodeObject( new SplitNode( nodeObject( node ), channels ) );\n\naddMethodChaining( 'element', element );\naddMethodChaining( 'convert', convert );\n\nclass UniformGroupNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'UniformGroupNode';\n\n\t}\n\n\tconstructor( name, shared = false, order = 1 ) {\n\n\t\tsuper( 'string' );\n\n\t\tthis.name = name;\n\t\tthis.version = 0;\n\n\t\tthis.shared = shared;\n\t\tthis.order = order;\n\t\tthis.isUniformGroup = true;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.name = this.name;\n\t\tdata.version = this.version;\n\t\tdata.shared = this.shared;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.name = data.name;\n\t\tthis.version = data.version;\n\t\tthis.shared = data.shared;\n\n\t}\n\n}\n\nconst uniformGroup = ( name ) => new UniformGroupNode( name );\nconst sharedUniformGroup = ( name, order = 0 ) => new UniformGroupNode( name, true, order );\n\nconst frameGroup = /*@__PURE__*/ sharedUniformGroup( 'frame' );\nconst renderGroup = /*@__PURE__*/ sharedUniformGroup( 'render' );\nconst objectGroup = /*@__PURE__*/ uniformGroup( 'object' );\n\nclass UniformNode extends InputNode {\n\n\tstatic get type() {\n\n\t\treturn 'UniformNode';\n\n\t}\n\n\tconstructor( value, nodeType = null ) {\n\n\t\tsuper( value, nodeType );\n\n\t\tthis.isUniformNode = true;\n\n\t\tthis.name = '';\n\t\tthis.groupNode = objectGroup;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.groupNode = group;\n\n\t\treturn this;\n\n\t}\n\n\tgetGroup() {\n\n\t\treturn this.groupNode;\n\n\t}\n\n\tgetUniformHash( builder ) {\n\n\t\treturn this.getHash( builder );\n\n\t}\n\n\tonUpdate( callback, updateType ) {\n\n\t\tconst self = this.getSelf();\n\n\t\tcallback = callback.bind( self );\n\n\t\treturn super.onUpdate( ( frame ) => {\n\n\t\t\tconst value = callback( frame, self );\n\n\t\t\tif ( value !== undefined ) {\n\n\t\t\t\tthis.value = value;\n\n\t\t\t}\n\n\t \t}, updateType );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst hash = this.getUniformHash( builder );\n\n\t\tlet sharedNode = builder.getNodeFromHash( hash );\n\n\t\tif ( sharedNode === undefined ) {\n\n\t\t\tbuilder.setHashNode( this, hash );\n\n\t\t\tsharedNode = this;\n\n\t\t}\n\n\t\tconst sharedNodeType = sharedNode.getInputType( builder );\n\n\t\tconst nodeUniform = builder.getUniformFromNode( sharedNode, sharedNodeType, builder.shaderStage, this.name || builder.context.label );\n\t\tconst propertyName = builder.getPropertyName( nodeUniform );\n\n\t\tif ( builder.context.label !== undefined ) delete builder.context.label;\n\n\t\treturn builder.format( propertyName, type, output );\n\n\t}\n\n}\n\nconst uniform = ( arg1, arg2 ) => {\n\n\tconst nodeType = getConstNodeType( arg2 || arg1 );\n\n\t// @TODO: get ConstNode from .traverse() in the future\n\tconst value = ( arg1 && arg1.isNode === true ) ? ( arg1.node && arg1.node.value ) || arg1.value : arg1;\n\n\treturn nodeObject( new UniformNode( value, nodeType ) );\n\n};\n\nclass PropertyNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'PropertyNode';\n\n\t}\n\n\tconstructor( nodeType, name = null, varying = false ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.name = name;\n\t\tthis.varying = varying;\n\n\t\tthis.isPropertyNode = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tisGlobal( /*builder*/ ) {\n\n\t\treturn true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tlet nodeVar;\n\n\t\tif ( this.varying === true ) {\n\n\t\t\tnodeVar = builder.getVaryingFromNode( this, this.name );\n\t\t\tnodeVar.needsInterpolation = true;\n\n\t\t} else {\n\n\t\t\tnodeVar = builder.getVarFromNode( this, this.name );\n\n\t\t}\n\n\t\treturn builder.getPropertyName( nodeVar );\n\n\t}\n\n}\n\nconst property = ( type, name ) => nodeObject( new PropertyNode( type, name ) );\nconst varyingProperty = ( type, name ) => nodeObject( new PropertyNode( type, name, true ) );\n\nconst diffuseColor = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec4', 'DiffuseColor' );\nconst emissive = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'EmissiveColor' );\nconst roughness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Roughness' );\nconst metalness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Metalness' );\nconst clearcoat = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Clearcoat' );\nconst clearcoatRoughness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'ClearcoatRoughness' );\nconst sheen = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'Sheen' );\nconst sheenRoughness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'SheenRoughness' );\nconst iridescence = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Iridescence' );\nconst iridescenceIOR = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'IridescenceIOR' );\nconst iridescenceThickness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'IridescenceThickness' );\nconst alphaT = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'AlphaT' );\nconst anisotropy = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Anisotropy' );\nconst anisotropyT = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'AnisotropyT' );\nconst anisotropyB = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec3', 'AnisotropyB' );\nconst specularColor = /*@__PURE__*/ nodeImmutable( PropertyNode, 'color', 'SpecularColor' );\nconst specularF90 = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'SpecularF90' );\nconst shininess = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Shininess' );\nconst output = /*@__PURE__*/ nodeImmutable( PropertyNode, 'vec4', 'Output' );\nconst dashSize = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'dashSize' );\nconst gapSize = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'gapSize' );\nconst pointWidth = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'pointWidth' );\nconst ior = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'IOR' );\nconst transmission = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Transmission' );\nconst thickness = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Thickness' );\nconst attenuationDistance = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'AttenuationDistance' );\nconst attenuationColor = /*@__PURE__*/ nodeImmutable( PropertyNode, 'color', 'AttenuationColor' );\nconst dispersion = /*@__PURE__*/ nodeImmutable( PropertyNode, 'float', 'Dispersion' );\n\nclass AssignNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'AssignNode';\n\n\t}\n\n\tconstructor( targetNode, sourceNode ) {\n\n\t\tsuper();\n\n\t\tthis.targetNode = targetNode;\n\t\tthis.sourceNode = sourceNode;\n\n\t}\n\n\thasDependencies() {\n\n\t\treturn false;\n\n\t}\n\n\tgetNodeType( builder, output ) {\n\n\t\treturn output !== 'void' ? this.targetNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tneedsSplitAssign( builder ) {\n\n\t\tconst { targetNode } = this;\n\n\t\tif ( builder.isAvailable( 'swizzleAssign' ) === false && targetNode.isSplitNode && targetNode.components.length > 1 ) {\n\n\t\t\tconst targetLength = builder.getTypeLength( targetNode.node.getNodeType( builder ) );\n\t\t\tconst assignDiferentVector = vectorComponents.join( '' ).slice( 0, targetLength ) !== targetNode.components;\n\n\t\t\treturn assignDiferentVector;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst { targetNode, sourceNode } = this;\n\n\t\tconst needsSplitAssign = this.needsSplitAssign( builder );\n\n\t\tconst targetType = targetNode.getNodeType( builder );\n\n\t\tconst target = targetNode.context( { assign: true } ).build( builder );\n\t\tconst source = sourceNode.build( builder, targetType );\n\n\t\tconst sourceType = sourceNode.getNodeType( builder );\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t//\n\n\t\tlet snippet;\n\n\t\tif ( nodeData.initialized === true ) {\n\n\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\tsnippet = target;\n\n\t\t\t}\n\n\t\t} else if ( needsSplitAssign ) {\n\n\t\t\tconst sourceVar = builder.getVarFromNode( this, null, targetType );\n\t\t\tconst sourceProperty = builder.getPropertyName( sourceVar );\n\n\t\t\tbuilder.addLineFlowCode( `${ sourceProperty } = ${ source }`, this );\n\n\t\t\tconst targetRoot = targetNode.node.context( { assign: true } ).build( builder );\n\n\t\t\tfor ( let i = 0; i < targetNode.components.length; i ++ ) {\n\n\t\t\t\tconst component = targetNode.components[ i ];\n\n\t\t\t\tbuilder.addLineFlowCode( `${ targetRoot }.${ component } = ${ sourceProperty }[ ${ i } ]`, this );\n\n\t\t\t}\n\n\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\tsnippet = target;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsnippet = `${ target } = ${ source }`;\n\n\t\t\tif ( output === 'void' || sourceType === 'void' ) {\n\n\t\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t\t\tif ( output !== 'void' ) {\n\n\t\t\t\t\tsnippet = target;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tnodeData.initialized = true;\n\n\t\treturn builder.format( snippet, targetType, output );\n\n\t}\n\n}\n\nconst assign = /*@__PURE__*/ nodeProxy( AssignNode );\n\naddMethodChaining( 'assign', assign );\n\nclass FunctionCallNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'FunctionCallNode';\n\n\t}\n\n\tconstructor( functionNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.functionNode = functionNode;\n\t\tthis.parameters = parameters;\n\n\t}\n\n\tsetParameters( parameters ) {\n\n\t\tthis.parameters = parameters;\n\n\t\treturn this;\n\n\t}\n\n\tgetParameters() {\n\n\t\treturn this.parameters;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.functionNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst params = [];\n\n\t\tconst functionNode = this.functionNode;\n\n\t\tconst inputs = functionNode.getInputs( builder );\n\t\tconst parameters = this.parameters;\n\n\t\tconst generateInput = ( node, inputNode ) => {\n\n\t\t\tconst type = inputNode.type;\n\t\t\tconst pointer = type === 'pointer';\n\n\t\t\tlet output;\n\n\t\t\tif ( pointer ) output = '&' + node.build( builder );\n\t\t\telse output = node.build( builder, type );\n\n\t\t\treturn output;\n\n\t\t};\n\n\t\tif ( Array.isArray( parameters ) ) {\n\n\t\t\tfor ( let i = 0; i < parameters.length; i ++ ) {\n\n\t\t\t\tparams.push( generateInput( parameters[ i ], inputs[ i ] ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( const inputNode of inputs ) {\n\n\t\t\t\tconst node = parameters[ inputNode.name ];\n\n\t\t\t\tif ( node !== undefined ) {\n\n\t\t\t\t\tparams.push( generateInput( node, inputNode ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( `FunctionCallNode: Input '${inputNode.name}' not found in FunctionNode.` );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst functionName = functionNode.build( builder, 'property' );\n\n\t\treturn `${functionName}( ${params.join( ', ' )} )`;\n\n\t}\n\n}\n\nconst call = ( func, ...params ) => {\n\n\tparams = params.length > 1 || ( params[ 0 ] && params[ 0 ].isNode === true ) ? nodeArray( params ) : nodeObjects( params[ 0 ] );\n\n\treturn nodeObject( new FunctionCallNode( nodeObject( func ), params ) );\n\n};\n\naddMethodChaining( 'call', call );\n\nclass OperatorNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'OperatorNode';\n\n\t}\n\n\tconstructor( op, aNode, bNode, ...params ) {\n\n\t\tsuper();\n\n\t\tif ( params.length > 0 ) {\n\n\t\t\tlet finalOp = new OperatorNode( op, aNode, bNode );\n\n\t\t\tfor ( let i = 0; i < params.length - 1; i ++ ) {\n\n\t\t\t\tfinalOp = new OperatorNode( op, finalOp, params[ i ] );\n\n\t\t\t}\n\n\t\t\taNode = finalOp;\n\t\t\tbNode = params[ params.length - 1 ];\n\n\t\t}\n\n\t\tthis.op = op;\n\t\tthis.aNode = aNode;\n\t\tthis.bNode = bNode;\n\n\t}\n\n\tgetNodeType( builder, output ) {\n\n\t\tconst op = this.op;\n\n\t\tconst aNode = this.aNode;\n\t\tconst bNode = this.bNode;\n\n\t\tconst typeA = aNode.getNodeType( builder );\n\t\tconst typeB = typeof bNode !== 'undefined' ? bNode.getNodeType( builder ) : null;\n\n\t\tif ( typeA === 'void' || typeB === 'void' ) {\n\n\t\t\treturn 'void';\n\n\t\t} else if ( op === '%' ) {\n\n\t\t\treturn typeA;\n\n\t\t} else if ( op === '~' || op === '&' || op === '|' || op === '^' || op === '>>' || op === '<<' ) {\n\n\t\t\treturn builder.getIntegerType( typeA );\n\n\t\t} else if ( op === '!' || op === '==' || op === '&&' || op === '||' || op === '^^' ) {\n\n\t\t\treturn 'bool';\n\n\t\t} else if ( op === '<' || op === '>' || op === '<=' || op === '>=' ) {\n\n\t\t\tconst typeLength = output ? builder.getTypeLength( output ) : Math.max( builder.getTypeLength( typeA ), builder.getTypeLength( typeB ) );\n\n\t\t\treturn typeLength > 1 ? `bvec${ typeLength }` : 'bool';\n\n\t\t} else {\n\n\t\t\tif ( typeA === 'float' && builder.isMatrix( typeB ) ) {\n\n\t\t\t\treturn typeB;\n\n\t\t\t} else if ( builder.isMatrix( typeA ) && builder.isVector( typeB ) ) {\n\n\t\t\t\t// matrix x vector\n\n\t\t\t\treturn builder.getVectorFromMatrix( typeA );\n\n\t\t\t} else if ( builder.isVector( typeA ) && builder.isMatrix( typeB ) ) {\n\n\t\t\t\t// vector x matrix\n\n\t\t\t\treturn builder.getVectorFromMatrix( typeB );\n\n\t\t\t} else if ( builder.getTypeLength( typeB ) > builder.getTypeLength( typeA ) ) {\n\n\t\t\t\t// anytype x anytype: use the greater length vector\n\n\t\t\t\treturn typeB;\n\n\t\t\t}\n\n\t\t\treturn typeA;\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst op = this.op;\n\n\t\tconst aNode = this.aNode;\n\t\tconst bNode = this.bNode;\n\n\t\tconst type = this.getNodeType( builder, output );\n\n\t\tlet typeA = null;\n\t\tlet typeB = null;\n\n\t\tif ( type !== 'void' ) {\n\n\t\t\ttypeA = aNode.getNodeType( builder );\n\t\t\ttypeB = typeof bNode !== 'undefined' ? bNode.getNodeType( builder ) : null;\n\n\t\t\tif ( op === '<' || op === '>' || op === '<=' || op === '>=' || op === '==' ) {\n\n\t\t\t\tif ( builder.isVector( typeA ) ) {\n\n\t\t\t\t\ttypeB = typeA;\n\n\t\t\t\t} else if ( typeA !== typeB ) {\n\n\t\t\t\t\ttypeA = typeB = 'float';\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>>' || op === '<<' ) {\n\n\t\t\t\ttypeA = type;\n\t\t\t\ttypeB = builder.changeComponentType( typeB, 'uint' );\n\n\t\t\t} else if ( builder.isMatrix( typeA ) && builder.isVector( typeB ) ) {\n\n\t\t\t\t// matrix x vector\n\n\t\t\t\ttypeB = builder.getVectorFromMatrix( typeA );\n\n\t\t\t} else if ( builder.isVector( typeA ) && builder.isMatrix( typeB ) ) {\n\n\t\t\t\t// vector x matrix\n\n\t\t\t\ttypeA = builder.getVectorFromMatrix( typeB );\n\n\t\t\t} else {\n\n\t\t\t\t// anytype x anytype\n\n\t\t\t\ttypeA = typeB = type;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\ttypeA = typeB = type;\n\n\t\t}\n\n\t\tconst a = aNode.build( builder, typeA );\n\t\tconst b = typeof bNode !== 'undefined' ? bNode.build( builder, typeB ) : null;\n\n\t\tconst outputLength = builder.getTypeLength( output );\n\t\tconst fnOpSnippet = builder.getFunctionOperator( op );\n\n\t\tif ( output !== 'void' ) {\n\n\t\t\tif ( op === '<' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'lessThan', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } < ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '<=' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'lessThanEqual', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } <= ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'greaterThan', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } > ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '>=' && outputLength > 1 ) {\n\n\t\t\t\tif ( builder.useComparisonMethod ) {\n\n\t\t\t\t\treturn builder.format( `${ builder.getMethod( 'greaterThanEqual', output ) }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn builder.format( `( ${ a } >= ${ b } )`, type, output );\n\n\t\t\t\t}\n\n\t\t\t} else if ( op === '!' || op === '~' ) {\n\n\t\t\t\treturn builder.format( `(${op}${a})`, typeA, output );\n\n\t\t\t} else if ( fnOpSnippet ) {\n\n\t\t\t\treturn builder.format( `${ fnOpSnippet }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.format( `( ${ a } ${ op } ${ b } )`, type, output );\n\n\t\t\t}\n\n\t\t} else if ( typeA !== 'void' ) {\n\n\t\t\tif ( fnOpSnippet ) {\n\n\t\t\t\treturn builder.format( `${ fnOpSnippet }( ${ a }, ${ b } )`, type, output );\n\n\t\t\t} else {\n\n\t\t\t\treturn builder.format( `${ a } ${ op } ${ b }`, type, output );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.op = this.op;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.op = data.op;\n\n\t}\n\n}\n\nconst add = /*@__PURE__*/ nodeProxy( OperatorNode, '+' );\nconst sub = /*@__PURE__*/ nodeProxy( OperatorNode, '-' );\nconst mul = /*@__PURE__*/ nodeProxy( OperatorNode, '*' );\nconst div = /*@__PURE__*/ nodeProxy( OperatorNode, '/' );\nconst modInt = /*@__PURE__*/ nodeProxy( OperatorNode, '%' );\nconst equal = /*@__PURE__*/ nodeProxy( OperatorNode, '==' );\nconst notEqual = /*@__PURE__*/ nodeProxy( OperatorNode, '!=' );\nconst lessThan = /*@__PURE__*/ nodeProxy( OperatorNode, '<' );\nconst greaterThan = /*@__PURE__*/ nodeProxy( OperatorNode, '>' );\nconst lessThanEqual = /*@__PURE__*/ nodeProxy( OperatorNode, '<=' );\nconst greaterThanEqual = /*@__PURE__*/ nodeProxy( OperatorNode, '>=' );\nconst and = /*@__PURE__*/ nodeProxy( OperatorNode, '&&' );\nconst or = /*@__PURE__*/ nodeProxy( OperatorNode, '||' );\nconst not = /*@__PURE__*/ nodeProxy( OperatorNode, '!' );\nconst xor = /*@__PURE__*/ nodeProxy( OperatorNode, '^^' );\nconst bitAnd = /*@__PURE__*/ nodeProxy( OperatorNode, '&' );\nconst bitNot = /*@__PURE__*/ nodeProxy( OperatorNode, '~' );\nconst bitOr = /*@__PURE__*/ nodeProxy( OperatorNode, '|' );\nconst bitXor = /*@__PURE__*/ nodeProxy( OperatorNode, '^' );\nconst shiftLeft = /*@__PURE__*/ nodeProxy( OperatorNode, '<<' );\nconst shiftRight = /*@__PURE__*/ nodeProxy( OperatorNode, '>>' );\n\naddMethodChaining( 'add', add );\naddMethodChaining( 'sub', sub );\naddMethodChaining( 'mul', mul );\naddMethodChaining( 'div', div );\naddMethodChaining( 'modInt', modInt );\naddMethodChaining( 'equal', equal );\naddMethodChaining( 'notEqual', notEqual );\naddMethodChaining( 'lessThan', lessThan );\naddMethodChaining( 'greaterThan', greaterThan );\naddMethodChaining( 'lessThanEqual', lessThanEqual );\naddMethodChaining( 'greaterThanEqual', greaterThanEqual );\naddMethodChaining( 'and', and );\naddMethodChaining( 'or', or );\naddMethodChaining( 'not', not );\naddMethodChaining( 'xor', xor );\naddMethodChaining( 'bitAnd', bitAnd );\naddMethodChaining( 'bitNot', bitNot );\naddMethodChaining( 'bitOr', bitOr );\naddMethodChaining( 'bitXor', bitXor );\naddMethodChaining( 'shiftLeft', shiftLeft );\naddMethodChaining( 'shiftRight', shiftRight );\n\n\nconst remainder = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.OperatorNode: .remainder() has been renamed to .modInt().' );\n\treturn modInt( ...params );\n\n};\n\naddMethodChaining( 'remainder', remainder );\n\nclass MathNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'MathNode';\n\n\t}\n\n\tconstructor( method, aNode, bNode = null, cNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.method = method;\n\n\t\tthis.aNode = aNode;\n\t\tthis.bNode = bNode;\n\t\tthis.cNode = cNode;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\tconst aType = this.aNode.getNodeType( builder );\n\t\tconst bType = this.bNode ? this.bNode.getNodeType( builder ) : null;\n\t\tconst cType = this.cNode ? this.cNode.getNodeType( builder ) : null;\n\n\t\tconst aLen = builder.isMatrix( aType ) ? 0 : builder.getTypeLength( aType );\n\t\tconst bLen = builder.isMatrix( bType ) ? 0 : builder.getTypeLength( bType );\n\t\tconst cLen = builder.isMatrix( cType ) ? 0 : builder.getTypeLength( cType );\n\n\t\tif ( aLen > bLen && aLen > cLen ) {\n\n\t\t\treturn aType;\n\n\t\t} else if ( bLen > cLen ) {\n\n\t\t\treturn bType;\n\n\t\t} else if ( cLen > aLen ) {\n\n\t\t\treturn cType;\n\n\t\t}\n\n\t\treturn aType;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst method = this.method;\n\n\t\tif ( method === MathNode.LENGTH || method === MathNode.DISTANCE || method === MathNode.DOT ) {\n\n\t\t\treturn 'float';\n\n\t\t} else if ( method === MathNode.CROSS ) {\n\n\t\t\treturn 'vec3';\n\n\t\t} else if ( method === MathNode.ALL ) {\n\n\t\t\treturn 'bool';\n\n\t\t} else if ( method === MathNode.EQUALS ) {\n\n\t\t\treturn builder.changeComponentType( this.aNode.getNodeType( builder ), 'bool' );\n\n\t\t} else if ( method === MathNode.MOD ) {\n\n\t\t\treturn this.aNode.getNodeType( builder );\n\n\t\t} else {\n\n\t\t\treturn this.getInputType( builder );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst method = this.method;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst inputType = this.getInputType( builder );\n\n\t\tconst a = this.aNode;\n\t\tconst b = this.bNode;\n\t\tconst c = this.cNode;\n\n\t\tconst isWebGL = builder.renderer.isWebGLRenderer === true;\n\n\t\tif ( method === MathNode.TRANSFORM_DIRECTION ) {\n\n\t\t\t// dir can be either a direction vector or a normal vector\n\t\t\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\t\t\tlet tA = a;\n\t\t\tlet tB = b;\n\n\t\t\tif ( builder.isMatrix( tA.getNodeType( builder ) ) ) {\n\n\t\t\t\ttB = vec4( vec3( tB ), 0.0 );\n\n\t\t\t} else {\n\n\t\t\t\ttA = vec4( vec3( tA ), 0.0 );\n\n\t\t\t}\n\n\t\t\tconst mulNode = mul( tA, tB ).xyz;\n\n\t\t\treturn normalize( mulNode ).build( builder, output );\n\n\t\t} else if ( method === MathNode.NEGATE ) {\n\n\t\t\treturn builder.format( '( - ' + a.build( builder, inputType ) + ' )', type, output );\n\n\t\t} else if ( method === MathNode.ONE_MINUS ) {\n\n\t\t\treturn sub( 1.0, a ).build( builder, output );\n\n\t\t} else if ( method === MathNode.RECIPROCAL ) {\n\n\t\t\treturn div( 1.0, a ).build( builder, output );\n\n\t\t} else if ( method === MathNode.DIFFERENCE ) {\n\n\t\t\treturn abs( sub( a, b ) ).build( builder, output );\n\n\t\t} else {\n\n\t\t\tconst params = [];\n\n\t\t\tif ( method === MathNode.CROSS || method === MathNode.MOD ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, type ),\n\t\t\t\t\tb.build( builder, type )\n\t\t\t\t);\n\n\t\t\t} else if ( isWebGL && method === MathNode.STEP ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, builder.getTypeLength( a.getNodeType( builder ) ) === 1 ? 'float' : inputType ),\n\t\t\t\t\tb.build( builder, inputType )\n\t\t\t\t);\n\n\t\t\t} else if ( ( isWebGL && ( method === MathNode.MIN || method === MathNode.MAX ) ) || method === MathNode.MOD ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, builder.getTypeLength( b.getNodeType( builder ) ) === 1 ? 'float' : inputType )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.REFRACT ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, inputType ),\n\t\t\t\t\tc.build( builder, 'float' )\n\t\t\t\t);\n\n\t\t\t} else if ( method === MathNode.MIX ) {\n\n\t\t\t\tparams.push(\n\t\t\t\t\ta.build( builder, inputType ),\n\t\t\t\t\tb.build( builder, inputType ),\n\t\t\t\t\tc.build( builder, builder.getTypeLength( c.getNodeType( builder ) ) === 1 ? 'float' : inputType )\n\t\t\t\t);\n\n\t\t\t} else {\n\n\t\t\t\tparams.push( a.build( builder, inputType ) );\n\t\t\t\tif ( b !== null ) params.push( b.build( builder, inputType ) );\n\t\t\t\tif ( c !== null ) params.push( c.build( builder, inputType ) );\n\n\t\t\t}\n\n\t\t\treturn builder.format( `${ builder.getMethod( method, type ) }( ${params.join( ', ' )} )`, type, output );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.method = this.method;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.method = data.method;\n\n\t}\n\n}\n\n// 1 input\n\nMathNode.ALL = 'all';\nMathNode.ANY = 'any';\nMathNode.EQUALS = 'equals';\n\nMathNode.RADIANS = 'radians';\nMathNode.DEGREES = 'degrees';\nMathNode.EXP = 'exp';\nMathNode.EXP2 = 'exp2';\nMathNode.LOG = 'log';\nMathNode.LOG2 = 'log2';\nMathNode.SQRT = 'sqrt';\nMathNode.INVERSE_SQRT = 'inversesqrt';\nMathNode.FLOOR = 'floor';\nMathNode.CEIL = 'ceil';\nMathNode.NORMALIZE = 'normalize';\nMathNode.FRACT = 'fract';\nMathNode.SIN = 'sin';\nMathNode.COS = 'cos';\nMathNode.TAN = 'tan';\nMathNode.ASIN = 'asin';\nMathNode.ACOS = 'acos';\nMathNode.ATAN = 'atan';\nMathNode.ABS = 'abs';\nMathNode.SIGN = 'sign';\nMathNode.LENGTH = 'length';\nMathNode.NEGATE = 'negate';\nMathNode.ONE_MINUS = 'oneMinus';\nMathNode.DFDX = 'dFdx';\nMathNode.DFDY = 'dFdy';\nMathNode.ROUND = 'round';\nMathNode.RECIPROCAL = 'reciprocal';\nMathNode.TRUNC = 'trunc';\nMathNode.FWIDTH = 'fwidth';\nMathNode.BITCAST = 'bitcast';\nMathNode.TRANSPOSE = 'transpose';\n\n// 2 inputs\n\nMathNode.ATAN2 = 'atan2';\nMathNode.MIN = 'min';\nMathNode.MAX = 'max';\nMathNode.MOD = 'mod';\nMathNode.STEP = 'step';\nMathNode.REFLECT = 'reflect';\nMathNode.DISTANCE = 'distance';\nMathNode.DIFFERENCE = 'difference';\nMathNode.DOT = 'dot';\nMathNode.CROSS = 'cross';\nMathNode.POW = 'pow';\nMathNode.TRANSFORM_DIRECTION = 'transformDirection';\n\n// 3 inputs\n\nMathNode.MIX = 'mix';\nMathNode.CLAMP = 'clamp';\nMathNode.REFRACT = 'refract';\nMathNode.SMOOTHSTEP = 'smoothstep';\nMathNode.FACEFORWARD = 'faceforward';\n\nconst EPSILON = /*@__PURE__*/ float( 1e-6 );\nconst INFINITY = /*@__PURE__*/ float( 1e6 );\nconst PI = /*@__PURE__*/ float( Math.PI );\nconst PI2 = /*@__PURE__*/ float( Math.PI * 2 );\n\nconst all = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ALL );\nconst any = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ANY );\nconst equals = /*@__PURE__*/ nodeProxy( MathNode, MathNode.EQUALS );\n\nconst radians = /*@__PURE__*/ nodeProxy( MathNode, MathNode.RADIANS );\nconst degrees = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DEGREES );\nconst exp = /*@__PURE__*/ nodeProxy( MathNode, MathNode.EXP );\nconst exp2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.EXP2 );\nconst log = /*@__PURE__*/ nodeProxy( MathNode, MathNode.LOG );\nconst log2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.LOG2 );\nconst sqrt = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SQRT );\nconst inverseSqrt = /*@__PURE__*/ nodeProxy( MathNode, MathNode.INVERSE_SQRT );\nconst floor = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FLOOR );\nconst ceil = /*@__PURE__*/ nodeProxy( MathNode, MathNode.CEIL );\nconst normalize = /*@__PURE__*/ nodeProxy( MathNode, MathNode.NORMALIZE );\nconst fract = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FRACT );\nconst sin = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SIN );\nconst cos = /*@__PURE__*/ nodeProxy( MathNode, MathNode.COS );\nconst tan = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TAN );\nconst asin = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ASIN );\nconst acos = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ACOS );\nconst atan = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ATAN );\nconst abs = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ABS );\nconst sign = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SIGN );\nconst length = /*@__PURE__*/ nodeProxy( MathNode, MathNode.LENGTH );\nconst negate = /*@__PURE__*/ nodeProxy( MathNode, MathNode.NEGATE );\nconst oneMinus = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ONE_MINUS );\nconst dFdx = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DFDX );\nconst dFdy = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DFDY );\nconst round = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ROUND );\nconst reciprocal = /*@__PURE__*/ nodeProxy( MathNode, MathNode.RECIPROCAL );\nconst trunc = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TRUNC );\nconst fwidth = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FWIDTH );\nconst bitcast = /*@__PURE__*/ nodeProxy( MathNode, MathNode.BITCAST );\nconst transpose = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TRANSPOSE );\n\nconst atan2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.ATAN2 );\nconst min$1 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MIN );\nconst max$1 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MAX );\nconst mod = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MOD );\nconst step = /*@__PURE__*/ nodeProxy( MathNode, MathNode.STEP );\nconst reflect = /*@__PURE__*/ nodeProxy( MathNode, MathNode.REFLECT );\nconst distance = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DISTANCE );\nconst difference = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DIFFERENCE );\nconst dot = /*@__PURE__*/ nodeProxy( MathNode, MathNode.DOT );\nconst cross = /*@__PURE__*/ nodeProxy( MathNode, MathNode.CROSS );\nconst pow = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW );\nconst pow2 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW, 2 );\nconst pow3 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW, 3 );\nconst pow4 = /*@__PURE__*/ nodeProxy( MathNode, MathNode.POW, 4 );\nconst transformDirection = /*@__PURE__*/ nodeProxy( MathNode, MathNode.TRANSFORM_DIRECTION );\n\nconst cbrt = ( a ) => mul( sign( a ), pow( abs( a ), 1.0 / 3.0 ) );\nconst lengthSq = ( a ) => dot( a, a );\nconst mix = /*@__PURE__*/ nodeProxy( MathNode, MathNode.MIX );\nconst clamp = ( value, low = 0, high = 1 ) => nodeObject( new MathNode( MathNode.CLAMP, nodeObject( value ), nodeObject( low ), nodeObject( high ) ) );\nconst saturate = ( value ) => clamp( value );\nconst refract = /*@__PURE__*/ nodeProxy( MathNode, MathNode.REFRACT );\nconst smoothstep = /*@__PURE__*/ nodeProxy( MathNode, MathNode.SMOOTHSTEP );\nconst faceForward = /*@__PURE__*/ nodeProxy( MathNode, MathNode.FACEFORWARD );\n\nconst rand = /*@__PURE__*/ Fn( ( [ uv ] ) => {\n\n\tconst a = 12.9898, b = 78.233, c = 43758.5453;\n\tconst dt = dot( uv.xy, vec2( a, b ) ), sn = mod( dt, PI );\n\n\treturn fract( sin( sn ).mul( c ) );\n\n} );\n\nconst mixElement = ( t, e1, e2 ) => mix( e1, e2, t );\nconst smoothstepElement = ( x, low, high ) => smoothstep( low, high, x );\n\naddMethodChaining( 'all', all );\naddMethodChaining( 'any', any );\naddMethodChaining( 'equals', equals );\n\naddMethodChaining( 'radians', radians );\naddMethodChaining( 'degrees', degrees );\naddMethodChaining( 'exp', exp );\naddMethodChaining( 'exp2', exp2 );\naddMethodChaining( 'log', log );\naddMethodChaining( 'log2', log2 );\naddMethodChaining( 'sqrt', sqrt );\naddMethodChaining( 'inverseSqrt', inverseSqrt );\naddMethodChaining( 'floor', floor );\naddMethodChaining( 'ceil', ceil );\naddMethodChaining( 'normalize', normalize );\naddMethodChaining( 'fract', fract );\naddMethodChaining( 'sin', sin );\naddMethodChaining( 'cos', cos );\naddMethodChaining( 'tan', tan );\naddMethodChaining( 'asin', asin );\naddMethodChaining( 'acos', acos );\naddMethodChaining( 'atan', atan );\naddMethodChaining( 'abs', abs );\naddMethodChaining( 'sign', sign );\naddMethodChaining( 'length', length );\naddMethodChaining( 'lengthSq', lengthSq );\naddMethodChaining( 'negate', negate );\naddMethodChaining( 'oneMinus', oneMinus );\naddMethodChaining( 'dFdx', dFdx );\naddMethodChaining( 'dFdy', dFdy );\naddMethodChaining( 'round', round );\naddMethodChaining( 'reciprocal', reciprocal );\naddMethodChaining( 'trunc', trunc );\naddMethodChaining( 'fwidth', fwidth );\naddMethodChaining( 'atan2', atan2 );\naddMethodChaining( 'min', min$1 );\naddMethodChaining( 'max', max$1 );\naddMethodChaining( 'mod', mod );\naddMethodChaining( 'step', step );\naddMethodChaining( 'reflect', reflect );\naddMethodChaining( 'distance', distance );\naddMethodChaining( 'dot', dot );\naddMethodChaining( 'cross', cross );\naddMethodChaining( 'pow', pow );\naddMethodChaining( 'pow2', pow2 );\naddMethodChaining( 'pow3', pow3 );\naddMethodChaining( 'pow4', pow4 );\naddMethodChaining( 'transformDirection', transformDirection );\naddMethodChaining( 'mix', mixElement );\naddMethodChaining( 'clamp', clamp );\naddMethodChaining( 'refract', refract );\naddMethodChaining( 'smoothstep', smoothstepElement );\naddMethodChaining( 'faceForward', faceForward );\naddMethodChaining( 'difference', difference );\naddMethodChaining( 'saturate', saturate );\naddMethodChaining( 'cbrt', cbrt );\naddMethodChaining( 'transpose', transpose );\naddMethodChaining( 'rand', rand );\n\nclass ConditionalNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ConditionalNode';\n\n\t}\n\n\tconstructor( condNode, ifNode, elseNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.condNode = condNode;\n\n\t\tthis.ifNode = ifNode;\n\t\tthis.elseNode = elseNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst ifType = this.ifNode.getNodeType( builder );\n\n\t\tif ( this.elseNode !== null ) {\n\n\t\t\tconst elseType = this.elseNode.getNodeType( builder );\n\n\t\t\tif ( builder.getTypeLength( elseType ) > builder.getTypeLength( ifType ) ) {\n\n\t\t\t\treturn elseType;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn ifType;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst condNode = this.condNode.cache();\n\t\tconst ifNode = this.ifNode.cache();\n\t\tconst elseNode = this.elseNode ? this.elseNode.cache() : null;\n\n\t\t//\n\n\t\tconst currentNodeBlock = builder.context.nodeBlock;\n\n\t\tbuilder.getDataFromNode( ifNode ).parentNodeBlock = currentNodeBlock;\n\t\tif ( elseNode !== null ) builder.getDataFromNode( elseNode ).parentNodeBlock = currentNodeBlock;\n\n\t\t//\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.condNode = condNode;\n\t\tproperties.ifNode = ifNode.context( { nodeBlock: ifNode } );\n\t\tproperties.elseNode = elseNode ? elseNode.context( { nodeBlock: elseNode } ) : null;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\tif ( nodeData.nodeProperty !== undefined ) {\n\n\t\t\treturn nodeData.nodeProperty;\n\n\t\t}\n\n\t\tconst { condNode, ifNode, elseNode } = builder.getNodeProperties( this );\n\n\t\tconst needsOutput = output !== 'void';\n\t\tconst nodeProperty = needsOutput ? property( type ).build( builder ) : '';\n\n\t\tnodeData.nodeProperty = nodeProperty;\n\n\t\tconst nodeSnippet = condNode.build( builder, 'bool' );\n\n\t\tbuilder.addFlowCode( `\\n${ builder.tab }if ( ${ nodeSnippet } ) {\\n\\n` ).addFlowTab();\n\n\t\tlet ifSnippet = ifNode.build( builder, type );\n\n\t\tif ( ifSnippet ) {\n\n\t\t\tif ( needsOutput ) {\n\n\t\t\t\tifSnippet = nodeProperty + ' = ' + ifSnippet + ';';\n\n\t\t\t} else {\n\n\t\t\t\tifSnippet = 'return ' + ifSnippet + ';';\n\n\t\t\t}\n\n\t\t}\n\n\t\tbuilder.removeFlowTab().addFlowCode( builder.tab + '\\t' + ifSnippet + '\\n\\n' + builder.tab + '}' );\n\n\t\tif ( elseNode !== null ) {\n\n\t\t\tbuilder.addFlowCode( ' else {\\n\\n' ).addFlowTab();\n\n\t\t\tlet elseSnippet = elseNode.build( builder, type );\n\n\t\t\tif ( elseSnippet ) {\n\n\t\t\t\tif ( needsOutput ) {\n\n\t\t\t\t\telseSnippet = nodeProperty + ' = ' + elseSnippet + ';';\n\n\t\t\t\t} else {\n\n\t\t\t\t\telseSnippet = 'return ' + elseSnippet + ';';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbuilder.removeFlowTab().addFlowCode( builder.tab + '\\t' + elseSnippet + '\\n\\n' + builder.tab + '}\\n\\n' );\n\n\t\t} else {\n\n\t\t\tbuilder.addFlowCode( '\\n\\n' );\n\n\t\t}\n\n\t\treturn builder.format( nodeProperty, type, output );\n\n\t}\n\n}\n\nconst select = /*@__PURE__*/ nodeProxy( ConditionalNode );\n\naddMethodChaining( 'select', select );\n\n//\n\nconst cond = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ConditionalNode: cond() has been renamed to select().' );\n\treturn select( ...params );\n\n};\n\naddMethodChaining( 'cond', cond );\n\nclass ContextNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ContextNode';\n\n\t}\n\n\tconstructor( node, value = {} ) {\n\n\t\tsuper();\n\n\t\tthis.isContextNode = true;\n\n\t\tthis.node = node;\n\t\tthis.value = value;\n\n\t}\n\n\tgetScope() {\n\n\t\treturn this.node.getScope();\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tthis.node.build( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst previousContext = builder.getContext();\n\n\t\tbuilder.setContext( { ...builder.context, ...this.value } );\n\n\t\tconst node = this.node.build( builder );\n\n\t\tbuilder.setContext( previousContext );\n\n\t\treturn node;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst previousContext = builder.getContext();\n\n\t\tbuilder.setContext( { ...builder.context, ...this.value } );\n\n\t\tconst snippet = this.node.build( builder, output );\n\n\t\tbuilder.setContext( previousContext );\n\n\t\treturn snippet;\n\n\t}\n\n}\n\nconst context = /*@__PURE__*/ nodeProxy( ContextNode );\nconst label = ( node, name ) => context( node, { label: name } );\n\naddMethodChaining( 'context', context );\naddMethodChaining( 'label', label );\n\nclass VarNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'VarNode';\n\n\t}\n\n\tconstructor( node, name = null ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.name = name;\n\n\t\tthis.global = true;\n\n\t\tthis.isVarNode = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { node, name } = this;\n\n\t\tconst nodeVar = builder.getVarFromNode( this, name, builder.getVectorType( this.getNodeType( builder ) ) );\n\n\t\tconst propertyName = builder.getPropertyName( nodeVar );\n\n\t\tconst snippet = node.build( builder, nodeVar.type );\n\n\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}`, this );\n\n\t\treturn propertyName;\n\n\t}\n\n}\n\nconst createVar = /*@__PURE__*/ nodeProxy( VarNode );\n\naddMethodChaining( 'toVar', ( ...params ) => createVar( ...params ).append() );\n\n// Deprecated\n\nconst temp = ( node ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: \"temp\" is deprecated. Use \".toVar()\" instead.' );\n\n\treturn createVar( node );\n\n};\n\naddMethodChaining( 'temp', temp );\n\nclass VaryingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'VaryingNode';\n\n\t}\n\n\tconstructor( node, name = null ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.name = name;\n\n\t\tthis.isVaryingNode = true;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.name || super.getHash( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\t// VaryingNode is auto type\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tsetupVarying( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tlet varying = properties.varying;\n\n\t\tif ( varying === undefined ) {\n\n\t\t\tconst name = this.name;\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tproperties.varying = varying = builder.getVaryingFromNode( this, name, type );\n\t\t\tproperties.node = this.node;\n\n\t\t}\n\n\t\t// this property can be used to check if the varying can be optimized for a variable\n\t\tvarying.needsInterpolation || ( varying.needsInterpolation = ( builder.shaderStage === 'fragment' ) );\n\n\t\treturn varying;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupVarying( builder );\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tthis.setupVarying( builder );\n\n\t\treturn this.node.analyze( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tconst varying = this.setupVarying( builder );\n\n\t\tif ( properties.propertyName === undefined ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\t\t\tconst propertyName = builder.getPropertyName( varying, NodeShaderStage.VERTEX );\n\n\t\t\t// force node run in vertex stage\n\t\t\tbuilder.flowNodeFromShaderStage( NodeShaderStage.VERTEX, this.node, type, propertyName );\n\n\t\t\tproperties.propertyName = propertyName;\n\n\t\t}\n\n\t\treturn builder.getPropertyName( varying );\n\n\t}\n\n}\n\nconst varying = /*@__PURE__*/ nodeProxy( VaryingNode );\n\naddMethodChaining( 'varying', varying );\n\nconst sRGBTransferEOTF = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\tconst a = color.mul( 0.9478672986 ).add( 0.0521327014 ).pow( 2.4 );\n\tconst b = color.mul( 0.0773993808 );\n\tconst factor = color.lessThanEqual( 0.04045 );\n\n\tconst rgbResult = mix( a, b, factor );\n\n\treturn rgbResult;\n\n} ).setLayout( {\n\tname: 'sRGBTransferEOTF',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' }\n\t]\n} );\n\nconst sRGBTransferOETF = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\tconst a = color.pow( 0.41666 ).mul( 1.055 ).sub( 0.055 );\n\tconst b = color.mul( 12.92 );\n\tconst factor = color.lessThanEqual( 0.0031308 );\n\n\tconst rgbResult = mix( a, b, factor );\n\n\treturn rgbResult;\n\n} ).setLayout( {\n\tname: 'sRGBTransferOETF',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' }\n\t]\n} );\n\nconst WORKING_COLOR_SPACE = 'WorkingColorSpace';\nconst OUTPUT_COLOR_SPACE = 'OutputColorSpace';\n\nclass ColorSpaceNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'ColorSpaceNode';\n\n\t}\n\n\tconstructor( colorNode, source, target ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.source = source;\n\t\tthis.target = target;\n\n\t}\n\n\tresolveColorSpace( builder, colorSpace ) {\n\n\t\tif ( colorSpace === WORKING_COLOR_SPACE ) {\n\n\t\t\treturn ColorManagement.workingColorSpace;\n\n\t\t} else if ( colorSpace === OUTPUT_COLOR_SPACE ) {\n\n\t\t\treturn builder.context.outputColorSpace || builder.renderer.outputColorSpace;\n\n\t\t}\n\n\t\treturn colorSpace;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { colorNode } = this;\n\n\t\tconst source = this.resolveColorSpace( builder, this.source );\n\t\tconst target = this.resolveColorSpace( builder, this.target );\n\n\t\tlet outputNode = colorNode;\n\n\t\tif ( ColorManagement.enabled === false || source === target || ! source || ! target ) {\n\n\t\t\treturn outputNode;\n\n\t\t}\n\n\t\tif ( ColorManagement.getTransfer( source ) === SRGBTransfer ) {\n\n\t\t\toutputNode = vec4( sRGBTransferEOTF( outputNode.rgb ), outputNode.a );\n\n\t\t}\n\n\t\tif ( ColorManagement.getPrimaries( source ) !== ColorManagement.getPrimaries( target ) ) {\n\n\t\t\toutputNode = vec4(\n\t\t\t\tmat3( ColorManagement._getMatrix( new Matrix3(), source, target ) ).mul( outputNode.rgb ),\n\t\t\t\toutputNode.a\n\t\t\t);\n\n\t\t}\n\n\t\tif ( ColorManagement.getTransfer( target ) === SRGBTransfer ) {\n\n\t\t\toutputNode = vec4( sRGBTransferOETF( outputNode.rgb ), outputNode.a );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst toOutputColorSpace = ( node ) => nodeObject( new ColorSpaceNode( nodeObject( node ), WORKING_COLOR_SPACE, OUTPUT_COLOR_SPACE ) );\nconst toWorkingColorSpace = ( node ) => nodeObject( new ColorSpaceNode( nodeObject( node ), OUTPUT_COLOR_SPACE, WORKING_COLOR_SPACE ) );\n\nconst workingToColorSpace = ( node, colorSpace ) => nodeObject( new ColorSpaceNode( nodeObject( node ), WORKING_COLOR_SPACE, colorSpace ) );\nconst colorSpaceToWorking = ( node, colorSpace ) => nodeObject( new ColorSpaceNode( nodeObject( node ), colorSpace, WORKING_COLOR_SPACE ) );\n\nconst convertColorSpace = ( node, sourceColorSpace, targetColorSpace ) => nodeObject( new ColorSpaceNode( nodeObject( node ), sourceColorSpace, targetColorSpace ) );\n\naddMethodChaining( 'toOutputColorSpace', toOutputColorSpace );\naddMethodChaining( 'toWorkingColorSpace', toWorkingColorSpace );\n\naddMethodChaining( 'workingToColorSpace', workingToColorSpace );\naddMethodChaining( 'colorSpaceToWorking', colorSpaceToWorking );\n\nlet ReferenceElementNode$1 = class ReferenceElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceElementNode';\n\n\t}\n\n\tconstructor( referenceNode, indexNode ) {\n\n\t\tsuper( referenceNode, indexNode );\n\n\t\tthis.referenceNode = referenceNode;\n\n\t\tthis.isReferenceElementNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.referenceNode.uniformType;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst arrayType = this.referenceNode.getNodeType();\n\t\tconst elementType = this.getNodeType();\n\n\t\treturn builder.format( snippet, arrayType, elementType );\n\n\t}\n\n};\n\nclass ReferenceBaseNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceBaseNode';\n\n\t}\n\n\tconstructor( property, uniformType, object = null, count = null ) {\n\n\t\tsuper();\n\n\t\tthis.property = property;\n\t\tthis.uniformType = uniformType;\n\t\tthis.object = object;\n\t\tthis.count = count;\n\n\t\tthis.properties = property.split( '.' );\n\t\tthis.reference = object;\n\t\tthis.node = null;\n\t\tthis.group = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.group = group;\n\n\t\treturn this;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new ReferenceElementNode$1( this, nodeObject( indexNode ) ) );\n\n\t}\n\n\tsetNodeType( uniformType ) {\n\n\t\tconst node = uniform( null, uniformType ).getSelf();\n\n\t\tif ( this.group !== null ) {\n\n\t\t\tnode.setGroup( this.group );\n\n\t\t}\n\n\t\tthis.node = node;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.node === null ) {\n\n\t\t\tthis.updateReference( builder );\n\t\t\tthis.updateValue();\n\n\t\t}\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgetValueFromReference( object = this.reference ) {\n\n\t\tconst { properties } = this;\n\n\t\tlet value = object[ properties[ 0 ] ];\n\n\t\tfor ( let i = 1; i < properties.length; i ++ ) {\n\n\t\t\tvalue = value[ properties[ i ] ];\n\n\t\t}\n\n\t\treturn value;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.object !== null ? this.object : state.object;\n\n\t\treturn this.reference;\n\n\t}\n\n\tsetup() {\n\n\t\tthis.updateValue();\n\n\t\treturn this.node;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tthis.updateValue();\n\n\t}\n\n\tupdateValue() {\n\n\t\tif ( this.node === null ) this.setNodeType( this.uniformType );\n\n\t\tconst value = this.getValueFromReference();\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tthis.node.array = value;\n\n\t\t} else {\n\n\t\t\tthis.node.value = value;\n\n\t\t}\n\n\t}\n\n}\n\nconst reference$1 = ( name, type, object ) => nodeObject( new ReferenceBaseNode( name, type, object ) );\n\nclass RendererReferenceNode extends ReferenceBaseNode {\n\n\tstatic get type() {\n\n\t\treturn 'RendererReferenceNode';\n\n\t}\n\n\tconstructor( property, inputType, renderer = null ) {\n\n\t\tsuper( property, inputType, renderer );\n\n\t\tthis.renderer = renderer;\n\n\t\tthis.setGroup( renderGroup );\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.renderer !== null ? this.renderer : state.renderer;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nconst rendererReference = ( name, type, renderer ) => nodeObject( new RendererReferenceNode( name, type, renderer ) );\n\nclass ToneMappingNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'ToneMappingNode';\n\n\t}\n\n\tconstructor( toneMapping, exposureNode = toneMappingExposure, colorNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.toneMapping = toneMapping;\n\n\t\tthis.exposureNode = exposureNode;\n\t\tthis.colorNode = colorNode;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn hash$1( super.getCacheKey(), this.toneMapping );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst colorNode = this.colorNode || builder.context.color;\n\t\tconst toneMapping = this.toneMapping;\n\n\t\tif ( toneMapping === NoToneMapping ) return colorNode;\n\n\t\tlet outputNode = null;\n\n\t\tconst toneMappingFn = builder.renderer.library.getToneMappingFunction( toneMapping );\n\n\t\tif ( toneMappingFn !== null ) {\n\n\t\t\toutputNode = vec4( toneMappingFn( colorNode.rgb, this.exposureNode ), colorNode.a );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping );\n\n\t\t\toutputNode = colorNode;\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst toneMapping = ( mapping, exposure, color ) => nodeObject( new ToneMappingNode( mapping, nodeObject( exposure ), nodeObject( color ) ) );\nconst toneMappingExposure = /*@__PURE__*/ rendererReference( 'toneMappingExposure', 'float' );\n\naddMethodChaining( 'toneMapping', ( color, mapping, exposure ) => toneMapping( mapping, exposure, color ) );\n\nclass BufferAttributeNode extends InputNode {\n\n\tstatic get type() {\n\n\t\treturn 'BufferAttributeNode';\n\n\t}\n\n\tconstructor( value, bufferType = null, bufferStride = 0, bufferOffset = 0 ) {\n\n\t\tsuper( value, bufferType );\n\n\t\tthis.isBufferNode = true;\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferStride = bufferStride;\n\t\tthis.bufferOffset = bufferOffset;\n\n\t\tthis.usage = StaticDrawUsage;\n\t\tthis.instanced = false;\n\n\t\tthis.attribute = null;\n\n\t\tthis.global = true;\n\n\t\tif ( value && value.isBufferAttribute === true ) {\n\n\t\t\tthis.attribute = value;\n\t\t\tthis.usage = value.usage;\n\t\t\tthis.instanced = value.isInstancedBufferAttribute;\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this.bufferStride === 0 && this.bufferOffset === 0 ) {\n\n\t\t\tlet bufferData = builder.globalCache.getData( this.value );\n\n\t\t\tif ( bufferData === undefined ) {\n\n\t\t\t\tbufferData = {\n\t\t\t\t\tnode: this\n\t\t\t\t};\n\n\t\t\t\tbuilder.globalCache.setData( this.value, bufferData );\n\n\t\t\t}\n\n\t\t\treturn bufferData.node.uuid;\n\n\t\t}\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.bufferType === null ) {\n\n\t\t\tthis.bufferType = builder.getTypeFromAttribute( this.attribute );\n\n\t\t}\n\n\t\treturn this.bufferType;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this.attribute !== null ) return;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst array = this.value;\n\t\tconst itemSize = builder.getTypeLength( type );\n\t\tconst stride = this.bufferStride || itemSize;\n\t\tconst offset = this.bufferOffset;\n\n\t\tconst buffer = array.isInterleavedBuffer === true ? array : new InterleavedBuffer( array, stride );\n\t\tconst bufferAttribute = new InterleavedBufferAttribute( buffer, itemSize, offset );\n\n\t\tbuffer.setUsage( this.usage );\n\n\t\tthis.attribute = bufferAttribute;\n\t\tthis.attribute.isInstancedBufferAttribute = this.instanced; // @TODO: Add a possible: InstancedInterleavedBufferAttribute\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tconst nodeAttribute = builder.getBufferAttributeFromNode( this, nodeType );\n\t\tconst propertyName = builder.getPropertyName( nodeAttribute );\n\n\t\tlet output = null;\n\n\t\tif ( builder.shaderStage === 'vertex' || builder.shaderStage === 'compute' ) {\n\n\t\t\tthis.name = propertyName;\n\n\t\t\toutput = propertyName;\n\n\t\t} else {\n\n\t\t\tconst nodeVarying = varying( this );\n\n\t\t\toutput = nodeVarying.build( builder, nodeType );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'bufferAttribute';\n\n\t}\n\n\tsetUsage( value ) {\n\n\t\tthis.usage = value;\n\n\t\tif ( this.attribute && this.attribute.isBufferAttribute === true ) {\n\n\t\t\tthis.attribute.usage = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tsetInstanced( value ) {\n\n\t\tthis.instanced = value;\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst bufferAttribute = ( array, type, stride, offset ) => nodeObject( new BufferAttributeNode( array, type, stride, offset ) );\nconst dynamicBufferAttribute = ( array, type, stride, offset ) => bufferAttribute( array, type, stride, offset ).setUsage( DynamicDrawUsage );\n\nconst instancedBufferAttribute = ( array, type, stride, offset ) => bufferAttribute( array, type, stride, offset ).setInstanced( true );\nconst instancedDynamicBufferAttribute = ( array, type, stride, offset ) => dynamicBufferAttribute( array, type, stride, offset ).setInstanced( true );\n\naddMethodChaining( 'toAttribute', ( bufferNode ) => bufferAttribute( bufferNode.value ) );\n\nclass ComputeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ComputeNode';\n\n\t}\n\n\tconstructor( computeNode, count, workgroupSize = [ 64 ] ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.isComputeNode = true;\n\n\t\tthis.computeNode = computeNode;\n\n\t\tthis.count = count;\n\t\tthis.workgroupSize = workgroupSize;\n\t\tthis.dispatchCount = 0;\n\n\t\tthis.version = 1;\n\t\tthis.updateBeforeType = NodeUpdateType.OBJECT;\n\n\t\tthis.onInitFunction = null;\n\n\t\tthis.updateDispatchCount();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.dispatchEvent( { type: 'dispose' } );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n\tupdateDispatchCount() {\n\n\t\tconst { count, workgroupSize } = this;\n\n\t\tlet size = workgroupSize[ 0 ];\n\n\t\tfor ( let i = 1; i < workgroupSize.length; i ++ )\n\t\t\tsize *= workgroupSize[ i ];\n\n\t\tthis.dispatchCount = Math.ceil( count / size );\n\n\t}\n\n\tonInit( callback ) {\n\n\t\tthis.onInitFunction = callback;\n\n\t\treturn this;\n\n\t}\n\n\tupdateBefore( { renderer } ) {\n\n\t\trenderer.compute( this );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { shaderStage } = builder;\n\n\t\tif ( shaderStage === 'compute' ) {\n\n\t\t\tconst snippet = this.computeNode.build( builder, 'void' );\n\n\t\t\tif ( snippet !== '' ) {\n\n\t\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst compute = ( node, count, workgroupSize ) => nodeObject( new ComputeNode( nodeObject( node ), count, workgroupSize ) );\n\naddMethodChaining( 'compute', compute );\n\nclass CacheNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'CacheNode';\n\n\t}\n\n\tconstructor( node, parent = true ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.parent = parent;\n\n\t\tthis.isCacheNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tbuild( builder, ...params ) {\n\n\t\tconst previousCache = builder.getCache();\n\t\tconst cache = builder.getCacheFromNode( this, this.parent );\n\n\t\tbuilder.setCache( cache );\n\n\t\tconst data = this.node.build( builder, ...params );\n\n\t\tbuilder.setCache( previousCache );\n\n\t\treturn data;\n\n\t}\n\n}\n\nconst cache = ( node, ...params ) => nodeObject( new CacheNode( nodeObject( node ), ...params ) );\n\naddMethodChaining( 'cache', cache );\n\nclass BypassNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'BypassNode';\n\n\t}\n\n\tconstructor( returnNode, callNode ) {\n\n\t\tsuper();\n\n\t\tthis.isBypassNode = true;\n\n\t\tthis.outputNode = returnNode;\n\t\tthis.callNode = callNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.outputNode.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = this.callNode.build( builder, 'void' );\n\n\t\tif ( snippet !== '' ) {\n\n\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t}\n\n\t\treturn this.outputNode.build( builder );\n\n\t}\n\n}\n\nconst bypass = /*@__PURE__*/ nodeProxy( BypassNode );\n\naddMethodChaining( 'bypass', bypass );\n\nclass RemapNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'RemapNode';\n\n\t}\n\n\tconstructor( node, inLowNode, inHighNode, outLowNode = float( 0 ), outHighNode = float( 1 ) ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\t\tthis.inLowNode = inLowNode;\n\t\tthis.inHighNode = inHighNode;\n\t\tthis.outLowNode = outLowNode;\n\t\tthis.outHighNode = outHighNode;\n\n\t\tthis.doClamp = true;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { node, inLowNode, inHighNode, outLowNode, outHighNode, doClamp } = this;\n\n\t\tlet t = node.sub( inLowNode ).div( inHighNode.sub( inLowNode ) );\n\n\t\tif ( doClamp === true ) t = t.clamp();\n\n\t\treturn t.mul( outHighNode.sub( outLowNode ) ).add( outLowNode );\n\n\t}\n\n}\n\nconst remap = /*@__PURE__*/ nodeProxy( RemapNode, null, null, { doClamp: false } );\nconst remapClamp = /*@__PURE__*/ nodeProxy( RemapNode );\n\naddMethodChaining( 'remap', remap );\naddMethodChaining( 'remapClamp', remapClamp );\n\nclass ExpressionNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ExpressionNode';\n\n\t}\n\n\tconstructor( snippet = '', nodeType = 'void' ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.snippet = snippet;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst snippet = this.snippet;\n\n\t\tif ( type === 'void' ) {\n\n\t\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t\t} else {\n\n\t\t\treturn builder.format( `( ${ snippet } )`, type, output );\n\n\t\t}\n\n\t}\n\n}\n\nconst expression = /*@__PURE__*/ nodeProxy( ExpressionNode );\n\nconst Discard = ( conditional ) => ( conditional ? select( conditional, expression( 'discard' ) ) : expression( 'discard' ) ).append();\nconst Return = () => expression( 'return' ).append();\n\naddMethodChaining( 'discard', Discard );\n\nclass RenderOutputNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'RenderOutputNode';\n\n\t}\n\n\tconstructor( colorNode, toneMapping, outputColorSpace ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.toneMapping = toneMapping;\n\t\tthis.outputColorSpace = outputColorSpace;\n\n\t\tthis.isRenderOutput = true;\n\n\t}\n\n\tsetup( { context } ) {\n\n\t\tlet outputNode = this.colorNode || context.color;\n\n\t\t// tone mapping\n\n\t\tconst toneMapping = ( this.toneMapping !== null ? this.toneMapping : context.toneMapping ) || NoToneMapping;\n\t\tconst outputColorSpace = ( this.outputColorSpace !== null ? this.outputColorSpace : context.outputColorSpace ) || NoColorSpace;\n\n\t\tif ( toneMapping !== NoToneMapping ) {\n\n\t\t\toutputNode = outputNode.toneMapping( toneMapping );\n\n\t\t}\n\n\t\t// working to output color space\n\n\t\tif ( outputColorSpace !== NoColorSpace && outputColorSpace !== ColorManagement.workingColorSpace ) {\n\n\t\t\toutputNode = outputNode.workingToColorSpace( outputColorSpace );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst renderOutput = ( color, toneMapping = null, outputColorSpace = null ) => nodeObject( new RenderOutputNode( nodeObject( color ), toneMapping, outputColorSpace ) );\n\naddMethodChaining( 'renderOutput', renderOutput );\n\n// Non-PURE exports list, side-effects are required here.\n// TSL Base Syntax\n\n\nfunction addNodeElement( name/*, nodeElement*/ ) {\n\n\tconsole.warn( 'THREE.TSLBase: AddNodeElement has been removed in favor of tree-shaking. Trying add', name );\n\n}\n\nclass AttributeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'AttributeNode';\n\n\t}\n\n\tconstructor( attributeName, nodeType = null ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis.global = true;\n\n\t\tthis._attributeName = attributeName;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.getAttributeName( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tlet nodeType = this.nodeType;\n\n\t\tif ( nodeType === null ) {\n\n\t\t\tconst attributeName = this.getAttributeName( builder );\n\n\t\t\tif ( builder.hasGeometryAttribute( attributeName ) ) {\n\n\t\t\t\tconst attribute = builder.geometry.getAttribute( attributeName );\n\n\t\t\t\tnodeType = builder.getTypeFromAttribute( attribute );\n\n\t\t\t} else {\n\n\t\t\t\tnodeType = 'float';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeType;\n\n\t}\n\n\tsetAttributeName( attributeName ) {\n\n\t\tthis._attributeName = attributeName;\n\n\t\treturn this;\n\n\t}\n\n\tgetAttributeName( /*builder*/ ) {\n\n\t\treturn this._attributeName;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst attributeName = this.getAttributeName( builder );\n\t\tconst nodeType = this.getNodeType( builder );\n\t\tconst geometryAttribute = builder.hasGeometryAttribute( attributeName );\n\n\t\tif ( geometryAttribute === true ) {\n\n\t\t\tconst attribute = builder.geometry.getAttribute( attributeName );\n\t\t\tconst attributeType = builder.getTypeFromAttribute( attribute );\n\n\t\t\tconst nodeAttribute = builder.getAttribute( attributeName, attributeType );\n\n\t\t\tif ( builder.shaderStage === 'vertex' ) {\n\n\t\t\t\treturn builder.format( nodeAttribute.name, attributeType, nodeType );\n\n\t\t\t} else {\n\n\t\t\t\tconst nodeVarying = varying( this );\n\n\t\t\t\treturn nodeVarying.build( builder, nodeType );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( `AttributeNode: Vertex attribute \"${ attributeName }\" not found on geometry.` );\n\n\t\t\treturn builder.generateConst( nodeType );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.global = this.global;\n\t\tdata._attributeName = this._attributeName;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.global = data.global;\n\t\tthis._attributeName = data._attributeName;\n\n\t}\n\n}\n\nconst attribute = ( name, nodeType ) => nodeObject( new AttributeNode( name, nodeType ) );\n\nconst uv = ( index ) => attribute( 'uv' + ( index > 0 ? index : '' ), 'vec2' );\n\nclass TextureSizeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'TextureSizeNode';\n\n\t}\n\n\tconstructor( textureNode, levelNode = null ) {\n\n\t\tsuper( 'uvec2' );\n\n\t\tthis.isTextureSizeNode = true;\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.levelNode = levelNode;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst textureProperty = this.textureNode.build( builder, 'property' );\n\t\tconst level = this.levelNode === null ? '0' : this.levelNode.build( builder, 'int' );\n\n\t\treturn builder.format( `${ builder.getMethod( 'textureDimensions' ) }( ${ textureProperty }, ${ level } )`, this.getNodeType( builder ), output );\n\n\t}\n\n}\n\nconst textureSize = /*@__PURE__*/ nodeProxy( TextureSizeNode );\n\nclass MaxMipLevelNode extends UniformNode {\n\n\tstatic get type() {\n\n\t\treturn 'MaxMipLevelNode';\n\n\t}\n\n\tconstructor( textureNode ) {\n\n\t\tsuper( 0 );\n\n\t\tthis._textureNode = textureNode;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t}\n\n\tget textureNode() {\n\n\t\treturn this._textureNode;\n\n\t}\n\n\tget texture() {\n\n\t\treturn this._textureNode.value;\n\n\t}\n\n\tupdate() {\n\n\t\tconst texture = this.texture;\n\t\tconst images = texture.images;\n\t\tconst image = ( images && images.length > 0 ) ? ( ( images[ 0 ] && images[ 0 ].image ) || images[ 0 ] ) : texture.image;\n\n\t\tif ( image && image.width !== undefined ) {\n\n\t\t\tconst { width, height } = image;\n\n\t\t\tthis.value = Math.log2( Math.max( width, height ) );\n\n\t\t}\n\n\t}\n\n}\n\nconst maxMipLevel = /*@__PURE__*/ nodeProxy( MaxMipLevelNode );\n\nclass TextureNode extends UniformNode {\n\n\tstatic get type() {\n\n\t\treturn 'TextureNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null, biasNode = null ) {\n\n\t\tsuper( value );\n\n\t\tthis.isTextureNode = true;\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.levelNode = levelNode;\n\t\tthis.biasNode = biasNode;\n\t\tthis.compareNode = null;\n\t\tthis.depthNode = null;\n\t\tthis.gradNode = null;\n\n\t\tthis.sampler = true;\n\t\tthis.updateMatrix = false;\n\t\tthis.updateType = NodeUpdateType.NONE;\n\n\t\tthis.referenceNode = null;\n\n\t\tthis._value = value;\n\t\tthis._matrixUniform = null;\n\n\t\tthis.setUpdateMatrix( uvNode === null );\n\n\t}\n\n\tset value( value ) {\n\n\t\tif ( this.referenceNode ) {\n\n\t\t\tthis.referenceNode.value = value;\n\n\t\t} else {\n\n\t\t\tthis._value = value;\n\n\t\t}\n\n\t}\n\n\tget value() {\n\n\t\treturn this.referenceNode ? this.referenceNode.value : this._value;\n\n\t}\n\n\tgetUniformHash( /*builder*/ ) {\n\n\t\treturn this.value.uuid;\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\tif ( this.value.isDepthTexture === true ) return 'float';\n\n\t\tif ( this.value.type === UnsignedIntType ) {\n\n\t\t\treturn 'uvec4';\n\n\t\t} else if ( this.value.type === IntType ) {\n\n\t\t\treturn 'ivec4';\n\n\t\t}\n\n\t\treturn 'vec4';\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'texture';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn uv( this.value.channel );\n\n\t}\n\n\tupdateReference( /*state*/ ) {\n\n\t\treturn this.value;\n\n\t}\n\n\tgetTransformedUV( uvNode ) {\n\n\t\tif ( this._matrixUniform === null ) this._matrixUniform = uniform( this.value.matrix );\n\n\t\treturn this._matrixUniform.mul( vec3( uvNode, 1 ) ).xy;\n\n\t}\n\n\tsetUpdateMatrix( value ) {\n\n\t\tthis.updateMatrix = value;\n\t\tthis.updateType = value ? NodeUpdateType.FRAME : NodeUpdateType.NONE;\n\n\t\treturn this;\n\n\t}\n\n\tsetupUV( builder, uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.isFlipY() && ( texture.isRenderTargetTexture === true || texture.isFramebufferTexture === true || texture.isDepthTexture === true ) ) {\n\n\t\t\tif ( this.sampler ) {\n\n\t\t\t\tuvNode = uvNode.flipY();\n\n\t\t\t} else {\n\n\t\t\t\tuvNode = uvNode.setY( int( textureSize( this, this.levelNode ).y ).sub( uvNode.y ).sub( 1 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn uvNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.referenceNode = this.referenceNode;\n\n\t\t//\n\n\t\tlet uvNode = this.uvNode;\n\n\t\tif ( ( uvNode === null || builder.context.forceUVContext === true ) && builder.context.getUV ) {\n\n\t\t\tuvNode = builder.context.getUV( this );\n\n\t\t}\n\n\t\tif ( ! uvNode ) uvNode = this.getDefaultUV();\n\n\t\tif ( this.updateMatrix === true ) {\n\n\t\t\tuvNode = this.getTransformedUV( uvNode );\n\n\t\t}\n\n\t\tuvNode = this.setupUV( builder, uvNode );\n\n\t\t//\n\n\t\tlet levelNode = this.levelNode;\n\n\t\tif ( levelNode === null && builder.context.getTextureLevel ) {\n\n\t\t\tlevelNode = builder.context.getTextureLevel( this );\n\n\t\t}\n\n\t\t//\n\n\t\tproperties.uvNode = uvNode;\n\t\tproperties.levelNode = levelNode;\n\t\tproperties.biasNode = this.biasNode;\n\t\tproperties.compareNode = this.compareNode;\n\t\tproperties.gradNode = this.gradNode;\n\t\tproperties.depthNode = this.depthNode;\n\n\t}\n\n\tgenerateUV( builder, uvNode ) {\n\n\t\treturn uvNode.build( builder, this.sampler === true ? 'vec2' : 'ivec2' );\n\n\t}\n\n\tgenerateSnippet( builder, textureProperty, uvSnippet, levelSnippet, biasSnippet, depthSnippet, compareSnippet, gradSnippet ) {\n\n\t\tconst texture = this.value;\n\n\t\tlet snippet;\n\n\t\tif ( levelSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet );\n\n\t\t} else if ( biasSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureBias( texture, textureProperty, uvSnippet, biasSnippet, depthSnippet );\n\n\t\t} else if ( gradSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet, depthSnippet );\n\n\t\t} else if ( compareSnippet ) {\n\n\t\t\tsnippet = builder.generateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet );\n\n\t\t} else if ( this.sampler === false ) {\n\n\t\t\tsnippet = builder.generateTextureLoad( texture, textureProperty, uvSnippet, depthSnippet );\n\n\t\t} else {\n\n\t\t\tsnippet = builder.generateTexture( texture, textureProperty, uvSnippet, depthSnippet );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tconst texture = this.value;\n\n\t\tif ( ! texture || texture.isTexture !== true ) {\n\n\t\t\tthrow new Error( 'TextureNode: Need a three.js texture.' );\n\n\t\t}\n\n\t\tconst textureProperty = super.generate( builder, 'property' );\n\n\t\tif ( output === 'sampler' ) {\n\n\t\t\treturn textureProperty + '_sampler';\n\n\t\t} else if ( builder.isReference( output ) ) {\n\n\t\t\treturn textureProperty;\n\n\t\t} else {\n\n\t\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\t\tlet propertyName = nodeData.propertyName;\n\n\t\t\tif ( propertyName === undefined ) {\n\n\t\t\t\tconst { uvNode, levelNode, biasNode, compareNode, depthNode, gradNode } = properties;\n\n\t\t\t\tconst uvSnippet = this.generateUV( builder, uvNode );\n\t\t\t\tconst levelSnippet = levelNode ? levelNode.build( builder, 'float' ) : null;\n\t\t\t\tconst biasSnippet = biasNode ? biasNode.build( builder, 'float' ) : null;\n\t\t\t\tconst depthSnippet = depthNode ? depthNode.build( builder, 'int' ) : null;\n\t\t\t\tconst compareSnippet = compareNode ? compareNode.build( builder, 'float' ) : null;\n\t\t\t\tconst gradSnippet = gradNode ? [ gradNode[ 0 ].build( builder, 'vec2' ), gradNode[ 1 ].build( builder, 'vec2' ) ] : null;\n\n\t\t\t\tconst nodeVar = builder.getVarFromNode( this );\n\n\t\t\t\tpropertyName = builder.getPropertyName( nodeVar );\n\n\t\t\t\tconst snippet = this.generateSnippet( builder, textureProperty, uvSnippet, levelSnippet, biasSnippet, depthSnippet, compareSnippet, gradSnippet );\n\n\t\t\t\tbuilder.addLineFlowCode( `${propertyName} = ${snippet}`, this );\n\n\t\t\t\tnodeData.snippet = snippet;\n\t\t\t\tnodeData.propertyName = propertyName;\n\n\t\t\t}\n\n\t\t\tlet snippet = propertyName;\n\t\t\tconst nodeType = this.getNodeType( builder );\n\n\t\t\tif ( builder.needsToWorkingColorSpace( texture ) ) {\n\n\t\t\t\tsnippet = colorSpaceToWorking( expression( snippet, nodeType ), texture.colorSpace ).setup( builder ).build( builder, nodeType );\n\n\t\t\t}\n\n\t\t\treturn builder.format( snippet, nodeType, output );\n\n\t\t}\n\n\t}\n\n\tsetSampler( value ) {\n\n\t\tthis.sampler = value;\n\n\t\treturn this;\n\n\t}\n\n\tgetSampler() {\n\n\t\treturn this.sampler;\n\n\t}\n\n\t// @TODO: Move to TSL\n\n\tuv( uvNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.uvNode = nodeObject( uvNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tblur( amountNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.biasNode = nodeObject( amountNode ).mul( maxMipLevel( textureNode ) );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tlevel( levelNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.levelNode = nodeObject( levelNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tsize( levelNode ) {\n\n\t\treturn textureSize( this, levelNode );\n\n\t}\n\n\tbias( biasNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.biasNode = nodeObject( biasNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tcompare( compareNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.compareNode = nodeObject( compareNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tgrad( gradNodeX, gradNodeY ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.gradNode = [ nodeObject( gradNodeX ), nodeObject( gradNodeY ) ];\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\tdepth( depthNode ) {\n\n\t\tconst textureNode = this.clone();\n\t\ttextureNode.depthNode = nodeObject( depthNode );\n\t\ttextureNode.referenceNode = this.getSelf();\n\n\t\treturn nodeObject( textureNode );\n\n\t}\n\n\t// --\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.value = this.value.toJSON( data.meta ).uuid;\n\t\tdata.sampler = this.sampler;\n\t\tdata.updateMatrix = this.updateMatrix;\n\t\tdata.updateType = this.updateType;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.value = data.meta.textures[ data.value ];\n\t\tthis.sampler = data.sampler;\n\t\tthis.updateMatrix = data.updateMatrix;\n\t\tthis.updateType = data.updateType;\n\n\t}\n\n\tupdate() {\n\n\t\tconst texture = this.value;\n\t\tconst matrixUniform = this._matrixUniform;\n\n\t\tif ( matrixUniform !== null ) matrixUniform.value = texture.matrix;\n\n\t\tif ( texture.matrixAutoUpdate === true ) {\n\n\t\t\ttexture.updateMatrix();\n\n\t\t}\n\n\t}\n\n\tclone() {\n\n\t\tconst newNode = new this.constructor( this.value, this.uvNode, this.levelNode, this.biasNode );\n\t\tnewNode.sampler = this.sampler;\n\n\t\treturn newNode;\n\n\t}\n\n}\n\nconst texture = /*@__PURE__*/ nodeProxy( TextureNode );\nconst textureLoad = ( ...params ) => texture( ...params ).setSampler( false );\n\n//export const textureLevel = ( value, uv, level ) => texture( value, uv ).level( level );\n\nconst sampler = ( aTexture ) => ( aTexture.isNode === true ? aTexture : texture( aTexture ) ).convert( 'sampler' );\n\nconst cameraNear = /*@__PURE__*/ uniform( 'float' ).label( 'cameraNear' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.near );\nconst cameraFar = /*@__PURE__*/ uniform( 'float' ).label( 'cameraFar' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.far );\nconst cameraProjectionMatrix = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraProjectionMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.projectionMatrix );\nconst cameraProjectionMatrixInverse = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraProjectionMatrixInverse' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.projectionMatrixInverse );\nconst cameraViewMatrix = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraViewMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.matrixWorldInverse );\nconst cameraWorldMatrix = /*@__PURE__*/ uniform( 'mat4' ).label( 'cameraWorldMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.matrixWorld );\nconst cameraNormalMatrix = /*@__PURE__*/ uniform( 'mat3' ).label( 'cameraNormalMatrix' ).setGroup( renderGroup ).onRenderUpdate( ( { camera } ) => camera.normalMatrix );\nconst cameraPosition = /*@__PURE__*/ uniform( new Vector3() ).label( 'cameraPosition' ).setGroup( renderGroup ).onRenderUpdate( ( { camera }, self ) => self.value.setFromMatrixPosition( camera.matrixWorld ) );\n\nclass Object3DNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'Object3DNode';\n\n\t}\n\n\tconstructor( scope, object3d = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.object3d = object3d;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\tthis._uniformNode = new UniformNode( null );\n\n\t}\n\n\tgetNodeType() {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\treturn 'mat4';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\treturn 'vec3';\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.object3d;\n\t\tconst uniformNode = this._uniformNode;\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\tuniformNode.value = object.matrixWorld;\n\n\t\t} else if ( scope === Object3DNode.POSITION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.SCALE ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tuniformNode.value.setFromMatrixScale( object.matrixWorld );\n\n\t\t} else if ( scope === Object3DNode.DIRECTION ) {\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\n\t\t\tobject.getWorldDirection( uniformNode.value );\n\n\t\t} else if ( scope === Object3DNode.VIEW_POSITION ) {\n\n\t\t\tconst camera = frame.camera;\n\n\t\t\tuniformNode.value = uniformNode.value || new Vector3();\n\t\t\tuniformNode.value.setFromMatrixPosition( object.matrixWorld );\n\n\t\t\tuniformNode.value.applyMatrix4( camera.matrixWorldInverse );\n\n\t\t}\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst scope = this.scope;\n\n\t\tif ( scope === Object3DNode.WORLD_MATRIX ) {\n\n\t\t\tthis._uniformNode.nodeType = 'mat4';\n\n\t\t} else if ( scope === Object3DNode.POSITION || scope === Object3DNode.VIEW_POSITION || scope === Object3DNode.DIRECTION || scope === Object3DNode.SCALE ) {\n\n\t\t\tthis._uniformNode.nodeType = 'vec3';\n\n\t\t}\n\n\t\treturn this._uniformNode.build( builder );\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.scope = this.scope;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.scope = data.scope;\n\n\t}\n\n}\n\nObject3DNode.WORLD_MATRIX = 'worldMatrix';\nObject3DNode.POSITION = 'position';\nObject3DNode.SCALE = 'scale';\nObject3DNode.VIEW_POSITION = 'viewPosition';\nObject3DNode.DIRECTION = 'direction';\n\nconst objectDirection = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.DIRECTION );\nconst objectWorldMatrix = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.WORLD_MATRIX );\nconst objectPosition = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.POSITION );\nconst objectScale = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.SCALE );\nconst objectViewPosition = /*@__PURE__*/ nodeProxy( Object3DNode, Object3DNode.VIEW_POSITION );\n\nclass ModelNode extends Object3DNode {\n\n\tstatic get type() {\n\n\t\treturn 'ModelNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper( scope );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tthis.object3d = frame.object;\n\n\t\tsuper.update( frame );\n\n\t}\n\n}\n\nconst modelDirection = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.DIRECTION );\nconst modelWorldMatrix = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.WORLD_MATRIX );\nconst modelPosition = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.POSITION );\nconst modelScale = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.SCALE );\nconst modelViewPosition = /*@__PURE__*/ nodeImmutable( ModelNode, ModelNode.VIEW_POSITION );\nconst modelNormalMatrix = /*@__PURE__*/ uniform( new Matrix3() ).onObjectUpdate( ( { object }, self ) => self.value.getNormalMatrix( object.matrixWorld ) );\nconst modelWorldMatrixInverse = /*@__PURE__*/ uniform( new Matrix4() ).onObjectUpdate( ( { object }, self ) => self.value.copy( object.matrixWorld ).invert() );\nconst modelViewMatrix = /*@__PURE__*/ cameraViewMatrix.mul( modelWorldMatrix ).toVar( 'modelViewMatrix' );\n\nconst highPrecisionModelViewMatrix = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tbuilder.context.isHighPrecisionModelViewMatrix = true;\n\n\treturn uniform( 'mat4' ).onObjectUpdate( ( { object, camera } ) => {\n\n\t\treturn object.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\n\t} );\n\n} ).once() )().toVar( 'highPrecisionModelViewMatrix' );\n\nconst highPrecisionModelNormalViewMatrix = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tconst isHighPrecisionModelViewMatrix = builder.context.isHighPrecisionModelViewMatrix;\n\n\treturn uniform( 'mat3' ).onObjectUpdate( ( { object, camera } ) => {\n\n\t\tif ( isHighPrecisionModelViewMatrix !== true ) {\n\n\t\t\tobject.modelViewMatrix.multiplyMatrices( camera.matrixWorldInverse, object.matrixWorld );\n\n\t\t}\n\n\t\treturn object.normalMatrix.getNormalMatrix( object.modelViewMatrix );\n\n\t} );\n\n} ).once() )().toVar( 'highPrecisionModelNormalMatrix' );\n\nconst positionGeometry = /*@__PURE__*/ attribute( 'position', 'vec3' );\nconst positionLocal = /*@__PURE__*/ positionGeometry.varying( 'positionLocal' );\nconst positionPrevious = /*@__PURE__*/ positionGeometry.varying( 'positionPrevious' );\nconst positionWorld = /*@__PURE__*/ modelWorldMatrix.mul( positionLocal ).xyz.varying( 'v_positionWorld' );\nconst positionWorldDirection = /*@__PURE__*/ positionLocal.transformDirection( modelWorldMatrix ).varying( 'v_positionWorldDirection' ).normalize().toVar( 'positionWorldDirection' );\nconst positionView = /*@__PURE__*/ modelViewMatrix.mul( positionLocal ).xyz.varying( 'v_positionView' );\nconst positionViewDirection = /*@__PURE__*/ positionView.negate().varying( 'v_positionViewDirection' ).normalize().toVar( 'positionViewDirection' );\n\nclass FrontFacingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'FrontFacingNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'bool' );\n\n\t\tthis.isFrontFacingNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { renderer, material } = builder;\n\n\t\tif ( renderer.coordinateSystem === WebGLCoordinateSystem ) {\n\n\t\t\tif ( material.side === BackSide ) {\n\n\t\t\t\treturn 'false';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn builder.getFrontFacing();\n\n\t}\n\n}\n\nconst frontFacing = /*@__PURE__*/ nodeImmutable( FrontFacingNode );\nconst faceDirection = /*@__PURE__*/ float( frontFacing ).mul( 2.0 ).sub( 1.0 );\n\nconst normalGeometry = /*@__PURE__*/ attribute( 'normal', 'vec3' );\n\nconst normalLocal = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'normal' ) === false ) {\n\n\t\tconsole.warn( 'TSL.NormalNode: Vertex attribute \"normal\" not found on geometry.' );\n\n\t\treturn vec3( 0, 1, 0 );\n\n\t}\n\n\treturn normalGeometry;\n\n}, 'vec3' ).once() )().toVar( 'normalLocal' );\n\nconst normalFlat = /*@__PURE__*/ positionView.dFdx().cross( positionView.dFdy() ).normalize().toVar( 'normalFlat' );\n\nconst normalView = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\tlet node;\n\n\tif ( builder.material.flatShading === true ) {\n\n\t\tnode = normalFlat;\n\n\t} else {\n\n\t\tnode = varying( transformNormalToView( normalLocal ), 'v_normalView' ).normalize();\n\n\t}\n\n\treturn node;\n\n}, 'vec3' ).once() )().toVar( 'normalView' );\n\nconst normalWorld = /*@__PURE__*/ varying( normalView.transformDirection( cameraViewMatrix ), 'v_normalWorld' ).normalize().toVar( 'normalWorld' );\n\nconst transformedNormalView = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\treturn builder.context.setupNormal();\n\n}, 'vec3' ).once() )().mul( faceDirection ).toVar( 'transformedNormalView' );\n\n\nconst transformedNormalWorld = /*@__PURE__*/ transformedNormalView.transformDirection( cameraViewMatrix ).toVar( 'transformedNormalWorld' );\n\nconst transformedClearcoatNormalView = /*@__PURE__*/ ( Fn( ( builder ) => {\n\n\treturn builder.context.setupClearcoatNormal();\n\n}, 'vec3' ).once() )().mul( faceDirection ).toVar( 'transformedClearcoatNormalView' );\n\nconst transformNormal = /*@__PURE__*/ Fn( ( [ normal, matrix = modelWorldMatrix ] ) => {\n\n\tconst m = mat3( matrix );\n\n\tconst transformedNormal = normal.div( vec3( m[ 0 ].dot( m[ 0 ] ), m[ 1 ].dot( m[ 1 ] ), m[ 2 ].dot( m[ 2 ] ) ) );\n\n\treturn m.mul( transformedNormal ).xyz;\n\n} );\n\nconst transformNormalToView = /*@__PURE__*/ Fn( ( [ normal ], builder ) => {\n\n\tconst modelNormalViewMatrix = builder.renderer.nodes.modelNormalViewMatrix;\n\n\tif ( modelNormalViewMatrix !== null ) {\n\n\t\treturn modelNormalViewMatrix.transformDirection( normal );\n\n\t}\n\n\t//\n\n\tconst transformedNormal = modelNormalMatrix.mul( normal );\n\n\treturn cameraViewMatrix.transformDirection( transformedNormal );\n\n} );\n\nconst materialRefractionRatio = /*@__PURE__*/ uniform( 0 ).onReference( ( { material } ) => material ).onRenderUpdate( ( { material } ) => material.refractionRatio );\n\nconst reflectView = /*@__PURE__*/ positionViewDirection.negate().reflect( transformedNormalView );\nconst refractView = /*@__PURE__*/ positionViewDirection.negate().refract( transformedNormalView, materialRefractionRatio );\n\nconst reflectVector = /*@__PURE__*/ reflectView.transformDirection( cameraViewMatrix ).toVar( 'reflectVector' );\nconst refractVector = /*@__PURE__*/ refractView.transformDirection( cameraViewMatrix ).toVar( 'reflectVector' );\n\nclass CubeTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'CubeTextureNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null, biasNode = null ) {\n\n\t\tsuper( value, uvNode, levelNode, biasNode );\n\n\t\tthis.isCubeTextureNode = true;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'cubeTexture';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\tconst texture = this.value;\n\n\t\tif ( texture.mapping === CubeReflectionMapping ) {\n\n\t\t\treturn reflectVector;\n\n\t\t} else if ( texture.mapping === CubeRefractionMapping ) {\n\n\t\t\treturn refractVector;\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.CubeTextureNode: Mapping \"%s\" not supported.', texture.mapping );\n\n\t\t\treturn vec3( 0, 0, 0 );\n\n\t\t}\n\n\t}\n\n\tsetUpdateMatrix( /*updateMatrix*/ ) { } // Ignore .updateMatrix for CubeTextureNode\n\n\tsetupUV( builder, uvNode ) {\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.renderer.coordinateSystem === WebGPUCoordinateSystem || ! texture.isRenderTargetTexture ) {\n\n\t\t\treturn vec3( uvNode.x.negate(), uvNode.yz );\n\n\t\t} else {\n\n\t\t\treturn uvNode;\n\n\t\t}\n\n\t}\n\n\tgenerateUV( builder, cubeUV ) {\n\n\t\treturn cubeUV.build( builder, 'vec3' );\n\n\t}\n\n}\n\nconst cubeTexture = /*@__PURE__*/ nodeProxy( CubeTextureNode );\n\nclass BufferNode extends UniformNode {\n\n\tstatic get type() {\n\n\t\treturn 'BufferNode';\n\n\t}\n\n\tconstructor( value, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( value, bufferType );\n\n\t\tthis.isBufferNode = true;\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferCount = bufferCount;\n\n\t}\n\n\tgetElementType( builder ) {\n\n\t\treturn this.getNodeType( builder );\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'buffer';\n\n\t}\n\n}\n\nconst buffer = ( value, type, count ) => nodeObject( new BufferNode( value, type, count ) );\n\nclass UniformArrayElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'UniformArrayElementNode';\n\n\t}\n\n\tconstructor( arrayBuffer, indexNode ) {\n\n\t\tsuper( arrayBuffer, indexNode );\n\n\t\tthis.isArrayBufferElementNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst type = this.getNodeType();\n\n\t\treturn builder.format( snippet, 'vec4', type );\n\n\t}\n\n}\n\nclass UniformArrayNode extends BufferNode {\n\n\tstatic get type() {\n\n\t\treturn 'UniformArrayNode';\n\n\t}\n\n\tconstructor( value, elementType = null ) {\n\n\t\tsuper( null, 'vec4' );\n\n\t\tthis.array = value;\n\t\tthis.elementType = elementType;\n\n\t\tthis._elementType = null;\n\t\tthis._elementLength = 0;\n\n\t\tthis.updateType = NodeUpdateType.RENDER;\n\n\t\tthis.isArrayBufferNode = true;\n\n\t}\n\n\tgetElementType() {\n\n\t\treturn this.elementType || this._elementType;\n\n\t}\n\n\tgetElementLength() {\n\n\t\treturn this._elementLength;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconst { array, value } = this;\n\n\t\tconst elementLength = this.getElementLength();\n\t\tconst elementType = this.getElementType();\n\n\t\tif ( elementLength === 1 ) {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\n\t\t\t\tvalue[ index ] = array[ i ];\n\n\t\t\t}\n\n\t\t} else if ( elementType === 'color' ) {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\t\t\t\tconst vector = array[ i ];\n\n\t\t\t\tvalue[ index ] = vector.r;\n\t\t\t\tvalue[ index + 1 ] = vector.g;\n\t\t\t\tvalue[ index + 2 ] = vector.b || 0;\n\t\t\t\t//value[ index + 3 ] = vector.a || 0;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\tconst index = i * 4;\n\t\t\t\tconst vector = array[ i ];\n\n\t\t\t\tvalue[ index ] = vector.x;\n\t\t\t\tvalue[ index + 1 ] = vector.y;\n\t\t\t\tvalue[ index + 2 ] = vector.z || 0;\n\t\t\t\tvalue[ index + 3 ] = vector.w || 0;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst length = this.array.length;\n\n\t\tthis._elementType = this.elementType === null ? getValueType( this.array[ 0 ] ) : this.elementType;\n\t\tthis._elementLength = builder.getTypeLength( this._elementType );\n\n\t\tlet arrayType = Float32Array;\n\n\t\tif ( this._elementType.charAt( 0 ) === 'i' ) arrayType = Int32Array;\n\t\telse if ( this._elementType.charAt( 0 ) === 'u' ) arrayType = Uint32Array;\n\n\t\tthis.value = new arrayType( length * 4 );\n\t\tthis.bufferCount = length;\n\t\tthis.bufferType = builder.changeComponentType( 'vec4', builder.getComponentType( this._elementType ) );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new UniformArrayElementNode( this, nodeObject( indexNode ) ) );\n\n\t}\n\n}\n\nconst uniformArray = ( values, nodeType ) => nodeObject( new UniformArrayNode( values, nodeType ) );\n\n//\n\nconst uniforms = ( values, nodeType ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.UniformArrayNode: uniforms() has been renamed to uniformArray().' );\n\treturn nodeObject( new UniformArrayNode( values, nodeType ) );\n\n};\n\nclass ReferenceElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceElementNode';\n\n\t}\n\n\tconstructor( referenceNode, indexNode ) {\n\n\t\tsuper( referenceNode, indexNode );\n\n\t\tthis.referenceNode = referenceNode;\n\n\t\tthis.isReferenceElementNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.referenceNode.uniformType;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst snippet = super.generate( builder );\n\t\tconst arrayType = this.referenceNode.getNodeType();\n\t\tconst elementType = this.getNodeType();\n\n\t\treturn builder.format( snippet, arrayType, elementType );\n\n\t}\n\n}\n\n// TODO: Extends this from ReferenceBaseNode\nclass ReferenceNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ReferenceNode';\n\n\t}\n\n\tconstructor( property, uniformType, object = null, count = null ) {\n\n\t\tsuper();\n\n\t\tthis.property = property;\n\t\tthis.uniformType = uniformType;\n\t\tthis.object = object;\n\t\tthis.count = count;\n\n\t\tthis.properties = property.split( '.' );\n\t\tthis.reference = object;\n\t\tthis.node = null;\n\t\tthis.group = null;\n\t\tthis.name = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new ReferenceElementNode( this, nodeObject( indexNode ) ) );\n\n\t}\n\n\tsetGroup( group ) {\n\n\t\tthis.group = group;\n\n\t\treturn this;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tsetNodeType( uniformType ) {\n\n\t\tlet node = null;\n\n\t\tif ( this.count !== null ) {\n\n\t\t\tnode = buffer( null, uniformType, this.count );\n\n\t\t} else if ( Array.isArray( this.getValueFromReference() ) ) {\n\n\t\t\tnode = uniformArray( null, uniformType );\n\n\t\t} else if ( uniformType === 'texture' ) {\n\n\t\t\tnode = texture( null );\n\n\t\t} else if ( uniformType === 'cubeTexture' ) {\n\n\t\t\tnode = cubeTexture( null );\n\n\t\t} else {\n\n\t\t\tnode = uniform( null, uniformType );\n\n\t\t}\n\n\t\tif ( this.group !== null ) {\n\n\t\t\tnode.setGroup( this.group );\n\n\t\t}\n\n\t\tif ( this.name !== null ) node.label( this.name );\n\n\t\tthis.node = node.getSelf();\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( this.node === null ) {\n\n\t\t\tthis.updateReference( builder );\n\t\t\tthis.updateValue();\n\n\t\t}\n\n\t\treturn this.node.getNodeType( builder );\n\n\t}\n\n\tgetValueFromReference( object = this.reference ) {\n\n\t\tconst { properties } = this;\n\n\t\tlet value = object[ properties[ 0 ] ];\n\n\t\tfor ( let i = 1; i < properties.length; i ++ ) {\n\n\t\t\tvalue = value[ properties[ i ] ];\n\n\t\t}\n\n\t\treturn value;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.object !== null ? this.object : state.object;\n\n\t\treturn this.reference;\n\n\t}\n\n\tsetup() {\n\n\t\tthis.updateValue();\n\n\t\treturn this.node;\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tthis.updateValue();\n\n\t}\n\n\tupdateValue() {\n\n\t\tif ( this.node === null ) this.setNodeType( this.uniformType );\n\n\t\tconst value = this.getValueFromReference();\n\n\t\tif ( Array.isArray( value ) ) {\n\n\t\t\tthis.node.array = value;\n\n\t\t} else {\n\n\t\t\tthis.node.value = value;\n\n\t\t}\n\n\t}\n\n}\n\nconst reference = ( name, type, object ) => nodeObject( new ReferenceNode( name, type, object ) );\nconst referenceBuffer = ( name, type, count, object ) => nodeObject( new ReferenceNode( name, type, object, count ) );\n\nclass MaterialReferenceNode extends ReferenceNode {\n\n\tstatic get type() {\n\n\t\treturn 'MaterialReferenceNode';\n\n\t}\n\n\tconstructor( property, inputType, material = null ) {\n\n\t\tsuper( property, inputType, material );\n\n\t\tthis.material = material;\n\n\t\t//this.updateType = NodeUpdateType.RENDER;\n\n\t\tthis.isMaterialReferenceNode = true;\n\n\t}\n\n\t/*setNodeType( node ) {\n\n\t\tsuper.setNodeType( node );\n\n\t\tthis.node.groupNode = renderGroup;\n\n\t}*/\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.material !== null ? this.material : state.material;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nconst materialReference = ( name, type, material ) => nodeObject( new MaterialReferenceNode( name, type, material ) );\n\nconst tangentGeometry = /*@__PURE__*/ Fn( ( builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'tangent' ) === false ) {\n\n\t\tbuilder.geometry.computeTangents();\n\n\t}\n\n\treturn attribute( 'tangent', 'vec4' );\n\n} )();\n\nconst tangentLocal = /*@__PURE__*/ tangentGeometry.xyz.toVar( 'tangentLocal' );\nconst tangentView = /*@__PURE__*/ modelViewMatrix.mul( vec4( tangentLocal, 0 ) ).xyz.varying( 'v_tangentView' ).normalize().toVar( 'tangentView' );\nconst tangentWorld = /*@__PURE__*/ tangentView.transformDirection( cameraViewMatrix ).varying( 'v_tangentWorld' ).normalize().toVar( 'tangentWorld' );\nconst transformedTangentView = /*@__PURE__*/ tangentView.toVar( 'transformedTangentView' );\nconst transformedTangentWorld = /*@__PURE__*/ transformedTangentView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedTangentWorld' );\n\nconst getBitangent = ( crossNormalTangent ) => crossNormalTangent.mul( tangentGeometry.w ).xyz;\n\nconst bitangentGeometry = /*@__PURE__*/ varying( getBitangent( normalGeometry.cross( tangentGeometry ) ), 'v_bitangentGeometry' ).normalize().toVar( 'bitangentGeometry' );\nconst bitangentLocal = /*@__PURE__*/ varying( getBitangent( normalLocal.cross( tangentLocal ) ), 'v_bitangentLocal' ).normalize().toVar( 'bitangentLocal' );\nconst bitangentView = /*@__PURE__*/ varying( getBitangent( normalView.cross( tangentView ) ), 'v_bitangentView' ).normalize().toVar( 'bitangentView' );\nconst bitangentWorld = /*@__PURE__*/ varying( getBitangent( normalWorld.cross( tangentWorld ) ), 'v_bitangentWorld' ).normalize().toVar( 'bitangentWorld' );\nconst transformedBitangentView = /*@__PURE__*/ getBitangent( transformedNormalView.cross( transformedTangentView ) ).normalize().toVar( 'transformedBitangentView' );\nconst transformedBitangentWorld = /*@__PURE__*/ transformedBitangentView.transformDirection( cameraViewMatrix ).normalize().toVar( 'transformedBitangentWorld' );\n\nconst TBNViewMatrix = /*@__PURE__*/ mat3( tangentView, bitangentView, normalView );\n\nconst parallaxDirection = /*@__PURE__*/ positionViewDirection.mul( TBNViewMatrix )/*.normalize()*/;\nconst parallaxUV = ( uv, scale ) => uv.sub( parallaxDirection.mul( scale ) );\n\nconst transformedBentNormalView = /*@__PURE__*/ ( () => {\n\n\t// https://google.github.io/filament/Filament.md.html#lighting/imagebasedlights/anisotropy\n\n\tlet bentNormal = anisotropyB.cross( positionViewDirection );\n\tbentNormal = bentNormal.cross( anisotropyB ).normalize();\n\tbentNormal = mix( bentNormal, transformedNormalView, anisotropy.mul( roughness.oneMinus() ).oneMinus().pow2().pow2() ).normalize();\n\n\treturn bentNormal;\n\n\n} )();\n\n// Normal Mapping Without Precomputed Tangents\n// http://www.thetenthplanet.de/archives/1180\n\nconst perturbNormal2Arb = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { eye_pos, surf_norm, mapN, uv } = inputs;\n\n\tconst q0 = eye_pos.dFdx();\n\tconst q1 = eye_pos.dFdy();\n\tconst st0 = uv.dFdx();\n\tconst st1 = uv.dFdy();\n\n\tconst N = surf_norm; // normalized\n\n\tconst q1perp = q1.cross( N );\n\tconst q0perp = N.cross( q0 );\n\n\tconst T = q1perp.mul( st0.x ).add( q0perp.mul( st1.x ) );\n\tconst B = q1perp.mul( st0.y ).add( q0perp.mul( st1.y ) );\n\n\tconst det = T.dot( T ).max( B.dot( B ) );\n\tconst scale = faceDirection.mul( det.inverseSqrt() );\n\n\treturn add( T.mul( mapN.x, scale ), B.mul( mapN.y, scale ), N.mul( mapN.z ) ).normalize();\n\n} );\n\nclass NormalMapNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'NormalMapNode';\n\n\t}\n\n\tconstructor( node, scaleNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.node = node;\n\t\tthis.scaleNode = scaleNode;\n\n\t\tthis.normalMapType = TangentSpaceNormalMap;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { normalMapType, scaleNode } = this;\n\n\t\tlet normalMap = this.node.mul( 2.0 ).sub( 1.0 );\n\n\t\tif ( scaleNode !== null ) {\n\n\t\t\tnormalMap = vec3( normalMap.xy.mul( scaleNode ), normalMap.z );\n\n\t\t}\n\n\t\tlet outputNode = null;\n\n\t\tif ( normalMapType === ObjectSpaceNormalMap ) {\n\n\t\t\toutputNode = transformNormalToView( normalMap );\n\n\t\t} else if ( normalMapType === TangentSpaceNormalMap ) {\n\n\t\t\tconst tangent = builder.hasGeometryAttribute( 'tangent' );\n\n\t\t\tif ( tangent === true ) {\n\n\t\t\t\toutputNode = TBNViewMatrix.mul( normalMap ).normalize();\n\n\t\t\t} else {\n\n\t\t\t\toutputNode = perturbNormal2Arb( {\n\t\t\t\t\teye_pos: positionView,\n\t\t\t\t\tsurf_norm: normalView,\n\t\t\t\t\tmapN: normalMap,\n\t\t\t\t\tuv: uv()\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n}\n\nconst normalMap = /*@__PURE__*/ nodeProxy( NormalMapNode );\n\n// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n// https://mmikk.github.io/papers3d/mm_sfgrad_bump.pdf\n\nconst dHdxy_fwd = Fn( ( { textureNode, bumpScale } ) => {\n\n\t// It's used to preserve the same TextureNode instance\n\tconst sampleTexture = ( callback ) => textureNode.cache().context( { getUV: ( texNode ) => callback( texNode.uvNode || uv() ), forceUVContext: true } );\n\n\tconst Hll = float( sampleTexture( ( uvNode ) => uvNode ) );\n\n\treturn vec2(\n\t\tfloat( sampleTexture( ( uvNode ) => uvNode.add( uvNode.dFdx() ) ) ).sub( Hll ),\n\t\tfloat( sampleTexture( ( uvNode ) => uvNode.add( uvNode.dFdy() ) ) ).sub( Hll )\n\t).mul( bumpScale );\n\n} );\n\n// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\nconst perturbNormalArb = Fn( ( inputs ) => {\n\n\tconst { surf_pos, surf_norm, dHdxy } = inputs;\n\n\t// normalize is done to ensure that the bump map looks the same regardless of the texture's scale\n\tconst vSigmaX = surf_pos.dFdx().normalize();\n\tconst vSigmaY = surf_pos.dFdy().normalize();\n\tconst vN = surf_norm; // normalized\n\n\tconst R1 = vSigmaY.cross( vN );\n\tconst R2 = vN.cross( vSigmaX );\n\n\tconst fDet = vSigmaX.dot( R1 ).mul( faceDirection );\n\n\tconst vGrad = fDet.sign().mul( dHdxy.x.mul( R1 ).add( dHdxy.y.mul( R2 ) ) );\n\n\treturn fDet.abs().mul( surf_norm ).sub( vGrad ).normalize();\n\n} );\n\nclass BumpMapNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'BumpMapNode';\n\n\t}\n\n\tconstructor( textureNode, scaleNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.scaleNode = scaleNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst bumpScale = this.scaleNode !== null ? this.scaleNode : 1;\n\t\tconst dHdxy = dHdxy_fwd( { textureNode: this.textureNode, bumpScale } );\n\n\t\treturn perturbNormalArb( {\n\t\t\tsurf_pos: positionView,\n\t\t\tsurf_norm: normalView,\n\t\t\tdHdxy\n\t\t} );\n\n\t}\n\n}\n\nconst bumpMap = /*@__PURE__*/ nodeProxy( BumpMapNode );\n\nconst _propertyCache = new Map();\n\nclass MaterialNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'MaterialNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tgetCache( property, type ) {\n\n\t\tlet node = _propertyCache.get( property );\n\n\t\tif ( node === undefined ) {\n\n\t\t\tnode = materialReference( property, type );\n\n\t\t\t_propertyCache.set( property, node );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tgetFloat( property ) {\n\n\t\treturn this.getCache( property, 'float' );\n\n\t}\n\n\tgetColor( property ) {\n\n\t\treturn this.getCache( property, 'color' );\n\n\t}\n\n\tgetTexture( property ) {\n\n\t\treturn this.getCache( property === 'map' ? 'map' : property + 'Map', 'texture' );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst material = builder.context.material;\n\t\tconst scope = this.scope;\n\n\t\tlet node = null;\n\n\t\tif ( scope === MaterialNode.COLOR ) {\n\n\t\t\tconst colorNode = material.color !== undefined ? this.getColor( scope ) : vec3();\n\n\t\t\tif ( material.map && material.map.isTexture === true ) {\n\n\t\t\t\tnode = colorNode.mul( this.getTexture( 'map' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = colorNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.OPACITY ) {\n\n\t\t\tconst opacityNode = this.getFloat( scope );\n\n\t\t\tif ( material.alphaMap && material.alphaMap.isTexture === true ) {\n\n\t\t\t\tnode = opacityNode.mul( this.getTexture( 'alpha' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = opacityNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_STRENGTH ) {\n\n\t\t\tif ( material.specularMap && material.specularMap.isTexture === true ) {\n\n\t\t\t\tnode = this.getTexture( 'specular' ).r;\n\n\t\t\t} else {\n\n\t\t\t\tnode = float( 1 );\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_INTENSITY ) {\n\n\t\t\tconst specularIntensity = this.getFloat( scope );\n\n\t\t\tif ( material.specularMap ) {\n\n\t\t\t\tnode = specularIntensity.mul( this.getTexture( scope ).a );\n\n\t\t\t} else {\n\n\t\t\t\tnode = specularIntensity;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SPECULAR_COLOR ) {\n\n\t\t\tconst specularColorNode = this.getColor( scope );\n\n\t\t\tif ( material.specularColorMap && material.specularColorMap.isTexture === true ) {\n\n\t\t\t\tnode = specularColorNode.mul( this.getTexture( scope ).rgb );\n\n\t\t\t} else {\n\n\t\t\t\tnode = specularColorNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.ROUGHNESS ) { // TODO: cleanup similar branches\n\n\t\t\tconst roughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.roughnessMap && material.roughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = roughnessNode.mul( this.getTexture( scope ).g );\n\n\t\t\t} else {\n\n\t\t\t\tnode = roughnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.METALNESS ) {\n\n\t\t\tconst metalnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.metalnessMap && material.metalnessMap.isTexture === true ) {\n\n\t\t\t\tnode = metalnessNode.mul( this.getTexture( scope ).b );\n\n\t\t\t} else {\n\n\t\t\t\tnode = metalnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.EMISSIVE ) {\n\n\t\t\tconst emissiveIntensityNode = this.getFloat( 'emissiveIntensity' );\n\t\t\tconst emissiveNode = this.getColor( scope ).mul( emissiveIntensityNode );\n\n\t\t\tif ( material.emissiveMap && material.emissiveMap.isTexture === true ) {\n\n\t\t\t\tnode = emissiveNode.mul( this.getTexture( scope ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = emissiveNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.NORMAL ) {\n\n\t\t\tif ( material.normalMap ) {\n\n\t\t\t\tnode = normalMap( this.getTexture( 'normal' ), this.getCache( 'normalScale', 'vec2' ) );\n\t\t\t\tnode.normalMapType = material.normalMapType;\n\n\t\t\t} else if ( material.bumpMap ) {\n\n\t\t\t\tnode = bumpMap( this.getTexture( 'bump' ).r, this.getFloat( 'bumpScale' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = normalView;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT ) {\n\n\t\t\tconst clearcoatNode = this.getFloat( scope );\n\n\t\t\tif ( material.clearcoatMap && material.clearcoatMap.isTexture === true ) {\n\n\t\t\t\tnode = clearcoatNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = clearcoatNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT_ROUGHNESS ) {\n\n\t\t\tconst clearcoatRoughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.clearcoatRoughnessMap && material.clearcoatRoughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = clearcoatRoughnessNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = clearcoatRoughnessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.CLEARCOAT_NORMAL ) {\n\n\t\t\tif ( material.clearcoatNormalMap ) {\n\n\t\t\t\tnode = normalMap( this.getTexture( scope ), this.getCache( scope + 'Scale', 'vec2' ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = normalView;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SHEEN ) {\n\n\t\t\tconst sheenNode = this.getColor( 'sheenColor' ).mul( this.getFloat( 'sheen' ) ); // Move this mul() to CPU\n\n\t\t\tif ( material.sheenColorMap && material.sheenColorMap.isTexture === true ) {\n\n\t\t\t\tnode = sheenNode.mul( this.getTexture( 'sheenColor' ).rgb );\n\n\t\t\t} else {\n\n\t\t\t\tnode = sheenNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.SHEEN_ROUGHNESS ) {\n\n\t\t\tconst sheenRoughnessNode = this.getFloat( scope );\n\n\t\t\tif ( material.sheenRoughnessMap && material.sheenRoughnessMap.isTexture === true ) {\n\n\t\t\t\tnode = sheenRoughnessNode.mul( this.getTexture( scope ).a );\n\n\t\t\t} else {\n\n\t\t\t\tnode = sheenRoughnessNode;\n\n\t\t\t}\n\n\t\t\tnode = node.clamp( 0.07, 1.0 );\n\n\t\t} else if ( scope === MaterialNode.ANISOTROPY ) {\n\n\t\t\tif ( material.anisotropyMap && material.anisotropyMap.isTexture === true ) {\n\n\t\t\t\tconst anisotropyPolar = this.getTexture( scope );\n\t\t\t\tconst anisotropyMat = mat2( materialAnisotropyVector.x, materialAnisotropyVector.y, materialAnisotropyVector.y.negate(), materialAnisotropyVector.x );\n\n\t\t\t\tnode = anisotropyMat.mul( anisotropyPolar.rg.mul( 2.0 ).sub( vec2( 1.0 ) ).normalize().mul( anisotropyPolar.b ) );\n\n\t\t\t} else {\n\n\t\t\t\tnode = materialAnisotropyVector;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.IRIDESCENCE_THICKNESS ) {\n\n\t\t\tconst iridescenceThicknessMaximum = reference( '1', 'float', material.iridescenceThicknessRange );\n\n\t\t\tif ( material.iridescenceThicknessMap ) {\n\n\t\t\t\tconst iridescenceThicknessMinimum = reference( '0', 'float', material.iridescenceThicknessRange );\n\n\t\t\t\tnode = iridescenceThicknessMaximum.sub( iridescenceThicknessMinimum ).mul( this.getTexture( scope ).g ).add( iridescenceThicknessMinimum );\n\n\t\t\t} else {\n\n\t\t\t\tnode = iridescenceThicknessMaximum;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.TRANSMISSION ) {\n\n\t\t\tconst transmissionNode = this.getFloat( scope );\n\n\t\t\tif ( material.transmissionMap ) {\n\n\t\t\t\tnode = transmissionNode.mul( this.getTexture( scope ).r );\n\n\t\t\t} else {\n\n\t\t\t\tnode = transmissionNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.THICKNESS ) {\n\n\t\t\tconst thicknessNode = this.getFloat( scope );\n\n\t\t\tif ( material.thicknessMap ) {\n\n\t\t\t\tnode = thicknessNode.mul( this.getTexture( scope ).g );\n\n\t\t\t} else {\n\n\t\t\t\tnode = thicknessNode;\n\n\t\t\t}\n\n\t\t} else if ( scope === MaterialNode.IOR ) {\n\n\t\t\tnode = this.getFloat( scope );\n\n\t\t} else if ( scope === MaterialNode.LIGHT_MAP ) {\n\n\t\t\tnode = this.getTexture( scope ).rgb.mul( this.getFloat( 'lightMapIntensity' ) );\n\n\t\t} else if ( scope === MaterialNode.AO_MAP ) {\n\n\t\t\tnode = this.getTexture( scope ).r.sub( 1.0 ).mul( this.getFloat( 'aoMapIntensity' ) ).add( 1.0 );\n\n\t\t} else {\n\n\t\t\tconst outputType = this.getNodeType( builder );\n\n\t\t\tnode = this.getCache( scope, outputType );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nMaterialNode.ALPHA_TEST = 'alphaTest';\nMaterialNode.COLOR = 'color';\nMaterialNode.OPACITY = 'opacity';\nMaterialNode.SHININESS = 'shininess';\nMaterialNode.SPECULAR = 'specular';\nMaterialNode.SPECULAR_STRENGTH = 'specularStrength';\nMaterialNode.SPECULAR_INTENSITY = 'specularIntensity';\nMaterialNode.SPECULAR_COLOR = 'specularColor';\nMaterialNode.REFLECTIVITY = 'reflectivity';\nMaterialNode.ROUGHNESS = 'roughness';\nMaterialNode.METALNESS = 'metalness';\nMaterialNode.NORMAL = 'normal';\nMaterialNode.CLEARCOAT = 'clearcoat';\nMaterialNode.CLEARCOAT_ROUGHNESS = 'clearcoatRoughness';\nMaterialNode.CLEARCOAT_NORMAL = 'clearcoatNormal';\nMaterialNode.EMISSIVE = 'emissive';\nMaterialNode.ROTATION = 'rotation';\nMaterialNode.SHEEN = 'sheen';\nMaterialNode.SHEEN_ROUGHNESS = 'sheenRoughness';\nMaterialNode.ANISOTROPY = 'anisotropy';\nMaterialNode.IRIDESCENCE = 'iridescence';\nMaterialNode.IRIDESCENCE_IOR = 'iridescenceIOR';\nMaterialNode.IRIDESCENCE_THICKNESS = 'iridescenceThickness';\nMaterialNode.IOR = 'ior';\nMaterialNode.TRANSMISSION = 'transmission';\nMaterialNode.THICKNESS = 'thickness';\nMaterialNode.ATTENUATION_DISTANCE = 'attenuationDistance';\nMaterialNode.ATTENUATION_COLOR = 'attenuationColor';\nMaterialNode.LINE_SCALE = 'scale';\nMaterialNode.LINE_DASH_SIZE = 'dashSize';\nMaterialNode.LINE_GAP_SIZE = 'gapSize';\nMaterialNode.LINE_WIDTH = 'linewidth';\nMaterialNode.LINE_DASH_OFFSET = 'dashOffset';\nMaterialNode.POINT_WIDTH = 'pointWidth';\nMaterialNode.DISPERSION = 'dispersion';\nMaterialNode.LIGHT_MAP = 'light';\nMaterialNode.AO_MAP = 'ao';\n\nconst materialAlphaTest = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ALPHA_TEST );\nconst materialColor = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.COLOR );\nconst materialShininess = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SHININESS );\nconst materialEmissive = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.EMISSIVE );\nconst materialOpacity = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.OPACITY );\nconst materialSpecular = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR );\n\nconst materialSpecularIntensity = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR_INTENSITY );\nconst materialSpecularColor = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR_COLOR );\n\nconst materialSpecularStrength = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SPECULAR_STRENGTH );\nconst materialReflectivity = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.REFLECTIVITY );\nconst materialRoughness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ROUGHNESS );\nconst materialMetalness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.METALNESS );\nconst materialNormal = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.NORMAL ).context( { getUV: null } );\nconst materialClearcoat = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT );\nconst materialClearcoatRoughness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT_ROUGHNESS );\nconst materialClearcoatNormal = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.CLEARCOAT_NORMAL ).context( { getUV: null } );\nconst materialRotation = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ROTATION );\nconst materialSheen = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SHEEN );\nconst materialSheenRoughness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.SHEEN_ROUGHNESS );\nconst materialAnisotropy = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ANISOTROPY );\nconst materialIridescence = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE );\nconst materialIridescenceIOR = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE_IOR );\nconst materialIridescenceThickness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IRIDESCENCE_THICKNESS );\nconst materialTransmission = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.TRANSMISSION );\nconst materialThickness = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.THICKNESS );\nconst materialIOR = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.IOR );\nconst materialAttenuationDistance = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ATTENUATION_DISTANCE );\nconst materialAttenuationColor = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.ATTENUATION_COLOR );\nconst materialLineScale = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_SCALE );\nconst materialLineDashSize = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_DASH_SIZE );\nconst materialLineGapSize = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_GAP_SIZE );\nconst materialLineWidth = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_WIDTH );\nconst materialLineDashOffset = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LINE_DASH_OFFSET );\nconst materialPointWidth = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.POINT_WIDTH );\nconst materialDispersion = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.DISPERSION );\nconst materialLightMap = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.LIGHT_MAP );\nconst materialAOMap = /*@__PURE__*/ nodeImmutable( MaterialNode, MaterialNode.AO_MAP );\nconst materialAnisotropyVector = /*@__PURE__*/ uniform( new Vector2() ).onReference( function ( frame ) {\n\n\treturn frame.material;\n\n} ).onRenderUpdate( function ( { material } ) {\n\n\tthis.value.set( material.anisotropy * Math.cos( material.anisotropyRotation ), material.anisotropy * Math.sin( material.anisotropyRotation ) );\n\n} );\n\nclass ModelViewProjectionNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'ModelViewProjectionNode';\n\n\t}\n\n\tconstructor( positionNode = null ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.positionNode = positionNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.shaderStage === 'fragment' ) {\n\n\t\t\treturn varying( builder.context.mvp );\n\n\t\t}\n\n\t\tconst position = this.positionNode || positionLocal;\n\t\tconst viewMatrix = builder.renderer.nodes.modelViewMatrix || modelViewMatrix;\n\n\t\treturn cameraProjectionMatrix.mul( viewMatrix ).mul( position );\n\n\t}\n\n}\n\nconst modelViewProjection = /*@__PURE__*/ nodeProxy( ModelViewProjectionNode );\n\nclass IndexNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'IndexNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper( 'uint' );\n\n\t\tthis.scope = scope;\n\n\t\tthis.isInstanceIndexNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst nodeType = this.getNodeType( builder );\n\t\tconst scope = this.scope;\n\n\t\tlet propertyName;\n\n\t\tif ( scope === IndexNode.VERTEX ) {\n\n\t\t\t// The index of a vertex within a mesh.\n\t\t\tpropertyName = builder.getVertexIndex();\n\n\t\t} else if ( scope === IndexNode.INSTANCE ) {\n\n\t\t\t// The index of either a mesh instance or an invocation of a compute shader.\n\t\t\tpropertyName = builder.getInstanceIndex();\n\n\t\t} else if ( scope === IndexNode.DRAW ) {\n\n\t\t\t// The index of a draw call.\n\t\t\tpropertyName = builder.getDrawIndex();\n\n\t\t} else if ( scope === IndexNode.INVOCATION_LOCAL ) {\n\n\t\t\t// The index of a compute invocation within the scope of a workgroup load.\n\t\t\tpropertyName = builder.getInvocationLocalIndex();\n\n\t\t} else if ( scope === IndexNode.INVOCATION_SUBGROUP ) {\n\n\t\t\t// The index of a compute invocation within the scope of a subgroup.\n\t\t\tpropertyName = builder.getInvocationSubgroupIndex();\n\n\t\t} else if ( scope === IndexNode.SUBGROUP ) {\n\n\t\t\t// The index of the subgroup the current compute invocation belongs to.\n\t\t\tpropertyName = builder.getSubgroupIndex();\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.IndexNode: Unknown scope: ' + scope );\n\n\t\t}\n\n\t\tlet output;\n\n\t\tif ( builder.shaderStage === 'vertex' || builder.shaderStage === 'compute' ) {\n\n\t\t\toutput = propertyName;\n\n\t\t} else {\n\n\t\t\tconst nodeVarying = varying( this );\n\n\t\t\toutput = nodeVarying.build( builder, nodeType );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nIndexNode.VERTEX = 'vertex';\nIndexNode.INSTANCE = 'instance';\nIndexNode.SUBGROUP = 'subgroup';\nIndexNode.INVOCATION_LOCAL = 'invocationLocal';\nIndexNode.INVOCATION_SUBGROUP = 'invocationSubgroup';\nIndexNode.DRAW = 'draw';\n\nconst vertexIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.VERTEX );\nconst instanceIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.INSTANCE );\nconst subgroupIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.SUBGROUP );\nconst invocationSubgroupIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.INVOCATION_SUBGROUP );\nconst invocationLocalIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.INVOCATION_LOCAL );\nconst drawIndex = /*@__PURE__*/ nodeImmutable( IndexNode, IndexNode.DRAW );\n\nclass InstanceNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'InstanceNode';\n\n\t}\n\n\tconstructor( instanceMesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.instanceMesh = instanceMesh;\n\n\t\tthis.instanceMatrixNode = null;\n\n\t\tthis.instanceColorNode = null;\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t\tthis.buffer = null;\n\t\tthis.bufferColor = null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tlet instanceMatrixNode = this.instanceMatrixNode;\n\t\tlet instanceColorNode = this.instanceColorNode;\n\n\t\tconst instanceMesh = this.instanceMesh;\n\n\t\tif ( instanceMatrixNode === null ) {\n\n\t\t\tconst instanceAttribute = instanceMesh.instanceMatrix;\n\n\t\t\t// Both WebGPU and WebGL backends have UBO max limited to 64kb. Matrix count number bigger than 1000 ( 16 * 4 * 1000 = 64kb ) will fallback to attribute.\n\n\t\t\tif ( instanceMesh.count <= 1000 ) {\n\n\t\t\t\tinstanceMatrixNode = buffer( instanceAttribute.array, 'mat4', Math.max( instanceMesh.count, 1 ) ).element( instanceIndex );\n\n\t\t\t} else {\n\n\t\t\t\tconst buffer = new InstancedInterleavedBuffer( instanceAttribute.array, 16, 1 );\n\n\t\t\t\tthis.buffer = buffer;\n\n\t\t\t\tconst bufferFn = instanceAttribute.usage === DynamicDrawUsage ? instancedDynamicBufferAttribute : instancedBufferAttribute;\n\n\t\t\t\tconst instanceBuffers = [\n\t\t\t\t\t// F.Signature -> bufferAttribute( array, type, stride, offset )\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 0 ),\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 4 ),\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 8 ),\n\t\t\t\t\tbufferFn( buffer, 'vec4', 16, 12 )\n\t\t\t\t];\n\n\t\t\t\tinstanceMatrixNode = mat4( ...instanceBuffers );\n\n\t\t\t}\n\n\t\t\tthis.instanceMatrixNode = instanceMatrixNode;\n\n\t\t}\n\n\t\tconst instanceColorAttribute = instanceMesh.instanceColor;\n\n\t\tif ( instanceColorAttribute && instanceColorNode === null ) {\n\n\t\t\tconst buffer = new InstancedBufferAttribute( instanceColorAttribute.array, 3 );\n\n\t\t\tconst bufferFn = instanceColorAttribute.usage === DynamicDrawUsage ? instancedDynamicBufferAttribute : instancedBufferAttribute;\n\n\t\t\tthis.bufferColor = buffer;\n\n\t\t\tinstanceColorNode = vec3( bufferFn( buffer, 'vec3', 3, 0 ) );\n\n\t\t\tthis.instanceColorNode = instanceColorNode;\n\n\t\t}\n\n\t\t// POSITION\n\n\t\tconst instancePosition = instanceMatrixNode.mul( positionLocal ).xyz;\n\t\tpositionLocal.assign( instancePosition );\n\n\t\t// NORMAL\n\n\t\tif ( builder.hasGeometryAttribute( 'normal' ) ) {\n\n\t\t\tconst instanceNormal = transformNormal( normalLocal, instanceMatrixNode );\n\n\t\t\t// ASSIGNS\n\n\t\t\tnormalLocal.assign( instanceNormal );\n\n\t\t}\n\n\t\t// COLOR\n\n\t\tif ( this.instanceColorNode !== null ) {\n\n\t\t\tvaryingProperty( 'vec3', 'vInstanceColor' ).assign( this.instanceColorNode );\n\n\t\t}\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tif ( this.instanceMesh.instanceMatrix.usage !== DynamicDrawUsage && this.buffer != null && this.instanceMesh.instanceMatrix.version !== this.buffer.version ) {\n\n\t\t\tthis.buffer.version = this.instanceMesh.instanceMatrix.version;\n\n\t\t}\n\n\t\tif ( this.instanceMesh.instanceColor && this.instanceMesh.instanceColor.usage !== DynamicDrawUsage && this.bufferColor != null && this.instanceMesh.instanceColor.version !== this.bufferColor.version ) {\n\n\t\t\tthis.bufferColor.version = this.instanceMesh.instanceColor.version;\n\n\t\t}\n\n\t}\n\n}\n\nconst instance = /*@__PURE__*/ nodeProxy( InstanceNode );\n\nclass BatchNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'BatchNode';\n\n\t}\n\n\tconstructor( batchMesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.batchMesh = batchMesh;\n\n\n\t\tthis.batchingIdNode = null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// POSITION\n\n\t\tif ( this.batchingIdNode === null ) {\n\n\t\t\tif ( builder.getDrawIndex() === null ) {\n\n\t\t\t\tthis.batchingIdNode = instanceIndex;\n\n\t\t\t} else {\n\n\t\t\t\tthis.batchingIdNode = drawIndex;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst getIndirectIndex = Fn( ( [ id ] ) => {\n\n\t\t\tconst size = textureSize( textureLoad( this.batchMesh._indirectTexture ), 0 );\n\t\t\tconst x = int( id ).modInt( int( size ) );\n\t\t\tconst y = int( id ).div( int( size ) );\n\t\t\treturn textureLoad( this.batchMesh._indirectTexture, ivec2( x, y ) ).x;\n\n\t\t} ).setLayout( {\n\t\t\tname: 'getIndirectIndex',\n\t\t\ttype: 'uint',\n\t\t\tinputs: [\n\t\t\t\t{ name: 'id', type: 'int' }\n\t\t\t]\n\t\t} );\n\n\t\tconst indirectId = getIndirectIndex( int( this.batchingIdNode ) );\n\n\t\tconst matricesTexture = this.batchMesh._matricesTexture;\n\n\t\tconst size = textureSize( textureLoad( matricesTexture ), 0 );\n\t\tconst j = float( indirectId ).mul( 4 ).toInt().toVar();\n\n\t\tconst x = j.modInt( size );\n\t\tconst y = j.div( int( size ) );\n\t\tconst batchingMatrix = mat4(\n\t\t\ttextureLoad( matricesTexture, ivec2( x, y ) ),\n\t\t\ttextureLoad( matricesTexture, ivec2( x.add( 1 ), y ) ),\n\t\t\ttextureLoad( matricesTexture, ivec2( x.add( 2 ), y ) ),\n\t\t\ttextureLoad( matricesTexture, ivec2( x.add( 3 ), y ) )\n\t\t);\n\n\n\t\tconst colorsTexture = this.batchMesh._colorsTexture;\n\n\t\tif ( colorsTexture !== null ) {\n\n\t\t\tconst getBatchingColor = Fn( ( [ id ] ) => {\n\n\t\t\t\tconst size = textureSize( textureLoad( colorsTexture ), 0 ).x;\n\t\t\t\tconst j = id;\n\t\t\t\tconst x = j.modInt( size );\n\t\t\t\tconst y = j.div( size );\n\t\t\t\treturn textureLoad( colorsTexture, ivec2( x, y ) ).rgb;\n\n\t\t\t} ).setLayout( {\n\t\t\t\tname: 'getBatchingColor',\n\t\t\t\ttype: 'vec3',\n\t\t\t\tinputs: [\n\t\t\t\t\t{ name: 'id', type: 'int' }\n\t\t\t\t]\n\t\t\t} );\n\n\t\t\tconst color = getBatchingColor( indirectId );\n\n\t\t\tvaryingProperty( 'vec3', 'vBatchColor' ).assign( color );\n\n\t\t}\n\n\t\tconst bm = mat3( batchingMatrix );\n\n\t\tpositionLocal.assign( batchingMatrix.mul( positionLocal ) );\n\n\t\tconst transformedNormal = normalLocal.div( vec3( bm[ 0 ].dot( bm[ 0 ] ), bm[ 1 ].dot( bm[ 1 ] ), bm[ 2 ].dot( bm[ 2 ] ) ) );\n\n\t\tconst batchingNormal = bm.mul( transformedNormal ).xyz;\n\n\t\tnormalLocal.assign( batchingNormal );\n\n\t\tif ( builder.hasGeometryAttribute( 'tangent' ) ) {\n\n\t\t\ttangentLocal.mulAssign( bm );\n\n\t\t}\n\n\t}\n\n}\n\nconst batch = /*@__PURE__*/ nodeProxy( BatchNode );\n\nconst _frameId = new WeakMap();\n\nclass SkinningNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SkinningNode';\n\n\t}\n\n\tconstructor( skinnedMesh, useReference = false ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.skinnedMesh = skinnedMesh;\n\t\tthis.useReference = useReference;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t\t//\n\n\t\tthis.skinIndexNode = attribute( 'skinIndex', 'uvec4' );\n\t\tthis.skinWeightNode = attribute( 'skinWeight', 'vec4' );\n\n\t\tlet bindMatrixNode, bindMatrixInverseNode, boneMatricesNode;\n\n\t\tif ( useReference ) {\n\n\t\t\tbindMatrixNode = reference( 'bindMatrix', 'mat4' );\n\t\t\tbindMatrixInverseNode = reference( 'bindMatrixInverse', 'mat4' );\n\t\t\tboneMatricesNode = referenceBuffer( 'skeleton.boneMatrices', 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t} else {\n\n\t\t\tbindMatrixNode = uniform( skinnedMesh.bindMatrix, 'mat4' );\n\t\t\tbindMatrixInverseNode = uniform( skinnedMesh.bindMatrixInverse, 'mat4' );\n\t\t\tboneMatricesNode = buffer( skinnedMesh.skeleton.boneMatrices, 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t}\n\n\t\tthis.bindMatrixNode = bindMatrixNode;\n\t\tthis.bindMatrixInverseNode = bindMatrixInverseNode;\n\t\tthis.boneMatricesNode = boneMatricesNode;\n\t\tthis.previousBoneMatricesNode = null;\n\n\t}\n\n\tgetSkinnedPosition( boneMatrices = this.boneMatricesNode, position = positionLocal ) {\n\n\t\tconst { skinIndexNode, skinWeightNode, bindMatrixNode, bindMatrixInverseNode } = this;\n\n\t\tconst boneMatX = boneMatrices.element( skinIndexNode.x );\n\t\tconst boneMatY = boneMatrices.element( skinIndexNode.y );\n\t\tconst boneMatZ = boneMatrices.element( skinIndexNode.z );\n\t\tconst boneMatW = boneMatrices.element( skinIndexNode.w );\n\n\t\t// POSITION\n\n\t\tconst skinVertex = bindMatrixNode.mul( position );\n\n\t\tconst skinned = add(\n\t\t\tboneMatX.mul( skinWeightNode.x ).mul( skinVertex ),\n\t\t\tboneMatY.mul( skinWeightNode.y ).mul( skinVertex ),\n\t\t\tboneMatZ.mul( skinWeightNode.z ).mul( skinVertex ),\n\t\t\tboneMatW.mul( skinWeightNode.w ).mul( skinVertex )\n\t\t);\n\n\t\treturn bindMatrixInverseNode.mul( skinned ).xyz;\n\n\t}\n\n\tgetSkinnedNormal( boneMatrices = this.boneMatricesNode, normal = normalLocal ) {\n\n\t\tconst { skinIndexNode, skinWeightNode, bindMatrixNode, bindMatrixInverseNode } = this;\n\n\t\tconst boneMatX = boneMatrices.element( skinIndexNode.x );\n\t\tconst boneMatY = boneMatrices.element( skinIndexNode.y );\n\t\tconst boneMatZ = boneMatrices.element( skinIndexNode.z );\n\t\tconst boneMatW = boneMatrices.element( skinIndexNode.w );\n\n\t\t// NORMAL\n\n\t\tlet skinMatrix = add(\n\t\t\tskinWeightNode.x.mul( boneMatX ),\n\t\t\tskinWeightNode.y.mul( boneMatY ),\n\t\t\tskinWeightNode.z.mul( boneMatZ ),\n\t\t\tskinWeightNode.w.mul( boneMatW )\n\t\t);\n\n\t\tskinMatrix = bindMatrixInverseNode.mul( skinMatrix ).mul( bindMatrixNode );\n\n\t\treturn skinMatrix.transformDirection( normal ).xyz;\n\n\t}\n\n\tgetPreviousSkinnedPosition( builder ) {\n\n\t\tconst skinnedMesh = builder.object;\n\n\t\tif ( this.previousBoneMatricesNode === null ) {\n\n\t\t\tskinnedMesh.skeleton.previousBoneMatrices = new Float32Array( skinnedMesh.skeleton.boneMatrices );\n\n\t\t\tthis.previousBoneMatricesNode = referenceBuffer( 'skeleton.previousBoneMatrices', 'mat4', skinnedMesh.skeleton.bones.length );\n\n\t\t}\n\n\t\treturn this.getSkinnedPosition( this.previousBoneMatricesNode, positionPrevious );\n\n\t}\n\n\tneedsPreviousBoneMatrices( builder ) {\n\n\t\tconst mrt = builder.renderer.getMRT();\n\n\t\treturn mrt && mrt.has( 'velocity' );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this.needsPreviousBoneMatrices( builder ) ) {\n\n\t\t\tpositionPrevious.assign( this.getPreviousSkinnedPosition( builder ) );\n\n\t\t}\n\n\t\tconst skinPosition = this.getSkinnedPosition();\n\n\n\t\tpositionLocal.assign( skinPosition );\n\n\t\tif ( builder.hasGeometryAttribute( 'normal' ) ) {\n\n\t\t\tconst skinNormal = this.getSkinnedNormal();\n\n\t\t\tnormalLocal.assign( skinNormal );\n\n\t\t\tif ( builder.hasGeometryAttribute( 'tangent' ) ) {\n\n\t\t\t\ttangentLocal.assign( skinNormal );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tif ( output !== 'void' ) {\n\n\t\t\treturn positionLocal.build( builder, output );\n\n\t\t}\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst object = this.useReference ? frame.object : this.skinnedMesh;\n\t\tconst skeleton = object.skeleton;\n\n\t\tif ( _frameId.get( skeleton ) === frame.frameId ) return;\n\n\t\t_frameId.set( skeleton, frame.frameId );\n\n\t\tif ( this.previousBoneMatricesNode !== null ) skeleton.previousBoneMatrices.set( skeleton.boneMatrices );\n\n\t\tskeleton.update();\n\n\t}\n\n}\n\nconst skinning = ( skinnedMesh ) => nodeObject( new SkinningNode( skinnedMesh ) );\nconst skinningReference = ( skinnedMesh ) => nodeObject( new SkinningNode( skinnedMesh, true ) );\n\nclass LoopNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'LoopNode';\n\n\t}\n\n\tconstructor( params = [] ) {\n\n\t\tsuper();\n\n\t\tthis.params = params;\n\n\t}\n\n\tgetVarName( index ) {\n\n\t\treturn String.fromCharCode( 'i'.charCodeAt() + index );\n\n\t}\n\n\tgetProperties( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tif ( properties.stackNode !== undefined ) return properties;\n\n\t\t//\n\n\t\tconst inputs = {};\n\n\t\tfor ( let i = 0, l = this.params.length - 1; i < l; i ++ ) {\n\n\t\t\tconst param = this.params[ i ];\n\n\t\t\tconst name = ( param.isNode !== true && param.name ) || this.getVarName( i );\n\t\t\tconst type = ( param.isNode !== true && param.type ) || 'int';\n\n\t\t\tinputs[ name ] = expression( name, type );\n\n\t\t}\n\n\t\tconst stack = builder.addStack(); // TODO: cache() it\n\n\t\tproperties.returnsNode = this.params[ this.params.length - 1 ]( inputs, stack, builder );\n\t\tproperties.stackNode = stack;\n\n\t\tbuilder.removeStack();\n\n\t\treturn properties;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tconst { returnsNode } = this.getProperties( builder );\n\n\t\treturn returnsNode ? returnsNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// setup properties\n\n\t\tthis.getProperties( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst properties = this.getProperties( builder );\n\n\t\tconst params = this.params;\n\t\tconst stackNode = properties.stackNode;\n\n\t\tfor ( let i = 0, l = params.length - 1; i < l; i ++ ) {\n\n\t\t\tconst param = params[ i ];\n\n\t\t\tlet start = null, end = null, name = null, type = null, condition = null, update = null;\n\n\t\t\tif ( param.isNode ) {\n\n\t\t\t\ttype = 'int';\n\t\t\t\tname = this.getVarName( i );\n\t\t\t\tstart = '0';\n\t\t\t\tend = param.build( builder, type );\n\t\t\t\tcondition = '<';\n\n\t\t\t} else {\n\n\t\t\t\ttype = param.type || 'int';\n\t\t\t\tname = param.name || this.getVarName( i );\n\t\t\t\tstart = param.start;\n\t\t\t\tend = param.end;\n\t\t\t\tcondition = param.condition;\n\t\t\t\tupdate = param.update;\n\n\t\t\t\tif ( typeof start === 'number' ) start = builder.generateConst( type, start );\n\t\t\t\telse if ( start && start.isNode ) start = start.build( builder, type );\n\n\t\t\t\tif ( typeof end === 'number' ) end = builder.generateConst( type, end );\n\t\t\t\telse if ( end && end.isNode ) end = end.build( builder, type );\n\n\t\t\t\tif ( start !== undefined && end === undefined ) {\n\n\t\t\t\t\tstart = start + ' - 1';\n\t\t\t\t\tend = '0';\n\t\t\t\t\tcondition = '>=';\n\n\t\t\t\t} else if ( end !== undefined && start === undefined ) {\n\n\t\t\t\t\tstart = '0';\n\t\t\t\t\tcondition = '<';\n\n\t\t\t\t}\n\n\t\t\t\tif ( condition === undefined ) {\n\n\t\t\t\t\tif ( Number( start ) > Number( end ) ) {\n\n\t\t\t\t\t\tcondition = '>=';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tcondition = '<';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst internalParam = { start, end, condition };\n\n\t\t\t//\n\n\t\t\tconst startSnippet = internalParam.start;\n\t\t\tconst endSnippet = internalParam.end;\n\n\t\t\tlet declarationSnippet = '';\n\t\t\tlet conditionalSnippet = '';\n\t\t\tlet updateSnippet = '';\n\n\t\t\tif ( ! update ) {\n\n\t\t\t\tif ( type === 'int' || type === 'uint' ) {\n\n\t\t\t\t\tif ( condition.includes( '<' ) ) update = '++';\n\t\t\t\t\telse update = '--';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( condition.includes( '<' ) ) update = '+= 1.';\n\t\t\t\t\telse update = '-= 1.';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdeclarationSnippet += builder.getVar( type, name ) + ' = ' + startSnippet;\n\n\t\t\tconditionalSnippet += name + ' ' + condition + ' ' + endSnippet;\n\t\t\tupdateSnippet += name + ' ' + update;\n\n\t\t\tconst forSnippet = `for ( ${ declarationSnippet }; ${ conditionalSnippet }; ${ updateSnippet } )`;\n\n\t\t\tbuilder.addFlowCode( ( i === 0 ? '\\n' : '' ) + builder.tab + forSnippet + ' {\\n\\n' ).addFlowTab();\n\n\t\t}\n\n\t\tconst stackSnippet = stackNode.build( builder, 'void' );\n\n\t\tconst returnsSnippet = properties.returnsNode ? properties.returnsNode.build( builder ) : '';\n\n\t\tbuilder.removeFlowTab().addFlowCode( '\\n' + builder.tab + stackSnippet );\n\n\t\tfor ( let i = 0, l = this.params.length - 1; i < l; i ++ ) {\n\n\t\t\tbuilder.addFlowCode( ( i === 0 ? '' : builder.tab ) + '}\\n\\n' ).removeFlowTab();\n\n\t\t}\n\n\t\tbuilder.addFlowTab();\n\n\t\treturn returnsSnippet;\n\n\t}\n\n}\n\nconst Loop = ( ...params ) => nodeObject( new LoopNode( nodeArray( params, 'int' ) ) ).append();\nconst Continue = () => expression( 'continue' ).append();\nconst Break = () => expression( 'break' ).append();\n\n//\n\nconst loop = ( ...params ) => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.LoopNode: loop() has been renamed to Loop().' );\n\treturn Loop( ...params );\n\n};\n\nconst _morphTextures = /*@__PURE__*/ new WeakMap();\nconst _morphVec4 = /*@__PURE__*/ new Vector4();\n\nconst getMorph = /*@__PURE__*/ Fn( ( { bufferMap, influence, stride, width, depth, offset } ) => {\n\n\tconst texelIndex = int( vertexIndex ).mul( stride ).add( offset );\n\n\tconst y = texelIndex.div( width );\n\tconst x = texelIndex.sub( y.mul( width ) );\n\n\tconst bufferAttrib = textureLoad( bufferMap, ivec2( x, y ) ).depth( depth );\n\n\treturn bufferAttrib.mul( influence );\n\n} );\n\nfunction getEntry( geometry ) {\n\n\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\tconst hasMorphNormals = geometry.morphAttributes.normal !== undefined;\n\tconst hasMorphColors = geometry.morphAttributes.color !== undefined;\n\n\t// instead of using attributes, the WebGL 2 code path encodes morph targets\n\t// into an array of data textures. Each layer represents a single morph target.\n\n\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\tlet entry = _morphTextures.get( geometry );\n\n\tif ( entry === undefined || entry.count !== morphTargetsCount ) {\n\n\t\tif ( entry !== undefined ) entry.texture.dispose();\n\n\t\tconst morphTargets = geometry.morphAttributes.position || [];\n\t\tconst morphNormals = geometry.morphAttributes.normal || [];\n\t\tconst morphColors = geometry.morphAttributes.color || [];\n\n\t\tlet vertexDataCount = 0;\n\n\t\tif ( hasMorphPosition === true ) vertexDataCount = 1;\n\t\tif ( hasMorphNormals === true ) vertexDataCount = 2;\n\t\tif ( hasMorphColors === true ) vertexDataCount = 3;\n\n\t\tlet width = geometry.attributes.position.count * vertexDataCount;\n\t\tlet height = 1;\n\n\t\tconst maxTextureSize = 4096; // @TODO: Use 'capabilities.maxTextureSize'\n\n\t\tif ( width > maxTextureSize ) {\n\n\t\t\theight = Math.ceil( width / maxTextureSize );\n\t\t\twidth = maxTextureSize;\n\n\t\t}\n\n\t\tconst buffer = new Float32Array( width * height * 4 * morphTargetsCount );\n\n\t\tconst bufferTexture = new DataArrayTexture( buffer, width, height, morphTargetsCount );\n\t\tbufferTexture.type = FloatType;\n\t\tbufferTexture.needsUpdate = true;\n\n\t\t// fill buffer\n\n\t\tconst vertexDataStride = vertexDataCount * 4;\n\n\t\tfor ( let i = 0; i < morphTargetsCount; i ++ ) {\n\n\t\t\tconst morphTarget = morphTargets[ i ];\n\t\t\tconst morphNormal = morphNormals[ i ];\n\t\t\tconst morphColor = morphColors[ i ];\n\n\t\t\tconst offset = width * height * 4 * i;\n\n\t\t\tfor ( let j = 0; j < morphTarget.count; j ++ ) {\n\n\t\t\t\tconst stride = j * vertexDataStride;\n\n\t\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\t\t_morphVec4.fromBufferAttribute( morphTarget, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 0 ] = _morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 1 ] = _morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 2 ] = _morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 3 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\t\t_morphVec4.fromBufferAttribute( morphNormal, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 4 ] = _morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 5 ] = _morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 6 ] = _morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 7 ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hasMorphColors === true ) {\n\n\t\t\t\t\t_morphVec4.fromBufferAttribute( morphColor, j );\n\n\t\t\t\t\tbuffer[ offset + stride + 8 ] = _morphVec4.x;\n\t\t\t\t\tbuffer[ offset + stride + 9 ] = _morphVec4.y;\n\t\t\t\t\tbuffer[ offset + stride + 10 ] = _morphVec4.z;\n\t\t\t\t\tbuffer[ offset + stride + 11 ] = ( morphColor.itemSize === 4 ) ? _morphVec4.w : 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tentry = {\n\t\t\tcount: morphTargetsCount,\n\t\t\ttexture: bufferTexture,\n\t\t\tstride: vertexDataCount,\n\t\t\tsize: new Vector2( width, height )\n\t\t};\n\n\t\t_morphTextures.set( geometry, entry );\n\n\t\tfunction disposeTexture() {\n\n\t\t\tbufferTexture.dispose();\n\n\t\t\t_morphTextures.delete( geometry );\n\n\t\t\tgeometry.removeEventListener( 'dispose', disposeTexture );\n\n\t\t}\n\n\t\tgeometry.addEventListener( 'dispose', disposeTexture );\n\n\t}\n\n\treturn entry;\n\n}\n\n\nclass MorphNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'MorphNode';\n\n\t}\n\n\tconstructor( mesh ) {\n\n\t\tsuper( 'void' );\n\n\t\tthis.mesh = mesh;\n\t\tthis.morphBaseInfluence = uniform( 1 );\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { geometry } = builder;\n\n\t\tconst hasMorphPosition = geometry.morphAttributes.position !== undefined;\n\t\tconst hasMorphNormals = geometry.hasAttribute( 'normal' ) && geometry.morphAttributes.normal !== undefined;\n\n\t\tconst morphAttribute = geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color;\n\t\tconst morphTargetsCount = ( morphAttribute !== undefined ) ? morphAttribute.length : 0;\n\n\t\t// nodes\n\n\t\tconst { texture: bufferMap, stride, size } = getEntry( geometry );\n\n\t\tif ( hasMorphPosition === true ) positionLocal.mulAssign( this.morphBaseInfluence );\n\t\tif ( hasMorphNormals === true ) normalLocal.mulAssign( this.morphBaseInfluence );\n\n\t\tconst width = int( size.width );\n\n\t\tLoop( morphTargetsCount, ( { i } ) => {\n\n\t\t\tconst influence = float( 0 ).toVar();\n\n\t\t\tif ( this.mesh.count > 1 && ( this.mesh.morphTexture !== null && this.mesh.morphTexture !== undefined ) ) {\n\n\t\t\t\tinfluence.assign( textureLoad( this.mesh.morphTexture, ivec2( int( i ).add( 1 ), int( instanceIndex ) ) ).r );\n\n\t\t\t} else {\n\n\t\t\t\tinfluence.assign( reference( 'morphTargetInfluences', 'float' ).element( i ).toVar() );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphPosition === true ) {\n\n\t\t\t\tpositionLocal.addAssign( getMorph( {\n\t\t\t\t\tbufferMap,\n\t\t\t\t\tinfluence,\n\t\t\t\t\tstride,\n\t\t\t\t\twidth,\n\t\t\t\t\tdepth: i,\n\t\t\t\t\toffset: int( 0 )\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormals === true ) {\n\n\t\t\t\tnormalLocal.addAssign( getMorph( {\n\t\t\t\t\tbufferMap,\n\t\t\t\t\tinfluence,\n\t\t\t\t\tstride,\n\t\t\t\t\twidth,\n\t\t\t\t\tdepth: i,\n\t\t\t\t\toffset: int( 1 )\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tupdate() {\n\n\t\tconst morphBaseInfluence = this.morphBaseInfluence;\n\n\t\tif ( this.mesh.geometry.morphTargetsRelative ) {\n\n\t\t\tmorphBaseInfluence.value = 1;\n\n\t\t} else {\n\n\t\t\tmorphBaseInfluence.value = 1 - this.mesh.morphTargetInfluences.reduce( ( a, b ) => a + b, 0 );\n\n\t\t}\n\n\t}\n\n}\n\nconst morphReference = /*@__PURE__*/ nodeProxy( MorphNode );\n\nclass LightingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'LightingNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.isLightingNode = true;\n\n\t}\n\n\tgenerate( /*builder*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nclass AONode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'AONode';\n\n\t}\n\n\tconstructor( aoNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.aoNode = aoNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.ambientOcclusion.mulAssign( this.aoNode );\n\n\t}\n\n}\n\nclass LightingContextNode extends ContextNode {\n\n\tstatic get type() {\n\n\t\treturn 'LightingContextNode';\n\n\t}\n\n\tconstructor( node, lightingModel = null, backdropNode = null, backdropAlphaNode = null ) {\n\n\t\tsuper( node );\n\n\t\tthis.lightingModel = lightingModel;\n\t\tthis.backdropNode = backdropNode;\n\t\tthis.backdropAlphaNode = backdropAlphaNode;\n\n\t\tthis._value = null;\n\n\t}\n\n\tgetContext() {\n\n\t\tconst { backdropNode, backdropAlphaNode } = this;\n\n\t\tconst directDiffuse = vec3().toVar( 'directDiffuse' ),\n\t\t\tdirectSpecular = vec3().toVar( 'directSpecular' ),\n\t\t\tindirectDiffuse = vec3().toVar( 'indirectDiffuse' ),\n\t\t\tindirectSpecular = vec3().toVar( 'indirectSpecular' );\n\n\t\tconst reflectedLight = {\n\t\t\tdirectDiffuse,\n\t\t\tdirectSpecular,\n\t\t\tindirectDiffuse,\n\t\t\tindirectSpecular\n\t\t};\n\n\t\tconst context = {\n\t\t\tradiance: vec3().toVar( 'radiance' ),\n\t\t\tirradiance: vec3().toVar( 'irradiance' ),\n\t\t\tiblIrradiance: vec3().toVar( 'iblIrradiance' ),\n\t\t\tambientOcclusion: float( 1 ).toVar( 'ambientOcclusion' ),\n\t\t\treflectedLight,\n\t\t\tbackdrop: backdropNode,\n\t\t\tbackdropAlpha: backdropAlphaNode\n\t\t};\n\n\t\treturn context;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.value = this._value || ( this._value = this.getContext() );\n\t\tthis.value.lightingModel = this.lightingModel || builder.context.lightingModel;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n}\n\nconst lightingContext = /*@__PURE__*/ nodeProxy( LightingContextNode );\n\nclass IrradianceNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'IrradianceNode';\n\n\t}\n\n\tconstructor( node ) {\n\n\t\tsuper();\n\n\t\tthis.node = node;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.irradiance.addAssign( this.node );\n\n\t}\n\n}\n\nlet screenSizeVec, viewportVec;\n\nclass ScreenNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ScreenNode';\n\n\t}\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t\tthis.isViewportNode = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\tif ( this.scope === ScreenNode.VIEWPORT ) return 'vec4';\n\t\telse return 'vec2';\n\n\t}\n\n\tgetUpdateType() {\n\n\t\tlet updateType = NodeUpdateType.NONE;\n\n\t\tif ( this.scope === ScreenNode.SIZE || this.scope === ScreenNode.VIEWPORT ) {\n\n\t\t\tupdateType = NodeUpdateType.RENDER;\n\n\t\t}\n\n\t\tthis.updateType = updateType;\n\n\t\treturn updateType;\n\n\t}\n\n\tupdate( { renderer } ) {\n\n\t\tconst renderTarget = renderer.getRenderTarget();\n\n\t\tif ( this.scope === ScreenNode.VIEWPORT ) {\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tviewportVec.copy( renderTarget.viewport );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.getViewport( viewportVec );\n\n\t\t\t\tviewportVec.multiplyScalar( renderer.getPixelRatio() );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tscreenSizeVec.width = renderTarget.width;\n\t\t\t\tscreenSizeVec.height = renderTarget.height;\n\n\t\t\t} else {\n\n\t\t\t\trenderer.getDrawingBufferSize( screenSizeVec );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst scope = this.scope;\n\n\t\tlet output = null;\n\n\t\tif ( scope === ScreenNode.SIZE ) {\n\n\t\t\toutput = uniform( screenSizeVec || ( screenSizeVec = new Vector2() ) );\n\n\t\t} else if ( scope === ScreenNode.VIEWPORT ) {\n\n\t\t\toutput = uniform( viewportVec || ( viewportVec = new Vector4() ) );\n\n\t\t} else {\n\n\t\t\toutput = vec2( screenCoordinate.div( screenSize ) );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( this.scope === ScreenNode.COORDINATE ) {\n\n\t\t\tlet coord = builder.getFragCoord();\n\n\t\t\tif ( builder.isFlipY() ) {\n\n\t\t\t\t// follow webgpu standards\n\n\t\t\t\tconst size = builder.getNodeProperties( screenSize ).outputNode.build( builder );\n\n\t\t\t\tcoord = `${ builder.getType( 'vec2' ) }( ${ coord }.x, ${ size }.y - ${ coord }.y )`;\n\n\t\t\t}\n\n\t\t\treturn coord;\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n}\n\nScreenNode.COORDINATE = 'coordinate';\nScreenNode.VIEWPORT = 'viewport';\nScreenNode.SIZE = 'size';\nScreenNode.UV = 'uv';\n\n// Screen\n\nconst screenUV = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.UV );\nconst screenSize = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.SIZE );\nconst screenCoordinate = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.COORDINATE );\n\n// Viewport\n\nconst viewport = /*@__PURE__*/ nodeImmutable( ScreenNode, ScreenNode.VIEWPORT );\nconst viewportSize = viewport.zw;\nconst viewportCoordinate = /*@__PURE__*/ screenCoordinate.sub( viewport.xy );\nconst viewportUV = /*@__PURE__*/ viewportCoordinate.div( viewportSize );\n\n// Deprecated\n\nconst viewportResolution = /*@__PURE__*/ ( Fn( () => { // @deprecated, r169\n\n\tconsole.warn( 'TSL.ViewportNode: \"viewportResolution\" is deprecated. Use \"screenSize\" instead.' );\n\n\treturn screenSize;\n\n}, 'vec2' ).once() )();\n\nconst viewportTopLeft = /*@__PURE__*/ ( Fn( () => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ViewportNode: \"viewportTopLeft\" is deprecated. Use \"screenUV\" instead.' );\n\n\treturn screenUV;\n\n}, 'vec2' ).once() )();\n\nconst viewportBottomLeft = /*@__PURE__*/ ( Fn( () => { // @deprecated, r168\n\n\tconsole.warn( 'TSL.ViewportNode: \"viewportBottomLeft\" is deprecated. Use \"screenUV.flipY()\" instead.' );\n\n\treturn screenUV.flipY();\n\n}, 'vec2' ).once() )();\n\nconst _size$4 = /*@__PURE__*/ new Vector2();\n\nclass ViewportTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportTextureNode';\n\n\t}\n\n\tconstructor( uvNode = screenUV, levelNode = null, framebufferTexture = null ) {\n\n\t\tif ( framebufferTexture === null ) {\n\n\t\t\tframebufferTexture = new FramebufferTexture();\n\t\t\tframebufferTexture.minFilter = LinearMipmapLinearFilter;\n\n\t\t}\n\n\t\tsuper( framebufferTexture, uvNode, levelNode );\n\n\t\tthis.generateMipmaps = false;\n\n\t\tthis.isOutputTextureNode = true;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst renderer = frame.renderer;\n\t\trenderer.getDrawingBufferSize( _size$4 );\n\n\t\t//\n\n\t\tconst framebufferTexture = this.value;\n\n\t\tif ( framebufferTexture.image.width !== _size$4.width || framebufferTexture.image.height !== _size$4.height ) {\n\n\t\t\tframebufferTexture.image.width = _size$4.width;\n\t\t\tframebufferTexture.image.height = _size$4.height;\n\t\t\tframebufferTexture.needsUpdate = true;\n\n\t\t}\n\n\t\t//\n\n\t\tconst currentGenerateMipmaps = framebufferTexture.generateMipmaps;\n\t\tframebufferTexture.generateMipmaps = this.generateMipmaps;\n\n\t\trenderer.copyFramebufferToTexture( framebufferTexture );\n\n\t\tframebufferTexture.generateMipmaps = currentGenerateMipmaps;\n\n\t}\n\n\tclone() {\n\n\t\tconst viewportTextureNode = new this.constructor( this.uvNode, this.levelNode, this.value );\n\t\tviewportTextureNode.generateMipmaps = this.generateMipmaps;\n\n\t\treturn viewportTextureNode;\n\n\t}\n\n}\n\nconst viewportTexture = /*@__PURE__*/ nodeProxy( ViewportTextureNode );\nconst viewportMipTexture = /*@__PURE__*/ nodeProxy( ViewportTextureNode, null, null, { generateMipmaps: true } );\n\nlet sharedDepthbuffer = null;\n\nclass ViewportDepthTextureNode extends ViewportTextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportDepthTextureNode';\n\n\t}\n\n\tconstructor( uvNode = screenUV, levelNode = null ) {\n\n\t\tif ( sharedDepthbuffer === null ) {\n\n\t\t\tsharedDepthbuffer = new DepthTexture();\n\n\t\t}\n\n\t\tsuper( uvNode, levelNode, sharedDepthbuffer );\n\n\t}\n\n}\n\nconst viewportDepthTexture = /*@__PURE__*/ nodeProxy( ViewportDepthTextureNode );\n\nclass ViewportDepthNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportDepthNode';\n\n\t}\n\n\tconstructor( scope, valueNode = null ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.scope = scope;\n\t\tthis.valueNode = valueNode;\n\n\t\tthis.isViewportDepthNode = true;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { scope } = this;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH_BASE ) {\n\n\t\t\treturn builder.getFragDepth();\n\n\t\t}\n\n\t\treturn super.generate( builder );\n\n\t}\n\n\tsetup( { camera } ) {\n\n\t\tconst { scope } = this;\n\t\tconst value = this.valueNode;\n\n\t\tlet node = null;\n\n\t\tif ( scope === ViewportDepthNode.DEPTH_BASE ) {\n\n\t\t\tif ( value !== null ) {\n\n \t\t\t\tnode = depthBase().assign( value );\n\n\t\t\t}\n\n\t\t} else if ( scope === ViewportDepthNode.DEPTH ) {\n\n\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\tnode = viewZToPerspectiveDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t} else {\n\n\t\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t}\n\n\t\t} else if ( scope === ViewportDepthNode.LINEAR_DEPTH ) {\n\n\t\t\tif ( value !== null ) {\n\n\t\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\t\tconst viewZ = perspectiveDepthToViewZ( value, cameraNear, cameraFar );\n\n\t\t\t\t\tnode = viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnode = value;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tnode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nViewportDepthNode.DEPTH_BASE = 'depthBase';\nViewportDepthNode.DEPTH = 'depth';\nViewportDepthNode.LINEAR_DEPTH = 'linearDepth';\n\n// NOTE: viewZ, the z-coordinate in camera space, is negative for points in front of the camera\n\n// -near maps to 0; -far maps to 1\nconst viewZToOrthographicDepth = ( viewZ, near, far ) => viewZ.add( near ).div( near.sub( far ) );\n\n// maps orthographic depth in [ 0, 1 ] to viewZ\nconst orthographicDepthToViewZ = ( depth, near, far ) => near.sub( far ).mul( depth ).sub( near );\n\n// NOTE: https://twitter.com/gonnavis/status/1377183786949959682\n\n// -near maps to 0; -far maps to 1\nconst viewZToPerspectiveDepth = ( viewZ, near, far ) => near.add( viewZ ).mul( far ).div( far.sub( near ).mul( viewZ ) );\n\n// maps perspective depth in [ 0, 1 ] to viewZ\nconst perspectiveDepthToViewZ = ( depth, near, far ) => near.mul( far ).div( far.sub( near ).mul( depth ).sub( far ) );\n\nconst perspectiveDepthToLogarithmicDepth = ( perspectiveW, near, far ) => {\n\n\t// The final logarithmic depth formula used here is adapted from one described in an\n\t// article by Thatcher Ulrich (see http://tulrich.com/geekstuff/log_depth_buffer.txt),\n\t// which was an improvement upon an earlier formula one described in an\n\t// Outerra article (https://outerra.blogspot.com/2009/08/logarithmic-z-buffer.html).\n\t// Ulrich's formula is the following:\n\t//     z = K * log( w / cameraNear ) / log( cameraFar / cameraNear )\n\t//     where K = 2^k - 1, and k is the number of bits in the depth buffer.\n\t// The Outerra variant ignored the camera near plane (it assumed it was 0) and instead\n\t// opted for a \"C-constant\" for resolution adjustment of objects near the camera.\n\t// Outerra states: \"Notice that the 'C' variant doesn’t use a near plane distance, it has it\n\t// set at 0\" (quote from https://outerra.blogspot.com/2012/11/maximizing-depth-buffer-range-and.html).\n\t// Ulrich's variant has the benefit of constant relative precision over the whole near-far range.\n\t// It was debated here whether Outerra's \"C-constant\" or Ulrich's \"near plane\" variant should\n\t// be used, and ultimately Ulrich's \"near plane\" version was chosen.\n\t// Outerra eventually made another improvement to their original \"C-constant\" variant,\n\t// but it still does not incorporate the camera near plane (for this version,\n\t// see https://outerra.blogspot.com/2013/07/logarithmic-depth-buffer-optimizations.html).\n\t// Here we make 4 changes to Ulrich's formula:\n\t// 1. Clamp the camera near plane so we don't divide by 0.\n\t// 2. Use log2 instead of log to avoid an extra multiply (shaders implement log using log2).\n\t// 3. Assume K is 1 (K = maximum value in depth buffer; see Ulrich's formula above).\n\t// 4. Add 1 to each division by cameraNear to ensure the depth curve is shifted to the left as cameraNear increases.\n\t// For visual representation of this depth curve, see https://www.desmos.com/calculator/lz5rqfysih\n\tnear = near.max( 1e-6 ).toVar();\n\tconst numerator = log2( perspectiveW.div( near ).add( 1 ) );\n\tconst denominator = log2( far.div( near ).add( 1 ) );\n\treturn numerator.div( denominator );\n\n};\n\nconst depthBase = /*@__PURE__*/ nodeProxy( ViewportDepthNode, ViewportDepthNode.DEPTH_BASE );\n\nconst depth = /*@__PURE__*/ nodeImmutable( ViewportDepthNode, ViewportDepthNode.DEPTH );\nconst linearDepth = /*@__PURE__*/ nodeProxy( ViewportDepthNode, ViewportDepthNode.LINEAR_DEPTH );\nconst viewportLinearDepth = /*@__PURE__*/ linearDepth( viewportDepthTexture() );\n\ndepth.assign = ( value ) => depthBase( value );\n\nclass ClippingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ClippingNode';\n\n\t}\n\n\tconstructor( scope = ClippingNode.DEFAULT ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst clippingContext = builder.clippingContext;\n\t\tconst { localClipIntersection, localClippingCount, globalClippingCount } = clippingContext;\n\n\t\tconst numClippingPlanes = globalClippingCount + localClippingCount;\n\t\tconst numUnionClippingPlanes = localClipIntersection ? numClippingPlanes - localClippingCount : numClippingPlanes;\n\n\t\tif ( this.scope === ClippingNode.ALPHA_TO_COVERAGE ) {\n\n\t\t\treturn this.setupAlphaToCoverage( clippingContext.planes, numClippingPlanes, numUnionClippingPlanes );\n\n\t\t} else {\n\n\t\t\treturn this.setupDefault( clippingContext.planes, numClippingPlanes, numUnionClippingPlanes );\n\n\t\t}\n\n\t}\n\n\tsetupAlphaToCoverage( planes, numClippingPlanes, numUnionClippingPlanes ) {\n\n\t\treturn Fn( () => {\n\n\t\t\tconst clippingPlanes = uniformArray( planes );\n\n\t\t\tconst distanceToPlane = property( 'float', 'distanceToPlane' );\n\t\t\tconst distanceGradient = property( 'float', 'distanceToGradient' );\n\n\t\t\tconst clipOpacity = property( 'float', 'clipOpacity' );\n\n\t\t\tclipOpacity.assign( 1 );\n\n\t\t\tlet plane;\n\n\t\t\tLoop( numUnionClippingPlanes, ( { i } ) => {\n\n\t\t\t\tplane = clippingPlanes.element( i );\n\n\t\t\t\tdistanceToPlane.assign( positionView.dot( plane.xyz ).negate().add( plane.w ) );\n\t\t\t\tdistanceGradient.assign( distanceToPlane.fwidth().div( 2.0 ) );\n\n\t\t\t\tclipOpacity.mulAssign( smoothstep( distanceGradient.negate(), distanceGradient, distanceToPlane ) );\n\n\t\t\t\tclipOpacity.equal( 0.0 ).discard();\n\n\t\t\t} );\n\n\t\t\tif ( numUnionClippingPlanes < numClippingPlanes ) {\n\n\t\t\t\tconst unionClipOpacity = property( 'float', 'unionclipOpacity' );\n\n\t\t\t\tunionClipOpacity.assign( 1 );\n\n\t\t\t\tLoop( { start: numUnionClippingPlanes, end: numClippingPlanes }, ( { i } ) => {\n\n\t\t\t\t\tplane = clippingPlanes.element( i );\n\n\t\t\t\t\tdistanceToPlane.assign( positionView.dot( plane.xyz ).negate().add( plane.w ) );\n\t\t\t\t\tdistanceGradient.assign( distanceToPlane.fwidth().div( 2.0 ) );\n\n\t\t\t\t\tunionClipOpacity.mulAssign( smoothstep( distanceGradient.negate(), distanceGradient, distanceToPlane ).oneMinus() );\n\n\t\t\t\t} );\n\n\t\t\t\tclipOpacity.mulAssign( unionClipOpacity.oneMinus() );\n\n\t\t\t}\n\n\t\t\tdiffuseColor.a.mulAssign( clipOpacity );\n\n\t\t\tdiffuseColor.a.equal( 0.0 ).discard();\n\n\t\t} )();\n\n\t}\n\n\tsetupDefault( planes, numClippingPlanes, numUnionClippingPlanes ) {\n\n\t\treturn Fn( () => {\n\n\t\t\tconst clippingPlanes = uniformArray( planes );\n\n\t\t\tlet plane;\n\n\t\t\tLoop( numUnionClippingPlanes, ( { i } ) => {\n\n\t\t\t\tplane = clippingPlanes.element( i );\n\t\t\t\tpositionView.dot( plane.xyz ).greaterThan( plane.w ).discard();\n\n\t\t\t} );\n\n\t\t\tif ( numUnionClippingPlanes < numClippingPlanes ) {\n\n\t\t\t\tconst clipped = property( 'bool', 'clipped' );\n\n\t\t\t\tclipped.assign( true );\n\n\t\t\t\tLoop( { start: numUnionClippingPlanes, end: numClippingPlanes }, ( { i } ) => {\n\n\t\t\t\t\tplane = clippingPlanes.element( i );\n\t\t\t\t\tclipped.assign( positionView.dot( plane.xyz ).greaterThan( plane.w ).and( clipped ) );\n\n\t\t\t\t} );\n\n\t\t\t\tclipped.discard();\n\n\t\t\t}\n\n\t\t} )();\n\n\t}\n\n}\n\nClippingNode.ALPHA_TO_COVERAGE = 'alphaToCoverage';\nClippingNode.DEFAULT = 'default';\n\nconst clipping = () => nodeObject( new ClippingNode() );\n\nconst clippingAlpha = () => nodeObject( new ClippingNode( ClippingNode.ALPHA_TO_COVERAGE ) );\n\n/**\n * See: https://casual-effects.com/research/Wyman2017Hashed/index.html\n */\n\nconst ALPHA_HASH_SCALE = 0.05; // Derived from trials only, and may be changed.\n\nconst hash2D = /*@__PURE__*/ Fn( ( [ value ] ) => {\n\n\treturn fract( mul( 1.0e4, sin( mul( 17.0, value.x ).add( mul( 0.1, value.y ) ) ) ).mul( add( 0.1, abs( sin( mul( 13.0, value.y ).add( value.x ) ) ) ) ) );\n\n} );\n\nconst hash3D = /*@__PURE__*/ Fn( ( [ value ] ) => {\n\n\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\n} );\n\nconst getAlphaHashThreshold = /*@__PURE__*/ Fn( ( [ position ] ) => {\n\n\t// Find the discretized derivatives of our coordinates\n\tconst maxDeriv = max$1(\n\t\tlength( dFdx( position.xyz ) ),\n\t\tlength( dFdy( position.xyz ) )\n\t).toVar( 'maxDeriv' );\n\n\tconst pixScale = float( 1 ).div( float( ALPHA_HASH_SCALE ).mul( maxDeriv ) ).toVar( 'pixScale' );\n\n\t// Find two nearest log-discretized noise scales\n\tconst pixScales = vec2(\n\t\texp2( floor( log2( pixScale ) ) ),\n\t\texp2( ceil( log2( pixScale ) ) )\n\t).toVar( 'pixScales' );\n\n\t// Compute alpha thresholds at our two noise scales\n\tconst alpha = vec2(\n\t\thash3D( floor( pixScales.x.mul( position.xyz ) ) ),\n\t\thash3D( floor( pixScales.y.mul( position.xyz ) ) ),\n\t).toVar( 'alpha' );\n\n\t// Factor to interpolate lerp with\n\tconst lerpFactor = fract( log2( pixScale ) ).toVar( 'lerpFactor' );\n\n\t// Interpolate alpha threshold from noise at two scales\n\tconst x = add( mul( lerpFactor.oneMinus(), alpha.x ), mul( lerpFactor, alpha.y ) ).toVar( 'x' );\n\n\t// Pass into CDF to compute uniformly distrib threshold\n\tconst a = min$1( lerpFactor, lerpFactor.oneMinus() ).toVar( 'a' );\n\tconst cases = vec3(\n\t\tx.mul( x ).div( mul( 2.0, a ).mul( sub( 1.0, a ) ) ),\n\t\tx.sub( mul( 0.5, a ) ).div( sub( 1.0, a ) ),\n\t\tsub( 1.0, sub( 1.0, x ).mul( sub( 1.0, x ) ).div( mul( 2.0, a ).mul( sub( 1.0, a ) ) ) ) ).toVar( 'cases' );\n\n\t// Find our final, uniformly distributed alpha threshold (ατ)\n\tconst threshold = x.lessThan( a.oneMinus() ).select( x.lessThan( a ).select( cases.x, cases.y ), cases.z );\n\n\t// Avoids ατ == 0. Could also do ατ =1-ατ\n\treturn clamp( threshold, 1.0e-6, 1.0 );\n\n} );\n\nclass NodeMaterial extends Material {\n\n\tstatic get type() {\n\n\t\treturn 'NodeMaterial';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isNodeMaterial = true;\n\n\t\tthis.type = this.constructor.type;\n\n\t\tthis.forceSinglePass = false;\n\n\t\tthis.fog = true;\n\t\tthis.lights = false;\n\n\t\tthis.lightsNode = null;\n\t\tthis.envNode = null;\n\t\tthis.aoNode = null;\n\n\t\tthis.colorNode = null;\n\t\tthis.normalNode = null;\n\t\tthis.opacityNode = null;\n\t\tthis.backdropNode = null;\n\t\tthis.backdropAlphaNode = null;\n\t\tthis.alphaTestNode = null;\n\n\t\tthis.positionNode = null;\n\t\tthis.geometryNode = null;\n\n\t\tthis.depthNode = null;\n\t\tthis.shadowNode = null;\n\t\tthis.shadowPositionNode = null;\n\n\t\tthis.outputNode = null;\n\t\tthis.mrtNode = null;\n\n\t\tthis.fragmentNode = null;\n\t\tthis.vertexNode = null;\n\n\t}\n\n\tcustomProgramCacheKey() {\n\n\t\treturn this.type + getCacheKey$1( this );\n\n\t}\n\n\tbuild( builder ) {\n\n\t\tthis.setup( builder );\n\n\t}\n\n\tsetupObserver( builder ) {\n\n\t\treturn new NodeMaterialObserver( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.setupNormal = () => this.setupNormal( builder );\n\n\t\t// < VERTEX STAGE >\n\n\t\tbuilder.addStack();\n\n\t\tbuilder.stack.outputNode = this.vertexNode || this.setupPosition( builder );\n\n\t\tif ( this.geometryNode !== null ) {\n\n\t\t\tbuilder.stack.outputNode = builder.stack.outputNode.bypass( this.geometryNode );\n\n\t\t}\n\n\t\tbuilder.addFlow( 'vertex', builder.removeStack() );\n\n\t\t// < FRAGMENT STAGE >\n\n\t\tbuilder.addStack();\n\n\t\tlet resultNode;\n\n\t\tconst clippingNode = this.setupClipping( builder );\n\n\t\tif ( this.depthWrite === true ) this.setupDepth( builder );\n\n\t\tif ( this.fragmentNode === null ) {\n\n\t\t\tthis.setupDiffuseColor( builder );\n\t\t\tthis.setupVariants( builder );\n\n\t\t\tconst outgoingLightNode = this.setupLighting( builder );\n\n\t\t\tif ( clippingNode !== null ) builder.stack.add( clippingNode );\n\n\t\t\t// force unsigned floats - useful for RenderTargets\n\n\t\t\tconst basicOutput = vec4( outgoingLightNode, diffuseColor.a ).max( 0 );\n\n\t\t\tresultNode = this.setupOutput( builder, basicOutput );\n\n\t\t\t// OUTPUT NODE\n\n\t\t\toutput.assign( resultNode );\n\n\t\t\t//\n\n\t\t\tif ( this.outputNode !== null ) resultNode = this.outputNode;\n\n\t\t\t// MRT\n\n\t\t\tconst renderTarget = builder.renderer.getRenderTarget();\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tconst mrt = builder.renderer.getMRT();\n\t\t\t\tconst materialMRT = this.mrtNode;\n\n\t\t\t\tif ( mrt !== null ) {\n\n\t\t\t\t\tresultNode = mrt;\n\n\t\t\t\t\tif ( materialMRT !== null ) {\n\n\t\t\t\t\t\tresultNode = mrt.merge( materialMRT );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( materialMRT !== null ) {\n\n\t\t\t\t\tresultNode = materialMRT;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tlet fragmentNode = this.fragmentNode;\n\n\t\t\tif ( fragmentNode.isOutputStructNode !== true ) {\n\n\t\t\t\tfragmentNode = vec4( fragmentNode );\n\n\t\t\t}\n\n\t\t\tresultNode = this.setupOutput( builder, fragmentNode );\n\n\t\t}\n\n\t\tbuilder.stack.outputNode = resultNode;\n\n\t\tbuilder.addFlow( 'fragment', builder.removeStack() );\n\n\t\t// < MONITOR >\n\n\t\tbuilder.monitor = this.setupObserver( builder );\n\n\t}\n\n\tsetupClipping( builder ) {\n\n\t\tif ( builder.clippingContext === null ) return null;\n\n\t\tconst { globalClippingCount, localClippingCount } = builder.clippingContext;\n\n\t\tlet result = null;\n\n\t\tif ( globalClippingCount || localClippingCount ) {\n\n\t\t\tconst samples = builder.renderer.samples;\n\n\t\t\tif ( this.alphaToCoverage && samples > 1 ) {\n\n\t\t\t\t// to be added to flow when the color/alpha value has been determined\n\t\t\t\tresult = clippingAlpha();\n\n\t\t\t} else {\n\n\t\t\t\tbuilder.stack.add( clipping() );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tsetupDepth( builder ) {\n\n\t\tconst { renderer, camera } = builder;\n\n\t\t// Depth\n\n\t\tlet depthNode = this.depthNode;\n\n\t\tif ( depthNode === null ) {\n\n\t\t\tconst mrt = renderer.getMRT();\n\n\t\t\tif ( mrt && mrt.has( 'depth' ) ) {\n\n\t\t\t\tdepthNode = mrt.get( 'depth' );\n\n\t\t\t} else if ( renderer.logarithmicDepthBuffer === true ) {\n\n\t\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\t\tdepthNode = perspectiveDepthToLogarithmicDepth( modelViewProjection().w, cameraNear, cameraFar );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdepthNode = viewZToOrthographicDepth( positionView.z, cameraNear, cameraFar );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( depthNode !== null ) {\n\n\t\t\tdepth.assign( depthNode ).append();\n\n\t\t}\n\n\t}\n\n\tsetupPosition( builder ) {\n\n\t\tconst { object } = builder;\n\t\tconst geometry = object.geometry;\n\n\t\tbuilder.addStack();\n\n\t\t// Vertex\n\n\t\tif ( geometry.morphAttributes.position || geometry.morphAttributes.normal || geometry.morphAttributes.color ) {\n\n\t\t\tmorphReference( object ).append();\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh === true ) {\n\n\t\t\tskinningReference( object ).append();\n\n\t\t}\n\n\t\tif ( this.displacementMap ) {\n\n\t\t\tconst displacementMap = materialReference( 'displacementMap', 'texture' );\n\t\t\tconst displacementScale = materialReference( 'displacementScale', 'float' );\n\t\t\tconst displacementBias = materialReference( 'displacementBias', 'float' );\n\n\t\t\tpositionLocal.addAssign( normalLocal.normalize().mul( ( displacementMap.x.mul( displacementScale ).add( displacementBias ) ) ) );\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tbatch( object ).append();\n\n\t\t}\n\n\t\tif ( ( object.instanceMatrix && object.instanceMatrix.isInstancedBufferAttribute === true ) ) {\n\n\t\t\tinstance( object ).append();\n\n\t\t}\n\n\t\tif ( this.positionNode !== null ) {\n\n\t\t\tpositionLocal.assign( this.positionNode );\n\n\t\t}\n\n\t\tconst mvp = modelViewProjection();\n\n\t\tbuilder.context.vertex = builder.removeStack();\n\t\tbuilder.context.mvp = mvp;\n\n\t\treturn mvp;\n\n\t}\n\n\tsetupDiffuseColor( { object, geometry } ) {\n\n\t\tlet colorNode = this.colorNode ? vec4( this.colorNode ) : materialColor;\n\n\t\t// VERTEX COLORS\n\n\t\tif ( this.vertexColors === true && geometry.hasAttribute( 'color' ) ) {\n\n\t\t\tcolorNode = vec4( colorNode.xyz.mul( attribute( 'color', 'vec3' ) ), colorNode.a );\n\n\t\t}\n\n\t\t// Instanced colors\n\n\t\tif ( object.instanceColor ) {\n\n\t\t\tconst instanceColor = varyingProperty( 'vec3', 'vInstanceColor' );\n\n\t\t\tcolorNode = instanceColor.mul( colorNode );\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh && object._colorsTexture ) {\n\n\t\t\tconst batchColor = varyingProperty( 'vec3', 'vBatchColor' );\n\n\t\t\tcolorNode = batchColor.mul( colorNode );\n\n\t\t}\n\n\n\t\t// COLOR\n\n\t\tdiffuseColor.assign( colorNode );\n\n\t\t// OPACITY\n\n\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\t\tdiffuseColor.a.assign( diffuseColor.a.mul( opacityNode ) );\n\n\t\t// ALPHA TEST\n\n\t\tif ( this.alphaTestNode !== null || this.alphaTest > 0 ) {\n\n\t\t\tconst alphaTestNode = this.alphaTestNode !== null ? float( this.alphaTestNode ) : materialAlphaTest;\n\n\t\t\tdiffuseColor.a.lessThanEqual( alphaTestNode ).discard();\n\n\t\t}\n\n\t\t// ALPHA HASH\n\n\t\tif ( this.alphaHash === true ) {\n\n\t\t\tdiffuseColor.a.lessThan( getAlphaHashThreshold( positionLocal ) ).discard();\n\n\t\t}\n\n\t\tif ( this.transparent === false && this.blending === NormalBlending && this.alphaToCoverage === false ) {\n\n\t\t\tdiffuseColor.a.assign( 1.0 );\n\n\t\t}\n\n\t}\n\n\tsetupVariants( /*builder*/ ) {\n\n\t\t// Interface function.\n\n\t}\n\n\tsetupOutgoingLight() {\n\n\t\treturn ( this.lights === true ) ? vec3( 0 ) : diffuseColor.rgb;\n\n\t}\n\n\tsetupNormal() {\n\n\t\treturn this.normalNode ? vec3( this.normalNode ) : materialNormal;\n\n\t}\n\n\tsetupEnvironment( /*builder*/ ) {\n\n\t\tlet node = null;\n\n\t\tif ( this.envNode ) {\n\n\t\t\tnode = this.envNode;\n\n\t\t} else if ( this.envMap ) {\n\n\t\t\tnode = this.envMap.isCubeTexture ? materialReference( 'envMap', 'cubeTexture' ) : materialReference( 'envMap', 'texture' );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupLightMap( builder ) {\n\n\t\tlet node = null;\n\n\t\tif ( builder.material.lightMap ) {\n\n\t\t\tnode = new IrradianceNode( materialLightMap );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupLights( builder ) {\n\n\t\tconst materialLightsNode = [];\n\n\t\t//\n\n\t\tconst envNode = this.setupEnvironment( builder );\n\n\t\tif ( envNode && envNode.isLightingNode ) {\n\n\t\t\tmaterialLightsNode.push( envNode );\n\n\t\t}\n\n\t\tconst lightMapNode = this.setupLightMap( builder );\n\n\t\tif ( lightMapNode && lightMapNode.isLightingNode ) {\n\n\t\t\tmaterialLightsNode.push( lightMapNode );\n\n\t\t}\n\n\t\tif ( this.aoNode !== null || builder.material.aoMap ) {\n\n\t\t\tconst aoNode = this.aoNode !== null ? this.aoNode : materialAOMap;\n\n\t\t\tmaterialLightsNode.push( new AONode( aoNode ) );\n\n\t\t}\n\n\t\tlet lightsN = this.lightsNode || builder.lightsNode;\n\n\t\tif ( materialLightsNode.length > 0 ) {\n\n\t\t\tlightsN = builder.renderer.lighting.createNode( [ ...lightsN.getLights(), ...materialLightsNode ] );\n\n\t\t}\n\n\t\treturn lightsN;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\t// Interface function.\n\n\t}\n\n\tsetupLighting( builder ) {\n\n\t\tconst { material } = builder;\n\t\tconst { backdropNode, backdropAlphaNode, emissiveNode } = this;\n\n\t\t// OUTGOING LIGHT\n\n\t\tconst lights = this.lights === true || this.lightsNode !== null;\n\n\t\tconst lightsNode = lights ? this.setupLights( builder ) : null;\n\n\t\tlet outgoingLightNode = this.setupOutgoingLight( builder );\n\n\t\tif ( lightsNode && lightsNode.getScope().hasLights ) {\n\n\t\t\tconst lightingModel = this.setupLightingModel( builder );\n\n\t\t\toutgoingLightNode = lightingContext( lightsNode, lightingModel, backdropNode, backdropAlphaNode );\n\n\t\t} else if ( backdropNode !== null ) {\n\n\t\t\toutgoingLightNode = vec3( backdropAlphaNode !== null ? mix( outgoingLightNode, backdropNode, backdropAlphaNode ) : backdropNode );\n\n\t\t}\n\n\t\t// EMISSIVE\n\n\t\tif ( ( emissiveNode && emissiveNode.isNode === true ) || ( material.emissive && material.emissive.isColor === true ) ) {\n\n\t\t\temissive.assign( vec3( emissiveNode ? emissiveNode : materialEmissive ) );\n\n\t\t\toutgoingLightNode = outgoingLightNode.add( emissive );\n\n\t\t}\n\n\t\treturn outgoingLightNode;\n\n\t}\n\n\tsetupOutput( builder, outputNode ) {\n\n\t\t// FOG\n\n\t\tif ( this.fog === true ) {\n\n\t\t\tconst fogNode = builder.fogNode;\n\n\t\t\tif ( fogNode ) outputNode = vec4( fogNode.mix( outputNode.rgb, fogNode.colorNode ), outputNode.a );\n\n\t\t}\n\n\t\treturn outputNode;\n\n\t}\n\n\tsetDefaultValues( material ) {\n\n\t\t// This approach is to reuse the native refreshUniforms*\n\t\t// and turn available the use of features like transmission and environment in core\n\n\t\tfor ( const property in material ) {\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tif ( this[ property ] === undefined ) {\n\n\t\t\t\tthis[ property ] = value;\n\n\t\t\t\tif ( value && value.clone ) this[ property ] = value.clone();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst descriptors = Object.getOwnPropertyDescriptors( material.constructor.prototype );\n\n\t\tfor ( const key in descriptors ) {\n\n\t\t\tif ( Object.getOwnPropertyDescriptor( this.constructor.prototype, key ) === undefined &&\n\t\t\t     descriptors[ key ].get !== undefined ) {\n\n\t\t\t\tObject.defineProperty( this.constructor.prototype, key, descriptors[ key ] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\ttoJSON( meta ) {\n\n\t\tconst isRoot = ( meta === undefined || typeof meta === 'string' );\n\n\t\tif ( isRoot ) {\n\n\t\t\tmeta = {\n\t\t\t\ttextures: {},\n\t\t\t\timages: {},\n\t\t\t\tnodes: {}\n\t\t\t};\n\n\t\t}\n\n\t\tconst data = Material.prototype.toJSON.call( this, meta );\n\t\tconst nodeChildren = getNodeChildren( this );\n\n\t\tdata.inputNodes = {};\n\n\t\tfor ( const { property, childNode } of nodeChildren ) {\n\n\t\t\tdata.inputNodes[ property ] = childNode.toJSON( meta ).uuid;\n\n\t\t}\n\n\t\t// TODO: Copied from Object3D.toJSON\n\n\t\tfunction extractFromCache( cache ) {\n\n\t\t\tconst values = [];\n\n\t\t\tfor ( const key in cache ) {\n\n\t\t\t\tconst data = cache[ key ];\n\t\t\t\tdelete data.metadata;\n\t\t\t\tvalues.push( data );\n\n\t\t\t}\n\n\t\t\treturn values;\n\n\t\t}\n\n\t\tif ( isRoot ) {\n\n\t\t\tconst textures = extractFromCache( meta.textures );\n\t\t\tconst images = extractFromCache( meta.images );\n\t\t\tconst nodes = extractFromCache( meta.nodes );\n\n\t\t\tif ( textures.length > 0 ) data.textures = textures;\n\t\t\tif ( images.length > 0 ) data.images = images;\n\t\t\tif ( nodes.length > 0 ) data.nodes = nodes;\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.lightsNode = source.lightsNode;\n\t\tthis.envNode = source.envNode;\n\n\t\tthis.colorNode = source.colorNode;\n\t\tthis.normalNode = source.normalNode;\n\t\tthis.opacityNode = source.opacityNode;\n\t\tthis.backdropNode = source.backdropNode;\n\t\tthis.backdropAlphaNode = source.backdropAlphaNode;\n\t\tthis.alphaTestNode = source.alphaTestNode;\n\n\t\tthis.positionNode = source.positionNode;\n\t\tthis.geometryNode = source.geometryNode;\n\n\t\tthis.depthNode = source.depthNode;\n\t\tthis.shadowNode = source.shadowNode;\n\t\tthis.shadowPositionNode = source.shadowPositionNode;\n\n\t\tthis.outputNode = source.outputNode;\n\t\tthis.mrtNode = source.mrtNode;\n\n\t\tthis.fragmentNode = source.fragmentNode;\n\t\tthis.vertexNode = source.vertexNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst _defaultValues$e = /*@__PURE__*/ new PointsMaterial();\n\nclass InstancedPointsNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'InstancedPointsNodeMaterial';\n\n\t}\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.useAlphaToCoverage = true;\n\n\t\tthis.useColor = params.vertexColors;\n\n\t\tthis.pointWidth = 1;\n\n\t\tthis.pointColorNode = null;\n\n\t\tthis.pointWidthNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$e );\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupShaders( builder );\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tsetupShaders( { renderer } ) {\n\n\t\tconst useAlphaToCoverage = this.alphaToCoverage;\n\t\tconst useColor = this.useColor;\n\n\t\tthis.vertexNode = Fn( () => {\n\n\t\t\tconst instancePosition = attribute( 'instancePosition' ).xyz;\n\n\t\t\t// camera space\n\t\t\tconst mvPos = vec4( modelViewMatrix.mul( vec4( instancePosition, 1.0 ) ) );\n\n\t\t\tconst aspect = viewport.z.div( viewport.w );\n\n\t\t\t// clip space\n\t\t\tconst clipPos = cameraProjectionMatrix.mul( mvPos );\n\n\t\t\t// offset in ndc space\n\t\t\tconst offset = positionGeometry.xy.toVar();\n\n\t\t\toffset.mulAssign( this.pointWidthNode ? this.pointWidthNode : materialPointWidth );\n\n\t\t\toffset.assign( offset.div( viewport.z ) );\n\t\t\toffset.y.assign( offset.y.mul( aspect ) );\n\n\t\t\t// back to clip space\n\t\t\toffset.assign( offset.mul( clipPos.w ) );\n\n\t\t\t//clipPos.xy += offset;\n\t\t\tclipPos.addAssign( vec4( offset, 0, 0 ) );\n\n\t\t\treturn clipPos;\n\n\t\t} )();\n\n\t\tthis.fragmentNode = Fn( () => {\n\n\t\t\tconst alpha = float( 1 ).toVar();\n\n\t\t\tconst len2 = lengthSq( uv().mul( 2 ).sub( 1 ) );\n\n\t\t\tif ( useAlphaToCoverage && renderer.samples > 1 ) {\n\n\t\t\t\tconst dlen = float( len2.fwidth() ).toVar();\n\n\t\t\t\talpha.assign( smoothstep( dlen.oneMinus(), dlen.add( 1 ), len2 ).oneMinus() );\n\n\t\t\t} else {\n\n\t\t\t\tlen2.greaterThan( 1.0 ).discard();\n\n\t\t\t}\n\n\t\t\tlet pointColorNode;\n\n\t\t\tif ( this.pointColorNode ) {\n\n\t\t\t\tpointColorNode = this.pointColorNode;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useColor ) {\n\n\t\t\t\t\tconst instanceColor = attribute( 'instanceColor' );\n\n\t\t\t\t\tpointColorNode = instanceColor.mul( materialColor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tpointColorNode = materialColor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\talpha.mulAssign( materialOpacity );\n\n\t\t\treturn vec4( pointColorNode, alpha );\n\n\t\t} )();\n\n\t}\n\n\tget alphaToCoverage() {\n\n\t\treturn this.useAlphaToCoverage;\n\n\t}\n\n\tset alphaToCoverage( value ) {\n\n\t\tif ( this.useAlphaToCoverage !== value ) {\n\n\t\t\tthis.useAlphaToCoverage = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nconst _defaultValues$d = /*@__PURE__*/ new LineBasicMaterial();\n\nclass LineBasicNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'LineBasicNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineBasicNodeMaterial = true;\n\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( _defaultValues$d );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n}\n\nconst _defaultValues$c = /*@__PURE__*/ new LineDashedMaterial();\n\nclass LineDashedNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'LineDashedNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isLineDashedNodeMaterial = true;\n\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( _defaultValues$c );\n\n\t\tthis.offsetNode = null;\n\t\tthis.dashScaleNode = null;\n\t\tthis.dashSizeNode = null;\n\t\tthis.gapSizeNode = null;\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupVariants() {\n\n\t\tconst offsetNode = this.offsetNode;\n\t\tconst dashScaleNode = this.dashScaleNode ? float( this.dashScaleNode ) : materialLineScale;\n\t\tconst dashSizeNode = this.dashSizeNode ? float( this.dashSizeNode ) : materialLineDashSize;\n\t\tconst gapSizeNode = this.dashSizeNode ? float( this.dashGapNode ) : materialLineGapSize;\n\n\t\tdashSize.assign( dashSizeNode );\n\t\tgapSize.assign( gapSizeNode );\n\n\t\tconst vLineDistance = varying( attribute( 'lineDistance' ).mul( dashScaleNode ) );\n\t\tconst vLineDistanceOffset = offsetNode ? vLineDistance.add( offsetNode ) : vLineDistance;\n\n\t\tvLineDistanceOffset.mod( dashSize.add( gapSize ) ).greaterThan( dashSize ).discard();\n\n\t}\n\n}\n\nconst _defaultValues$b = /*@__PURE__*/ new LineDashedMaterial();\n\nclass Line2NodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'Line2NodeMaterial';\n\n\t}\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.setDefaultValues( _defaultValues$b );\n\n\t\tthis.useAlphaToCoverage = true;\n\t\tthis.useColor = params.vertexColors;\n\t\tthis.useDash = params.dashed;\n\t\tthis.useWorldUnits = false;\n\n\t\tthis.dashOffset = 0;\n\t\tthis.lineWidth = 1;\n\n\t\tthis.lineColorNode = null;\n\n\t\tthis.offsetNode = null;\n\t\tthis.dashScaleNode = null;\n\t\tthis.dashSizeNode = null;\n\t\tthis.gapSizeNode = null;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.setupShaders( builder );\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tsetupShaders( { renderer } ) {\n\n\t\tconst useAlphaToCoverage = this.alphaToCoverage;\n\t\tconst useColor = this.useColor;\n\t\tconst useDash = this.dashed;\n\t\tconst useWorldUnits = this.worldUnits;\n\n\t\tconst trimSegment = Fn( ( { start, end } ) => {\n\n\t\t\tconst a = cameraProjectionMatrix.element( 2 ).element( 2 ); // 3nd entry in 3th column\n\t\t\tconst b = cameraProjectionMatrix.element( 3 ).element( 2 ); // 3nd entry in 4th column\n\t\t\tconst nearEstimate = b.mul( - 0.5 ).div( a );\n\n\t\t\tconst alpha = nearEstimate.sub( start.z ).div( end.z.sub( start.z ) );\n\n\t\t\treturn vec4( mix( start.xyz, end.xyz, alpha ), end.w );\n\n\t\t} ).setLayout( {\n\t\t\tname: 'trimSegment',\n\t\t\ttype: 'vec4',\n\t\t\tinputs: [\n\t\t\t\t{ name: 'start', type: 'vec4' },\n\t\t\t\t{ name: 'end', type: 'vec4' }\n\t\t\t]\n\t\t} );\n\n\t\tthis.vertexNode = Fn( () => {\n\n\t\t\tconst instanceStart = attribute( 'instanceStart' );\n\t\t\tconst instanceEnd = attribute( 'instanceEnd' );\n\n\t\t\t// camera space\n\n\t\t\tconst start = vec4( modelViewMatrix.mul( vec4( instanceStart, 1.0 ) ) ).toVar( 'start' );\n\t\t\tconst end = vec4( modelViewMatrix.mul( vec4( instanceEnd, 1.0 ) ) ).toVar( 'end' );\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\tvaryingProperty( 'vec3', 'worldStart' ).assign( start.xyz );\n\t\t\t\tvaryingProperty( 'vec3', 'worldEnd' ).assign( end.xyz );\n\n\t\t\t}\n\n\t\t\tconst aspect = viewport.z.div( viewport.w );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tconst perspective = cameraProjectionMatrix.element( 2 ).element( 3 ).equal( - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tIf( perspective, () => {\n\n\t\t\t\tIf( start.z.lessThan( 0.0 ).and( end.z.greaterThan( 0.0 ) ), () => {\n\n\t\t\t\t\tend.assign( trimSegment( { start: start, end: end } ) );\n\n\t\t\t\t} ).ElseIf( end.z.lessThan( 0.0 ).and( start.z.greaterThanEqual( 0.0 ) ), () => {\n\n\t\t\t\t\tstart.assign( trimSegment( { start: end, end: start } ) );\n\n\t\t\t \t} );\n\n\t\t\t} );\n\n\t\t\t// clip space\n\t\t\tconst clipStart = cameraProjectionMatrix.mul( start );\n\t\t\tconst clipEnd = cameraProjectionMatrix.mul( end );\n\n\t\t\t// ndc space\n\t\t\tconst ndcStart = clipStart.xyz.div( clipStart.w );\n\t\t\tconst ndcEnd = clipEnd.xyz.div( clipEnd.w );\n\n\t\t\t// direction\n\t\t\tconst dir = ndcEnd.xy.sub( ndcStart.xy ).toVar();\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x.assign( dir.x.mul( aspect ) );\n\t\t\tdir.assign( dir.normalize() );\n\n\t\t\tconst clip = vec4().toVar();\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\n\t\t\t\tconst worldDir = end.xyz.sub( start.xyz ).normalize();\n\t\t\t\tconst tmpFwd = mix( start.xyz, end.xyz, 0.5 ).normalize();\n\t\t\t\tconst worldUp = worldDir.cross( tmpFwd ).normalize();\n\t\t\t\tconst worldFwd = worldDir.cross( worldUp );\n\n\t\t\t\tconst worldPos = varyingProperty( 'vec4', 'worldPos' );\n\n\t\t\t\tworldPos.assign( positionGeometry.y.lessThan( 0.5 ).select( start, end ) );\n\n\t\t\t\t// height offset\n\t\t\t\tconst hw = materialLineWidth.mul( 0.5 );\n\t\t\t\tworldPos.addAssign( vec4( positionGeometry.x.lessThan( 0.0 ).select( worldUp.mul( hw ), worldUp.mul( hw ).negate() ), 0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\tif ( ! useDash ) {\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.addAssign( vec4( positionGeometry.y.lessThan( 0.5 ).select( worldDir.mul( hw ).negate(), worldDir.mul( hw ) ), 0 ) );\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.addAssign( vec4( worldFwd.mul( hw ), 0 ) );\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tIf( positionGeometry.y.greaterThan( 1.0 ).or( positionGeometry.y.lessThan( 0.0 ) ), () => {\n\n\t\t\t\t\t\tworldPos.subAssign( vec4( worldFwd.mul( 2.0 ).mul( hw ), 0 ) );\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\t// project the worldpos\n\t\t\t\tclip.assign( cameraProjectionMatrix.mul( worldPos ) );\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tconst clipPose = vec3().toVar();\n\n\t\t\t\tclipPose.assign( positionGeometry.y.lessThan( 0.5 ).select( ndcStart, ndcEnd ) );\n\t\t\t\tclip.z.assign( clipPose.z.mul( clip.w ) );\n\n\t\t\t} else {\n\n\t\t\t\tconst offset = vec2( dir.y, dir.x.negate() ).toVar( 'offset' );\n\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x.assign( dir.x.div( aspect ) );\n\t\t\t\toffset.x.assign( offset.x.div( aspect ) );\n\n\t\t\t\t// sign flip\n\t\t\t\toffset.assign( positionGeometry.x.lessThan( 0.0 ).select( offset.negate(), offset ) );\n\n\t\t\t\t// endcaps\n\t\t\t\tIf( positionGeometry.y.lessThan( 0.0 ), () => {\n\n\t\t\t\t\toffset.assign( offset.sub( dir ) );\n\n\t\t\t\t} ).ElseIf( positionGeometry.y.greaterThan( 1.0 ), () => {\n\n\t\t\t\t\toffset.assign( offset.add( dir ) );\n\n\t\t\t\t} );\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset.assign( offset.mul( materialLineWidth ) );\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset.assign( offset.div( viewport.w ) );\n\n\t\t\t\t// select end\n\t\t\t\tclip.assign( positionGeometry.y.lessThan( 0.5 ).select( clipStart, clipEnd ) );\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset.assign( offset.mul( clip.w ) );\n\n\t\t\t\tclip.assign( clip.add( vec4( offset, 0, 0 ) ) );\n\n\t\t\t}\n\n\t\t\treturn clip;\n\n\t\t} )();\n\n\t\tconst closestLineToLine = Fn( ( { p1, p2, p3, p4 } ) => {\n\n\t\t\tconst p13 = p1.sub( p3 );\n\t\t\tconst p43 = p4.sub( p3 );\n\n\t\t\tconst p21 = p2.sub( p1 );\n\n\t\t\tconst d1343 = p13.dot( p43 );\n\t\t\tconst d4321 = p43.dot( p21 );\n\t\t\tconst d1321 = p13.dot( p21 );\n\t\t\tconst d4343 = p43.dot( p43 );\n\t\t\tconst d2121 = p21.dot( p21 );\n\n\t\t\tconst denom = d2121.mul( d4343 ).sub( d4321.mul( d4321 ) );\n\t\t\tconst numer = d1343.mul( d4321 ).sub( d1321.mul( d4343 ) );\n\n\t\t\tconst mua = numer.div( denom ).clamp();\n\t\t\tconst mub = d1343.add( d4321.mul( mua ) ).div( d4343 ).clamp();\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t} );\n\n\t\tthis.fragmentNode = Fn( () => {\n\n\t\t\tconst vUv = uv();\n\n\t\t\tif ( useDash ) {\n\n\t\t\t\tconst offsetNode = this.offsetNode ? float( this.offsetNodeNode ) : materialLineDashOffset;\n\t\t\t\tconst dashScaleNode = this.dashScaleNode ? float( this.dashScaleNode ) : materialLineScale;\n\t\t\t\tconst dashSizeNode = this.dashSizeNode ? float( this.dashSizeNode ) : materialLineDashSize;\n\t\t\t\tconst gapSizeNode = this.dashSizeNode ? float( this.dashGapNode ) : materialLineGapSize;\n\n\t\t\t\tdashSize.assign( dashSizeNode );\n\t\t\t\tgapSize.assign( gapSizeNode );\n\n\t\t\t\tconst instanceDistanceStart = attribute( 'instanceDistanceStart' );\n\t\t\t\tconst instanceDistanceEnd = attribute( 'instanceDistanceEnd' );\n\n\t\t\t\tconst lineDistance = positionGeometry.y.lessThan( 0.5 ).select( dashScaleNode.mul( instanceDistanceStart ), materialLineScale.mul( instanceDistanceEnd ) );\n\n\t\t\t\tconst vLineDistance = varying( lineDistance.add( materialLineDashOffset ) );\n\t\t\t\tconst vLineDistanceOffset = offsetNode ? vLineDistance.add( offsetNode ) : vLineDistance;\n\n\t\t\t\tvUv.y.lessThan( - 1.0 ).or( vUv.y.greaterThan( 1.0 ) ).discard(); // discard endcaps\n\t\t\t\tvLineDistanceOffset.mod( dashSize.add( gapSize ) ).greaterThan( dashSize ).discard(); // todo - FIX\n\n\t\t\t}\n\n\t\t\tconst alpha = float( 1 ).toVar( 'alpha' );\n\n\t\t\tif ( useWorldUnits ) {\n\n\t\t\t\tconst worldStart = varyingProperty( 'vec3', 'worldStart' );\n\t\t\t\tconst worldEnd = varyingProperty( 'vec3', 'worldEnd' );\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tconst rayEnd = varyingProperty( 'vec4', 'worldPos' ).xyz.normalize().mul( 1e5 );\n\t\t\t\tconst lineDir = worldEnd.sub( worldStart );\n\t\t\t\tconst params = closestLineToLine( { p1: worldStart, p2: worldEnd, p3: vec3( 0.0, 0.0, 0.0 ), p4: rayEnd } );\n\n\t\t\t\tconst p1 = worldStart.add( lineDir.mul( params.x ) );\n\t\t\t\tconst p2 = rayEnd.mul( params.y );\n\t\t\t\tconst delta = p1.sub( p2 );\n\t\t\t\tconst len = delta.length();\n\t\t\t\tconst norm = len.div( materialLineWidth );\n\n\t\t\t\tif ( ! useDash ) {\n\n\t\t\t\t\tif ( useAlphaToCoverage && renderer.samples > 1 ) {\n\n\t\t\t\t\t\tconst dnorm = norm.fwidth();\n\t\t\t\t\t\talpha.assign( smoothstep( dnorm.negate().add( 0.5 ), dnorm.add( 0.5 ), norm ).oneMinus() );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnorm.greaterThan( 0.5 ).discard();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// round endcaps\n\n\t\t\t\tif ( useAlphaToCoverage && renderer.samples > 1 ) {\n\n\t\t\t\t\tconst a = vUv.x;\n\t\t\t\t\tconst b = vUv.y.greaterThan( 0.0 ).select( vUv.y.sub( 1.0 ), vUv.y.add( 1.0 ) );\n\n\t\t\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\t\t\tconst dlen = float( len2.fwidth() ).toVar( 'dlen' );\n\n\t\t\t\t\tIf( vUv.y.abs().greaterThan( 1.0 ), () => {\n\n\t\t\t\t\t\talpha.assign( smoothstep( dlen.oneMinus(), dlen.add( 1 ), len2 ).oneMinus() );\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tIf( vUv.y.abs().greaterThan( 1.0 ), () => {\n\n\t\t\t\t\t\tconst a = vUv.x;\n\t\t\t\t\t\tconst b = vUv.y.greaterThan( 0.0 ).select( vUv.y.sub( 1.0 ), vUv.y.add( 1.0 ) );\n\t\t\t\t\t\tconst len2 = a.mul( a ).add( b.mul( b ) );\n\n\t\t\t\t\t\tlen2.greaterThan( 1.0 ).discard();\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tlet lineColorNode;\n\n\t\t\tif ( this.lineColorNode ) {\n\n\t\t\t\tlineColorNode = this.lineColorNode;\n\n\t\t\t} else {\n\n\t\t\t\tif ( useColor ) {\n\n\t\t\t\t\tconst instanceColorStart = attribute( 'instanceColorStart' );\n\t\t\t\t\tconst instanceColorEnd = attribute( 'instanceColorEnd' );\n\n\t\t\t\t\tconst instanceColor = positionGeometry.y.lessThan( 0.5 ).select( instanceColorStart, instanceColorEnd );\n\n\t\t\t\t\tlineColorNode = instanceColor.mul( materialColor );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tlineColorNode = materialColor;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn vec4( lineColorNode, alpha );\n\n\t\t} )();\n\n\t}\n\n\n\tget worldUnits() {\n\n\t\treturn this.useWorldUnits;\n\n\t}\n\n\tset worldUnits( value ) {\n\n\t\tif ( this.useWorldUnits !== value ) {\n\n\t\t\tthis.useWorldUnits = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\n\tget dashed() {\n\n\t\treturn this.useDash;\n\n\t}\n\n\tset dashed( value ) {\n\n\t\tif ( this.useDash !== value ) {\n\n\t\t\tthis.useDash = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n\n\tget alphaToCoverage() {\n\n\t\treturn this.useAlphaToCoverage;\n\n\t}\n\n\tset alphaToCoverage( value ) {\n\n\t\tif ( this.useAlphaToCoverage !== value ) {\n\n\t\t\tthis.useAlphaToCoverage = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nconst directionToColor = ( node ) => nodeObject( node ).mul( 0.5 ).add( 0.5 );\nconst colorToDirection = ( node ) => nodeObject( node ).mul( 2.0 ).sub( 1 );\n\nconst _defaultValues$a = /*@__PURE__*/ new MeshNormalMaterial();\n\nclass MeshNormalNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshNormalNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.isMeshNormalNodeMaterial = true;\n\n\t\tthis.setDefaultValues( _defaultValues$a );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupDiffuseColor() {\n\n\t\tconst opacityNode = this.opacityNode ? float( this.opacityNode ) : materialOpacity;\n\n\t\tdiffuseColor.assign( vec4( directionToColor( transformedNormalView ), opacityNode ) );\n\n\t}\n\n}\n\nclass EquirectUVNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'EquirectUVNode';\n\n\t}\n\n\tconstructor( dirNode = positionWorldDirection ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.dirNode = dirNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst dir = this.dirNode;\n\n\t\tconst u = dir.z.atan2( dir.x ).mul( 1 / ( Math.PI * 2 ) ).add( 0.5 );\n\t\tconst v = dir.y.clamp( - 1.0, 1.0 ).asin().mul( 1 / Math.PI ).add( 0.5 );\n\n\t\treturn vec2( u, v );\n\n\t}\n\n}\n\nconst equirectUV = /*@__PURE__*/ nodeProxy( EquirectUVNode );\n\n// @TODO: Consider rename WebGLCubeRenderTarget to just CubeRenderTarget\n\nclass CubeRenderTarget extends WebGLCubeRenderTarget {\n\n\tconstructor( size = 1, options = {} ) {\n\n\t\tsuper( size, options );\n\n\t\tthis.isCubeRenderTarget = true;\n\n\t}\n\n\tfromEquirectangularTexture( renderer, texture$1 ) {\n\n\t\tconst currentMinFilter = texture$1.minFilter;\n\t\tconst currentGenerateMipmaps = texture$1.generateMipmaps;\n\n\t\ttexture$1.generateMipmaps = true;\n\n\t\tthis.texture.type = texture$1.type;\n\t\tthis.texture.colorSpace = texture$1.colorSpace;\n\n\t\tthis.texture.generateMipmaps = texture$1.generateMipmaps;\n\t\tthis.texture.minFilter = texture$1.minFilter;\n\t\tthis.texture.magFilter = texture$1.magFilter;\n\n\t\tconst geometry = new BoxGeometry( 5, 5, 5 );\n\n\t\tconst uvNode = equirectUV( positionWorldDirection );\n\n\t\tconst material = new NodeMaterial();\n\t\tmaterial.colorNode = texture( texture$1, uvNode, 0 );\n\t\tmaterial.side = BackSide;\n\t\tmaterial.blending = NoBlending;\n\n\t\tconst mesh = new Mesh( geometry, material );\n\n\t\tconst scene = new Scene();\n\t\tscene.add( mesh );\n\n\t\t// Avoid blurred poles\n\t\tif ( texture$1.minFilter === LinearMipmapLinearFilter ) texture$1.minFilter = LinearFilter;\n\n\t\tconst camera = new CubeCamera( 1, 10, this );\n\n\t\tconst currentMRT = renderer.getMRT();\n\t\trenderer.setMRT( null );\n\n\t\tcamera.update( renderer, scene );\n\n\t\trenderer.setMRT( currentMRT );\n\n\t\ttexture$1.minFilter = currentMinFilter;\n\t\ttexture$1.currentGenerateMipmaps = currentGenerateMipmaps;\n\n\t\tmesh.geometry.dispose();\n\t\tmesh.material.dispose();\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst _cache$1 = new WeakMap();\n\nclass CubeMapNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'CubeMapNode';\n\n\t}\n\n\tconstructor( envNode ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.envNode = envNode;\n\n\t\tthis._cubeTexture = null;\n\t\tthis._cubeTextureNode = cubeTexture();\n\n\t\tconst defaultTexture = new CubeTexture();\n\t\tdefaultTexture.isRenderTargetTexture = true;\n\n\t\tthis._defaultTexture = defaultTexture;\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer, material } = frame;\n\n\t\tconst envNode = this.envNode;\n\n\t\tif ( envNode.isTextureNode || envNode.isMaterialReferenceNode ) {\n\n\t\t\tconst texture = ( envNode.isTextureNode ) ? envNode.value : material[ envNode.property ];\n\n\t\t\tif ( texture && texture.isTexture ) {\n\n\t\t\t\tconst mapping = texture.mapping;\n\n\t\t\t\tif ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) {\n\n\t\t\t\t\t// check for converted cubemap map\n\n\t\t\t\t\tif ( _cache$1.has( texture ) ) {\n\n\t\t\t\t\t\tconst cubeMap = _cache$1.get( texture );\n\n\t\t\t\t\t\tmapTextureMapping( cubeMap, texture.mapping );\n\t\t\t\t\t\tthis._cubeTexture = cubeMap;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// create cube map from equirectangular map\n\n\t\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\t\tif ( isEquirectangularMapReady$1( image ) ) {\n\n\t\t\t\t\t\t\tconst renderTarget = new CubeRenderTarget( image.height );\n\t\t\t\t\t\t\trenderTarget.fromEquirectangularTexture( renderer, texture );\n\n\t\t\t\t\t\t\tmapTextureMapping( renderTarget.texture, texture.mapping );\n\t\t\t\t\t\t\tthis._cubeTexture = renderTarget.texture;\n\n\t\t\t\t\t\t\t_cache$1.set( texture, renderTarget.texture );\n\n\t\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// default cube texture as fallback when equirectangular texture is not yet loaded\n\n\t\t\t\t\t\t\tthis._cubeTexture = this._defaultTexture;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t//\n\n\t\t\t\t\tthis._cubeTextureNode.value = this._cubeTexture;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// envNode already refers to a cube map\n\n\t\t\t\t\tthis._cubeTextureNode = this.envNode;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.updateBefore( builder );\n\n\t\treturn this._cubeTextureNode;\n\n\t}\n\n}\n\nfunction isEquirectangularMapReady$1( image ) {\n\n\tif ( image === null || image === undefined ) return false;\n\n\treturn image.height > 0;\n\n}\n\nfunction onTextureDispose( event ) {\n\n\tconst texture = event.target;\n\n\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\tconst renderTarget = _cache$1.get( texture );\n\n\tif ( renderTarget !== undefined ) {\n\n\t\t_cache$1.delete( texture );\n\n\t\trenderTarget.dispose();\n\n\t}\n\n}\n\nfunction mapTextureMapping( texture, mapping ) {\n\n\tif ( mapping === EquirectangularReflectionMapping ) {\n\n\t\ttexture.mapping = CubeReflectionMapping;\n\n\t} else if ( mapping === EquirectangularRefractionMapping ) {\n\n\t\ttexture.mapping = CubeRefractionMapping;\n\n\t}\n\n}\n\nconst cubeMapNode = /*@__PURE__*/ nodeProxy( CubeMapNode );\n\nclass BasicEnvironmentNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'BasicEnvironmentNode';\n\n\t}\n\n\tconstructor( envNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.envNode = envNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// environment property is used in the finish() method of BasicLightingModel\n\n\t\tbuilder.context.environment = cubeMapNode( this.envNode );\n\n\t}\n\n}\n\nclass BasicLightMapNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'BasicLightMapNode';\n\n\t}\n\n\tconstructor( lightMapNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.lightMapNode = lightMapNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// irradianceLightMap property is used in the indirectDiffuse() method of BasicLightingModel\n\n\t\tconst RECIPROCAL_PI = float( 1 / Math.PI );\n\n\t\tbuilder.context.irradianceLightMap = this.lightMapNode.mul( RECIPROCAL_PI );\n\n\t}\n\n}\n\nclass LightingModel {\n\n\tstart( /*input, stack, builder*/ ) { }\n\n\tfinish( /*input, stack, builder*/ ) { }\n\n\tdirect( /*input, stack, builder*/ ) { }\n\n\tdirectRectArea( /*input, stack, builder*/ ) {}\n\n\tindirect( /*input, stack, builder*/ ) { }\n\n\tambientOcclusion( /*input, stack, builder*/ ) { }\n\n}\n\nclass BasicLightingModel extends LightingModel {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t}\n\n\tindirect( context, stack, builder ) {\n\n\t\tconst ambientOcclusion = context.ambientOcclusion;\n\t\tconst reflectedLight = context.reflectedLight;\n\t\tconst irradianceLightMap = builder.context.irradianceLightMap;\n\n\t\treflectedLight.indirectDiffuse.assign( vec4( 0.0 ) );\n\n\t\t// accumulation (baked indirect lighting only)\n\n\t\tif ( irradianceLightMap ) {\n\n\t\t\treflectedLight.indirectDiffuse.addAssign( irradianceLightMap );\n\n\t\t} else {\n\n\t\t\treflectedLight.indirectDiffuse.addAssign( vec4( 1.0, 1.0, 1.0, 0.0 ) );\n\n\t\t}\n\n\t\t// modulation\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\n\t\treflectedLight.indirectDiffuse.mulAssign( diffuseColor.rgb );\n\n\t}\n\n\tfinish( context, stack, builder ) {\n\n\t\tconst material = builder.material;\n\t\tconst outgoingLight = context.outgoingLight;\n\t\tconst envNode = builder.context.environment;\n\n\t\tif ( envNode ) {\n\n\t\t\tswitch ( material.combine ) {\n\n\t\t\t\tcase MultiplyOperation:\n\t\t\t\t\toutgoingLight.rgb.assign( mix( outgoingLight.rgb, outgoingLight.rgb.mul( envNode.rgb ), materialSpecularStrength.mul( materialReflectivity ) ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase MixOperation:\n\t\t\t\t\toutgoingLight.rgb.assign( mix( outgoingLight.rgb, envNode.rgb, materialSpecularStrength.mul( materialReflectivity ) ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AddOperation:\n\t\t\t\t\toutgoingLight.rgb.addAssign( envNode.rgb.mul( materialSpecularStrength.mul( materialReflectivity ) ) );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.BasicLightingModel: Unsupported .combine value:', material.combine );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst _defaultValues$9 = /*@__PURE__*/ new MeshBasicMaterial();\n\nclass MeshBasicNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshBasicNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshBasicNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues$9 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupNormal() {\n\n\t\treturn normalView; // see #28839\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tconst envNode = super.setupEnvironment( builder );\n\n\t\treturn envNode ? new BasicEnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightMap( builder ) {\n\n\t\tlet node = null;\n\n\t\tif ( builder.material.lightMap ) {\n\n\t\t\tnode = new BasicLightMapNode( materialLightMap );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tsetupOutgoingLight() {\n\n\t\treturn diffuseColor.rgb;\n\n\t}\n\n\tsetupLightingModel() {\n\n\t\treturn new BasicLightingModel();\n\n\t}\n\n}\n\nconst F_Schlick = /*@__PURE__*/ Fn( ( { f0, f90, dotVH } ) => {\n\n\t// Original approximation by Christophe Schlick '94\n\t// float fresnel = pow( 1.0 - dotVH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH '13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tconst fresnel = dotVH.mul( - 5.55473 ).sub( 6.98316 ).mul( dotVH ).exp2();\n\n\treturn f0.mul( fresnel.oneMinus() ).add( f90.mul( fresnel ) );\n\n} ); // validated\n\nconst BRDF_Lambert = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\treturn inputs.diffuseColor.mul( 1 / Math.PI ); // punctual light\n\n} ); // validated\n\nconst G_BlinnPhong_Implicit = () => float( 0.25 );\n\nconst D_BlinnPhong = /*@__PURE__*/ Fn( ( { dotNH } ) => {\n\n\treturn shininess.mul( float( 0.5 ) ).add( 1.0 ).mul( float( 1 / Math.PI ) ).mul( dotNH.pow( shininess ) );\n\n} );\n\nconst BRDF_BlinnPhong = /*@__PURE__*/ Fn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tconst F = F_Schlick( { f0: specularColor, f90: 1.0, dotVH } );\n\tconst G = G_BlinnPhong_Implicit();\n\tconst D = D_BlinnPhong( { dotNH } );\n\n\treturn F.mul( G ).mul( D );\n\n} );\n\nclass PhongLightingModel extends BasicLightingModel {\n\n\tconstructor( specular = true ) {\n\n\t\tsuper();\n\n\t\tthis.specular = specular;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\tif ( this.specular === true ) {\n\n\t\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_BlinnPhong( { lightDirection } ) ).mul( materialSpecularStrength ) );\n\n\t\t}\n\n\t}\n\n\tindirect( { ambientOcclusion, irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\n\t}\n\n}\n\nconst _defaultValues$8 = /*@__PURE__*/ new MeshLambertMaterial();\n\nclass MeshLambertNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshLambertNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshLambertNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues$8 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tconst envNode = super.setupEnvironment( builder );\n\n\t\treturn envNode ? new BasicEnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhongLightingModel( false ); // ( specular ) -> force lambert\n\n\t}\n\n}\n\nconst _defaultValues$7 = /*@__PURE__*/ new MeshPhongMaterial();\n\nclass MeshPhongNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshPhongNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhongNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.shininessNode = null;\n\t\tthis.specularNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$7 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tconst envNode = super.setupEnvironment( builder );\n\n\t\treturn envNode ? new BasicEnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhongLightingModel();\n\n\t}\n\n\tsetupVariants() {\n\n\t\t// SHININESS\n\n\t\tconst shininessNode = ( this.shininessNode ? float( this.shininessNode ) : materialShininess ).max( 1e-4 ); // to prevent pow( 0.0, 0.0 )\n\n\t\tshininess.assign( shininessNode );\n\n\t\t// SPECULAR COLOR\n\n\t\tconst specularNode = this.specularNode || materialSpecular;\n\n\t\tspecularColor.assign( specularNode );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.shininessNode = source.shininessNode;\n\t\tthis.specularNode = source.specularNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst getGeometryRoughness = /*@__PURE__*/ Fn( ( builder ) => {\n\n\tif ( builder.geometry.hasAttribute( 'normal' ) === false ) {\n\n\t\treturn float( 0 );\n\n\t}\n\n\tconst dxy = normalView.dFdx().abs().max( normalView.dFdy().abs() );\n\tconst geometryRoughness = dxy.x.max( dxy.y ).max( dxy.z );\n\n\treturn geometryRoughness;\n\n} );\n\nconst getRoughness = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { roughness } = inputs;\n\n\tconst geometryRoughness = getGeometryRoughness();\n\n\tlet roughnessFactor = roughness.max( 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.\n\troughnessFactor = roughnessFactor.add( geometryRoughness );\n\troughnessFactor = roughnessFactor.min( 1.0 );\n\n\treturn roughnessFactor;\n\n} );\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nconst V_GGX_SmithCorrelated = /*@__PURE__*/ Fn( ( { alpha, dotNL, dotNV } ) => {\n\n\tconst a2 = alpha.pow2();\n\n\tconst gv = dotNL.mul( a2.add( a2.oneMinus().mul( dotNV.pow2() ) ).sqrt() );\n\tconst gl = dotNV.mul( a2.add( a2.oneMinus().mul( dotNL.pow2() ) ).sqrt() );\n\n\treturn div( 0.5, gv.add( gl ).max( EPSILON ) );\n\n} ).setLayout( {\n\tname: 'V_GGX_SmithCorrelated',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alpha', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' },\n\t\t{ name: 'dotNV', type: 'float' }\n\t]\n} ); // validated\n\n// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf\n\nconst V_GGX_SmithCorrelated_Anisotropic = /*@__PURE__*/ Fn( ( { alphaT, alphaB, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL } ) => {\n\n\tconst gv = dotNL.mul( vec3( alphaT.mul( dotTV ), alphaB.mul( dotBV ), dotNV ).length() );\n\tconst gl = dotNV.mul( vec3( alphaT.mul( dotTL ), alphaB.mul( dotBL ), dotNL ).length() );\n\tconst v = div( 0.5, gv.add( gl ) );\n\n\treturn v.saturate();\n\n} ).setLayout( {\n\tname: 'V_GGX_SmithCorrelated_Anisotropic',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alphaT', type: 'float', qualifier: 'in' },\n\t\t{ name: 'alphaB', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTL', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBL', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNV', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNL', type: 'float', qualifier: 'in' }\n\t]\n} );\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is \"roughness squared\" in Disney’s reparameterization\nconst D_GGX = /*@__PURE__*/ Fn( ( { alpha, dotNH } ) => {\n\n\tconst a2 = alpha.pow2();\n\n\tconst denom = dotNH.pow2().mul( a2.oneMinus() ).oneMinus(); // avoid alpha = 0 with dotNH = 1\n\n\treturn a2.div( denom.pow2() ).mul( 1 / Math.PI );\n\n} ).setLayout( {\n\tname: 'D_GGX',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alpha', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} ); // validated\n\nconst RECIPROCAL_PI = /*@__PURE__*/ float( 1 / Math.PI );\n\n// https://google.github.io/filament/Filament.md.html#materialsystem/anisotropicmodel/anisotropicspecularbrdf\n\nconst D_GGX_Anisotropic = /*@__PURE__*/ Fn( ( { alphaT, alphaB, dotNH, dotTH, dotBH } ) => {\n\n\tconst a2 = alphaT.mul( alphaB );\n\tconst v = vec3( alphaB.mul( dotTH ), alphaT.mul( dotBH ), a2.mul( dotNH ) );\n\tconst v2 = v.dot( v );\n\tconst w2 = a2.div( v2 );\n\n\treturn RECIPROCAL_PI.mul( a2.mul( w2.pow2() ) );\n\n} ).setLayout( {\n\tname: 'D_GGX_Anisotropic',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'alphaT', type: 'float', qualifier: 'in' },\n\t\t{ name: 'alphaB', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotNH', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotTH', type: 'float', qualifier: 'in' },\n\t\t{ name: 'dotBH', type: 'float', qualifier: 'in' }\n\t]\n} );\n\n// GGX Distribution, Schlick Fresnel, GGX_SmithCorrelated Visibility\nconst BRDF_GGX = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { lightDirection, f0, f90, roughness, f, USE_IRIDESCENCE, USE_ANISOTROPY } = inputs;\n\n\tconst normalView = inputs.normalView || transformedNormalView;\n\n\tconst alpha = roughness.pow2(); // UE4's roughness\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = normalView.dot( lightDirection ).clamp();\n\tconst dotNV = normalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\tconst dotNH = normalView.dot( halfDir ).clamp();\n\tconst dotVH = positionViewDirection.dot( halfDir ).clamp();\n\n\tlet F = F_Schlick( { f0, f90, dotVH } );\n\tlet V, D;\n\n\tif ( defined( USE_IRIDESCENCE ) ) {\n\n\t\tF = iridescence.mix( F, f );\n\n\t}\n\n\tif ( defined( USE_ANISOTROPY ) ) {\n\n\t\tconst dotTL = anisotropyT.dot( lightDirection );\n\t\tconst dotTV = anisotropyT.dot( positionViewDirection );\n\t\tconst dotTH = anisotropyT.dot( halfDir );\n\t\tconst dotBL = anisotropyB.dot( lightDirection );\n\t\tconst dotBV = anisotropyB.dot( positionViewDirection );\n\t\tconst dotBH = anisotropyB.dot( halfDir );\n\n\t\tV = V_GGX_SmithCorrelated_Anisotropic( { alphaT, alphaB: alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL } );\n\t\tD = D_GGX_Anisotropic( { alphaT, alphaB: alpha, dotNH, dotTH, dotBH } );\n\n\t} else {\n\n\t\tV = V_GGX_SmithCorrelated( { alpha, dotNL, dotNV } );\n\t\tD = D_GGX( { alpha, dotNH } );\n\n\t}\n\n\treturn F.mul( V ).mul( D );\n\n} ); // validated\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via 'environmentBRDF' from \"Physically Based Shading on Mobile\"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nconst DFGApprox = /*@__PURE__*/ Fn( ( { roughness, dotNV } ) => {\n\n\tconst c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tconst r = roughness.mul( c0 ).add( c1 );\n\n\tconst a004 = r.x.mul( r.x ).min( dotNV.mul( - 9.28 ).exp2() ).mul( r.x ).add( r.y );\n\n\tconst fab = vec2( - 1.04, 1.04 ).mul( a004 ).add( r.zw );\n\n\treturn fab;\n\n} ).setLayout( {\n\tname: 'DFGApprox',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNV', type: 'vec3' }\n\t]\n} );\n\nconst EnvironmentBRDF = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { dotNV, specularColor, specularF90, roughness } = inputs;\n\n\tconst fab = DFGApprox( { dotNV, roughness } );\n\treturn specularColor.mul( fab.x ).add( specularF90.mul( fab.y ) );\n\n} );\n\nconst Schlick_to_F0 = /*@__PURE__*/ Fn( ( { f, f90, dotVH } ) => {\n\n\tconst x = dotVH.oneMinus().saturate();\n\tconst x2 = x.mul( x );\n\tconst x5 = x.mul( x2, x2 ).clamp( 0, .9999 );\n\n\treturn f.sub( vec3( f90 ).mul( x5 ) ).div( x5.oneMinus() );\n\n} ).setLayout( {\n\tname: 'Schlick_to_F0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'f', type: 'vec3' },\n\t\t{ name: 'f90', type: 'float' },\n\t\t{ name: 'dotVH', type: 'float' }\n\t]\n} );\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst D_Charlie = /*@__PURE__*/ Fn( ( { roughness, dotNH } ) => {\n\n\tconst alpha = roughness.pow2();\n\n\t// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\"\n\tconst invAlpha = float( 1.0 ).div( alpha );\n\tconst cos2h = dotNH.pow2();\n\tconst sin2h = cos2h.oneMinus().max( 0.0078125 ); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\n\treturn float( 2.0 ).add( invAlpha ).mul( sin2h.pow( invAlpha.mul( 0.5 ) ) ).div( 2.0 * Math.PI );\n\n} ).setLayout( {\n\tname: 'D_Charlie',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'dotNH', type: 'float' }\n\t]\n} );\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs\nconst V_Neubelt = /*@__PURE__*/ Fn( ( { dotNV, dotNL } ) => {\n\n\t// Neubelt and Pettineo 2013, \"Crafting a Next-gen Material Pipeline for The Order: 1886\"\n\treturn float( 1.0 ).div( float( 4.0 ).mul( dotNL.add( dotNV ).sub( dotNL.mul( dotNV ) ) ) );\n\n} ).setLayout( {\n\tname: 'V_Neubelt',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'dotNV', type: 'float' },\n\t\t{ name: 'dotNL', type: 'float' }\n\t]\n} );\n\nconst BRDF_Sheen = /*@__PURE__*/ Fn( ( { lightDirection } ) => {\n\n\tconst halfDir = lightDirection.add( positionViewDirection ).normalize();\n\n\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp();\n\tconst dotNH = transformedNormalView.dot( halfDir ).clamp();\n\n\tconst D = D_Charlie( { roughness: sheenRoughness, dotNH } );\n\tconst V = V_Neubelt( { dotNV, dotNL } );\n\n\treturn sheen.mul( D ).mul( V );\n\n} );\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nconst LTC_Uv = /*@__PURE__*/ Fn( ( { N, V, roughness } ) => {\n\n\tconst LUT_SIZE = 64.0;\n\tconst LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst LUT_BIAS = 0.5 / LUT_SIZE;\n\n\tconst dotNV = N.dot( V ).saturate();\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tconst uv = vec2( roughness, dotNV.oneMinus().sqrt() );\n\n\tuv.assign( uv.mul( LUT_SCALE ).add( LUT_BIAS ) );\n\n\treturn uv;\n\n} ).setLayout( {\n\tname: 'LTC_Uv',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'N', type: 'vec3' },\n\t\t{ name: 'V', type: 'vec3' },\n\t\t{ name: 'roughness', type: 'float' }\n\t]\n} );\n\nconst LTC_ClippedSphereFormFactor = /*@__PURE__*/ Fn( ( { f } ) => {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tconst l = f.length();\n\n\treturn max$1( l.mul( l ).add( f.z ).div( l.add( 1.0 ) ), 0 );\n\n} ).setLayout( {\n\tname: 'LTC_ClippedSphereFormFactor',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'f', type: 'vec3' }\n\t]\n} );\n\nconst LTC_EdgeVectorFormFactor = /*@__PURE__*/ Fn( ( { v1, v2 } ) => {\n\n\tconst x = v1.dot( v2 );\n\tconst y = x.abs().toVar();\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tconst a = y.mul( 0.0145206 ).add( 0.4965155 ).mul( y ).add( 0.8543985 ).toVar();\n\tconst b = y.add( 4.1616724 ).mul( y ).add( 3.4175940 ).toVar();\n\tconst v = a.div( b );\n\n\tconst theta_sintheta = x.greaterThan( 0.0 ).select( v, max$1( x.mul( x ).oneMinus(), 1e-7 ).inverseSqrt().mul( 0.5 ).sub( v ) );\n\n\treturn v1.cross( v2 ).mul( theta_sintheta );\n\n} ).setLayout( {\n\tname: 'LTC_EdgeVectorFormFactor',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' }\n\t]\n} );\n\nconst LTC_Evaluate = /*@__PURE__*/ Fn( ( { N, V, P, mInv, p0, p1, p2, p3 } ) => {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tconst v1 = p1.sub( p0 ).toVar();\n\tconst v2 = p3.sub( p0 ).toVar();\n\n\tconst lightNormal = v1.cross( v2 );\n\tconst result = vec3().toVar();\n\n\tIf( lightNormal.dot( P.sub( p0 ) ).greaterThanEqual( 0.0 ), () => {\n\n\t\t// construct orthonormal basis around N\n\t\tconst T1 = V.sub( N.mul( V.dot( N ) ) ).normalize();\n\t\tconst T2 = N.cross( T1 ).negate(); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t\t// compute transform\n\t\tconst mat = mInv.mul( mat3( T1, T2, N ).transpose() ).toVar();\n\n\t\t// transform rect\n\t\t// & project rect onto sphere\n\t\tconst coords0 = mat.mul( p0.sub( P ) ).normalize().toVar();\n\t\tconst coords1 = mat.mul( p1.sub( P ) ).normalize().toVar();\n\t\tconst coords2 = mat.mul( p2.sub( P ) ).normalize().toVar();\n\t\tconst coords3 = mat.mul( p3.sub( P ) ).normalize().toVar();\n\n\t\t// calculate vector form factor\n\t\tconst vectorFormFactor = vec3( 0 ).toVar();\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords0, v2: coords1 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords1, v2: coords2 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords2, v2: coords3 } ) );\n\t\tvectorFormFactor.addAssign( LTC_EdgeVectorFormFactor( { v1: coords3, v2: coords0 } ) );\n\n\t\t// adjust for horizon clipping\n\t\tresult.assign( vec3( LTC_ClippedSphereFormFactor( { f: vectorFormFactor } ) ) );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'LTC_Evaluate',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'N', type: 'vec3' },\n\t\t{ name: 'V', type: 'vec3' },\n\t\t{ name: 'P', type: 'vec3' },\n\t\t{ name: 'mInv', type: 'mat3' },\n\t\t{ name: 'p0', type: 'vec3' },\n\t\t{ name: 'p1', type: 'vec3' },\n\t\t{ name: 'p2', type: 'vec3' },\n\t\t{ name: 'p3', type: 'vec3' }\n\t]\n} );\n\n// Mipped Bicubic Texture Filtering by N8\n// https://www.shadertoy.com/view/Dl2SDW\n\nconst bC = 1.0 / 6.0;\n\nconst w0 = ( a ) => mul( bC, mul( a, mul( a, a.negate().add( 3.0 ) ).sub( 3.0 ) ).add( 1.0 ) );\n\nconst w1 = ( a ) => mul( bC, mul( a, mul( a, mul( 3.0, a ).sub( 6.0 ) ) ).add( 4.0 ) );\n\nconst w2 = ( a ) => mul( bC, mul( a, mul( a, mul( - 3.0, a ).add( 3.0 ) ).add( 3.0 ) ).add( 1.0 ) );\n\nconst w3 = ( a ) => mul( bC, pow( a, 3 ) );\n\nconst g0 = ( a ) => w0( a ).add( w1( a ) );\n\nconst g1 = ( a ) => w2( a ).add( w3( a ) );\n\n// h0 and h1 are the two offset functions\nconst h0 = ( a ) => add( - 1.0, w1( a ).div( w0( a ).add( w1( a ) ) ) );\n\nconst h1 = ( a ) => add( 1.0, w3( a ).div( w2( a ).add( w3( a ) ) ) );\n\nconst bicubic = ( textureNode, texelSize, lod ) => {\n\n\tconst uv = textureNode.uvNode;\n\tconst uvScaled = mul( uv, texelSize.zw ).add( 0.5 );\n\n\tconst iuv = floor( uvScaled );\n\tconst fuv = fract( uvScaled );\n\n\tconst g0x = g0( fuv.x );\n\tconst g1x = g1( fuv.x );\n\tconst h0x = h0( fuv.x );\n\tconst h1x = h1( fuv.x );\n\tconst h0y = h0( fuv.y );\n\tconst h1y = h1( fuv.y );\n\n\tconst p0 = vec2( iuv.x.add( h0x ), iuv.y.add( h0y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p1 = vec2( iuv.x.add( h1x ), iuv.y.add( h0y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p2 = vec2( iuv.x.add( h0x ), iuv.y.add( h1y ) ).sub( 0.5 ).mul( texelSize.xy );\n\tconst p3 = vec2( iuv.x.add( h1x ), iuv.y.add( h1y ) ).sub( 0.5 ).mul( texelSize.xy );\n\n\tconst a = g0( fuv.y ).mul( add( g0x.mul( textureNode.uv( p0 ).level( lod ) ), g1x.mul( textureNode.uv( p1 ).level( lod ) ) ) );\n\tconst b = g1( fuv.y ).mul( add( g0x.mul( textureNode.uv( p2 ).level( lod ) ), g1x.mul( textureNode.uv( p3 ).level( lod ) ) ) );\n\n\treturn a.add( b );\n\n};\n\nconst textureBicubic = /*@__PURE__*/ Fn( ( [ textureNode, lodNode = float( 3 ) ] ) => {\n\n\tconst fLodSize = vec2( textureNode.size( int( lodNode ) ) );\n\tconst cLodSize = vec2( textureNode.size( int( lodNode.add( 1.0 ) ) ) );\n\tconst fLodSizeInv = div( 1.0, fLodSize );\n\tconst cLodSizeInv = div( 1.0, cLodSize );\n\tconst fSample = bicubic( textureNode, vec4( fLodSizeInv, fLodSize ), floor( lodNode ) );\n\tconst cSample = bicubic( textureNode, vec4( cLodSizeInv, cLodSize ), ceil( lodNode ) );\n\n\treturn fract( lodNode ).mix( fSample, cSample );\n\n} );\n\n//\n// Transmission\n//\n\nconst getVolumeTransmissionRay = /*@__PURE__*/ Fn( ( [ n, v, thickness, ior, modelMatrix ] ) => {\n\n\t// Direction of refracted light.\n\tconst refractionVector = vec3( refract( v.negate(), normalize( n ), div( 1.0, ior ) ) );\n\n\t// Compute rotation-independant scaling of the model matrix.\n\tconst modelScale = vec3(\n\t\tlength( modelMatrix[ 0 ].xyz ),\n\t\tlength( modelMatrix[ 1 ].xyz ),\n\t\tlength( modelMatrix[ 2 ].xyz )\n\t);\n\n\t// The thickness is specified in local space.\n\treturn normalize( refractionVector ).mul( thickness.mul( modelScale ) );\n\n} ).setLayout( {\n\tname: 'getVolumeTransmissionRay',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'n', type: 'vec3' },\n\t\t{ name: 'v', type: 'vec3' },\n\t\t{ name: 'thickness', type: 'float' },\n\t\t{ name: 'ior', type: 'float' },\n\t\t{ name: 'modelMatrix', type: 'mat4' }\n\t]\n} );\n\nconst applyIorToRoughness = /*@__PURE__*/ Fn( ( [ roughness, ior ] ) => {\n\n\t// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and\n\t// an IOR of 1.5 results in the default amount of microfacet refraction.\n\treturn roughness.mul( clamp( ior.mul( 2.0 ).sub( 2.0 ), 0.0, 1.0 ) );\n\n} ).setLayout( {\n\tname: 'applyIorToRoughness',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' },\n\t\t{ name: 'ior', type: 'float' }\n\t]\n} );\n\nconst viewportBackSideTexture = /*@__PURE__*/ viewportMipTexture();\nconst viewportFrontSideTexture = /*@__PURE__*/ viewportMipTexture();\n\nconst getTransmissionSample = /*@__PURE__*/ Fn( ( [ fragCoord, roughness, ior ], { material } ) => {\n\n\tconst vTexture = material.side == BackSide ? viewportBackSideTexture : viewportFrontSideTexture;\n\n\tconst transmissionSample = vTexture.uv( fragCoord );\n\t//const transmissionSample = viewportMipTexture( fragCoord );\n\n\tconst lod = log2( screenSize.x ).mul( applyIorToRoughness( roughness, ior ) );\n\n\treturn textureBicubic( transmissionSample, lod );\n\n} );\n\nconst volumeAttenuation = /*@__PURE__*/ Fn( ( [ transmissionDistance, attenuationColor, attenuationDistance ] ) => {\n\n\tIf( attenuationDistance.notEqual( 0 ), () => {\n\n\t\t// Compute light attenuation using Beer's law.\n\t\tconst attenuationCoefficient = log( attenuationColor ).negate().div( attenuationDistance );\n\t\tconst transmittance = exp( attenuationCoefficient.negate().mul( transmissionDistance ) );\n\n\t\treturn transmittance;\n\n\t} );\n\n\t// Attenuation distance is +∞, i.e. the transmitted color is not attenuated at all.\n\treturn vec3( 1.0 );\n\n} ).setLayout( {\n\tname: 'volumeAttenuation',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'transmissionDistance', type: 'float' },\n\t\t{ name: 'attenuationColor', type: 'vec3' },\n\t\t{ name: 'attenuationDistance', type: 'float' }\n\t]\n} );\n\nconst getIBLVolumeRefraction = /*@__PURE__*/ Fn( ( [ n, v, roughness, diffuseColor, specularColor, specularF90, position, modelMatrix, viewMatrix, projMatrix, ior, thickness, attenuationColor, attenuationDistance, dispersion ] ) => {\n\n\tlet transmittedLight, transmittance;\n\n\tif ( dispersion ) {\n\n\t\ttransmittedLight = vec4().toVar();\n\t\ttransmittance = vec3().toVar();\n\n\t\tconst halfSpread = ior.sub( 1.0 ).mul( dispersion.mul( 0.025 ) );\n\t\tconst iors = vec3( ior.sub( halfSpread ), ior, ior.add( halfSpread ) );\n\n\t\tLoop( { start: 0, end: 3 }, ( { i } ) => {\n\n\t\t\tconst ior = iors.element( i );\n\n\t\t\tconst transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tconst refractedRayExit = position.add( transmissionRay );\n\n\t\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\t\tconst ndcPos = projMatrix.mul( viewMatrix.mul( vec4( refractedRayExit, 1.0 ) ) );\n\t\t\tconst refractionCoords = vec2( ndcPos.xy.div( ndcPos.w ) ).toVar();\n\t\t\trefractionCoords.addAssign( 1.0 );\n\t\t\trefractionCoords.divAssign( 2.0 );\n\t\t\trefractionCoords.assign( vec2( refractionCoords.x, refractionCoords.y.oneMinus() ) ); // webgpu\n\n\t\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\t\tconst transmissionSample = getTransmissionSample( refractionCoords, roughness, ior );\n\n\t\t\ttransmittedLight.element( i ).assign( transmissionSample.element( i ) );\n\t\t\ttransmittedLight.a.addAssign( transmissionSample.a );\n\n\t\t\ttransmittance.element( i ).assign( diffuseColor.element( i ).mul( volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance ).element( i ) ) );\n\n\t\t} );\n\n\t\ttransmittedLight.a.divAssign( 3.0 );\n\n\t} else {\n\n\t\tconst transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tconst refractedRayExit = position.add( transmissionRay );\n\n\t\t// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.\n\t\tconst ndcPos = projMatrix.mul( viewMatrix.mul( vec4( refractedRayExit, 1.0 ) ) );\n\t\tconst refractionCoords = vec2( ndcPos.xy.div( ndcPos.w ) ).toVar();\n\t\trefractionCoords.addAssign( 1.0 );\n\t\trefractionCoords.divAssign( 2.0 );\n\t\trefractionCoords.assign( vec2( refractionCoords.x, refractionCoords.y.oneMinus() ) ); // webgpu\n\n\t\t// Sample framebuffer to get pixel the refracted ray hits.\n\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\ttransmittance = diffuseColor.mul( volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance ) );\n\n\t}\n\n\tconst attenuatedColor = transmittance.rgb.mul( transmittedLight.rgb );\n\tconst dotNV = n.dot( v ).clamp();\n\n\t// Get the specular component.\n\tconst F = vec3( EnvironmentBRDF( { // n, v, specularColor, specularF90, roughness\n\t\tdotNV,\n\t\tspecularColor,\n\t\tspecularF90,\n\t\troughness\n\t} ) );\n\n\t// As less light is transmitted, the opacity should be increased. This simple approximation does a decent job\n\t// of modulating a CSS background, and has no effect when the buffer is opaque, due to a solid object or clear color.\n\tconst transmittanceFactor = transmittance.r.add( transmittance.g, transmittance.b ).div( 3.0 );\n\n\treturn vec4( F.oneMinus().mul( attenuatedColor ), transmittedLight.a.oneMinus().mul( transmittanceFactor ).oneMinus() );\n\n} );\n\n//\n// Iridescence\n//\n\n// XYZ to linear-sRGB color space\nconst XYZ_TO_REC709 = /*@__PURE__*/ mat3(\n\t3.2404542, - 0.9692660, 0.0556434,\n\t- 1.5371385, 1.8760108, - 0.2040259,\n\t- 0.4985314, 0.0415560, 1.0572252\n);\n\n// Assume air interface for top\n// Note: We don't handle the case fresnel0 == 1\nconst Fresnel0ToIor = ( fresnel0 ) => {\n\n\tconst sqrtF0 = fresnel0.sqrt();\n\treturn vec3( 1.0 ).add( sqrtF0 ).div( vec3( 1.0 ).sub( sqrtF0 ) );\n\n};\n\n// ior is a value between 1.0 and 3.0. 1.0 is air interface\nconst IorToFresnel0 = ( transmittedIor, incidentIor ) => {\n\n\treturn transmittedIor.sub( incidentIor ).div( transmittedIor.add( incidentIor ) ).pow2();\n\n};\n\n// Fresnel equations for dielectric/dielectric interfaces.\n// Ref: https://belcour.github.io/blog/research/2017/05/01/brdf-thin-film.html\n// Evaluation XYZ sensitivity curves in Fourier space\nconst evalSensitivity = ( OPD, shift ) => {\n\n\tconst phase = OPD.mul( 2.0 * Math.PI * 1.0e-9 );\n\tconst val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\tconst pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\tconst VAR = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\n\tconst x = float( 9.7470e-14 * Math.sqrt( 2.0 * Math.PI * 4.5282e+09 ) ).mul( phase.mul( 2.2399e+06 ).add( shift.x ).cos() ).mul( phase.pow2().mul( - 4.5282e+09 ).exp() );\n\n\tlet xyz = val.mul( VAR.mul( 2.0 * Math.PI ).sqrt() ).mul( pos.mul( phase ).add( shift ).cos() ).mul( phase.pow2().negate().mul( VAR ).exp() );\n\txyz = vec3( xyz.x.add( x ), xyz.y, xyz.z ).div( 1.0685e-7 );\n\n\tconst rgb = XYZ_TO_REC709.mul( xyz );\n\n\treturn rgb;\n\n};\n\nconst evalIridescence = /*@__PURE__*/ Fn( ( { outsideIOR, eta2, cosTheta1, thinFilmThickness, baseF0 } ) => {\n\n\t// Force iridescenceIOR -> outsideIOR when thinFilmThickness -> 0.0\n\tconst iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t// Evaluate the cosTheta on the base layer (Snell law)\n\tconst sinTheta2Sq = outsideIOR.div( iridescenceIOR ).pow2().mul( cosTheta1.pow2().oneMinus() );\n\n\t// Handle TIR:\n\tconst cosTheta2Sq = sinTheta2Sq.oneMinus();\n\n\tIf( cosTheta2Sq.lessThan( 0 ), () => {\n\n\t\treturn vec3( 1.0 );\n\n\t} );\n\n\tconst cosTheta2 = cosTheta2Sq.sqrt();\n\n\t// First interface\n\tconst R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\tconst R12 = F_Schlick( { f0: R0, f90: 1.0, dotVH: cosTheta1 } );\n\t//const R21 = R12;\n\tconst T121 = R12.oneMinus();\n\tconst phi12 = iridescenceIOR.lessThan( outsideIOR ).select( Math.PI, 0.0 );\n\tconst phi21 = float( Math.PI ).sub( phi12 );\n\n\t// Second interface\n\tconst baseIOR = Fresnel0ToIor( baseF0.clamp( 0.0, 0.9999 ) ); // guard against 1.0\n\tconst R1 = IorToFresnel0( baseIOR, iridescenceIOR.toVec3() );\n\tconst R23 = F_Schlick( { f0: R1, f90: 1.0, dotVH: cosTheta2 } );\n\tconst phi23 = vec3(\n\t\tbaseIOR.x.lessThan( iridescenceIOR ).select( Math.PI, 0.0 ),\n\t\tbaseIOR.y.lessThan( iridescenceIOR ).select( Math.PI, 0.0 ),\n\t\tbaseIOR.z.lessThan( iridescenceIOR ).select( Math.PI, 0.0 )\n\t);\n\n\t// Phase shift\n\tconst OPD = iridescenceIOR.mul( thinFilmThickness, cosTheta2, 2.0 );\n\tconst phi = vec3( phi21 ).add( phi23 );\n\n\t// Compound terms\n\tconst R123 = R12.mul( R23 ).clamp( 1e-5, 0.9999 );\n\tconst r123 = R123.sqrt();\n\tconst Rs = T121.pow2().mul( R23 ).div( vec3( 1.0 ).sub( R123 ) );\n\n\t// Reflectance term for m = 0 (DC term amplitude)\n\tconst C0 = R12.add( Rs );\n\tconst I = C0.toVar();\n\n\t// Reflectance term for m > 0 (pairs of diracs)\n\tconst Cm = Rs.sub( T121 ).toVar();\n\n\tLoop( { start: 1, end: 2, condition: '<=', name: 'm' }, ( { m } ) => {\n\n\t\tCm.mulAssign( r123 );\n\t\tconst Sm = evalSensitivity( float( m ).mul( OPD ), float( m ).mul( phi ) ).mul( 2.0 );\n\t\tI.addAssign( Cm.mul( Sm ) );\n\n\t} );\n\n\t// Since out of gamut colors might be produced, negative color values are clamped to 0.\n\treturn I.max( vec3( 0.0 ) );\n\n} ).setLayout( {\n\tname: 'evalIridescence',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'outsideIOR', type: 'float' },\n\t\t{ name: 'eta2', type: 'float' },\n\t\t{ name: 'cosTheta1', type: 'float' },\n\t\t{ name: 'thinFilmThickness', type: 'float' },\n\t\t{ name: 'baseF0', type: 'vec3' }\n\t]\n} );\n\n//\n//\tSheen\n//\n\n// This is a curve-fit approxmation to the \"Charlie sheen\" BRDF integrated over the hemisphere from\n// Estevez and Kulla 2017, \"Production Friendly Microfacet Sheen BRDF\". The analysis can be found\n// in the Sheen section of https://drive.google.com/file/d/1T0D1VSyR4AllqIJTQAraEIzjlb5h4FKH/view?usp=sharing\nconst IBLSheenBRDF = /*@__PURE__*/ Fn( ( { normal, viewDir, roughness } ) => {\n\n\tconst dotNV = normal.dot( viewDir ).saturate();\n\n\tconst r2 = roughness.pow2();\n\n\tconst a = select(\n\t\troughness.lessThan( 0.25 ),\n\t\tfloat( - 339.2 ).mul( r2 ).add( float( 161.4 ).mul( roughness ) ).sub( 25.9 ),\n\t\tfloat( - 8.48 ).mul( r2 ).add( float( 14.3 ).mul( roughness ) ).sub( 9.95 )\n\t);\n\n\tconst b = select(\n\t\troughness.lessThan( 0.25 ),\n\t\tfloat( 44.0 ).mul( r2 ).sub( float( 23.7 ).mul( roughness ) ).add( 3.26 ),\n\t\tfloat( 1.97 ).mul( r2 ).sub( float( 3.27 ).mul( roughness ) ).add( 0.72 )\n\t);\n\n\tconst DG = select( roughness.lessThan( 0.25 ), 0.0, float( 0.1 ).mul( roughness ).sub( 0.025 ) ).add( a.mul( dotNV ).add( b ).exp() );\n\n\treturn DG.mul( 1.0 / Math.PI ).saturate();\n\n} );\n\nconst clearcoatF0 = vec3( 0.04 );\nconst clearcoatF90 = float( 1 );\n\n//\n\nclass PhysicalLightingModel extends LightingModel {\n\n\tconstructor( clearcoat = false, sheen = false, iridescence = false, anisotropy = false, transmission = false, dispersion = false ) {\n\n\t\tsuper();\n\n\t\tthis.clearcoat = clearcoat;\n\t\tthis.sheen = sheen;\n\t\tthis.iridescence = iridescence;\n\t\tthis.anisotropy = anisotropy;\n\t\tthis.transmission = transmission;\n\t\tthis.dispersion = dispersion;\n\n\t\tthis.clearcoatRadiance = null;\n\t\tthis.clearcoatSpecularDirect = null;\n\t\tthis.clearcoatSpecularIndirect = null;\n\t\tthis.sheenSpecularDirect = null;\n\t\tthis.sheenSpecularIndirect = null;\n\t\tthis.iridescenceFresnel = null;\n\t\tthis.iridescenceF0 = null;\n\n\t}\n\n\tstart( context ) {\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tthis.clearcoatRadiance = vec3().toVar( 'clearcoatRadiance' );\n\t\t\tthis.clearcoatSpecularDirect = vec3().toVar( 'clearcoatSpecularDirect' );\n\t\t\tthis.clearcoatSpecularIndirect = vec3().toVar( 'clearcoatSpecularIndirect' );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularDirect = vec3().toVar( 'sheenSpecularDirect' );\n\t\t\tthis.sheenSpecularIndirect = vec3().toVar( 'sheenSpecularIndirect' );\n\n\t\t}\n\n\t\tif ( this.iridescence === true ) {\n\n\t\t\tconst dotNVi = transformedNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tthis.iridescenceFresnel = evalIridescence( {\n\t\t\t\toutsideIOR: float( 1.0 ),\n\t\t\t\teta2: iridescenceIOR,\n\t\t\t\tcosTheta1: dotNVi,\n\t\t\t\tthinFilmThickness: iridescenceThickness,\n\t\t\t\tbaseF0: specularColor\n\t\t\t} );\n\n\t\t\tthis.iridescenceF0 = Schlick_to_F0( { f: this.iridescenceFresnel, f90: 1.0, dotVH: dotNVi } );\n\n\t\t}\n\n\t\tif ( this.transmission === true ) {\n\n\t\t\tconst position = positionWorld;\n\t\t\tconst v = cameraPosition.sub( positionWorld ).normalize(); // TODO: Create Node for this, same issue in MaterialX\n\t\t\tconst n = transformedNormalWorld;\n\n\t\t\tcontext.backdrop = getIBLVolumeRefraction(\n\t\t\t\tn,\n\t\t\t\tv,\n\t\t\t\troughness,\n\t\t\t\tdiffuseColor,\n\t\t\t\tspecularColor,\n\t\t\t\tspecularF90, // specularF90\n\t\t\t\tposition, // positionWorld\n\t\t\t\tmodelWorldMatrix, // modelMatrix\n\t\t\t\tcameraViewMatrix, // viewMatrix\n\t\t\t\tcameraProjectionMatrix, // projMatrix\n\t\t\t\tior,\n\t\t\t\tthickness,\n\t\t\t\tattenuationColor,\n\t\t\t\tattenuationDistance,\n\t\t\t\tthis.dispersion ? dispersion : null\n\t\t\t);\n\n\t\t\tcontext.backdropAlpha = transmission;\n\n\t\t\tdiffuseColor.a.mulAssign( mix( 1, context.backdrop.a, transmission ) );\n\n\t\t}\n\n\t}\n\n\t// Fdez-Agüera's \"Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting\"\n\t// Approximates multiscattering in order to preserve energy.\n\t// http://www.jcgt.org/published/0008/01/03/\n\n\tcomputeMultiscattering( singleScatter, multiScatter, specularF90 ) {\n\n\t\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\n\t\tconst fab = DFGApprox( { roughness, dotNV } );\n\n\t\tconst Fr = this.iridescenceF0 ? iridescence.mix( specularColor, this.iridescenceF0 ) : specularColor;\n\n\t\tconst FssEss = Fr.mul( fab.x ).add( specularF90.mul( fab.y ) );\n\n\t\tconst Ess = fab.x.add( fab.y );\n\t\tconst Ems = Ess.oneMinus();\n\n\t\tconst Favg = specularColor.add( specularColor.oneMinus().mul( 0.047619 ) ); // 1/21\n\t\tconst Fms = FssEss.mul( Favg ).div( Ems.mul( Favg ).oneMinus() );\n\n\t\tsingleScatter.addAssign( FssEss );\n\t\tmultiScatter.addAssign( Fms.mul( Ems ) );\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight } ) {\n\n\t\tconst dotNL = transformedNormalView.dot( lightDirection ).clamp();\n\t\tconst irradiance = dotNL.mul( lightColor );\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularDirect.addAssign( irradiance.mul( BRDF_Sheen( { lightDirection } ) ) );\n\n\t\t}\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNLcc = transformedClearcoatNormalView.dot( lightDirection ).clamp();\n\t\t\tconst ccIrradiance = dotNLcc.mul( lightColor );\n\n\t\t\tthis.clearcoatSpecularDirect.addAssign( ccIrradiance.mul( BRDF_GGX( { lightDirection, f0: clearcoatF0, f90: clearcoatF90, roughness: clearcoatRoughness, normalView: transformedClearcoatNormalView } ) ) );\n\n\t\t}\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t\treflectedLight.directSpecular.addAssign( irradiance.mul( BRDF_GGX( { lightDirection, f0: specularColor, f90: 1, roughness, iridescence: this.iridescence, f: this.iridescenceFresnel, USE_IRIDESCENCE: this.iridescence, USE_ANISOTROPY: this.anisotropy } ) ) );\n\n\t}\n\n\tdirectRectArea( { lightColor, lightPosition, halfWidth, halfHeight, reflectedLight, ltc_1, ltc_2 } ) {\n\n\t\tconst p0 = lightPosition.add( halfWidth ).sub( halfHeight ); // counterclockwise; light shines in local neg z direction\n\t\tconst p1 = lightPosition.sub( halfWidth ).sub( halfHeight );\n\t\tconst p2 = lightPosition.sub( halfWidth ).add( halfHeight );\n\t\tconst p3 = lightPosition.add( halfWidth ).add( halfHeight );\n\n\t\tconst N = transformedNormalView;\n\t\tconst V = positionViewDirection;\n\t\tconst P = positionView.toVar();\n\n\t\tconst uv = LTC_Uv( { N, V, roughness } );\n\n\t\tconst t1 = ltc_1.uv( uv ).toVar();\n\t\tconst t2 = ltc_2.uv( uv ).toVar();\n\n\t\tconst mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3( 0, 1, 0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t).toVar();\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tconst fresnel = specularColor.mul( t2.x ).add( specularColor.oneMinus().mul( t2.y ) ).toVar();\n\n\t\treflectedLight.directSpecular.addAssign( lightColor.mul( fresnel ).mul( LTC_Evaluate( { N, V, P, mInv, p0, p1, p2, p3 } ) ) );\n\n\t\treflectedLight.directDiffuse.addAssign( lightColor.mul( diffuseColor ).mul( LTC_Evaluate( { N, V, P, mInv: mat3( 1, 0, 0, 0, 1, 0, 0, 0, 1 ), p0, p1, p2, p3 } ) ) );\n\n\t}\n\n\tindirect( context, stack, builder ) {\n\n\t\tthis.indirectDiffuse( context, stack, builder );\n\t\tthis.indirectSpecular( context, stack, builder );\n\t\tthis.ambientOcclusion( context, stack, builder );\n\n\t}\n\n\tindirectDiffuse( { irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t}\n\n\tindirectSpecular( { radiance, iblIrradiance, reflectedLight } ) {\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularIndirect.addAssign( iblIrradiance.mul(\n\t\t\t\tsheen,\n\t\t\t\tIBLSheenBRDF( {\n\t\t\t\t\tnormal: transformedNormalView,\n\t\t\t\t\tviewDir: positionViewDirection,\n\t\t\t\t\troughness: sheenRoughness\n\t\t\t\t} )\n\t\t\t) );\n\n\t\t}\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNVcc = transformedClearcoatNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tconst clearcoatEnv = EnvironmentBRDF( {\n\t\t\t\tdotNV: dotNVcc,\n\t\t\t\tspecularColor: clearcoatF0,\n\t\t\t\tspecularF90: clearcoatF90,\n\t\t\t\troughness: clearcoatRoughness\n\t\t\t} );\n\n\t\t\tthis.clearcoatSpecularIndirect.addAssign( this.clearcoatRadiance.mul( clearcoatEnv ) );\n\n\t\t}\n\n\t\t// Both indirect specular and indirect diffuse light accumulate here\n\n\t\tconst singleScattering = vec3().toVar( 'singleScattering' );\n\t\tconst multiScattering = vec3().toVar( 'multiScattering' );\n\t\tconst cosineWeightedIrradiance = iblIrradiance.mul( 1 / Math.PI );\n\n\t\tthis.computeMultiscattering( singleScattering, multiScattering, specularF90 );\n\n\t\tconst totalScattering = singleScattering.add( multiScattering );\n\n\t\tconst diffuse = diffuseColor.mul( totalScattering.r.max( totalScattering.g ).max( totalScattering.b ).oneMinus() );\n\n\t\treflectedLight.indirectSpecular.addAssign( radiance.mul( singleScattering ) );\n\t\treflectedLight.indirectSpecular.addAssign( multiScattering.mul( cosineWeightedIrradiance ) );\n\n\t\treflectedLight.indirectDiffuse.addAssign( diffuse.mul( cosineWeightedIrradiance ) );\n\n\t}\n\n\tambientOcclusion( { ambientOcclusion, reflectedLight } ) {\n\n\t\tconst dotNV = transformedNormalView.dot( positionViewDirection ).clamp(); // @ TODO: Move to core dotNV\n\n\t\tconst aoNV = dotNV.add( ambientOcclusion );\n\t\tconst aoExp = roughness.mul( - 16.0 ).oneMinus().negate().exp2();\n\n\t\tconst aoNode = ambientOcclusion.sub( aoNV.pow( aoExp ).oneMinus() ).clamp();\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tthis.clearcoatSpecularIndirect.mulAssign( ambientOcclusion );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tthis.sheenSpecularIndirect.mulAssign( ambientOcclusion );\n\n\t\t}\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\t\treflectedLight.indirectSpecular.mulAssign( aoNode );\n\n\t}\n\n\tfinish( context ) {\n\n\t\tconst { outgoingLight } = context;\n\n\t\tif ( this.clearcoat === true ) {\n\n\t\t\tconst dotNVcc = transformedClearcoatNormalView.dot( positionViewDirection ).clamp();\n\n\t\t\tconst Fcc = F_Schlick( {\n\t\t\t\tdotVH: dotNVcc,\n\t\t\t\tf0: clearcoatF0,\n\t\t\t\tf90: clearcoatF90\n\t\t\t} );\n\n\t\t\tconst clearcoatLight = outgoingLight.mul( clearcoat.mul( Fcc ).oneMinus() ).add( this.clearcoatSpecularDirect.add( this.clearcoatSpecularIndirect ).mul( clearcoat ) );\n\n\t\t\toutgoingLight.assign( clearcoatLight );\n\n\t\t}\n\n\t\tif ( this.sheen === true ) {\n\n\t\t\tconst sheenEnergyComp = sheen.r.max( sheen.g ).max( sheen.b ).mul( 0.157 ).oneMinus();\n\t\t\tconst sheenLight = outgoingLight.mul( sheenEnergyComp ).add( this.sheenSpecularDirect, this.sheenSpecularIndirect );\n\n\t\t\toutgoingLight.assign( sheenLight );\n\n\t\t}\n\n\t}\n\n}\n\n// These defines must match with PMREMGenerator\n\nconst cubeUV_r0 = /*@__PURE__*/ float( 1.0 );\nconst cubeUV_m0 = /*@__PURE__*/ float( - 2.0 );\nconst cubeUV_r1 = /*@__PURE__*/ float( 0.8 );\nconst cubeUV_m1 = /*@__PURE__*/ float( - 1.0 );\nconst cubeUV_r4 = /*@__PURE__*/ float( 0.4 );\nconst cubeUV_m4 = /*@__PURE__*/ float( 2.0 );\nconst cubeUV_r5 = /*@__PURE__*/ float( 0.305 );\nconst cubeUV_m5 = /*@__PURE__*/ float( 3.0 );\nconst cubeUV_r6 = /*@__PURE__*/ float( 0.21 );\nconst cubeUV_m6 = /*@__PURE__*/ float( 4.0 );\n\nconst cubeUV_minMipLevel = /*@__PURE__*/ float( 4.0 );\nconst cubeUV_minTileSize = /*@__PURE__*/ float( 16.0 );\n\n// These shader functions convert between the UV coordinates of a single face of\n// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n// sampling a textureCube (not generally normalized ).\n\nconst getFace = /*@__PURE__*/ Fn( ( [ direction ] ) => {\n\n\tconst absDirection = vec3( abs( direction ) ).toVar();\n\tconst face = float( - 1.0 ).toVar();\n\n\tIf( absDirection.x.greaterThan( absDirection.z ), () => {\n\n\t\tIf( absDirection.x.greaterThan( absDirection.y ), () => {\n\n\t\t\tface.assign( select( direction.x.greaterThan( 0.0 ), 0.0, 3.0 ) );\n\n\t\t} ).Else( () => {\n\n\t\t\tface.assign( select( direction.y.greaterThan( 0.0 ), 1.0, 4.0 ) );\n\n\t\t} );\n\n\t} ).Else( () => {\n\n\t\tIf( absDirection.z.greaterThan( absDirection.y ), () => {\n\n\t\t\tface.assign( select( direction.z.greaterThan( 0.0 ), 2.0, 5.0 ) );\n\n\t\t} ).Else( () => {\n\n\t\t\tface.assign( select( direction.y.greaterThan( 0.0 ), 1.0, 4.0 ) );\n\n\t\t} );\n\n\t} );\n\n\treturn face;\n\n} ).setLayout( {\n\tname: 'getFace',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'direction', type: 'vec3' }\n\t]\n} );\n\n// RH coordinate system; PMREM face-indexing convention\nconst getUV = /*@__PURE__*/ Fn( ( [ direction, face ] ) => {\n\n\tconst uv = vec2().toVar();\n\n\tIf( face.equal( 0.0 ), () => {\n\n\t\tuv.assign( vec2( direction.z, direction.y ).div( abs( direction.x ) ) ); // pos x\n\n\t} ).ElseIf( face.equal( 1.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.z.negate() ).div( abs( direction.y ) ) ); // pos y\n\n\t} ).ElseIf( face.equal( 2.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.y ).div( abs( direction.z ) ) ); // pos z\n\n\t} ).ElseIf( face.equal( 3.0 ), () => {\n\n\t\tuv.assign( vec2( direction.z.negate(), direction.y ).div( abs( direction.x ) ) ); // neg x\n\n\t} ).ElseIf( face.equal( 4.0 ), () => {\n\n\t\tuv.assign( vec2( direction.x.negate(), direction.z ).div( abs( direction.y ) ) ); // neg y\n\n\t} ).Else( () => {\n\n\t\tuv.assign( vec2( direction.x, direction.y ).div( abs( direction.z ) ) ); // neg z\n\n\t} );\n\n\treturn mul( 0.5, uv.add( 1.0 ) );\n\n} ).setLayout( {\n\tname: 'getUV',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'direction', type: 'vec3' },\n\t\t{ name: 'face', type: 'float' }\n\t]\n} );\n\nconst roughnessToMip = /*@__PURE__*/ Fn( ( [ roughness ] ) => {\n\n\tconst mip = float( 0.0 ).toVar();\n\n\tIf( roughness.greaterThanEqual( cubeUV_r1 ), () => {\n\n\t\tmip.assign( cubeUV_r0.sub( roughness ).mul( cubeUV_m1.sub( cubeUV_m0 ) ).div( cubeUV_r0.sub( cubeUV_r1 ) ).add( cubeUV_m0 ) );\n\n\t} ).ElseIf( roughness.greaterThanEqual( cubeUV_r4 ), () => {\n\n\t\tmip.assign( cubeUV_r1.sub( roughness ).mul( cubeUV_m4.sub( cubeUV_m1 ) ).div( cubeUV_r1.sub( cubeUV_r4 ) ).add( cubeUV_m1 ) );\n\n\t} ).ElseIf( roughness.greaterThanEqual( cubeUV_r5 ), () => {\n\n\t\tmip.assign( cubeUV_r4.sub( roughness ).mul( cubeUV_m5.sub( cubeUV_m4 ) ).div( cubeUV_r4.sub( cubeUV_r5 ) ).add( cubeUV_m4 ) );\n\n\t} ).ElseIf( roughness.greaterThanEqual( cubeUV_r6 ), () => {\n\n\t\tmip.assign( cubeUV_r5.sub( roughness ).mul( cubeUV_m6.sub( cubeUV_m5 ) ).div( cubeUV_r5.sub( cubeUV_r6 ) ).add( cubeUV_m5 ) );\n\n\t} ).Else( () => {\n\n\t\tmip.assign( float( - 2.0 ).mul( log2( mul( 1.16, roughness ) ) ) ); // 1.16 = 1.79^0.25\n\n\t} );\n\n\treturn mip;\n\n} ).setLayout( {\n\tname: 'roughnessToMip',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'roughness', type: 'float' }\n\t]\n} );\n\n// RH coordinate system; PMREM face-indexing convention\nconst getDirection = /*@__PURE__*/ Fn( ( [ uv_immutable, face ] ) => {\n\n\tconst uv = uv_immutable.toVar();\n\tuv.assign( mul( 2.0, uv ).sub( 1.0 ) );\n\tconst direction = vec3( uv, 1.0 ).toVar();\n\n\tIf( face.equal( 0.0 ), () => {\n\n\t\tdirection.assign( direction.zyx ); // ( 1, v, u ) pos x\n\n\t} ).ElseIf( face.equal( 1.0 ), () => {\n\n\t\tdirection.assign( direction.xzy );\n\t\tdirection.xz.mulAssign( - 1.0 ); // ( -u, 1, -v ) pos y\n\n\t} ).ElseIf( face.equal( 2.0 ), () => {\n\n\t\tdirection.x.mulAssign( - 1.0 ); // ( -u, v, 1 ) pos z\n\n\t} ).ElseIf( face.equal( 3.0 ), () => {\n\n\t\tdirection.assign( direction.zyx );\n\t\tdirection.xz.mulAssign( - 1.0 ); // ( -1, v, -u ) neg x\n\n\t} ).ElseIf( face.equal( 4.0 ), () => {\n\n\t\tdirection.assign( direction.xzy );\n\t\tdirection.xy.mulAssign( - 1.0 ); // ( -u, -1, v ) neg y\n\n\t} ).ElseIf( face.equal( 5.0 ), () => {\n\n\t\tdirection.z.mulAssign( - 1.0 ); // ( u, v, -1 ) neg zS\n\n\t} );\n\n\treturn direction;\n\n} ).setLayout( {\n\tname: 'getDirection',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'uv', type: 'vec2' },\n\t\t{ name: 'face', type: 'float' }\n\t]\n} );\n\n//\n\nconst textureCubeUV = /*@__PURE__*/ Fn( ( [ envMap, sampleDir_immutable, roughness_immutable, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ] ) => {\n\n\tconst roughness = float( roughness_immutable );\n\tconst sampleDir = vec3( sampleDir_immutable );\n\n\tconst mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\tconst mipF = fract( mip );\n\tconst mipInt = floor( mip );\n\tconst color0 = vec3( bilinearCubeUV( envMap, sampleDir, mipInt, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ) ).toVar();\n\n\tIf( mipF.notEqual( 0.0 ), () => {\n\n\t\tconst color1 = vec3( bilinearCubeUV( envMap, sampleDir, mipInt.add( 1.0 ), CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ) ).toVar();\n\n\t\tcolor0.assign( mix( color0, color1, mipF ) );\n\n\t} );\n\n\treturn color0;\n\n} );\n\nconst bilinearCubeUV = /*@__PURE__*/ Fn( ( [ envMap, direction_immutable, mipInt_immutable, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP ] ) => {\n\n\tconst mipInt = float( mipInt_immutable ).toVar();\n\tconst direction = vec3( direction_immutable );\n\tconst face = float( getFace( direction ) ).toVar();\n\tconst filterInt = float( max$1( cubeUV_minMipLevel.sub( mipInt ), 0.0 ) ).toVar();\n\tmipInt.assign( max$1( mipInt, cubeUV_minMipLevel ) );\n\tconst faceSize = float( exp2( mipInt ) ).toVar();\n\tconst uv = vec2( getUV( direction, face ).mul( faceSize.sub( 2.0 ) ).add( 1.0 ) ).toVar();\n\n\tIf( face.greaterThan( 2.0 ), () => {\n\n\t\tuv.y.addAssign( faceSize );\n\t\tface.subAssign( 3.0 );\n\n\t} );\n\n\tuv.x.addAssign( face.mul( faceSize ) );\n\tuv.x.addAssign( filterInt.mul( mul( 3.0, cubeUV_minTileSize ) ) );\n\tuv.y.addAssign( mul( 4.0, exp2( CUBEUV_MAX_MIP ).sub( faceSize ) ) );\n\tuv.x.mulAssign( CUBEUV_TEXEL_WIDTH );\n\tuv.y.mulAssign( CUBEUV_TEXEL_HEIGHT );\n\n\treturn envMap.uv( uv ).grad( vec2(), vec2() ); // disable anisotropic filtering\n\n} );\n\nconst getSample = /*@__PURE__*/ Fn( ( { envMap, mipInt, outputDirection, theta, axis, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) => {\n\n\tconst cosTheta = cos( theta );\n\n\t// Rodrigues' axis-angle rotation\n\tconst sampleDirection = outputDirection.mul( cosTheta )\n\t\t.add( axis.cross( outputDirection ).mul( sin( theta ) ) )\n\t\t.add( axis.mul( axis.dot( outputDirection ).mul( cosTheta.oneMinus() ) ) );\n\n\treturn bilinearCubeUV( envMap, sampleDirection, mipInt, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP );\n\n} );\n\nconst blur = /*@__PURE__*/ Fn( ( { n, latitudinal, poleAxis, outputDirection, weights, samples, dTheta, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) => {\n\n\tconst axis = vec3( select( latitudinal, poleAxis, cross( poleAxis, outputDirection ) ) ).toVar();\n\n\tIf( all( axis.equals( vec3( 0.0 ) ) ), () => {\n\n\t\taxis.assign( vec3( outputDirection.z, 0.0, outputDirection.x.negate() ) );\n\n\t} );\n\n\taxis.assign( normalize( axis ) );\n\n\tconst gl_FragColor = vec3().toVar();\n\tgl_FragColor.addAssign( weights.element( int( 0 ) ).mul( getSample( { theta: 0.0, axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\n\tLoop( { start: int( 1 ), end: n }, ( { i } ) => {\n\n\t\tIf( i.greaterThanEqual( samples ), () => {\n\n\t\t\tBreak();\n\n\t\t} );\n\n\t\tconst theta = float( dTheta.mul( float( i ) ) ).toVar();\n\t\tgl_FragColor.addAssign( weights.element( i ).mul( getSample( { theta: theta.mul( - 1.0 ), axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\t\tgl_FragColor.addAssign( weights.element( i ).mul( getSample( { theta, axis, outputDirection, mipInt, envMap, CUBEUV_TEXEL_WIDTH, CUBEUV_TEXEL_HEIGHT, CUBEUV_MAX_MIP } ) ) );\n\n\t} );\n\n\treturn vec4( gl_FragColor, 1 );\n\n} );\n\nlet _generator = null;\n\nconst _cache = new WeakMap();\n\nfunction _generateCubeUVSize( imageHeight ) {\n\n\tconst maxMip = Math.log2( imageHeight ) - 2;\n\n\tconst texelHeight = 1.0 / imageHeight;\n\n\tconst texelWidth = 1.0 / ( 3 * Math.max( Math.pow( 2, maxMip ), 7 * 16 ) );\n\n\treturn { texelWidth, texelHeight, maxMip };\n\n}\n\nfunction _getPMREMFromTexture( texture ) {\n\n\tlet cacheTexture = _cache.get( texture );\n\n\tconst pmremVersion = cacheTexture !== undefined ? cacheTexture.pmremVersion : - 1;\n\n\tif ( pmremVersion !== texture.pmremVersion ) {\n\n\t\tconst image = texture.image;\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\tif ( isCubeMapReady( image ) ) {\n\n\t\t\t\tcacheTexture = _generator.fromCubemap( texture, cacheTexture );\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\n\t\t} else {\n\n\t\t\tif ( isEquirectangularMapReady( image ) ) {\n\n\t\t\t\tcacheTexture = _generator.fromEquirectangular( texture, cacheTexture );\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tcacheTexture.pmremVersion = texture.pmremVersion;\n\n\t\t_cache.set( texture, cacheTexture );\n\n\t}\n\n\treturn cacheTexture.texture;\n\n}\n\nclass PMREMNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'PMREMNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis._value = value;\n\t\tthis._pmrem = null;\n\n\t\tthis.uvNode = uvNode;\n\t\tthis.levelNode = levelNode;\n\n\t\tthis._generator = null;\n\n\t\tconst defaultTexture = new Texture();\n\t\tdefaultTexture.isRenderTargetTexture = true;\n\n\t\tthis._texture = texture( defaultTexture );\n\n\t\tthis._width = uniform( 0 );\n\t\tthis._height = uniform( 0 );\n\t\tthis._maxMip = uniform( 0 );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tset value( value ) {\n\n\t\tthis._value = value;\n\t\tthis._pmrem = null;\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\tupdateFromTexture( texture ) {\n\n\t\tconst cubeUVSize = _generateCubeUVSize( texture.image.height );\n\n\t\tthis._texture.value = texture;\n\t\tthis._width.value = cubeUVSize.texelWidth;\n\t\tthis._height.value = cubeUVSize.texelHeight;\n\t\tthis._maxMip.value = cubeUVSize.maxMip;\n\n\t}\n\n\tupdateBefore() {\n\n\t\tlet pmrem = this._pmrem;\n\n\t\tconst pmremVersion = pmrem ? pmrem.pmremVersion : - 1;\n\t\tconst texture = this._value;\n\n\t\tif ( pmremVersion !== texture.pmremVersion ) {\n\n\t\t\tif ( texture.isPMREMTexture === true ) {\n\n\t\t\t\tpmrem = texture;\n\n\t\t\t} else {\n\n\t\t\t\tpmrem = _getPMREMFromTexture( texture );\n\n\t\t\t}\n\n\t\t\tif ( pmrem !== null ) {\n\n\t\t\t\tthis._pmrem = pmrem;\n\n\t\t\t\tthis.updateFromTexture( pmrem );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( _generator === null ) {\n\n\t\t\t_generator = builder.createPMREMGenerator();\n\n\t\t}\n\n\t\t//\n\n\t\tthis.updateBefore( builder );\n\n\t\t//\n\n\t\tlet uvNode = this.uvNode;\n\n\t\tif ( uvNode === null && builder.context.getUV ) {\n\n\t\t\tuvNode = builder.context.getUV( this );\n\n\t\t}\n\n\t\t//\n\n\t\tconst texture = this.value;\n\n\t\tif ( builder.renderer.coordinateSystem === WebGLCoordinateSystem && texture.isPMREMTexture !== true && texture.isRenderTargetTexture === true ) {\n\n\t\t\tuvNode = vec3( uvNode.x.negate(), uvNode.yz );\n\n\t\t}\n\n\t\t//\n\n\t\tlet levelNode = this.levelNode;\n\n\t\tif ( levelNode === null && builder.context.getTextureLevel ) {\n\n\t\t\tlevelNode = builder.context.getTextureLevel( this );\n\n\t\t}\n\n\t\t//\n\n\t\treturn textureCubeUV( this._texture, uvNode, levelNode, this._width, this._height, this._maxMip );\n\n\t}\n\n}\n\nfunction isCubeMapReady( image ) {\n\n\tif ( image === null || image === undefined ) return false;\n\n\tlet count = 0;\n\tconst length = 6;\n\n\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\tif ( image[ i ] !== undefined ) count ++;\n\n\t}\n\n\treturn count === length;\n\n\n}\n\nfunction isEquirectangularMapReady( image ) {\n\n\tif ( image === null || image === undefined ) return false;\n\n\treturn image.height > 0;\n\n}\n\nconst pmremTexture = /*@__PURE__*/ nodeProxy( PMREMNode );\n\nconst _envNodeCache = new WeakMap();\n\nclass EnvironmentNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'EnvironmentNode';\n\n\t}\n\n\tconstructor( envNode = null ) {\n\n\t\tsuper();\n\n\t\tthis.envNode = envNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { material } = builder;\n\n\t\tlet envNode = this.envNode;\n\n\t\tif ( envNode.isTextureNode || envNode.isMaterialReferenceNode ) {\n\n\t\t\tconst value = ( envNode.isTextureNode ) ? envNode.value : material[ envNode.property ];\n\n\t\t\tlet cacheEnvNode = _envNodeCache.get( value );\n\n\t\t\tif ( cacheEnvNode === undefined ) {\n\n\t\t\t\tcacheEnvNode = pmremTexture( value );\n\n\t\t\t\t_envNodeCache.set( value, cacheEnvNode );\n\n\t\t\t}\n\n\t\t\tenvNode\t= cacheEnvNode;\n\n\t\t}\n\n\t\t//\n\n\t\tconst envMap = material.envMap;\n\t\tconst intensity = envMap ? reference( 'envMapIntensity', 'float', builder.material ) : reference( 'environmentIntensity', 'float', builder.scene ); // @TODO: Add materialEnvIntensity in MaterialNode\n\n\t\tconst useAnisotropy = material.useAnisotropy === true || material.anisotropy > 0;\n\t\tconst radianceNormalView = useAnisotropy ? transformedBentNormalView : transformedNormalView;\n\n\t\tconst radiance = envNode.context( createRadianceContext( roughness, radianceNormalView ) ).mul( intensity );\n\t\tconst irradiance = envNode.context( createIrradianceContext( transformedNormalWorld ) ).mul( Math.PI ).mul( intensity );\n\n\t\tconst isolateRadiance = cache( radiance );\n\t\tconst isolateIrradiance = cache( irradiance );\n\n\t\t//\n\n\t\tbuilder.context.radiance.addAssign( isolateRadiance );\n\n\t\tbuilder.context.iblIrradiance.addAssign( isolateIrradiance );\n\n\t\t//\n\n\t\tconst clearcoatRadiance = builder.context.lightingModel.clearcoatRadiance;\n\n\t\tif ( clearcoatRadiance ) {\n\n\t\t\tconst clearcoatRadianceContext = envNode.context( createRadianceContext( clearcoatRoughness, transformedClearcoatNormalView ) ).mul( intensity );\n\t\t\tconst isolateClearcoatRadiance = cache( clearcoatRadianceContext );\n\n\t\t\tclearcoatRadiance.addAssign( isolateClearcoatRadiance );\n\n\t\t}\n\n\t}\n\n}\n\nconst createRadianceContext = ( roughnessNode, normalViewNode ) => {\n\n\tlet reflectVec = null;\n\n\treturn {\n\t\tgetUV: () => {\n\n\t\t\tif ( reflectVec === null ) {\n\n\t\t\t\treflectVec = positionViewDirection.negate().reflect( normalViewNode );\n\n\t\t\t\t// Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t\t\treflectVec = roughnessNode.mul( roughnessNode ).mix( reflectVec, normalViewNode ).normalize();\n\n\t\t\t\treflectVec = reflectVec.transformDirection( cameraViewMatrix );\n\n\t\t\t}\n\n\t\t\treturn reflectVec;\n\n\t\t},\n\t\tgetTextureLevel: () => {\n\n\t\t\treturn roughnessNode;\n\n\t\t}\n\t};\n\n};\n\nconst createIrradianceContext = ( normalWorldNode ) => {\n\n\treturn {\n\t\tgetUV: () => {\n\n\t\t\treturn normalWorldNode;\n\n\t\t},\n\t\tgetTextureLevel: () => {\n\n\t\t\treturn float( 1.0 );\n\n\t\t}\n\t};\n\n};\n\nconst _defaultValues$6 = /*@__PURE__*/ new MeshStandardMaterial();\n\nclass MeshStandardNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshStandardNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshStandardNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.emissiveNode = null;\n\n\t\tthis.metalnessNode = null;\n\t\tthis.roughnessNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$6 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupEnvironment( builder ) {\n\n\t\tlet envNode = super.setupEnvironment( builder );\n\n\t\tif ( envNode === null && builder.environmentNode ) {\n\n\t\t\tenvNode = builder.environmentNode;\n\n\t\t}\n\n\t\treturn envNode ? new EnvironmentNode( envNode ) : null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhysicalLightingModel();\n\n\t}\n\n\tsetupSpecular() {\n\n\t\tconst specularColorNode = mix( vec3( 0.04 ), diffuseColor.rgb, metalness );\n\n\t\tspecularColor.assign( specularColorNode );\n\t\tspecularF90.assign( 1.0 );\n\n\t}\n\n\tsetupVariants() {\n\n\t\t// METALNESS\n\n\t\tconst metalnessNode = this.metalnessNode ? float( this.metalnessNode ) : materialMetalness;\n\n\t\tmetalness.assign( metalnessNode );\n\n\t\t// ROUGHNESS\n\n\t\tlet roughnessNode = this.roughnessNode ? float( this.roughnessNode ) : materialRoughness;\n\t\troughnessNode = getRoughness( { roughness: roughnessNode } );\n\n\t\troughness.assign( roughnessNode );\n\n\t\t// SPECULAR COLOR\n\n\t\tthis.setupSpecular();\n\n\t\t// DIFFUSE COLOR\n\n\t\tdiffuseColor.assign( vec4( diffuseColor.rgb.mul( metalnessNode.oneMinus() ), diffuseColor.a ) );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.emissiveNode = source.emissiveNode;\n\n\t\tthis.metalnessNode = source.metalnessNode;\n\t\tthis.roughnessNode = source.roughnessNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst _defaultValues$5 = /*@__PURE__*/ new MeshPhysicalMaterial();\n\nclass MeshPhysicalNodeMaterial extends MeshStandardNodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshPhysicalNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshPhysicalNodeMaterial = true;\n\n\t\tthis.clearcoatNode = null;\n\t\tthis.clearcoatRoughnessNode = null;\n\t\tthis.clearcoatNormalNode = null;\n\n\t\tthis.sheenNode = null;\n\t\tthis.sheenRoughnessNode = null;\n\n\t\tthis.iridescenceNode = null;\n\t\tthis.iridescenceIORNode = null;\n\t\tthis.iridescenceThicknessNode = null;\n\n\t\tthis.specularIntensityNode = null;\n\t\tthis.specularColorNode = null;\n\n\t\tthis.iorNode = null;\n\t\tthis.transmissionNode = null;\n\t\tthis.thicknessNode = null;\n\t\tthis.attenuationDistanceNode = null;\n\t\tthis.attenuationColorNode = null;\n\t\tthis.dispersionNode = null;\n\n\t\tthis.anisotropyNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$5 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tget useClearcoat() {\n\n\t\treturn this.clearcoat > 0 || this.clearcoatNode !== null;\n\n\t}\n\n\tget useIridescence() {\n\n\t\treturn this.iridescence > 0 || this.iridescenceNode !== null;\n\n\t}\n\n\tget useSheen() {\n\n\t\treturn this.sheen > 0 || this.sheenNode !== null;\n\n\t}\n\n\tget useAnisotropy() {\n\n\t\treturn this.anisotropy > 0 || this.anisotropyNode !== null;\n\n\t}\n\n\tget useTransmission() {\n\n\t\treturn this.transmission > 0 || this.transmissionNode !== null;\n\n\t}\n\n\tget useDispersion() {\n\n\t\treturn this.dispersion > 0 || this.dispersionNode !== null;\n\n\t}\n\n\tsetupSpecular() {\n\n\t\tconst iorNode = this.iorNode ? float( this.iorNode ) : materialIOR;\n\n\t\tior.assign( iorNode );\n\t\tspecularColor.assign( mix( min$1( pow2( ior.sub( 1.0 ).div( ior.add( 1.0 ) ) ).mul( materialSpecularColor ), vec3( 1.0 ) ).mul( materialSpecularIntensity ), diffuseColor.rgb, metalness ) );\n\t\tspecularF90.assign( mix( materialSpecularIntensity, 1.0, metalness ) );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new PhysicalLightingModel( this.useClearcoat, this.useSheen, this.useIridescence, this.useAnisotropy, this.useTransmission, this.useDispersion );\n\n\t}\n\n\tsetupVariants( builder ) {\n\n\t\tsuper.setupVariants( builder );\n\n\t\t// CLEARCOAT\n\n\t\tif ( this.useClearcoat ) {\n\n\t\t\tconst clearcoatNode = this.clearcoatNode ? float( this.clearcoatNode ) : materialClearcoat;\n\t\t\tconst clearcoatRoughnessNode = this.clearcoatRoughnessNode ? float( this.clearcoatRoughnessNode ) : materialClearcoatRoughness;\n\n\t\t\tclearcoat.assign( clearcoatNode );\n\t\t\tclearcoatRoughness.assign( getRoughness( { roughness: clearcoatRoughnessNode } ) );\n\n\t\t}\n\n\t\t// SHEEN\n\n\t\tif ( this.useSheen ) {\n\n\t\t\tconst sheenNode = this.sheenNode ? vec3( this.sheenNode ) : materialSheen;\n\t\t\tconst sheenRoughnessNode = this.sheenRoughnessNode ? float( this.sheenRoughnessNode ) : materialSheenRoughness;\n\n\t\t\tsheen.assign( sheenNode );\n\t\t\tsheenRoughness.assign( sheenRoughnessNode );\n\n\t\t}\n\n\t\t// IRIDESCENCE\n\n\t\tif ( this.useIridescence ) {\n\n\t\t\tconst iridescenceNode = this.iridescenceNode ? float( this.iridescenceNode ) : materialIridescence;\n\t\t\tconst iridescenceIORNode = this.iridescenceIORNode ? float( this.iridescenceIORNode ) : materialIridescenceIOR;\n\t\t\tconst iridescenceThicknessNode = this.iridescenceThicknessNode ? float( this.iridescenceThicknessNode ) : materialIridescenceThickness;\n\n\t\t\tiridescence.assign( iridescenceNode );\n\t\t\tiridescenceIOR.assign( iridescenceIORNode );\n\t\t\tiridescenceThickness.assign( iridescenceThicknessNode );\n\n\t\t}\n\n\t\t// ANISOTROPY\n\n\t\tif ( this.useAnisotropy ) {\n\n\t\t\tconst anisotropyV = ( this.anisotropyNode ? vec2( this.anisotropyNode ) : materialAnisotropy ).toVar();\n\n\t\t\tanisotropy.assign( anisotropyV.length() );\n\n\t\t\tIf( anisotropy.equal( 0.0 ), () => {\n\n\t\t\t\tanisotropyV.assign( vec2( 1.0, 0.0 ) );\n\n\t\t\t} ).Else( () => {\n\n\t\t\t\tanisotropyV.divAssign( vec2( anisotropy ) );\n\t\t\t\tanisotropy.assign( anisotropy.saturate() );\n\n\t\t\t} );\n\n\t\t\t// Roughness along the anisotropy bitangent is the material roughness, while the tangent roughness increases with anisotropy.\n\t\t\talphaT.assign( anisotropy.pow2().mix( roughness.pow2(), 1.0 ) );\n\n\t\t\tanisotropyT.assign( TBNViewMatrix[ 0 ].mul( anisotropyV.x ).add( TBNViewMatrix[ 1 ].mul( anisotropyV.y ) ) );\n\t\t\tanisotropyB.assign( TBNViewMatrix[ 1 ].mul( anisotropyV.x ).sub( TBNViewMatrix[ 0 ].mul( anisotropyV.y ) ) );\n\n\t\t}\n\n\t\t// TRANSMISSION\n\n\t\tif ( this.useTransmission ) {\n\n\t\t\tconst transmissionNode = this.transmissionNode ? float( this.transmissionNode ) : materialTransmission;\n\t\t\tconst thicknessNode = this.thicknessNode ? float( this.thicknessNode ) : materialThickness;\n\t\t\tconst attenuationDistanceNode = this.attenuationDistanceNode ? float( this.attenuationDistanceNode ) : materialAttenuationDistance;\n\t\t\tconst attenuationColorNode = this.attenuationColorNode ? vec3( this.attenuationColorNode ) : materialAttenuationColor;\n\n\t\t\ttransmission.assign( transmissionNode );\n\t\t\tthickness.assign( thicknessNode );\n\t\t\tattenuationDistance.assign( attenuationDistanceNode );\n\t\t\tattenuationColor.assign( attenuationColorNode );\n\n\t\t\tif ( this.useDispersion ) {\n\n\t\t\t\tconst dispersionNode = this.dispersionNode ? float( this.dispersionNode ) : materialDispersion;\n\n\t\t\t\tdispersion.assign( dispersionNode );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetupClearcoatNormal() {\n\n\t\treturn this.clearcoatNormalNode ? vec3( this.clearcoatNormalNode ) : materialClearcoatNormal;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tbuilder.context.setupClearcoatNormal = () => this.setupClearcoatNormal( builder );\n\n\t\tsuper.setup( builder );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.clearcoatNode = source.clearcoatNode;\n\t\tthis.clearcoatRoughnessNode = source.clearcoatRoughnessNode;\n\t\tthis.clearcoatNormalNode = source.clearcoatNormalNode;\n\n\t\tthis.sheenNode = source.sheenNode;\n\t\tthis.sheenRoughnessNode = source.sheenRoughnessNode;\n\n\t\tthis.iridescenceNode = source.iridescenceNode;\n\t\tthis.iridescenceIORNode = source.iridescenceIORNode;\n\t\tthis.iridescenceThicknessNode = source.iridescenceThicknessNode;\n\n\t\tthis.specularIntensityNode = source.specularIntensityNode;\n\t\tthis.specularColorNode = source.specularColorNode;\n\n\t\tthis.transmissionNode = source.transmissionNode;\n\t\tthis.thicknessNode = source.thicknessNode;\n\t\tthis.attenuationDistanceNode = source.attenuationDistanceNode;\n\t\tthis.attenuationColorNode = source.attenuationColorNode;\n\t\tthis.dispersionNode = source.dispersionNode;\n\n\t\tthis.anisotropyNode = source.anisotropyNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nclass SSSLightingModel extends PhysicalLightingModel {\n\n\tconstructor( useClearcoat, useSheen, useIridescence, useSSS ) {\n\n\t\tsuper( useClearcoat, useSheen, useIridescence );\n\n\t\tthis.useSSS = useSSS;\n\n\t}\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tif ( this.useSSS === true ) {\n\n\t\t\tconst material = builder.material;\n\n\t\t\tconst { thicknessColorNode, thicknessDistortionNode, thicknessAmbientNode, thicknessAttenuationNode, thicknessPowerNode, thicknessScaleNode } = material;\n\n\t\t\tconst scatteringHalf = lightDirection.add( transformedNormalView.mul( thicknessDistortionNode ) ).normalize();\n\t\t\tconst scatteringDot = float( positionViewDirection.dot( scatteringHalf.negate() ).saturate().pow( thicknessPowerNode ).mul( thicknessScaleNode ) );\n\t\t\tconst scatteringIllu = vec3( scatteringDot.add( thicknessAmbientNode ).mul( thicknessColorNode ) );\n\n\t\t\treflectedLight.directDiffuse.addAssign( scatteringIllu.mul( thicknessAttenuationNode.mul( lightColor ) ) );\n\n\t\t}\n\n\t\tsuper.direct( { lightDirection, lightColor, reflectedLight }, stack, builder );\n\n\t}\n\n}\n\nclass MeshSSSNodeMaterial extends MeshPhysicalNodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshSSSNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.thicknessColorNode = null;\n\t\tthis.thicknessDistortionNode = float( 0.1 );\n\t\tthis.thicknessAmbientNode = float( 0.0 );\n\t\tthis.thicknessAttenuationNode = float( .1 );\n\t\tthis.thicknessPowerNode = float( 2.0 );\n\t\tthis.thicknessScaleNode = float( 10.0 );\n\n\t}\n\n\tget useSSS() {\n\n\t\treturn this.thicknessColorNode !== null;\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new SSSLightingModel( this.useClearcoat, this.useSheen, this.useIridescence, this.useSSS );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.thicknessColorNode = source.thicknessColorNode;\n\t\tthis.thicknessDistortionNode = source.thicknessDistortionNode;\n\t\tthis.thicknessAmbientNode = source.thicknessAmbientNode;\n\t\tthis.thicknessAttenuationNode = source.thicknessAttenuationNode;\n\t\tthis.thicknessPowerNode = source.thicknessPowerNode;\n\t\tthis.thicknessScaleNode = source.thicknessScaleNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nconst getGradientIrradiance = /*@__PURE__*/ Fn( ( { normal, lightDirection, builder } ) => {\n\n\t// dotNL will be from -1.0 to 1.0\n\tconst dotNL = normal.dot( lightDirection );\n\tconst coord = vec2( dotNL.mul( 0.5 ).add( 0.5 ), 0.0 );\n\n\tif ( builder.material.gradientMap ) {\n\n\t\tconst gradientMap = materialReference( 'gradientMap', 'texture' ).context( { getUV: () => coord } );\n\n\t\treturn vec3( gradientMap.r );\n\n\t} else {\n\n\t\tconst fw = coord.fwidth().mul( 0.5 );\n\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( float( 0.7 ).sub( fw.x ), float( 0.7 ).add( fw.x ), coord.x ) );\n\n\t}\n\n} );\n\nclass ToonLightingModel extends LightingModel {\n\n\tdirect( { lightDirection, lightColor, reflectedLight }, stack, builder ) {\n\n\t\tconst irradiance = getGradientIrradiance( { normal: normalGeometry, lightDirection, builder } ).mul( lightColor );\n\n\t\treflectedLight.directDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor: diffuseColor.rgb } ) ) );\n\n\t}\n\n\tindirect( { ambientOcclusion, irradiance, reflectedLight } ) {\n\n\t\treflectedLight.indirectDiffuse.addAssign( irradiance.mul( BRDF_Lambert( { diffuseColor } ) ) );\n\n\t\treflectedLight.indirectDiffuse.mulAssign( ambientOcclusion );\n\n\t}\n\n}\n\nconst _defaultValues$4 = /*@__PURE__*/ new MeshToonMaterial();\n\nclass MeshToonNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshToonNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isMeshToonNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues$4 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new ToonLightingModel();\n\n\t}\n\n}\n\nclass MatcapUVNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'MatcapUVNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t}\n\n\tsetup() {\n\n\t\tconst x = vec3( positionViewDirection.z, 0, positionViewDirection.x.negate() ).normalize();\n\t\tconst y = positionViewDirection.cross( x );\n\n\t\treturn vec2( x.dot( transformedNormalView ), y.dot( transformedNormalView ) ).mul( 0.495 ).add( 0.5 ); // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t}\n\n}\n\nconst matcapUV = /*@__PURE__*/ nodeImmutable( MatcapUVNode );\n\nconst _defaultValues$3 = /*@__PURE__*/ new MeshMatcapMaterial();\n\nclass MeshMatcapNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'MeshMatcapNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\n\t\tthis.isMeshMatcapNodeMaterial = true;\n\n\t\tthis.setDefaultValues( _defaultValues$3 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupVariants( builder ) {\n\n\t\tconst uv = matcapUV;\n\n\t\tlet matcapColor;\n\n\t\tif ( builder.material.matcap ) {\n\n\t\t\tmatcapColor = materialReference( 'matcap', 'texture' ).context( { getUV: () => uv } );\n\n\t\t} else {\n\n\t\t\tmatcapColor = vec3( mix( 0.2, 0.8, uv.y ) ); // default if matcap is missing\n\n\t\t}\n\n\t\tdiffuseColor.rgb.mulAssign( matcapColor.rgb );\n\n\t}\n\n}\n\nconst _defaultValues$2 = /*@__PURE__*/ new PointsMaterial();\n\nclass PointsNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'PointsNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isPointsNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis.transparent = true;\n\n\t\tthis.sizeNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$2 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.sizeNode = source.sizeNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n}\n\nclass RotateNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'RotateNode';\n\n\t}\n\n\tconstructor( positionNode, rotationNode ) {\n\n\t\tsuper();\n\n\t\tthis.positionNode = positionNode;\n\t\tthis.rotationNode = rotationNode;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.positionNode.getNodeType( builder );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { rotationNode, positionNode } = this;\n\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tif ( nodeType === 'vec2' ) {\n\n\t\t\tconst cosAngle = rotationNode.cos();\n\t\t\tconst sinAngle = rotationNode.sin();\n\n\t\t\tconst rotationMatrix = mat2(\n\t\t\t\tcosAngle, sinAngle,\n\t\t\t\tsinAngle.negate(), cosAngle\n\t\t\t);\n\n\t\t\treturn rotationMatrix.mul( positionNode );\n\n\t\t} else {\n\n\t\t\tconst rotation = rotationNode;\n\t\t\tconst rotationXMatrix = mat4( vec4( 1.0, 0.0, 0.0, 0.0 ), vec4( 0.0, cos( rotation.x ), sin( rotation.x ).negate(), 0.0 ), vec4( 0.0, sin( rotation.x ), cos( rotation.x ), 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\t\t\tconst rotationYMatrix = mat4( vec4( cos( rotation.y ), 0.0, sin( rotation.y ), 0.0 ), vec4( 0.0, 1.0, 0.0, 0.0 ), vec4( sin( rotation.y ).negate(), 0.0, cos( rotation.y ), 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\t\t\tconst rotationZMatrix = mat4( vec4( cos( rotation.z ), sin( rotation.z ).negate(), 0.0, 0.0 ), vec4( sin( rotation.z ), cos( rotation.z ), 0.0, 0.0 ), vec4( 0.0, 0.0, 1.0, 0.0 ), vec4( 0.0, 0.0, 0.0, 1.0 ) );\n\n\t\t\treturn rotationXMatrix.mul( rotationYMatrix ).mul( rotationZMatrix ).mul( vec4( positionNode, 1.0 ) ).xyz;\n\n\t\t}\n\n\t}\n\n}\n\nconst rotate = /*@__PURE__*/ nodeProxy( RotateNode );\n\nconst _defaultValues$1 = /*@__PURE__*/ new SpriteMaterial();\n\nclass SpriteNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'SpriteNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isSpriteNodeMaterial = true;\n\n\t\tthis.lights = false;\n\t\tthis._useSizeAttenuation = true;\n\n\t\tthis.positionNode = null;\n\t\tthis.rotationNode = null;\n\t\tthis.scaleNode = null;\n\n\t\tthis.setDefaultValues( _defaultValues$1 );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupPosition( { object, camera, context } ) {\n\n\t\tconst sizeAttenuation = this.sizeAttenuation;\n\n\t\t// < VERTEX STAGE >\n\n\t\tconst { positionNode, rotationNode, scaleNode } = this;\n\n\t\tconst vertex = positionLocal;\n\n\t\tlet mvPosition = modelViewMatrix.mul( vec3( positionNode || 0 ) );\n\n\t\tlet scale = vec2( modelWorldMatrix[ 0 ].xyz.length(), modelWorldMatrix[ 1 ].xyz.length() );\n\n\t\tif ( scaleNode !== null ) {\n\n\t\t\tscale = scale.mul( scaleNode );\n\n\t\t}\n\n\n\t\tif ( ! sizeAttenuation ) {\n\n\t\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\t\tscale = scale.mul( mvPosition.z.negate() );\n\n\t\t\t} else {\n\n\t\t\t\tconst orthoScale = float( 2.0 ).div( cameraProjectionMatrix.element( 1 ).element( 1 ) );\n\t\t\t\tscale = scale.mul( orthoScale.mul( 2 ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet alignedPosition = vertex.xy;\n\n\t\tif ( object.center && object.center.isVector2 === true ) {\n\n\t\t\tconst center = reference$1( 'center', 'vec2' );\n\n\t\t\talignedPosition = alignedPosition.sub( center.sub( 0.5 ) );\n\n\t\t}\n\n\t\talignedPosition = alignedPosition.mul( scale );\n\n\t\tconst rotation = float( rotationNode || materialRotation );\n\n\t\tconst rotatedPosition = rotate( alignedPosition, rotation );\n\n\t\tmvPosition = vec4( mvPosition.xy.add( rotatedPosition ), mvPosition.zw );\n\n\t\tconst modelViewProjection = cameraProjectionMatrix.mul( mvPosition );\n\n\t\tcontext.vertex = vertex;\n\n\t\treturn modelViewProjection;\n\n\t}\n\n\tcopy( source ) {\n\n\t\tthis.positionNode = source.positionNode;\n\t\tthis.rotationNode = source.rotationNode;\n\t\tthis.scaleNode = source.scaleNode;\n\n\t\treturn super.copy( source );\n\n\t}\n\n\tget sizeAttenuation() {\n\n\t\treturn this._useSizeAttenuation;\n\n\t}\n\n\tset sizeAttenuation( value ) {\n\n\t\tif ( this._useSizeAttenuation !== value ) {\n\n\t\t\tthis._useSizeAttenuation = value;\n\t\t\tthis.needsUpdate = true;\n\n\t\t}\n\n\t}\n\n}\n\nclass ShadowMaskModel extends LightingModel {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.shadowNode = float( 1 ).toVar( 'shadowMask' );\n\n\t}\n\n\tdirect( { shadowMask } ) {\n\n\t\tthis.shadowNode.mulAssign( shadowMask );\n\n\t}\n\n\tfinish( context ) {\n\n\t\tdiffuseColor.a.mulAssign( this.shadowNode.oneMinus() );\n\n\t\tcontext.outgoingLight.rgb.assign( diffuseColor.rgb ); // TODO: Optimize LightsNode to avoid this assignment\n\n\t}\n\n}\n\nconst _defaultValues = /*@__PURE__*/ new ShadowMaterial();\n\nclass ShadowNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'ShadowNodeMaterial';\n\n\t}\n\n\tconstructor( parameters ) {\n\n\t\tsuper();\n\n\t\tthis.isShadowNodeMaterial = true;\n\n\t\tthis.lights = true;\n\n\t\tthis.setDefaultValues( _defaultValues );\n\n\t\tthis.setValues( parameters );\n\n\t}\n\n\tsetupLightingModel( /*builder*/ ) {\n\n\t\treturn new ShadowMaskModel();\n\n\t}\n\n}\n\nconst normal = Fn( ( { texture, uv } ) => {\n\n\tconst epsilon = 0.0001;\n\n\tconst ret = vec3().toVar();\n\n\tIf( uv.x.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 1, 0, 0 ) );\n\n\t} ).ElseIf( uv.y.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 1, 0 ) );\n\n\t} ).ElseIf( uv.z.lessThan( epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 0, 1 ) );\n\n\t} ).ElseIf( uv.x.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( - 1, 0, 0 ) );\n\n\t} ).ElseIf( uv.y.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( 0, - 1, 0 ) );\n\n\t} ).ElseIf( uv.z.greaterThan( 1 - epsilon ), () => {\n\n\t\tret.assign( vec3( 0, 0, - 1 ) );\n\n\t} ).Else( () => {\n\n\t\tconst step = 0.01;\n\n\t\tconst x = texture.uv( uv.add( vec3( - step, 0.0, 0.0 ) ) ).r.sub( texture.uv( uv.add( vec3( step, 0.0, 0.0 ) ) ).r );\n\t\tconst y = texture.uv( uv.add( vec3( 0.0, - step, 0.0 ) ) ).r.sub( texture.uv( uv.add( vec3( 0.0, step, 0.0 ) ) ).r );\n\t\tconst z = texture.uv( uv.add( vec3( 0.0, 0.0, - step ) ) ).r.sub( texture.uv( uv.add( vec3( 0.0, 0.0, step ) ) ).r );\n\n\t\tret.assign( vec3( x, y, z ) );\n\n\t} );\n\n\treturn ret.normalize();\n\n} );\n\n\nclass Texture3DNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'Texture3DNode';\n\n\t}\n\n\tconstructor( value, uvNode = null, levelNode = null ) {\n\n\t\tsuper( value, uvNode, levelNode );\n\n\t\tthis.isTexture3DNode = true;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'texture3D';\n\n\t}\n\n\tgetDefaultUV() {\n\n\t\treturn vec3( 0.5, 0.5, 0.5 );\n\n\t}\n\n\tsetUpdateMatrix( /*updateMatrix*/ ) { } // Ignore .updateMatrix for 3d TextureNode\n\n\tsetupUV( builder, uvNode ) {\n\n\t\treturn uvNode;\n\n\t}\n\n\tgenerateUV( builder, uvNode ) {\n\n\t\treturn uvNode.build( builder, 'vec3' );\n\n\t}\n\n\tnormal( uvNode ) {\n\n\t\treturn normal( { texture: this, uv: uvNode } );\n\n\t}\n\n}\n\nconst texture3D = /*@__PURE__*/ nodeProxy( Texture3DNode );\n\nclass VolumeNodeMaterial extends NodeMaterial {\n\n\tstatic get type() {\n\n\t\treturn 'VolumeNodeMaterial';\n\n\t}\n\n\tconstructor( params = {} ) {\n\n\t\tsuper();\n\n\t\tthis.lights = false;\n\t\tthis.isVolumeNodeMaterial = true;\n\t\tthis.testNode = null;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst map = texture3D( this.map, null, 0 );\n\n\t\tconst hitBox = Fn( ( { orig, dir } ) => {\n\n\t\t\tconst box_min = vec3( - 0.5 );\n\t\t\tconst box_max = vec3( 0.5 );\n\n\t\t\tconst inv_dir = dir.reciprocal();\n\n\t\t\tconst tmin_tmp = box_min.sub( orig ).mul( inv_dir );\n\t\t\tconst tmax_tmp = box_max.sub( orig ).mul( inv_dir );\n\n\t\t\tconst tmin = min$1( tmin_tmp, tmax_tmp );\n\t\t\tconst tmax = max$1( tmin_tmp, tmax_tmp );\n\n\t\t\tconst t0 = max$1( tmin.x, max$1( tmin.y, tmin.z ) );\n\t\t\tconst t1 = min$1( tmax.x, min$1( tmax.y, tmax.z ) );\n\n\t\t\treturn vec2( t0, t1 );\n\n\t\t} );\n\n\t\tthis.fragmentNode = Fn( () => {\n\n\t\t\tconst vOrigin = varying( vec3( modelWorldMatrixInverse.mul( vec4( cameraPosition, 1.0 ) ) ) );\n\t\t\tconst vDirection = varying( positionGeometry.sub( vOrigin ) );\n\n\t\t\tconst rayDir = vDirection.normalize();\n\t\t\tconst bounds = vec2( hitBox( { orig: vOrigin, dir: rayDir } ) ).toVar();\n\n\t\t\tbounds.x.greaterThan( bounds.y ).discard();\n\n\t\t\tbounds.assign( vec2( max$1( bounds.x, 0.0 ), bounds.y ) );\n\n\t\t\tconst p = vec3( vOrigin.add( bounds.x.mul( rayDir ) ) ).toVar();\n\t\t\tconst inc = vec3( rayDir.abs().reciprocal() ).toVar();\n\t\t\tconst delta = float( min$1( inc.x, min$1( inc.y, inc.z ) ) ).toVar( 'delta' ); // used 'delta' name in loop\n\n\t\t\tdelta.divAssign( materialReference( 'steps', 'float' ) );\n\n\t\t\tconst ac = vec4( materialReference( 'base', 'color' ), 0.0 ).toVar();\n\n\t\t\tLoop( { type: 'float', start: bounds.x, end: bounds.y, update: '+= delta' }, () => {\n\n\t\t\t\tconst d = property( 'float', 'd' ).assign( map.uv( p.add( 0.5 ) ).r );\n\n\t\t\t\tif ( this.testNode !== null ) {\n\n\t\t\t\t\tthis.testNode( { map: map, mapValue: d, probe: p, finalColor: ac } ).append();\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// default to show surface of mesh\n\t\t\t\t\tac.a.assign( 1 );\n\t\t\t\t\tBreak();\n\n\t\t\t\t}\n\n\t\t\t\tp.addAssign( rayDir.mul( delta ) );\n\n\t\t\t} );\n\n\t\t\tac.a.equal( 0 ).discard();\n\n\t\t\treturn vec4( ac );\n\n\t\t} )();\n\n\t\tsuper.setup( builder );\n\n\t}\n\n}\n\nclass Animation {\n\n\tconstructor( nodes, info ) {\n\n\t\tthis.nodes = nodes;\n\t\tthis.info = info;\n\n\t\tthis.animationLoop = null;\n\t\tthis.requestId = null;\n\n\t\tthis._init();\n\n\t}\n\n\t_init() {\n\n\t\tconst update = ( time, frame ) => {\n\n\t\t\tthis.requestId = self.requestAnimationFrame( update );\n\n\t\t\tif ( this.info.autoReset === true ) this.info.reset();\n\n\t\t\tthis.nodes.nodeFrame.update();\n\n\t\t\tthis.info.frame = this.nodes.nodeFrame.frameId;\n\n\t\t\tif ( this.animationLoop !== null ) this.animationLoop( time, frame );\n\n\t\t};\n\n\t\tupdate();\n\n\t}\n\n\tdispose() {\n\n\t\tself.cancelAnimationFrame( this.requestId );\n\t\tthis.requestId = null;\n\n\t}\n\n\tsetAnimationLoop( callback ) {\n\n\t\tthis.animationLoop = callback;\n\n\t}\n\n}\n\nclass ChainMap {\n\n\tconstructor() {\n\n\t\tthis.weakMap = new WeakMap();\n\n\t}\n\n\tget( keys ) {\n\n\t\tlet map = this.weakMap;\n\n\t\tfor ( let i = 0; i < keys.length; i ++ ) {\n\n\t\t\tmap = map.get( keys[ i ] );\n\n\t\t\tif ( map === undefined ) return undefined;\n\n\t\t}\n\n\t\treturn map.get( keys[ keys.length - 1 ] );\n\n\t}\n\n\tset( keys, value ) {\n\n\t\tlet map = this.weakMap;\n\n\t\tfor ( let i = 0; i < keys.length; i ++ ) {\n\n\t\t\tconst key = keys[ i ];\n\n\t\t\tif ( map.has( key ) === false ) map.set( key, new WeakMap() );\n\n\t\t\tmap = map.get( key );\n\n\t\t}\n\n\t\treturn map.set( keys[ keys.length - 1 ], value );\n\n\t}\n\n\tdelete( keys ) {\n\n\t\tlet map = this.weakMap;\n\n\t\tfor ( let i = 0; i < keys.length; i ++ ) {\n\n\t\t\tmap = map.get( keys[ i ] );\n\n\t\t\tif ( map === undefined ) return false;\n\n\t\t}\n\n\t\treturn map.delete( keys[ keys.length - 1 ] );\n\n\t}\n\n}\n\nconst _plane = /*@__PURE__*/ new Plane();\n\nclass ClippingContext {\n\n\tconstructor() {\n\n\t\tthis.version = 0;\n\n\t\tthis.globalClippingCount = 0;\n\n\t\tthis.localClippingCount = 0;\n\t\tthis.localClippingEnabled = false;\n\t\tthis.localClipIntersection = false;\n\n\t\tthis.planes = [];\n\n\t\tthis.parentVersion = 0;\n\t\tthis.viewNormalMatrix = new Matrix3();\n\t\tthis.cacheKey = 0;\n\n\t}\n\n\tprojectPlanes( source, offset ) {\n\n\t\tconst l = source.length;\n\t\tconst planes = this.planes;\n\n\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t_plane.copy( source[ i ] ).applyMatrix4( this.viewMatrix, this.viewNormalMatrix );\n\n\t\t\tconst v = planes[ offset + i ];\n\t\t\tconst normal = _plane.normal;\n\n\t\t\tv.x = - normal.x;\n\t\t\tv.y = - normal.y;\n\t\t\tv.z = - normal.z;\n\t\t\tv.w = _plane.constant;\n\n\t\t}\n\n\t}\n\n\tupdateGlobal( renderer, camera ) {\n\n\t\tconst rendererClippingPlanes = renderer.clippingPlanes;\n\t\tthis.viewMatrix = camera.matrixWorldInverse;\n\n\t\tthis.viewNormalMatrix.getNormalMatrix( this.viewMatrix );\n\n\t\tlet update = false;\n\n\t\tif ( Array.isArray( rendererClippingPlanes ) && rendererClippingPlanes.length !== 0 ) {\n\n\t\t\tconst l = rendererClippingPlanes.length;\n\n\t\t\tif ( l !== this.globalClippingCount ) {\n\n\t\t\t\tconst planes = [];\n\n\t\t\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t\t\tplanes.push( new Vector4() );\n\n\t\t\t\t}\n\n\t\t\t\tthis.globalClippingCount = l;\n\t\t\t\tthis.planes = planes;\n\n\t\t\t\tupdate = true;\n\n\t\t\t}\n\n\t\t\tthis.projectPlanes( rendererClippingPlanes, 0 );\n\n\t\t} else if ( this.globalClippingCount !== 0 ) {\n\n\t\t\tthis.globalClippingCount = 0;\n\t\t\tthis.planes = [];\n\t\t\tupdate = true;\n\n\t\t}\n\n\t\tif ( renderer.localClippingEnabled !== this.localClippingEnabled ) {\n\n\t\t\tthis.localClippingEnabled = renderer.localClippingEnabled;\n\t\t\tupdate = true;\n\n\t\t}\n\n\t\tif ( update ) {\n\n\t\t\tthis.version ++;\n\t\t\tthis.cacheKey = hash$1( this.globalClippingCount, this.localClippingEnabled === true ? 1 : 0 );\n\n\t\t}\n\n\t}\n\n\tupdate( parent, material ) {\n\n\t\tlet update = false;\n\n\t\tif ( this !== parent && parent.version !== this.parentVersion ) {\n\n\t\t\tthis.globalClippingCount = material.isShadowNodeMaterial ? 0 : parent.globalClippingCount;\n\t\t\tthis.localClippingEnabled = parent.localClippingEnabled;\n\t\t\tthis.planes = Array.from( parent.planes );\n\t\t\tthis.parentVersion = parent.version;\n\t\t\tthis.viewMatrix = parent.viewMatrix;\n\t\t\tthis.viewNormalMatrix = parent.viewNormalMatrix;\n\n\t\t\tupdate = true;\n\n\t\t}\n\n\t\tif ( this.localClippingEnabled ) {\n\n\t\t\tconst localClippingPlanes = material.clippingPlanes;\n\n\t\t\tif ( ( Array.isArray( localClippingPlanes ) && localClippingPlanes.length !== 0 ) ) {\n\n\t\t\t\tconst l = localClippingPlanes.length;\n\t\t\t\tconst planes = this.planes;\n\t\t\t\tconst offset = this.globalClippingCount;\n\n\t\t\t\tif ( update || l !== this.localClippingCount ) {\n\n\t\t\t\t\tplanes.length = offset + l;\n\n\t\t\t\t\tfor ( let i = 0; i < l; i ++ ) {\n\n\t\t\t\t\t\tplanes[ offset + i ] = new Vector4();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.localClippingCount = l;\n\t\t\t\t\tupdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tthis.projectPlanes( localClippingPlanes, offset );\n\n\n\t\t\t} else if ( this.localClippingCount !== 0 ) {\n\n\t\t\t\tthis.localClippingCount = 0;\n\t\t\t\tupdate = true;\n\n\t\t\t}\n\n\t\t\tif ( this.localClipIntersection !== material.clipIntersection ) {\n\n\t\t\t\tthis.localClipIntersection = material.clipIntersection;\n\t\t\t\tupdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( update ) {\n\n\t\t\tthis.version += parent.version;\n\t\t\tthis.cacheKey = hash$1( parent.cacheKey, this.localClippingCount, this.localClipIntersection === true ? 1 : 0 );\n\n\t\t}\n\n\t}\n\n}\n\nlet _id$7 = 0;\n\nfunction getKeys( obj ) {\n\n\tconst keys = Object.keys( obj );\n\n\tlet proto = Object.getPrototypeOf( obj );\n\n\twhile ( proto ) {\n\n\t\tconst descriptors = Object.getOwnPropertyDescriptors( proto );\n\n\t\tfor ( const key in descriptors ) {\n\n\t\t\tif ( descriptors[ key ] !== undefined ) {\n\n\t\t\t\tconst descriptor = descriptors[ key ];\n\n\t\t\t\tif ( descriptor && typeof descriptor.get === 'function' ) {\n\n\t\t\t\t\tkeys.push( key );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tproto = Object.getPrototypeOf( proto );\n\n\t}\n\n\treturn keys;\n\n}\n\nclass RenderObject {\n\n\tconstructor( nodes, geometries, renderer, object, material, scene, camera, lightsNode, renderContext ) {\n\n\t\tthis._nodes = nodes;\n\t\tthis._geometries = geometries;\n\n\t\tthis.id = _id$7 ++;\n\n\t\tthis.renderer = renderer;\n\t\tthis.object = object;\n\t\tthis.material = material;\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\t\tthis.lightsNode = lightsNode;\n\t\tthis.context = renderContext;\n\n\t\tthis.geometry = object.geometry;\n\t\tthis.version = material.version;\n\n\t\tthis.drawRange = null;\n\n\t\tthis.attributes = null;\n\t\tthis.pipeline = null;\n\t\tthis.vertexBuffers = null;\n\t\tthis.drawParams = null;\n\n\t\tthis.bundle = null;\n\n\t\tthis.updateClipping( renderContext.clippingContext );\n\n\t\tthis.clippingContextVersion = this.clippingContext.version;\n\n\t\tthis.initialNodesCacheKey = this.getDynamicCacheKey();\n\t\tthis.initialCacheKey = this.getCacheKey();\n\n\t\tthis._nodeBuilderState = null;\n\t\tthis._bindings = null;\n\t\tthis._monitor = null;\n\n\t\tthis.onDispose = null;\n\n\t\tthis.isRenderObject = true;\n\n\t\tthis.onMaterialDispose = () => {\n\n\t\t\tthis.dispose();\n\n\t\t};\n\n\t\tthis.material.addEventListener( 'dispose', this.onMaterialDispose );\n\n\t}\n\n\tupdateClipping( parent ) {\n\n\t\tconst material = this.material;\n\n\t\tlet clippingContext = this.clippingContext;\n\n\t\tif ( Array.isArray( material.clippingPlanes ) ) {\n\n\t\t\tif ( clippingContext === parent || ! clippingContext ) {\n\n\t\t\t\tclippingContext = new ClippingContext();\n\t\t\t\tthis.clippingContext = clippingContext;\n\n\t\t\t}\n\n\t\t\tclippingContext.update( parent, material );\n\n\t\t} else if ( this.clippingContext !== parent ) {\n\n\t\t\tthis.clippingContext = parent;\n\n\t\t}\n\n\t}\n\n\tget clippingNeedsUpdate() {\n\n\t\tif ( this.clippingContext.version === this.clippingContextVersion ) return false;\n\n\t\tthis.clippingContextVersion = this.clippingContext.version;\n\n\t\treturn true;\n\n\t}\n\n\tgetNodeBuilderState() {\n\n\t\treturn this._nodeBuilderState || ( this._nodeBuilderState = this._nodes.getForRender( this ) );\n\n\t}\n\n\tgetMonitor() {\n\n\t\treturn this._monitor || ( this._monitor = this.getNodeBuilderState().monitor );\n\n\t}\n\n\tgetBindings() {\n\n\t\treturn this._bindings || ( this._bindings = this.getNodeBuilderState().createBindings() );\n\n\t}\n\n\tgetIndex() {\n\n\t\treturn this._geometries.getIndex( this );\n\n\t}\n\n\tgetIndirect() {\n\n\t\treturn this._geometries.getIndirect( this );\n\n\t}\n\n\tgetChainArray() {\n\n\t\treturn [ this.object, this.material, this.context, this.lightsNode ];\n\n\t}\n\n\tgetAttributes() {\n\n\t\tif ( this.attributes !== null ) return this.attributes;\n\n\t\tconst nodeAttributes = this.getNodeBuilderState().nodeAttributes;\n\t\tconst geometry = this.geometry;\n\n\t\tconst attributes = [];\n\t\tconst vertexBuffers = new Set();\n\n\t\tfor ( const nodeAttribute of nodeAttributes ) {\n\n\t\t\tconst attribute = nodeAttribute.node && nodeAttribute.node.attribute ? nodeAttribute.node.attribute : geometry.getAttribute( nodeAttribute.name );\n\n\t\t\tif ( attribute === undefined ) continue;\n\n\t\t\tattributes.push( attribute );\n\n\t\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\t\tvertexBuffers.add( bufferAttribute );\n\n\t\t}\n\n\t\tthis.attributes = attributes;\n\t\tthis.vertexBuffers = Array.from( vertexBuffers.values() );\n\n\t\treturn attributes;\n\n\t}\n\n\tgetVertexBuffers() {\n\n\t\tif ( this.vertexBuffers === null ) this.getAttributes();\n\n\t\treturn this.vertexBuffers;\n\n\t}\n\n\tgetDrawParameters() {\n\n\t\tconst { object, material, geometry, group, drawRange } = this;\n\n\t\tconst drawParams = this.drawParams || ( this.drawParams = {\n\t\t\tvertexCount: 0,\n\t\t\tfirstVertex: 0,\n\t\t\tinstanceCount: 0,\n\t\t\tfirstInstance: 0\n\t\t} );\n\n\t\tconst index = this.getIndex();\n\t\tconst hasIndex = ( index !== null );\n\t\tconst instanceCount = geometry.isInstancedBufferGeometry ? geometry.instanceCount : ( object.count > 1 ? object.count : 1 );\n\n\t\tif ( instanceCount === 0 ) return null;\n\n\t\tdrawParams.instanceCount = instanceCount;\n\n\t\tif ( object.isBatchedMesh === true ) return drawParams;\n\n\t\tlet rangeFactor = 1;\n\n\t\tif ( material.wireframe === true && ! object.isPoints && ! object.isLineSegments && ! object.isLine && ! object.isLineLoop ) {\n\n\t\t\trangeFactor = 2;\n\n\t\t}\n\n\t\tlet firstVertex = drawRange.start * rangeFactor;\n\t\tlet lastVertex = ( drawRange.start + drawRange.count ) * rangeFactor;\n\n\t\tif ( group !== null ) {\n\n\t\t\tfirstVertex = Math.max( firstVertex, group.start * rangeFactor );\n\t\t\tlastVertex = Math.min( lastVertex, ( group.start + group.count ) * rangeFactor );\n\n\t\t}\n\n\t\tconst position = geometry.attributes.position;\n\t\tlet itemCount = Infinity;\n\n\t\tif ( hasIndex ) {\n\n\t\t\titemCount = index.count;\n\n\t\t} else if ( position !== undefined && position !== null ) {\n\n\t\t\titemCount = position.count;\n\n\t\t}\n\n\t\tfirstVertex = Math.max( firstVertex, 0 );\n\t\tlastVertex = Math.min( lastVertex, itemCount );\n\n\t\tconst count = lastVertex - firstVertex;\n\n\t\tif ( count < 0 || count === Infinity ) return null;\n\n\t\tdrawParams.vertexCount = count;\n\t\tdrawParams.firstVertex = firstVertex;\n\n\t\treturn drawParams;\n\n\t}\n\n\tgetGeometryCacheKey() {\n\n\t\tconst { geometry } = this;\n\n\t\tlet cacheKey = '';\n\n\t\tfor ( const name of Object.keys( geometry.attributes ).sort() ) {\n\n\t\t\tconst attribute = geometry.attributes[ name ];\n\n\t\t\tcacheKey += name + ',';\n\n\t\t\tif ( attribute.data ) cacheKey += attribute.data.stride + ',';\n\t\t\tif ( attribute.offset ) cacheKey += attribute.offset + ',';\n\t\t\tif ( attribute.itemSize ) cacheKey += attribute.itemSize + ',';\n\t\t\tif ( attribute.normalized ) cacheKey += 'n,';\n\n\t\t}\n\n\t\tif ( geometry.index ) {\n\n\t\t\tcacheKey += 'index,';\n\n\t\t}\n\n\t\treturn cacheKey;\n\n\t}\n\n\tgetMaterialCacheKey() {\n\n\t\tconst { object, material } = this;\n\n\t\tlet cacheKey = material.customProgramCacheKey();\n\n\t\tfor ( const property of getKeys( material ) ) {\n\n\t\t\tif ( /^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test( property ) ) continue;\n\n\t\t\tconst value = material[ property ];\n\n\t\t\tlet valueKey;\n\n\t\t\tif ( value !== null ) {\n\n\t\t\t\t// some material values require a formatting\n\n\t\t\t\tconst type = typeof value;\n\n\t\t\t\tif ( type === 'number' ) {\n\n\t\t\t\t\tvalueKey = value !== 0 ? '1' : '0'; // Convert to on/off, important for clearcoat, transmission, etc\n\n\t\t\t\t} else if ( type === 'object' ) {\n\n\t\t\t\t\tvalueKey = '{';\n\n\t\t\t\t\tif ( value.isTexture ) {\n\n\t\t\t\t\t\tvalueKey += value.mapping;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvalueKey += '}';\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvalueKey = String( value );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tvalueKey = String( value );\n\n\t\t\t}\n\n\t\t\tcacheKey += /*property + ':' +*/ valueKey + ',';\n\n\t\t}\n\n\t\tcacheKey += this.clippingContext.cacheKey + ',';\n\n\t\tif ( object.geometry ) {\n\n\t\t\tcacheKey += this.getGeometryCacheKey();\n\n\t\t}\n\n\t\tif ( object.skeleton ) {\n\n\t\t\tcacheKey += object.skeleton.bones.length + ',';\n\n\t\t}\n\n\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\tcacheKey += object.morphTargetInfluences.length + ',';\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tcacheKey += object._matricesTexture.uuid + ',';\n\n\t\t\tif ( object._colorsTexture !== null ) {\n\n\t\t\t\tcacheKey += object._colorsTexture.uuid + ',';\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.count > 1 ) {\n\n\t\t\t// TODO: https://github.com/mrdoob/three.js/pull/29066#issuecomment-2269400850\n\n\t\t\tcacheKey += object.uuid + ',';\n\n\t\t}\n\n\t\treturn hashString( cacheKey );\n\n\t}\n\n\tget needsUpdate() {\n\n\t\treturn /*this.object.static !== true &&*/ ( this.initialNodesCacheKey !== this.getDynamicCacheKey() || this.clippingNeedsUpdate );\n\n\t}\n\n\tgetDynamicCacheKey() {\n\n\t\t// Environment Nodes Cache Key\n\n\t\tlet cacheKey = this._nodes.getCacheKey( this.scene, this.lightsNode );\n\n\t\tif ( this.object.receiveShadow ) {\n\n\t\t\tcacheKey += 1;\n\n\t\t}\n\n\t\treturn cacheKey;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn this.getMaterialCacheKey() + this.getDynamicCacheKey();\n\n\t}\n\n\tdispose() {\n\n\t\tthis.material.removeEventListener( 'dispose', this.onMaterialDispose );\n\n\t\tthis.onDispose();\n\n\t}\n\n}\n\nconst chainArray = [];\n\nclass RenderObjects {\n\n\tconstructor( renderer, nodes, geometries, pipelines, bindings, info ) {\n\n\t\tthis.renderer = renderer;\n\t\tthis.nodes = nodes;\n\t\tthis.geometries = geometries;\n\t\tthis.pipelines = pipelines;\n\t\tthis.bindings = bindings;\n\t\tthis.info = info;\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n\tget( object, material, scene, camera, lightsNode, renderContext, passId ) {\n\n\t\tconst chainMap = this.getChainMap( passId );\n\n\t\t// reuse chainArray\n\t\tchainArray[ 0 ] = object;\n\t\tchainArray[ 1 ] = material;\n\t\tchainArray[ 2 ] = renderContext;\n\t\tchainArray[ 3 ] = lightsNode;\n\n\t\tlet renderObject = chainMap.get( chainArray );\n\n\t\tif ( renderObject === undefined ) {\n\n\t\t\trenderObject = this.createRenderObject( this.nodes, this.geometries, this.renderer, object, material, scene, camera, lightsNode, renderContext, passId );\n\n\t\t\tchainMap.set( chainArray, renderObject );\n\n\t\t} else {\n\n\t\t\trenderObject.updateClipping( renderContext.clippingContext );\n\n\t\t\tif ( renderObject.version !== material.version || renderObject.needsUpdate ) {\n\n\t\t\t\tif ( renderObject.initialCacheKey !== renderObject.getCacheKey() ) {\n\n\t\t\t\t\trenderObject.dispose();\n\n\t\t\t\t\trenderObject = this.get( object, material, scene, camera, lightsNode, renderContext, passId );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderObject.version = material.version;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn renderObject;\n\n\t}\n\n\tgetChainMap( passId = 'default' ) {\n\n\t\treturn this.chainMaps[ passId ] || ( this.chainMaps[ passId ] = new ChainMap() );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n\tcreateRenderObject( nodes, geometries, renderer, object, material, scene, camera, lightsNode, renderContext, passId ) {\n\n\t\tconst chainMap = this.getChainMap( passId );\n\n\t\tconst renderObject = new RenderObject( nodes, geometries, renderer, object, material, scene, camera, lightsNode, renderContext );\n\n\t\trenderObject.onDispose = () => {\n\n\t\t\tthis.pipelines.delete( renderObject );\n\t\t\tthis.bindings.delete( renderObject );\n\t\t\tthis.nodes.delete( renderObject );\n\n\t\t\tchainMap.delete( renderObject.getChainArray() );\n\n\t\t};\n\n\t\treturn renderObject;\n\n\t}\n\n\n}\n\nclass DataMap {\n\n\tconstructor() {\n\n\t\tthis.data = new WeakMap();\n\n\t}\n\n\tget( object ) {\n\n\t\tlet map = this.data.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tthis.data.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\tdelete( object ) {\n\n\t\tlet map;\n\n\t\tif ( this.data.has( object ) ) {\n\n\t\t\tmap = this.data.get( object );\n\n\t\t\tthis.data.delete( object );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\thas( object ) {\n\n\t\treturn this.data.has( object );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.data = new WeakMap();\n\n\t}\n\n}\n\nconst AttributeType = {\n\tVERTEX: 1,\n\tINDEX: 2,\n\tSTORAGE: 3,\n\tINDIRECT: 4\n};\n\n// size of a chunk in bytes (STD140 layout)\n\nconst GPU_CHUNK_BYTES = 16;\n\n// @TODO: Move to src/constants.js\n\nconst BlendColorFactor = 211;\nconst OneMinusBlendColorFactor = 212;\n\nclass Attributes extends DataMap {\n\n\tconstructor( backend ) {\n\n\t\tsuper();\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tdelete( attribute ) {\n\n\t\tconst attributeData = super.delete( attribute );\n\n\t\tif ( attributeData !== undefined ) {\n\n\t\t\tthis.backend.destroyAttribute( attribute );\n\n\t\t}\n\n\t\treturn attributeData;\n\n\t}\n\n\tupdate( attribute, type ) {\n\n\t\tconst data = this.get( attribute );\n\n\t\tif ( data.version === undefined ) {\n\n\t\t\tif ( type === AttributeType.VERTEX ) {\n\n\t\t\t\tthis.backend.createAttribute( attribute );\n\n\t\t\t} else if ( type === AttributeType.INDEX ) {\n\n\t\t\t\tthis.backend.createIndexAttribute( attribute );\n\n\t\t\t} else if ( type === AttributeType.STORAGE ) {\n\n\t\t\t\tthis.backend.createStorageAttribute( attribute );\n\n\t\t\t} else if ( type === AttributeType.INDIRECT ) {\n\n\t\t\t\tthis.backend.createIndirectStorageAttribute( attribute );\n\n\t\t\t}\n\n\t\t\tdata.version = this._getBufferAttribute( attribute ).version;\n\n\t\t} else {\n\n\t\t\tconst bufferAttribute = this._getBufferAttribute( attribute );\n\n\t\t\tif ( data.version < bufferAttribute.version || bufferAttribute.usage === DynamicDrawUsage ) {\n\n\t\t\t\tthis.backend.updateAttribute( attribute );\n\n\t\t\t\tdata.version = bufferAttribute.version;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_getBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn attribute;\n\n\t}\n\n}\n\nfunction arrayNeedsUint32( array ) {\n\n\t// assumes larger values usually on last\n\n\tfor ( let i = array.length - 1; i >= 0; -- i ) {\n\n\t\tif ( array[ i ] >= 65535 ) return true; // account for PRIMITIVE_RESTART_FIXED_INDEX, #24565\n\n\t}\n\n\treturn false;\n\n}\n\nfunction getWireframeVersion( geometry ) {\n\n\treturn ( geometry.index !== null ) ? geometry.index.version : geometry.attributes.position.version;\n\n}\n\nfunction getWireframeIndex( geometry ) {\n\n\tconst indices = [];\n\n\tconst geometryIndex = geometry.index;\n\tconst geometryPosition = geometry.attributes.position;\n\n\tif ( geometryIndex !== null ) {\n\n\t\tconst array = geometryIndex.array;\n\n\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\tconst a = array[ i + 0 ];\n\t\t\tconst b = array[ i + 1 ];\n\t\t\tconst c = array[ i + 2 ];\n\n\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t}\n\n\t} else {\n\n\t\tconst array = geometryPosition.array;\n\n\t\tfor ( let i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\tconst a = i + 0;\n\t\t\tconst b = i + 1;\n\t\t\tconst c = i + 2;\n\n\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t}\n\n\t}\n\n\tconst attribute = new ( arrayNeedsUint32( indices ) ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\n\tattribute.version = getWireframeVersion( geometry );\n\n\treturn attribute;\n\n}\n\nclass Geometries extends DataMap {\n\n\tconstructor( attributes, info ) {\n\n\t\tsuper();\n\n\t\tthis.attributes = attributes;\n\t\tthis.info = info;\n\n\t\tthis.wireframes = new WeakMap();\n\n\t\tthis.attributeCall = new WeakMap();\n\n\t}\n\n\thas( renderObject ) {\n\n\t\tconst geometry = renderObject.geometry;\n\n\t\treturn super.has( geometry ) && this.get( geometry ).initialized === true;\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tif ( this.has( renderObject ) === false ) this.initGeometry( renderObject );\n\n\t\tthis.updateAttributes( renderObject );\n\n\t}\n\n\tinitGeometry( renderObject ) {\n\n\t\tconst geometry = renderObject.geometry;\n\t\tconst geometryData = this.get( geometry );\n\n\t\tgeometryData.initialized = true;\n\n\t\tthis.info.memory.geometries ++;\n\n\t\tconst onDispose = () => {\n\n\t\t\tthis.info.memory.geometries --;\n\n\t\t\tconst index = geometry.index;\n\t\t\tconst geometryAttributes = renderObject.getAttributes();\n\n\t\t\tif ( index !== null ) {\n\n\t\t\t\tthis.attributes.delete( index );\n\n\t\t\t}\n\n\t\t\tfor ( const geometryAttribute of geometryAttributes ) {\n\n\t\t\t\tthis.attributes.delete( geometryAttribute );\n\n\t\t\t}\n\n\t\t\tconst wireframeAttribute = this.wireframes.get( geometry );\n\n\t\t\tif ( wireframeAttribute !== undefined ) {\n\n\t\t\t\tthis.attributes.delete( wireframeAttribute );\n\n\t\t\t}\n\n\t\t\tgeometry.removeEventListener( 'dispose', onDispose );\n\n\t\t};\n\n\t\tgeometry.addEventListener( 'dispose', onDispose );\n\n\t}\n\n\tupdateAttributes( renderObject ) {\n\n\t\t// attributes\n\n\t\tconst attributes = renderObject.getAttributes();\n\n\t\tfor ( const attribute of attributes ) {\n\n\t\t\tif ( attribute.isStorageBufferAttribute || attribute.isStorageInstancedBufferAttribute ) {\n\n\t\t\t\tthis.updateAttribute( attribute, AttributeType.STORAGE );\n\n\t\t\t} else {\n\n\t\t\t\tthis.updateAttribute( attribute, AttributeType.VERTEX );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// indexes\n\n\t\tconst index = this.getIndex( renderObject );\n\n\t\tif ( index !== null ) {\n\n\t\t\tthis.updateAttribute( index, AttributeType.INDEX );\n\n\t\t}\n\n\t\t// indirect\n\n\t\tconst indirect = renderObject.geometry.indirect;\n\n\t\tif ( indirect !== null ) {\n\n\t\t\tthis.updateAttribute( indirect, AttributeType.INDIRECT );\n\n\t\t}\n\n\t}\n\n\tupdateAttribute( attribute, type ) {\n\n\t\tconst callId = this.info.render.calls;\n\n\t\tif ( ! attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( this.attributeCall.get( attribute ) !== callId ) {\n\n\t\t\t\tthis.attributes.update( attribute, type );\n\n\t\t\t\tthis.attributeCall.set( attribute, callId );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this.attributeCall.get( attribute ) === undefined ) {\n\n\t\t\t\tthis.attributes.update( attribute, type );\n\n\t\t\t\tthis.attributeCall.set( attribute, callId );\n\n\t\t\t} else if ( this.attributeCall.get( attribute.data ) !== callId ) {\n\n\t\t\t\tthis.attributes.update( attribute, type );\n\n\t\t\t\tthis.attributeCall.set( attribute.data, callId );\n\n\t\t\t\tthis.attributeCall.set( attribute, callId );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetIndirect( renderObject ) {\n\n\t\treturn renderObject.geometry.indirect;\n\n\t}\n\n\tgetIndex( renderObject ) {\n\n\t\tconst { geometry, material } = renderObject;\n\n\t\tlet index = geometry.index;\n\n\t\tif ( material.wireframe === true ) {\n\n\t\t\tconst wireframes = this.wireframes;\n\n\t\t\tlet wireframeAttribute = wireframes.get( geometry );\n\n\t\t\tif ( wireframeAttribute === undefined ) {\n\n\t\t\t\twireframeAttribute = getWireframeIndex( geometry );\n\n\t\t\t\twireframes.set( geometry, wireframeAttribute );\n\n\t\t\t} else if ( wireframeAttribute.version !== getWireframeVersion( geometry ) ) {\n\n\t\t\t\tthis.attributes.delete( wireframeAttribute );\n\n\t\t\t\twireframeAttribute = getWireframeIndex( geometry );\n\n\t\t\t\twireframes.set( geometry, wireframeAttribute );\n\n\t\t\t}\n\n\t\t\tindex = wireframeAttribute;\n\n\t\t}\n\n\t\treturn index;\n\n\t}\n\n}\n\nclass Info {\n\n\tconstructor() {\n\n\t\tthis.autoReset = true;\n\n\t\tthis.frame = 0;\n\t\tthis.calls = 0;\n\n\t\tthis.render = {\n\t\t\tcalls: 0,\n\t\t\tframeCalls: 0,\n\t\t\tdrawCalls: 0,\n\t\t\ttriangles: 0,\n\t\t\tpoints: 0,\n\t\t\tlines: 0,\n\t\t\ttimestamp: 0,\n\t\t\tpreviousFrameCalls: 0,\n\t\t\ttimestampCalls: 0\n\t\t};\n\n\t\tthis.compute = {\n\t\t\tcalls: 0,\n\t\t\tframeCalls: 0,\n\t\t\ttimestamp: 0,\n\t\t\tpreviousFrameCalls: 0,\n\t\t\ttimestampCalls: 0\n\t\t};\n\n\t\tthis.memory = {\n\t\t\tgeometries: 0,\n\t\t\ttextures: 0\n\t\t};\n\n\t}\n\n\tupdate( object, count, instanceCount ) {\n\n\t\tthis.render.drawCalls ++;\n\n\t\tif ( object.isMesh || object.isSprite ) {\n\n\t\t\tthis.render.triangles += instanceCount * ( count / 3 );\n\n\t\t} else if ( object.isPoints ) {\n\n\t\t\tthis.render.points += instanceCount * count;\n\n\t\t} else if ( object.isLineSegments ) {\n\n\t\t\tthis.render.lines += instanceCount * ( count / 2 );\n\n\t\t} else if ( object.isLine ) {\n\n\t\t\tthis.render.lines += instanceCount * ( count - 1 );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.WebGPUInfo: Unknown object type.' );\n\n\t\t}\n\n\t}\n\n\tupdateTimestamp( type, time ) {\n\n\t\tif ( this[ type ].timestampCalls === 0 ) {\n\n\t\t\tthis[ type ].timestamp = 0;\n\n\t\t}\n\n\n\t\tthis[ type ].timestamp += time;\n\n\t\tthis[ type ].timestampCalls ++;\n\n\n\t\tif ( this[ type ].timestampCalls >= this[ type ].previousFrameCalls ) {\n\n\t\t\tthis[ type ].timestampCalls = 0;\n\n\t\t}\n\n\n\t}\n\n\treset() {\n\n\t\tconst previousRenderFrameCalls = this.render.frameCalls;\n\t\tthis.render.previousFrameCalls = previousRenderFrameCalls;\n\n\t\tconst previousComputeFrameCalls = this.compute.frameCalls;\n\t\tthis.compute.previousFrameCalls = previousComputeFrameCalls;\n\n\n\t\tthis.render.drawCalls = 0;\n\t\tthis.render.frameCalls = 0;\n\t\tthis.compute.frameCalls = 0;\n\n\t\tthis.render.triangles = 0;\n\t\tthis.render.points = 0;\n\t\tthis.render.lines = 0;\n\n\n\t}\n\n\tdispose() {\n\n\t\tthis.reset();\n\n\t\tthis.calls = 0;\n\n\t\tthis.render.calls = 0;\n\t\tthis.compute.calls = 0;\n\n\t\tthis.render.timestamp = 0;\n\t\tthis.compute.timestamp = 0;\n\t\tthis.memory.geometries = 0;\n\t\tthis.memory.textures = 0;\n\n\t}\n\n}\n\nclass Pipeline {\n\n\tconstructor( cacheKey ) {\n\n\t\tthis.cacheKey = cacheKey;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nclass RenderPipeline extends Pipeline {\n\n\tconstructor( cacheKey, vertexProgram, fragmentProgram ) {\n\n\t\tsuper( cacheKey );\n\n\t\tthis.vertexProgram = vertexProgram;\n\t\tthis.fragmentProgram = fragmentProgram;\n\n\t}\n\n}\n\nclass ComputePipeline extends Pipeline {\n\n\tconstructor( cacheKey, computeProgram ) {\n\n\t\tsuper( cacheKey );\n\n\t\tthis.computeProgram = computeProgram;\n\n\t\tthis.isComputePipeline = true;\n\n\t}\n\n}\n\nlet _id$6 = 0;\n\nclass ProgrammableStage {\n\n\tconstructor( code, type, transforms = null, attributes = null ) {\n\n\t\tthis.id = _id$6 ++;\n\n\t\tthis.code = code;\n\t\tthis.stage = type;\n\t\tthis.transforms = transforms;\n\t\tthis.attributes = attributes;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nclass Pipelines extends DataMap {\n\n\tconstructor( backend, nodes ) {\n\n\t\tsuper();\n\n\t\tthis.backend = backend;\n\t\tthis.nodes = nodes;\n\n\t\tthis.bindings = null; // set by the bindings\n\n\t\tthis.caches = new Map();\n\t\tthis.programs = {\n\t\t\tvertex: new Map(),\n\t\t\tfragment: new Map(),\n\t\t\tcompute: new Map()\n\t\t};\n\n\t}\n\n\tgetForCompute( computeNode, bindings ) {\n\n\t\tconst { backend } = this;\n\n\t\tconst data = this.get( computeNode );\n\n\t\tif ( this._needsComputeUpdate( computeNode ) ) {\n\n\t\t\tconst previousPipeline = data.pipeline;\n\n\t\t\tif ( previousPipeline ) {\n\n\t\t\t\tpreviousPipeline.usedTimes --;\n\t\t\t\tpreviousPipeline.computeProgram.usedTimes --;\n\n\t\t\t}\n\n\t\t\t// get shader\n\n\t\t\tconst nodeBuilderState = this.nodes.getForCompute( computeNode );\n\n\t\t\t// programmable stage\n\n\t\t\tlet stageCompute = this.programs.compute.get( nodeBuilderState.computeShader );\n\n\t\t\tif ( stageCompute === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.computeProgram.usedTimes === 0 ) this._releaseProgram( previousPipeline.computeProgram );\n\n\t\t\t\tstageCompute = new ProgrammableStage( nodeBuilderState.computeShader, 'compute', nodeBuilderState.transforms, nodeBuilderState.nodeAttributes );\n\t\t\t\tthis.programs.compute.set( nodeBuilderState.computeShader, stageCompute );\n\n\t\t\t\tbackend.createProgram( stageCompute );\n\n\t\t\t}\n\n\t\t\t// determine compute pipeline\n\n\t\t\tconst cacheKey = this._getComputeCacheKey( computeNode, stageCompute );\n\n\t\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\t\tif ( pipeline === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.usedTimes === 0 ) this._releasePipeline( previousPipeline );\n\n\t\t\t\tpipeline = this._getComputePipeline( computeNode, stageCompute, cacheKey, bindings );\n\n\t\t\t}\n\n\t\t\t// keep track of all used times\n\n\t\t\tpipeline.usedTimes ++;\n\t\t\tstageCompute.usedTimes ++;\n\n\t\t\t//\n\n\t\t\tdata.version = computeNode.version;\n\t\t\tdata.pipeline = pipeline;\n\n\t\t}\n\n\t\treturn data.pipeline;\n\n\t}\n\n\tgetForRender( renderObject, promises = null ) {\n\n\t\tconst { backend } = this;\n\n\t\tconst data = this.get( renderObject );\n\n\t\tif ( this._needsRenderUpdate( renderObject ) ) {\n\n\t\t\tconst previousPipeline = data.pipeline;\n\n\t\t\tif ( previousPipeline ) {\n\n\t\t\t\tpreviousPipeline.usedTimes --;\n\t\t\t\tpreviousPipeline.vertexProgram.usedTimes --;\n\t\t\t\tpreviousPipeline.fragmentProgram.usedTimes --;\n\n\t\t\t}\n\n\t\t\t// get shader\n\n\t\t\tconst nodeBuilderState = renderObject.getNodeBuilderState();\n\n\t\t\t// programmable stages\n\n\t\t\tlet stageVertex = this.programs.vertex.get( nodeBuilderState.vertexShader );\n\n\t\t\tif ( stageVertex === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.vertexProgram.usedTimes === 0 ) this._releaseProgram( previousPipeline.vertexProgram );\n\n\t\t\t\tstageVertex = new ProgrammableStage( nodeBuilderState.vertexShader, 'vertex' );\n\t\t\t\tthis.programs.vertex.set( nodeBuilderState.vertexShader, stageVertex );\n\n\t\t\t\tbackend.createProgram( stageVertex );\n\n\t\t\t}\n\n\t\t\tlet stageFragment = this.programs.fragment.get( nodeBuilderState.fragmentShader );\n\n\t\t\tif ( stageFragment === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.fragmentProgram.usedTimes === 0 ) this._releaseProgram( previousPipeline.fragmentProgram );\n\n\t\t\t\tstageFragment = new ProgrammableStage( nodeBuilderState.fragmentShader, 'fragment' );\n\t\t\t\tthis.programs.fragment.set( nodeBuilderState.fragmentShader, stageFragment );\n\n\t\t\t\tbackend.createProgram( stageFragment );\n\n\t\t\t}\n\n\t\t\t// determine render pipeline\n\n\t\t\tconst cacheKey = this._getRenderCacheKey( renderObject, stageVertex, stageFragment );\n\n\t\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\t\tif ( pipeline === undefined ) {\n\n\t\t\t\tif ( previousPipeline && previousPipeline.usedTimes === 0 ) this._releasePipeline( previousPipeline );\n\n\t\t\t\tpipeline = this._getRenderPipeline( renderObject, stageVertex, stageFragment, cacheKey, promises );\n\n\t\t\t} else {\n\n\t\t\t\trenderObject.pipeline = pipeline;\n\n\t\t\t}\n\n\t\t\t// keep track of all used times\n\n\t\t\tpipeline.usedTimes ++;\n\t\t\tstageVertex.usedTimes ++;\n\t\t\tstageFragment.usedTimes ++;\n\n\t\t\t//\n\n\t\t\tdata.pipeline = pipeline;\n\n\t\t}\n\n\t\treturn data.pipeline;\n\n\t}\n\n\tdelete( object ) {\n\n\t\tconst pipeline = this.get( object ).pipeline;\n\n\t\tif ( pipeline ) {\n\n\t\t\t// pipeline\n\n\t\t\tpipeline.usedTimes --;\n\n\t\t\tif ( pipeline.usedTimes === 0 ) this._releasePipeline( pipeline );\n\n\t\t\t// programs\n\n\t\t\tif ( pipeline.isComputePipeline ) {\n\n\t\t\t\tpipeline.computeProgram.usedTimes --;\n\n\t\t\t\tif ( pipeline.computeProgram.usedTimes === 0 ) this._releaseProgram( pipeline.computeProgram );\n\n\t\t\t} else {\n\n\t\t\t\tpipeline.fragmentProgram.usedTimes --;\n\t\t\t\tpipeline.vertexProgram.usedTimes --;\n\n\t\t\t\tif ( pipeline.vertexProgram.usedTimes === 0 ) this._releaseProgram( pipeline.vertexProgram );\n\t\t\t\tif ( pipeline.fragmentProgram.usedTimes === 0 ) this._releaseProgram( pipeline.fragmentProgram );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.delete( object );\n\n\t}\n\n\tdispose() {\n\n\t\tsuper.dispose();\n\n\t\tthis.caches = new Map();\n\t\tthis.programs = {\n\t\t\tvertex: new Map(),\n\t\t\tfragment: new Map(),\n\t\t\tcompute: new Map()\n\t\t};\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tthis.getForRender( renderObject );\n\n\t}\n\n\t_getComputePipeline( computeNode, stageCompute, cacheKey, bindings ) {\n\n\t\t// check for existing pipeline\n\n\t\tcacheKey = cacheKey || this._getComputeCacheKey( computeNode, stageCompute );\n\n\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = new ComputePipeline( cacheKey, stageCompute );\n\n\t\t\tthis.caches.set( cacheKey, pipeline );\n\n\t\t\tthis.backend.createComputePipeline( pipeline, bindings );\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\t_getRenderPipeline( renderObject, stageVertex, stageFragment, cacheKey, promises ) {\n\n\t\t// check for existing pipeline\n\n\t\tcacheKey = cacheKey || this._getRenderCacheKey( renderObject, stageVertex, stageFragment );\n\n\t\tlet pipeline = this.caches.get( cacheKey );\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = new RenderPipeline( cacheKey, stageVertex, stageFragment );\n\n\t\t\tthis.caches.set( cacheKey, pipeline );\n\n\t\t\trenderObject.pipeline = pipeline;\n\n\t\t\tthis.backend.createRenderPipeline( renderObject, promises );\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\t_getComputeCacheKey( computeNode, stageCompute ) {\n\n\t\treturn computeNode.id + ',' + stageCompute.id;\n\n\t}\n\n\t_getRenderCacheKey( renderObject, stageVertex, stageFragment ) {\n\n\t\treturn stageVertex.id + ',' + stageFragment.id + ',' + this.backend.getRenderCacheKey( renderObject );\n\n\t}\n\n\t_releasePipeline( pipeline ) {\n\n\t\tthis.caches.delete( pipeline.cacheKey );\n\n\t}\n\n\t_releaseProgram( program ) {\n\n\t\tconst code = program.code;\n\t\tconst stage = program.stage;\n\n\t\tthis.programs[ stage ].delete( code );\n\n\t}\n\n\t_needsComputeUpdate( computeNode ) {\n\n\t\tconst data = this.get( computeNode );\n\n\t\treturn data.pipeline === undefined || data.version !== computeNode.version;\n\n\t}\n\n\t_needsRenderUpdate( renderObject ) {\n\n\t\tconst data = this.get( renderObject );\n\n\t\treturn data.pipeline === undefined || this.backend.needsRenderUpdate( renderObject );\n\n\t}\n\n}\n\nclass Bindings extends DataMap {\n\n\tconstructor( backend, nodes, textures, attributes, pipelines, info ) {\n\n\t\tsuper();\n\n\t\tthis.backend = backend;\n\t\tthis.textures = textures;\n\t\tthis.pipelines = pipelines;\n\t\tthis.attributes = attributes;\n\t\tthis.nodes = nodes;\n\t\tthis.info = info;\n\n\t\tthis.pipelines.bindings = this; // assign bindings to pipelines\n\n\t}\n\n\tgetForRender( renderObject ) {\n\n\t\tconst bindings = renderObject.getBindings();\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tconst groupData = this.get( bindGroup );\n\n\t\t\tif ( groupData.bindGroup === undefined ) {\n\n\t\t\t\t// each object defines an array of bindings (ubos, textures, samplers etc.)\n\n\t\t\t\tthis._init( bindGroup );\n\n\t\t\t\tthis.backend.createBindings( bindGroup, bindings );\n\n\t\t\t\tgroupData.bindGroup = bindGroup;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindings;\n\n\t}\n\n\tgetForCompute( computeNode ) {\n\n\t\tconst bindings = this.nodes.getForCompute( computeNode ).bindings;\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tconst groupData = this.get( bindGroup );\n\n\t\t\tif ( groupData.bindGroup === undefined ) {\n\n\t\t\t\tthis._init( bindGroup );\n\n\t\t\t\tthis.backend.createBindings( bindGroup, bindings );\n\n\t\t\t\tgroupData.bindGroup = bindGroup;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindings;\n\n\t}\n\n\tupdateForCompute( computeNode ) {\n\n\t\tthis._updateBindings( this.getForCompute( computeNode ) );\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tthis._updateBindings( this.getForRender( renderObject ) );\n\n\t}\n\n\t_updateBindings( bindings ) {\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tthis._update( bindGroup, bindings );\n\n\t\t}\n\n\t}\n\n\t_init( bindGroup ) {\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isSampledTexture ) {\n\n\t\t\t\tthis.textures.updateTexture( binding.texture );\n\n\t\t\t} else if ( binding.isStorageBuffer ) {\n\n\t\t\t\tconst attribute = binding.attribute;\n\t\t\t\tconst attributeType = attribute.isIndirectStorageBufferAttribute ? AttributeType.INDIRECT : AttributeType.STORAGE;\n\n\t\t\t\tthis.attributes.update( attribute, attributeType );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_update( bindGroup, bindings ) {\n\n\t\tconst { backend } = this;\n\n\t\tlet needsBindingsUpdate = false;\n\n\t\t// iterate over all bindings and check if buffer updates or a new binding group is required\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isNodeUniformsGroup ) {\n\n\t\t\t\tconst updated = this.nodes.updateGroup( binding );\n\n\t\t\t\tif ( ! updated ) continue;\n\n\t\t\t}\n\n\t\t\tif ( binding.isUniformBuffer ) {\n\n\t\t\t\tconst updated = binding.update();\n\n\t\t\t\tif ( updated ) {\n\n\t\t\t\t\tbackend.updateBinding( binding );\n\n\t\t\t\t}\n\n\t\t\t} else if ( binding.isSampler ) {\n\n\t\t\t\tbinding.update();\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tif ( binding.needsBindingsUpdate( this.textures.get( binding.texture ).generation ) ) needsBindingsUpdate = true;\n\n\t\t\t\tconst updated = binding.update();\n\n\t\t\t\tconst texture = binding.texture;\n\n\t\t\t\tif ( updated ) {\n\n\t\t\t\t\tthis.textures.updateTexture( texture );\n\n\t\t\t\t}\n\n\t\t\t\tconst textureData = backend.get( texture );\n\n\t\t\t\tif ( backend.isWebGPUBackend === true && textureData.texture === undefined && textureData.externalTexture === undefined ) {\n\n\t\t\t\t\t// TODO: Remove this once we found why updated === false isn't bound to a texture in the WebGPU backend\n\t\t\t\t\tconsole.error( 'Bindings._update: binding should be available:', binding, updated, texture, binding.textureNode.value, needsBindingsUpdate );\n\n\t\t\t\t\tthis.textures.updateTexture( texture );\n\t\t\t\t\tneedsBindingsUpdate = true;\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.isStorageTexture === true ) {\n\n\t\t\t\t\tconst textureData = this.get( texture );\n\n\t\t\t\t\tif ( binding.store === true ) {\n\n\t\t\t\t\t\ttextureData.needsMipmap = true;\n\n\t\t\t\t\t} else if ( this.textures.needsMipmaps( texture ) && textureData.needsMipmap === true ) {\n\n\t\t\t\t\t\tthis.backend.generateMipmaps( texture );\n\n\t\t\t\t\t\ttextureData.needsMipmap = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( needsBindingsUpdate === true ) {\n\n\t\t\tthis.backend.updateBindings( bindGroup, bindings );\n\n\t\t}\n\n\t}\n\n}\n\nfunction painterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.material.id !== b.material.id ) {\n\n\t\treturn a.material.id - b.material.id;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn a.z - b.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction reversePainterSortStable( a, b ) {\n\n\tif ( a.groupOrder !== b.groupOrder ) {\n\n\t\treturn a.groupOrder - b.groupOrder;\n\n\t} else if ( a.renderOrder !== b.renderOrder ) {\n\n\t\treturn a.renderOrder - b.renderOrder;\n\n\t} else if ( a.z !== b.z ) {\n\n\t\treturn b.z - a.z;\n\n\t} else {\n\n\t\treturn a.id - b.id;\n\n\t}\n\n}\n\nfunction needsDoublePass( material ) {\n\n\tconst hasTransmission = material.transmission > 0 || material.transmissionNode;\n\n\treturn hasTransmission && material.side === DoubleSide && material.forceSinglePass === false;\n\n}\n\nclass RenderList {\n\n\tconstructor( lighting, scene, camera ) {\n\n\t\tthis.renderItems = [];\n\t\tthis.renderItemsIndex = 0;\n\n\t\tthis.opaque = [];\n\t\tthis.transparentDoublePass = [];\n\t\tthis.transparent = [];\n\t\tthis.bundles = [];\n\n\t\tthis.lightsNode = lighting.getNode( scene, camera );\n\t\tthis.lightsArray = [];\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t\tthis.occlusionQueryCount = 0;\n\n\t}\n\n\tbegin() {\n\n\t\tthis.renderItemsIndex = 0;\n\n\t\tthis.opaque.length = 0;\n\t\tthis.transparentDoublePass.length = 0;\n\t\tthis.transparent.length = 0;\n\t\tthis.bundles.length = 0;\n\n\t\tthis.lightsArray.length = 0;\n\n\t\tthis.occlusionQueryCount = 0;\n\n\t\treturn this;\n\n\t}\n\n\tgetNextRenderItem( object, geometry, material, groupOrder, z, group ) {\n\n\t\tlet renderItem = this.renderItems[ this.renderItemsIndex ];\n\n\t\tif ( renderItem === undefined ) {\n\n\t\t\trenderItem = {\n\t\t\t\tid: object.id,\n\t\t\t\tobject: object,\n\t\t\t\tgeometry: geometry,\n\t\t\t\tmaterial: material,\n\t\t\t\tgroupOrder: groupOrder,\n\t\t\t\trenderOrder: object.renderOrder,\n\t\t\t\tz: z,\n\t\t\t\tgroup: group\n\t\t\t};\n\n\t\t\tthis.renderItems[ this.renderItemsIndex ] = renderItem;\n\n\t\t} else {\n\n\t\t\trenderItem.id = object.id;\n\t\t\trenderItem.object = object;\n\t\t\trenderItem.geometry = geometry;\n\t\t\trenderItem.material = material;\n\t\t\trenderItem.groupOrder = groupOrder;\n\t\t\trenderItem.renderOrder = object.renderOrder;\n\t\t\trenderItem.z = z;\n\t\t\trenderItem.group = group;\n\n\t\t}\n\n\t\tthis.renderItemsIndex ++;\n\n\t\treturn renderItem;\n\n\t}\n\n\tpush( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = this.getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( object.occlusionTest === true ) this.occlusionQueryCount ++;\n\n\t\tif ( material.transparent === true || material.transmission > 0 ) {\n\n\t\t\tif ( needsDoublePass( material ) ) this.transparentDoublePass.push( renderItem );\n\n\t\t\tthis.transparent.push( renderItem );\n\n\t\t} else {\n\n\t\t\tthis.opaque.push( renderItem );\n\n\t\t}\n\n\t}\n\n\tunshift( object, geometry, material, groupOrder, z, group ) {\n\n\t\tconst renderItem = this.getNextRenderItem( object, geometry, material, groupOrder, z, group );\n\n\t\tif ( material.transparent === true || material.transmission > 0 ) {\n\n\t\t\tif ( needsDoublePass( material ) ) this.transparentDoublePass.unshift( renderItem );\n\n\t\t\tthis.transparent.unshift( renderItem );\n\n\t\t} else {\n\n\t\t\tthis.opaque.unshift( renderItem );\n\n\t\t}\n\n\t}\n\n\tpushBundle( group ) {\n\n\t\tthis.bundles.push( group );\n\n\t}\n\n\tpushLight( light ) {\n\n\t\tthis.lightsArray.push( light );\n\n\t}\n\n\tsort( customOpaqueSort, customTransparentSort ) {\n\n\t\tif ( this.opaque.length > 1 ) this.opaque.sort( customOpaqueSort || painterSortStable );\n\t\tif ( this.transparentDoublePass.length > 1 ) this.transparentDoublePass.sort( customTransparentSort || reversePainterSortStable );\n\t\tif ( this.transparent.length > 1 ) this.transparent.sort( customTransparentSort || reversePainterSortStable );\n\n\t}\n\n\tfinish() {\n\n\t\t// update lights\n\n\t\tthis.lightsNode.setLights( this.lightsArray );\n\n\t\t// Clear references from inactive renderItems in the list\n\n\t\tfor ( let i = this.renderItemsIndex, il = this.renderItems.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = this.renderItems[ i ];\n\n\t\t\tif ( renderItem.id === null ) break;\n\n\t\t\trenderItem.id = null;\n\t\t\trenderItem.object = null;\n\t\t\trenderItem.geometry = null;\n\t\t\trenderItem.material = null;\n\t\t\trenderItem.groupOrder = null;\n\t\t\trenderItem.renderOrder = null;\n\t\t\trenderItem.z = null;\n\t\t\trenderItem.group = null;\n\n\t\t}\n\n\t}\n\n}\n\nclass RenderLists {\n\n\tconstructor( lighting ) {\n\n\t\tthis.lighting = lighting;\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n\tget( scene, camera ) {\n\n\t\tconst lists = this.lists;\n\t\tconst keys = [ scene, camera ];\n\n\t\tlet list = lists.get( keys );\n\n\t\tif ( list === undefined ) {\n\n\t\t\tlist = new RenderList( this.lighting, scene, camera );\n\t\t\tlists.set( keys, list );\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n}\n\nlet id$1 = 0;\n\nclass RenderContext {\n\n\tconstructor() {\n\n\t\tthis.id = id$1 ++;\n\n\t\tthis.color = true;\n\t\tthis.clearColor = true;\n\t\tthis.clearColorValue = { r: 0, g: 0, b: 0, a: 1 };\n\n\t\tthis.depth = true;\n\t\tthis.clearDepth = true;\n\t\tthis.clearDepthValue = 1;\n\n\t\tthis.stencil = false;\n\t\tthis.clearStencil = true;\n\t\tthis.clearStencilValue = 1;\n\n\t\tthis.viewport = false;\n\t\tthis.viewportValue = new Vector4();\n\n\t\tthis.scissor = false;\n\t\tthis.scissorValue = new Vector4();\n\n\t\tthis.textures = null;\n\t\tthis.depthTexture = null;\n\t\tthis.activeCubeFace = 0;\n\t\tthis.sampleCount = 1;\n\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\n\t\tthis.isRenderContext = true;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn getCacheKey( this );\n\n\t}\n\n}\n\nfunction getCacheKey( renderContext ) {\n\n\tconst { textures, activeCubeFace } = renderContext;\n\n\tconst values = [ activeCubeFace ];\n\n\tfor ( const texture of textures ) {\n\n\t\tvalues.push( texture.id );\n\n\t}\n\n\treturn hashArray( values );\n\n}\n\nclass RenderContexts {\n\n\tconstructor() {\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n\tget( scene, camera, renderTarget = null ) {\n\n\t\tconst chainKey = [ scene, camera ];\n\n\t\tlet attachmentState;\n\n\t\tif ( renderTarget === null ) {\n\n\t\t\tattachmentState = 'default';\n\n\t\t} else {\n\n\t\t\tconst format = renderTarget.texture.format;\n\t\t\tconst count = renderTarget.textures.length;\n\n\t\t\tattachmentState = `${ count }:${ format }:${ renderTarget.samples }:${ renderTarget.depthBuffer }:${ renderTarget.stencilBuffer }`;\n\n\t\t}\n\n\t\tconst chainMap = this.getChainMap( attachmentState );\n\n\t\tlet renderState = chainMap.get( chainKey );\n\n\t\tif ( renderState === undefined ) {\n\n\t\t\trenderState = new RenderContext();\n\n\t\t\tchainMap.set( chainKey, renderState );\n\n\t\t}\n\n\t\tif ( renderTarget !== null ) renderState.sampleCount = renderTarget.samples === 0 ? 1 : renderTarget.samples;\n\n\t\treturn renderState;\n\n\t}\n\n\tgetChainMap( attachmentState ) {\n\n\t\treturn this.chainMaps[ attachmentState ] || ( this.chainMaps[ attachmentState ] = new ChainMap() );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.chainMaps = {};\n\n\t}\n\n}\n\nconst _size$3 = /*@__PURE__*/ new Vector3();\n\nclass Textures extends DataMap {\n\n\tconstructor( renderer, backend, info ) {\n\n\t\tsuper();\n\n\t\tthis.renderer = renderer;\n\t\tthis.backend = backend;\n\t\tthis.info = info;\n\n\t}\n\n\tupdateRenderTarget( renderTarget, activeMipmapLevel = 0 ) {\n\n\t\tconst renderTargetData = this.get( renderTarget );\n\n\t\tconst sampleCount = renderTarget.samples === 0 ? 1 : renderTarget.samples;\n\t\tconst depthTextureMips = renderTargetData.depthTextureMips || ( renderTargetData.depthTextureMips = {} );\n\n\t\tconst textures = renderTarget.textures;\n\n\t\tconst size = this.getSize( textures[ 0 ] );\n\n\t\tconst mipWidth = size.width >> activeMipmapLevel;\n\t\tconst mipHeight = size.height >> activeMipmapLevel;\n\n\t\tlet depthTexture = renderTarget.depthTexture || depthTextureMips[ activeMipmapLevel ];\n\t\tconst useDepthTexture = renderTarget.depthBuffer === true || renderTarget.stencilBuffer === true;\n\n\t\tlet textureNeedsUpdate = false;\n\n\t\tif ( depthTexture === undefined && useDepthTexture ) {\n\n\t\t\tdepthTexture = new DepthTexture();\n\t\t\tdepthTexture.format = renderTarget.stencilBuffer ? DepthStencilFormat : DepthFormat;\n\t\t\tdepthTexture.type = renderTarget.stencilBuffer ? UnsignedInt248Type : UnsignedIntType; // FloatType\n\t\t\tdepthTexture.image.width = mipWidth;\n\t\t\tdepthTexture.image.height = mipHeight;\n\n\t\t\tdepthTextureMips[ activeMipmapLevel ] = depthTexture;\n\n\t\t}\n\n\t\tif ( renderTargetData.width !== size.width || size.height !== renderTargetData.height ) {\n\n\t\t\ttextureNeedsUpdate = true;\n\n\t\t\tif ( depthTexture ) {\n\n\t\t\t\tdepthTexture.needsUpdate = true;\n\t\t\t\tdepthTexture.image.width = mipWidth;\n\t\t\t\tdepthTexture.image.height = mipHeight;\n\n\t\t\t}\n\n\t\t}\n\n\t\trenderTargetData.width = size.width;\n\t\trenderTargetData.height = size.height;\n\t\trenderTargetData.textures = textures;\n\t\trenderTargetData.depthTexture = depthTexture || null;\n\t\trenderTargetData.depth = renderTarget.depthBuffer;\n\t\trenderTargetData.stencil = renderTarget.stencilBuffer;\n\t\trenderTargetData.renderTarget = renderTarget;\n\n\t\tif ( renderTargetData.sampleCount !== sampleCount ) {\n\n\t\t\ttextureNeedsUpdate = true;\n\n\t\t\tif ( depthTexture ) {\n\n\t\t\t\tdepthTexture.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\trenderTargetData.sampleCount = sampleCount;\n\n\t\t}\n\n\t\t//\n\n\t\tconst options = { sampleCount };\n\n\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\tconst texture = textures[ i ];\n\n\t\t\tif ( textureNeedsUpdate ) texture.needsUpdate = true;\n\n\t\t\tthis.updateTexture( texture, options );\n\n\t\t}\n\n\t\tif ( depthTexture ) {\n\n\t\t\tthis.updateTexture( depthTexture, options );\n\n\t\t}\n\n\t\t// dispose handler\n\n\t\tif ( renderTargetData.initialized !== true ) {\n\n\t\t\trenderTargetData.initialized = true;\n\n\t\t\t// dispose\n\n\t\t\tconst onDispose = () => {\n\n\t\t\t\trenderTarget.removeEventListener( 'dispose', onDispose );\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\tthis._destroyTexture( textures[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( depthTexture ) {\n\n\t\t\t\t\tthis._destroyTexture( depthTexture );\n\n\t\t\t\t}\n\n\t\t\t\tthis.delete( renderTarget );\n\n\t\t\t};\n\n\t\t\trenderTarget.addEventListener( 'dispose', onDispose );\n\n\t\t}\n\n\t}\n\n\tupdateTexture( texture, options = {} ) {\n\n\t\tconst textureData = this.get( texture );\n\t\tif ( textureData.initialized === true && textureData.version === texture.version ) return;\n\n\t\tconst isRenderTarget = texture.isRenderTargetTexture || texture.isDepthTexture || texture.isFramebufferTexture;\n\t\tconst backend = this.backend;\n\n\t\tif ( isRenderTarget && textureData.initialized === true ) {\n\n\t\t\t// it's an update\n\n\t\t\tbackend.destroySampler( texture );\n\t\t\tbackend.destroyTexture( texture );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( texture.isFramebufferTexture ) {\n\n\t\t\tconst renderTarget = this.renderer.getRenderTarget();\n\n\t\t\tif ( renderTarget ) {\n\n\t\t\t\ttexture.type = renderTarget.texture.type;\n\n\t\t\t} else {\n\n\t\t\t\ttexture.type = UnsignedByteType;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst { width, height, depth } = this.getSize( texture );\n\n\t\toptions.width = width;\n\t\toptions.height = height;\n\t\toptions.depth = depth;\n\t\toptions.needsMipmaps = this.needsMipmaps( texture );\n\t\toptions.levels = options.needsMipmaps ? this.getMipLevels( texture, width, height ) : 1;\n\n\t\t//\n\n\t\tif ( isRenderTarget || texture.isStorageTexture === true ) {\n\n\t\t\tbackend.createSampler( texture );\n\t\t\tbackend.createTexture( texture, options );\n\n\t\t\ttextureData.generation = texture.version;\n\n\t\t} else {\n\n\t\t\tconst needsCreate = textureData.initialized !== true;\n\n\t\t\tif ( needsCreate ) backend.createSampler( texture );\n\n\t\t\tif ( texture.version > 0 ) {\n\n\t\t\t\tconst image = texture.image;\n\n\t\t\t\tif ( image === undefined ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.Renderer: Texture marked for update but image is undefined.' );\n\n\t\t\t\t} else if ( image.complete === false ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.Renderer: Texture marked for update but image is incomplete.' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( texture.images ) {\n\n\t\t\t\t\t\tconst images = [];\n\n\t\t\t\t\t\tfor ( const image of texture.images ) {\n\n\t\t\t\t\t\t\timages.push( image );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\toptions.images = images;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\toptions.image = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( textureData.isDefaultTexture === undefined || textureData.isDefaultTexture === true ) {\n\n\t\t\t\t\t\tbackend.createTexture( texture, options );\n\n\t\t\t\t\t\ttextureData.isDefaultTexture = false;\n\t\t\t\t\t\ttextureData.generation = texture.version;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( texture.source.dataReady === true ) backend.updateTexture( texture, options );\n\n\t\t\t\t\tif ( options.needsMipmaps && texture.mipmaps.length === 0 ) backend.generateMipmaps( texture );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// async update\n\n\t\t\t\tbackend.createDefaultTexture( texture );\n\n\t\t\t\ttextureData.isDefaultTexture = true;\n\t\t\t\ttextureData.generation = texture.version;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// dispose handler\n\n\t\tif ( textureData.initialized !== true ) {\n\n\t\t\ttextureData.initialized = true;\n\t\t\ttextureData.generation = texture.version;\n\n\t\t\t//\n\n\t\t\tthis.info.memory.textures ++;\n\n\t\t\t// dispose\n\n\t\t\tconst onDispose = () => {\n\n\t\t\t\ttexture.removeEventListener( 'dispose', onDispose );\n\n\t\t\t\tthis._destroyTexture( texture );\n\n\t\t\t\tthis.info.memory.textures --;\n\n\t\t\t};\n\n\t\t\ttexture.addEventListener( 'dispose', onDispose );\n\n\t\t}\n\n\t\t//\n\n\t\ttextureData.version = texture.version;\n\n\t}\n\n\tgetSize( texture, target = _size$3 ) {\n\n\t\tlet image = texture.images ? texture.images[ 0 ] : texture.image;\n\n\t\tif ( image ) {\n\n\t\t\tif ( image.image !== undefined ) image = image.image;\n\n\t\t\ttarget.width = image.width;\n\t\t\ttarget.height = image.height;\n\t\t\ttarget.depth = texture.isCubeTexture ? 6 : ( image.depth || 1 );\n\n\t\t} else {\n\n\t\t\ttarget.width = target.height = target.depth = 1;\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetMipLevels( texture, width, height ) {\n\n\t\tlet mipLevelCount;\n\n\t\tif ( texture.isCompressedTexture ) {\n\n\t\t\tmipLevelCount = texture.mipmaps.length;\n\n\t\t} else {\n\n\t\t\tmipLevelCount = Math.floor( Math.log2( Math.max( width, height ) ) ) + 1;\n\n\t\t}\n\n\t\treturn mipLevelCount;\n\n\t}\n\n\tneedsMipmaps( texture ) {\n\n\t\treturn this.isEnvironmentTexture( texture ) || texture.isCompressedTexture === true || texture.generateMipmaps;\n\n\t}\n\n\tisEnvironmentTexture( texture ) {\n\n\t\tconst mapping = texture.mapping;\n\n\t\treturn ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) || ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t}\n\n\t_destroyTexture( texture ) {\n\n\t\tthis.backend.destroySampler( texture );\n\t\tthis.backend.destroyTexture( texture );\n\n\t\tthis.delete( texture );\n\n\t}\n\n}\n\nclass Color4 extends Color {\n\n\tconstructor( r, g, b, a = 1 ) {\n\n\t\tsuper( r, g, b );\n\n\t\tthis.a = a;\n\n\t}\n\n\tset( r, g, b, a = 1 ) {\n\n\t\tthis.a = a;\n\n\t\treturn super.set( r, g, b );\n\n\t}\n\n\tcopy( color ) {\n\n\t\tif ( color.a !== undefined ) this.a = color.a;\n\n\t\treturn super.copy( color );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.r, this.g, this.b, this.a );\n\n\t}\n\n}\n\nclass ParameterNode extends PropertyNode {\n\n\tstatic get type() {\n\n\t\treturn 'ParameterNode';\n\n\t}\n\n\tconstructor( nodeType, name = null ) {\n\n\t\tsuper( nodeType, name );\n\n\t\tthis.isParameterNode = true;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgenerate() {\n\n\t\treturn this.name;\n\n\t}\n\n}\n\nconst parameter = ( type, name ) => nodeObject( new ParameterNode( type, name ) );\n\nclass StackNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'StackNode';\n\n\t}\n\n\tconstructor( parent = null ) {\n\n\t\tsuper();\n\n\t\tthis.nodes = [];\n\t\tthis.outputNode = null;\n\n\t\tthis.parent = parent;\n\n\t\tthis._currentCond = null;\n\n\t\tthis.isStackNode = true;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.outputNode ? this.outputNode.getNodeType( builder ) : 'void';\n\n\t}\n\n\tadd( node ) {\n\n\t\tthis.nodes.push( node );\n\n\t\treturn this;\n\n\t}\n\n\tIf( boolNode, method ) {\n\n\t\tconst methodNode = new ShaderNode( method );\n\t\tthis._currentCond = select( boolNode, methodNode );\n\n\t\treturn this.add( this._currentCond );\n\n\t}\n\n\tElseIf( boolNode, method ) {\n\n\t\tconst methodNode = new ShaderNode( method );\n\t\tconst ifNode = select( boolNode, methodNode );\n\n\t\tthis._currentCond.elseNode = ifNode;\n\t\tthis._currentCond = ifNode;\n\n\t\treturn this;\n\n\t}\n\n\tElse( method ) {\n\n\t\tthis._currentCond.elseNode = new ShaderNode( method );\n\n\t\treturn this;\n\n\t}\n\n\tbuild( builder, ...params ) {\n\n\t\tconst previousStack = getCurrentStack();\n\n\t\tsetCurrentStack( this );\n\n\t\tfor ( const node of this.nodes ) {\n\n\t\t\tnode.build( builder, 'void' );\n\n\t\t}\n\n\t\tsetCurrentStack( previousStack );\n\n\t\treturn this.outputNode ? this.outputNode.build( builder, ...params ) : super.build( builder, ...params );\n\n\t}\n\n\t//\n\n\telse( ...params ) { // @deprecated, r168\n\n\t\tconsole.warn( 'TSL.StackNode: .else() has been renamed to .Else().' );\n\t\treturn this.Else( ...params );\n\n\t}\n\n\telseif( ...params ) { // @deprecated, r168\n\n\t\tconsole.warn( 'TSL.StackNode: .elseif() has been renamed to .ElseIf().' );\n\t\treturn this.ElseIf( ...params );\n\n\t}\n\n}\n\nconst stack = /*@__PURE__*/ nodeProxy( StackNode );\n\nclass StructTypeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'StructTypeNode';\n\n\t}\n\n\tconstructor( types ) {\n\n\t\tsuper();\n\n\t\tthis.types = types;\n\t\tthis.isStructTypeNode = true;\n\n\t}\n\n\tgetMemberTypes() {\n\n\t\treturn this.types;\n\n\t}\n\n}\n\nclass OutputStructNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'OutputStructNode';\n\n\t}\n\n\tconstructor( ...members ) {\n\n\t\tsuper();\n\n\t\tthis.members = members;\n\n\t\tthis.isOutputStructNode = true;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst members = this.members;\n\t\tconst types = [];\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\ttypes.push( members[ i ].getNodeType( builder ) );\n\n\t\t}\n\n\t\tthis.nodeType = builder.getStructTypeFromNode( new StructTypeNode( types ) ).name;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst propertyName = builder.getOutputStructName();\n\t\tconst members = this.members;\n\n\t\tconst structPrefix = propertyName !== '' ? propertyName + '.' : '';\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst snippet = members[ i ].build( builder, output );\n\n\t\t\tbuilder.addLineFlowCode( `${ structPrefix }m${ i } = ${ snippet }`, this );\n\n\t\t}\n\n\t\treturn propertyName;\n\n\t}\n\n}\n\nconst outputStruct = /*@__PURE__*/ nodeProxy( OutputStructNode );\n\nfunction getTextureIndex( textures, name ) {\n\n\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\tif ( textures[ i ].name === name ) {\n\n\t\t\treturn i;\n\n\t\t}\n\n\t}\n\n\treturn - 1;\n\n}\n\nclass MRTNode extends OutputStructNode {\n\n\tstatic get type() {\n\n\t\treturn 'MRTNode';\n\n\t}\n\n\tconstructor( outputNodes ) {\n\n\t\tsuper();\n\n\t\tthis.outputNodes = outputNodes;\n\n\t\tthis.isMRTNode = true;\n\n\t}\n\n\thas( name ) {\n\n\t\treturn this.outputNodes[ name ] !== undefined;\n\n\t}\n\n\tget( name ) {\n\n\t\treturn this.outputNodes[ name ];\n\n\t}\n\n\tmerge( mrtNode ) {\n\n\t\tconst outputs = { ...this.outputNodes, ...mrtNode.outputNodes };\n\n\t\treturn mrt( outputs );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst outputNodes = this.outputNodes;\n\t\tconst mrt = builder.renderer.getRenderTarget();\n\n\t\tconst members = [];\n\n\t\tconst textures = mrt.textures;\n\n\t\tfor ( const name in outputNodes ) {\n\n\t\t\tconst index = getTextureIndex( textures, name );\n\n\t\t\tmembers[ index ] = vec4( outputNodes[ name ] );\n\n\t\t}\n\n\t\tthis.members = members;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n}\n\nconst mrt = /*@__PURE__*/ nodeProxy( MRTNode );\n\nconst hash = /*@__PURE__*/ Fn( ( [ seed ] ) => {\n\n\t// Taken from https://www.shadertoy.com/view/XlGcRh, originally from pcg-random.org\n\n\tconst state = seed.toUint().mul( 747796405 ).add( 2891336453 );\n\tconst word = state.shiftRight( state.shiftRight( 28 ).add( 4 ) ).bitXor( state ).mul( 277803737 );\n\tconst result = word.shiftRight( 22 ).bitXor( word );\n\n\treturn result.toFloat().mul( 1 / 2 ** 32 ); // Convert to range [0, 1)\n\n} );\n\n// remapping functions https://iquilezles.org/articles/functions/\nconst parabola = ( x, k ) => pow( mul( 4.0, x.mul( sub( 1.0, x ) ) ), k );\nconst gain = ( x, k ) => x.lessThan( 0.5 ) ? parabola( x.mul( 2.0 ), k ).div( 2.0 ) : sub( 1.0, parabola( mul( sub( 1.0, x ), 2.0 ), k ).div( 2.0 ) );\nconst pcurve = ( x, a, b ) => pow( div( pow( x, a ), add( pow( x, a ), pow( sub( 1.0, x ), b ) ) ), 1.0 / a );\nconst sinc = ( x, k ) => sin( PI.mul( k.mul( x ).sub( 1.0 ) ) ).div( PI.mul( k.mul( x ).sub( 1.0 ) ) );\n\n// https://github.com/cabbibo/glsl-tri-noise-3d\n\n\nconst tri = /*@__PURE__*/ Fn( ( [ x ] ) => {\n\n\treturn x.fract().sub( .5 ).abs();\n\n} ).setLayout( {\n\tname: 'tri',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'x', type: 'float' }\n\t]\n} );\n\nconst tri3 = /*@__PURE__*/ Fn( ( [ p ] ) => {\n\n\treturn vec3( tri( p.z.add( tri( p.y.mul( 1. ) ) ) ), tri( p.z.add( tri( p.x.mul( 1. ) ) ) ), tri( p.y.add( tri( p.x.mul( 1. ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'tri3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst triNoise3D = /*@__PURE__*/ Fn( ( [ p_immutable, spd, time ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst z = float( 1.4 ).toVar();\n\tconst rz = float( 0.0 ).toVar();\n\tconst bp = vec3( p ).toVar();\n\n\tLoop( { start: float( 0.0 ), end: float( 3.0 ), type: 'float', condition: '<=' }, () => {\n\n\t\tconst dg = vec3( tri3( bp.mul( 2.0 ) ) ).toVar();\n\t\tp.addAssign( dg.add( time.mul( float( 0.1 ).mul( spd ) ) ) );\n\t\tbp.mulAssign( 1.8 );\n\t\tz.mulAssign( 1.5 );\n\t\tp.mulAssign( 1.2 );\n\n\t\tconst t = float( tri( p.z.add( tri( p.x.add( tri( p.y ) ) ) ) ) ).toVar();\n\t\trz.addAssign( t.div( z ) );\n\t\tbp.addAssign( 0.14 );\n\n\t} );\n\n\treturn rz;\n\n} ).setLayout( {\n\tname: 'triNoise3D',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'spd', type: 'float' },\n\t\t{ name: 'time', type: 'float' }\n\t]\n} );\n\nclass FunctionOverloadingNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'FunctionOverloadingNode';\n\n\t}\n\n\tconstructor( functionNodes = [], ...parametersNodes ) {\n\n\t\tsuper();\n\n\t\tthis.functionNodes = functionNodes;\n\t\tthis.parametersNodes = parametersNodes;\n\n\t\tthis._candidateFnCall = null;\n\n\t\tthis.global = true;\n\n\t}\n\n\tgetNodeType() {\n\n\t\treturn this.functionNodes[ 0 ].shaderNode.layout.type;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst params = this.parametersNodes;\n\n\t\tlet candidateFnCall = this._candidateFnCall;\n\n\t\tif ( candidateFnCall === null ) {\n\n\t\t\tlet candidateFn = null;\n\t\t\tlet candidateScore = - 1;\n\n\t\t\tfor ( const functionNode of this.functionNodes ) {\n\n\t\t\t\tconst shaderNode = functionNode.shaderNode;\n\t\t\t\tconst layout = shaderNode.layout;\n\n\t\t\t\tif ( layout === null ) {\n\n\t\t\t\t\tthrow new Error( 'FunctionOverloadingNode: FunctionNode must be a layout.' );\n\n\t\t\t\t}\n\n\t\t\t\tconst inputs = layout.inputs;\n\n\t\t\t\tif ( params.length === inputs.length ) {\n\n\t\t\t\t\tlet score = 0;\n\n\t\t\t\t\tfor ( let i = 0; i < params.length; i ++ ) {\n\n\t\t\t\t\t\tconst param = params[ i ];\n\t\t\t\t\t\tconst input = inputs[ i ];\n\n\t\t\t\t\t\tif ( param.getNodeType( builder ) === input.type ) {\n\n\t\t\t\t\t\t\tscore ++;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tscore = 0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( score > candidateScore ) {\n\n\t\t\t\t\t\tcandidateFn = functionNode;\n\t\t\t\t\t\tcandidateScore = score;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._candidateFnCall = candidateFnCall = candidateFn( ...params );\n\n\t\t}\n\n\t\treturn candidateFnCall;\n\n\t}\n\n}\n\nconst overloadingBaseFn = /*@__PURE__*/ nodeProxy( FunctionOverloadingNode );\n\nconst overloadingFn = ( functionNodes ) => ( ...params ) => overloadingBaseFn( functionNodes, ...params );\n\nconst time = /*@__PURE__*/ uniform( 0 ).setGroup( renderGroup ).onRenderUpdate( ( frame ) => frame.time );\nconst deltaTime = /*@__PURE__*/ uniform( 0 ).setGroup( renderGroup ).onRenderUpdate( ( frame ) => frame.deltaTime );\nconst frameId = /*@__PURE__*/ uniform( 0, 'uint' ).setGroup( renderGroup ).onRenderUpdate( ( frame ) => frame.frameId );\n\n// Deprecated\n\nconst timerLocal = ( timeScale = 1 ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: timerLocal() is deprecated. Use \"time\" instead.' );\n\treturn time.mul( timeScale );\n\n};\n\nconst timerGlobal = ( timeScale = 1 ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: timerGlobal() is deprecated. Use \"time\" instead.' );\n\treturn time.mul( timeScale );\n\n};\n\nconst timerDelta = ( timeScale = 1 ) => { // @deprecated, r170\n\n\tconsole.warn( 'TSL: timerDelta() is deprecated. Use \"deltaTime\" instead.' );\n\treturn deltaTime.mul( timeScale );\n\n};\n\nconst oscSine = ( t = time ) => t.add( 0.75 ).mul( Math.PI * 2 ).sin().mul( 0.5 ).add( 0.5 );\nconst oscSquare = ( t = time ) => t.fract().round();\nconst oscTriangle = ( t = time ) => t.add( 0.5 ).fract().mul( 2 ).sub( 1 ).abs();\nconst oscSawtooth = ( t = time ) => t.fract();\n\nconst rotateUV = /*@__PURE__*/ Fn( ( [ uv, rotation, center = vec2( 0.5 ) ] ) => {\n\n\treturn rotate( uv.sub( center ), rotation ).add( center );\n\n} );\n\nconst spherizeUV = /*@__PURE__*/ Fn( ( [ uv, strength, center = vec2( 0.5 ) ] ) => {\n\n\tconst delta = uv.sub( center );\n\tconst delta2 = delta.dot( delta );\n\tconst delta4 = delta2.mul( delta2 );\n\tconst deltaOffset = delta4.mul( strength );\n\n\treturn uv.add( delta.mul( deltaOffset ) );\n\n} );\n\nconst billboarding = /*@__PURE__*/ Fn( ( { position = null, horizontal = true, vertical = false } ) => {\n\n\tlet worldMatrix;\n\n\tif ( position !== null ) {\n\n\t\tworldMatrix = modelWorldMatrix.toVar();\n\t\tworldMatrix[ 3 ][ 0 ] = position.x;\n\t\tworldMatrix[ 3 ][ 1 ] = position.y;\n\t\tworldMatrix[ 3 ][ 2 ] = position.z;\n\n\t} else {\n\n\t\tworldMatrix = modelWorldMatrix;\n\n\t}\n\n\tconst modelViewMatrix = cameraViewMatrix.mul( worldMatrix );\n\n\tif ( defined( horizontal ) ) {\n\n\t\tmodelViewMatrix[ 0 ][ 0 ] = modelWorldMatrix[ 0 ].length();\n\t\tmodelViewMatrix[ 0 ][ 1 ] = 0;\n\t\tmodelViewMatrix[ 0 ][ 2 ] = 0;\n\n\t}\n\n\tif ( defined( vertical ) ) {\n\n\t\tmodelViewMatrix[ 1 ][ 0 ] = 0;\n\t\tmodelViewMatrix[ 1 ][ 1 ] = modelWorldMatrix[ 1 ].length();\n\t\tmodelViewMatrix[ 1 ][ 2 ] = 0;\n\n\t}\n\n\tmodelViewMatrix[ 2 ][ 0 ] = 0;\n\tmodelViewMatrix[ 2 ][ 1 ] = 0;\n\tmodelViewMatrix[ 2 ][ 2 ] = 1;\n\n\treturn cameraProjectionMatrix.mul( modelViewMatrix ).mul( positionLocal );\n\n} );\n\nconst viewportSafeUV = /*@__PURE__*/ Fn( ( [ uv = null ] ) => {\n\n\tconst depth = linearDepth();\n\tconst depthDiff = linearDepth( viewportDepthTexture( uv ) ).sub( depth );\n\tconst finalUV = depthDiff.lessThan( 0 ).select( screenUV, uv );\n\n\treturn finalUV;\n\n} );\n\nclass SpriteSheetUVNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SpriteSheetUVNode';\n\n\t}\n\n\tconstructor( countNode, uvNode = uv(), frameNode = float( 0 ) ) {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.countNode = countNode;\n\t\tthis.uvNode = uvNode;\n\t\tthis.frameNode = frameNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { frameNode, uvNode, countNode } = this;\n\n\t\tconst { width, height } = countNode;\n\n\t\tconst frameNum = frameNode.mod( width.mul( height ) ).floor();\n\n\t\tconst column = frameNum.mod( width );\n\t\tconst row = height.sub( frameNum.add( 1 ).div( width ).ceil() );\n\n\t\tconst scale = countNode.reciprocal();\n\t\tconst uvFrameOffset = vec2( column, row );\n\n\t\treturn uvNode.add( uvFrameOffset ).mul( scale );\n\n\t}\n\n}\n\nconst spritesheetUV = /*@__PURE__*/ nodeProxy( SpriteSheetUVNode );\n\nclass TriplanarTexturesNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'TriplanarTexturesNode';\n\n\t}\n\n\tconstructor( textureXNode, textureYNode = null, textureZNode = null, scaleNode = float( 1 ), positionNode = positionLocal, normalNode = normalLocal ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.textureXNode = textureXNode;\n\t\tthis.textureYNode = textureYNode;\n\t\tthis.textureZNode = textureZNode;\n\n\t\tthis.scaleNode = scaleNode;\n\n\t\tthis.positionNode = positionNode;\n\t\tthis.normalNode = normalNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { textureXNode, textureYNode, textureZNode, scaleNode, positionNode, normalNode } = this;\n\n\t\t// Ref: https://github.com/keijiro/StandardTriplanar\n\n\t\t// Blending factor of triplanar mapping\n\t\tlet bf = normalNode.abs().normalize();\n\t\tbf = bf.div( bf.dot( vec3( 1.0 ) ) );\n\n\t\t// Triplanar mapping\n\t\tconst tx = positionNode.yz.mul( scaleNode );\n\t\tconst ty = positionNode.zx.mul( scaleNode );\n\t\tconst tz = positionNode.xy.mul( scaleNode );\n\n\t\t// Base color\n\t\tconst textureX = textureXNode.value;\n\t\tconst textureY = textureYNode !== null ? textureYNode.value : textureX;\n\t\tconst textureZ = textureZNode !== null ? textureZNode.value : textureX;\n\n\t\tconst cx = texture( textureX, tx ).mul( bf.x );\n\t\tconst cy = texture( textureY, ty ).mul( bf.y );\n\t\tconst cz = texture( textureZ, tz ).mul( bf.z );\n\n\t\treturn add( cx, cy, cz );\n\n\t}\n\n}\n\nconst triplanarTextures = /*@__PURE__*/ nodeProxy( TriplanarTexturesNode );\nconst triplanarTexture = ( ...params ) => triplanarTextures( ...params );\n\nconst _reflectorPlane = new Plane();\nconst _normal = new Vector3();\nconst _reflectorWorldPosition = new Vector3();\nconst _cameraWorldPosition = new Vector3();\nconst _rotationMatrix = new Matrix4();\nconst _lookAtPosition = new Vector3( 0, 0, - 1 );\nconst clipPlane = new Vector4();\n\nconst _view = new Vector3();\nconst _target = new Vector3();\nconst _q = new Vector4();\n\nconst _size$2 = new Vector2();\n\nconst _defaultRT = new RenderTarget();\nconst _defaultUV = screenUV.flipX();\n\n_defaultRT.depthTexture = new DepthTexture( 1, 1 );\n\nlet _inReflector = false;\n\nclass ReflectorNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ReflectorNode';\n\n\t}\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( parameters.defaultTexture || _defaultRT.texture, _defaultUV );\n\n\t\tthis._reflectorBaseNode = parameters.reflector || new ReflectorBaseNode( this, parameters );\n\t\tthis._depthNode = null;\n\n\t\tthis.setUpdateMatrix( false );\n\n\t}\n\n\tget reflector() {\n\n\t\treturn this._reflectorBaseNode;\n\n\t}\n\n\tget target() {\n\n\t\treturn this._reflectorBaseNode.target;\n\n\t}\n\n\tgetDepthNode() {\n\n\t\tif ( this._depthNode === null ) {\n\n\t\t\tif ( this._reflectorBaseNode.depth !== true ) {\n\n\t\t\t\tthrow new Error( 'THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ' );\n\n\t\t\t}\n\n\t\t\tthis._depthNode = nodeObject( new ReflectorNode( {\n\t\t\t\tdefaultTexture: _defaultRT.depthTexture,\n\t\t\t\treflector: this._reflectorBaseNode\n\t\t\t} ) );\n\n\t\t}\n\n\t\treturn this._depthNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\t// ignore if used in post-processing\n\t\tif ( ! builder.object.isQuadMesh ) this._reflectorBaseNode.build( builder );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\tconst texture = new this.constructor( this.reflectorNode );\n\t\ttexture._reflectorBaseNode = this._reflectorBaseNode;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n\nclass ReflectorBaseNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ReflectorBaseNode';\n\n\t}\n\n\tconstructor( textureNode, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tconst {\n\t\t\ttarget = new Object3D(),\n\t\t\tresolution = 1,\n\t\t\tgenerateMipmaps = false,\n\t\t\tbounces = true,\n\t\t\tdepth = false\n\t\t} = parameters;\n\n\t\t//\n\n\t\tthis.textureNode = textureNode;\n\n\t\tthis.target = target;\n\t\tthis.resolution = resolution;\n\t\tthis.generateMipmaps = generateMipmaps;\n\t\tthis.bounces = bounces;\n\t\tthis.depth = depth;\n\n\t\tthis.updateBeforeType = bounces ? NodeUpdateType.RENDER : NodeUpdateType.FRAME;\n\n\t\tthis.virtualCameras = new WeakMap();\n\t\tthis.renderTargets = new WeakMap();\n\n\t}\n\n\t_updateResolution( renderTarget, renderer ) {\n\n\t\tconst resolution = this.resolution;\n\n\t\trenderer.getDrawingBufferSize( _size$2 );\n\n\t\trenderTarget.setSize( Math.round( _size$2.width * resolution ), Math.round( _size$2.height * resolution ) );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis._updateResolution( _defaultRT, builder.renderer );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tgetVirtualCamera( camera ) {\n\n\t\tlet virtualCamera = this.virtualCameras.get( camera );\n\n\t\tif ( virtualCamera === undefined ) {\n\n\t\t\tvirtualCamera = camera.clone();\n\n\t\t\tthis.virtualCameras.set( camera, virtualCamera );\n\n\t\t}\n\n\t\treturn virtualCamera;\n\n\t}\n\n\tgetRenderTarget( camera ) {\n\n\t\tlet renderTarget = this.renderTargets.get( camera );\n\n\t\tif ( renderTarget === undefined ) {\n\n\t\t\trenderTarget = new RenderTarget( 0, 0, { type: HalfFloatType } );\n\n\t\t\tif ( this.generateMipmaps === true ) {\n\n\t\t\t\trenderTarget.texture.minFilter = LinearMipMapLinearFilter;\n\t\t\t\trenderTarget.texture.generateMipmaps = true;\n\n\t\t\t}\n\n\t\t\tif ( this.depth === true ) {\n\n\t\t\t\trenderTarget.depthTexture = new DepthTexture();\n\n\t\t\t}\n\n\t\t\tthis.renderTargets.set( camera, renderTarget );\n\n\t\t}\n\n\t\treturn renderTarget;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tif ( this.bounces === false && _inReflector ) return;\n\n\t\t_inReflector = true;\n\n\t\tconst { scene, camera, renderer, material } = frame;\n\t\tconst { target } = this;\n\n\t\tconst virtualCamera = this.getVirtualCamera( camera );\n\t\tconst renderTarget = this.getRenderTarget( virtualCamera );\n\n\t\trenderer.getDrawingBufferSize( _size$2 );\n\n\t\tthis._updateResolution( renderTarget, renderer );\n\n\t\t//\n\n\t\t_reflectorWorldPosition.setFromMatrixPosition( target.matrixWorld );\n\t\t_cameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\t_rotationMatrix.extractRotation( target.matrixWorld );\n\n\t\t_normal.set( 0, 0, 1 );\n\t\t_normal.applyMatrix4( _rotationMatrix );\n\n\t\t_view.subVectors( _reflectorWorldPosition, _cameraWorldPosition );\n\n\t\t// Avoid rendering when reflector is facing away\n\n\t\tif ( _view.dot( _normal ) > 0 ) return;\n\n\t\t_view.reflect( _normal ).negate();\n\t\t_view.add( _reflectorWorldPosition );\n\n\t\t_rotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\t_lookAtPosition.set( 0, 0, - 1 );\n\t\t_lookAtPosition.applyMatrix4( _rotationMatrix );\n\t\t_lookAtPosition.add( _cameraWorldPosition );\n\n\t\t_target.subVectors( _reflectorWorldPosition, _lookAtPosition );\n\t\t_target.reflect( _normal ).negate();\n\t\t_target.add( _reflectorWorldPosition );\n\n\t\t//\n\n\t\tvirtualCamera.coordinateSystem = camera.coordinateSystem;\n\t\tvirtualCamera.position.copy( _view );\n\t\tvirtualCamera.up.set( 0, 1, 0 );\n\t\tvirtualCamera.up.applyMatrix4( _rotationMatrix );\n\t\tvirtualCamera.up.reflect( _normal );\n\t\tvirtualCamera.lookAt( _target );\n\n\t\tvirtualCamera.near = camera.near;\n\t\tvirtualCamera.far = camera.far;\n\n\t\tvirtualCamera.updateMatrixWorld();\n\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n\t\t// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\t\t_reflectorPlane.setFromNormalAndCoplanarPoint( _normal, _reflectorWorldPosition );\n\t\t_reflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\tclipPlane.set( _reflectorPlane.normal.x, _reflectorPlane.normal.y, _reflectorPlane.normal.z, _reflectorPlane.constant );\n\n\t\tconst projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\t_q.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\t_q.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\t_q.z = - 1.0;\n\t\t_q.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t// Calculate the scaled plane vector\n\t\tclipPlane.multiplyScalar( 1.0 / clipPlane.dot( _q ) );\n\n\t\tconst clipBias = 0;\n\n\t\t// Replacing the third row of the projection matrix\n\t\tprojectionMatrix.elements[ 2 ] = clipPlane.x;\n\t\tprojectionMatrix.elements[ 6 ] = clipPlane.y;\n\t\tprojectionMatrix.elements[ 10 ] = ( renderer.coordinateSystem === WebGPUCoordinateSystem ) ? ( clipPlane.z - clipBias ) : ( clipPlane.z + 1.0 - clipBias );\n\t\tprojectionMatrix.elements[ 14 ] = clipPlane.w;\n\n\t\t//\n\n\t\tthis.textureNode.value = renderTarget.texture;\n\n\t\tif ( this.depth === true ) {\n\n\t\t\tthis.textureNode.getDepthNode().value = renderTarget.depthTexture;\n\n\t\t}\n\n\t\tmaterial.visible = false;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentMRT = renderer.getMRT();\n\n\t\trenderer.setMRT( null );\n\t\trenderer.setRenderTarget( renderTarget );\n\n\t\trenderer.render( scene, virtualCamera );\n\n\t\trenderer.setMRT( currentMRT );\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\tmaterial.visible = true;\n\n\t\t_inReflector = false;\n\n\t}\n\n}\n\nconst reflector = ( parameters ) => nodeObject( new ReflectorNode( parameters ) );\n\n// Helper for passes that need to fill the viewport with a single quad.\n\nconst _camera = /*@__PURE__*/ new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\n\n// https://github.com/mrdoob/three.js/pull/21358\n\nclass QuadGeometry extends BufferGeometry {\n\n\tconstructor( flipY = false ) {\n\n\t\tsuper();\n\n\t\tconst uv = flipY === false ? [ 0, - 1, 0, 1, 2, 1 ] : [ 0, 2, 0, 0, 2, 0 ];\n\n\t\tthis.setAttribute( 'position', new Float32BufferAttribute( [ - 1, 3, 0, - 1, - 1, 0, 3, - 1, 0 ], 3 ) );\n\t\tthis.setAttribute( 'uv', new Float32BufferAttribute( uv, 2 ) );\n\n\t}\n\n}\n\nconst _geometry = /*@__PURE__*/ new QuadGeometry();\n\nclass QuadMesh extends Mesh {\n\n\tconstructor( material = null ) {\n\n\t\tsuper( _geometry, material );\n\n\t\tthis.camera = _camera;\n\n\t\tthis.isQuadMesh = true;\n\n\t}\n\n\trenderAsync( renderer ) {\n\n\t\treturn renderer.renderAsync( this, _camera );\n\n\t}\n\n\trender( renderer ) {\n\n\t\trenderer.render( this, _camera );\n\n\t}\n\n}\n\nconst _size$1 = /*@__PURE__*/ new Vector2();\n\nclass RTTNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'RTTNode';\n\n\t}\n\n\tconstructor( node, width = null, height = null, options = { type: HalfFloatType } ) {\n\n\t\tconst renderTarget = new RenderTarget( width, height, options );\n\n\t\tsuper( renderTarget.texture, uv() );\n\n\t\tthis.node = node;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tthis.textureNeedsUpdate = true;\n\t\tthis.autoUpdate = true;\n\n\t\tthis.updateMap = new WeakMap();\n\n\t\tthis._rttNode = null;\n\t\tthis._quadMesh = new QuadMesh( new NodeMaterial() );\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\n\t}\n\n\tget autoSize() {\n\n\t\treturn this.width === null;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis._rttNode = this.node.context( builder.getSharedContext() );\n\t\tthis._quadMesh.material.name = 'RTT';\n\t\tthis._quadMesh.material.needsUpdate = true;\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\n\t\tconst effectiveWidth = width * this.pixelRatio;\n\t\tconst effectiveHeight = height * this.pixelRatio;\n\n\t\tthis.renderTarget.setSize( effectiveWidth, effectiveHeight );\n\n\t\tthis.textureNeedsUpdate = true;\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis.pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this.width, this.height );\n\n\t}\n\n\tupdateBefore( { renderer } ) {\n\n\t\tif ( this.textureNeedsUpdate === false && this.autoUpdate === false ) return;\n\n\t\tthis.textureNeedsUpdate = false;\n\n\t\t//\n\n\t\tif ( this.autoSize === true ) {\n\n\t\t\tthis.pixelRatio = renderer.getPixelRatio();\n\n\t\t\tconst size = renderer.getSize( _size$1 );\n\n\t\t\tthis.setSize( size.width, size.height );\n\n\t\t}\n\n\t\t//\n\n\t\tthis._quadMesh.material.fragmentNode = this._rttNode;\n\n\t\t//\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\trenderer.setRenderTarget( this.renderTarget );\n\n\t\tthis._quadMesh.render( renderer );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t}\n\n\tclone() {\n\n\t\tconst newNode = new TextureNode( this.value, this.uvNode, this.levelNode );\n\t\tnewNode.sampler = this.sampler;\n\t\tnewNode.referenceNode = this;\n\n\t\treturn newNode;\n\n\t}\n\n}\n\nconst rtt = ( node, ...params ) => nodeObject( new RTTNode( nodeObject( node ), ...params ) );\nconst convertToTexture = ( node, ...params ) => node.isTextureNode ? node : rtt( node, ...params );\n\n/**\n* Computes a position in view space based on a fragment's screen position expressed as uv coordinates, the fragments\n* depth value and the camera's inverse projection matrix.\n*\n* @param {vec2} screenPosition - The fragment's screen position expressed as uv coordinates.\n* @param {float} depth - The fragment's depth value.\n* @param {mat4} projectionMatrixInverse - The camera's inverse projection matrix.\n* @return {vec3} The fragments position in view space.\n*/\nconst getViewPosition = /*@__PURE__*/ Fn( ( [ screenPosition, depth, projectionMatrixInverse ], builder ) => {\n\n\tlet clipSpacePosition;\n\n\tif ( builder.renderer.coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\tscreenPosition = vec2( screenPosition.x, screenPosition.y.oneMinus() ).mul( 2.0 ).sub( 1.0 );\n\t\tclipSpacePosition = vec4( vec3( screenPosition, depth ), 1.0 );\n\n\t} else {\n\n\t\tclipSpacePosition = vec4( vec3( screenPosition.x, screenPosition.y.oneMinus(), depth ).mul( 2.0 ).sub( 1.0 ), 1.0 );\n\n\t}\n\n\tconst viewSpacePosition = vec4( projectionMatrixInverse.mul( clipSpacePosition ) );\n\n\treturn viewSpacePosition.xyz.div( viewSpacePosition.w );\n\n} );\n\n/**\n* Computes a screen position expressed as uv coordinates based on a fragment's position in view space\n* and the camera's projection matrix\n*\n* @param {vec3} viewPosition - The fragments position in view space.\n* @param {mat4} projectionMatrix - The camera's projection matrix.\n* @return {vec2} The fragment's screen position expressed as uv coordinates.\n*/\nconst getScreenPosition = /*@__PURE__*/ Fn( ( [ viewPosition, projectionMatrix ] ) => {\n\n\tconst sampleClipPos = projectionMatrix.mul( vec4( viewPosition, 1.0 ) );\n\tconst sampleUv = sampleClipPos.xy.div( sampleClipPos.w ).mul( 0.5 ).add( 0.5 ).toVar();\n\treturn vec2( sampleUv.x, sampleUv.y.oneMinus() );\n\n} );\n\n/**\n* Computes a normal vector based on depth data. Can be used as a fallback when no normal render\n* target is available or if flat surface normals are required.\n*\n* @param {vec2} uv - The texture coordinate.\n* @param {DepthTexture} depthTexture - The depth texture.\n* @param {mat4} projectionMatrixInverse - The camera's inverse projection matrix.\n* @return {vec3} The computed normal vector.\n*/\nconst getNormalFromDepth = /*@__PURE__*/ Fn( ( [ uv, depthTexture, projectionMatrixInverse ] ) => {\n\n\tconst size = textureSize( textureLoad( depthTexture ) );\n\tconst p = ivec2( uv.mul( size ) ).toVar();\n\n\tconst c0 = textureLoad( depthTexture, p ).toVar();\n\n\tconst l2 = textureLoad( depthTexture, p.sub( ivec2( 2, 0 ) ) ).toVar();\n\tconst l1 = textureLoad( depthTexture, p.sub( ivec2( 1, 0 ) ) ).toVar();\n\tconst r1 = textureLoad( depthTexture, p.add( ivec2( 1, 0 ) ) ).toVar();\n\tconst r2 = textureLoad( depthTexture, p.add( ivec2( 2, 0 ) ) ).toVar();\n\tconst b2 = textureLoad( depthTexture, p.add( ivec2( 0, 2 ) ) ).toVar();\n\tconst b1 = textureLoad( depthTexture, p.add( ivec2( 0, 1 ) ) ).toVar();\n\tconst t1 = textureLoad( depthTexture, p.sub( ivec2( 0, 1 ) ) ).toVar();\n\tconst t2 = textureLoad( depthTexture, p.sub( ivec2( 0, 2 ) ) ).toVar();\n\n\tconst dl = abs( sub( float( 2 ).mul( l1 ).sub( l2 ), c0 ) ).toVar();\n\tconst dr = abs( sub( float( 2 ).mul( r1 ).sub( r2 ), c0 ) ).toVar();\n\tconst db = abs( sub( float( 2 ).mul( b1 ).sub( b2 ), c0 ) ).toVar();\n\tconst dt = abs( sub( float( 2 ).mul( t1 ).sub( t2 ), c0 ) ).toVar();\n\n\tconst ce = getViewPosition( uv, c0, projectionMatrixInverse ).toVar();\n\n\tconst dpdx = dl.lessThan( dr ).select( ce.sub( getViewPosition( uv.sub( vec2( float( 1 ).div( size.x ), 0 ) ), l1, projectionMatrixInverse ) ), ce.negate().add( getViewPosition( uv.add( vec2( float( 1 ).div( size.x ), 0 ) ), r1, projectionMatrixInverse ) ) );\n\tconst dpdy = db.lessThan( dt ).select( ce.sub( getViewPosition( uv.add( vec2( 0, float( 1 ).div( size.y ) ) ), b1, projectionMatrixInverse ) ), ce.negate().add( getViewPosition( uv.sub( vec2( 0, float( 1 ).div( size.y ) ) ), t1, projectionMatrixInverse ) ) );\n\n\treturn normalize( cross( dpdx, dpdy ) );\n\n} );\n\nclass VertexColorNode extends AttributeNode {\n\n\tstatic get type() {\n\n\t\treturn 'VertexColorNode';\n\n\t}\n\n\tconstructor( index = 0 ) {\n\n\t\tsuper( null, 'vec4' );\n\n\t\tthis.isVertexColorNode = true;\n\n\t\tthis.index = index;\n\n\t}\n\n\tgetAttributeName( /*builder*/ ) {\n\n\t\tconst index = this.index;\n\n\t\treturn 'color' + ( index > 0 ? index : '' );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst attributeName = this.getAttributeName( builder );\n\t\tconst geometryAttribute = builder.hasGeometryAttribute( attributeName );\n\n\t\tlet result;\n\n\t\tif ( geometryAttribute === true ) {\n\n\t\t\tresult = super.generate( builder );\n\n\t\t} else {\n\n\t\t\t// Vertex color fallback should be white\n\t\t\tresult = builder.generateConst( this.nodeType, new Vector4( 1, 1, 1, 1 ) );\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.index = this.index;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.index = data.index;\n\n\t}\n\n}\n\nconst vertexColor = ( ...params ) => nodeObject( new VertexColorNode( ...params ) );\n\nclass PointUVNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'PointUVNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.isPointUVNode = true;\n\n\t}\n\n\tgenerate( /*builder*/ ) {\n\n\t\treturn 'vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )';\n\n\t}\n\n}\n\nconst pointUV = /*@__PURE__*/ nodeImmutable( PointUVNode );\n\nconst _e1 = /*@__PURE__*/ new Euler();\nconst _m1 = /*@__PURE__*/ new Matrix4();\n\nclass SceneNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'SceneNode';\n\n\t}\n\n\tconstructor( scope = SceneNode.BACKGROUND_BLURRINESS, scene = null ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\t\tthis.scene = scene;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst scope = this.scope;\n\t\tconst scene = this.scene !== null ? this.scene : builder.scene;\n\n\t\tlet output;\n\n\t\tif ( scope === SceneNode.BACKGROUND_BLURRINESS ) {\n\n\t\t\toutput = reference( 'backgroundBlurriness', 'float', scene );\n\n\t\t} else if ( scope === SceneNode.BACKGROUND_INTENSITY ) {\n\n\t\t\toutput = reference( 'backgroundIntensity', 'float', scene );\n\n\t\t} else if ( scope === SceneNode.BACKGROUND_ROTATION ) {\n\n\t\t\toutput = uniform( 'mat4' ).label( 'backgroundRotation' ).setGroup( renderGroup ).onRenderUpdate( () => {\n\n\t\t\t\tconst background = scene.background;\n\n\t\t\t\tif ( background !== null && background.isTexture && background.mapping !== UVMapping ) {\n\n\t\t\t\t\t_e1.copy( scene.backgroundRotation );\n\n\t\t\t\t\t// accommodate left-handed frame\n\t\t\t\t\t_e1.x *= - 1; _e1.y *= - 1; _e1.z *= - 1;\n\n\t\t\t\t\t_m1.makeRotationFromEuler( _e1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_m1.identity();\n\n\t\t\t\t}\n\n\t\t\t\treturn _m1;\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.SceneNode: Unknown scope:', scope );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nSceneNode.BACKGROUND_BLURRINESS = 'backgroundBlurriness';\nSceneNode.BACKGROUND_INTENSITY = 'backgroundIntensity';\nSceneNode.BACKGROUND_ROTATION = 'backgroundRotation';\n\nconst backgroundBlurriness = /*@__PURE__*/ nodeImmutable( SceneNode, SceneNode.BACKGROUND_BLURRINESS );\nconst backgroundIntensity = /*@__PURE__*/ nodeImmutable( SceneNode, SceneNode.BACKGROUND_INTENSITY );\nconst backgroundRotation = /*@__PURE__*/ nodeImmutable( SceneNode, SceneNode.BACKGROUND_ROTATION );\n\nclass StorageArrayElementNode extends ArrayElementNode {\n\n\tstatic get type() {\n\n\t\treturn 'StorageArrayElementNode';\n\n\t}\n\n\tconstructor( storageBufferNode, indexNode ) {\n\n\t\tsuper( storageBufferNode, indexNode );\n\n\t\tthis.isStorageArrayElementNode = true;\n\n\t}\n\n\tset storageBufferNode( value ) {\n\n\t\tthis.node = value;\n\n\t}\n\n\tget storageBufferNode() {\n\n\t\treturn this.node;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) === false ) {\n\n\t\t\tif ( this.node.bufferObject === true ) {\n\n\t\t\t\tbuilder.setupPBO( this.node );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tconst isAssignContext = builder.context.assign;\n\n\t\t//\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) === false ) {\n\n\t\t\tif ( this.node.bufferObject === true && isAssignContext !== true ) {\n\n\t\t\t\tsnippet = builder.generatePBO( this );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = this.node.build( builder );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsnippet = super.generate( builder );\n\n\t\t}\n\n\t\tif ( isAssignContext !== true ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tsnippet = builder.format( snippet, type, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n}\n\nconst storageElement = /*@__PURE__*/ nodeProxy( StorageArrayElementNode );\n\nconst GPUPrimitiveTopology = {\n\tPointList: 'point-list',\n\tLineList: 'line-list',\n\tLineStrip: 'line-strip',\n\tTriangleList: 'triangle-list',\n\tTriangleStrip: 'triangle-strip',\n};\n\nconst GPUCompareFunction = {\n\tNever: 'never',\n\tLess: 'less',\n\tEqual: 'equal',\n\tLessEqual: 'less-equal',\n\tGreater: 'greater',\n\tNotEqual: 'not-equal',\n\tGreaterEqual: 'greater-equal',\n\tAlways: 'always'\n};\n\nconst GPUStoreOp = {\n\tStore: 'store',\n\tDiscard: 'discard'\n};\n\nconst GPULoadOp = {\n\tLoad: 'load',\n\tClear: 'clear'\n};\n\nconst GPUFrontFace = {\n\tCCW: 'ccw',\n\tCW: 'cw'\n};\n\nconst GPUCullMode = {\n\tNone: 'none',\n\tFront: 'front',\n\tBack: 'back'\n};\n\nconst GPUIndexFormat = {\n\tUint16: 'uint16',\n\tUint32: 'uint32'\n};\n\nconst GPUTextureFormat = {\n\n\t// 8-bit formats\n\n\tR8Unorm: 'r8unorm',\n\tR8Snorm: 'r8snorm',\n\tR8Uint: 'r8uint',\n\tR8Sint: 'r8sint',\n\n\t// 16-bit formats\n\n\tR16Uint: 'r16uint',\n\tR16Sint: 'r16sint',\n\tR16Float: 'r16float',\n\tRG8Unorm: 'rg8unorm',\n\tRG8Snorm: 'rg8snorm',\n\tRG8Uint: 'rg8uint',\n\tRG8Sint: 'rg8sint',\n\n\t// 32-bit formats\n\n\tR32Uint: 'r32uint',\n\tR32Sint: 'r32sint',\n\tR32Float: 'r32float',\n\tRG16Uint: 'rg16uint',\n\tRG16Sint: 'rg16sint',\n\tRG16Float: 'rg16float',\n\tRGBA8Unorm: 'rgba8unorm',\n\tRGBA8UnormSRGB: 'rgba8unorm-srgb',\n\tRGBA8Snorm: 'rgba8snorm',\n\tRGBA8Uint: 'rgba8uint',\n\tRGBA8Sint: 'rgba8sint',\n\tBGRA8Unorm: 'bgra8unorm',\n\tBGRA8UnormSRGB: 'bgra8unorm-srgb',\n\t// Packed 32-bit formats\n\tRGB9E5UFloat: 'rgb9e5ufloat',\n\tRGB10A2Unorm: 'rgb10a2unorm',\n\tRG11B10uFloat: 'rgb10a2unorm',\n\n\t// 64-bit formats\n\n\tRG32Uint: 'rg32uint',\n\tRG32Sint: 'rg32sint',\n\tRG32Float: 'rg32float',\n\tRGBA16Uint: 'rgba16uint',\n\tRGBA16Sint: 'rgba16sint',\n\tRGBA16Float: 'rgba16float',\n\n\t// 128-bit formats\n\n\tRGBA32Uint: 'rgba32uint',\n\tRGBA32Sint: 'rgba32sint',\n\tRGBA32Float: 'rgba32float',\n\n\t// Depth and stencil formats\n\n\tStencil8: 'stencil8',\n\tDepth16Unorm: 'depth16unorm',\n\tDepth24Plus: 'depth24plus',\n\tDepth24PlusStencil8: 'depth24plus-stencil8',\n\tDepth32Float: 'depth32float',\n\n\t// 'depth32float-stencil8' extension\n\n\tDepth32FloatStencil8: 'depth32float-stencil8',\n\n\t// BC compressed formats usable if 'texture-compression-bc' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tBC1RGBAUnorm: 'bc1-rgba-unorm',\n\tBC1RGBAUnormSRGB: 'bc1-rgba-unorm-srgb',\n\tBC2RGBAUnorm: 'bc2-rgba-unorm',\n\tBC2RGBAUnormSRGB: 'bc2-rgba-unorm-srgb',\n\tBC3RGBAUnorm: 'bc3-rgba-unorm',\n\tBC3RGBAUnormSRGB: 'bc3-rgba-unorm-srgb',\n\tBC4RUnorm: 'bc4-r-unorm',\n\tBC4RSnorm: 'bc4-r-snorm',\n\tBC5RGUnorm: 'bc5-rg-unorm',\n\tBC5RGSnorm: 'bc5-rg-snorm',\n\tBC6HRGBUFloat: 'bc6h-rgb-ufloat',\n\tBC6HRGBFloat: 'bc6h-rgb-float',\n\tBC7RGBAUnorm: 'bc7-rgba-unorm',\n\tBC7RGBAUnormSRGB: 'bc7-rgba-srgb',\n\n\t// ETC2 compressed formats usable if 'texture-compression-etc2' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tETC2RGB8Unorm: 'etc2-rgb8unorm',\n\tETC2RGB8UnormSRGB: 'etc2-rgb8unorm-srgb',\n\tETC2RGB8A1Unorm: 'etc2-rgb8a1unorm',\n\tETC2RGB8A1UnormSRGB: 'etc2-rgb8a1unorm-srgb',\n\tETC2RGBA8Unorm: 'etc2-rgba8unorm',\n\tETC2RGBA8UnormSRGB: 'etc2-rgba8unorm-srgb',\n\tEACR11Unorm: 'eac-r11unorm',\n\tEACR11Snorm: 'eac-r11snorm',\n\tEACRG11Unorm: 'eac-rg11unorm',\n\tEACRG11Snorm: 'eac-rg11snorm',\n\n\t// ASTC compressed formats usable if 'texture-compression-astc' is both\n\t// supported by the device/user agent and enabled in requestDevice.\n\n\tASTC4x4Unorm: 'astc-4x4-unorm',\n\tASTC4x4UnormSRGB: 'astc-4x4-unorm-srgb',\n\tASTC5x4Unorm: 'astc-5x4-unorm',\n\tASTC5x4UnormSRGB: 'astc-5x4-unorm-srgb',\n\tASTC5x5Unorm: 'astc-5x5-unorm',\n\tASTC5x5UnormSRGB: 'astc-5x5-unorm-srgb',\n\tASTC6x5Unorm: 'astc-6x5-unorm',\n\tASTC6x5UnormSRGB: 'astc-6x5-unorm-srgb',\n\tASTC6x6Unorm: 'astc-6x6-unorm',\n\tASTC6x6UnormSRGB: 'astc-6x6-unorm-srgb',\n\tASTC8x5Unorm: 'astc-8x5-unorm',\n\tASTC8x5UnormSRGB: 'astc-8x5-unorm-srgb',\n\tASTC8x6Unorm: 'astc-8x6-unorm',\n\tASTC8x6UnormSRGB: 'astc-8x6-unorm-srgb',\n\tASTC8x8Unorm: 'astc-8x8-unorm',\n\tASTC8x8UnormSRGB: 'astc-8x8-unorm-srgb',\n\tASTC10x5Unorm: 'astc-10x5-unorm',\n\tASTC10x5UnormSRGB: 'astc-10x5-unorm-srgb',\n\tASTC10x6Unorm: 'astc-10x6-unorm',\n\tASTC10x6UnormSRGB: 'astc-10x6-unorm-srgb',\n\tASTC10x8Unorm: 'astc-10x8-unorm',\n\tASTC10x8UnormSRGB: 'astc-10x8-unorm-srgb',\n\tASTC10x10Unorm: 'astc-10x10-unorm',\n\tASTC10x10UnormSRGB: 'astc-10x10-unorm-srgb',\n\tASTC12x10Unorm: 'astc-12x10-unorm',\n\tASTC12x10UnormSRGB: 'astc-12x10-unorm-srgb',\n\tASTC12x12Unorm: 'astc-12x12-unorm',\n\tASTC12x12UnormSRGB: 'astc-12x12-unorm-srgb',\n\n};\n\nconst GPUAddressMode = {\n\tClampToEdge: 'clamp-to-edge',\n\tRepeat: 'repeat',\n\tMirrorRepeat: 'mirror-repeat'\n};\n\nconst GPUFilterMode = {\n\tLinear: 'linear',\n\tNearest: 'nearest'\n};\n\nconst GPUBlendFactor = {\n\tZero: 'zero',\n\tOne: 'one',\n\tSrc: 'src',\n\tOneMinusSrc: 'one-minus-src',\n\tSrcAlpha: 'src-alpha',\n\tOneMinusSrcAlpha: 'one-minus-src-alpha',\n\tDst: 'dst',\n\tOneMinusDstColor: 'one-minus-dst',\n\tDstAlpha: 'dst-alpha',\n\tOneMinusDstAlpha: 'one-minus-dst-alpha',\n\tSrcAlphaSaturated: 'src-alpha-saturated',\n\tConstant: 'constant',\n\tOneMinusConstant: 'one-minus-constant'\n};\n\nconst GPUBlendOperation = {\n\tAdd: 'add',\n\tSubtract: 'subtract',\n\tReverseSubtract: 'reverse-subtract',\n\tMin: 'min',\n\tMax: 'max'\n};\n\nconst GPUColorWriteFlags = {\n\tNone: 0,\n\tRed: 0x1,\n\tGreen: 0x2,\n\tBlue: 0x4,\n\tAlpha: 0x8,\n\tAll: 0xF\n};\n\nconst GPUStencilOperation = {\n\tKeep: 'keep',\n\tZero: 'zero',\n\tReplace: 'replace',\n\tInvert: 'invert',\n\tIncrementClamp: 'increment-clamp',\n\tDecrementClamp: 'decrement-clamp',\n\tIncrementWrap: 'increment-wrap',\n\tDecrementWrap: 'decrement-wrap'\n};\n\nconst GPUBufferBindingType = {\n\tUniform: 'uniform',\n\tStorage: 'storage',\n\tReadOnlyStorage: 'read-only-storage'\n};\n\nconst GPUStorageTextureAccess = {\n\tWriteOnly: 'write-only',\n\tReadOnly: 'read-only',\n\tReadWrite: 'read-write',\n};\n\nconst GPUTextureSampleType = {\n\tFloat: 'float',\n\tUnfilterableFloat: 'unfilterable-float',\n\tDepth: 'depth',\n\tSInt: 'sint',\n\tUInt: 'uint'\n};\n\nconst GPUTextureDimension = {\n\tOneD: '1d',\n\tTwoD: '2d',\n\tThreeD: '3d'\n};\n\nconst GPUTextureViewDimension = {\n\tOneD: '1d',\n\tTwoD: '2d',\n\tTwoDArray: '2d-array',\n\tCube: 'cube',\n\tCubeArray: 'cube-array',\n\tThreeD: '3d'\n};\n\nconst GPUTextureAspect = {\n\tAll: 'all',\n\tStencilOnly: 'stencil-only',\n\tDepthOnly: 'depth-only'\n};\n\nconst GPUInputStepMode = {\n\tVertex: 'vertex',\n\tInstance: 'instance'\n};\n\nconst GPUFeatureName = {\n\tDepthClipControl: 'depth-clip-control',\n\tDepth32FloatStencil8: 'depth32float-stencil8',\n\tTextureCompressionBC: 'texture-compression-bc',\n\tTextureCompressionETC2: 'texture-compression-etc2',\n\tTextureCompressionASTC: 'texture-compression-astc',\n\tTimestampQuery: 'timestamp-query',\n\tIndirectFirstInstance: 'indirect-first-instance',\n\tShaderF16: 'shader-f16',\n\tRG11B10UFloat: 'rg11b10ufloat-renderable',\n\tBGRA8UNormStorage: 'bgra8unorm-storage',\n\tFloat32Filterable: 'float32-filterable',\n\tClipDistances: 'clip-distances',\n\tDualSourceBlending: 'dual-source-blending',\n\tSubgroups: 'subgroups'\n};\n\nclass StorageBufferNode extends BufferNode {\n\n\tstatic get type() {\n\n\t\treturn 'StorageBufferNode';\n\n\t}\n\n\tconstructor( value, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( value, bufferType, bufferCount );\n\n\t\tthis.isStorageBufferNode = true;\n\n\t\tthis.access = GPUBufferBindingType.Storage;\n\t\tthis.isAtomic = false;\n\n\t\tthis.bufferObject = false;\n\t\tthis.bufferCount = bufferCount;\n\n\t\tthis._attribute = null;\n\t\tthis._varying = null;\n\n\t\tthis.global = true;\n\n\t\tif ( value.isStorageBufferAttribute !== true && value.isStorageInstancedBufferAttribute !== true ) {\n\n\t\t\t// TOOD: Improve it, possibly adding a new property to the BufferAttribute to identify it as a storage buffer read-only attribute in Renderer\n\n\t\t\tif ( value.isInstancedBufferAttribute ) value.isStorageInstancedBufferAttribute = true;\n\t\t\telse value.isStorageBufferAttribute = true;\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this.bufferCount === 0 ) {\n\n\t\t\tlet bufferData = builder.globalCache.getData( this.value );\n\n\t\t\tif ( bufferData === undefined ) {\n\n\t\t\t\tbufferData = {\n\t\t\t\t\tnode: this\n\t\t\t\t};\n\n\t\t\t\tbuilder.globalCache.setData( this.value, bufferData );\n\n\t\t\t}\n\n\t\t\treturn bufferData.node.uuid;\n\n\t\t}\n\n\t\treturn this.uuid;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn this.value.isIndirectStorageBufferAttribute ? 'indirectStorageBuffer' : 'storageBuffer';\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn storageElement( this, indexNode );\n\n\t}\n\n\tsetBufferObject( value ) {\n\n\t\tthis.bufferObject = value;\n\n\t\treturn this;\n\n\t}\n\n\tsetAccess( value ) {\n\n\t\tthis.access = value;\n\n\t\treturn this;\n\n\t}\n\n\ttoReadOnly() {\n\n\t\treturn this.setAccess( GPUBufferBindingType.ReadOnlyStorage );\n\n\t}\n\n\tsetAtomic( value ) {\n\n\t\tthis.isAtomic = value;\n\n\t\treturn this;\n\n\t}\n\n\ttoAtomic() {\n\n\t\treturn this.setAtomic( true );\n\n\t}\n\n\tgetAttributeData() {\n\n\t\tif ( this._attribute === null ) {\n\n\t\t\tthis._attribute = bufferAttribute( this.value );\n\t\t\tthis._varying = varying( this._attribute );\n\n\t\t}\n\n\t\treturn {\n\t\t\tattribute: this._attribute,\n\t\t\tvarying: this._varying\n\t\t};\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) || builder.isAvailable( 'indirectStorageBuffer' ) ) {\n\n\t\t\treturn super.getNodeType( builder );\n\n\t\t}\n\n\t\tconst { attribute } = this.getAttributeData();\n\n\t\treturn attribute.getNodeType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tif ( builder.isAvailable( 'storageBuffer' ) || builder.isAvailable( 'indirectStorageBuffer' ) ) {\n\n\t\t\treturn super.generate( builder );\n\n\t\t}\n\n\t\tconst { attribute, varying } = this.getAttributeData();\n\n\t\tconst output = varying.build( builder );\n\n\t\tbuilder.registerTransform( output, attribute );\n\n\t\treturn output;\n\n\t}\n\n}\n\n// Read-Write Storage\nconst storage = ( value, type, count ) => nodeObject( new StorageBufferNode( value, type, count ) );\nconst storageObject = ( value, type, count ) => nodeObject( new StorageBufferNode( value, type, count ).setBufferObject( true ) );\n\nclass StorageTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'StorageTextureNode';\n\n\t}\n\n\tconstructor( value, uvNode, storeNode = null ) {\n\n\t\tsuper( value, uvNode );\n\n\t\tthis.storeNode = storeNode;\n\n\t\tthis.isStorageTextureNode = true;\n\n\t\tthis.access = GPUStorageTextureAccess.WriteOnly;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn 'storageTexture';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst properties = builder.getNodeProperties( this );\n\t\tproperties.storeNode = this.storeNode;\n\n\t}\n\n\tsetAccess( value ) {\n\n\t\tthis.access = value;\n\t\treturn this;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tif ( this.storeNode !== null ) {\n\n\t\t\tsnippet = this.generateStore( builder );\n\n\t\t} else {\n\n\t\t\tsnippet = super.generate( builder, output );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\ttoReadOnly() {\n\n\t\treturn this.setAccess( GPUStorageTextureAccess.ReadOnly );\n\n\t}\n\n\ttoWriteOnly() {\n\n\t\treturn this.setAccess( GPUStorageTextureAccess.WriteOnly );\n\n\t}\n\n\tgenerateStore( builder ) {\n\n\t\tconst properties = builder.getNodeProperties( this );\n\n\t\tconst { uvNode, storeNode } = properties;\n\n\t\tconst textureProperty = super.generate( builder, 'property' );\n\t\tconst uvSnippet = uvNode.build( builder, 'uvec2' );\n\t\tconst storeSnippet = storeNode.build( builder, 'vec4' );\n\n\t\tconst snippet = builder.generateTextureStore( builder, textureProperty, uvSnippet, storeSnippet );\n\n\t\tbuilder.addLineFlowCode( snippet, this );\n\n\t}\n\n}\n\nconst storageTexture = /*@__PURE__*/ nodeProxy( StorageTextureNode );\n\nconst textureStore = ( value, uvNode, storeNode ) => {\n\n\tconst node = storageTexture( value, uvNode, storeNode );\n\n\tif ( storeNode !== null ) node.append();\n\n\treturn node;\n\n};\n\nclass UserDataNode extends ReferenceNode {\n\n\tstatic get type() {\n\n\t\treturn 'UserDataNode';\n\n\t}\n\n\tconstructor( property, inputType, userData = null ) {\n\n\t\tsuper( property, inputType, userData );\n\n\t\tthis.userData = userData;\n\n\t}\n\n\tupdateReference( state ) {\n\n\t\tthis.reference = this.userData !== null ? this.userData : state.object.userData;\n\n\t\treturn this.reference;\n\n\t}\n\n}\n\nconst userData = ( name, inputType, userData ) => nodeObject( new UserDataNode( name, inputType, userData ) );\n\nconst _objectData = new WeakMap();\n\nclass VelocityNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'VelocityNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec2' );\n\n\t\tthis.projectionMatrix = null;\n\n\t\tthis.updateType = NodeUpdateType.OBJECT;\n\t\tthis.updateAfterType = NodeUpdateType.OBJECT;\n\n\t\tthis.previousModelWorldMatrix = uniform( new Matrix4() );\n\t\tthis.previousProjectionMatrix = uniform( new Matrix4() ).setGroup( renderGroup );\n\t\tthis.previousCameraViewMatrix = uniform( new Matrix4() );\n\n\t}\n\n\tsetProjectionMatrix( projectionMatrix ) {\n\n\t\tthis.projectionMatrix = projectionMatrix;\n\n\t}\n\n\tupdate( { frameId, camera, object } ) {\n\n\t\tconst previousModelMatrix = getPreviousMatrix( object );\n\n\t\tthis.previousModelWorldMatrix.value.copy( previousModelMatrix );\n\n\t\t//\n\n\t\tconst cameraData = getData( camera );\n\n\t\tif ( cameraData.frameId !== frameId ) {\n\n\t\t\tcameraData.frameId = frameId;\n\n\t\t\tif ( cameraData.previousProjectionMatrix === undefined ) {\n\n\t\t\t\tcameraData.previousProjectionMatrix = new Matrix4();\n\t\t\t\tcameraData.previousCameraViewMatrix = new Matrix4();\n\n\t\t\t\tcameraData.currentProjectionMatrix = new Matrix4();\n\t\t\t\tcameraData.currentCameraViewMatrix = new Matrix4();\n\n\t\t\t\tcameraData.previousProjectionMatrix.copy( this.projectionMatrix || camera.projectionMatrix );\n\t\t\t\tcameraData.previousCameraViewMatrix.copy( camera.matrixWorldInverse );\n\n\t\t\t} else {\n\n\t\t\t\tcameraData.previousProjectionMatrix.copy( cameraData.currentProjectionMatrix );\n\t\t\t\tcameraData.previousCameraViewMatrix.copy( cameraData.currentCameraViewMatrix );\n\n\t\t\t}\n\n\t\t\tcameraData.currentProjectionMatrix.copy( this.projectionMatrix || camera.projectionMatrix );\n\t\t\tcameraData.currentCameraViewMatrix.copy( camera.matrixWorldInverse );\n\n\t\t\tthis.previousProjectionMatrix.value.copy( cameraData.previousProjectionMatrix );\n\t\t\tthis.previousCameraViewMatrix.value.copy( cameraData.previousCameraViewMatrix );\n\n\t\t}\n\n\t}\n\n\tupdateAfter( { object } ) {\n\n\t\tgetPreviousMatrix( object ).copy( object.matrixWorld );\n\n\t}\n\n\tsetup( /*builder*/ ) {\n\n\t\tconst projectionMatrix = ( this.projectionMatrix === null ) ? cameraProjectionMatrix : uniform( this.projectionMatrix );\n\n\t\tconst previousModelViewMatrix = this.previousCameraViewMatrix.mul( this.previousModelWorldMatrix );\n\n\t\tconst clipPositionCurrent = projectionMatrix.mul( modelViewMatrix ).mul( positionLocal );\n\t\tconst clipPositionPrevious = this.previousProjectionMatrix.mul( previousModelViewMatrix ).mul( positionPrevious );\n\n\t\tconst ndcPositionCurrent = clipPositionCurrent.xy.div( clipPositionCurrent.w );\n\t\tconst ndcPositionPrevious = clipPositionPrevious.xy.div( clipPositionPrevious.w );\n\n\t\tconst velocity = sub( ndcPositionCurrent, ndcPositionPrevious );\n\n\t\treturn velocity;\n\n\t}\n\n}\n\nfunction getData( object ) {\n\n\tlet objectData = _objectData.get( object );\n\n\tif ( objectData === undefined ) {\n\n\t\tobjectData = {};\n\t\t_objectData.set( object, objectData );\n\n\t}\n\n\treturn objectData;\n\n}\n\nfunction getPreviousMatrix( object, index = 0 ) {\n\n\tconst objectData = getData( object );\n\n\tlet matrix = objectData[ index ];\n\n\tif ( matrix === undefined ) {\n\n\t\tobjectData[ index ] = matrix = new Matrix4();\n\n\t}\n\n\treturn matrix;\n\n}\n\nconst velocity = /*@__PURE__*/ nodeImmutable( VelocityNode );\n\nconst burn = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn min$1( 1.0, base.oneMinus().div( blend ) ).oneMinus();\n\n} ).setLayout( {\n\tname: 'burnBlend',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst dodge = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn min$1( base.div( blend.oneMinus() ), 1.0 );\n\n} ).setLayout( {\n\tname: 'dodgeBlend',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst screen = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn base.oneMinus().mul( blend.oneMinus() ).oneMinus();\n\n} ).setLayout( {\n\tname: 'screenBlend',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst overlay = /*@__PURE__*/ Fn( ( [ base, blend ] ) => {\n\n\treturn mix( base.mul( 2.0 ).mul( blend ), base.oneMinus().mul( 2.0 ).mul( blend.oneMinus() ).oneMinus(), step( 0.5, base ) );\n\n} ).setLayout( {\n\tname: 'overlayBlend',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'base', type: 'vec3' },\n\t\t{ name: 'blend', type: 'vec3' }\n\t]\n} );\n\nconst grayscale = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\treturn luminance( color.rgb );\n\n} );\n\nconst saturation = /*@__PURE__*/ Fn( ( [ color, adjustment = float( 1 ) ] ) => {\n\n\treturn adjustment.mix( luminance( color.rgb ), color.rgb );\n\n} );\n\nconst vibrance = /*@__PURE__*/ Fn( ( [ color, adjustment = float( 1 ) ] ) => {\n\n\tconst average = add( color.r, color.g, color.b ).div( 3.0 );\n\n\tconst mx = color.r.max( color.g.max( color.b ) );\n\tconst amt = mx.sub( average ).mul( adjustment ).mul( - 3.0 );\n\n\treturn mix( color.rgb, mx, amt );\n\n} );\n\nconst hue = /*@__PURE__*/ Fn( ( [ color, adjustment = float( 1 ) ] ) => {\n\n\tconst k = vec3( 0.57735, 0.57735, 0.57735 );\n\n\tconst cosAngle = adjustment.cos();\n\n\treturn vec3( color.rgb.mul( cosAngle ).add( k.cross( color.rgb ).mul( adjustment.sin() ).add( k.mul( dot( k, color.rgb ).mul( cosAngle.oneMinus() ) ) ) ) );\n\n} );\n\nconst luminance = (\n\tcolor,\n\tluminanceCoefficients = vec3( ColorManagement.getLuminanceCoefficients( new Vector3() ) )\n) => dot( color, luminanceCoefficients );\n\nconst threshold = ( color, threshold ) => mix( vec3( 0.0 ), color, luminance( color ).sub( threshold ).max( 0 ) );\n\n/**\n * Color Decision List (CDL) v1.2\n *\n * Compact representation of color grading information, defined by slope, offset, power, and\n * saturation. The CDL should be typically be given input in a log space (such as LogC, ACEScc,\n * or AgX Log), and will return output in the same space. Output may require clamping >=0.\n *\n * @param {vec4} color Input (-Infinity < input < +Infinity)\n * @param {number | vec3} slope Slope (0 ≤ slope < +Infinity)\n * @param {number | vec3} offset Offset (-Infinity < offset < +Infinity; typically -1 < offset < 1)\n * @param {number | vec3} power Power (0 < power < +Infinity)\n * @param {number} saturation Saturation (0 ≤ saturation < +Infinity; typically 0 ≤ saturation < 4)\n * @param {vec3} luminanceCoefficients Luminance coefficients for saturation term, typically Rec. 709\n * @return Output, -Infinity < output < +Infinity\n *\n * References:\n * - ASC CDL v1.2\n * - https://blender.stackexchange.com/a/55239/43930\n * - https://docs.acescentral.com/specifications/acescc/\n */\nconst cdl = /*@__PURE__*/ Fn( ( [\n\tcolor,\n\tslope = vec3( 1 ),\n\toffset = vec3( 0 ),\n\tpower = vec3( 1 ),\n\tsaturation = float( 1 ),\n\t// ASC CDL v1.2 explicitly requires Rec. 709 luminance coefficients.\n\tluminanceCoefficients = vec3( ColorManagement.getLuminanceCoefficients( new Vector3(), LinearSRGBColorSpace ) )\n] ) => {\n\n\t// NOTE: The ASC CDL v1.2 defines a [0, 1] clamp on the slope+offset term, and another on the\n\t// saturation term. Per the ACEScc specification and Filament, limits may be omitted to support\n\t// values outside [0, 1], requiring a workaround for negative values in the power expression.\n\n\tconst luma = color.rgb.dot( vec3( luminanceCoefficients ) );\n\n\tconst v = max$1( color.rgb.mul( slope ).add( offset ), 0.0 ).toVar();\n\tconst pv = v.pow( power ).toVar();\n\n\tIf( v.r.greaterThan( 0.0 ), () => { v.r.assign( pv.r ); } ); // eslint-disable-line\n\tIf( v.g.greaterThan( 0.0 ), () => { v.g.assign( pv.g ); } ); // eslint-disable-line\n\tIf( v.b.greaterThan( 0.0 ), () => { v.b.assign( pv.b ); } ); // eslint-disable-line\n\n\tv.assign( luma.add( v.sub( luma ).mul( saturation ) ) );\n\n\treturn vec4( v.rgb, color.a );\n\n} );\n\nclass PosterizeNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'PosterizeNode';\n\n\t}\n\n\tconstructor( sourceNode, stepsNode ) {\n\n\t\tsuper();\n\n\t\tthis.sourceNode = sourceNode;\n\t\tthis.stepsNode = stepsNode;\n\n\t}\n\n\tsetup() {\n\n\t\tconst { sourceNode, stepsNode } = this;\n\n\t\treturn sourceNode.mul( stepsNode ).floor().div( stepsNode );\n\n\t}\n\n}\n\nconst posterize = /*@__PURE__*/ nodeProxy( PosterizeNode );\n\nlet _sharedFramebuffer = null;\n\nclass ViewportSharedTextureNode extends ViewportTextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'ViewportSharedTextureNode';\n\n\t}\n\n\tconstructor( uvNode = screenUV, levelNode = null ) {\n\n\t\tif ( _sharedFramebuffer === null ) {\n\n\t\t\t_sharedFramebuffer = new FramebufferTexture();\n\n\t\t}\n\n\t\tsuper( uvNode, levelNode, _sharedFramebuffer );\n\n\t}\n\n\tupdateReference() {\n\n\t\treturn this;\n\n\t}\n\n}\n\nconst viewportSharedTexture = /*@__PURE__*/ nodeProxy( ViewportSharedTextureNode );\n\nconst _size = /*@__PURE__*/ new Vector2();\n\nclass PassTextureNode extends TextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'PassTextureNode';\n\n\t}\n\n\tconstructor( passNode, texture ) {\n\n\t\tsuper( texture );\n\n\t\tthis.passNode = passNode;\n\n\t\tthis.setUpdateMatrix( false );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.object.isQuadMesh ) this.passNode.build( builder );\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.passNode, this.value );\n\n\t}\n\n}\n\nclass PassMultipleTextureNode extends PassTextureNode {\n\n\tstatic get type() {\n\n\t\treturn 'PassMultipleTextureNode';\n\n\t}\n\n\tconstructor( passNode, textureName, previousTexture = false ) {\n\n\t\tsuper( passNode, null );\n\n\t\tthis.textureName = textureName;\n\t\tthis.previousTexture = previousTexture;\n\n\t}\n\n\tupdateTexture() {\n\n\t\tthis.value = this.previousTexture ? this.passNode.getPreviousTexture( this.textureName ) : this.passNode.getTexture( this.textureName );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.updateTexture();\n\n\t\treturn super.setup( builder );\n\n\t}\n\n\tclone() {\n\n\t\treturn new this.constructor( this.passNode, this.textureName, this.previousTexture );\n\n\t}\n\n}\n\nclass PassNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'PassNode';\n\n\t}\n\n\tconstructor( scope, scene, camera, options = {} ) {\n\n\t\tsuper( 'vec4' );\n\n\t\tthis.scope = scope;\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\t\tthis.options = options;\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\n\t\tconst depthTexture = new DepthTexture();\n\t\tdepthTexture.isRenderTargetTexture = true;\n\t\t//depthTexture.type = FloatType;\n\t\tdepthTexture.name = 'depth';\n\n\t\tconst renderTarget = new RenderTarget( this._width * this._pixelRatio, this._height * this._pixelRatio, { type: HalfFloatType, ...options, } );\n\t\trenderTarget.texture.name = 'output';\n\t\trenderTarget.depthTexture = depthTexture;\n\n\t\tthis.renderTarget = renderTarget;\n\n\t\tthis.updateBeforeType = NodeUpdateType.FRAME;\n\n\t\tthis._textures = {\n\t\t\toutput: renderTarget.texture,\n\t\t\tdepth: depthTexture\n\t\t};\n\n\t\tthis._textureNodes = {};\n\t\tthis._linearDepthNodes = {};\n\t\tthis._viewZNodes = {};\n\n\t\tthis._previousTextures = {};\n\t\tthis._previousTextureNodes = {};\n\n\t\tthis._cameraNear = uniform( 0 );\n\t\tthis._cameraFar = uniform( 0 );\n\n\t\tthis._mrt = null;\n\n\t\tthis.isPassNode = true;\n\n\t}\n\n\tsetMRT( mrt ) {\n\n\t\tthis._mrt = mrt;\n\n\t\treturn this;\n\n\t}\n\n\tgetMRT() {\n\n\t\treturn this._mrt;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tgetTexture( name ) {\n\n\t\tlet texture = this._textures[ name ];\n\n\t\tif ( texture === undefined ) {\n\n\t\t\tconst refTexture = this.renderTarget.texture;\n\n\t\t\ttexture = refTexture.clone();\n\t\t\ttexture.isRenderTargetTexture = true;\n\t\t\ttexture.name = name;\n\n\t\t\tthis._textures[ name ] = texture;\n\n\t\t\tthis.renderTarget.textures.push( texture );\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tgetPreviousTexture( name ) {\n\n\t\tlet texture = this._previousTextures[ name ];\n\n\t\tif ( texture === undefined ) {\n\n\t\t\ttexture = this.getTexture( name ).clone();\n\t\t\ttexture.isRenderTargetTexture = true;\n\n\t\t\tthis._previousTextures[ name ] = texture;\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\ttoggleTexture( name ) {\n\n\t\tconst prevTexture = this._previousTextures[ name ];\n\n\t\tif ( prevTexture !== undefined ) {\n\n\t\t\tconst texture = this._textures[ name ];\n\n\t\t\tconst index = this.renderTarget.textures.indexOf( texture );\n\t\t\tthis.renderTarget.textures[ index ] = prevTexture;\n\n\t\t\tthis._textures[ name ] = prevTexture;\n\t\t\tthis._previousTextures[ name ] = texture;\n\n\t\t\tthis._textureNodes[ name ].updateTexture();\n\t\t\tthis._previousTextureNodes[ name ].updateTexture();\n\n\t\t}\n\n\t}\n\n\tgetTextureNode( name = 'output' ) {\n\n\t\tlet textureNode = this._textureNodes[ name ];\n\n\t\tif ( textureNode === undefined ) {\n\n\t\t\ttextureNode = nodeObject( new PassMultipleTextureNode( this, name ) );\n\t\t\ttextureNode.updateTexture();\n\t\t\tthis._textureNodes[ name ] = textureNode;\n\n\t\t}\n\n\t\treturn textureNode;\n\n\t}\n\n\tgetPreviousTextureNode( name = 'output' ) {\n\n\t\tlet textureNode = this._previousTextureNodes[ name ];\n\n\t\tif ( textureNode === undefined ) {\n\n\t\t\tif ( this._textureNodes[ name ] === undefined ) this.getTextureNode( name );\n\n\t\t\ttextureNode = nodeObject( new PassMultipleTextureNode( this, name, true ) );\n\t\t\ttextureNode.updateTexture();\n\t\t\tthis._previousTextureNodes[ name ] = textureNode;\n\n\t\t}\n\n\t\treturn textureNode;\n\n\t}\n\n\tgetViewZNode( name = 'depth' ) {\n\n\t\tlet viewZNode = this._viewZNodes[ name ];\n\n\t\tif ( viewZNode === undefined ) {\n\n\t\t\tconst cameraNear = this._cameraNear;\n\t\t\tconst cameraFar = this._cameraFar;\n\n\t\t\tthis._viewZNodes[ name ] = viewZNode = perspectiveDepthToViewZ( this.getTextureNode( name ), cameraNear, cameraFar );\n\n\t\t}\n\n\t\treturn viewZNode;\n\n\t}\n\n\tgetLinearDepthNode( name = 'depth' ) {\n\n\t\tlet linearDepthNode = this._linearDepthNodes[ name ];\n\n\t\tif ( linearDepthNode === undefined ) {\n\n\t\t\tconst cameraNear = this._cameraNear;\n\t\t\tconst cameraFar = this._cameraFar;\n\t\t\tconst viewZNode = this.getViewZNode( name );\n\n\t\t\t// TODO: just if ( builder.camera.isPerspectiveCamera )\n\n\t\t\tthis._linearDepthNodes[ name ] = linearDepthNode = viewZToOrthographicDepth( viewZNode, cameraNear, cameraFar );\n\n\t\t}\n\n\t\treturn linearDepthNode;\n\n\t}\n\n\tsetup( { renderer } ) {\n\n\t\tthis.renderTarget.samples = this.options.samples === undefined ? renderer.samples : this.options.samples;\n\n\t\t// Disable MSAA for WebGL backend for now\n\t\tif ( renderer.backend.isWebGLBackend === true ) {\n\n\t\t\tthis.renderTarget.samples = 0;\n\n\t\t}\n\n\t\tthis.renderTarget.depthTexture.isMultisampleRenderTargetTexture = this.renderTarget.samples > 1;\n\n\t\treturn this.scope === PassNode.COLOR ? this.getTextureNode() : this.getLinearDepthNode();\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\t\tconst { scene, camera } = this;\n\n\t\tthis._pixelRatio = renderer.getPixelRatio();\n\n\t\tconst size = renderer.getSize( _size );\n\n\t\tthis.setSize( size.width, size.height );\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentMRT = renderer.getMRT();\n\n\t\tthis._cameraNear.value = camera.near;\n\t\tthis._cameraFar.value = camera.far;\n\n\t\tfor ( const name in this._previousTextures ) {\n\n\t\t\tthis.toggleTexture( name );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( this.renderTarget );\n\t\trenderer.setMRT( this._mrt );\n\n\t\trenderer.render( scene, camera );\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\t\trenderer.setMRT( currentMRT );\n\n\t}\n\n\tsetSize( width, height ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tconst effectiveWidth = this._width * this._pixelRatio;\n\t\tconst effectiveHeight = this._height * this._pixelRatio;\n\n\t\tthis.renderTarget.setSize( effectiveWidth, effectiveHeight );\n\n\t}\n\n\tsetPixelRatio( pixelRatio ) {\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.setSize( this._width, this._height );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.renderTarget.dispose();\n\n\t}\n\n\n}\n\nPassNode.COLOR = 'color';\nPassNode.DEPTH = 'depth';\n\nconst pass = ( scene, camera, options ) => nodeObject( new PassNode( PassNode.COLOR, scene, camera, options ) );\nconst passTexture = ( pass, texture ) => nodeObject( new PassTextureNode( pass, texture ) );\nconst depthPass = ( scene, camera ) => nodeObject( new PassNode( PassNode.DEPTH, scene, camera ) );\n\nclass ToonOutlinePassNode extends PassNode {\n\n\tstatic get type() {\n\n\t\treturn 'ToonOutlinePassNode';\n\n\t}\n\n\tconstructor( scene, camera, colorNode, thicknessNode, alphaNode ) {\n\n\t\tsuper( PassNode.COLOR, scene, camera );\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.thicknessNode = thicknessNode;\n\t\tthis.alphaNode = alphaNode;\n\n\t\tthis._materialCache = new WeakMap();\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { renderer } = frame;\n\n\t\tconst currentRenderObjectFunction = renderer.getRenderObjectFunction();\n\n\t\trenderer.setRenderObjectFunction( ( object, scene, camera, geometry, material, group, lightsNode ) => {\n\n\t\t\t// only render outline for supported materials\n\n\t\t\tif ( material.isMeshToonMaterial || material.isMeshToonNodeMaterial ) {\n\n\t\t\t\tif ( material.wireframe === false ) {\n\n\t\t\t\t\tconst outlineMaterial = this._getOutlineMaterial( material );\n\t\t\t\t\trenderer.renderObject( object, scene, camera, geometry, outlineMaterial, group, lightsNode );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// default\n\n\t\t\trenderer.renderObject( object, scene, camera, geometry, material, group, lightsNode );\n\n\t\t} );\n\n\t\tsuper.updateBefore( frame );\n\n\t\trenderer.setRenderObjectFunction( currentRenderObjectFunction );\n\n\t}\n\n\t_createMaterial() {\n\n\t\tconst material = new NodeMaterial();\n\t\tmaterial.isMeshToonOutlineMaterial = true;\n\t\tmaterial.name = 'Toon_Outline';\n\t\tmaterial.side = BackSide;\n\n\t\t// vertex node\n\n\t\tconst outlineNormal = normalLocal.negate();\n\t\tconst mvp = cameraProjectionMatrix.mul( modelViewMatrix );\n\n\t\tconst ratio = float( 1.0 ); // TODO: support outline thickness ratio for each vertex\n\t\tconst pos = mvp.mul( vec4( positionLocal, 1.0 ) );\n\t\tconst pos2 = mvp.mul( vec4( positionLocal.add( outlineNormal ), 1.0 ) );\n\t\tconst norm = normalize( pos.sub( pos2 ) ); // NOTE: subtract pos2 from pos because BackSide objectNormal is negative\n\n\t\tmaterial.vertexNode = pos.add( norm.mul( this.thicknessNode ).mul( pos.w ).mul( ratio ) );\n\n\t\t// color node\n\n\t\tmaterial.colorNode = vec4( this.colorNode, this.alphaNode );\n\n\t\treturn material;\n\n\t}\n\n\t_getOutlineMaterial( originalMaterial ) {\n\n\t\tlet outlineMaterial = this._materialCache.get( originalMaterial );\n\n\t\tif ( outlineMaterial === undefined ) {\n\n\t\t\toutlineMaterial = this._createMaterial();\n\n\t\t\tthis._materialCache.set( originalMaterial, outlineMaterial );\n\n\t\t}\n\n\t\treturn outlineMaterial;\n\n\t}\n\n}\n\nconst toonOutlinePass = ( scene, camera, color = new Color( 0, 0, 0 ), thickness = 0.003, alpha = 1 ) => nodeObject( new ToonOutlinePassNode( scene, camera, nodeObject( color ), nodeObject( thickness ), nodeObject( alpha ) ) );\n\n// exposure only\n\nconst linearToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\treturn color.mul( exposure ).clamp();\n\n} ).setLayout( {\n\tname: 'linearToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\n\nconst reinhardToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\tcolor = color.mul( exposure );\n\n\treturn color.div( color.add( 1.0 ) ).clamp();\n\n} ).setLayout( {\n\tname: 'reinhardToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\n\nconst cineonToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\t// filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor = color.mul( exposure );\n\tcolor = color.sub( 0.004 ).max( 0.0 );\n\n\tconst a = color.mul( color.mul( 6.2 ).add( 0.5 ) );\n\tconst b = color.mul( color.mul( 6.2 ).add( 1.7 ) ).add( 0.06 );\n\n\treturn a.div( b ).pow( 2.2 );\n\n} ).setLayout( {\n\tname: 'cineonToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\n\nconst RRTAndODTFit = /*@__PURE__*/ Fn( ( [ color ] ) => {\n\n\tconst a = color.mul( color.add( 0.0245786 ) ).sub( 0.000090537 );\n\tconst b = color.mul( color.add( 0.4329510 ).mul( 0.983729 ) ).add( 0.238081 );\n\n\treturn a.div( b );\n\n} );\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\n\nconst acesFilmicToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n\tconst ACESInputMat = mat3(\n\t\t0.59719, 0.35458, 0.04823,\n\t\t0.07600, 0.90834, 0.01566,\n\t\t0.02840, 0.13383, 0.83777\n\t);\n\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\n\tconst ACESOutputMat = mat3(\n\t\t1.60475, - 0.53108, - 0.07367,\n\t\t- 0.10208, 1.10813, - 0.00605,\n\t\t- 0.00327, - 0.07276, 1.07602\n\t);\n\n\tcolor = color.mul( exposure ).div( 0.6 );\n\n\tcolor = ACESInputMat.mul( color );\n\n\t// Apply RRT and ODT\n\tcolor = RRTAndODTFit( color );\n\n\tcolor = ACESOutputMat.mul( color );\n\n\t// Clamp to [0, 1]\n\treturn color.clamp();\n\n} ).setLayout( {\n\tname: 'acesFilmicToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\nconst LINEAR_REC2020_TO_LINEAR_SRGB = /*@__PURE__*/ mat3( vec3( 1.6605, - 0.1246, - 0.0182 ), vec3( - 0.5876, 1.1329, - 0.1006 ), vec3( - 0.0728, - 0.0083, 1.1187 ) );\nconst LINEAR_SRGB_TO_LINEAR_REC2020 = /*@__PURE__*/ mat3( vec3( 0.6274, 0.0691, 0.0164 ), vec3( 0.3293, 0.9195, 0.0880 ), vec3( 0.0433, 0.0113, 0.8956 ) );\n\nconst agxDefaultContrastApprox = /*@__PURE__*/ Fn( ( [ x_immutable ] ) => {\n\n\tconst x = vec3( x_immutable ).toVar();\n\tconst x2 = vec3( x.mul( x ) ).toVar();\n\tconst x4 = vec3( x2.mul( x2 ) ).toVar();\n\n\treturn float( 15.5 ).mul( x4.mul( x2 ) ).sub( mul( 40.14, x4.mul( x ) ) ).add( mul( 31.96, x4 ).sub( mul( 6.868, x2.mul( x ) ) ).add( mul( 0.4298, x2 ).add( mul( 0.1191, x ).sub( 0.00232 ) ) ) );\n\n} );\n\nconst agxToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\tconst colortone = vec3( color ).toVar();\n\tconst AgXInsetMatrix = mat3( vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ), vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ), vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 ) );\n\tconst AgXOutsetMatrix = mat3( vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ), vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ), vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 ) );\n\tconst AgxMinEv = float( - 12.47393 );\n\tconst AgxMaxEv = float( 4.026069 );\n\tcolortone.mulAssign( exposure );\n\tcolortone.assign( LINEAR_SRGB_TO_LINEAR_REC2020.mul( colortone ) );\n\tcolortone.assign( AgXInsetMatrix.mul( colortone ) );\n\tcolortone.assign( max$1( colortone, 1e-10 ) );\n\tcolortone.assign( log2( colortone ) );\n\tcolortone.assign( colortone.sub( AgxMinEv ).div( AgxMaxEv.sub( AgxMinEv ) ) );\n\tcolortone.assign( clamp( colortone, 0.0, 1.0 ) );\n\tcolortone.assign( agxDefaultContrastApprox( colortone ) );\n\tcolortone.assign( AgXOutsetMatrix.mul( colortone ) );\n\tcolortone.assign( pow( max$1( vec3( 0.0 ), colortone ), vec3( 2.2 ) ) );\n\tcolortone.assign( LINEAR_REC2020_TO_LINEAR_SRGB.mul( colortone ) );\n\tcolortone.assign( clamp( colortone, 0.0, 1.0 ) );\n\n\treturn colortone;\n\n} ).setLayout( {\n\tname: 'agxToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\n// https://modelviewer.dev/examples/tone-mapping\n\nconst neutralToneMapping = /*@__PURE__*/ Fn( ( [ color, exposure ] ) => {\n\n\tconst StartCompression = float( 0.8 - 0.04 );\n\tconst Desaturation = float( 0.15 );\n\n\tcolor = color.mul( exposure );\n\n\tconst x = min$1( color.r, min$1( color.g, color.b ) );\n\tconst offset = select( x.lessThan( 0.08 ), x.sub( mul( 6.25, x.mul( x ) ) ), 0.04 );\n\n\tcolor.subAssign( offset );\n\n\tconst peak = max$1( color.r, max$1( color.g, color.b ) );\n\n\tIf( peak.lessThan( StartCompression ), () => {\n\n\t\treturn color;\n\n\t} );\n\n\tconst d = sub( 1, StartCompression );\n\tconst newPeak = sub( 1, d.mul( d ).div( peak.add( d.sub( StartCompression ) ) ) );\n\tcolor.mulAssign( newPeak.div( peak ) );\n\tconst g = sub( 1, div( 1, Desaturation.mul( peak.sub( newPeak ) ).add( 1 ) ) );\n\n\treturn mix( color, vec3( newPeak ), g );\n\n} ).setLayout( {\n\tname: 'neutralToneMapping',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' },\n\t\t{ name: 'exposure', type: 'float' }\n\t]\n} );\n\nclass CodeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'CodeNode';\n\n\t}\n\n\tconstructor( code = '', includes = [], language = '' ) {\n\n\t\tsuper( 'code' );\n\n\t\tthis.isCodeNode = true;\n\n\t\tthis.code = code;\n\t\tthis.language = language;\n\n\t\tthis.includes = includes;\n\n\t}\n\n\tisGlobal() {\n\n\t\treturn true;\n\n\t}\n\n\tsetIncludes( includes ) {\n\n\t\tthis.includes = includes;\n\n\t\treturn this;\n\n\t}\n\n\tgetIncludes( /*builder*/ ) {\n\n\t\treturn this.includes;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst includes = this.getIncludes( builder );\n\n\t\tfor ( const include of includes ) {\n\n\t\t\tinclude.build( builder );\n\n\t\t}\n\n\t\tconst nodeCode = builder.getCodeFromNode( this, this.getNodeType( builder ) );\n\t\tnodeCode.code = this.code;\n\n\t\treturn nodeCode.code;\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.code = this.code;\n\t\tdata.language = this.language;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.code = data.code;\n\t\tthis.language = data.language;\n\n\t}\n\n}\n\nconst code = /*@__PURE__*/ nodeProxy( CodeNode );\n\nconst js = ( src, includes ) => code( src, includes, 'js' );\nconst wgsl = ( src, includes ) => code( src, includes, 'wgsl' );\nconst glsl = ( src, includes ) => code( src, includes, 'glsl' );\n\nclass FunctionNode extends CodeNode {\n\n\tstatic get type() {\n\n\t\treturn 'FunctionNode';\n\n\t}\n\n\tconstructor( code = '', includes = [], language = '' ) {\n\n\t\tsuper( code, includes, language );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getNodeFunction( builder ).type;\n\n\t}\n\n\tgetInputs( builder ) {\n\n\t\treturn this.getNodeFunction( builder ).inputs;\n\n\t}\n\n\tgetNodeFunction( builder ) {\n\n\t\tconst nodeData = builder.getDataFromNode( this );\n\n\t\tlet nodeFunction = nodeData.nodeFunction;\n\n\t\tif ( nodeFunction === undefined ) {\n\n\t\t\tnodeFunction = builder.parser.parseFunction( this.code );\n\n\t\t\tnodeData.nodeFunction = nodeFunction;\n\n\t\t}\n\n\t\treturn nodeFunction;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tsuper.generate( builder );\n\n\t\tconst nodeFunction = this.getNodeFunction( builder );\n\n\t\tconst name = nodeFunction.name;\n\t\tconst type = nodeFunction.type;\n\n\t\tconst nodeCode = builder.getCodeFromNode( this, type );\n\n\t\tif ( name !== '' ) {\n\n\t\t\t// use a custom property name\n\n\t\t\tnodeCode.name = name;\n\n\t\t}\n\n\t\tconst propertyName = builder.getPropertyName( nodeCode );\n\n\t\tconst code = this.getNodeFunction( builder ).getCode( propertyName );\n\n\t\tnodeCode.code = code + '\\n';\n\n\t\tif ( output === 'property' ) {\n\n\t\t\treturn propertyName;\n\n\t\t} else {\n\n\t\t\treturn builder.format( `${ propertyName }()`, type, output );\n\n\t\t}\n\n\t}\n\n}\n\nconst nativeFn = ( code, includes = [], language = '' ) => {\n\n\tfor ( let i = 0; i < includes.length; i ++ ) {\n\n\t\tconst include = includes[ i ];\n\n\t\t// TSL Function: glslFn, wgslFn\n\n\t\tif ( typeof include === 'function' ) {\n\n\t\t\tincludes[ i ] = include.functionNode;\n\n\t\t}\n\n\t}\n\n\tconst functionNode = nodeObject( new FunctionNode( code, includes, language ) );\n\n\tconst fn = ( ...params ) => functionNode.call( ...params );\n\tfn.functionNode = functionNode;\n\n\treturn fn;\n\n};\n\nconst glslFn = ( code, includes ) => nativeFn( code, includes, 'glsl' );\nconst wgslFn = ( code, includes ) => nativeFn( code, includes, 'wgsl' );\n\nclass ScriptableValueNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ScriptableValueNode';\n\n\t}\n\n\tconstructor( value = null ) {\n\n\t\tsuper();\n\n\t\tthis._value = value;\n\t\tthis._cache = null;\n\n\t\tthis.inputType = null;\n\t\tthis.outpuType = null;\n\n\t\tthis.events = new EventDispatcher();\n\n\t\tthis.isScriptableValueNode = true;\n\n\t}\n\n\tget isScriptableOutputNode() {\n\n\t\treturn this.outputType !== null;\n\n\t}\n\n\tset value( val ) {\n\n\t\tif ( this._value === val ) return;\n\n\t\tif ( this._cache && this.inputType === 'URL' && this.value.value instanceof ArrayBuffer ) {\n\n\t\t\tURL.revokeObjectURL( this._cache );\n\n\t\t\tthis._cache = null;\n\n\t\t}\n\n\t\tthis._value = val;\n\n\t\tthis.events.dispatchEvent( { type: 'change' } );\n\n\t\tthis.refresh();\n\n\t}\n\n\tget value() {\n\n\t\treturn this._value;\n\n\t}\n\n\trefresh() {\n\n\t\tthis.events.dispatchEvent( { type: 'refresh' } );\n\n\t}\n\n\tgetValue() {\n\n\t\tconst value = this.value;\n\n\t\tif ( value && this._cache === null && this.inputType === 'URL' && value.value instanceof ArrayBuffer ) {\n\n\t\t\tthis._cache = URL.createObjectURL( new Blob( [ value.value ] ) );\n\n\t\t} else if ( value && value.value !== null && value.value !== undefined && (\n\t\t\t( ( this.inputType === 'URL' || this.inputType === 'String' ) && typeof value.value === 'string' ) ||\n\t\t\t( this.inputType === 'Number' && typeof value.value === 'number' ) ||\n\t\t\t( this.inputType === 'Vector2' && value.value.isVector2 ) ||\n\t\t\t( this.inputType === 'Vector3' && value.value.isVector3 ) ||\n\t\t\t( this.inputType === 'Vector4' && value.value.isVector4 ) ||\n\t\t\t( this.inputType === 'Color' && value.value.isColor ) ||\n\t\t\t( this.inputType === 'Matrix3' && value.value.isMatrix3 ) ||\n\t\t\t( this.inputType === 'Matrix4' && value.value.isMatrix4 )\n\t\t) ) {\n\n\t\t\treturn value.value;\n\n\t\t}\n\n\t\treturn this._cache || value;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.value && this.value.isNode ? this.value.getNodeType( builder ) : 'float';\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.value && this.value.isNode ? this.value : float();\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tif ( this.value !== null ) {\n\n\t\t\tif ( this.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tdata.value = arrayBufferToBase64( this.value );\n\n\t\t\t} else {\n\n\t\t\t\tdata.value = this.value ? this.value.toJSON( data.meta ).uuid : null;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdata.value = null;\n\n\t\t}\n\n\t\tdata.inputType = this.inputType;\n\t\tdata.outputType = this.outputType;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tlet value = null;\n\n\t\tif ( data.value !== null ) {\n\n\t\t\tif ( data.inputType === 'ArrayBuffer' ) {\n\n\t\t\t\tvalue = base64ToArrayBuffer( data.value );\n\n\t\t\t} else if ( data.inputType === 'Texture' ) {\n\n\t\t\t\tvalue = data.meta.textures[ data.value ];\n\n\t\t\t} else {\n\n\t\t\t\tvalue = data.meta.nodes[ data.value ] || null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.value = value;\n\n\t\tthis.inputType = data.inputType;\n\t\tthis.outputType = data.outputType;\n\n\t}\n\n}\n\nconst scriptableValue = /*@__PURE__*/ nodeProxy( ScriptableValueNode );\n\nclass Resources extends Map {\n\n\tget( key, callback = null, ...params ) {\n\n\t\tif ( this.has( key ) ) return super.get( key );\n\n\t\tif ( callback !== null ) {\n\n\t\t\tconst value = callback( ...params );\n\t\t\tthis.set( key, value );\n\t\t\treturn value;\n\n\t\t}\n\n\t}\n\n}\n\nclass Parameters {\n\n\tconstructor( scriptableNode ) {\n\n\t\tthis.scriptableNode = scriptableNode;\n\n\t}\n\n\tget parameters() {\n\n\t\treturn this.scriptableNode.parameters;\n\n\t}\n\n\tget layout() {\n\n\t\treturn this.scriptableNode.getLayout();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\treturn this.scriptableNode.getInputLayout( id );\n\n\t}\n\n\tget( name ) {\n\n\t\tconst param = this.parameters[ name ];\n\t\tconst value = param ? param.getValue() : null;\n\n\t\treturn value;\n\n\t}\n\n}\n\nconst ScriptableNodeResources = new Resources();\n\nclass ScriptableNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ScriptableNode';\n\n\t}\n\n\tconstructor( codeNode = null, parameters = {} ) {\n\n\t\tsuper();\n\n\t\tthis.codeNode = codeNode;\n\t\tthis.parameters = parameters;\n\n\t\tthis._local = new Resources();\n\t\tthis._output = scriptableValue();\n\t\tthis._outputs = {};\n\t\tthis._source = this.source;\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\n\t\tthis.onRefresh = this.onRefresh.bind( this );\n\n\t\tthis.isScriptableNode = true;\n\n\t}\n\n\tget source() {\n\n\t\treturn this.codeNode ? this.codeNode.code : '';\n\n\t}\n\n\tsetLocal( name, value ) {\n\n\t\treturn this._local.set( name, value );\n\n\t}\n\n\tgetLocal( name ) {\n\n\t\treturn this._local.get( name );\n\n\t}\n\n\tonRefresh() {\n\n\t\tthis._refresh();\n\n\t}\n\n\tgetInputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.inputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetOutputLayout( id ) {\n\n\t\tfor ( const element of this.getLayout() ) {\n\n\t\t\tif ( element.outputType && ( element.id === id || element.name === id ) ) {\n\n\t\t\t\treturn element;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tsetOutput( name, value ) {\n\n\t\tconst outputs = this._outputs;\n\n\t\tif ( outputs[ name ] === undefined ) {\n\n\t\t\toutputs[ name ] = scriptableValue( value );\n\n\t\t} else {\n\n\t\t\toutputs[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetOutput( name ) {\n\n\t\treturn this._outputs[ name ];\n\n\t}\n\n\tgetParameter( name ) {\n\n\t\treturn this.parameters[ name ];\n\n\t}\n\n\tsetParameter( name, value ) {\n\n\t\tconst parameters = this.parameters;\n\n\t\tif ( value && value.isScriptableNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].getDefaultOutput().events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( value && value.isScriptableValueNode ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t\tparameters[ name ] = value;\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else if ( parameters[ name ] === undefined ) {\n\n\t\t\tparameters[ name ] = scriptableValue( value );\n\t\t\tparameters[ name ].events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t} else {\n\n\t\t\tparameters[ name ].value = value;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.getDefaultOutput().getValue();\n\n\t}\n\n\tdeleteParameter( name ) {\n\n\t\tlet valueNode = this.parameters[ name ];\n\n\t\tif ( valueNode ) {\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.removeEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tclearParameters() {\n\n\t\tfor ( const name of Object.keys( this.parameters ) ) {\n\n\t\t\tthis.deleteParameter( name );\n\n\t\t}\n\n\t\tthis.needsUpdate = true;\n\n\t\treturn this;\n\n\t}\n\n\tcall( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method( ...params );\n\n\t\t}\n\n\t}\n\n\tasync callAsync( name, ...params ) {\n\n\t\tconst object = this.getObject();\n\t\tconst method = object[ name ];\n\n\t\tif ( typeof method === 'function' ) {\n\n\t\t\treturn method.constructor.name === 'AsyncFunction' ? await method( ...params ) : method( ...params );\n\n\t\t}\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getDefaultOutputNode().getNodeType( builder );\n\n\t}\n\n\trefresh( output = null ) {\n\n\t\tif ( output !== null ) {\n\n\t\t\tthis.getOutput( output ).refresh();\n\n\t\t} else {\n\n\t\t\tthis._refresh();\n\n\t\t}\n\n\t}\n\n\tgetObject() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._object !== null ) return this._object;\n\n\t\t//\n\n\t\tconst refresh = () => this.refresh();\n\t\tconst setOutput = ( id, value ) => this.setOutput( id, value );\n\n\t\tconst parameters = new Parameters( this );\n\n\t\tconst THREE = ScriptableNodeResources.get( 'THREE' );\n\t\tconst TSL = ScriptableNodeResources.get( 'TSL' );\n\n\t\tconst method = this.getMethod( this.codeNode );\n\t\tconst params = [ parameters, this._local, ScriptableNodeResources, refresh, setOutput, THREE, TSL ];\n\n\t\tthis._object = method( ...params );\n\n\t\tconst layout = this._object.layout;\n\n\t\tif ( layout ) {\n\n\t\t\tif ( layout.cache === false ) {\n\n\t\t\t\tthis._local.clear();\n\n\t\t\t}\n\n\t\t\t// default output\n\t\t\tthis._output.outputType = layout.outputType || null;\n\n\t\t\tif ( Array.isArray( layout.elements ) ) {\n\n\t\t\t\tfor ( const element of layout.elements ) {\n\n\t\t\t\t\tconst id = element.id || element.name;\n\n\t\t\t\t\tif ( element.inputType ) {\n\n\t\t\t\t\t\tif ( this.getParameter( id ) === undefined ) this.setParameter( id, null );\n\n\t\t\t\t\t\tthis.getParameter( id ).inputType = element.inputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.outputType ) {\n\n\t\t\t\t\t\tif ( this.getOutput( id ) === undefined ) this.setOutput( id, null );\n\n\t\t\t\t\t\tthis.getOutput( id ).outputType = element.outputType;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn this._object;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tfor ( const name in this.parameters ) {\n\n\t\t\tlet valueNode = this.parameters[ name ];\n\n\t\t\tif ( valueNode.isScriptableNode ) valueNode = valueNode.getDefaultOutput();\n\n\t\t\tvalueNode.events.addEventListener( 'refresh', this.onRefresh );\n\n\t\t}\n\n\t}\n\n\tgetLayout() {\n\n\t\treturn this.getObject().layout;\n\n\t}\n\n\tgetDefaultOutputNode() {\n\n\t\tconst output = this.getDefaultOutput().value;\n\n\t\tif ( output && output.isNode ) {\n\n\t\t\treturn output;\n\n\t\t}\n\n\t\treturn float();\n\n\t}\n\n\tgetDefaultOutput()\t{\n\n\t\treturn this._exec()._output;\n\n\t}\n\n\tgetMethod() {\n\n\t\tif ( this.needsUpdate ) this.dispose();\n\t\tif ( this._method !== null ) return this._method;\n\n\t\t//\n\n\t\tconst parametersProps = [ 'parameters', 'local', 'global', 'refresh', 'setOutput', 'THREE', 'TSL' ];\n\t\tconst interfaceProps = [ 'layout', 'init', 'main', 'dispose' ];\n\n\t\tconst properties = interfaceProps.join( ', ' );\n\t\tconst declarations = 'var ' + properties + '; var output = {};\\n';\n\t\tconst returns = '\\nreturn { ...output, ' + properties + ' };';\n\n\t\tconst code = declarations + this.codeNode.code + returns;\n\n\t\t//\n\n\t\tthis._method = new Function( ...parametersProps, code );\n\n\t\treturn this._method;\n\n\t}\n\n\tdispose() {\n\n\t\tif ( this._method === null ) return;\n\n\t\tif ( this._object && typeof this._object.dispose === 'function' ) {\n\n\t\t\tthis._object.dispose();\n\n\t\t}\n\n\t\tthis._method = null;\n\t\tthis._object = null;\n\t\tthis._source = null;\n\t\tthis._value = null;\n\t\tthis._needsOutputUpdate = true;\n\t\tthis._output.value = null;\n\t\tthis._outputs = {};\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.getDefaultOutputNode();\n\n\t}\n\n\tgetCacheKey( force ) {\n\n\t\tconst values = [ hashString( this.source ), this.getDefaultOutputNode().getCacheKey( force ) ];\n\n\t\tfor ( const param in this.parameters ) {\n\n\t\t\tvalues.push( this.parameters[ param ].getCacheKey( force ) );\n\n\t\t}\n\n\t\treturn hashArray( values );\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.dispose();\n\n\t}\n\n\tget needsUpdate() {\n\n\t\treturn this.source !== this._source;\n\n\t}\n\n\t_exec()\t{\n\n\t\tif ( this.codeNode === null ) return this;\n\n\t\tif ( this._needsOutputUpdate === true ) {\n\n\t\t\tthis._value = this.call( 'main' );\n\n\t\t\tthis._needsOutputUpdate = false;\n\n\t\t}\n\n\t\tthis._output.value = this._value;\n\n\t\treturn this;\n\n\t}\n\n\t_refresh() {\n\n\t\tthis.needsUpdate = true;\n\n\t\tthis._exec();\n\n\t\tthis._output.refresh();\n\n\t}\n\n}\n\nconst scriptable = /*@__PURE__*/ nodeProxy( ScriptableNode );\n\nclass FogNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'FogNode';\n\n\t}\n\n\tconstructor( colorNode, factorNode ) {\n\n\t\tsuper( 'float' );\n\n\t\tthis.isFogNode = true;\n\n\t\tthis.colorNode = colorNode;\n\t\tthis.factorNode = factorNode;\n\n\t}\n\n\tgetViewZNode( builder ) {\n\n\t\tlet viewZ;\n\n\t\tconst getViewZ = builder.context.getViewZ;\n\n\t\tif ( getViewZ !== undefined ) {\n\n\t\t\tviewZ = getViewZ( this );\n\n\t\t}\n\n\t\treturn ( viewZ || positionView.z ).negate();\n\n\t}\n\n\tsetup() {\n\n\t\treturn this.factorNode;\n\n\t}\n\n}\n\nconst fog = /*@__PURE__*/ nodeProxy( FogNode );\n\nclass FogRangeNode extends FogNode {\n\n\tstatic get type() {\n\n\t\treturn 'FogRangeNode';\n\n\t}\n\n\tconstructor( colorNode, nearNode, farNode ) {\n\n\t\tsuper( colorNode );\n\n\t\tthis.isFogRangeNode = true;\n\n\t\tthis.nearNode = nearNode;\n\t\tthis.farNode = farNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst viewZ = this.getViewZNode( builder );\n\n\t\treturn smoothstep( this.nearNode, this.farNode, viewZ );\n\n\t}\n\n}\n\nconst rangeFog = /*@__PURE__*/ nodeProxy( FogRangeNode );\n\nclass FogExp2Node extends FogNode {\n\n\tstatic get type() {\n\n\t\treturn 'FogExp2Node';\n\n\t}\n\n\tconstructor( colorNode, densityNode ) {\n\n\t\tsuper( colorNode );\n\n\t\tthis.isFogExp2Node = true;\n\n\t\tthis.densityNode = densityNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst viewZ = this.getViewZNode( builder );\n\t\tconst density = this.densityNode;\n\n\t\treturn density.mul( density, viewZ, viewZ ).negate().exp().oneMinus();\n\n\t}\n\n}\n\nconst densityFog = /*@__PURE__*/ nodeProxy( FogExp2Node );\n\nlet min = null;\nlet max = null;\n\nclass RangeNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'RangeNode';\n\n\t}\n\n\tconstructor( minNode = float(), maxNode = float() ) {\n\n\t\tsuper();\n\n\t\tthis.minNode = minNode;\n\t\tthis.maxNode = maxNode;\n\n\t}\n\n\tgetVectorLength( builder ) {\n\n\t\tconst minLength = builder.getTypeLength( getValueType( this.minNode.value ) );\n\t\tconst maxLength = builder.getTypeLength( getValueType( this.maxNode.value ) );\n\n\t\treturn minLength > maxLength ? minLength : maxLength;\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn builder.object.count > 1 ? builder.getTypeFromLength( this.getVectorLength( builder ) ) : 'float';\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst object = builder.object;\n\n\t\tlet output = null;\n\n\t\tif ( object.count > 1 ) {\n\n\t\t\tconst minValue = this.minNode.value;\n\t\t\tconst maxValue = this.maxNode.value;\n\n\t\t\tconst minLength = builder.getTypeLength( getValueType( minValue ) );\n\t\t\tconst maxLength = builder.getTypeLength( getValueType( maxValue ) );\n\n\t\t\tmin = min || new Vector4();\n\t\t\tmax = max || new Vector4();\n\n\t\t\tmin.setScalar( 0 );\n\t\t\tmax.setScalar( 0 );\n\n\t\t\tif ( minLength === 1 ) min.setScalar( minValue );\n\t\t\telse if ( minValue.isColor ) min.set( minValue.r, minValue.g, minValue.b );\n\t\t\telse min.set( minValue.x, minValue.y, minValue.z || 0, minValue.w || 0 );\n\n\t\t\tif ( maxLength === 1 ) max.setScalar( maxValue );\n\t\t\telse if ( maxValue.isColor ) max.set( maxValue.r, maxValue.g, maxValue.b );\n\t\t\telse max.set( maxValue.x, maxValue.y, maxValue.z || 0, maxValue.w || 0 );\n\n\t\t\tconst stride = 4;\n\n\t\t\tconst length = stride * object.count;\n\t\t\tconst array = new Float32Array( length );\n\n\t\t\tfor ( let i = 0; i < length; i ++ ) {\n\n\t\t\t\tconst index = i % stride;\n\n\t\t\t\tconst minElementValue = min.getComponent( index );\n\t\t\t\tconst maxElementValue = max.getComponent( index );\n\n\t\t\t\tarray[ i ] = MathUtils.lerp( minElementValue, maxElementValue, Math.random() );\n\n\t\t\t}\n\n\t\t\tconst nodeType = this.getNodeType( builder );\n\n\t\t\tif ( object.count <= 4096 ) {\n\n\t\t\t\toutput = buffer( array, 'vec4', object.count ).element( instanceIndex ).convert( nodeType );\n\n\t\t\t} else {\n\n\t\t\t\t// TODO: Improve anonymous buffer attribute creation removing this part\n\t\t\t\tconst bufferAttribute = new InstancedBufferAttribute( array, 4 );\n\t\t\t\tbuilder.geometry.setAttribute( '__range' + this.id, bufferAttribute );\n\n\t\t\t\toutput = instancedBufferAttribute( bufferAttribute ).convert( nodeType );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\toutput = float( 0 );\n\n\t\t}\n\n\t\treturn output;\n\n\t}\n\n}\n\nconst range = /*@__PURE__*/ nodeProxy( RangeNode );\n\nclass ComputeBuiltinNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ComputeBuiltinNode';\n\n\t}\n\n\tconstructor( builtinName, nodeType ) {\n\n\t\tsuper( nodeType );\n\n\t\tthis._builtinName = builtinName;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\treturn this.getBuiltinName( builder );\n\n\t}\n\n\tgetNodeType( /*builder*/ ) {\n\n\t\treturn this.nodeType;\n\n\t}\n\n\tsetBuiltinName( builtinName ) {\n\n\t\tthis._builtinName = builtinName;\n\n\t\treturn this;\n\n\t}\n\n\tgetBuiltinName( /*builder*/ ) {\n\n\t\treturn this._builtinName;\n\n\t}\n\n\thasBuiltin( builder ) {\n\n\t\tbuilder.hasBuiltin( this._builtinName );\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tconst builtinName = this.getBuiltinName( builder );\n\t\tconst nodeType = this.getNodeType( builder );\n\n\t\tif ( builder.shaderStage === 'compute' ) {\n\n\t\t\treturn builder.format( builtinName, nodeType, output );\n\n\t\t} else {\n\n\t\t\tconsole.warn( `ComputeBuiltinNode: Compute built-in value ${builtinName} can not be accessed in the ${builder.shaderStage} stage` );\n\t\t\treturn builder.generateConst( nodeType );\n\n\t\t}\n\n\t}\n\n\tserialize( data ) {\n\n\t\tsuper.serialize( data );\n\n\t\tdata.global = this.global;\n\t\tdata._builtinName = this._builtinName;\n\n\t}\n\n\tdeserialize( data ) {\n\n\t\tsuper.deserialize( data );\n\n\t\tthis.global = data.global;\n\t\tthis._builtinName = data._builtinName;\n\n\t}\n\n}\n\nconst computeBuiltin = ( name, nodeType ) => nodeObject( new ComputeBuiltinNode( name, nodeType ) );\n\nconst numWorkgroups = /*@__PURE__*/ computeBuiltin( 'numWorkgroups', 'uvec3' );\nconst workgroupId = /*@__PURE__*/ computeBuiltin( 'workgroupId', 'uvec3' );\nconst localId = /*@__PURE__*/ computeBuiltin( 'localId', 'uvec3' );\nconst subgroupSize = /*@__PURE__*/ computeBuiltin( 'subgroupSize', 'uint' );\n\nclass BarrierNode extends Node {\n\n\tconstructor( scope ) {\n\n\t\tsuper();\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst { scope } = this;\n\t\tconst { renderer } = builder;\n\n\t\tif ( renderer.backend.isWebGLBackend === true ) {\n\n\t\t\tbuilder.addFlowCode( `\\t// ${scope}Barrier \\n` );\n\n\t\t} else {\n\n\t\t\tbuilder.addLineFlowCode( `${scope}Barrier()`, this );\n\n\t\t}\n\n\t}\n\n}\n\nconst barrier = nodeProxy( BarrierNode );\n\nconst workgroupBarrier = () => barrier( 'workgroup' ).append();\nconst storageBarrier = () => barrier( 'storage' ).append();\nconst textureBarrier = () => barrier( 'texture' ).append();\n\nclass WorkgroupInfoElementNode extends ArrayElementNode {\n\n\tconstructor( workgroupInfoNode, indexNode ) {\n\n\t\tsuper( workgroupInfoNode, indexNode );\n\n\t\tthis.isWorkgroupInfoElementNode = true;\n\n\t}\n\n\tgenerate( builder, output ) {\n\n\t\tlet snippet;\n\n\t\tconst isAssignContext = builder.context.assign;\n\t\tsnippet = super.generate( builder );\n\n\t\tif ( isAssignContext !== true ) {\n\n\t\t\tconst type = this.getNodeType( builder );\n\n\t\t\tsnippet = builder.format( snippet, type, output );\n\n\t\t}\n\n\t\t// TODO: Possibly activate clip distance index on index access rather than from clipping context\n\n\t\treturn snippet;\n\n\t}\n\n}\n\n\nclass WorkgroupInfoNode extends Node {\n\n\tconstructor( scope, bufferType, bufferCount = 0 ) {\n\n\t\tsuper( bufferType );\n\n\t\tthis.bufferType = bufferType;\n\t\tthis.bufferCount = bufferCount;\n\n\t\tthis.isWorkgroupInfoNode = true;\n\n\t\tthis.scope = scope;\n\n\t}\n\n\tlabel( name ) {\n\n\t\tthis.name = name;\n\n\t\treturn this;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.uuid;\n\n\t}\n\n\tsetScope( scope ) {\n\n\t\tthis.scope = scope;\n\n\t\treturn this;\n\n\t}\n\n\tgetInputType( /*builder*/ ) {\n\n\t\treturn `${this.scope}Array`;\n\n\t}\n\n\telement( indexNode ) {\n\n\t\treturn nodeObject( new WorkgroupInfoElementNode( this, indexNode ) );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\treturn builder.getScopedArray( this.name || `${this.scope}Array_${this.id}`, this.scope.toLowerCase(), this.bufferType, this.bufferCount );\n\n\t}\n\n}\n\nconst workgroupArray = ( type, count ) => nodeObject( new WorkgroupInfoNode( 'Workgroup', type, count ) );\n\nclass AtomicFunctionNode extends TempNode {\n\n\tstatic get type() {\n\n\t\treturn 'AtomicFunctionNode';\n\n\t}\n\n\tconstructor( method, pointerNode, valueNode, storeNode = null ) {\n\n\t\tsuper( 'uint' );\n\n\t\tthis.method = method;\n\n\t\tthis.pointerNode = pointerNode;\n\t\tthis.valueNode = valueNode;\n\t\tthis.storeNode = storeNode;\n\n\t}\n\n\tgetInputType( builder ) {\n\n\t\treturn this.pointerNode.getNodeType( builder );\n\n\t}\n\n\tgetNodeType( builder ) {\n\n\t\treturn this.getInputType( builder );\n\n\t}\n\n\tgenerate( builder ) {\n\n\t\tconst method = this.method;\n\n\t\tconst type = this.getNodeType( builder );\n\t\tconst inputType = this.getInputType( builder );\n\n\t\tconst a = this.pointerNode;\n\t\tconst b = this.valueNode;\n\n\t\tconst params = [];\n\n\t\tparams.push( `&${ a.build( builder, inputType ) }` );\n\t\tparams.push( b.build( builder, inputType ) );\n\n\t\tconst methodSnippet = `${ builder.getMethod( method, type ) }( ${params.join( ', ' )} )`;\n\n\t\tif ( this.storeNode !== null ) {\n\n\t\t\tconst varSnippet = this.storeNode.build( builder, inputType );\n\n\t\t\tbuilder.addLineFlowCode( `${varSnippet} = ${methodSnippet}`, this );\n\n\t\t} else {\n\n\t\t\tbuilder.addLineFlowCode( methodSnippet, this );\n\n\t\t}\n\n\t}\n\n}\n\nAtomicFunctionNode.ATOMIC_LOAD = 'atomicLoad';\nAtomicFunctionNode.ATOMIC_STORE = 'atomicStore';\nAtomicFunctionNode.ATOMIC_ADD = 'atomicAdd';\nAtomicFunctionNode.ATOMIC_SUB = 'atomicSub';\nAtomicFunctionNode.ATOMIC_MAX = 'atomicMax';\nAtomicFunctionNode.ATOMIC_MIN = 'atomicMin';\nAtomicFunctionNode.ATOMIC_AND = 'atomicAnd';\nAtomicFunctionNode.ATOMIC_OR = 'atomicOr';\nAtomicFunctionNode.ATOMIC_XOR = 'atomicXor';\n\nconst atomicNode = nodeProxy( AtomicFunctionNode );\n\nconst atomicFunc = ( method, pointerNode, valueNode, storeNode ) => {\n\n\tconst node = atomicNode( method, pointerNode, valueNode, storeNode );\n\tnode.append();\n\n\treturn node;\n\n};\n\nconst atomicStore = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_STORE, pointerNode, valueNode, storeNode );\nconst atomicAdd = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_ADD, pointerNode, valueNode, storeNode );\nconst atomicSub = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_SUB, pointerNode, valueNode, storeNode );\nconst atomicMax = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_MAX, pointerNode, valueNode, storeNode );\nconst atomicMin = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_MIN, pointerNode, valueNode, storeNode );\nconst atomicAnd = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_AND, pointerNode, valueNode, storeNode );\nconst atomicOr = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_OR, pointerNode, valueNode, storeNode );\nconst atomicXor = ( pointerNode, valueNode, storeNode = null ) => atomicFunc( AtomicFunctionNode.ATOMIC_XOR, pointerNode, valueNode, storeNode );\n\nlet uniformsLib;\n\nfunction getLightData( light ) {\n\n\tuniformsLib = uniformsLib || new WeakMap();\n\n\tlet uniforms = uniformsLib.get( light );\n\n\tif ( uniforms === undefined ) uniformsLib.set( light, uniforms = {} );\n\n\treturn uniforms;\n\n}\n\nfunction lightPosition( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.position || ( data.position = uniform( new Vector3() ).setGroup( renderGroup ).onRenderUpdate( ( _, self ) => self.value.setFromMatrixPosition( light.matrixWorld ) ) );\n\n}\n\nfunction lightTargetPosition( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.targetPosition || ( data.targetPosition = uniform( new Vector3() ).setGroup( renderGroup ).onRenderUpdate( ( _, self ) => self.value.setFromMatrixPosition( light.target.matrixWorld ) ) );\n\n}\n\nfunction lightViewPosition( light ) {\n\n\tconst data = getLightData( light );\n\n\treturn data.viewPosition || ( data.viewPosition = uniform( new Vector3() ).setGroup( renderGroup ).onRenderUpdate( ( { camera }, self ) => {\n\n\t\tself.value = self.value || new Vector3();\n\t\tself.value.setFromMatrixPosition( light.matrixWorld );\n\n\t\tself.value.applyMatrix4( camera.matrixWorldInverse );\n\n\t} ) );\n\n}\n\nconst lightTargetDirection = ( light ) => cameraViewMatrix.transformDirection( lightPosition( light ).sub( lightTargetPosition( light ) ) );\n\nconst sortLights = ( lights ) => {\n\n\treturn lights.sort( ( a, b ) => a.id - b.id );\n\n};\n\nconst getLightNodeById = ( id, lightNodes ) => {\n\n\tfor ( const lightNode of lightNodes ) {\n\n\t\tif ( lightNode.isAnalyticLightNode && lightNode.light.id === id ) {\n\n\t\t\treturn lightNode;\n\n\t\t}\n\n\t}\n\n\treturn null;\n\n};\n\nconst _lightsNodeRef = /*@__PURE__*/ new WeakMap();\n\nclass LightsNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'LightsNode';\n\n\t}\n\n\tconstructor() {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.totalDiffuseNode = vec3().toVar( 'totalDiffuse' );\n\t\tthis.totalSpecularNode = vec3().toVar( 'totalSpecular' );\n\n\t\tthis.outgoingLightNode = vec3().toVar( 'outgoingLight' );\n\n\t\tthis._lights = [];\n\n\t\tthis._lightNodes = null;\n\t\tthis._lightNodesHash = null;\n\n\t\tthis.global = true;\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this._lightNodesHash === null ) {\n\n\t\t\tif ( this._lightNodes === null ) this.setupLightsNode( builder );\n\n\t\t\tconst hash = [];\n\n\t\t\tfor ( const lightNode of this._lightNodes ) {\n\n\t\t\t\thash.push( lightNode.getSelf().getHash() );\n\n\t\t\t}\n\n\t\t\tthis._lightNodesHash = 'lights-' + hash.join( ',' );\n\n\t\t}\n\n\t\treturn this._lightNodesHash;\n\n\t}\n\n\tanalyze( builder ) {\n\n\t\tconst properties = builder.getDataFromNode( this );\n\n\t\tfor ( const node of properties.nodes ) {\n\n\t\t\tnode.build( builder );\n\n\t\t}\n\n\t}\n\n\tsetupLightsNode( builder ) {\n\n\t\tconst lightNodes = [];\n\n\t\tconst previousLightNodes = this._lightNodes;\n\n\t\tconst lights = sortLights( this._lights );\n\t\tconst nodeLibrary = builder.renderer.library;\n\n\t\tfor ( const light of lights ) {\n\n\t\t\tif ( light.isNode ) {\n\n\t\t\t\tlightNodes.push( nodeObject( light ) );\n\n\t\t\t} else {\n\n\t\t\t\tlet lightNode = null;\n\n\t\t\t\tif ( previousLightNodes !== null ) {\n\n\t\t\t\t\tlightNode = getLightNodeById( light.id, previousLightNodes ); // resuse existing light node\n\n\t\t\t\t}\n\n\t\t\t\tif ( lightNode === null ) {\n\n\t\t\t\t\tconst lightNodeClass = nodeLibrary.getLightNodeClass( light.constructor );\n\n\t\t\t\t\tif ( lightNodeClass === null ) {\n\n\t\t\t\t\t\tconsole.warn( `LightsNode.setupNodeLights: Light node not found for ${ light.constructor.name }` );\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet lightNode = null;\n\n\t\t\t\t\tif ( ! _lightsNodeRef.has( light ) ) {\n\n\t\t\t\t\t\tlightNode = nodeObject( new lightNodeClass( light ) );\n\t\t\t\t\t\t_lightsNodeRef.set( light, lightNode );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tlightNode = _lightsNodeRef.get( light );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlightNodes.push( lightNode );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._lightNodes = lightNodes;\n\n\t}\n\n\tsetupLights( builder, lightNodes ) {\n\n\t\tfor ( const lightNode of lightNodes ) {\n\n\t\t\tlightNode.build( builder );\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( this._lightNodes === null ) this.setupLightsNode( builder );\n\n\t\tconst context = builder.context;\n\t\tconst lightingModel = context.lightingModel;\n\n\t\tlet outgoingLightNode = this.outgoingLightNode;\n\n\t\tif ( lightingModel ) {\n\n\t\t\tconst { _lightNodes, totalDiffuseNode, totalSpecularNode } = this;\n\n\t\t\tcontext.outgoingLight = outgoingLightNode;\n\n\t\t\tconst stack = builder.addStack();\n\n\t\t\t//\n\n\t\t\tconst properties = builder.getDataFromNode( this );\n\t\t\tproperties.nodes = stack.nodes;\n\n\t\t\t//\n\n\t\t\tlightingModel.start( context, stack, builder );\n\n\t\t\t// lights\n\n\t\t\tthis.setupLights( builder, _lightNodes );\n\n\t\t\t//\n\n\t\t\tlightingModel.indirect( context, stack, builder );\n\n\t\t\t//\n\n\t\t\tconst { backdrop, backdropAlpha } = context;\n\t\t\tconst { directDiffuse, directSpecular, indirectDiffuse, indirectSpecular } = context.reflectedLight;\n\n\t\t\tlet totalDiffuse = directDiffuse.add( indirectDiffuse );\n\n\t\t\tif ( backdrop !== null ) {\n\n\t\t\t\tif ( backdropAlpha !== null ) {\n\n\t\t\t\t\ttotalDiffuse = vec3( backdropAlpha.mix( totalDiffuse, backdrop ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttotalDiffuse = vec3( backdrop );\n\n\t\t\t\t}\n\n\t\t\t\tcontext.material.transparent = true;\n\n\t\t\t}\n\n\t\t\ttotalDiffuseNode.assign( totalDiffuse );\n\t\t\ttotalSpecularNode.assign( directSpecular.add( indirectSpecular ) );\n\n\t\t\toutgoingLightNode.assign( totalDiffuseNode.add( totalSpecularNode ) );\n\n\t\t\t//\n\n\t\t\tlightingModel.finish( context, stack, builder );\n\n\t\t\t//\n\n\t\t\toutgoingLightNode = outgoingLightNode.bypass( builder.removeStack() );\n\n\t\t}\n\n\t\treturn outgoingLightNode;\n\n\t}\n\n\tsetLights( lights ) {\n\n\t\tthis._lights = lights;\n\n\t\tthis._lightNodes = null;\n\t\tthis._lightNodesHash = null;\n\n\t\treturn this;\n\n\t}\n\n\tgetLights() {\n\n\t\treturn this._lights;\n\n\t}\n\n\tget hasLights() {\n\n\t\treturn this._lights.length > 0;\n\n\t}\n\n}\n\nconst lights = ( lights = [] ) => nodeObject( new LightsNode() ).setLights( lights );\n\nconst BasicShadowMap = Fn( ( { depthTexture, shadowCoord } ) => {\n\n\treturn texture( depthTexture, shadowCoord.xy ).compare( shadowCoord.z );\n\n} );\n\nconst PCFShadowMap = Fn( ( { depthTexture, shadowCoord, shadow } ) => {\n\n\tconst depthCompare = ( uv, compare ) => texture( depthTexture, uv ).compare( compare );\n\n\tconst mapSize = reference( 'mapSize', 'vec2', shadow ).setGroup( renderGroup );\n\tconst radius = reference( 'radius', 'float', shadow ).setGroup( renderGroup );\n\n\tconst texelSize = vec2( 1 ).div( mapSize );\n\tconst dx0 = texelSize.x.negate().mul( radius );\n\tconst dy0 = texelSize.y.negate().mul( radius );\n\tconst dx1 = texelSize.x.mul( radius );\n\tconst dy1 = texelSize.y.mul( radius );\n\tconst dx2 = dx0.div( 2 );\n\tconst dy2 = dy0.div( 2 );\n\tconst dx3 = dx1.div( 2 );\n\tconst dy3 = dy1.div( 2 );\n\n\treturn add(\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx0, dy0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx1, dy0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx2, dy2 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy2 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx3, dy2 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx0, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx2, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy, shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx3, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx1, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx2, dy3 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy3 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx3, dy3 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx0, dy1 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( 0, dy1 ) ), shadowCoord.z ),\n\t\tdepthCompare( shadowCoord.xy.add( vec2( dx1, dy1 ) ), shadowCoord.z )\n\t).mul( 1 / 17 );\n\n} );\n\nconst PCFSoftShadowMap = Fn( ( { depthTexture, shadowCoord, shadow } ) => {\n\n\tconst depthCompare = ( uv, compare ) => texture( depthTexture, uv ).compare( compare );\n\n\tconst mapSize = reference( 'mapSize', 'vec2', shadow ).setGroup( renderGroup );\n\n\tconst texelSize = vec2( 1 ).div( mapSize );\n\tconst dx = texelSize.x;\n\tconst dy = texelSize.y;\n\n\tconst uv = shadowCoord.xy;\n\tconst f = fract( uv.mul( mapSize ).add( 0.5 ) );\n\tuv.subAssign( f.mul( texelSize ) );\n\n\treturn add(\n\t\tdepthCompare( uv, shadowCoord.z ),\n\t\tdepthCompare( uv.add( vec2( dx, 0 ) ), shadowCoord.z ),\n\t\tdepthCompare( uv.add( vec2( 0, dy ) ), shadowCoord.z ),\n\t\tdepthCompare( uv.add( texelSize ), shadowCoord.z ),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( dx.negate(), 0 ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), 0 ) ), shadowCoord.z ),\n\t\t\tf.x\n\t\t),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( dx.negate(), dy ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), dy ) ), shadowCoord.z ),\n\t\t\tf.x\n\t\t),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( 0, dy.negate() ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( 0, dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\tf.y\n\t\t),\n\t\tmix(\n\t\t\tdepthCompare( uv.add( vec2( dx, dy.negate() ) ), shadowCoord.z ),\n\t\t\tdepthCompare( uv.add( vec2( dx, dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\tf.y\n\t\t),\n\t\tmix(\n\t\t\tmix(\n\t\t\t\tdepthCompare( uv.add( vec2( dx.negate(), dy.negate() ) ), shadowCoord.z ),\n\t\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), dy.negate() ) ), shadowCoord.z ),\n\t\t\t\tf.x\n\t\t\t),\n\t\t\tmix(\n\t\t\t\tdepthCompare( uv.add( vec2( dx.negate(), dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\t\tdepthCompare( uv.add( vec2( dx.mul( 2 ), dy.mul( 2 ) ) ), shadowCoord.z ),\n\t\t\t\tf.x\n\t\t\t),\n\t\t\tf.y\n\t\t)\n\t).mul( 1 / 9 );\n\n} );\n\n// VSM\n\nconst VSMShadowMapNode = Fn( ( { depthTexture, shadowCoord } ) => {\n\n\tconst occlusion = float( 1 ).toVar();\n\n\tconst distribution = texture( depthTexture ).uv( shadowCoord.xy ).rg;\n\n\tconst hardShadow = step( shadowCoord.z, distribution.x );\n\n\tIf( hardShadow.notEqual( float( 1.0 ) ), () => {\n\n\t\tconst distance = shadowCoord.z.sub( distribution.x );\n\t\tconst variance = max$1( 0, distribution.y.mul( distribution.y ) );\n\t\tlet softnessProbability = variance.div( variance.add( distance.mul( distance ) ) ); // Chebeyshevs inequality\n\t\tsoftnessProbability = clamp( sub( softnessProbability, 0.3 ).div( 0.95 - 0.3 ) );\n\t\tocclusion.assign( clamp( max$1( hardShadow, softnessProbability ) ) );\n\n\t} );\n\n\treturn occlusion;\n\n} );\n\nconst VSMPassVertical = Fn( ( { samples, radius, size, shadowPass } ) => {\n\n\tconst mean = float( 0 ).toVar();\n\tconst squaredMean = float( 0 ).toVar();\n\n\tconst uvStride = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( 2 ).div( samples.sub( 1 ) ) );\n\tconst uvStart = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( - 1 ) );\n\n\tLoop( { start: int( 0 ), end: int( samples ), type: 'int', condition: '<' }, ( { i } ) => {\n\n\t\tconst uvOffset = uvStart.add( float( i ).mul( uvStride ) );\n\n\t\tconst depth = shadowPass.uv( add( screenCoordinate.xy, vec2( 0, uvOffset ).mul( radius ) ).div( size ) ).x;\n\t\tmean.addAssign( depth );\n\t\tsquaredMean.addAssign( depth.mul( depth ) );\n\n\t} );\n\n\tmean.divAssign( samples );\n\tsquaredMean.divAssign( samples );\n\n\tconst std_dev = sqrt( squaredMean.sub( mean.mul( mean ) ) );\n\treturn vec2( mean, std_dev );\n\n} );\n\nconst VSMPassHorizontal = Fn( ( { samples, radius, size, shadowPass } ) => {\n\n\tconst mean = float( 0 ).toVar();\n\tconst squaredMean = float( 0 ).toVar();\n\n\tconst uvStride = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( 2 ).div( samples.sub( 1 ) ) );\n\tconst uvStart = samples.lessThanEqual( float( 1 ) ).select( float( 0 ), float( - 1 ) );\n\n\tLoop( { start: int( 0 ), end: int( samples ), type: 'int', condition: '<' }, ( { i } ) => {\n\n\t\tconst uvOffset = uvStart.add( float( i ).mul( uvStride ) );\n\n\t\tconst distribution = shadowPass.uv( add( screenCoordinate.xy, vec2( uvOffset, 0 ).mul( radius ) ).div( size ) );\n\t\tmean.addAssign( distribution.x );\n\t\tsquaredMean.addAssign( add( distribution.y.mul( distribution.y ), distribution.x.mul( distribution.x ) ) );\n\n\t} );\n\n\tmean.divAssign( samples );\n\tsquaredMean.divAssign( samples );\n\n\tconst std_dev = sqrt( squaredMean.sub( mean.mul( mean ) ) );\n\treturn vec2( mean, std_dev );\n\n} );\n\nconst _shadowFilterLib = [ BasicShadowMap, PCFShadowMap, PCFSoftShadowMap, VSMShadowMapNode ];\n\n//\n\nlet _overrideMaterial = null;\nconst _quadMesh$1 = /*@__PURE__*/ new QuadMesh();\n\nclass ShadowNode extends Node {\n\n\tstatic get type() {\n\n\t\treturn 'ShadowNode';\n\n\t}\n\n\tconstructor( light, shadow = null ) {\n\n\t\tsuper();\n\n\t\tthis.light = light;\n\t\tthis.shadow = shadow || light.shadow;\n\n\t\tthis.shadowMap = null;\n\n\t\tthis.vsmShadowMapVertical = null;\n\t\tthis.vsmShadowMapHorizontal = null;\n\n\t\tthis.vsmMaterialVertical = null;\n\t\tthis.vsmMaterialHorizontal = null;\n\n\t\tthis.updateBeforeType = NodeUpdateType.RENDER;\n\t\tthis._node = null;\n\n\t\tthis.isShadowNode = true;\n\n\t}\n\n\tsetupShadow( builder ) {\n\n\t\tconst { object, renderer } = builder;\n\n\t\tif ( _overrideMaterial === null ) {\n\n\t\t\t_overrideMaterial = new NodeMaterial();\n\t\t\t_overrideMaterial.fragmentNode = vec4( 0, 0, 0, 1 );\n\t\t\t_overrideMaterial.isShadowNodeMaterial = true; // Use to avoid other overrideMaterial override material.fragmentNode unintentionally when using material.shadowNode\n\t\t\t_overrideMaterial.name = 'ShadowMaterial';\n\n\t\t}\n\n\t\tconst shadow = this.shadow;\n\t\tconst shadowMapType = renderer.shadowMap.type;\n\n\t\tconst depthTexture = new DepthTexture( shadow.mapSize.width, shadow.mapSize.height );\n\t\tdepthTexture.compareFunction = LessCompare;\n\n\t\tconst shadowMap = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height );\n\t\tshadowMap.depthTexture = depthTexture;\n\n\t\tshadow.camera.updateProjectionMatrix();\n\n\t\t// VSM\n\n\t\tif ( shadowMapType === VSMShadowMap ) {\n\n\t\t\tdepthTexture.compareFunction = null; // VSM does not use textureSampleCompare()/texture2DCompare()\n\n\t\t\tthis.vsmShadowMapVertical = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height, { format: RGFormat, type: HalfFloatType } );\n\t\t\tthis.vsmShadowMapHorizontal = builder.createRenderTarget( shadow.mapSize.width, shadow.mapSize.height, { format: RGFormat, type: HalfFloatType } );\n\n\t\t\tconst shadowPassVertical = texture( depthTexture );\n\t\t\tconst shadowPassHorizontal = texture( this.vsmShadowMapVertical.texture );\n\n\t\t\tconst samples = reference( 'blurSamples', 'float', shadow ).setGroup( renderGroup );\n\t\t\tconst radius = reference( 'radius', 'float', shadow ).setGroup( renderGroup );\n\t\t\tconst size = reference( 'mapSize', 'vec2', shadow ).setGroup( renderGroup );\n\n\t\t\tlet material = this.vsmMaterialVertical || ( this.vsmMaterialVertical = new NodeMaterial() );\n\t\t\tmaterial.fragmentNode = VSMPassVertical( { samples, radius, size, shadowPass: shadowPassVertical } ).context( builder.getSharedContext() );\n\t\t\tmaterial.name = 'VSMVertical';\n\n\t\t\tmaterial = this.vsmMaterialHorizontal || ( this.vsmMaterialHorizontal = new NodeMaterial() );\n\t\t\tmaterial.fragmentNode = VSMPassHorizontal( { samples, radius, size, shadowPass: shadowPassHorizontal } ).context( builder.getSharedContext() );\n\t\t\tmaterial.name = 'VSMHorizontal';\n\n\t\t}\n\n\t\t//\n\n\t\tconst shadowIntensity = reference( 'intensity', 'float', shadow ).setGroup( renderGroup );\n\t\tconst bias = reference( 'bias', 'float', shadow ).setGroup( renderGroup );\n\t\tconst normalBias = reference( 'normalBias', 'float', shadow ).setGroup( renderGroup );\n\n\t\tconst position = object.material.shadowPositionNode || positionWorld;\n\n\t\tlet shadowCoord = uniform( shadow.matrix ).setGroup( renderGroup ).mul( position.add( transformedNormalWorld.mul( normalBias ) ) );\n\n\t\tlet coordZ;\n\n\t\tif ( shadow.camera.isOrthographicCamera || renderer.logarithmicDepthBuffer !== true ) {\n\n\t\t\tshadowCoord = shadowCoord.xyz.div( shadowCoord.w );\n\n\t\t\tcoordZ = shadowCoord.z;\n\n\t\t\tif ( renderer.coordinateSystem === WebGPUCoordinateSystem ) {\n\n\t\t\t\tcoordZ = coordZ.mul( 2 ).sub( 1 ); // WebGPU: Conversion [ 0, 1 ] to [ - 1, 1 ]\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst w = shadowCoord.w;\n\t\t\tshadowCoord = shadowCoord.xy.div( w ); // <-- Only divide X/Y coords since we don't need Z\n\n\t\t\t// The normally available \"cameraNear\" and \"cameraFar\" nodes cannot be used here because they do not get\n\t\t\t// updated to use the shadow camera. So, we have to declare our own \"local\" ones here.\n\t\t\t// TODO: How do we get the cameraNear/cameraFar nodes to use the shadow camera so we don't have to declare local ones here?\n\t\t\tconst cameraNearLocal = uniform( 'float' ).onRenderUpdate( () => shadow.camera.near );\n\t\t\tconst cameraFarLocal = uniform( 'float' ).onRenderUpdate( () => shadow.camera.far );\n\n\t\t\tcoordZ = perspectiveDepthToLogarithmicDepth( w, cameraNearLocal, cameraFarLocal );\n\n\t\t}\n\n\t\tshadowCoord = vec3(\n\t\t\tshadowCoord.x,\n\t\t\tshadowCoord.y.oneMinus(), // follow webgpu standards\n\t\t\tcoordZ.add( bias )\n\t\t);\n\n\t\tconst frustumTest = shadowCoord.x.greaterThanEqual( 0 )\n\t\t\t.and( shadowCoord.x.lessThanEqual( 1 ) )\n\t\t\t.and( shadowCoord.y.greaterThanEqual( 0 ) )\n\t\t\t.and( shadowCoord.y.lessThanEqual( 1 ) )\n\t\t\t.and( shadowCoord.z.lessThanEqual( 1 ) );\n\n\t\t//\n\n\t\tconst filterFn = shadow.filterNode || _shadowFilterLib[ renderer.shadowMap.type ] || null;\n\n\t\tif ( filterFn === null ) {\n\n\t\t\tthrow new Error( 'THREE.WebGPURenderer: Shadow map type not supported yet.' );\n\n\t\t}\n\n\t\tconst shadowColor = texture( shadowMap.texture, shadowCoord );\n\t\tconst shadowNode = frustumTest.select( filterFn( { depthTexture: ( shadowMapType === VSMShadowMap ) ? this.vsmShadowMapHorizontal.texture : depthTexture, shadowCoord, shadow } ), float( 1 ) );\n\n\t\tthis.shadowMap = shadowMap;\n\t\tthis.shadow.map = shadowMap;\n\n\t\treturn mix( 1, shadowNode.rgb.mix( shadowColor, 1 ), shadowIntensity.mul( shadowColor.a ) );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tif ( builder.renderer.shadowMap.enabled === false ) return;\n\n\t\treturn this._node !== null ? this._node : ( this._node = this.setupShadow( builder ) );\n\n\t}\n\n\tupdateShadow( frame ) {\n\n\t\tconst { shadowMap, light, shadow } = this;\n\t\tconst { renderer, scene, camera } = frame;\n\n\t\tconst shadowType = renderer.shadowMap.type;\n\n\t\tconst depthVersion = shadowMap.depthTexture.version;\n\t\tthis._depthVersionCached = depthVersion;\n\n\t\tconst currentOverrideMaterial = scene.overrideMaterial;\n\n\t\tscene.overrideMaterial = _overrideMaterial;\n\n\t\tshadowMap.setSize( shadow.mapSize.width, shadow.mapSize.height );\n\n\t\tshadow.updateMatrices( light );\n\t\tshadow.camera.layers.mask = camera.layers.mask;\n\n\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\t\tconst currentRenderObjectFunction = renderer.getRenderObjectFunction();\n\n\t\trenderer.setRenderObjectFunction( ( object, ...params ) => {\n\n\t\t\tif ( object.castShadow === true || ( object.receiveShadow && shadowType === VSMShadowMap ) ) {\n\n\t\t\t\trenderer.renderObject( object, ...params );\n\n\t\t\t}\n\n\t\t} );\n\n\t\trenderer.setRenderTarget( shadowMap );\n\t\trenderer.render( scene, shadow.camera );\n\n\t\trenderer.setRenderObjectFunction( currentRenderObjectFunction );\n\n\t\t// vsm blur pass\n\n\t\tif ( light.isPointLight !== true && shadowType === VSMShadowMap ) {\n\n\t\t\tthis.vsmPass( renderer );\n\n\t\t}\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\tscene.overrideMaterial = currentOverrideMaterial;\n\n\t}\n\n\tvsmPass( renderer ) {\n\n\t\tconst { shadow } = this;\n\n\t\tthis.vsmShadowMapVertical.setSize( shadow.mapSize.width, shadow.mapSize.height );\n\t\tthis.vsmShadowMapHorizontal.setSize( shadow.mapSize.width, shadow.mapSize.height );\n\n\t\trenderer.setRenderTarget( this.vsmShadowMapVertical );\n\t\t_quadMesh$1.material = this.vsmMaterialVertical;\n\t\t_quadMesh$1.render( renderer );\n\n\t\trenderer.setRenderTarget( this.vsmShadowMapHorizontal );\n\t\t_quadMesh$1.material = this.vsmMaterialHorizontal;\n\t\t_quadMesh$1.render( renderer );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shadowMap.dispose();\n\t\tthis.shadowMap = null;\n\n\t\tif ( this.vsmShadowMapVertical !== null ) {\n\n\t\t\tthis.vsmShadowMapVertical.dispose();\n\t\t\tthis.vsmShadowMapVertical = null;\n\n\t\t\tthis.vsmMaterialVertical.dispose();\n\t\t\tthis.vsmMaterialVertical = null;\n\n\t\t}\n\n\t\tif ( this.vsmShadowMapHorizontal !== null ) {\n\n\t\t\tthis.vsmShadowMapHorizontal.dispose();\n\t\t\tthis.vsmShadowMapHorizontal = null;\n\n\t\t\tthis.vsmMaterialHorizontal.dispose();\n\t\t\tthis.vsmMaterialHorizontal = null;\n\n\t\t}\n\n\t\tthis.updateBeforeType = NodeUpdateType.NONE;\n\n\t}\n\n\tupdateBefore( frame ) {\n\n\t\tconst { shadow } = this;\n\n\t\tconst needsUpdate = shadow.needsUpdate || shadow.autoUpdate;\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tthis.updateShadow( frame );\n\n\t\t\tif ( this.shadowMap.depthTexture.version === this._depthVersionCached ) {\n\n\t\t\t\tshadow.needsUpdate = false;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nconst shadow = ( light, shadow ) => nodeObject( new ShadowNode( light, shadow ) );\n\nclass AnalyticLightNode extends LightingNode {\n\n\tstatic get type() {\n\n\t\treturn 'AnalyticLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper();\n\n\t\tthis.updateType = NodeUpdateType.FRAME;\n\n\t\tthis.light = light;\n\n\t\tthis.color = new Color();\n\t\tthis.colorNode = uniform( this.color ).setGroup( renderGroup );\n\n\t\tthis.baseColorNode = null;\n\n\t\tthis.shadowNode = null;\n\t\tthis.shadowColorNode = null;\n\n\t\tthis.isAnalyticLightNode = true;\n\n\t}\n\n\tgetCacheKey() {\n\n\t\treturn hash$1( super.getCacheKey(), this.light.id, this.light.castShadow ? 1 : 0 );\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.light.uuid;\n\n\t}\n\n\tsetupShadow( builder ) {\n\n\t\tconst { renderer } = builder;\n\n\t\tif ( renderer.shadowMap.enabled === false ) return;\n\n\t\tlet shadowColorNode = this.shadowColorNode;\n\n\t\tif ( shadowColorNode === null ) {\n\n\t\t\tconst customShadowNode = this.light.shadow.shadowNode;\n\n\t\t\tlet shadowNode;\n\n\t\t\tif ( customShadowNode !== undefined ) {\n\n\t\t\t\tshadowNode = nodeObject( customShadowNode );\n\n\t\t\t} else {\n\n\t\t\t\tshadowNode = shadow( this.light );\n\n\t\t\t}\n\n\t\t\tthis.shadowNode = shadowNode;\n\n\t\t\tthis.shadowColorNode = shadowColorNode = this.colorNode.mul( shadowNode );\n\n\t\t\tthis.baseColorNode = this.colorNode;\n\n\t\t}\n\n\t\t//\n\n\t\tthis.colorNode = shadowColorNode;\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tthis.colorNode = this.baseColorNode || this.colorNode;\n\n\t\tif ( this.light.castShadow ) {\n\n\t\t\tif ( builder.object.receiveShadow ) {\n\n\t\t\t\tthis.setupShadow( builder );\n\n\t\t\t}\n\n\t\t} else if ( this.shadowNode !== null ) {\n\n\t\t\tthis.shadowNode.dispose();\n\n\t\t}\n\n\t}\n\n\tupdate( /*frame*/ ) {\n\n\t\tconst { light } = this;\n\n\t\tthis.color.copy( light.color ).multiplyScalar( light.intensity );\n\n\t}\n\n}\n\nconst getDistanceAttenuation = /*@__PURE__*/ Fn( ( inputs ) => {\n\n\tconst { lightDistance, cutoffDistance, decayExponent } = inputs;\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\tconst distanceFalloff = lightDistance.pow( decayExponent ).max( 0.01 ).reciprocal();\n\n\treturn cutoffDistance.greaterThan( 0 ).select(\n\t\tdistanceFalloff.mul( lightDistance.div( cutoffDistance ).pow4().oneMinus().clamp().pow2() ),\n\t\tdistanceFalloff\n\t);\n\n} ); // validated\n\nconst directPointLight = Fn( ( { color, lightViewPosition, cutoffDistance, decayExponent }, builder ) => {\n\n\tconst lightingModel = builder.context.lightingModel;\n\n\tconst lVector = lightViewPosition.sub( positionView ); // @TODO: Add it into LightNode\n\n\tconst lightDirection = lVector.normalize();\n\tconst lightDistance = lVector.length();\n\n\tconst lightAttenuation = getDistanceAttenuation( {\n\t\tlightDistance,\n\t\tcutoffDistance,\n\t\tdecayExponent\n\t} );\n\n\tconst lightColor = color.mul( lightAttenuation );\n\n\tconst reflectedLight = builder.context.reflectedLight;\n\n\tlightingModel.direct( {\n\t\tlightDirection,\n\t\tlightColor,\n\t\treflectedLight\n\t}, builder.stack, builder );\n\n} );\n\nclass PointLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'PointLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.cutoffDistanceNode = uniform( 0 ).setGroup( renderGroup );\n\t\tthis.decayExponentNode = uniform( 0 ).setGroup( renderGroup );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\tthis.cutoffDistanceNode.value = light.distance;\n\t\tthis.decayExponentNode.value = light.decay;\n\n\t}\n\n\tsetup() {\n\n\t\tdirectPointLight( {\n\t\t\tcolor: this.colorNode,\n\t\t\tlightViewPosition: lightViewPosition( this.light ),\n\t\t\tcutoffDistance: this.cutoffDistanceNode,\n\t\t\tdecayExponent: this.decayExponentNode\n\t\t} ).append();\n\n\t}\n\n}\n\nconst checker = /*@__PURE__*/ Fn( ( [ coord = uv() ] ) => {\n\n\tconst uv = coord.mul( 2.0 );\n\n\tconst cx = uv.x.floor();\n\tconst cy = uv.y.floor();\n\tconst result = cx.add( cy ).mod( 2.0 );\n\n\treturn result.sign();\n\n} );\n\n// Three.js Transpiler\n// https://raw.githubusercontent.com/AcademySoftwareFoundation/MaterialX/main/libraries/stdlib/genglsl/lib/mx_noise.glsl\n\n\n\nconst mx_select = /*@__PURE__*/ Fn( ( [ b_immutable, t_immutable, f_immutable ] ) => {\n\n\tconst f = float( f_immutable ).toVar();\n\tconst t = float( t_immutable ).toVar();\n\tconst b = bool( b_immutable ).toVar();\n\n\treturn select( b, t, f );\n\n} ).setLayout( {\n\tname: 'mx_select',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'b', type: 'bool' },\n\t\t{ name: 't', type: 'float' },\n\t\t{ name: 'f', type: 'float' }\n\t]\n} );\n\nconst mx_negate_if = /*@__PURE__*/ Fn( ( [ val_immutable, b_immutable ] ) => {\n\n\tconst b = bool( b_immutable ).toVar();\n\tconst val = float( val_immutable ).toVar();\n\n\treturn select( b, val.negate(), val );\n\n} ).setLayout( {\n\tname: 'mx_negate_if',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'val', type: 'float' },\n\t\t{ name: 'b', type: 'bool' }\n\t]\n} );\n\nconst mx_floor = /*@__PURE__*/ Fn( ( [ x_immutable ] ) => {\n\n\tconst x = float( x_immutable ).toVar();\n\n\treturn int( floor( x ) );\n\n} ).setLayout( {\n\tname: 'mx_floor',\n\ttype: 'int',\n\tinputs: [\n\t\t{ name: 'x', type: 'float' }\n\t]\n} );\n\nconst mx_floorfrac = /*@__PURE__*/ Fn( ( [ x_immutable, i ] ) => {\n\n\tconst x = float( x_immutable ).toVar();\n\ti.assign( mx_floor( x ) );\n\n\treturn x.sub( float( i ) );\n\n} );\n\nconst mx_bilerp_0 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, s_immutable, t_immutable ] ) => {\n\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v3 = float( v3_immutable ).toVar();\n\tconst v2 = float( v2_immutable ).toVar();\n\tconst v1 = float( v1_immutable ).toVar();\n\tconst v0 = float( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\n\treturn sub( 1.0, t ).mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_bilerp_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v0', type: 'float' },\n\t\t{ name: 'v1', type: 'float' },\n\t\t{ name: 'v2', type: 'float' },\n\t\t{ name: 'v3', type: 'float' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' }\n\t]\n} );\n\nconst mx_bilerp_1 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, s_immutable, t_immutable ] ) => {\n\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v3 = vec3( v3_immutable ).toVar();\n\tconst v2 = vec3( v2_immutable ).toVar();\n\tconst v1 = vec3( v1_immutable ).toVar();\n\tconst v0 = vec3( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\n\treturn sub( 1.0, t ).mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_bilerp_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v0', type: 'vec3' },\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' },\n\t\t{ name: 'v3', type: 'vec3' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' }\n\t]\n} );\n\nconst mx_bilerp = /*@__PURE__*/ overloadingFn( [ mx_bilerp_0, mx_bilerp_1 ] );\n\nconst mx_trilerp_0 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, v4_immutable, v5_immutable, v6_immutable, v7_immutable, s_immutable, t_immutable, r_immutable ] ) => {\n\n\tconst r = float( r_immutable ).toVar();\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v7 = float( v7_immutable ).toVar();\n\tconst v6 = float( v6_immutable ).toVar();\n\tconst v5 = float( v5_immutable ).toVar();\n\tconst v4 = float( v4_immutable ).toVar();\n\tconst v3 = float( v3_immutable ).toVar();\n\tconst v2 = float( v2_immutable ).toVar();\n\tconst v1 = float( v1_immutable ).toVar();\n\tconst v0 = float( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\tconst t1 = float( sub( 1.0, t ) ).toVar();\n\tconst r1 = float( sub( 1.0, r ) ).toVar();\n\n\treturn r1.mul( t1.mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) ) ).add( r.mul( t1.mul( v4.mul( s1 ).add( v5.mul( s ) ) ).add( t.mul( v6.mul( s1 ).add( v7.mul( s ) ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_trilerp_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v0', type: 'float' },\n\t\t{ name: 'v1', type: 'float' },\n\t\t{ name: 'v2', type: 'float' },\n\t\t{ name: 'v3', type: 'float' },\n\t\t{ name: 'v4', type: 'float' },\n\t\t{ name: 'v5', type: 'float' },\n\t\t{ name: 'v6', type: 'float' },\n\t\t{ name: 'v7', type: 'float' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' },\n\t\t{ name: 'r', type: 'float' }\n\t]\n} );\n\nconst mx_trilerp_1 = /*@__PURE__*/ Fn( ( [ v0_immutable, v1_immutable, v2_immutable, v3_immutable, v4_immutable, v5_immutable, v6_immutable, v7_immutable, s_immutable, t_immutable, r_immutable ] ) => {\n\n\tconst r = float( r_immutable ).toVar();\n\tconst t = float( t_immutable ).toVar();\n\tconst s = float( s_immutable ).toVar();\n\tconst v7 = vec3( v7_immutable ).toVar();\n\tconst v6 = vec3( v6_immutable ).toVar();\n\tconst v5 = vec3( v5_immutable ).toVar();\n\tconst v4 = vec3( v4_immutable ).toVar();\n\tconst v3 = vec3( v3_immutable ).toVar();\n\tconst v2 = vec3( v2_immutable ).toVar();\n\tconst v1 = vec3( v1_immutable ).toVar();\n\tconst v0 = vec3( v0_immutable ).toVar();\n\tconst s1 = float( sub( 1.0, s ) ).toVar();\n\tconst t1 = float( sub( 1.0, t ) ).toVar();\n\tconst r1 = float( sub( 1.0, r ) ).toVar();\n\n\treturn r1.mul( t1.mul( v0.mul( s1 ).add( v1.mul( s ) ) ).add( t.mul( v2.mul( s1 ).add( v3.mul( s ) ) ) ) ).add( r.mul( t1.mul( v4.mul( s1 ).add( v5.mul( s ) ) ).add( t.mul( v6.mul( s1 ).add( v7.mul( s ) ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_trilerp_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v0', type: 'vec3' },\n\t\t{ name: 'v1', type: 'vec3' },\n\t\t{ name: 'v2', type: 'vec3' },\n\t\t{ name: 'v3', type: 'vec3' },\n\t\t{ name: 'v4', type: 'vec3' },\n\t\t{ name: 'v5', type: 'vec3' },\n\t\t{ name: 'v6', type: 'vec3' },\n\t\t{ name: 'v7', type: 'vec3' },\n\t\t{ name: 's', type: 'float' },\n\t\t{ name: 't', type: 'float' },\n\t\t{ name: 'r', type: 'float' }\n\t]\n} );\n\nconst mx_trilerp = /*@__PURE__*/ overloadingFn( [ mx_trilerp_0, mx_trilerp_1 ] );\n\nconst mx_gradient_float_0 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable ] ) => {\n\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uint( hash_immutable ).toVar();\n\tconst h = uint( hash.bitAnd( uint( 7 ) ) ).toVar();\n\tconst u = float( mx_select( h.lessThan( uint( 4 ) ), x, y ) ).toVar();\n\tconst v = float( mul( 2.0, mx_select( h.lessThan( uint( 4 ) ), y, x ) ) ).toVar();\n\n\treturn mx_negate_if( u, bool( h.bitAnd( uint( 1 ) ) ) ).add( mx_negate_if( v, bool( h.bitAnd( uint( 2 ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uint' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_float_1 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = float( z_immutable ).toVar();\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uint( hash_immutable ).toVar();\n\tconst h = uint( hash.bitAnd( uint( 15 ) ) ).toVar();\n\tconst u = float( mx_select( h.lessThan( uint( 8 ) ), x, y ) ).toVar();\n\tconst v = float( mx_select( h.lessThan( uint( 4 ) ), y, mx_select( h.equal( uint( 12 ) ).or( h.equal( uint( 14 ) ) ), x, z ) ) ).toVar();\n\n\treturn mx_negate_if( u, bool( h.bitAnd( uint( 1 ) ) ) ).add( mx_negate_if( v, bool( h.bitAnd( uint( 2 ) ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uint' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' },\n\t\t{ name: 'z', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_float = /*@__PURE__*/ overloadingFn( [ mx_gradient_float_0, mx_gradient_float_1 ] );\n\nconst mx_gradient_vec3_0 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable ] ) => {\n\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uvec3( hash_immutable ).toVar();\n\n\treturn vec3( mx_gradient_float( hash.x, x, y ), mx_gradient_float( hash.y, x, y ), mx_gradient_float( hash.z, x, y ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uvec3' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_vec3_1 = /*@__PURE__*/ Fn( ( [ hash_immutable, x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = float( z_immutable ).toVar();\n\tconst y = float( y_immutable ).toVar();\n\tconst x = float( x_immutable ).toVar();\n\tconst hash = uvec3( hash_immutable ).toVar();\n\n\treturn vec3( mx_gradient_float( hash.x, x, y, z ), mx_gradient_float( hash.y, x, y, z ), mx_gradient_float( hash.z, x, y, z ) );\n\n} ).setLayout( {\n\tname: 'mx_gradient_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'hash', type: 'uvec3' },\n\t\t{ name: 'x', type: 'float' },\n\t\t{ name: 'y', type: 'float' },\n\t\t{ name: 'z', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_vec3 = /*@__PURE__*/ overloadingFn( [ mx_gradient_vec3_0, mx_gradient_vec3_1 ] );\n\nconst mx_gradient_scale2d_0 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = float( v_immutable ).toVar();\n\n\treturn mul( 0.6616, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale2d_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_scale3d_0 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = float( v_immutable ).toVar();\n\n\treturn mul( 0.9820, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale3d_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'v', type: 'float' }\n\t]\n} );\n\nconst mx_gradient_scale2d_1 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = vec3( v_immutable ).toVar();\n\n\treturn mul( 0.6616, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale2d_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v', type: 'vec3' }\n\t]\n} );\n\nconst mx_gradient_scale2d = /*@__PURE__*/ overloadingFn( [ mx_gradient_scale2d_0, mx_gradient_scale2d_1 ] );\n\nconst mx_gradient_scale3d_1 = /*@__PURE__*/ Fn( ( [ v_immutable ] ) => {\n\n\tconst v = vec3( v_immutable ).toVar();\n\n\treturn mul( 0.9820, v );\n\n} ).setLayout( {\n\tname: 'mx_gradient_scale3d_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'v', type: 'vec3' }\n\t]\n} );\n\nconst mx_gradient_scale3d = /*@__PURE__*/ overloadingFn( [ mx_gradient_scale3d_0, mx_gradient_scale3d_1 ] );\n\nconst mx_rotl32 = /*@__PURE__*/ Fn( ( [ x_immutable, k_immutable ] ) => {\n\n\tconst k = int( k_immutable ).toVar();\n\tconst x = uint( x_immutable ).toVar();\n\n\treturn x.shiftLeft( k ).bitOr( x.shiftRight( int( 32 ).sub( k ) ) );\n\n} ).setLayout( {\n\tname: 'mx_rotl32',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'uint' },\n\t\t{ name: 'k', type: 'int' }\n\t]\n} );\n\nconst mx_bjmix = /*@__PURE__*/ Fn( ( [ a, b, c ] ) => {\n\n\ta.subAssign( c );\n\ta.bitXorAssign( mx_rotl32( c, int( 4 ) ) );\n\tc.addAssign( b );\n\tb.subAssign( a );\n\tb.bitXorAssign( mx_rotl32( a, int( 6 ) ) );\n\ta.addAssign( c );\n\tc.subAssign( b );\n\tc.bitXorAssign( mx_rotl32( b, int( 8 ) ) );\n\tb.addAssign( a );\n\ta.subAssign( c );\n\ta.bitXorAssign( mx_rotl32( c, int( 16 ) ) );\n\tc.addAssign( b );\n\tb.subAssign( a );\n\tb.bitXorAssign( mx_rotl32( a, int( 19 ) ) );\n\ta.addAssign( c );\n\tc.subAssign( b );\n\tc.bitXorAssign( mx_rotl32( b, int( 4 ) ) );\n\tb.addAssign( a );\n\n} );\n\nconst mx_bjfinal = /*@__PURE__*/ Fn( ( [ a_immutable, b_immutable, c_immutable ] ) => {\n\n\tconst c = uint( c_immutable ).toVar();\n\tconst b = uint( b_immutable ).toVar();\n\tconst a = uint( a_immutable ).toVar();\n\tc.bitXorAssign( b );\n\tc.subAssign( mx_rotl32( b, int( 14 ) ) );\n\ta.bitXorAssign( c );\n\ta.subAssign( mx_rotl32( c, int( 11 ) ) );\n\tb.bitXorAssign( a );\n\tb.subAssign( mx_rotl32( a, int( 25 ) ) );\n\tc.bitXorAssign( b );\n\tc.subAssign( mx_rotl32( b, int( 16 ) ) );\n\ta.bitXorAssign( c );\n\ta.subAssign( mx_rotl32( c, int( 4 ) ) );\n\tb.bitXorAssign( a );\n\tb.subAssign( mx_rotl32( a, int( 14 ) ) );\n\tc.bitXorAssign( b );\n\tc.subAssign( mx_rotl32( b, int( 24 ) ) );\n\n\treturn c;\n\n} ).setLayout( {\n\tname: 'mx_bjfinal',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'a', type: 'uint' },\n\t\t{ name: 'b', type: 'uint' },\n\t\t{ name: 'c', type: 'uint' }\n\t]\n} );\n\nconst mx_bits_to_01 = /*@__PURE__*/ Fn( ( [ bits_immutable ] ) => {\n\n\tconst bits = uint( bits_immutable ).toVar();\n\n\treturn float( bits ).div( float( uint( int( 0xffffffff ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_bits_to_01',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'bits', type: 'uint' }\n\t]\n} );\n\nconst mx_fade = /*@__PURE__*/ Fn( ( [ t_immutable ] ) => {\n\n\tconst t = float( t_immutable ).toVar();\n\n\treturn t.mul( t ).mul( t ).mul( t.mul( t.mul( 6.0 ).sub( 15.0 ) ).add( 10.0 ) );\n\n} ).setLayout( {\n\tname: 'mx_fade',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 't', type: 'float' }\n\t]\n} );\n\nconst mx_hash_int_0 = /*@__PURE__*/ Fn( ( [ x_immutable ] ) => {\n\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 1 ) ).toVar();\n\tconst seed = uint( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ).toVar();\n\n\treturn mx_bjfinal( seed.add( uint( x ) ), seed, seed );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_0',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_1 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable ] ) => {\n\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 2 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_1',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_2 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 3 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\tc.addAssign( uint( z ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_2',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_3 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable, xx_immutable ] ) => {\n\n\tconst xx = int( xx_immutable ).toVar();\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 4 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\tc.addAssign( uint( z ) );\n\tmx_bjmix( a, b, c );\n\ta.addAssign( uint( xx ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_3',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' },\n\t\t{ name: 'xx', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int_4 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable, xx_immutable, yy_immutable ] ) => {\n\n\tconst yy = int( yy_immutable ).toVar();\n\tconst xx = int( xx_immutable ).toVar();\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst len = uint( uint( 5 ) ).toVar();\n\tconst a = uint().toVar(), b = uint().toVar(), c = uint().toVar();\n\ta.assign( b.assign( c.assign( uint( int( 0xdeadbeef ) ).add( len.shiftLeft( uint( 2 ) ) ).add( uint( 13 ) ) ) ) );\n\ta.addAssign( uint( x ) );\n\tb.addAssign( uint( y ) );\n\tc.addAssign( uint( z ) );\n\tmx_bjmix( a, b, c );\n\ta.addAssign( uint( xx ) );\n\tb.addAssign( uint( yy ) );\n\n\treturn mx_bjfinal( a, b, c );\n\n} ).setLayout( {\n\tname: 'mx_hash_int_4',\n\ttype: 'uint',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' },\n\t\t{ name: 'xx', type: 'int' },\n\t\t{ name: 'yy', type: 'int' }\n\t]\n} );\n\nconst mx_hash_int = /*@__PURE__*/ overloadingFn( [ mx_hash_int_0, mx_hash_int_1, mx_hash_int_2, mx_hash_int_3, mx_hash_int_4 ] );\n\nconst mx_hash_vec3_0 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable ] ) => {\n\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst h = uint( mx_hash_int( x, y ) ).toVar();\n\tconst result = uvec3().toVar();\n\tresult.x.assign( h.bitAnd( int( 0xFF ) ) );\n\tresult.y.assign( h.shiftRight( int( 8 ) ).bitAnd( int( 0xFF ) ) );\n\tresult.z.assign( h.shiftRight( int( 16 ) ).bitAnd( int( 0xFF ) ) );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_hash_vec3_0',\n\ttype: 'uvec3',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' }\n\t]\n} );\n\nconst mx_hash_vec3_1 = /*@__PURE__*/ Fn( ( [ x_immutable, y_immutable, z_immutable ] ) => {\n\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst h = uint( mx_hash_int( x, y, z ) ).toVar();\n\tconst result = uvec3().toVar();\n\tresult.x.assign( h.bitAnd( int( 0xFF ) ) );\n\tresult.y.assign( h.shiftRight( int( 8 ) ).bitAnd( int( 0xFF ) ) );\n\tresult.z.assign( h.shiftRight( int( 16 ) ).bitAnd( int( 0xFF ) ) );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_hash_vec3_1',\n\ttype: 'uvec3',\n\tinputs: [\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' }\n\t]\n} );\n\nconst mx_hash_vec3 = /*@__PURE__*/ overloadingFn( [ mx_hash_vec3_0, mx_hash_vec3_1 ] );\n\nconst mx_perlin_noise_float_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst result = float( mx_bilerp( mx_gradient_float( mx_hash_int( X, Y ), fx, fy ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y ), fx.sub( 1.0 ), fy ), mx_gradient_float( mx_hash_int( X, Y.add( int( 1 ) ) ), fx, fy.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ) ), u, v ) ).toVar();\n\n\treturn mx_gradient_scale2d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_perlin_noise_float_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst fz = float( mx_floorfrac( p.z, Z ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst w = float( mx_fade( fz ) ).toVar();\n\tconst result = float( mx_trilerp( mx_gradient_float( mx_hash_int( X, Y, Z ), fx, fy, fz ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y, Z ), fx.sub( 1.0 ), fy, fz ), mx_gradient_float( mx_hash_int( X, Y.add( int( 1 ) ), Z ), fx, fy.sub( 1.0 ), fz ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz ), mx_gradient_float( mx_hash_int( X, Y, Z.add( int( 1 ) ) ), fx, fy, fz.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y, Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy, fz.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X, Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx, fy.sub( 1.0 ), fz.sub( 1.0 ) ), mx_gradient_float( mx_hash_int( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz.sub( 1.0 ) ), u, v, w ) ).toVar();\n\n\treturn mx_gradient_scale3d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_perlin_noise_float = /*@__PURE__*/ overloadingFn( [ mx_perlin_noise_float_0, mx_perlin_noise_float_1 ] );\n\nconst mx_perlin_noise_vec3_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst result = vec3( mx_bilerp( mx_gradient_vec3( mx_hash_vec3( X, Y ), fx, fy ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y ), fx.sub( 1.0 ), fy ), mx_gradient_vec3( mx_hash_vec3( X, Y.add( int( 1 ) ) ), fx, fy.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ) ), u, v ) ).toVar();\n\n\treturn mx_gradient_scale2d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_perlin_noise_vec3_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst fx = float( mx_floorfrac( p.x, X ) ).toVar();\n\tconst fy = float( mx_floorfrac( p.y, Y ) ).toVar();\n\tconst fz = float( mx_floorfrac( p.z, Z ) ).toVar();\n\tconst u = float( mx_fade( fx ) ).toVar();\n\tconst v = float( mx_fade( fy ) ).toVar();\n\tconst w = float( mx_fade( fz ) ).toVar();\n\tconst result = vec3( mx_trilerp( mx_gradient_vec3( mx_hash_vec3( X, Y, Z ), fx, fy, fz ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y, Z ), fx.sub( 1.0 ), fy, fz ), mx_gradient_vec3( mx_hash_vec3( X, Y.add( int( 1 ) ), Z ), fx, fy.sub( 1.0 ), fz ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz ), mx_gradient_vec3( mx_hash_vec3( X, Y, Z.add( int( 1 ) ) ), fx, fy, fz.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y, Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy, fz.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X, Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx, fy.sub( 1.0 ), fz.sub( 1.0 ) ), mx_gradient_vec3( mx_hash_vec3( X.add( int( 1 ) ), Y.add( int( 1 ) ), Z.add( int( 1 ) ) ), fx.sub( 1.0 ), fy.sub( 1.0 ), fz.sub( 1.0 ) ), u, v, w ) ).toVar();\n\n\treturn mx_gradient_scale3d( result );\n\n} ).setLayout( {\n\tname: 'mx_perlin_noise_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_perlin_noise_vec3 = /*@__PURE__*/ overloadingFn( [ mx_perlin_noise_vec3_0, mx_perlin_noise_vec3_1 ] );\n\nconst mx_cell_noise_float_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = float( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'float' }\n\t]\n} );\n\nconst mx_cell_noise_float_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix, iy ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_cell_noise_float_2 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix, iy, iz ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_2',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_cell_noise_float_3 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec4( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\tconst iw = int( mx_floor( p.w ) ).toVar();\n\n\treturn mx_bits_to_01( mx_hash_int( ix, iy, iz, iw ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_float_3',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec4' }\n\t]\n} );\n\nconst mx_cell_noise_float$1 = /*@__PURE__*/ overloadingFn( [ mx_cell_noise_float_0, mx_cell_noise_float_1, mx_cell_noise_float_2, mx_cell_noise_float_3 ] );\n\nconst mx_cell_noise_vec3_0 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = float( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'float' }\n\t]\n} );\n\nconst mx_cell_noise_vec3_1 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec2( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, iy, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' }\n\t]\n} );\n\nconst mx_cell_noise_vec3_2 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec3( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, iy, iz, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_2',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' }\n\t]\n} );\n\nconst mx_cell_noise_vec3_3 = /*@__PURE__*/ Fn( ( [ p_immutable ] ) => {\n\n\tconst p = vec4( p_immutable ).toVar();\n\tconst ix = int( mx_floor( p.x ) ).toVar();\n\tconst iy = int( mx_floor( p.y ) ).toVar();\n\tconst iz = int( mx_floor( p.z ) ).toVar();\n\tconst iw = int( mx_floor( p.w ) ).toVar();\n\n\treturn vec3( mx_bits_to_01( mx_hash_int( ix, iy, iz, iw, int( 0 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, iw, int( 1 ) ) ), mx_bits_to_01( mx_hash_int( ix, iy, iz, iw, int( 2 ) ) ) );\n\n} ).setLayout( {\n\tname: 'mx_cell_noise_vec3_3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec4' }\n\t]\n} );\n\nconst mx_cell_noise_vec3 = /*@__PURE__*/ overloadingFn( [ mx_cell_noise_vec3_0, mx_cell_noise_vec3_1, mx_cell_noise_vec3_2, mx_cell_noise_vec3_3 ] );\n\nconst mx_fractal_noise_float$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst result = float( 0.0 ).toVar();\n\tconst amplitude = float( 1.0 ).toVar();\n\n\tLoop( octaves, () => {\n\n\t\tresult.addAssign( amplitude.mul( mx_perlin_noise_float( p ) ) );\n\t\tamplitude.mulAssign( diminish );\n\t\tp.mulAssign( lacunarity );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_float',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_fractal_noise_vec3$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst result = vec3( 0.0 ).toVar();\n\tconst amplitude = float( 1.0 ).toVar();\n\n\tLoop( octaves, () => {\n\n\t\tresult.addAssign( amplitude.mul( mx_perlin_noise_vec3( p ) ) );\n\t\tamplitude.mulAssign( diminish );\n\t\tp.mulAssign( lacunarity );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_vec3',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_fractal_noise_vec2$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\n\treturn vec2( mx_fractal_noise_float$1( p, octaves, lacunarity, diminish ), mx_fractal_noise_float$1( p.add( vec3( int( 19 ), int( 193 ), int( 17 ) ) ), octaves, lacunarity, diminish ) );\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_vec2',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_fractal_noise_vec4$1 = /*@__PURE__*/ Fn( ( [ p_immutable, octaves_immutable, lacunarity_immutable, diminish_immutable ] ) => {\n\n\tconst diminish = float( diminish_immutable ).toVar();\n\tconst lacunarity = float( lacunarity_immutable ).toVar();\n\tconst octaves = int( octaves_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst c = vec3( mx_fractal_noise_vec3$1( p, octaves, lacunarity, diminish ) ).toVar();\n\tconst f = float( mx_fractal_noise_float$1( p.add( vec3( int( 19 ), int( 193 ), int( 17 ) ) ), octaves, lacunarity, diminish ) ).toVar();\n\n\treturn vec4( c, f );\n\n} ).setLayout( {\n\tname: 'mx_fractal_noise_vec4',\n\ttype: 'vec4',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'octaves', type: 'int' },\n\t\t{ name: 'lacunarity', type: 'float' },\n\t\t{ name: 'diminish', type: 'float' }\n\t]\n} );\n\nconst mx_worley_distance_0 = /*@__PURE__*/ Fn( ( [ p_immutable, x_immutable, y_immutable, xoff_immutable, yoff_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst yoff = int( yoff_immutable ).toVar();\n\tconst xoff = int( xoff_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst tmp = vec3( mx_cell_noise_vec3( vec2( x.add( xoff ), y.add( yoff ) ) ) ).toVar();\n\tconst off = vec2( tmp.x, tmp.y ).toVar();\n\toff.subAssign( 0.5 );\n\toff.mulAssign( jitter );\n\toff.addAssign( 0.5 );\n\tconst cellpos = vec2( vec2( float( x ), float( y ) ).add( off ) ).toVar();\n\tconst diff = vec2( cellpos.sub( p ) ).toVar();\n\n\tIf( metric.equal( int( 2 ) ), () => {\n\n\t\treturn abs( diff.x ).add( abs( diff.y ) );\n\n\t} );\n\n\tIf( metric.equal( int( 3 ) ), () => {\n\n\t\treturn max$1( abs( diff.x ), abs( diff.y ) );\n\n\t} );\n\n\treturn dot( diff, diff );\n\n} ).setLayout( {\n\tname: 'mx_worley_distance_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'xoff', type: 'int' },\n\t\t{ name: 'yoff', type: 'int' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_distance_1 = /*@__PURE__*/ Fn( ( [ p_immutable, x_immutable, y_immutable, z_immutable, xoff_immutable, yoff_immutable, zoff_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst zoff = int( zoff_immutable ).toVar();\n\tconst yoff = int( yoff_immutable ).toVar();\n\tconst xoff = int( xoff_immutable ).toVar();\n\tconst z = int( z_immutable ).toVar();\n\tconst y = int( y_immutable ).toVar();\n\tconst x = int( x_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst off = vec3( mx_cell_noise_vec3( vec3( x.add( xoff ), y.add( yoff ), z.add( zoff ) ) ) ).toVar();\n\toff.subAssign( 0.5 );\n\toff.mulAssign( jitter );\n\toff.addAssign( 0.5 );\n\tconst cellpos = vec3( vec3( float( x ), float( y ), float( z ) ).add( off ) ).toVar();\n\tconst diff = vec3( cellpos.sub( p ) ).toVar();\n\n\tIf( metric.equal( int( 2 ) ), () => {\n\n\t\treturn abs( diff.x ).add( abs( diff.y ) ).add( abs( diff.z ) );\n\n\t} );\n\n\tIf( metric.equal( int( 3 ) ), () => {\n\n\t\treturn max$1( max$1( abs( diff.x ), abs( diff.y ) ), abs( diff.z ) );\n\n\t} );\n\n\treturn dot( diff, diff );\n\n} ).setLayout( {\n\tname: 'mx_worley_distance_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'x', type: 'int' },\n\t\t{ name: 'y', type: 'int' },\n\t\t{ name: 'z', type: 'int' },\n\t\t{ name: 'xoff', type: 'int' },\n\t\t{ name: 'yoff', type: 'int' },\n\t\t{ name: 'zoff', type: 'int' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_distance = /*@__PURE__*/ overloadingFn( [ mx_worley_distance_0, mx_worley_distance_1 ] );\n\nconst mx_worley_noise_float_0 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst localpos = vec2( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ) ).toVar();\n\tconst sqdist = float( 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, X, Y, jitter, metric ) ).toVar();\n\t\t\tsqdist.assign( min$1( sqdist, dist ) );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_float_0',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec2_0 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst localpos = vec2( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ) ).toVar();\n\tconst sqdist = vec2( 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, X, Y, jitter, metric ) ).toVar();\n\n\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec2_0',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec3_0 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec2( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar();\n\tconst localpos = vec2( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ) ).toVar();\n\tconst sqdist = vec3( 1e6, 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, X, Y, jitter, metric ) ).toVar();\n\n\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t} ).ElseIf( dist.lessThan( sqdist.z ), () => {\n\n\t\t\t\tsqdist.z.assign( dist );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec3_0',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec2' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_float_1 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst localpos = vec3( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ), mx_floorfrac( p.z, Z ) ).toVar();\n\tconst sqdist = float( 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tLoop( { start: - 1, end: int( 1 ), name: 'z', condition: '<=' }, ( { z } ) => {\n\n\t\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, z, X, Y, Z, jitter, metric ) ).toVar();\n\t\t\t\tsqdist.assign( min$1( sqdist, dist ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_float_1',\n\ttype: 'float',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_float$1 = /*@__PURE__*/ overloadingFn( [ mx_worley_noise_float_0, mx_worley_noise_float_1 ] );\n\nconst mx_worley_noise_vec2_1 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst localpos = vec3( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ), mx_floorfrac( p.z, Z ) ).toVar();\n\tconst sqdist = vec2( 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tLoop( { start: - 1, end: int( 1 ), name: 'z', condition: '<=' }, ( { z } ) => {\n\n\t\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, z, X, Y, Z, jitter, metric ) ).toVar();\n\n\t\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec2_1',\n\ttype: 'vec2',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec2$1 = /*@__PURE__*/ overloadingFn( [ mx_worley_noise_vec2_0, mx_worley_noise_vec2_1 ] );\n\nconst mx_worley_noise_vec3_1 = /*@__PURE__*/ Fn( ( [ p_immutable, jitter_immutable, metric_immutable ] ) => {\n\n\tconst metric = int( metric_immutable ).toVar();\n\tconst jitter = float( jitter_immutable ).toVar();\n\tconst p = vec3( p_immutable ).toVar();\n\tconst X = int().toVar(), Y = int().toVar(), Z = int().toVar();\n\tconst localpos = vec3( mx_floorfrac( p.x, X ), mx_floorfrac( p.y, Y ), mx_floorfrac( p.z, Z ) ).toVar();\n\tconst sqdist = vec3( 1e6, 1e6, 1e6 ).toVar();\n\n\tLoop( { start: - 1, end: int( 1 ), name: 'x', condition: '<=' }, ( { x } ) => {\n\n\t\tLoop( { start: - 1, end: int( 1 ), name: 'y', condition: '<=' }, ( { y } ) => {\n\n\t\t\tLoop( { start: - 1, end: int( 1 ), name: 'z', condition: '<=' }, ( { z } ) => {\n\n\t\t\t\tconst dist = float( mx_worley_distance( localpos, x, y, z, X, Y, Z, jitter, metric ) ).toVar();\n\n\t\t\t\tIf( dist.lessThan( sqdist.x ), () => {\n\n\t\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\t\tsqdist.y.assign( sqdist.x );\n\t\t\t\t\tsqdist.x.assign( dist );\n\n\t\t\t\t} ).ElseIf( dist.lessThan( sqdist.y ), () => {\n\n\t\t\t\t\tsqdist.z.assign( sqdist.y );\n\t\t\t\t\tsqdist.y.assign( dist );\n\n\t\t\t\t} ).ElseIf( dist.lessThan( sqdist.z ), () => {\n\n\t\t\t\t\tsqdist.z.assign( dist );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t} );\n\n\t} );\n\n\tIf( metric.equal( int( 0 ) ), () => {\n\n\t\tsqdist.assign( sqrt( sqdist ) );\n\n\t} );\n\n\treturn sqdist;\n\n} ).setLayout( {\n\tname: 'mx_worley_noise_vec3_1',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'p', type: 'vec3' },\n\t\t{ name: 'jitter', type: 'float' },\n\t\t{ name: 'metric', type: 'int' }\n\t]\n} );\n\nconst mx_worley_noise_vec3$1 = /*@__PURE__*/ overloadingFn( [ mx_worley_noise_vec3_0, mx_worley_noise_vec3_1 ] );\n\n// Three.js Transpiler\n// https://github.com/AcademySoftwareFoundation/MaterialX/blob/main/libraries/stdlib/genglsl/lib/mx_hsv.glsl\n\n\nconst mx_hsvtorgb = /*@__PURE__*/ Fn( ( [ hsv ] ) => {\n\n\tconst s = hsv.y;\n\tconst v = hsv.z;\n\n\tconst result = vec3().toVar();\n\n\tIf( s.lessThan( 0.0001 ), () => {\n\n\t\tresult.assign( vec3( v, v, v ) );\n\n\t} ).Else( () => {\n\n\t\tlet h = hsv.x;\n\t\th = h.sub( floor( h ) ).mul( 6.0 ).toVar(); // TODO: check what .toVar() is needed in node system cache\n\t\tconst hi = int( trunc( h ) );\n\t\tconst f = h.sub( float( hi ) );\n\t\tconst p = v.mul( s.oneMinus() );\n\t\tconst q = v.mul( s.mul( f ).oneMinus() );\n\t\tconst t = v.mul( s.mul( f.oneMinus() ).oneMinus() );\n\n\t\tIf( hi.equal( int( 0 ) ), () => {\n\n\t\t\tresult.assign( vec3( v, t, p ) );\n\n\t\t} ).ElseIf( hi.equal( int( 1 ) ), () => {\n\n\t\t\tresult.assign( vec3( q, v, p ) );\n\n\t\t} ).ElseIf( hi.equal( int( 2 ) ), () => {\n\n\t\t\tresult.assign( vec3( p, v, t ) );\n\n\t\t} ).ElseIf( hi.equal( int( 3 ) ), () => {\n\n\t\t\tresult.assign( vec3( p, q, v ) );\n\n\t\t} ).ElseIf( hi.equal( int( 4 ) ), () => {\n\n\t\t\tresult.assign( vec3( t, p, v ) );\n\n\t\t} ).Else( () => {\n\n\t\t\tresult.assign( vec3( v, p, q ) );\n\n\t\t} );\n\n\t} );\n\n\treturn result;\n\n} ).setLayout( {\n\tname: 'mx_hsvtorgb',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'hsv', type: 'vec3' }\n\t]\n} );\n\nconst mx_rgbtohsv = /*@__PURE__*/ Fn( ( [ c_immutable ] ) => {\n\n\tconst c = vec3( c_immutable ).toVar();\n\tconst r = float( c.x ).toVar();\n\tconst g = float( c.y ).toVar();\n\tconst b = float( c.z ).toVar();\n\tconst mincomp = float( min$1( r, min$1( g, b ) ) ).toVar();\n\tconst maxcomp = float( max$1( r, max$1( g, b ) ) ).toVar();\n\tconst delta = float( maxcomp.sub( mincomp ) ).toVar();\n\tconst h = float().toVar(), s = float().toVar(), v = float().toVar();\n\tv.assign( maxcomp );\n\n\tIf( maxcomp.greaterThan( 0.0 ), () => {\n\n\t\ts.assign( delta.div( maxcomp ) );\n\n\t} ).Else( () => {\n\n\t\ts.assign( 0.0 );\n\n\t} );\n\n\tIf( s.lessThanEqual( 0.0 ), () => {\n\n\t\th.assign( 0.0 );\n\n\t} ).Else( () => {\n\n\t\tIf( r.greaterThanEqual( maxcomp ), () => {\n\n\t\t\th.assign( g.sub( b ).div( delta ) );\n\n\t\t} ).ElseIf( g.greaterThanEqual( maxcomp ), () => {\n\n\t\t\th.assign( add( 2.0, b.sub( r ).div( delta ) ) );\n\n\t\t} ).Else( () => {\n\n\t\t\th.assign( add( 4.0, r.sub( g ).div( delta ) ) );\n\n\t\t} );\n\n\t\th.mulAssign( 1.0 / 6.0 );\n\n\t\tIf( h.lessThan( 0.0 ), () => {\n\n\t\t\th.addAssign( 1.0 );\n\n\t\t} );\n\n\t} );\n\n\treturn vec3( h, s, v );\n\n} ).setLayout( {\n\tname: 'mx_rgbtohsv',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'c', type: 'vec3' }\n\t]\n} );\n\n// Three.js Transpiler\n// https://github.com/AcademySoftwareFoundation/MaterialX/blob/main/libraries/stdlib/genglsl/lib/mx_transform_color.glsl\n\n\nconst mx_srgb_texture_to_lin_rec709 = /*@__PURE__*/ Fn( ( [ color_immutable ] ) => {\n\n\tconst color = vec3( color_immutable ).toVar();\n\tconst isAbove = bvec3( greaterThan( color, vec3( 0.04045 ) ) ).toVar();\n\tconst linSeg = vec3( color.div( 12.92 ) ).toVar();\n\tconst powSeg = vec3( pow( max$1( color.add( vec3( 0.055 ) ), vec3( 0.0 ) ).div( 1.055 ), vec3( 2.4 ) ) ).toVar();\n\n\treturn mix( linSeg, powSeg, isAbove );\n\n} ).setLayout( {\n\tname: 'mx_srgb_texture_to_lin_rec709',\n\ttype: 'vec3',\n\tinputs: [\n\t\t{ name: 'color', type: 'vec3' }\n\t]\n} );\n\nconst mx_aastep = ( threshold, value ) => {\n\n\tthreshold = float( threshold );\n\tvalue = float( value );\n\n\tconst afwidth = vec2( value.dFdx(), value.dFdy() ).length().mul( 0.70710678118654757 );\n\n\treturn smoothstep( threshold.sub( afwidth ), threshold.add( afwidth ), value );\n\n};\n\nconst _ramp = ( a, b, uv, p ) => mix( a, b, uv[ p ].clamp() );\nconst mx_ramplr = ( valuel, valuer, texcoord = uv() ) => _ramp( valuel, valuer, texcoord, 'x' );\nconst mx_ramptb = ( valuet, valueb, texcoord = uv() ) => _ramp( valuet, valueb, texcoord, 'y' );\n\nconst _split = ( a, b, center, uv, p ) => mix( a, b, mx_aastep( center, uv[ p ] ) );\nconst mx_splitlr = ( valuel, valuer, center, texcoord = uv() ) => _split( valuel, valuer, center, texcoord, 'x' );\nconst mx_splittb = ( valuet, valueb, center, texcoord = uv() ) => _split( valuet, valueb, center, texcoord, 'y' );\n\nconst mx_transform_uv = ( uv_scale = 1, uv_offset = 0, uv_geo = uv() ) => uv_geo.mul( uv_scale ).add( uv_offset );\n\nconst mx_safepower = ( in1, in2 = 1 ) => {\n\n\tin1 = float( in1 );\n\n\treturn in1.abs().pow( in2 ).mul( in1.sign() );\n\n};\n\nconst mx_contrast = ( input, amount = 1, pivot = .5 ) => float( input ).sub( pivot ).mul( amount ).add( pivot );\n\nconst mx_noise_float = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => mx_perlin_noise_float( texcoord.convert( 'vec2|vec3' ) ).mul( amplitude ).add( pivot );\n//export const mx_noise_vec2 = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => mx_perlin_noise_vec3( texcoord.convert( 'vec2|vec3' ) ).mul( amplitude ).add( pivot );\nconst mx_noise_vec3 = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => mx_perlin_noise_vec3( texcoord.convert( 'vec2|vec3' ) ).mul( amplitude ).add( pivot );\nconst mx_noise_vec4 = ( texcoord = uv(), amplitude = 1, pivot = 0 ) => {\n\n\ttexcoord = texcoord.convert( 'vec2|vec3' ); // overloading type\n\n\tconst noise_vec4 = vec4( mx_perlin_noise_vec3( texcoord ), mx_perlin_noise_float( texcoord.add( vec2( 19, 73 ) ) ) );\n\n\treturn noise_vec4.mul( amplitude ).add( pivot );\n\n};\n\nconst mx_worley_noise_float = ( texcoord = uv(), jitter = 1 ) => mx_worley_noise_float$1( texcoord.convert( 'vec2|vec3' ), jitter, int( 1 ) );\nconst mx_worley_noise_vec2 = ( texcoord = uv(), jitter = 1 ) => mx_worley_noise_vec2$1( texcoord.convert( 'vec2|vec3' ), jitter, int( 1 ) );\nconst mx_worley_noise_vec3 = ( texcoord = uv(), jitter = 1 ) => mx_worley_noise_vec3$1( texcoord.convert( 'vec2|vec3' ), jitter, int( 1 ) );\n\nconst mx_cell_noise_float = ( texcoord = uv() ) => mx_cell_noise_float$1( texcoord.convert( 'vec2|vec3' ) );\n\nconst mx_fractal_noise_float = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_float$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\nconst mx_fractal_noise_vec2 = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_vec2$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\nconst mx_fractal_noise_vec3 = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_vec3$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\nconst mx_fractal_noise_vec4 = ( position = uv(), octaves = 3, lacunarity = 2, diminish = .5, amplitude = 1 ) => mx_fractal_noise_vec4$1( position, int( octaves ), lacunarity, diminish ).mul( amplitude );\n\n// https://devlog-martinsh.blogspot.com/2011/09/box-projected-cube-environment-mapping.html\n\nconst getParallaxCorrectNormal = /*@__PURE__*/ Fn( ( [ normal, cubeSize, cubePos ] ) => {\n\n\tconst nDir = normalize( normal ).toVar( 'nDir' );\n\tconst rbmax = sub( float( 0.5 ).mul( cubeSize.sub( cubePos ) ), positionWorld ).div( nDir ).toVar( 'rbmax' );\n\tconst rbmin = sub( float( - 0.5 ).mul( cubeSize.sub( cubePos ) ), positionWorld ).div( nDir ).toVar( 'rbmin' );\n\tconst rbminmax = vec3().toVar( 'rbminmax' );\n\trbminmax.x = nDir.x.greaterThan( float( 0 ) ).select( rbmax.x, rbmin.x );\n\trbminmax.y = nDir.y.greaterThan( float( 0 ) ).select( rbmax.y, rbmin.y );\n\trbminmax.z = nDir.z.greaterThan( float( 0 ) ).select( rbmax.z, rbmin.z );\n\n\tconst correction = min$1( min$1( rbminmax.x, rbminmax.y ), rbminmax.z ).toVar( 'correction' );\n\tconst boxIntersection = positionWorld.add( nDir.mul( correction ) ).toVar( 'boxIntersection' );\n\treturn boxIntersection.sub( cubePos );\n\n} );\n\nconst getShIrradianceAt = /*@__PURE__*/ Fn( ( [ normal, shCoefficients ] ) => {\n\n\t// normal is assumed to have unit length\n\n\tconst x = normal.x, y = normal.y, z = normal.z;\n\n\t// band 0\n\tlet result = shCoefficients.element( 0 ).mul( 0.886227 );\n\n\t// band 1\n\tresult = result.add( shCoefficients.element( 1 ).mul( 2.0 * 0.511664 ).mul( y ) );\n\tresult = result.add( shCoefficients.element( 2 ).mul( 2.0 * 0.511664 ).mul( z ) );\n\tresult = result.add( shCoefficients.element( 3 ).mul( 2.0 * 0.511664 ).mul( x ) );\n\n\t// band 2\n\tresult = result.add( shCoefficients.element( 4 ).mul( 2.0 * 0.429043 ).mul( x ).mul( y ) );\n\tresult = result.add( shCoefficients.element( 5 ).mul( 2.0 * 0.429043 ).mul( y ).mul( z ) );\n\tresult = result.add( shCoefficients.element( 6 ).mul( z.mul( z ).mul( 0.743125 ).sub( 0.247708 ) ) );\n\tresult = result.add( shCoefficients.element( 7 ).mul( 2.0 * 0.429043 ).mul( x ).mul( z ) );\n\tresult = result.add( shCoefficients.element( 8 ).mul( 0.429043 ).mul( mul( x, x ).sub( mul( y, y ) ) ) );\n\n\treturn result;\n\n} );\n\nconst _clearColor$1 = /*@__PURE__*/ new Color4();\n\nclass Background extends DataMap {\n\n\tconstructor( renderer, nodes ) {\n\n\t\tsuper();\n\n\t\tthis.renderer = renderer;\n\t\tthis.nodes = nodes;\n\n\t}\n\n\tupdate( scene, renderList, renderContext ) {\n\n\t\tconst renderer = this.renderer;\n\t\tconst background = this.nodes.getBackgroundNode( scene ) || scene.background;\n\n\t\tlet forceClear = false;\n\n\t\tif ( background === null ) {\n\n\t\t\t// no background settings, use clear color configuration from the renderer\n\n\t\t\trenderer._clearColor.getRGB( _clearColor$1, LinearSRGBColorSpace );\n\t\t\t_clearColor$1.a = renderer._clearColor.a;\n\n\t\t} else if ( background.isColor === true ) {\n\n\t\t\t// background is an opaque color\n\n\t\t\tbackground.getRGB( _clearColor$1, LinearSRGBColorSpace );\n\t\t\t_clearColor$1.a = 1;\n\n\t\t\tforceClear = true;\n\n\t\t} else if ( background.isNode === true ) {\n\n\t\t\tconst sceneData = this.get( scene );\n\t\t\tconst backgroundNode = background;\n\n\t\t\t_clearColor$1.copy( renderer._clearColor );\n\n\t\t\tlet backgroundMesh = sceneData.backgroundMesh;\n\n\t\t\tif ( backgroundMesh === undefined ) {\n\n\t\t\t\tconst backgroundMeshNode = context( vec4( backgroundNode ).mul( backgroundIntensity ), {\n\t\t\t\t\t// @TODO: Add Texture2D support using node context\n\t\t\t\t\tgetUV: () => backgroundRotation.mul( normalWorld ),\n\t\t\t\t\tgetTextureLevel: () => backgroundBlurriness\n\t\t\t\t} );\n\n\t\t\t\tlet viewProj = modelViewProjection();\n\t\t\t\tviewProj = viewProj.setZ( viewProj.w );\n\n\t\t\t\tconst nodeMaterial = new NodeMaterial();\n\t\t\t\tnodeMaterial.name = 'Background.material';\n\t\t\t\tnodeMaterial.side = BackSide;\n\t\t\t\tnodeMaterial.depthTest = false;\n\t\t\t\tnodeMaterial.depthWrite = false;\n\t\t\t\tnodeMaterial.fog = false;\n\t\t\t\tnodeMaterial.lights = false;\n\t\t\t\tnodeMaterial.vertexNode = viewProj;\n\t\t\t\tnodeMaterial.colorNode = backgroundMeshNode;\n\n\t\t\t\tsceneData.backgroundMeshNode = backgroundMeshNode;\n\t\t\t\tsceneData.backgroundMesh = backgroundMesh = new Mesh( new SphereGeometry( 1, 32, 32 ), nodeMaterial );\n\t\t\t\tbackgroundMesh.frustumCulled = false;\n\t\t\t\tbackgroundMesh.name = 'Background.mesh';\n\n\t\t\t\tbackgroundMesh.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\t\t\t\tthis.matrixWorld.copyPosition( camera.matrixWorld );\n\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tconst backgroundCacheKey = backgroundNode.getCacheKey();\n\n\t\t\tif ( sceneData.backgroundCacheKey !== backgroundCacheKey ) {\n\n\t\t\t\tsceneData.backgroundMeshNode.node = vec4( backgroundNode ).mul( backgroundIntensity );\n\t\t\t\tsceneData.backgroundMeshNode.needsUpdate = true;\n\n\t\t\t\tbackgroundMesh.material.needsUpdate = true;\n\n\t\t\t\tsceneData.backgroundCacheKey = backgroundCacheKey;\n\n\t\t\t}\n\n\t\t\trenderList.unshift( backgroundMesh, backgroundMesh.geometry, backgroundMesh.material, 0, 0, null );\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.Renderer: Unsupported background configuration.', background );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( renderer.autoClear === true || forceClear === true ) {\n\n\t\t\tconst clearColorValue = renderContext.clearColorValue;\n\n\t\t\tclearColorValue.r = _clearColor$1.r;\n\t\t\tclearColorValue.g = _clearColor$1.g;\n\t\t\tclearColorValue.b = _clearColor$1.b;\n\t\t\tclearColorValue.a = _clearColor$1.a;\n\n\t\t\t// premultiply alpha\n\n\t\t\tif ( renderer.backend.isWebGLBackend === true || renderer.alpha === true ) {\n\n\t\t\t\tclearColorValue.r *= clearColorValue.a;\n\t\t\t\tclearColorValue.g *= clearColorValue.a;\n\t\t\t\tclearColorValue.b *= clearColorValue.a;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\trenderContext.depthClearValue = renderer._clearDepth;\n\t\t\trenderContext.stencilClearValue = renderer._clearStencil;\n\n\t\t\trenderContext.clearColor = renderer.autoClearColor === true;\n\t\t\trenderContext.clearDepth = renderer.autoClearDepth === true;\n\t\t\trenderContext.clearStencil = renderer.autoClearStencil === true;\n\n\t\t} else {\n\n\t\t\trenderContext.clearColor = false;\n\t\t\trenderContext.clearDepth = false;\n\t\t\trenderContext.clearStencil = false;\n\n\t\t}\n\n\t}\n\n}\n\nlet _id$5 = 0;\n\nclass BindGroup {\n\n\tconstructor( name = '', bindings = [], index = 0, bindingsReference = [] ) {\n\n\t\tthis.name = name;\n\t\tthis.bindings = bindings;\n\t\tthis.index = index;\n\t\tthis.bindingsReference = bindingsReference;\n\n\t\tthis.id = _id$5 ++;\n\n\t}\n\n}\n\nclass NodeBuilderState {\n\n\tconstructor( vertexShader, fragmentShader, computeShader, nodeAttributes, bindings, updateNodes, updateBeforeNodes, updateAfterNodes, monitor, transforms = [] ) {\n\n\t\tthis.vertexShader = vertexShader;\n\t\tthis.fragmentShader = fragmentShader;\n\t\tthis.computeShader = computeShader;\n\t\tthis.transforms = transforms;\n\n\t\tthis.nodeAttributes = nodeAttributes;\n\t\tthis.bindings = bindings;\n\n\t\tthis.updateNodes = updateNodes;\n\t\tthis.updateBeforeNodes = updateBeforeNodes;\n\t\tthis.updateAfterNodes = updateAfterNodes;\n\n\t\tthis.monitor = monitor;\n\n\t\tthis.usedTimes = 0;\n\n\t}\n\n\tcreateBindings() {\n\n\t\tconst bindings = [];\n\n\t\tfor ( const instanceGroup of this.bindings ) {\n\n\t\t\tconst shared = instanceGroup.bindings[ 0 ].groupNode.shared;\n\n\t\t\tif ( shared !== true ) {\n\n\t\t\t\tconst bindingsGroup = new BindGroup( instanceGroup.name, [], instanceGroup.index, instanceGroup );\n\t\t\t\tbindings.push( bindingsGroup );\n\n\t\t\t\tfor ( const instanceBinding of instanceGroup.bindings ) {\n\n\t\t\t\t\tbindingsGroup.bindings.push( instanceBinding.clone() );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tbindings.push( instanceGroup );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindings;\n\n\t}\n\n}\n\nclass NodeAttribute {\n\n\tconstructor( name, type, node = null ) {\n\n\t\tthis.isNodeAttribute = true;\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.node = node;\n\n\t}\n\n}\n\nclass NodeUniform {\n\n\tconstructor( name, type, node ) {\n\n\t\tthis.isNodeUniform = true;\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.node = node.getSelf();\n\n\t}\n\n\tget value() {\n\n\t\treturn this.node.value;\n\n\t}\n\n\tset value( val ) {\n\n\t\tthis.node.value = val;\n\n\t}\n\n\tget id() {\n\n\t\treturn this.node.id;\n\n\t}\n\n\tget groupNode() {\n\n\t\treturn this.node.groupNode;\n\n\t}\n\n}\n\nclass NodeVar {\n\n\tconstructor( name, type ) {\n\n\t\tthis.isNodeVar = true;\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\n\t}\n\n}\n\nclass NodeVarying extends NodeVar {\n\n\tconstructor( name, type ) {\n\n\t\tsuper( name, type );\n\n\t\tthis.needsInterpolation = false;\n\n\t\tthis.isNodeVarying = true;\n\n\t}\n\n}\n\nclass NodeCode {\n\n\tconstructor( name, type, code = '' ) {\n\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.code = code;\n\n\t\tObject.defineProperty( this, 'isNodeCode', { value: true } );\n\n\t}\n\n}\n\nlet id = 0;\n\nclass NodeCache {\n\n\tconstructor( parent = null ) {\n\n\t\tthis.id = id ++;\n\t\tthis.nodesData = new WeakMap();\n\n\t\tthis.parent = parent;\n\n\t}\n\n\tgetData( node ) {\n\n\t\tlet data = this.nodesData.get( node );\n\n\t\tif ( data === undefined && this.parent !== null ) {\n\n\t\t\tdata = this.parent.getData( node );\n\n\t\t}\n\n\t\treturn data;\n\n\t}\n\n\tsetData( node, data ) {\n\n\t\tthis.nodesData.set( node, data );\n\n\t}\n\n}\n\nclass Uniform {\n\n\tconstructor( name, value ) {\n\n\t\tthis.name = name;\n\t\tthis.value = value;\n\n\t\tthis.boundary = 0; // used to build the uniform buffer according to the STD140 layout\n\t\tthis.itemSize = 0;\n\n\t\tthis.offset = 0; // this property is set by WebGPUUniformsGroup and marks the start position in the uniform buffer\n\n\t}\n\n\tsetValue( value ) {\n\n\t\tthis.value = value;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.value;\n\n\t}\n\n}\n\nclass NumberUniform extends Uniform {\n\n\tconstructor( name, value = 0 ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isNumberUniform = true;\n\n\t\tthis.boundary = 4;\n\t\tthis.itemSize = 1;\n\n\t}\n\n}\n\nclass Vector2Uniform extends Uniform {\n\n\tconstructor( name, value = new Vector2() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isVector2Uniform = true;\n\n\t\tthis.boundary = 8;\n\t\tthis.itemSize = 2;\n\n\t}\n\n}\n\nclass Vector3Uniform extends Uniform {\n\n\tconstructor( name, value = new Vector3() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isVector3Uniform = true;\n\n\t\tthis.boundary = 16;\n\t\tthis.itemSize = 3;\n\n\t}\n\n}\n\nclass Vector4Uniform extends Uniform {\n\n\tconstructor( name, value = new Vector4() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isVector4Uniform = true;\n\n\t\tthis.boundary = 16;\n\t\tthis.itemSize = 4;\n\n\t}\n\n}\n\nclass ColorUniform extends Uniform {\n\n\tconstructor( name, value = new Color() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isColorUniform = true;\n\n\t\tthis.boundary = 16;\n\t\tthis.itemSize = 3;\n\n\t}\n\n}\n\nclass Matrix3Uniform extends Uniform {\n\n\tconstructor( name, value = new Matrix3() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isMatrix3Uniform = true;\n\n\t\tthis.boundary = 48;\n\t\tthis.itemSize = 12;\n\n\t}\n\n}\n\nclass Matrix4Uniform extends Uniform {\n\n\tconstructor( name, value = new Matrix4() ) {\n\n\t\tsuper( name, value );\n\n\t\tthis.isMatrix4Uniform = true;\n\n\t\tthis.boundary = 64;\n\t\tthis.itemSize = 16;\n\n\t}\n\n}\n\nclass NumberNodeUniform extends NumberUniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass Vector2NodeUniform extends Vector2Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass Vector3NodeUniform extends Vector3Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass Vector4NodeUniform extends Vector4Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass ColorNodeUniform extends ColorUniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass Matrix3NodeUniform extends Matrix3Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass Matrix4NodeUniform extends Matrix4Uniform {\n\n\tconstructor( nodeUniform ) {\n\n\t\tsuper( nodeUniform.name, nodeUniform.value );\n\n\t\tthis.nodeUniform = nodeUniform;\n\n\t}\n\n\tgetValue() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nconst LOD_MIN = 4;\n\n// The standard deviations (radians) associated with the extra mips. These are\n// chosen to approximate a Trowbridge-Reitz distribution function times the\n// geometric shadowing function. These sigma values squared must match the\n// variance #defines in cube_uv_reflection_fragment.glsl.js.\nconst EXTRA_LOD_SIGMA = [ 0.125, 0.215, 0.35, 0.446, 0.526, 0.582 ];\n\n// The maximum length of the blur for loop. Smaller sigmas will use fewer\n// samples and exit early, but not recompile the shader.\nconst MAX_SAMPLES = 20;\n\nconst _flatCamera = /*@__PURE__*/ new OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\nconst _cubeCamera = /*@__PURE__*/ new PerspectiveCamera( 90, 1 );\nconst _clearColor = /*@__PURE__*/ new Color();\nlet _oldTarget = null;\nlet _oldActiveCubeFace = 0;\nlet _oldActiveMipmapLevel = 0;\n\n// Golden Ratio\nconst PHI = ( 1 + Math.sqrt( 5 ) ) / 2;\nconst INV_PHI = 1 / PHI;\n\n// Vertices of a dodecahedron (except the opposites, which represent the\n// same axis), used as axis directions evenly spread on a sphere.\nconst _axisDirections = [\n\t/*@__PURE__*/ new Vector3( - PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( PHI, INV_PHI, 0 ),\n\t/*@__PURE__*/ new Vector3( - INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( INV_PHI, 0, PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, - INV_PHI ),\n\t/*@__PURE__*/ new Vector3( 0, PHI, INV_PHI ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, - 1 ),\n\t/*@__PURE__*/ new Vector3( - 1, 1, 1 ),\n\t/*@__PURE__*/ new Vector3( 1, 1, 1 )\n];\n\n//\n\n// WebGPU Face indices\nconst _faceLib = [\n\t3, 1, 5,\n\t0, 4, 2\n];\n\nconst direction = getDirection( uv(), attribute( 'faceIndex' ) ).normalize();\nconst outputDirection = vec3( direction.x, direction.y.negate(), direction.z );\n\n/**\n * This class generates a Prefiltered, Mipmapped Radiance Environment Map\n * (PMREM) from a cubeMap environment texture. This allows different levels of\n * blur to be quickly accessed based on material roughness. It is packed into a\n * special CubeUV format that allows us to perform custom interpolation so that\n * we can support nonlinear formats such as RGBE. Unlike a traditional mipmap\n * chain, it only goes down to the LOD_MIN level (above), and then creates extra\n * even more filtered 'mips' at the same LOD_MIN resolution, associated with\n * higher roughness levels. In this way we maintain resolution to smoothly\n * interpolate diffuse lighting while limiting sampling computation.\n *\n * Paper: Fast, Accurate Image-Based Lighting\n * https://drive.google.com/file/d/15y8r_UpKlU9SvV4ILb0C3qCPecS8pvLz/view\n*/\n\nclass PMREMGenerator {\n\n\tconstructor( renderer ) {\n\n\t\tthis._renderer = renderer;\n\t\tthis._pingPongRenderTarget = null;\n\n\t\tthis._lodMax = 0;\n\t\tthis._cubeSize = 0;\n\t\tthis._lodPlanes = [];\n\t\tthis._sizeLods = [];\n\t\tthis._sigmas = [];\n\t\tthis._lodMeshes = [];\n\n\t\tthis._blurMaterial = null;\n\t\tthis._cubemapMaterial = null;\n\t\tthis._equirectMaterial = null;\n\t\tthis._backgroundBox = null;\n\n\t}\n\n\t/**\n\t * Generates a PMREM from a supplied Scene, which can be faster than using an\n\t * image if networking bandwidth is low. Optional sigma specifies a blur radius\n\t * in radians to be applied to the scene before PMREM generation. Optional near\n\t * and far planes ensure the scene is rendered in its entirety (the cubeCamera\n\t * is placed at the origin).\n\t */\n\tfromScene( scene, sigma = 0, near = 0.1, far = 100 ) {\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\t_oldActiveCubeFace = this._renderer.getActiveCubeFace();\n\t\t_oldActiveMipmapLevel = this._renderer.getActiveMipmapLevel();\n\n\t\tthis._setSize( 256 );\n\n\t\tconst cubeUVRenderTarget = this._allocateTargets();\n\t\tcubeUVRenderTarget.depthBuffer = true;\n\n\t\tthis._sceneToCubeUV( scene, near, far, cubeUVRenderTarget );\n\n\t\tif ( sigma > 0 ) {\n\n\t\t\tthis._blur( cubeUVRenderTarget, 0, 0, sigma );\n\n\t\t}\n\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an equirectangular texture, which can be either LDR\n\t * or HDR. The ideal input image size is 1k (1024 x 512),\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromEquirectangular( equirectangular, renderTarget = null ) {\n\n\t\treturn this._fromTexture( equirectangular, renderTarget );\n\n\t}\n\n\t/**\n\t * Generates a PMREM from an cubemap texture, which can be either LDR\n\t * or HDR. The ideal input cube size is 256 x 256,\n\t * as this matches best with the 256 x 256 cubemap output.\n\t */\n\tfromCubemap( cubemap, renderTarget = null ) {\n\n\t\treturn this._fromTexture( cubemap, renderTarget );\n\n\t}\n\n\t/**\n\t * Pre-compiles the cubemap shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tasync compileCubemapShader() {\n\n\t\tif ( this._cubemapMaterial === null ) {\n\n\t\t\tthis._cubemapMaterial = _getCubemapMaterial();\n\t\t\tawait this._compileMaterial( this._cubemapMaterial );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Pre-compiles the equirectangular shader. You can get faster start-up by invoking this method during\n\t * your texture's network fetch for increased concurrency.\n\t */\n\tasync compileEquirectangularShader() {\n\n\t\tif ( this._equirectMaterial === null ) {\n\n\t\t\tthis._equirectMaterial = _getEquirectMaterial();\n\t\t\tawait this._compileMaterial( this._equirectMaterial );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Disposes of the PMREMGenerator's internal memory. Note that PMREMGenerator is a static class,\n\t * so you should not need more than one PMREMGenerator object. If you do, calling dispose() on\n\t * one of them will cause any others to also become unusable.\n\t */\n\tdispose() {\n\n\t\tthis._dispose();\n\n\t\tif ( this._cubemapMaterial !== null ) this._cubemapMaterial.dispose();\n\t\tif ( this._equirectMaterial !== null ) this._equirectMaterial.dispose();\n\t\tif ( this._backgroundBox !== null ) {\n\n\t\t\tthis._backgroundBox.geometry.dispose();\n\t\t\tthis._backgroundBox.material.dispose();\n\n\t\t}\n\n\t}\n\n\t// private interface\n\n\t_setSize( cubeSize ) {\n\n\t\tthis._lodMax = Math.floor( Math.log2( cubeSize ) );\n\t\tthis._cubeSize = Math.pow( 2, this._lodMax );\n\n\t}\n\n\t_dispose() {\n\n\t\tif ( this._blurMaterial !== null ) this._blurMaterial.dispose();\n\n\t\tif ( this._pingPongRenderTarget !== null ) this._pingPongRenderTarget.dispose();\n\n\t\tfor ( let i = 0; i < this._lodPlanes.length; i ++ ) {\n\n\t\t\tthis._lodPlanes[ i ].dispose();\n\n\t\t}\n\n\t}\n\n\t_cleanup( outputTarget ) {\n\n\t\tthis._renderer.setRenderTarget( _oldTarget, _oldActiveCubeFace, _oldActiveMipmapLevel );\n\t\toutputTarget.scissorTest = false;\n\t\t_setViewport( outputTarget, 0, 0, outputTarget.width, outputTarget.height );\n\n\t}\n\n\t_fromTexture( texture, renderTarget ) {\n\n\t\tif ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping ) {\n\n\t\t\tthis._setSize( texture.image.length === 0 ? 16 : ( texture.image[ 0 ].width || texture.image[ 0 ].image.width ) );\n\n\t\t} else { // Equirectangular\n\n\t\t\tthis._setSize( texture.image.width / 4 );\n\n\t\t}\n\n\t\t_oldTarget = this._renderer.getRenderTarget();\n\t\t_oldActiveCubeFace = this._renderer.getActiveCubeFace();\n\t\t_oldActiveMipmapLevel = this._renderer.getActiveMipmapLevel();\n\n\t\tconst cubeUVRenderTarget = renderTarget || this._allocateTargets();\n\t\tthis._textureToCubeUV( texture, cubeUVRenderTarget );\n\t\tthis._applyPMREM( cubeUVRenderTarget );\n\t\tthis._cleanup( cubeUVRenderTarget );\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\t_allocateTargets() {\n\n\t\tconst width = 3 * Math.max( this._cubeSize, 16 * 7 );\n\t\tconst height = 4 * this._cubeSize;\n\n\t\tconst params = {\n\t\t\tmagFilter: LinearFilter,\n\t\t\tminFilter: LinearFilter,\n\t\t\tgenerateMipmaps: false,\n\t\t\ttype: HalfFloatType,\n\t\t\tformat: RGBAFormat,\n\t\t\tcolorSpace: LinearSRGBColorSpace,\n\t\t\t//depthBuffer: false\n\t\t};\n\n\t\tconst cubeUVRenderTarget = _createRenderTarget( width, height, params );\n\n\t\tif ( this._pingPongRenderTarget === null || this._pingPongRenderTarget.width !== width || this._pingPongRenderTarget.height !== height ) {\n\n\t\t\tif ( this._pingPongRenderTarget !== null ) {\n\n\t\t\t\tthis._dispose();\n\n\t\t\t}\n\n\t\t\tthis._pingPongRenderTarget = _createRenderTarget( width, height, params );\n\n\t\t\tconst { _lodMax } = this;\n\t\t\t( { sizeLods: this._sizeLods, lodPlanes: this._lodPlanes, sigmas: this._sigmas, lodMeshes: this._lodMeshes } = _createPlanes( _lodMax ) );\n\n\t\t\tthis._blurMaterial = _getBlurShader( _lodMax, width, height );\n\n\t\t}\n\n\t\treturn cubeUVRenderTarget;\n\n\t}\n\n\tasync _compileMaterial( material ) {\n\n\t\tconst tmpMesh = new Mesh( this._lodPlanes[ 0 ], material );\n\t\tawait this._renderer.compile( tmpMesh, _flatCamera );\n\n\t}\n\n\t_sceneToCubeUV( scene, near, far, cubeUVRenderTarget ) {\n\n\t\tconst cubeCamera = _cubeCamera;\n\t\tcubeCamera.near = near;\n\t\tcubeCamera.far = far;\n\n\t\t// px, py, pz, nx, ny, nz\n\t\tconst upSign = [ - 1, 1, - 1, - 1, - 1, - 1 ];\n\t\tconst forwardSign = [ 1, 1, 1, - 1, - 1, - 1 ];\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst originalAutoClear = renderer.autoClear;\n\n\t\trenderer.getClearColor( _clearColor );\n\n\t\trenderer.autoClear = false;\n\n\t\tlet backgroundBox = this._backgroundBox;\n\n\t\tif ( backgroundBox === null ) {\n\n\t\t\tconst backgroundMaterial = new MeshBasicMaterial( {\n\t\t\t\tname: 'PMREM.Background',\n\t\t\t\tside: BackSide,\n\t\t\t\tdepthWrite: false,\n\t\t\t\tdepthTest: false\n\t\t\t} );\n\n\t\t\tbackgroundBox = new Mesh( new BoxGeometry(), backgroundMaterial );\n\n\t\t}\n\n\t\tlet useSolidColor = false;\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tif ( background.isColor ) {\n\n\t\t\t\tbackgroundBox.material.color.copy( background );\n\t\t\t\tscene.background = null;\n\t\t\t\tuseSolidColor = true;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbackgroundBox.material.color.copy( _clearColor );\n\t\t\tuseSolidColor = true;\n\n\t\t}\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\n\t\trenderer.clear();\n\n\t\tif ( useSolidColor ) {\n\n\t\t\trenderer.render( backgroundBox, cubeCamera );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst col = i % 3;\n\n\t\t\tif ( col === 0 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( forwardSign[ i ], 0, 0 );\n\n\t\t\t} else if ( col === 1 ) {\n\n\t\t\t\tcubeCamera.up.set( 0, 0, upSign[ i ] );\n\t\t\t\tcubeCamera.lookAt( 0, forwardSign[ i ], 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcubeCamera.up.set( 0, upSign[ i ], 0 );\n\t\t\t\tcubeCamera.lookAt( 0, 0, forwardSign[ i ] );\n\n\t\t\t}\n\n\t\t\tconst size = this._cubeSize;\n\n\t\t\t_setViewport( cubeUVRenderTarget, col * size, i > 2 ? size : 0, size, size );\n\n\t\t\trenderer.render( scene, cubeCamera );\n\n\t\t}\n\n\t\trenderer.autoClear = originalAutoClear;\n\t\tscene.background = background;\n\n\t}\n\n\t_textureToCubeUV( texture, cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst isCubeTexture = ( texture.mapping === CubeReflectionMapping || texture.mapping === CubeRefractionMapping );\n\n\t\tif ( isCubeTexture ) {\n\n\t\t\tif ( this._cubemapMaterial === null ) {\n\n\t\t\t\tthis._cubemapMaterial = _getCubemapMaterial( texture );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this._equirectMaterial === null ) {\n\n\t\t\t\tthis._equirectMaterial = _getEquirectMaterial( texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst material = isCubeTexture ? this._cubemapMaterial : this._equirectMaterial;\n\t\tmaterial.fragmentNode.value = texture;\n\n\t\tconst mesh = this._lodMeshes[ 0 ];\n\t\tmesh.material = material;\n\n\t\tconst size = this._cubeSize;\n\n\t\t_setViewport( cubeUVRenderTarget, 0, 0, 3 * size, 2 * size );\n\n\t\trenderer.setRenderTarget( cubeUVRenderTarget );\n\t\trenderer.render( mesh, _flatCamera );\n\n\t}\n\n\t_applyPMREM( cubeUVRenderTarget ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst autoClear = renderer.autoClear;\n\t\trenderer.autoClear = false;\n\t\tconst n = this._lodPlanes.length;\n\n\t\tfor ( let i = 1; i < n; i ++ ) {\n\n\t\t\tconst sigma = Math.sqrt( this._sigmas[ i ] * this._sigmas[ i ] - this._sigmas[ i - 1 ] * this._sigmas[ i - 1 ] );\n\n\t\t\tconst poleAxis = _axisDirections[ ( n - i - 1 ) % _axisDirections.length ];\n\n\t\t\tthis._blur( cubeUVRenderTarget, i - 1, i, sigma, poleAxis );\n\n\t\t}\n\n\t\trenderer.autoClear = autoClear;\n\n\t}\n\n\t/**\n\t * This is a two-pass Gaussian blur for a cubemap. Normally this is done\n\t * vertically and horizontally, but this breaks down on a cube. Here we apply\n\t * the blur latitudinally (around the poles), and then longitudinally (towards\n\t * the poles) to approximate the orthogonally-separable blur. It is least\n\t * accurate at the poles, but still does a decent job.\n\t */\n\t_blur( cubeUVRenderTarget, lodIn, lodOut, sigma, poleAxis ) {\n\n\t\tconst pingPongRenderTarget = this._pingPongRenderTarget;\n\n\t\tthis._halfBlur(\n\t\t\tcubeUVRenderTarget,\n\t\t\tpingPongRenderTarget,\n\t\t\tlodIn,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'latitudinal',\n\t\t\tpoleAxis );\n\n\t\tthis._halfBlur(\n\t\t\tpingPongRenderTarget,\n\t\t\tcubeUVRenderTarget,\n\t\t\tlodOut,\n\t\t\tlodOut,\n\t\t\tsigma,\n\t\t\t'longitudinal',\n\t\t\tpoleAxis );\n\n\t}\n\n\t_halfBlur( targetIn, targetOut, lodIn, lodOut, sigmaRadians, direction, poleAxis ) {\n\n\t\tconst renderer = this._renderer;\n\t\tconst blurMaterial = this._blurMaterial;\n\n\t\tif ( direction !== 'latitudinal' && direction !== 'longitudinal' ) {\n\n\t\t\tconsole.error( 'blur direction must be either latitudinal or longitudinal!' );\n\n\t\t}\n\n\t\t// Number of standard deviations at which to cut off the discrete approximation.\n\t\tconst STANDARD_DEVIATIONS = 3;\n\n\t\tconst blurMesh = this._lodMeshes[ lodOut ];\n\t\tblurMesh.material = blurMaterial;\n\n\t\tconst blurUniforms = blurMaterial.uniforms;\n\n\t\tconst pixels = this._sizeLods[ lodIn ] - 1;\n\t\tconst radiansPerPixel = isFinite( sigmaRadians ) ? Math.PI / ( 2 * pixels ) : 2 * Math.PI / ( 2 * MAX_SAMPLES - 1 );\n\t\tconst sigmaPixels = sigmaRadians / radiansPerPixel;\n\t\tconst samples = isFinite( sigmaRadians ) ? 1 + Math.floor( STANDARD_DEVIATIONS * sigmaPixels ) : MAX_SAMPLES;\n\n\t\tif ( samples > MAX_SAMPLES ) {\n\n\t\t\tconsole.warn( `sigmaRadians, ${\n\t\t\t\tsigmaRadians}, is too large and will clip, as it requested ${\n\t\t\t\tsamples} samples when the maximum is set to ${MAX_SAMPLES}` );\n\n\t\t}\n\n\t\tconst weights = [];\n\t\tlet sum = 0;\n\n\t\tfor ( let i = 0; i < MAX_SAMPLES; ++ i ) {\n\n\t\t\tconst x = i / sigmaPixels;\n\t\t\tconst weight = Math.exp( - x * x / 2 );\n\t\t\tweights.push( weight );\n\n\t\t\tif ( i === 0 ) {\n\n\t\t\t\tsum += weight;\n\n\t\t\t} else if ( i < samples ) {\n\n\t\t\t\tsum += 2 * weight;\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < weights.length; i ++ ) {\n\n\t\t\tweights[ i ] = weights[ i ] / sum;\n\n\t\t}\n\n\t\ttargetIn.texture.frame = ( targetIn.texture.frame || 0 ) + 1;\n\n\t\tblurUniforms.envMap.value = targetIn.texture;\n\t\tblurUniforms.samples.value = samples;\n\t\tblurUniforms.weights.array = weights;\n\t\tblurUniforms.latitudinal.value = direction === 'latitudinal' ? 1 : 0;\n\n\t\tif ( poleAxis ) {\n\n\t\t\tblurUniforms.poleAxis.value = poleAxis;\n\n\t\t}\n\n\t\tconst { _lodMax } = this;\n\t\tblurUniforms.dTheta.value = radiansPerPixel;\n\t\tblurUniforms.mipInt.value = _lodMax - lodIn;\n\n\t\tconst outputSize = this._sizeLods[ lodOut ];\n\t\tconst x = 3 * outputSize * ( lodOut > _lodMax - LOD_MIN ? lodOut - _lodMax + LOD_MIN : 0 );\n\t\tconst y = 4 * ( this._cubeSize - outputSize );\n\n\t\t_setViewport( targetOut, x, y, 3 * outputSize, 2 * outputSize );\n\t\trenderer.setRenderTarget( targetOut );\n\t\trenderer.render( blurMesh, _flatCamera );\n\n\t}\n\n}\n\nfunction _createPlanes( lodMax ) {\n\n\tconst lodPlanes = [];\n\tconst sizeLods = [];\n\tconst sigmas = [];\n\tconst lodMeshes = [];\n\n\tlet lod = lodMax;\n\n\tconst totalLods = lodMax - LOD_MIN + 1 + EXTRA_LOD_SIGMA.length;\n\n\tfor ( let i = 0; i < totalLods; i ++ ) {\n\n\t\tconst sizeLod = Math.pow( 2, lod );\n\t\tsizeLods.push( sizeLod );\n\t\tlet sigma = 1.0 / sizeLod;\n\n\t\tif ( i > lodMax - LOD_MIN ) {\n\n\t\t\tsigma = EXTRA_LOD_SIGMA[ i - lodMax + LOD_MIN - 1 ];\n\n\t\t} else if ( i === 0 ) {\n\n\t\t\tsigma = 0;\n\n\t\t}\n\n\t\tsigmas.push( sigma );\n\n\t\tconst texelSize = 1.0 / ( sizeLod - 2 );\n\t\tconst min = - texelSize;\n\t\tconst max = 1 + texelSize;\n\t\tconst uv1 = [ min, min, max, min, max, max, min, min, max, max, min, max ];\n\n\t\tconst cubeFaces = 6;\n\t\tconst vertices = 6;\n\t\tconst positionSize = 3;\n\t\tconst uvSize = 2;\n\t\tconst faceIndexSize = 1;\n\n\t\tconst position = new Float32Array( positionSize * vertices * cubeFaces );\n\t\tconst uv = new Float32Array( uvSize * vertices * cubeFaces );\n\t\tconst faceIndex = new Float32Array( faceIndexSize * vertices * cubeFaces );\n\n\t\tfor ( let face = 0; face < cubeFaces; face ++ ) {\n\n\t\t\tconst x = ( face % 3 ) * 2 / 3 - 1;\n\t\t\tconst y = face > 2 ? 0 : - 1;\n\t\t\tconst coordinates = [\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y, 0,\n\t\t\t\tx + 2 / 3, y + 1, 0,\n\t\t\t\tx, y + 1, 0\n\t\t\t];\n\n\t\t\tconst faceIdx = _faceLib[ face ];\n\t\t\tposition.set( coordinates, positionSize * vertices * faceIdx );\n\t\t\tuv.set( uv1, uvSize * vertices * faceIdx );\n\t\t\tconst fill = [ faceIdx, faceIdx, faceIdx, faceIdx, faceIdx, faceIdx ];\n\t\t\tfaceIndex.set( fill, faceIndexSize * vertices * faceIdx );\n\n\t\t}\n\n\t\tconst planes = new BufferGeometry();\n\t\tplanes.setAttribute( 'position', new BufferAttribute( position, positionSize ) );\n\t\tplanes.setAttribute( 'uv', new BufferAttribute( uv, uvSize ) );\n\t\tplanes.setAttribute( 'faceIndex', new BufferAttribute( faceIndex, faceIndexSize ) );\n\t\tlodPlanes.push( planes );\n\t\tlodMeshes.push( new Mesh( planes, null ) );\n\n\t\tif ( lod > LOD_MIN ) {\n\n\t\t\tlod --;\n\n\t\t}\n\n\t}\n\n\treturn { lodPlanes, sizeLods, sigmas, lodMeshes };\n\n}\n\nfunction _createRenderTarget( width, height, params ) {\n\n\tconst cubeUVRenderTarget = new RenderTarget( width, height, params );\n\tcubeUVRenderTarget.texture.mapping = CubeUVReflectionMapping;\n\tcubeUVRenderTarget.texture.name = 'PMREM.cubeUv';\n\tcubeUVRenderTarget.texture.isPMREMTexture = true;\n\tcubeUVRenderTarget.scissorTest = true;\n\treturn cubeUVRenderTarget;\n\n}\n\nfunction _setViewport( target, x, y, width, height ) {\n\n\ttarget.viewport.set( x, y, width, height );\n\ttarget.scissor.set( x, y, width, height );\n\n}\n\nfunction _getMaterial( type ) {\n\n\tconst material = new NodeMaterial();\n\tmaterial.depthTest = false;\n\tmaterial.depthWrite = false;\n\tmaterial.blending = NoBlending;\n\tmaterial.name = `PMREM_${ type }`;\n\n\treturn material;\n\n}\n\nfunction _getBlurShader( lodMax, width, height ) {\n\n\tconst weights = uniformArray( new Array( MAX_SAMPLES ).fill( 0 ) );\n\tconst poleAxis = uniform( new Vector3( 0, 1, 0 ) );\n\tconst dTheta = uniform( 0 );\n\tconst n = float( MAX_SAMPLES );\n\tconst latitudinal = uniform( 0 ); // false, bool\n\tconst samples = uniform( 1 ); // int\n\tconst envMap = texture( null );\n\tconst mipInt = uniform( 0 ); // int\n\tconst CUBEUV_TEXEL_WIDTH = float( 1 / width );\n\tconst CUBEUV_TEXEL_HEIGHT = float( 1 / height );\n\tconst CUBEUV_MAX_MIP = float( lodMax );\n\n\tconst materialUniforms = {\n\t\tn,\n\t\tlatitudinal,\n\t\tweights,\n\t\tpoleAxis,\n\t\toutputDirection,\n\t\tdTheta,\n\t\tsamples,\n\t\tenvMap,\n\t\tmipInt,\n\t\tCUBEUV_TEXEL_WIDTH,\n\t\tCUBEUV_TEXEL_HEIGHT,\n\t\tCUBEUV_MAX_MIP\n\t};\n\n\tconst material = _getMaterial( 'blur' );\n\tmaterial.uniforms = materialUniforms; // TODO: Move to outside of the material\n\tmaterial.fragmentNode = blur( { ...materialUniforms, latitudinal: latitudinal.equal( 1 ) } );\n\n\treturn material;\n\n}\n\nfunction _getCubemapMaterial( envTexture ) {\n\n\tconst material = _getMaterial( 'cubemap' );\n\tmaterial.fragmentNode = cubeTexture( envTexture, outputDirection );\n\n\treturn material;\n\n}\n\nfunction _getEquirectMaterial( envTexture ) {\n\n\tconst material = _getMaterial( 'equirect' );\n\tmaterial.fragmentNode = texture( envTexture, equirectUV( outputDirection ), 0 );\n\n\treturn material;\n\n}\n\nconst rendererCache = new WeakMap();\n\nconst typeFromLength = new Map( [\n\t[ 2, 'vec2' ],\n\t[ 3, 'vec3' ],\n\t[ 4, 'vec4' ],\n\t[ 9, 'mat3' ],\n\t[ 16, 'mat4' ]\n] );\n\nconst typeFromArray = new Map( [\n\t[ Int8Array, 'int' ],\n\t[ Int16Array, 'int' ],\n\t[ Int32Array, 'int' ],\n\t[ Uint8Array, 'uint' ],\n\t[ Uint16Array, 'uint' ],\n\t[ Uint32Array, 'uint' ],\n\t[ Float32Array, 'float' ]\n] );\n\nconst toFloat = ( value ) => {\n\n\tif ( /e/g.test( value ) ) {\n\n\t\treturn String( value ).replace( /\\+/g, '' );\n\n\t} else {\n\n\t\tvalue = Number( value );\n\n\t\treturn value + ( value % 1 ? '' : '.0' );\n\n\t}\n\n};\n\nclass NodeBuilder {\n\n\tconstructor( object, renderer, parser ) {\n\n\t\tthis.object = object;\n\t\tthis.material = ( object && object.material ) || null;\n\t\tthis.geometry = ( object && object.geometry ) || null;\n\t\tthis.renderer = renderer;\n\t\tthis.parser = parser;\n\t\tthis.scene = null;\n\t\tthis.camera = null;\n\n\t\tthis.nodes = [];\n\t\tthis.sequentialNodes = [];\n\t\tthis.updateNodes = [];\n\t\tthis.updateBeforeNodes = [];\n\t\tthis.updateAfterNodes = [];\n\t\tthis.hashNodes = {};\n\n\t\tthis.monitor = null;\n\n\t\tthis.lightsNode = null;\n\t\tthis.environmentNode = null;\n\t\tthis.fogNode = null;\n\n\t\tthis.clippingContext = null;\n\n\t\tthis.vertexShader = null;\n\t\tthis.fragmentShader = null;\n\t\tthis.computeShader = null;\n\n\t\tthis.flowNodes = { vertex: [], fragment: [], compute: [] };\n\t\tthis.flowCode = { vertex: '', fragment: '', compute: '' };\n\t\tthis.uniforms = { vertex: [], fragment: [], compute: [], index: 0 };\n\t\tthis.structs = { vertex: [], fragment: [], compute: [], index: 0 };\n\t\tthis.bindings = { vertex: {}, fragment: {}, compute: {} };\n\t\tthis.bindingsIndexes = {};\n\t\tthis.bindGroups = null;\n\t\tthis.attributes = [];\n\t\tthis.bufferAttributes = [];\n\t\tthis.varyings = [];\n\t\tthis.codes = {};\n\t\tthis.vars = {};\n\t\tthis.flow = { code: '' };\n\t\tthis.chaining = [];\n\t\tthis.stack = stack();\n\t\tthis.stacks = [];\n\t\tthis.tab = '\\t';\n\n\t\tthis.currentFunctionNode = null;\n\n\t\tthis.context = {\n\t\t\tmaterial: this.material\n\t\t};\n\n\t\tthis.cache = new NodeCache();\n\t\tthis.globalCache = this.cache;\n\n\t\tthis.flowsData = new WeakMap();\n\n\t\tthis.shaderStage = null;\n\t\tthis.buildStage = null;\n\n\t\tthis.useComparisonMethod = false;\n\n\t}\n\n\tgetBindGroupsCache() {\n\n\t\tlet bindGroupsCache = rendererCache.get( this.renderer );\n\n\t\tif ( bindGroupsCache === undefined ) {\n\n\t\t\tbindGroupsCache = new ChainMap();\n\n\t\t\trendererCache.set( this.renderer, bindGroupsCache );\n\n\t\t}\n\n\t\treturn bindGroupsCache;\n\n\t}\n\n\tcreateRenderTarget( width, height, options ) {\n\n\t\treturn new RenderTarget( width, height, options );\n\n\t}\n\n\tcreateCubeRenderTarget( size, options ) {\n\n\t\treturn new CubeRenderTarget( size, options );\n\n\t}\n\n\tcreatePMREMGenerator() {\n\n\t\t// TODO: Move Materials.js to outside of the Nodes.js in order to remove this function and improve tree-shaking support\n\n\t\treturn new PMREMGenerator( this.renderer );\n\n\t}\n\n\tincludes( node ) {\n\n\t\treturn this.nodes.includes( node );\n\n\t}\n\n\t_getBindGroup( groupName, bindings ) {\n\n\t\tconst bindGroupsCache = this.getBindGroupsCache();\n\n\t\t//\n\n\t\tconst bindingsArray = [];\n\n\t\tlet sharedGroup = true;\n\n\t\tfor ( const binding of bindings ) {\n\n\t\t\tbindingsArray.push( binding );\n\n\t\t\tsharedGroup = sharedGroup && binding.groupNode.shared !== true;\n\n\t\t}\n\n\t\t//\n\n\t\tlet bindGroup;\n\n\t\tif ( sharedGroup ) {\n\n\t\t\tbindGroup = bindGroupsCache.get( bindingsArray );\n\n\t\t\tif ( bindGroup === undefined ) {\n\n\t\t\t\tbindGroup = new BindGroup( groupName, bindingsArray, this.bindingsIndexes[ groupName ].group, bindingsArray );\n\n\t\t\t\tbindGroupsCache.set( bindingsArray, bindGroup );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tbindGroup = new BindGroup( groupName, bindingsArray, this.bindingsIndexes[ groupName ].group, bindingsArray );\n\n\t\t}\n\n\t\treturn bindGroup;\n\n\t}\n\n\tgetBindGroupArray( groupName, shaderStage ) {\n\n\t\tconst bindings = this.bindings[ shaderStage ];\n\n\t\tlet bindGroup = bindings[ groupName ];\n\n\t\tif ( bindGroup === undefined ) {\n\n\t\t\tif ( this.bindingsIndexes[ groupName ] === undefined ) {\n\n\t\t\t\tthis.bindingsIndexes[ groupName ] = { binding: 0, group: Object.keys( this.bindingsIndexes ).length };\n\n\t\t\t}\n\n\t\t\tbindings[ groupName ] = bindGroup = [];\n\n\t\t}\n\n\t\treturn bindGroup;\n\n\t}\n\n\tgetBindings() {\n\n\t\tlet bindingsGroups = this.bindGroups;\n\n\t\tif ( bindingsGroups === null ) {\n\n\t\t\tconst groups = {};\n\t\t\tconst bindings = this.bindings;\n\n\t\t\tfor ( const shaderStage of shaderStages ) {\n\n\t\t\t\tfor ( const groupName in bindings[ shaderStage ] ) {\n\n\t\t\t\t\tconst uniforms = bindings[ shaderStage ][ groupName ];\n\n\t\t\t\t\tconst groupUniforms = groups[ groupName ] || ( groups[ groupName ] = [] );\n\t\t\t\t\tgroupUniforms.push( ...uniforms );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tbindingsGroups = [];\n\n\t\t\tfor ( const groupName in groups ) {\n\n\t\t\t\tconst group = groups[ groupName ];\n\n\t\t\t\tconst bindingsGroup = this._getBindGroup( groupName, group );\n\n\t\t\t\tbindingsGroups.push( bindingsGroup );\n\n\t\t\t}\n\n\t\t\tthis.bindGroups = bindingsGroups;\n\n\t\t}\n\n\t\treturn bindingsGroups;\n\n\t}\n\n\tsortBindingGroups() {\n\n\t\tconst bindingsGroups = this.getBindings();\n\n\t\tbindingsGroups.sort( ( a, b ) => ( a.bindings[ 0 ].groupNode.order - b.bindings[ 0 ].groupNode.order ) );\n\n\t\tfor ( let i = 0; i < bindingsGroups.length; i ++ ) {\n\n\t\t\tconst bindingGroup = bindingsGroups[ i ];\n\t\t\tthis.bindingsIndexes[ bindingGroup.name ].group = i;\n\n\t\t\tbindingGroup.index = i;\n\n\t\t}\n\n\t}\n\n\tsetHashNode( node, hash ) {\n\n\t\tthis.hashNodes[ hash ] = node;\n\n\t}\n\n\taddNode( node ) {\n\n\t\tif ( this.nodes.includes( node ) === false ) {\n\n\t\t\tthis.nodes.push( node );\n\n\t\t\tthis.setHashNode( node, node.getHash( this ) );\n\n\t\t}\n\n\t}\n\n\taddSequentialNode( node ) {\n\n\t\tif ( this.sequentialNodes.includes( node ) === false ) {\n\n\t\t\tthis.sequentialNodes.push( node );\n\n\t\t}\n\n\t}\n\n\tbuildUpdateNodes() {\n\n\t\tfor ( const node of this.nodes ) {\n\n\t\t\tconst updateType = node.getUpdateType();\n\n\t\t\tif ( updateType !== NodeUpdateType.NONE ) {\n\n\t\t\t\tthis.updateNodes.push( node.getSelf() );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const node of this.sequentialNodes ) {\n\n\t\t\tconst updateBeforeType = node.getUpdateBeforeType();\n\t\t\tconst updateAfterType = node.getUpdateAfterType();\n\n\t\t\tif ( updateBeforeType !== NodeUpdateType.NONE ) {\n\n\t\t\t\tthis.updateBeforeNodes.push( node.getSelf() );\n\n\t\t\t}\n\n\t\t\tif ( updateAfterType !== NodeUpdateType.NONE ) {\n\n\t\t\t\tthis.updateAfterNodes.push( node.getSelf() );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tget currentNode() {\n\n\t\treturn this.chaining[ this.chaining.length - 1 ];\n\n\t}\n\n\tisFilteredTexture( texture ) {\n\n\t\treturn ( texture.magFilter === LinearFilter || texture.magFilter === LinearMipmapNearestFilter || texture.magFilter === NearestMipmapLinearFilter || texture.magFilter === LinearMipmapLinearFilter ||\n\t\t\ttexture.minFilter === LinearFilter || texture.minFilter === LinearMipmapNearestFilter || texture.minFilter === NearestMipmapLinearFilter || texture.minFilter === LinearMipmapLinearFilter );\n\n\t}\n\n\taddChain( node ) {\n\n\t\t/*\n\t\tif ( this.chaining.indexOf( node ) !== - 1 ) {\n\n\t\t\tconsole.warn( 'Recursive node: ', node );\n\n\t\t}\n\t\t*/\n\n\t\tthis.chaining.push( node );\n\n\t}\n\n\tremoveChain( node ) {\n\n\t\tconst lastChain = this.chaining.pop();\n\n\t\tif ( lastChain !== node ) {\n\n\t\t\tthrow new Error( 'NodeBuilder: Invalid node chaining!' );\n\n\t\t}\n\n\t}\n\n\tgetMethod( method ) {\n\n\t\treturn method;\n\n\t}\n\n\tgetNodeFromHash( hash ) {\n\n\t\treturn this.hashNodes[ hash ];\n\n\t}\n\n\taddFlow( shaderStage, node ) {\n\n\t\tthis.flowNodes[ shaderStage ].push( node );\n\n\t\treturn node;\n\n\t}\n\n\tsetContext( context ) {\n\n\t\tthis.context = context;\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.context;\n\n\t}\n\n\tgetSharedContext() {\n\n\t\t({ ...this.context });\n\n\t\treturn this.context;\n\n\t}\n\n\tsetCache( cache ) {\n\n\t\tthis.cache = cache;\n\n\t}\n\n\tgetCache() {\n\n\t\treturn this.cache;\n\n\t}\n\n\tgetCacheFromNode( node, parent = true ) {\n\n\t\tconst data = this.getDataFromNode( node );\n\t\tif ( data.cache === undefined ) data.cache = new NodeCache( parent ? this.getCache() : null );\n\n\t\treturn data.cache;\n\n\t}\n\n\tisAvailable( /*name*/ ) {\n\n\t\treturn false;\n\n\t}\n\n\tgetVertexIndex() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetInstanceIndex() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetDrawIndex() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetFrontFacing() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetFragCoord() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tisFlipY() {\n\n\t\treturn false;\n\n\t}\n\n\tincreaseUsage( node ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\t\tnodeData.usageCount = nodeData.usageCount === undefined ? 1 : nodeData.usageCount + 1;\n\n\t\treturn nodeData.usageCount;\n\n\t}\n\n\tgenerateTexture( /* texture, textureProperty, uvSnippet */ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgenerateTextureLod( /* texture, textureProperty, uvSnippet, levelSnippet */ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgenerateConst( type, value = null ) {\n\n\t\tif ( value === null ) {\n\n\t\t\tif ( type === 'float' || type === 'int' || type === 'uint' ) value = 0;\n\t\t\telse if ( type === 'bool' ) value = false;\n\t\t\telse if ( type === 'color' ) value = new Color();\n\t\t\telse if ( type === 'vec2' ) value = new Vector2();\n\t\t\telse if ( type === 'vec3' ) value = new Vector3();\n\t\t\telse if ( type === 'vec4' ) value = new Vector4();\n\n\t\t}\n\n\t\tif ( type === 'float' ) return toFloat( value );\n\t\tif ( type === 'int' ) return `${ Math.round( value ) }`;\n\t\tif ( type === 'uint' ) return value >= 0 ? `${ Math.round( value ) }u` : '0u';\n\t\tif ( type === 'bool' ) return value ? 'true' : 'false';\n\t\tif ( type === 'color' ) return `${ this.getType( 'vec3' ) }( ${ toFloat( value.r ) }, ${ toFloat( value.g ) }, ${ toFloat( value.b ) } )`;\n\n\t\tconst typeLength = this.getTypeLength( type );\n\n\t\tconst componentType = this.getComponentType( type );\n\n\t\tconst generateConst = value => this.generateConst( componentType, value );\n\n\t\tif ( typeLength === 2 ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ generateConst( value.x ) }, ${ generateConst( value.y ) } )`;\n\n\t\t} else if ( typeLength === 3 ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ generateConst( value.x ) }, ${ generateConst( value.y ) }, ${ generateConst( value.z ) } )`;\n\n\t\t} else if ( typeLength === 4 ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ generateConst( value.x ) }, ${ generateConst( value.y ) }, ${ generateConst( value.z ) }, ${ generateConst( value.w ) } )`;\n\n\t\t} else if ( typeLength > 4 && value && ( value.isMatrix3 || value.isMatrix4 ) ) {\n\n\t\t\treturn `${ this.getType( type ) }( ${ value.elements.map( generateConst ).join( ', ' ) } )`;\n\n\t\t} else if ( typeLength > 4 ) {\n\n\t\t\treturn `${ this.getType( type ) }()`;\n\n\t\t}\n\n\t\tthrow new Error( `NodeBuilder: Type '${type}' not found in generate constant attempt.` );\n\n\t}\n\n\tgetType( type ) {\n\n\t\tif ( type === 'color' ) return 'vec3';\n\n\t\treturn type;\n\n\t}\n\n\thasGeometryAttribute( name ) {\n\n\t\treturn this.geometry && this.geometry.getAttribute( name ) !== undefined;\n\n\t}\n\n\tgetAttribute( name, type ) {\n\n\t\tconst attributes = this.attributes;\n\n\t\t// find attribute\n\n\t\tfor ( const attribute of attributes ) {\n\n\t\t\tif ( attribute.name === name ) {\n\n\t\t\t\treturn attribute;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// create a new if no exist\n\n\t\tconst attribute = new NodeAttribute( name, type );\n\n\t\tattributes.push( attribute );\n\n\t\treturn attribute;\n\n\t}\n\n\tgetPropertyName( node/*, shaderStage*/ ) {\n\n\t\treturn node.name;\n\n\t}\n\n\tisVector( type ) {\n\n\t\treturn /vec\\d/.test( type );\n\n\t}\n\n\tisMatrix( type ) {\n\n\t\treturn /mat\\d/.test( type );\n\n\t}\n\n\tisReference( type ) {\n\n\t\treturn type === 'void' || type === 'property' || type === 'sampler' || type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'depthTexture' || type === 'texture3D';\n\n\t}\n\n\tneedsToWorkingColorSpace( /*texture*/ ) {\n\n\t\treturn false;\n\n\t}\n\n\tgetComponentTypeFromTexture( texture ) {\n\n\t\tconst type = texture.type;\n\n\t\tif ( texture.isDataTexture ) {\n\n\t\t\tif ( type === IntType ) return 'int';\n\t\t\tif ( type === UnsignedIntType ) return 'uint';\n\n\t\t}\n\n\t\treturn 'float';\n\n\t}\n\n\tgetElementType( type ) {\n\n\t\tif ( type === 'mat2' ) return 'vec2';\n\t\tif ( type === 'mat3' ) return 'vec3';\n\t\tif ( type === 'mat4' ) return 'vec4';\n\n\t\treturn this.getComponentType( type );\n\n\t}\n\n\tgetComponentType( type ) {\n\n\t\ttype = this.getVectorType( type );\n\n\t\tif ( type === 'float' || type === 'bool' || type === 'int' || type === 'uint' ) return type;\n\n\t\tconst componentType = /(b|i|u|)(vec|mat)([2-4])/.exec( type );\n\n\t\tif ( componentType === null ) return null;\n\n\t\tif ( componentType[ 1 ] === 'b' ) return 'bool';\n\t\tif ( componentType[ 1 ] === 'i' ) return 'int';\n\t\tif ( componentType[ 1 ] === 'u' ) return 'uint';\n\n\t\treturn 'float';\n\n\t}\n\n\tgetVectorType( type ) {\n\n\t\tif ( type === 'color' ) return 'vec3';\n\t\tif ( type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'texture3D' ) return 'vec4';\n\n\t\treturn type;\n\n\t}\n\n\tgetTypeFromLength( length, componentType = 'float' ) {\n\n\t\tif ( length === 1 ) return componentType;\n\n\t\tconst baseType = typeFromLength.get( length );\n\t\tconst prefix = componentType === 'float' ? '' : componentType[ 0 ];\n\n\t\treturn prefix + baseType;\n\n\t}\n\n\tgetTypeFromArray( array ) {\n\n\t\treturn typeFromArray.get( array.constructor );\n\n\t}\n\n\tgetTypeFromAttribute( attribute ) {\n\n\t\tlet dataAttribute = attribute;\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) dataAttribute = attribute.data;\n\n\t\tconst array = dataAttribute.array;\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst normalized = attribute.normalized;\n\n\t\tlet arrayType;\n\n\t\tif ( ! ( attribute instanceof Float16BufferAttribute ) && normalized !== true ) {\n\n\t\t\tarrayType = this.getTypeFromArray( array );\n\n\t\t}\n\n\t\treturn this.getTypeFromLength( itemSize, arrayType );\n\n\t}\n\n\tgetTypeLength( type ) {\n\n\t\tconst vecType = this.getVectorType( type );\n\t\tconst vecNum = /vec([2-4])/.exec( vecType );\n\n\t\tif ( vecNum !== null ) return Number( vecNum[ 1 ] );\n\t\tif ( vecType === 'float' || vecType === 'bool' || vecType === 'int' || vecType === 'uint' ) return 1;\n\t\tif ( /mat2/.test( type ) === true ) return 4;\n\t\tif ( /mat3/.test( type ) === true ) return 9;\n\t\tif ( /mat4/.test( type ) === true ) return 16;\n\n\t\treturn 0;\n\n\t}\n\n\tgetVectorFromMatrix( type ) {\n\n\t\treturn type.replace( 'mat', 'vec' );\n\n\t}\n\n\tchangeComponentType( type, newComponentType ) {\n\n\t\treturn this.getTypeFromLength( this.getTypeLength( type ), newComponentType );\n\n\t}\n\n\tgetIntegerType( type ) {\n\n\t\tconst componentType = this.getComponentType( type );\n\n\t\tif ( componentType === 'int' || componentType === 'uint' ) return type;\n\n\t\treturn this.changeComponentType( type, 'int' );\n\n\t}\n\n\taddStack() {\n\n\t\tthis.stack = stack( this.stack );\n\n\t\tthis.stacks.push( getCurrentStack() || this.stack );\n\t\tsetCurrentStack( this.stack );\n\n\t\treturn this.stack;\n\n\t}\n\n\tremoveStack() {\n\n\t\tconst lastStack = this.stack;\n\t\tthis.stack = lastStack.parent;\n\n\t\tsetCurrentStack( this.stacks.pop() );\n\n\t\treturn lastStack;\n\n\t}\n\n\tgetDataFromNode( node, shaderStage = this.shaderStage, cache = null ) {\n\n\t\tcache = cache === null ? ( node.isGlobal( this ) ? this.globalCache : this.cache ) : cache;\n\n\t\tlet nodeData = cache.getData( node );\n\n\t\tif ( nodeData === undefined ) {\n\n\t\t\tnodeData = {};\n\n\t\t\tcache.setData( node, nodeData );\n\n\t\t}\n\n\t\tif ( nodeData[ shaderStage ] === undefined ) nodeData[ shaderStage ] = {};\n\n\t\treturn nodeData[ shaderStage ];\n\n\t}\n\n\tgetNodeProperties( node, shaderStage = 'any' ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage );\n\n\t\treturn nodeData.properties || ( nodeData.properties = { outputNode: null } );\n\n\t}\n\n\tgetBufferAttributeFromNode( node, type ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\n\t\tlet bufferAttribute = nodeData.bufferAttribute;\n\n\t\tif ( bufferAttribute === undefined ) {\n\n\t\t\tconst index = this.uniforms.index ++;\n\n\t\t\tbufferAttribute = new NodeAttribute( 'nodeAttribute' + index, type, node );\n\n\t\t\tthis.bufferAttributes.push( bufferAttribute );\n\n\t\t\tnodeData.bufferAttribute = bufferAttribute;\n\n\t\t}\n\n\t\treturn bufferAttribute;\n\n\t}\n\n\tgetStructTypeFromNode( node, shaderStage = this.shaderStage ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage );\n\n\t\tif ( nodeData.structType === undefined ) {\n\n\t\t\tconst index = this.structs.index ++;\n\n\t\t\tnode.name = `StructType${ index }`;\n\t\t\tthis.structs[ shaderStage ].push( node );\n\n\t\t\tnodeData.structType = node;\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n\tgetUniformFromNode( node, type, shaderStage = this.shaderStage, name = null ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage, this.globalCache );\n\n\t\tlet nodeUniform = nodeData.uniform;\n\n\t\tif ( nodeUniform === undefined ) {\n\n\t\t\tconst index = this.uniforms.index ++;\n\n\t\t\tnodeUniform = new NodeUniform( name || ( 'nodeUniform' + index ), type, node );\n\n\t\t\tthis.uniforms[ shaderStage ].push( nodeUniform );\n\n\t\t\tnodeData.uniform = nodeUniform;\n\n\t\t}\n\n\t\treturn nodeUniform;\n\n\t}\n\n\tgetVarFromNode( node, name = null, type = node.getNodeType( this ), shaderStage = this.shaderStage ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage );\n\n\t\tlet nodeVar = nodeData.variable;\n\n\t\tif ( nodeVar === undefined ) {\n\n\t\t\tconst vars = this.vars[ shaderStage ] || ( this.vars[ shaderStage ] = [] );\n\n\t\t\tif ( name === null ) name = 'nodeVar' + vars.length;\n\n\t\t\tnodeVar = new NodeVar( name, type );\n\n\t\t\tvars.push( nodeVar );\n\n\t\t\tnodeData.variable = nodeVar;\n\n\t\t}\n\n\t\treturn nodeVar;\n\n\t}\n\n\tgetVaryingFromNode( node, name = null, type = node.getNodeType( this ) ) {\n\n\t\tconst nodeData = this.getDataFromNode( node, 'any' );\n\n\t\tlet nodeVarying = nodeData.varying;\n\n\t\tif ( nodeVarying === undefined ) {\n\n\t\t\tconst varyings = this.varyings;\n\t\t\tconst index = varyings.length;\n\n\t\t\tif ( name === null ) name = 'nodeVarying' + index;\n\n\t\t\tnodeVarying = new NodeVarying( name, type );\n\n\t\t\tvaryings.push( nodeVarying );\n\n\t\t\tnodeData.varying = nodeVarying;\n\n\t\t}\n\n\t\treturn nodeVarying;\n\n\t}\n\n\tgetCodeFromNode( node, type, shaderStage = this.shaderStage ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\n\t\tlet nodeCode = nodeData.code;\n\n\t\tif ( nodeCode === undefined ) {\n\n\t\t\tconst codes = this.codes[ shaderStage ] || ( this.codes[ shaderStage ] = [] );\n\t\t\tconst index = codes.length;\n\n\t\t\tnodeCode = new NodeCode( 'nodeCode' + index, type );\n\n\t\t\tcodes.push( nodeCode );\n\n\t\t\tnodeData.code = nodeCode;\n\n\t\t}\n\n\t\treturn nodeCode;\n\n\t}\n\n\taddFlowCodeHierarchy( node, nodeBlock ) {\n\n\t\tconst { flowCodes, flowCodeBlock } = this.getDataFromNode( node );\n\n\t\tlet needsFlowCode = true;\n\t\tlet nodeBlockHierarchy = nodeBlock;\n\n\t\twhile ( nodeBlockHierarchy ) {\n\n\t\t\tif ( flowCodeBlock.get( nodeBlockHierarchy ) === true ) {\n\n\t\t\t\tneedsFlowCode = false;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tnodeBlockHierarchy = this.getDataFromNode( nodeBlockHierarchy ).parentNodeBlock;\n\n\t\t}\n\n\t\tif ( needsFlowCode ) {\n\n\t\t\tfor ( const flowCode of flowCodes ) {\n\n\t\t\t\tthis.addLineFlowCode( flowCode );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddLineFlowCodeBlock( node, code, nodeBlock ) {\n\n\t\tconst nodeData = this.getDataFromNode( node );\n\t\tconst flowCodes = nodeData.flowCodes || ( nodeData.flowCodes = [] );\n\t\tconst codeBlock = nodeData.flowCodeBlock || ( nodeData.flowCodeBlock = new WeakMap() );\n\n\t\tflowCodes.push( code );\n\t\tcodeBlock.set( nodeBlock, true );\n\n\t}\n\n\taddLineFlowCode( code, node = null ) {\n\n\t\tif ( code === '' ) return this;\n\n\t\tif ( node !== null && this.context.nodeBlock ) {\n\n\t\t\tthis.addLineFlowCodeBlock( node, code, this.context.nodeBlock );\n\n\t\t}\n\n\t\tcode = this.tab + code;\n\n\t\tif ( ! /;\\s*$/.test( code ) ) {\n\n\t\t\tcode = code + ';\\n';\n\n\t\t}\n\n\t\tthis.flow.code += code;\n\n\t\treturn this;\n\n\t}\n\n\taddFlowCode( code ) {\n\n\t\tthis.flow.code += code;\n\n\t\treturn this;\n\n\t}\n\n\taddFlowTab() {\n\n\t\tthis.tab += '\\t';\n\n\t\treturn this;\n\n\t}\n\n\tremoveFlowTab() {\n\n\t\tthis.tab = this.tab.slice( 0, - 1 );\n\n\t\treturn this;\n\n\t}\n\n\tgetFlowData( node/*, shaderStage*/ ) {\n\n\t\treturn this.flowsData.get( node );\n\n\t}\n\n\tflowNode( node ) {\n\n\t\tconst output = node.getNodeType( this );\n\n\t\tconst flowData = this.flowChildNode( node, output );\n\n\t\tthis.flowsData.set( node, flowData );\n\n\t\treturn flowData;\n\n\t}\n\n\tbuildFunctionNode( shaderNode ) {\n\n\t\tconst fn = new FunctionNode();\n\n\t\tconst previous = this.currentFunctionNode;\n\n\t\tthis.currentFunctionNode = fn;\n\n\t\tfn.code = this.buildFunctionCode( shaderNode );\n\n\t\tthis.currentFunctionNode = previous;\n\n\t\treturn fn;\n\n\t}\n\n\tflowShaderNode( shaderNode ) {\n\n\t\tconst layout = shaderNode.layout;\n\n\t\tconst inputs = {\n\t\t\t[ Symbol.iterator ]() {\n\n\t\t\t\tlet index = 0;\n\t\t\t\tconst values = Object.values( this );\n\t\t\t\treturn {\n\t\t\t\t\tnext: () => ( {\n\t\t\t\t\t\tvalue: values[ index ],\n\t\t\t\t\t\tdone: index ++ >= values.length\n\t\t\t\t\t} )\n\t\t\t\t};\n\n\t\t\t}\n\t\t};\n\n\t\tfor ( const input of layout.inputs ) {\n\n\t\t\tinputs[ input.name ] = new ParameterNode( input.type, input.name );\n\n\t\t}\n\n\t\t//\n\n\t\tshaderNode.layout = null;\n\n\t\tconst callNode = shaderNode.call( inputs );\n\t\tconst flowData = this.flowStagesNode( callNode, layout.type );\n\n\t\tshaderNode.layout = layout;\n\n\t\treturn flowData;\n\n\t}\n\n\tflowStagesNode( node, output = null ) {\n\n\t\tconst previousFlow = this.flow;\n\t\tconst previousVars = this.vars;\n\t\tconst previousCache = this.cache;\n\t\tconst previousBuildStage = this.buildStage;\n\t\tconst previousStack = this.stack;\n\n\t\tconst flow = {\n\t\t\tcode: ''\n\t\t};\n\n\t\tthis.flow = flow;\n\t\tthis.vars = {};\n\t\tthis.cache = new NodeCache();\n\t\tthis.stack = stack();\n\n\t\tfor ( const buildStage of defaultBuildStages ) {\n\n\t\t\tthis.setBuildStage( buildStage );\n\n\t\t\tflow.result = node.build( this, output );\n\n\t\t}\n\n\t\tflow.vars = this.getVars( this.shaderStage );\n\n\t\tthis.flow = previousFlow;\n\t\tthis.vars = previousVars;\n\t\tthis.cache = previousCache;\n\t\tthis.stack = previousStack;\n\n\t\tthis.setBuildStage( previousBuildStage );\n\n\t\treturn flow;\n\n\t}\n\n\tgetFunctionOperator() {\n\n\t\treturn null;\n\n\t}\n\n\tflowChildNode( node, output = null ) {\n\n\t\tconst previousFlow = this.flow;\n\n\t\tconst flow = {\n\t\t\tcode: ''\n\t\t};\n\n\t\tthis.flow = flow;\n\n\t\tflow.result = node.build( this, output );\n\n\t\tthis.flow = previousFlow;\n\n\t\treturn flow;\n\n\t}\n\n\tflowNodeFromShaderStage( shaderStage, node, output = null, propertyName = null ) {\n\n\t\tconst previousShaderStage = this.shaderStage;\n\n\t\tthis.setShaderStage( shaderStage );\n\n\t\tconst flowData = this.flowChildNode( node, output );\n\n\t\tif ( propertyName !== null ) {\n\n\t\t\tflowData.code += `${ this.tab + propertyName } = ${ flowData.result };\\n`;\n\n\t\t}\n\n\t\tthis.flowCode[ shaderStage ] = this.flowCode[ shaderStage ] + flowData.code;\n\n\t\tthis.setShaderStage( previousShaderStage );\n\n\t\treturn flowData;\n\n\t}\n\n\tgetAttributesArray() {\n\n\t\treturn this.attributes.concat( this.bufferAttributes );\n\n\t}\n\n\tgetAttributes( /*shaderStage*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetVaryings( /*shaderStage*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetVar( type, name ) {\n\n\t\treturn `${ this.getType( type ) } ${ name }`;\n\n\t}\n\n\tgetVars( shaderStage ) {\n\n\t\tlet snippet = '';\n\n\t\tconst vars = this.vars[ shaderStage ];\n\n\t\tif ( vars !== undefined ) {\n\n\t\t\tfor ( const variable of vars ) {\n\n\t\t\t\tsnippet += `${ this.getVar( variable.type, variable.name ) }; `;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgetUniforms( /*shaderStage*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tgetCodes( shaderStage ) {\n\n\t\tconst codes = this.codes[ shaderStage ];\n\n\t\tlet code = '';\n\n\t\tif ( codes !== undefined ) {\n\n\t\t\tfor ( const nodeCode of codes ) {\n\n\t\t\t\tcode += nodeCode.code + '\\n';\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn code;\n\n\t}\n\n\tgetHash() {\n\n\t\treturn this.vertexShader + this.fragmentShader + this.computeShader;\n\n\t}\n\n\tsetShaderStage( shaderStage ) {\n\n\t\tthis.shaderStage = shaderStage;\n\n\t}\n\n\tgetShaderStage() {\n\n\t\treturn this.shaderStage;\n\n\t}\n\n\tsetBuildStage( buildStage ) {\n\n\t\tthis.buildStage = buildStage;\n\n\t}\n\n\tgetBuildStage() {\n\n\t\treturn this.buildStage;\n\n\t}\n\n\tbuildCode() {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n\tbuild() {\n\n\t\tconst { object, material, renderer } = this;\n\n\t\tif ( material !== null ) {\n\n\t\t\tlet nodeMaterial = renderer.library.fromMaterial( material );\n\n\t\t\tif ( nodeMaterial === null ) {\n\n\t\t\t\tconsole.error( `NodeMaterial: Material \"${ material.type }\" is not compatible.` );\n\n\t\t\t\tnodeMaterial = new NodeMaterial();\n\n\t\t\t}\n\n\t\t\tnodeMaterial.build( this );\n\n\t\t} else {\n\n\t\t\tthis.addFlow( 'compute', object );\n\n\t\t}\n\n\t\t// setup() -> stage 1: create possible new nodes and returns an output reference node\n\t\t// analyze()   -> stage 2: analyze nodes to possible optimization and validation\n\t\t// generate()  -> stage 3: generate shader\n\n\t\tfor ( const buildStage of defaultBuildStages ) {\n\n\t\t\tthis.setBuildStage( buildStage );\n\n\t\t\tif ( this.context.vertex && this.context.vertex.isNode ) {\n\n\t\t\t\tthis.flowNodeFromShaderStage( 'vertex', this.context.vertex );\n\n\t\t\t}\n\n\t\t\tfor ( const shaderStage of shaderStages ) {\n\n\t\t\t\tthis.setShaderStage( shaderStage );\n\n\t\t\t\tconst flowNodes = this.flowNodes[ shaderStage ];\n\n\t\t\t\tfor ( const node of flowNodes ) {\n\n\t\t\t\t\tif ( buildStage === 'generate' ) {\n\n\t\t\t\t\t\tthis.flowNode( node );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode.build( this );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setBuildStage( null );\n\t\tthis.setShaderStage( null );\n\n\t\t// stage 4: build code for a specific output\n\n\t\tthis.buildCode();\n\t\tthis.buildUpdateNodes();\n\n\t\treturn this;\n\n\t}\n\n\tgetNodeUniform( uniformNode, type ) {\n\n\t\tif ( type === 'float' || type === 'int' || type === 'uint' ) return new NumberNodeUniform( uniformNode );\n\t\tif ( type === 'vec2' || type === 'ivec2' || type === 'uvec2' ) return new Vector2NodeUniform( uniformNode );\n\t\tif ( type === 'vec3' || type === 'ivec3' || type === 'uvec3' ) return new Vector3NodeUniform( uniformNode );\n\t\tif ( type === 'vec4' || type === 'ivec4' || type === 'uvec4' ) return new Vector4NodeUniform( uniformNode );\n\t\tif ( type === 'color' ) return new ColorNodeUniform( uniformNode );\n\t\tif ( type === 'mat3' ) return new Matrix3NodeUniform( uniformNode );\n\t\tif ( type === 'mat4' ) return new Matrix4NodeUniform( uniformNode );\n\n\t\tthrow new Error( `Uniform \"${type}\" not declared.` );\n\n\t}\n\n\tcreateNodeMaterial( type = 'NodeMaterial' ) { // @deprecated, r168\n\n\t\tthrow new Error( `THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${ type }() instead.` );\n\n\t}\n\n\tformat( snippet, fromType, toType ) {\n\n\t\tfromType = this.getVectorType( fromType );\n\t\ttoType = this.getVectorType( toType );\n\n\t\tif ( fromType === toType || toType === null || this.isReference( toType ) ) {\n\n\t\t\treturn snippet;\n\n\t\t}\n\n\t\tconst fromTypeLength = this.getTypeLength( fromType );\n\t\tconst toTypeLength = this.getTypeLength( toType );\n\n\t\tif ( fromTypeLength === 16 && toTypeLength === 9 ) {\n\n\t\t\treturn `${ this.getType( toType ) }(${ snippet }[0].xyz, ${ snippet }[1].xyz, ${ snippet }[2].xyz)`;\n\n\t\t}\n\n\t\tif ( fromTypeLength === 9 && toTypeLength === 4 ) {\n\n\t\t\treturn `${ this.getType( toType ) }(${ snippet }[0].xy, ${ snippet }[1].xy)`;\n\n\t\t}\n\n\n\t\tif ( fromTypeLength > 4 ) { // fromType is matrix-like\n\n\t\t\t// @TODO: ignore for now\n\n\t\t\treturn snippet;\n\n\t\t}\n\n\t\tif ( toTypeLength > 4 || toTypeLength === 0 ) { // toType is matrix-like or unknown\n\n\t\t\t// @TODO: ignore for now\n\n\t\t\treturn snippet;\n\n\t\t}\n\n\t\tif ( fromTypeLength === toTypeLength ) {\n\n\t\t\treturn `${ this.getType( toType ) }( ${ snippet } )`;\n\n\t\t}\n\n\t\tif ( fromTypeLength > toTypeLength ) {\n\n\t\t\treturn this.format( `${ snippet }.${ 'xyz'.slice( 0, toTypeLength ) }`, this.getTypeFromLength( toTypeLength, this.getComponentType( fromType ) ), toType );\n\n\t\t}\n\n\t\tif ( toTypeLength === 4 && fromTypeLength > 1 ) { // toType is vec4-like\n\n\t\t\treturn `${ this.getType( toType ) }( ${ this.format( snippet, fromType, 'vec3' ) }, 1.0 )`;\n\n\t\t}\n\n\t\tif ( fromTypeLength === 2 ) { // fromType is vec2-like and toType is vec3-like\n\n\t\t\treturn `${ this.getType( toType ) }( ${ this.format( snippet, fromType, 'vec2' ) }, 0.0 )`;\n\n\t\t}\n\n\t\tif ( fromTypeLength === 1 && toTypeLength > 1 && fromType !== this.getComponentType( toType ) ) { // fromType is float-like\n\n\t\t\t// convert a number value to vector type, e.g:\n\t\t\t// vec3( 1u ) -> vec3( float( 1u ) )\n\n\t\t\tsnippet = `${ this.getType( this.getComponentType( toType ) ) }( ${ snippet } )`;\n\n\t\t}\n\n\t\treturn `${ this.getType( toType ) }( ${ snippet } )`; // fromType is float-like\n\n\t}\n\n\tgetSignature() {\n\n\t\treturn `// Three.js r${ REVISION } - Node System\\n`;\n\n\t}\n\n}\n\nclass NodeFrame {\n\n\tconstructor() {\n\n\t\tthis.time = 0;\n\t\tthis.deltaTime = 0;\n\n\t\tthis.frameId = 0;\n\t\tthis.renderId = 0;\n\n\t\tthis.startTime = null;\n\n\t\tthis.updateMap = new WeakMap();\n\t\tthis.updateBeforeMap = new WeakMap();\n\t\tthis.updateAfterMap = new WeakMap();\n\n\t\tthis.renderer = null;\n\t\tthis.material = null;\n\t\tthis.camera = null;\n\t\tthis.object = null;\n\t\tthis.scene = null;\n\n\t}\n\n\t_getMaps( referenceMap, nodeRef ) {\n\n\t\tlet maps = referenceMap.get( nodeRef );\n\n\t\tif ( maps === undefined ) {\n\n\t\t\tmaps = {\n\t\t\t\trenderMap: new WeakMap(),\n\t\t\t\tframeMap: new WeakMap()\n\t\t\t};\n\n\t\t\treferenceMap.set( nodeRef, maps );\n\n\t\t}\n\n\t\treturn maps;\n\n\t}\n\n\tupdateBeforeNode( node ) {\n\n\t\tconst updateType = node.getUpdateBeforeType();\n\t\tconst reference = node.updateReference( this );\n\n\t\tif ( updateType === NodeUpdateType.FRAME ) {\n\n\t\t\tconst { frameMap } = this._getMaps( this.updateBeforeMap, reference );\n\n\t\t\tif ( frameMap.get( reference ) !== this.frameId ) {\n\n\t\t\t\tif ( node.updateBefore( this ) !== false ) {\n\n\t\t\t\t\tframeMap.set( reference, this.frameId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.RENDER ) {\n\n\t\t\tconst { renderMap } = this._getMaps( this.updateBeforeMap, reference );\n\n\t\t\tif ( renderMap.get( reference ) !== this.renderId ) {\n\n\t\t\t\tif ( node.updateBefore( this ) !== false ) {\n\n\t\t\t\t\trenderMap.set( reference, this.renderId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.OBJECT ) {\n\n\t\t\tnode.updateBefore( this );\n\n\t\t}\n\n\t}\n\n\tupdateAfterNode( node ) {\n\n\t\tconst updateType = node.getUpdateAfterType();\n\t\tconst reference = node.updateReference( this );\n\n\t\tif ( updateType === NodeUpdateType.FRAME ) {\n\n\t\t\tconst { frameMap } = this._getMaps( this.updateAfterMap, reference );\n\n\t\t\tif ( frameMap.get( reference ) !== this.frameId ) {\n\n\t\t\t\tif ( node.updateAfter( this ) !== false ) {\n\n\t\t\t\t\tframeMap.set( reference, this.frameId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.RENDER ) {\n\n\t\t\tconst { renderMap } = this._getMaps( this.updateAfterMap, reference );\n\n\t\t\tif ( renderMap.get( reference ) !== this.renderId ) {\n\n\t\t\t\tif ( node.updateAfter( this ) !== false ) {\n\n\t\t\t\t\trenderMap.set( reference, this.renderId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.OBJECT ) {\n\n\t\t\tnode.updateAfter( this );\n\n\t\t}\n\n\t}\n\n\tupdateNode( node ) {\n\n\t\tconst updateType = node.getUpdateType();\n\t\tconst reference = node.updateReference( this );\n\n\t\tif ( updateType === NodeUpdateType.FRAME ) {\n\n\t\t\tconst { frameMap } = this._getMaps( this.updateMap, reference );\n\n\t\t\tif ( frameMap.get( reference ) !== this.frameId ) {\n\n\t\t\t\tif ( node.update( this ) !== false ) {\n\n\t\t\t\t\tframeMap.set( reference, this.frameId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.RENDER ) {\n\n\t\t\tconst { renderMap } = this._getMaps( this.updateMap, reference );\n\n\t\t\tif ( renderMap.get( reference ) !== this.renderId ) {\n\n\t\t\t\tif ( node.update( this ) !== false ) {\n\n\t\t\t\t\trenderMap.set( reference, this.renderId );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( updateType === NodeUpdateType.OBJECT ) {\n\n\t\t\tnode.update( this );\n\n\t\t}\n\n\t}\n\n\tupdate() {\n\n\t\tthis.frameId ++;\n\n\t\tif ( this.lastTime === undefined ) this.lastTime = performance.now();\n\n\t\tthis.deltaTime = ( performance.now() - this.lastTime ) / 1000;\n\n\t\tthis.lastTime = performance.now();\n\n\t\tthis.time += this.deltaTime;\n\n\t}\n\n}\n\nclass NodeFunctionInput {\n\n\tconstructor( type, name, count = null, qualifier = '', isConst = false ) {\n\n\t\tthis.type = type;\n\t\tthis.name = name;\n\t\tthis.count = count;\n\t\tthis.qualifier = qualifier;\n\t\tthis.isConst = isConst;\n\n\t}\n\n}\n\nNodeFunctionInput.isNodeFunctionInput = true;\n\nclass DirectionalLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'DirectionalLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lightColor = this.colorNode;\n\t\tconst lightDirection = lightTargetDirection( this.light );\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nconst _matrix41 = /*@__PURE__*/ new Matrix4();\nconst _matrix42 = /*@__PURE__*/ new Matrix4();\n\nlet ltcLib = null;\n\nclass RectAreaLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'RectAreaLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.halfHeight = uniform( new Vector3() ).setGroup( renderGroup );\n\t\tthis.halfWidth = uniform( new Vector3() ).setGroup( renderGroup );\n\n\t\tthis.updateType = NodeUpdateType.RENDER;\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tsuper.update( frame );\n\n\t\tconst { light } = this;\n\n\t\tconst viewMatrix = frame.camera.matrixWorldInverse;\n\n\t\t_matrix42.identity();\n\t\t_matrix41.copy( light.matrixWorld );\n\t\t_matrix41.premultiply( viewMatrix );\n\t\t_matrix42.extractRotation( _matrix41 );\n\n\t\tthis.halfWidth.value.set( light.width * 0.5, 0.0, 0.0 );\n\t\tthis.halfHeight.value.set( 0.0, light.height * 0.5, 0.0 );\n\n\t\tthis.halfWidth.value.applyMatrix4( _matrix42 );\n\t\tthis.halfHeight.value.applyMatrix4( _matrix42 );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tlet ltc_1, ltc_2;\n\n\t\tif ( builder.isAvailable( 'float32Filterable' ) ) {\n\n\t\t\tltc_1 = texture( ltcLib.LTC_FLOAT_1 );\n\t\t\tltc_2 = texture( ltcLib.LTC_FLOAT_2 );\n\n\t\t} else {\n\n\t\t\tltc_1 = texture( ltcLib.LTC_HALF_1 );\n\t\t\tltc_2 = texture( ltcLib.LTC_HALF_2 );\n\n\t\t}\n\n\t\tconst { colorNode, light } = this;\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst lightPosition = lightViewPosition( light );\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.directRectArea( {\n\t\t\tlightColor: colorNode,\n\t\t\tlightPosition,\n\t\t\thalfWidth: this.halfWidth,\n\t\t\thalfHeight: this.halfHeight,\n\t\t\treflectedLight,\n\t\t\tltc_1,\n\t\t\tltc_2\n\t\t}, builder.stack, builder );\n\n\t}\n\n\tstatic setLTC( ltc ) {\n\n\t\tltcLib = ltc;\n\n\t}\n\n}\n\nclass SpotLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'SpotLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.coneCosNode = uniform( 0 ).setGroup( renderGroup );\n\t\tthis.penumbraCosNode = uniform( 0 ).setGroup( renderGroup );\n\n\t\tthis.cutoffDistanceNode = uniform( 0 ).setGroup( renderGroup );\n\t\tthis.decayExponentNode = uniform( 0 ).setGroup( renderGroup );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tsuper.update( frame );\n\n\t\tconst { light } = this;\n\n\t\tthis.coneCosNode.value = Math.cos( light.angle );\n\t\tthis.penumbraCosNode.value = Math.cos( light.angle * ( 1 - light.penumbra ) );\n\n\t\tthis.cutoffDistanceNode.value = light.distance;\n\t\tthis.decayExponentNode.value = light.decay;\n\n\t}\n\n\tgetSpotAttenuation( angleCosine ) {\n\n\t\tconst { coneCosNode, penumbraCosNode } = this;\n\n\t\treturn smoothstep( coneCosNode, penumbraCosNode, angleCosine );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tsuper.setup( builder );\n\n\t\tconst lightingModel = builder.context.lightingModel;\n\n\t\tconst { colorNode, cutoffDistanceNode, decayExponentNode, light } = this;\n\n\t\tconst lVector = lightViewPosition( light ).sub( positionView ); // @TODO: Add it into LightNode\n\n\t\tconst lightDirection = lVector.normalize();\n\t\tconst angleCos = lightDirection.dot( lightTargetDirection( light ) );\n\t\tconst spotAttenuation = this.getSpotAttenuation( angleCos );\n\n\t\tconst lightDistance = lVector.length();\n\n\t\tconst lightAttenuation = getDistanceAttenuation( {\n\t\t\tlightDistance,\n\t\t\tcutoffDistance: cutoffDistanceNode,\n\t\t\tdecayExponent: decayExponentNode\n\t\t} );\n\n\t\tconst lightColor = colorNode.mul( spotAttenuation ).mul( lightAttenuation );\n\n\t\tconst reflectedLight = builder.context.reflectedLight;\n\n\t\tlightingModel.direct( {\n\t\t\tlightDirection,\n\t\t\tlightColor,\n\t\t\treflectedLight\n\t\t}, builder.stack, builder );\n\n\t}\n\n}\n\nclass IESSpotLightNode extends SpotLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'IESSpotLightNode';\n\n\t}\n\n\tgetSpotAttenuation( angleCosine ) {\n\n\t\tconst iesMap = this.light.iesMap;\n\n\t\tlet spotAttenuation = null;\n\n\t\tif ( iesMap && iesMap.isTexture === true ) {\n\n\t\t\tconst angle = angleCosine.acos().mul( 1.0 / Math.PI );\n\n\t\t\tspotAttenuation = texture( iesMap, vec2( angle, 0 ), 0 ).r;\n\n\t\t} else {\n\n\t\t\tspotAttenuation = super.getSpotAttenuation( angleCosine );\n\n\t\t}\n\n\t\treturn spotAttenuation;\n\n\t}\n\n}\n\nclass AmbientLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'AmbientLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t}\n\n\tsetup( { context } ) {\n\n\t\tcontext.irradiance.addAssign( this.colorNode );\n\n\t}\n\n}\n\nclass HemisphereLightNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'HemisphereLightNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tthis.lightPositionNode = lightPosition( light );\n\t\tthis.lightDirectionNode = this.lightPositionNode.normalize();\n\n\t\tthis.groundColorNode = uniform( new Color() ).setGroup( renderGroup );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\tthis.lightPositionNode.object3d = light;\n\n\t\tthis.groundColorNode.value.copy( light.groundColor ).multiplyScalar( light.intensity );\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst { colorNode, groundColorNode, lightDirectionNode } = this;\n\n\t\tconst dotNL = normalView.dot( lightDirectionNode );\n\t\tconst hemiDiffuseWeight = dotNL.mul( 0.5 ).add( 0.5 );\n\n\t\tconst irradiance = mix( groundColorNode, colorNode, hemiDiffuseWeight );\n\n\t\tbuilder.context.irradiance.addAssign( irradiance );\n\n\t}\n\n}\n\nclass LightProbeNode extends AnalyticLightNode {\n\n\tstatic get type() {\n\n\t\treturn 'LightProbeNode';\n\n\t}\n\n\tconstructor( light = null ) {\n\n\t\tsuper( light );\n\n\t\tconst array = [];\n\n\t\tfor ( let i = 0; i < 9; i ++ ) array.push( new Vector3() );\n\n\t\tthis.lightProbe = uniformArray( array );\n\n\t}\n\n\tupdate( frame ) {\n\n\t\tconst { light } = this;\n\n\t\tsuper.update( frame );\n\n\t\t//\n\n\t\tfor ( let i = 0; i < 9; i ++ ) {\n\n\t\t\tthis.lightProbe.array[ i ].copy( light.sh.coefficients[ i ] ).multiplyScalar( light.intensity );\n\n\t\t}\n\n\t}\n\n\tsetup( builder ) {\n\n\t\tconst irradiance = getShIrradianceAt( normalWorld, this.lightProbe );\n\n\t\tbuilder.context.irradiance.addAssign( irradiance );\n\n\t}\n\n}\n\nclass NodeParser {\n\n\tparseFunction( /*source*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nclass NodeFunction {\n\n\tconstructor( type, inputs, name = '', precision = '' ) {\n\n\t\tthis.type = type;\n\t\tthis.inputs = inputs;\n\t\tthis.name = name;\n\t\tthis.precision = precision;\n\n\t}\n\n\tgetCode( /*name = this.name*/ ) {\n\n\t\tconsole.warn( 'Abstract function.' );\n\n\t}\n\n}\n\nNodeFunction.isNodeFunction = true;\n\nconst declarationRegexp$1 = /^\\s*(highp|mediump|lowp)?\\s*([a-z_0-9]+)\\s*([a-z_0-9]+)?\\s*\\(([\\s\\S]*?)\\)/i;\nconst propertiesRegexp$1 = /[a-z_0-9]+/ig;\n\nconst pragmaMain = '#pragma main';\n\nconst parse$1 = ( source ) => {\n\n\tsource = source.trim();\n\n\tconst pragmaMainIndex = source.indexOf( pragmaMain );\n\n\tconst mainCode = pragmaMainIndex !== - 1 ? source.slice( pragmaMainIndex + pragmaMain.length ) : source;\n\n\tconst declaration = mainCode.match( declarationRegexp$1 );\n\n\tif ( declaration !== null && declaration.length === 5 ) {\n\n\t\t// tokenizer\n\n\t\tconst inputsCode = declaration[ 4 ];\n\t\tconst propsMatches = [];\n\n\t\tlet nameMatch = null;\n\n\t\twhile ( ( nameMatch = propertiesRegexp$1.exec( inputsCode ) ) !== null ) {\n\n\t\t\tpropsMatches.push( nameMatch );\n\n\t\t}\n\n\t\t// parser\n\n\t\tconst inputs = [];\n\n\t\tlet i = 0;\n\n\t\twhile ( i < propsMatches.length ) {\n\n\t\t\tconst isConst = propsMatches[ i ][ 0 ] === 'const';\n\n\t\t\tif ( isConst === true ) {\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t\tlet qualifier = propsMatches[ i ][ 0 ];\n\n\t\t\tif ( qualifier === 'in' || qualifier === 'out' || qualifier === 'inout' ) {\n\n\t\t\t\ti ++;\n\n\t\t\t} else {\n\n\t\t\t\tqualifier = '';\n\n\t\t\t}\n\n\t\t\tconst type = propsMatches[ i ++ ][ 0 ];\n\n\t\t\tlet count = Number.parseInt( propsMatches[ i ][ 0 ] );\n\n\t\t\tif ( Number.isNaN( count ) === false ) i ++;\n\t\t\telse count = null;\n\n\t\t\tconst name = propsMatches[ i ++ ][ 0 ];\n\n\t\t\tinputs.push( new NodeFunctionInput( type, name, count, qualifier, isConst ) );\n\n\t\t}\n\n\t\t//\n\n\t\tconst blockCode = mainCode.substring( declaration[ 0 ].length );\n\n\t\tconst name = declaration[ 3 ] !== undefined ? declaration[ 3 ] : '';\n\t\tconst type = declaration[ 2 ];\n\n\t\tconst precision = declaration[ 1 ] !== undefined ? declaration[ 1 ] : '';\n\n\t\tconst headerCode = pragmaMainIndex !== - 1 ? source.slice( 0, pragmaMainIndex ) : '';\n\n\t\treturn {\n\t\t\ttype,\n\t\t\tinputs,\n\t\t\tname,\n\t\t\tprecision,\n\t\t\tinputsCode,\n\t\t\tblockCode,\n\t\t\theaderCode\n\t\t};\n\n\t} else {\n\n\t\tthrow new Error( 'FunctionNode: Function is not a GLSL code.' );\n\n\t}\n\n};\n\nclass GLSLNodeFunction extends NodeFunction {\n\n\tconstructor( source ) {\n\n\t\tconst { type, inputs, name, precision, inputsCode, blockCode, headerCode } = parse$1( source );\n\n\t\tsuper( type, inputs, name, precision );\n\n\t\tthis.inputsCode = inputsCode;\n\t\tthis.blockCode = blockCode;\n\t\tthis.headerCode = headerCode;\n\n\t}\n\n\tgetCode( name = this.name ) {\n\n\t\tlet code;\n\n\t\tconst blockCode = this.blockCode;\n\n\t\tif ( blockCode !== '' ) {\n\n\t\t\tconst { type, inputsCode, headerCode, precision } = this;\n\n\t\t\tlet declarationCode = `${ type } ${ name } ( ${ inputsCode.trim() } )`;\n\n\t\t\tif ( precision !== '' ) {\n\n\t\t\t\tdeclarationCode = `${ precision } ${ declarationCode }`;\n\n\t\t\t}\n\n\t\t\tcode = headerCode + declarationCode + blockCode;\n\n\t\t} else {\n\n\t\t\t// interface function\n\n\t\t\tcode = '';\n\n\t\t}\n\n\t\treturn code;\n\n\t}\n\n}\n\nclass GLSLNodeParser extends NodeParser {\n\n\tparseFunction( source ) {\n\n\t\treturn new GLSLNodeFunction( source );\n\n\t}\n\n}\n\nconst outputNodeMap = new WeakMap();\n\nclass Nodes extends DataMap {\n\n\tconstructor( renderer, backend ) {\n\n\t\tsuper();\n\n\t\tthis.renderer = renderer;\n\t\tthis.backend = backend;\n\t\tthis.nodeFrame = new NodeFrame();\n\t\tthis.nodeBuilderCache = new Map();\n\t\tthis.callHashCache = new ChainMap();\n\t\tthis.groupsData = new ChainMap();\n\n\t}\n\n\tupdateGroup( nodeUniformsGroup ) {\n\n\t\tconst groupNode = nodeUniformsGroup.groupNode;\n\t\tconst name = groupNode.name;\n\n\t\t// objectGroup is every updated\n\n\t\tif ( name === objectGroup.name ) return true;\n\n\t\t// renderGroup is updated once per render/compute call\n\n\t\tif ( name === renderGroup.name ) {\n\n\t\t\tconst uniformsGroupData = this.get( nodeUniformsGroup );\n\t\t\tconst renderId = this.nodeFrame.renderId;\n\n\t\t\tif ( uniformsGroupData.renderId !== renderId ) {\n\n\t\t\t\tuniformsGroupData.renderId = renderId;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// frameGroup is updated once per frame\n\n\t\tif ( name === frameGroup.name ) {\n\n\t\t\tconst uniformsGroupData = this.get( nodeUniformsGroup );\n\t\t\tconst frameId = this.nodeFrame.frameId;\n\n\t\t\tif ( uniformsGroupData.frameId !== frameId ) {\n\n\t\t\t\tuniformsGroupData.frameId = frameId;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t// other groups are updated just when groupNode.needsUpdate is true\n\n\t\tconst groupChain = [ groupNode, nodeUniformsGroup ];\n\n\t\tlet groupData = this.groupsData.get( groupChain );\n\t\tif ( groupData === undefined ) this.groupsData.set( groupChain, groupData = {} );\n\n\t\tif ( groupData.version !== groupNode.version ) {\n\n\t\t\tgroupData.version = groupNode.version;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetForRenderCacheKey( renderObject ) {\n\n\t\treturn renderObject.initialCacheKey;\n\n\t}\n\n\tgetForRender( renderObject ) {\n\n\t\tconst renderObjectData = this.get( renderObject );\n\n\t\tlet nodeBuilderState = renderObjectData.nodeBuilderState;\n\n\t\tif ( nodeBuilderState === undefined ) {\n\n\t\t\tconst { nodeBuilderCache } = this;\n\n\t\t\tconst cacheKey = this.getForRenderCacheKey( renderObject );\n\n\t\t\tnodeBuilderState = nodeBuilderCache.get( cacheKey );\n\n\t\t\tif ( nodeBuilderState === undefined ) {\n\n\t\t\t\tconst nodeBuilder = this.backend.createNodeBuilder( renderObject.object, this.renderer );\n\t\t\t\tnodeBuilder.scene = renderObject.scene;\n\t\t\t\tnodeBuilder.material = renderObject.material;\n\t\t\t\tnodeBuilder.camera = renderObject.camera;\n\t\t\t\tnodeBuilder.context.material = renderObject.material;\n\t\t\t\tnodeBuilder.lightsNode = renderObject.lightsNode;\n\t\t\t\tnodeBuilder.environmentNode = this.getEnvironmentNode( renderObject.scene );\n\t\t\t\tnodeBuilder.fogNode = this.getFogNode( renderObject.scene );\n\t\t\t\tnodeBuilder.clippingContext = renderObject.clippingContext;\n\t\t\t\tnodeBuilder.build();\n\n\t\t\t\tnodeBuilderState = this._createNodeBuilderState( nodeBuilder );\n\n\t\t\t\tnodeBuilderCache.set( cacheKey, nodeBuilderState );\n\n\t\t\t}\n\n\t\t\tnodeBuilderState.usedTimes ++;\n\n\t\t\trenderObjectData.nodeBuilderState = nodeBuilderState;\n\n\t\t}\n\n\t\treturn nodeBuilderState;\n\n\t}\n\n\tdelete( object ) {\n\n\t\tif ( object.isRenderObject ) {\n\n\t\t\tconst nodeBuilderState = this.get( object ).nodeBuilderState;\n\t\t\tnodeBuilderState.usedTimes --;\n\n\t\t\tif ( nodeBuilderState.usedTimes === 0 ) {\n\n\t\t\t\tthis.nodeBuilderCache.delete( this.getForRenderCacheKey( object ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.delete( object );\n\n\t}\n\n\tgetForCompute( computeNode ) {\n\n\t\tconst computeData = this.get( computeNode );\n\n\t\tlet nodeBuilderState = computeData.nodeBuilderState;\n\n\t\tif ( nodeBuilderState === undefined ) {\n\n\t\t\tconst nodeBuilder = this.backend.createNodeBuilder( computeNode, this.renderer );\n\t\t\tnodeBuilder.build();\n\n\t\t\tnodeBuilderState = this._createNodeBuilderState( nodeBuilder );\n\n\t\t\tcomputeData.nodeBuilderState = nodeBuilderState;\n\n\t\t}\n\n\t\treturn nodeBuilderState;\n\n\t}\n\n\t_createNodeBuilderState( nodeBuilder ) {\n\n\t\treturn new NodeBuilderState(\n\t\t\tnodeBuilder.vertexShader,\n\t\t\tnodeBuilder.fragmentShader,\n\t\t\tnodeBuilder.computeShader,\n\t\t\tnodeBuilder.getAttributesArray(),\n\t\t\tnodeBuilder.getBindings(),\n\t\t\tnodeBuilder.updateNodes,\n\t\t\tnodeBuilder.updateBeforeNodes,\n\t\t\tnodeBuilder.updateAfterNodes,\n\t\t\tnodeBuilder.monitor,\n\t\t\tnodeBuilder.transforms\n\t\t);\n\n\t}\n\n\tgetEnvironmentNode( scene ) {\n\n\t\treturn scene.environmentNode || this.get( scene ).environmentNode || null;\n\n\t}\n\n\tgetBackgroundNode( scene ) {\n\n\t\treturn scene.backgroundNode || this.get( scene ).backgroundNode || null;\n\n\t}\n\n\tgetFogNode( scene ) {\n\n\t\treturn scene.fogNode || this.get( scene ).fogNode || null;\n\n\t}\n\n\tgetCacheKey( scene, lightsNode ) {\n\n\t\tconst chain = [ scene, lightsNode ];\n\t\tconst callId = this.renderer.info.calls;\n\n\t\tlet cacheKeyData = this.callHashCache.get( chain );\n\n\t\tif ( cacheKeyData === undefined || cacheKeyData.callId !== callId ) {\n\n\t\t\tconst environmentNode = this.getEnvironmentNode( scene );\n\t\t\tconst fogNode = this.getFogNode( scene );\n\n\t\t\tconst values = [];\n\n\t\t\tif ( lightsNode ) values.push( lightsNode.getCacheKey( true ) );\n\t\t\tif ( environmentNode ) values.push( environmentNode.getCacheKey() );\n\t\t\tif ( fogNode ) values.push( fogNode.getCacheKey() );\n\n\t\t\tvalues.push( this.renderer.shadowMap.enabled ? 1 : 0 );\n\n\t\t\tcacheKeyData = {\n\t\t\t\tcallId,\n\t\t\t\tcacheKey: hashArray( values )\n\t\t\t};\n\n\t\t\tthis.callHashCache.set( chain, cacheKeyData );\n\n\t\t}\n\n\t\treturn cacheKeyData.cacheKey;\n\n\t}\n\n\tupdateScene( scene ) {\n\n\t\tthis.updateEnvironment( scene );\n\t\tthis.updateFog( scene );\n\t\tthis.updateBackground( scene );\n\n\t}\n\n\tget isToneMappingState() {\n\n\t\treturn this.renderer.getRenderTarget() ? false : true;\n\n\t}\n\n\tupdateBackground( scene ) {\n\n\t\tconst sceneData = this.get( scene );\n\t\tconst background = scene.background;\n\n\t\tif ( background ) {\n\n\t\t\tconst forceUpdate = ( scene.backgroundBlurriness === 0 && sceneData.backgroundBlurriness > 0 ) || ( scene.backgroundBlurriness > 0 && sceneData.backgroundBlurriness === 0 );\n\n\t\t\tif ( sceneData.background !== background || forceUpdate ) {\n\n\t\t\t\tlet backgroundNode = null;\n\n\t\t\t\tif ( background.isCubeTexture === true || ( background.mapping === EquirectangularReflectionMapping || background.mapping === EquirectangularRefractionMapping || background.mapping === CubeUVReflectionMapping ) ) {\n\n\t\t\t\t\tif ( scene.backgroundBlurriness > 0 || background.mapping === CubeUVReflectionMapping ) {\n\n\t\t\t\t\t\tbackgroundNode = pmremTexture( background );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tlet envMap;\n\n\t\t\t\t\t\tif ( background.isCubeTexture === true ) {\n\n\t\t\t\t\t\t\tenvMap = cubeTexture( background );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tenvMap = texture( background );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbackgroundNode = cubeMapNode( envMap );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( background.isTexture === true ) {\n\n\t\t\t\t\tbackgroundNode = texture( background, screenUV.flipY() ).setUpdateMatrix( true );\n\n\t\t\t\t} else if ( background.isColor !== true ) {\n\n\t\t\t\t\tconsole.error( 'WebGPUNodes: Unsupported background configuration.', background );\n\n\t\t\t\t}\n\n\t\t\t\tsceneData.backgroundNode = backgroundNode;\n\t\t\t\tsceneData.background = background;\n\t\t\t\tsceneData.backgroundBlurriness = scene.backgroundBlurriness;\n\n\t\t\t}\n\n\t\t} else if ( sceneData.backgroundNode ) {\n\n\t\t\tdelete sceneData.backgroundNode;\n\t\t\tdelete sceneData.background;\n\n\t\t}\n\n\t}\n\n\tupdateFog( scene ) {\n\n\t\tconst sceneData = this.get( scene );\n\t\tconst fog = scene.fog;\n\n\t\tif ( fog ) {\n\n\t\t\tif ( sceneData.fog !== fog ) {\n\n\t\t\t\tlet fogNode = null;\n\n\t\t\t\tif ( fog.isFogExp2 ) {\n\n\t\t\t\t\tconst color = reference( 'color', 'color', fog ).setGroup( renderGroup );\n\t\t\t\t\tconst density = reference( 'density', 'float', fog ).setGroup( renderGroup );\n\n\t\t\t\t\tfogNode = densityFog( color, density );\n\n\t\t\t\t} else if ( fog.isFog ) {\n\n\t\t\t\t\tconst color = reference( 'color', 'color', fog ).setGroup( renderGroup );\n\t\t\t\t\tconst near = reference( 'near', 'float', fog ).setGroup( renderGroup );\n\t\t\t\t\tconst far = reference( 'far', 'float', fog ).setGroup( renderGroup );\n\n\t\t\t\t\tfogNode = rangeFog( color, near, far );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'WebGPUNodes: Unsupported fog configuration.', fog );\n\n\t\t\t\t}\n\n\t\t\t\tsceneData.fogNode = fogNode;\n\t\t\t\tsceneData.fog = fog;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tdelete sceneData.fogNode;\n\t\t\tdelete sceneData.fog;\n\n\t\t}\n\n\t}\n\n\tupdateEnvironment( scene ) {\n\n\t\tconst sceneData = this.get( scene );\n\t\tconst environment = scene.environment;\n\n\t\tif ( environment ) {\n\n\t\t\tif ( sceneData.environment !== environment ) {\n\n\t\t\t\tlet environmentNode = null;\n\n\t\t\t\tif ( environment.isCubeTexture === true ) {\n\n\t\t\t\t\tenvironmentNode = cubeTexture( environment );\n\n\t\t\t\t} else if ( environment.isTexture === true ) {\n\n\t\t\t\t\tenvironmentNode = texture( environment );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( 'Nodes: Unsupported environment configuration.', environment );\n\n\t\t\t\t}\n\n\t\t\t\tsceneData.environmentNode = environmentNode;\n\t\t\t\tsceneData.environment = environment;\n\n\t\t\t}\n\n\t\t} else if ( sceneData.environmentNode ) {\n\n\t\t\tdelete sceneData.environmentNode;\n\t\t\tdelete sceneData.environment;\n\n\t\t}\n\n\t}\n\n\tgetNodeFrame( renderer = this.renderer, scene = null, object = null, camera = null, material = null ) {\n\n\t\tconst nodeFrame = this.nodeFrame;\n\t\tnodeFrame.renderer = renderer;\n\t\tnodeFrame.scene = scene;\n\t\tnodeFrame.object = object;\n\t\tnodeFrame.camera = camera;\n\t\tnodeFrame.material = material;\n\n\t\treturn nodeFrame;\n\n\t}\n\n\tgetNodeFrameForRender( renderObject ) {\n\n\t\treturn this.getNodeFrame( renderObject.renderer, renderObject.scene, renderObject.object, renderObject.camera, renderObject.material );\n\n\t}\n\n\tgetOutputCacheKey() {\n\n\t\tconst renderer = this.renderer;\n\n\t\treturn renderer.toneMapping + ',' + renderer.currentColorSpace;\n\n\t}\n\n\thasOutputChange( outputTarget ) {\n\n\t\tconst cacheKey = outputNodeMap.get( outputTarget );\n\n\t\treturn cacheKey !== this.getOutputCacheKey();\n\n\t}\n\n\tgetOutputNode( outputTexture ) {\n\n\t\tconst renderer = this.renderer;\n\t\tconst cacheKey = this.getOutputCacheKey();\n\n\t\tconst output = texture( outputTexture, screenUV ).renderOutput( renderer.toneMapping, renderer.currentColorSpace );\n\n\t\toutputNodeMap.set( outputTexture, cacheKey );\n\n\t\treturn output;\n\n\t}\n\n\tupdateBefore( renderObject ) {\n\n\t\tconst nodeBuilder = renderObject.getNodeBuilderState();\n\n\t\tfor ( const node of nodeBuilder.updateBeforeNodes ) {\n\n\t\t\t// update frame state for each node\n\n\t\t\tthis.getNodeFrameForRender( renderObject ).updateBeforeNode( node );\n\n\t\t}\n\n\t}\n\n\tupdateAfter( renderObject ) {\n\n\t\tconst nodeBuilder = renderObject.getNodeBuilderState();\n\n\t\tfor ( const node of nodeBuilder.updateAfterNodes ) {\n\n\t\t\t// update frame state for each node\n\n\t\t\tthis.getNodeFrameForRender( renderObject ).updateAfterNode( node );\n\n\t\t}\n\n\t}\n\n\tupdateForCompute( computeNode ) {\n\n\t\tconst nodeFrame = this.getNodeFrame();\n\t\tconst nodeBuilder = this.getForCompute( computeNode );\n\n\t\tfor ( const node of nodeBuilder.updateNodes ) {\n\n\t\t\tnodeFrame.updateNode( node );\n\n\t\t}\n\n\t}\n\n\tupdateForRender( renderObject ) {\n\n\t\tconst nodeFrame = this.getNodeFrameForRender( renderObject );\n\t\tconst nodeBuilder = renderObject.getNodeBuilderState();\n\n\t\tfor ( const node of nodeBuilder.updateNodes ) {\n\n\t\t\tnodeFrame.updateNode( node );\n\n\t\t}\n\n\t}\n\n\tneedsRefresh( renderObject ) {\n\n\t\tconst nodeFrame = this.getNodeFrameForRender( renderObject );\n\t\tconst monitor = renderObject.getMonitor();\n\n\t\treturn monitor.needsRefresh( renderObject, nodeFrame );\n\n\t}\n\n\tdispose() {\n\n\t\tsuper.dispose();\n\n\t\tthis.nodeFrame = new NodeFrame();\n\t\tthis.nodeBuilderCache = new Map();\n\n\t}\n\n}\n\nclass RenderBundle {\n\n\tconstructor( scene, camera ) {\n\n\t\tthis.scene = scene;\n\t\tthis.camera = camera;\n\n\t}\n\n\tclone() {\n\n\t\treturn Object.assign( new this.constructor(), this );\n\n\t}\n\n}\n\nclass RenderBundles {\n\n\tconstructor() {\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n\tget( scene, camera ) {\n\n\t\tconst lists = this.lists;\n\t\tconst keys = [ scene, camera ];\n\n\t\tlet list = lists.get( keys );\n\n\t\tif ( list === undefined ) {\n\n\t\t\tlist = new RenderBundle( scene, camera );\n\t\t\tlists.set( keys, list );\n\n\t\t}\n\n\t\treturn list;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.lists = new ChainMap();\n\n\t}\n\n}\n\nclass NodeLibrary {\n\n\tconstructor() {\n\n\t\tthis.lightNodes = new WeakMap();\n\t\tthis.materialNodes = new Map();\n\t\tthis.toneMappingNodes = new Map();\n\n\t}\n\n\tfromMaterial( material ) {\n\n\t\tif ( material.isNodeMaterial ) return material;\n\n\t\tlet nodeMaterial = null;\n\n\t\tconst nodeMaterialClass = this.getMaterialNodeClass( material.type );\n\n\t\tif ( nodeMaterialClass !== null ) {\n\n\t\t\tnodeMaterial = new nodeMaterialClass();\n\n\t\t\tfor ( const key in material ) {\n\n\t\t\t\tnodeMaterial[ key ] = material[ key ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeMaterial;\n\n\t}\n\n\taddToneMapping( toneMappingNode, toneMapping ) {\n\n\t\tthis.addType( toneMappingNode, toneMapping, this.toneMappingNodes );\n\n\t}\n\n\tgetToneMappingFunction( toneMapping ) {\n\n\t\treturn this.toneMappingNodes.get( toneMapping ) || null;\n\n\t}\n\n\tgetMaterialNodeClass( materialType ) {\n\n\t\treturn this.materialNodes.get( materialType ) || null;\n\n\t}\n\n\taddMaterial( materialNodeClass, materialClass ) {\n\n\t\tthis.addType( materialNodeClass, materialClass.type, this.materialNodes );\n\n\t}\n\n\tgetLightNodeClass( light ) {\n\n\t\treturn this.lightNodes.get( light ) || null;\n\n\t}\n\n\taddLight( lightNodeClass, lightClass ) {\n\n\t\tthis.addClass( lightNodeClass, lightClass, this.lightNodes );\n\n\t}\n\n\taddType( nodeClass, type, library ) {\n\n\t\tif ( library.has( type ) ) {\n\n\t\t\tconsole.warn( `Redefinition of node ${ type }` );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof nodeClass !== 'function' ) throw new Error( `Node class ${ nodeClass.name } is not a class.` );\n\t\tif ( typeof type === 'function' || typeof type === 'object' ) throw new Error( `Base class ${ type } is not a class.` );\n\n\t\tlibrary.set( type, nodeClass );\n\n\t}\n\n\taddClass( nodeClass, baseClass, library ) {\n\n\t\tif ( library.has( baseClass ) ) {\n\n\t\t\tconsole.warn( `Redefinition of node ${ baseClass.name }` );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof nodeClass !== 'function' ) throw new Error( `Node class ${ nodeClass.name } is not a class.` );\n\t\tif ( typeof baseClass !== 'function' ) throw new Error( `Base class ${ baseClass.name } is not a class.` );\n\n\t\tlibrary.set( baseClass, nodeClass );\n\n\t}\n\n}\n\nconst _defaultLights = /*@__PURE__*/ new LightsNode();\n\nclass Lighting extends ChainMap {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t}\n\n\tcreateNode( lights = [] ) {\n\n\t\treturn new LightsNode().setLights( lights );\n\n\t}\n\n\tgetNode( scene, camera ) {\n\n\t\t// ignore post-processing\n\n\t\tif ( scene.isQuadMesh ) return _defaultLights;\n\n\t\t// tiled lighting\n\n\t\tconst keys = [ scene, camera ];\n\n\t\tlet node = this.get( keys );\n\n\t\tif ( node === undefined ) {\n\n\t\t\tnode = this.createNode();\n\t\t\tthis.set( keys, node );\n\n\t\t}\n\n\t\treturn node;\n\n\t}\n\n}\n\nconst _scene = /*@__PURE__*/ new Scene();\nconst _drawingBufferSize = /*@__PURE__*/ new Vector2();\nconst _screen = /*@__PURE__*/ new Vector4();\nconst _frustum = /*@__PURE__*/ new Frustum();\nconst _projScreenMatrix = /*@__PURE__*/ new Matrix4();\nconst _vector4 = /*@__PURE__*/ new Vector4();\n\nclass Renderer {\n\n\tconstructor( backend, parameters = {} ) {\n\n\t\tthis.isRenderer = true;\n\n\t\t//\n\n\t\tconst {\n\t\t\tlogarithmicDepthBuffer = false,\n\t\t\talpha = true,\n\t\t\tdepth = true,\n\t\t\tstencil = false,\n\t\t\tantialias = false,\n\t\t\tsamples = 0,\n\t\t\tgetFallback = null\n\t\t} = parameters;\n\n\t\t// public\n\t\tthis.domElement = backend.getDomElement();\n\n\t\tthis.backend = backend;\n\n\t\tthis.samples = samples || ( antialias === true ) ? 4 : 0;\n\n\t\tthis.autoClear = true;\n\t\tthis.autoClearColor = true;\n\t\tthis.autoClearDepth = true;\n\t\tthis.autoClearStencil = true;\n\n\t\tthis.alpha = alpha;\n\n\t\tthis.logarithmicDepthBuffer = logarithmicDepthBuffer;\n\n\t\tthis.outputColorSpace = SRGBColorSpace;\n\n\t\tthis.toneMapping = NoToneMapping;\n\t\tthis.toneMappingExposure = 1.0;\n\n\t\tthis.sortObjects = true;\n\n\t\tthis.depth = depth;\n\t\tthis.stencil = stencil;\n\n\t\tthis.clippingPlanes = [];\n\n\t\tthis.info = new Info();\n\n\t\tthis.nodes = {\n\t\t\tmodelViewMatrix: null,\n\t\t\tmodelNormalViewMatrix: null\n\t\t};\n\n\t\tthis.library = new NodeLibrary();\n\t\tthis.lighting = new Lighting();\n\n\t\t// internals\n\n\t\tthis._getFallback = getFallback;\n\n\t\tthis._pixelRatio = 1;\n\t\tthis._width = this.domElement.width;\n\t\tthis._height = this.domElement.height;\n\n\t\tthis._viewport = new Vector4( 0, 0, this._width, this._height );\n\t\tthis._scissor = new Vector4( 0, 0, this._width, this._height );\n\t\tthis._scissorTest = false;\n\n\t\tthis._attributes = null;\n\t\tthis._geometries = null;\n\t\tthis._nodes = null;\n\t\tthis._animation = null;\n\t\tthis._bindings = null;\n\t\tthis._objects = null;\n\t\tthis._pipelines = null;\n\t\tthis._bundles = null;\n\t\tthis._renderLists = null;\n\t\tthis._renderContexts = null;\n\t\tthis._textures = null;\n\t\tthis._background = null;\n\n\t\tthis._quad = new QuadMesh( new NodeMaterial() );\n\t\tthis._quad.material.type = 'Renderer_output';\n\n\t\tthis._currentRenderContext = null;\n\n\t\tthis._opaqueSort = null;\n\t\tthis._transparentSort = null;\n\n\t\tthis._frameBufferTarget = null;\n\n\t\tconst alphaClear = this.alpha === true ? 0 : 1;\n\n\t\tthis._clearColor = new Color4( 0, 0, 0, alphaClear );\n\t\tthis._clearDepth = 1;\n\t\tthis._clearStencil = 0;\n\n\t\tthis._renderTarget = null;\n\t\tthis._activeCubeFace = 0;\n\t\tthis._activeMipmapLevel = 0;\n\n\t\tthis._mrt = null;\n\n\t\tthis._renderObjectFunction = null;\n\t\tthis._currentRenderObjectFunction = null;\n\t\tthis._currentRenderBundle = null;\n\n\t\tthis._handleObjectFunction = this._renderObjectDirect;\n\n\t\tthis._isDeviceLost = false;\n\t\tthis.onDeviceLost = this._onDeviceLost;\n\n\t\tthis._initialized = false;\n\t\tthis._initPromise = null;\n\n\t\tthis._compilationPromises = null;\n\n\t\tthis.transparent = true;\n\t\tthis.opaque = true;\n\n\t\tthis.shadowMap = {\n\t\t\tenabled: false,\n\t\t\ttype: PCFShadowMap$1\n\t\t};\n\n\t\tthis.xr = {\n\t\t\tenabled: false\n\t\t};\n\n\t\tthis.debug = {\n\t\t\tcheckShaderErrors: true,\n\t\t\tonShaderError: null,\n\t\t\tgetShaderAsync: async ( scene, camera, object ) => {\n\n\t\t\t\tawait this.compileAsync( scene, camera );\n\n\t\t\t\tconst renderList = this._renderLists.get( scene, camera );\n\t\t\t\tconst renderContext = this._renderContexts.get( scene, camera, this._renderTarget );\n\n\t\t\t\tconst material = scene.overrideMaterial || object.material;\n\n\t\t\t\tconst renderObject = this._objects.get( object, material, scene, camera, renderList.lightsNode, renderContext );\n\n\t\t\t\tconst { fragmentShader, vertexShader } = renderObject.getNodeBuilderState();\n\n\t\t\t\treturn { fragmentShader, vertexShader };\n\n\t\t\t}\n\t\t};\n\n\t}\n\n\tasync init() {\n\n\t\tif ( this._initialized ) {\n\n\t\t\tthrow new Error( 'Renderer: Backend has already been initialized.' );\n\n\t\t}\n\n\t\tif ( this._initPromise !== null ) {\n\n\t\t\treturn this._initPromise;\n\n\t\t}\n\n\t\tthis._initPromise = new Promise( async ( resolve, reject ) => {\n\n\t\t\tlet backend = this.backend;\n\n\t\t\ttry {\n\n\t\t\t\tawait backend.init( this );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\tif ( this._getFallback !== null ) {\n\n\t\t\t\t\t// try the fallback\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tthis.backend = backend = this._getFallback( error );\n\t\t\t\t\t\tawait backend.init( this );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\treject( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\treject( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis._nodes = new Nodes( this, backend );\n\t\t\tthis._animation = new Animation( this._nodes, this.info );\n\t\t\tthis._attributes = new Attributes( backend );\n\t\t\tthis._background = new Background( this, this._nodes );\n\t\t\tthis._geometries = new Geometries( this._attributes, this.info );\n\t\t\tthis._textures = new Textures( this, backend, this.info );\n\t\t\tthis._pipelines = new Pipelines( backend, this._nodes );\n\t\t\tthis._bindings = new Bindings( backend, this._nodes, this._textures, this._attributes, this._pipelines, this.info );\n\t\t\tthis._objects = new RenderObjects( this, this._nodes, this._geometries, this._pipelines, this._bindings, this.info );\n\t\t\tthis._renderLists = new RenderLists( this.lighting );\n\t\t\tthis._bundles = new RenderBundles();\n\t\t\tthis._renderContexts = new RenderContexts();\n\n\t\t\t//\n\n\t\t\tthis._initialized = true;\n\n\t\t\tresolve();\n\n\t\t} );\n\n\t\treturn this._initPromise;\n\n\t}\n\n\tget coordinateSystem() {\n\n\t\treturn this.backend.coordinateSystem;\n\n\t}\n\n\tasync compileAsync( scene, camera, targetScene = null ) {\n\n\t\tif ( this._isDeviceLost === true ) return;\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\t// preserve render tree\n\n\t\tconst nodeFrame = this._nodes.nodeFrame;\n\n\t\tconst previousRenderId = nodeFrame.renderId;\n\t\tconst previousRenderContext = this._currentRenderContext;\n\t\tconst previousRenderObjectFunction = this._currentRenderObjectFunction;\n\t\tconst previousCompilationPromises = this._compilationPromises;\n\n\t\t//\n\n\t\tconst sceneRef = ( scene.isScene === true ) ? scene : _scene;\n\n\t\tif ( targetScene === null ) targetScene = scene;\n\n\t\tconst renderTarget = this._renderTarget;\n\t\tconst renderContext = this._renderContexts.get( targetScene, camera, renderTarget );\n\t\tconst activeMipmapLevel = this._activeMipmapLevel;\n\n\t\tconst compilationPromises = [];\n\n\t\tthis._currentRenderContext = renderContext;\n\t\tthis._currentRenderObjectFunction = this.renderObject;\n\n\t\tthis._handleObjectFunction = this._createObjectPipeline;\n\n\t\tthis._compilationPromises = compilationPromises;\n\n\t\tnodeFrame.renderId ++;\n\n\t\t//\n\n\t\tnodeFrame.update();\n\n\t\t//\n\n\t\trenderContext.depth = this.depth;\n\t\trenderContext.stencil = this.stencil;\n\n\t\tif ( ! renderContext.clippingContext ) renderContext.clippingContext = new ClippingContext();\n\t\trenderContext.clippingContext.updateGlobal( this, camera );\n\n\t\t//\n\n\t\tsceneRef.onBeforeRender( this, scene, camera, renderTarget );\n\n\t\t//\n\n\t\tconst renderList = this._renderLists.get( scene, camera );\n\t\trenderList.begin();\n\n\t\tthis._projectObject( scene, camera, 0, renderList );\n\n\t\t// include lights from target scene\n\t\tif ( targetScene !== scene ) {\n\n\t\t\ttargetScene.traverseVisible( function ( object ) {\n\n\t\t\t\tif ( object.isLight && object.layers.test( camera.layers ) ) {\n\n\t\t\t\t\trenderList.pushLight( object );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t\trenderList.finish();\n\n\t\t//\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tthis._textures.updateRenderTarget( renderTarget, activeMipmapLevel );\n\n\t\t\tconst renderTargetData = this._textures.get( renderTarget );\n\n\t\t\trenderContext.textures = renderTargetData.textures;\n\t\t\trenderContext.depthTexture = renderTargetData.depthTexture;\n\n\t\t} else {\n\n\t\t\trenderContext.textures = null;\n\t\t\trenderContext.depthTexture = null;\n\n\t\t}\n\n\t\t//\n\n\t\tthis._nodes.updateScene( sceneRef );\n\n\t\t//\n\n\t\tthis._background.update( sceneRef, renderList, renderContext );\n\n\t\t// process render lists\n\n\t\tconst opaqueObjects = renderList.opaque;\n\t\tconst transparentObjects = renderList.transparent;\n\t\tconst lightsNode = renderList.lightsNode;\n\n\t\tif ( this.opaque === true && opaqueObjects.length > 0 ) this._renderObjects( opaqueObjects, camera, sceneRef, lightsNode );\n\t\tif ( this.transparent === true && transparentObjects.length > 0 ) this._renderTransparents( transparentObjects, camera, sceneRef, lightsNode );\n\n\t\t// restore render tree\n\n\t\tnodeFrame.renderId = previousRenderId;\n\n\t\tthis._currentRenderContext = previousRenderContext;\n\t\tthis._currentRenderObjectFunction = previousRenderObjectFunction;\n\t\tthis._compilationPromises = previousCompilationPromises;\n\n\t\tthis._handleObjectFunction = this._renderObjectDirect;\n\n\t\t// wait for all promises setup by backends awaiting compilation/linking/pipeline creation to complete\n\n\t\tawait Promise.all( compilationPromises );\n\n\t}\n\n\tasync renderAsync( scene, camera ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tconst renderContext = this._renderScene( scene, camera );\n\n\t\tawait this.backend.resolveTimestampAsync( renderContext, 'render' );\n\n\t}\n\n\tasync waitForGPU() {\n\n\t\tawait this.backend.waitForGPU();\n\n\t}\n\n\tsetMRT( mrt ) {\n\n\t\tthis._mrt = mrt;\n\n\t\treturn this;\n\n\t}\n\n\tgetMRT() {\n\n\t\treturn this._mrt;\n\n\t}\n\n\t_onDeviceLost( info ) {\n\n\t\tlet errorMessage = `THREE.WebGPURenderer: ${info.api} Device Lost:\\n\\nMessage: ${info.message}`;\n\n\t\tif ( info.reason ) {\n\n\t\t\terrorMessage += `\\nReason: ${info.reason}`;\n\n\t\t}\n\n\t\tconsole.error( errorMessage );\n\n\t\tthis._isDeviceLost = true;\n\n\t}\n\n\n\t_renderBundle( bundle, sceneRef, lightsNode ) {\n\n\t\tconst { bundleGroup, camera, renderList } = bundle;\n\n\t\tconst renderContext = this._currentRenderContext;\n\n\t\t//\n\n\t\tconst renderBundle = this._bundles.get( bundleGroup, camera );\n\t\tconst renderBundleData = this.backend.get( renderBundle );\n\n\t\tif ( renderBundleData.renderContexts === undefined ) renderBundleData.renderContexts = new Set();\n\n\t\t//\n\n\t\tconst needsUpdate = bundleGroup.version !== renderBundleData.version;\n\t\tconst renderBundleNeedsUpdate = renderBundleData.renderContexts.has( renderContext ) === false || needsUpdate;\n\n\t\trenderBundleData.renderContexts.add( renderContext );\n\n\t\tif ( renderBundleNeedsUpdate ) {\n\n\t\t\tthis.backend.beginBundle( renderContext );\n\n\t\t\tif ( renderBundleData.renderObjects === undefined || needsUpdate ) {\n\n\t\t\t\trenderBundleData.renderObjects = [];\n\n\t\t\t}\n\n\t\t\tthis._currentRenderBundle = renderBundle;\n\n\t\t\tconst opaqueObjects = renderList.opaque;\n\n\t\t\tif ( this.opaque === true && opaqueObjects.length > 0 ) this._renderObjects( opaqueObjects, camera, sceneRef, lightsNode );\n\n\t\t\tthis._currentRenderBundle = null;\n\n\t\t\t//\n\n\t\t\tthis.backend.finishBundle( renderContext, renderBundle );\n\n\t\t\trenderBundleData.version = bundleGroup.version;\n\n\t\t} else {\n\n\t\t\tconst { renderObjects } = renderBundleData;\n\n\t\t\tfor ( let i = 0, l = renderObjects.length; i < l; i ++ ) {\n\n\t\t\t\tconst renderObject = renderObjects[ i ];\n\n\t\t\t\tif ( this._nodes.needsRefresh( renderObject ) ) {\n\n\t\t\t\t\tthis._nodes.updateBefore( renderObject );\n\n\t\t\t\t\tthis._nodes.updateForRender( renderObject );\n\t\t\t\t\tthis._bindings.updateForRender( renderObject );\n\n\t\t\t\t\tthis._nodes.updateAfter( renderObject );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.backend.addBundle( renderContext, renderBundle );\n\n\t}\n\n\trender( scene, camera ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead.' );\n\n\t\t\treturn this.renderAsync( scene, camera );\n\n\t\t}\n\n\t\tthis._renderScene( scene, camera );\n\n\t}\n\n\t_getFrameBufferTarget() {\n\n\t\tconst { currentToneMapping, currentColorSpace } = this;\n\n\t\tconst useToneMapping = currentToneMapping !== NoToneMapping;\n\t\tconst useColorSpace = currentColorSpace !== LinearSRGBColorSpace;\n\n\t\tif ( useToneMapping === false && useColorSpace === false ) return null;\n\n\t\tconst { width, height } = this.getDrawingBufferSize( _drawingBufferSize );\n\t\tconst { depth, stencil } = this;\n\n\t\tlet frameBufferTarget = this._frameBufferTarget;\n\n\t\tif ( frameBufferTarget === null ) {\n\n\t\t\tframeBufferTarget = new RenderTarget( width, height, {\n\t\t\t\tdepthBuffer: depth,\n\t\t\t\tstencilBuffer: stencil,\n\t\t\t\ttype: HalfFloatType, // FloatType\n\t\t\t\tformat: RGBAFormat,\n\t\t\t\tcolorSpace: LinearSRGBColorSpace,\n\t\t\t\tgenerateMipmaps: false,\n\t\t\t\tminFilter: LinearFilter,\n\t\t\t\tmagFilter: LinearFilter,\n\t\t\t\tsamples: this.samples\n\t\t\t} );\n\n\t\t\tframeBufferTarget.isPostProcessingRenderTarget = true;\n\n\t\t\tthis._frameBufferTarget = frameBufferTarget;\n\n\t\t}\n\n\t\tframeBufferTarget.depthBuffer = depth;\n\t\tframeBufferTarget.stencilBuffer = stencil;\n\t\tframeBufferTarget.setSize( width, height );\n\t\tframeBufferTarget.viewport.copy( this._viewport );\n\t\tframeBufferTarget.scissor.copy( this._scissor );\n\t\tframeBufferTarget.viewport.multiplyScalar( this._pixelRatio );\n\t\tframeBufferTarget.scissor.multiplyScalar( this._pixelRatio );\n\t\tframeBufferTarget.scissorTest = this._scissorTest;\n\n\t\treturn frameBufferTarget;\n\n\t}\n\n\t_renderScene( scene, camera, useFrameBufferTarget = true ) {\n\n\t\tif ( this._isDeviceLost === true ) return;\n\n\t\tconst frameBufferTarget = useFrameBufferTarget ? this._getFrameBufferTarget() : null;\n\n\t\t// preserve render tree\n\n\t\tconst nodeFrame = this._nodes.nodeFrame;\n\n\t\tconst previousRenderId = nodeFrame.renderId;\n\t\tconst previousRenderContext = this._currentRenderContext;\n\t\tconst previousRenderObjectFunction = this._currentRenderObjectFunction;\n\n\t\t//\n\n\t\tconst sceneRef = ( scene.isScene === true ) ? scene : _scene;\n\n\t\tconst outputRenderTarget = this._renderTarget;\n\n\t\tconst activeCubeFace = this._activeCubeFace;\n\t\tconst activeMipmapLevel = this._activeMipmapLevel;\n\n\t\t//\n\n\t\tlet renderTarget;\n\n\t\tif ( frameBufferTarget !== null ) {\n\n\t\t\trenderTarget = frameBufferTarget;\n\n\t\t\tthis.setRenderTarget( renderTarget );\n\n\t\t} else {\n\n\t\t\trenderTarget = outputRenderTarget;\n\n\t\t}\n\n\t\t//\n\n\t\tconst renderContext = this._renderContexts.get( scene, camera, renderTarget );\n\n\t\tthis._currentRenderContext = renderContext;\n\t\tthis._currentRenderObjectFunction = this._renderObjectFunction || this.renderObject;\n\n\t\t//\n\n\t\tthis.info.calls ++;\n\t\tthis.info.render.calls ++;\n\t\tthis.info.render.frameCalls ++;\n\n\t\tnodeFrame.renderId = this.info.calls;\n\n\t\t//\n\n\t\tconst coordinateSystem = this.coordinateSystem;\n\n\t\tif ( camera.coordinateSystem !== coordinateSystem ) {\n\n\t\t\tcamera.coordinateSystem = coordinateSystem;\n\n\t\t\tcamera.updateProjectionMatrix();\n\n\t\t}\n\n\t\t//\n\n\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\n\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t//\n\n\t\tlet viewport = this._viewport;\n\t\tlet scissor = this._scissor;\n\t\tlet pixelRatio = this._pixelRatio;\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tviewport = renderTarget.viewport;\n\t\t\tscissor = renderTarget.scissor;\n\t\t\tpixelRatio = 1;\n\n\t\t}\n\n\t\tthis.getDrawingBufferSize( _drawingBufferSize );\n\n\t\t_screen.set( 0, 0, _drawingBufferSize.width, _drawingBufferSize.height );\n\n\t\tconst minDepth = ( viewport.minDepth === undefined ) ? 0 : viewport.minDepth;\n\t\tconst maxDepth = ( viewport.maxDepth === undefined ) ? 1 : viewport.maxDepth;\n\n\t\trenderContext.viewportValue.copy( viewport ).multiplyScalar( pixelRatio ).floor();\n\t\trenderContext.viewportValue.width >>= activeMipmapLevel;\n\t\trenderContext.viewportValue.height >>= activeMipmapLevel;\n\t\trenderContext.viewportValue.minDepth = minDepth;\n\t\trenderContext.viewportValue.maxDepth = maxDepth;\n\t\trenderContext.viewport = renderContext.viewportValue.equals( _screen ) === false;\n\n\t\trenderContext.scissorValue.copy( scissor ).multiplyScalar( pixelRatio ).floor();\n\t\trenderContext.scissor = this._scissorTest && renderContext.scissorValue.equals( _screen ) === false;\n\t\trenderContext.scissorValue.width >>= activeMipmapLevel;\n\t\trenderContext.scissorValue.height >>= activeMipmapLevel;\n\n\t\tif ( ! renderContext.clippingContext ) renderContext.clippingContext = new ClippingContext();\n\t\trenderContext.clippingContext.updateGlobal( this, camera );\n\n\t\t//\n\n\t\tsceneRef.onBeforeRender( this, scene, camera, renderTarget );\n\n\t\t//\n\n\t\t_projScreenMatrix.multiplyMatrices( camera.projectionMatrix, camera.matrixWorldInverse );\n\t\t_frustum.setFromProjectionMatrix( _projScreenMatrix, coordinateSystem );\n\n\t\tconst renderList = this._renderLists.get( scene, camera );\n\t\trenderList.begin();\n\n\t\tthis._projectObject( scene, camera, 0, renderList );\n\n\t\trenderList.finish();\n\n\t\tif ( this.sortObjects === true ) {\n\n\t\t\trenderList.sort( this._opaqueSort, this._transparentSort );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tthis._textures.updateRenderTarget( renderTarget, activeMipmapLevel );\n\n\t\t\tconst renderTargetData = this._textures.get( renderTarget );\n\n\t\t\trenderContext.textures = renderTargetData.textures;\n\t\t\trenderContext.depthTexture = renderTargetData.depthTexture;\n\t\t\trenderContext.width = renderTargetData.width;\n\t\t\trenderContext.height = renderTargetData.height;\n\t\t\trenderContext.renderTarget = renderTarget;\n\t\t\trenderContext.depth = renderTarget.depthBuffer;\n\t\t\trenderContext.stencil = renderTarget.stencilBuffer;\n\n\t\t} else {\n\n\t\t\trenderContext.textures = null;\n\t\t\trenderContext.depthTexture = null;\n\t\t\trenderContext.width = this.domElement.width;\n\t\t\trenderContext.height = this.domElement.height;\n\t\t\trenderContext.depth = this.depth;\n\t\t\trenderContext.stencil = this.stencil;\n\n\t\t}\n\n\t\trenderContext.width >>= activeMipmapLevel;\n\t\trenderContext.height >>= activeMipmapLevel;\n\t\trenderContext.activeCubeFace = activeCubeFace;\n\t\trenderContext.activeMipmapLevel = activeMipmapLevel;\n\t\trenderContext.occlusionQueryCount = renderList.occlusionQueryCount;\n\n\t\t//\n\n\t\tthis._nodes.updateScene( sceneRef );\n\n\t\t//\n\n\t\tthis._background.update( sceneRef, renderList, renderContext );\n\n\t\t//\n\n\t\tthis.backend.beginRender( renderContext );\n\n\t\t// process render lists\n\n\t\tconst {\n\t\t\tbundles,\n\t\t\tlightsNode,\n\t\t\ttransparentDoublePass: transparentDoublePassObjects,\n\t\t\ttransparent: transparentObjects,\n\t\t\topaque: opaqueObjects\n\t\t} = renderList;\n\n\t\tif ( bundles.length > 0 ) this._renderBundles( bundles, sceneRef, lightsNode );\n\t\tif ( this.opaque === true && opaqueObjects.length > 0 ) this._renderObjects( opaqueObjects, camera, sceneRef, lightsNode );\n\t\tif ( this.transparent === true && transparentObjects.length > 0 ) this._renderTransparents( transparentObjects, transparentDoublePassObjects, camera, sceneRef, lightsNode );\n\n\t\t// finish render pass\n\n\t\tthis.backend.finishRender( renderContext );\n\n\t\t// restore render tree\n\n\t\tnodeFrame.renderId = previousRenderId;\n\n\t\tthis._currentRenderContext = previousRenderContext;\n\t\tthis._currentRenderObjectFunction = previousRenderObjectFunction;\n\n\t\t//\n\n\t\tif ( frameBufferTarget !== null ) {\n\n\t\t\tthis.setRenderTarget( outputRenderTarget, activeCubeFace, activeMipmapLevel );\n\n\t\t\tconst quad = this._quad;\n\n\t\t\tif ( this._nodes.hasOutputChange( renderTarget.texture ) ) {\n\n\t\t\t\tquad.material.fragmentNode = this._nodes.getOutputNode( renderTarget.texture );\n\t\t\t\tquad.material.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tthis._renderScene( quad, quad.camera, false );\n\n\t\t}\n\n\t\t//\n\n\t\tsceneRef.onAfterRender( this, scene, camera, renderTarget );\n\n\t\t//\n\n\t\treturn renderContext;\n\n\t}\n\n\tgetMaxAnisotropy() {\n\n\t\treturn this.backend.getMaxAnisotropy();\n\n\t}\n\n\tgetActiveCubeFace() {\n\n\t\treturn this._activeCubeFace;\n\n\t}\n\n\tgetActiveMipmapLevel() {\n\n\t\treturn this._activeMipmapLevel;\n\n\t}\n\n\tasync setAnimationLoop( callback ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis._animation.setAnimationLoop( callback );\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\treturn await this.backend.getArrayBufferAsync( attribute );\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.backend.getContext();\n\n\t}\n\n\tgetPixelRatio() {\n\n\t\treturn this._pixelRatio;\n\n\t}\n\n\tgetDrawingBufferSize( target ) {\n\n\t\treturn target.set( this._width * this._pixelRatio, this._height * this._pixelRatio ).floor();\n\n\t}\n\n\tgetSize( target ) {\n\n\t\treturn target.set( this._width, this._height );\n\n\t}\n\n\tsetPixelRatio( value = 1 ) {\n\n\t\tif ( this._pixelRatio === value ) return;\n\n\t\tthis._pixelRatio = value;\n\n\t\tthis.setSize( this._width, this._height, false );\n\n\t}\n\n\tsetDrawingBufferSize( width, height, pixelRatio ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis._pixelRatio = pixelRatio;\n\n\t\tthis.domElement.width = Math.floor( width * pixelRatio );\n\t\tthis.domElement.height = Math.floor( height * pixelRatio );\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t\tif ( this._initialized ) this.backend.updateSize();\n\n\t}\n\n\tsetSize( width, height, updateStyle = true ) {\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis.domElement.width = Math.floor( width * this._pixelRatio );\n\t\tthis.domElement.height = Math.floor( height * this._pixelRatio );\n\n\t\tif ( updateStyle === true ) {\n\n\t\t\tthis.domElement.style.width = width + 'px';\n\t\t\tthis.domElement.style.height = height + 'px';\n\n\t\t}\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t\tif ( this._initialized ) this.backend.updateSize();\n\n\t}\n\n\tsetOpaqueSort( method ) {\n\n\t\tthis._opaqueSort = method;\n\n\t}\n\n\tsetTransparentSort( method ) {\n\n\t\tthis._transparentSort = method;\n\n\t}\n\n\tgetScissor( target ) {\n\n\t\tconst scissor = this._scissor;\n\n\t\ttarget.x = scissor.x;\n\t\ttarget.y = scissor.y;\n\t\ttarget.width = scissor.width;\n\t\ttarget.height = scissor.height;\n\n\t\treturn target;\n\n\t}\n\n\tsetScissor( x, y, width, height ) {\n\n\t\tconst scissor = this._scissor;\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\tscissor.copy( x );\n\n\t\t} else {\n\n\t\t\tscissor.set( x, y, width, height );\n\n\t\t}\n\n\t}\n\n\tgetScissorTest() {\n\n\t\treturn this._scissorTest;\n\n\t}\n\n\tsetScissorTest( boolean ) {\n\n\t\tthis._scissorTest = boolean;\n\n\t\tthis.backend.setScissorTest( boolean );\n\n\t}\n\n\tgetViewport( target ) {\n\n\t\treturn target.copy( this._viewport );\n\n\t}\n\n\tsetViewport( x, y, width, height, minDepth = 0, maxDepth = 1 ) {\n\n\t\tconst viewport = this._viewport;\n\n\t\tif ( x.isVector4 ) {\n\n\t\t\tviewport.copy( x );\n\n\t\t} else {\n\n\t\t\tviewport.set( x, y, width, height );\n\n\t\t}\n\n\t\tviewport.minDepth = minDepth;\n\t\tviewport.maxDepth = maxDepth;\n\n\t}\n\n\tgetClearColor( target ) {\n\n\t\treturn target.copy( this._clearColor );\n\n\t}\n\n\tsetClearColor( color, alpha = 1 ) {\n\n\t\tthis._clearColor.set( color );\n\t\tthis._clearColor.a = alpha;\n\n\t}\n\n\tgetClearAlpha() {\n\n\t\treturn this._clearColor.a;\n\n\t}\n\n\tsetClearAlpha( alpha ) {\n\n\t\tthis._clearColor.a = alpha;\n\n\t}\n\n\tgetClearDepth() {\n\n\t\treturn this._clearDepth;\n\n\t}\n\n\tsetClearDepth( depth ) {\n\n\t\tthis._clearDepth = depth;\n\n\t}\n\n\tgetClearStencil() {\n\n\t\treturn this._clearStencil;\n\n\t}\n\n\tsetClearStencil( stencil ) {\n\n\t\tthis._clearStencil = stencil;\n\n\t}\n\n\tisOccluded( object ) {\n\n\t\tconst renderContext = this._currentRenderContext;\n\n\t\treturn renderContext && this.backend.isOccluded( renderContext, object );\n\n\t}\n\n\tclear( color = true, depth = true, stencil = true ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead.' );\n\n\t\t\treturn this.clearAsync( color, depth, stencil );\n\n\t\t}\n\n\t\tconst renderTarget = this._renderTarget || this._getFrameBufferTarget();\n\n\t\tlet renderTargetData = null;\n\n\t\tif ( renderTarget !== null ) {\n\n\t\t\tthis._textures.updateRenderTarget( renderTarget );\n\n\t\t\trenderTargetData = this._textures.get( renderTarget );\n\n\t\t}\n\n\t\tthis.backend.clear( color, depth, stencil, renderTargetData );\n\n\t\tif ( renderTarget !== null && this._renderTarget === null ) {\n\n\t\t\t// If a color space transform or tone mapping is required,\n\t\t\t// the clear operation clears the intermediate renderTarget texture, but does not update the screen canvas.\n\n\t\t\tconst quad = this._quad;\n\n\t\t\tif ( this._nodes.hasOutputChange( renderTarget.texture ) ) {\n\n\t\t\t\tquad.material.fragmentNode = this._nodes.getOutputNode( renderTarget.texture );\n\t\t\t\tquad.material.needsUpdate = true;\n\n\t\t\t}\n\n\t\t\tthis._renderScene( quad, quad.camera, false );\n\n\t\t}\n\n\t}\n\n\tclearColor() {\n\n\t\treturn this.clear( true, false, false );\n\n\t}\n\n\tclearDepth() {\n\n\t\treturn this.clear( false, true, false );\n\n\t}\n\n\tclearStencil() {\n\n\t\treturn this.clear( false, false, true );\n\n\t}\n\n\tasync clearAsync( color = true, depth = true, stencil = true ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis.clear( color, depth, stencil );\n\n\t}\n\n\tclearColorAsync() {\n\n\t\treturn this.clearAsync( true, false, false );\n\n\t}\n\n\tclearDepthAsync() {\n\n\t\treturn this.clearAsync( false, true, false );\n\n\t}\n\n\tclearStencilAsync() {\n\n\t\treturn this.clearAsync( false, false, true );\n\n\t}\n\n\tget currentToneMapping() {\n\n\t\treturn this._renderTarget !== null ? NoToneMapping : this.toneMapping;\n\n\t}\n\n\tget currentColorSpace() {\n\n\t\treturn this._renderTarget !== null ? LinearSRGBColorSpace : this.outputColorSpace;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.info.dispose();\n\t\tthis.backend.dispose();\n\n\t\tthis._animation.dispose();\n\t\tthis._objects.dispose();\n\t\tthis._pipelines.dispose();\n\t\tthis._nodes.dispose();\n\t\tthis._bindings.dispose();\n\t\tthis._renderLists.dispose();\n\t\tthis._renderContexts.dispose();\n\t\tthis._textures.dispose();\n\n\t\tthis.setRenderTarget( null );\n\t\tthis.setAnimationLoop( null );\n\n\t}\n\n\tsetRenderTarget( renderTarget, activeCubeFace = 0, activeMipmapLevel = 0 ) {\n\n\t\tthis._renderTarget = renderTarget;\n\t\tthis._activeCubeFace = activeCubeFace;\n\t\tthis._activeMipmapLevel = activeMipmapLevel;\n\n\t}\n\n\tgetRenderTarget() {\n\n\t\treturn this._renderTarget;\n\n\t}\n\n\tsetRenderObjectFunction( renderObjectFunction ) {\n\n\t\tthis._renderObjectFunction = renderObjectFunction;\n\n\t}\n\n\tgetRenderObjectFunction() {\n\n\t\treturn this._renderObjectFunction;\n\n\t}\n\n\tcompute( computeNodes ) {\n\n\t\tif ( this.isDeviceLost === true ) return;\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead.' );\n\n\t\t\treturn this.computeAsync( computeNodes );\n\n\t\t}\n\n\t\t//\n\n\t\tconst nodeFrame = this._nodes.nodeFrame;\n\n\t\tconst previousRenderId = nodeFrame.renderId;\n\n\t\t//\n\n\t\tthis.info.calls ++;\n\t\tthis.info.compute.calls ++;\n\t\tthis.info.compute.frameCalls ++;\n\n\t\tnodeFrame.renderId = this.info.calls;\n\n\t\t//\n\n\t\tconst backend = this.backend;\n\t\tconst pipelines = this._pipelines;\n\t\tconst bindings = this._bindings;\n\t\tconst nodes = this._nodes;\n\n\t\tconst computeList = Array.isArray( computeNodes ) ? computeNodes : [ computeNodes ];\n\n\t\tif ( computeList[ 0 ] === undefined || computeList[ 0 ].isComputeNode !== true ) {\n\n\t\t\tthrow new Error( 'THREE.Renderer: .compute() expects a ComputeNode.' );\n\n\t\t}\n\n\t\tbackend.beginCompute( computeNodes );\n\n\t\tfor ( const computeNode of computeList ) {\n\n\t\t\t// onInit\n\n\t\t\tif ( pipelines.has( computeNode ) === false ) {\n\n\t\t\t\tconst dispose = () => {\n\n\t\t\t\t\tcomputeNode.removeEventListener( 'dispose', dispose );\n\n\t\t\t\t\tpipelines.delete( computeNode );\n\t\t\t\t\tbindings.delete( computeNode );\n\t\t\t\t\tnodes.delete( computeNode );\n\n\t\t\t\t};\n\n\t\t\t\tcomputeNode.addEventListener( 'dispose', dispose );\n\n\t\t\t\t//\n\n\t\t\t\tconst onInitFn = computeNode.onInitFunction;\n\n\t\t\t\tif ( onInitFn !== null ) {\n\n\t\t\t\t\tonInitFn.call( computeNode, { renderer: this } );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnodes.updateForCompute( computeNode );\n\t\t\tbindings.updateForCompute( computeNode );\n\n\t\t\tconst computeBindings = bindings.getForCompute( computeNode );\n\t\t\tconst computePipeline = pipelines.getForCompute( computeNode, computeBindings );\n\n\t\t\tbackend.compute( computeNodes, computeNode, computeBindings, computePipeline );\n\n\t\t}\n\n\t\tbackend.finishCompute( computeNodes );\n\n\t\t//\n\n\t\tnodeFrame.renderId = previousRenderId;\n\n\t}\n\n\tasync computeAsync( computeNodes ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\tthis.compute( computeNodes );\n\n\t\tawait this.backend.resolveTimestampAsync( computeNodes, 'compute' );\n\n\t}\n\n\tasync hasFeatureAsync( name ) {\n\n\t\tif ( this._initialized === false ) await this.init();\n\n\t\treturn this.backend.hasFeature( name );\n\n\t}\n\n\thasFeature( name ) {\n\n\t\tif ( this._initialized === false ) {\n\n\t\t\tconsole.warn( 'THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead.' );\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\treturn this.backend.hasFeature( name );\n\n\t}\n\n\tcopyFramebufferToTexture( framebufferTexture, rectangle = null ) {\n\n\t\tif ( rectangle !== null ) {\n\n\t\t\tif ( rectangle.isVector2 ) {\n\n\t\t\t\trectangle = _vector4.set( rectangle.x, rectangle.y, framebufferTexture.image.width, framebufferTexture.image.height ).floor();\n\n\t\t\t} else if ( rectangle.isVector4 ) {\n\n\t\t\t\trectangle = _vector4.copy( rectangle ).floor();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.' );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\trectangle = _vector4.set( 0, 0, framebufferTexture.image.width, framebufferTexture.image.height );\n\n\t\t}\n\n\t\t//\n\n\t\tlet renderContext = this._currentRenderContext;\n\t\tlet renderTarget;\n\n\t\tif ( renderContext !== null ) {\n\n\t\t\trenderTarget = renderContext.renderTarget;\n\n\t\t} else {\n\n\t\t\trenderTarget = this._renderTarget || this._getFrameBufferTarget();\n\n\t\t\tif ( renderTarget !== null ) {\n\n\t\t\t\tthis._textures.updateRenderTarget( renderTarget );\n\n\t\t\t\trenderContext = this._textures.get( renderTarget );\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tthis._textures.updateTexture( framebufferTexture, { renderTarget } );\n\n\t\tthis.backend.copyFramebufferToTexture( framebufferTexture, renderContext, rectangle );\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion = null, dstPosition = null, level = 0 ) {\n\n\t\tthis._textures.updateTexture( srcTexture );\n\t\tthis._textures.updateTexture( dstTexture );\n\n\t\tthis.backend.copyTextureToTexture( srcTexture, dstTexture, srcRegion, dstPosition, level );\n\n\t}\n\n\treadRenderTargetPixelsAsync( renderTarget, x, y, width, height, index = 0, faceIndex = 0 ) {\n\n\t\treturn this.backend.copyTextureToBuffer( renderTarget.textures[ index ], x, y, width, height, faceIndex );\n\n\t}\n\n\t_projectObject( object, camera, groupOrder, renderList ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tconst visible = object.layers.test( camera.layers );\n\n\t\tif ( visible ) {\n\n\t\t\tif ( object.isGroup ) {\n\n\t\t\t\tgroupOrder = object.renderOrder;\n\n\t\t\t} else if ( object.isLOD ) {\n\n\t\t\t\tif ( object.autoUpdate === true ) object.update( camera );\n\n\t\t\t} else if ( object.isLight ) {\n\n\t\t\t\trenderList.pushLight( object );\n\n\t\t\t} else if ( object.isSprite ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsSprite( object ) ) {\n\n\t\t\t\t\tif ( this.sortObjects === true ) {\n\n\t\t\t\t\t\t_vector4.setFromMatrixPosition( object.matrixWorld ).applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { geometry, material } = object;\n\n\t\t\t\t\tif ( material.visible ) {\n\n\t\t\t\t\t\trenderList.push( object, geometry, material, groupOrder, _vector4.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object.isLineLoop ) {\n\n\t\t\t\tconsole.error( 'THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.' );\n\n\t\t\t} else if ( object.isMesh || object.isLine || object.isPoints ) {\n\n\t\t\t\tif ( ! object.frustumCulled || _frustum.intersectsObject( object ) ) {\n\n\t\t\t\t\tconst { geometry, material } = object;\n\n\t\t\t\t\tif ( this.sortObjects === true ) {\n\n\t\t\t\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\n\n\t\t\t\t\t\t_vector4\n\t\t\t\t\t\t\t.copy( geometry.boundingSphere.center )\n\t\t\t\t\t\t\t.applyMatrix4( object.matrixWorld )\n\t\t\t\t\t\t\t.applyMatrix4( _projScreenMatrix );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Array.isArray( material ) ) {\n\n\t\t\t\t\t\tconst groups = geometry.groups;\n\n\t\t\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i ++ ) {\n\n\t\t\t\t\t\t\tconst group = groups[ i ];\n\t\t\t\t\t\t\tconst groupMaterial = material[ group.materialIndex ];\n\n\t\t\t\t\t\t\tif ( groupMaterial && groupMaterial.visible ) {\n\n\t\t\t\t\t\t\t\trenderList.push( object, geometry, groupMaterial, groupOrder, _vector4.z, group );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( material.visible ) {\n\n\t\t\t\t\t\trenderList.push( object, geometry, material, groupOrder, _vector4.z, null );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.isBundleGroup === true && this.backend.beginBundle !== undefined ) {\n\n\t\t\tconst baseRenderList = renderList;\n\n\t\t\t// replace render list\n\t\t\trenderList = this._renderLists.get( object, camera );\n\n\t\t\trenderList.begin();\n\n\t\t\tbaseRenderList.pushBundle( {\n\t\t\t\tbundleGroup: object,\n\t\t\t\tcamera,\n\t\t\t\trenderList,\n\t\t\t} );\n\n\t\t\trenderList.finish();\n\n\t\t}\n\n\t\tconst children = object.children;\n\n\t\tfor ( let i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tthis._projectObject( children[ i ], camera, groupOrder, renderList );\n\n\t\t}\n\n\t}\n\n\t_renderBundles( bundles, sceneRef, lightsNode ) {\n\n\t\tfor ( const bundle of bundles ) {\n\n\t\t\tthis._renderBundle( bundle, sceneRef, lightsNode );\n\n\t\t}\n\n\t}\n\n\t_renderTransparents( renderList, doublePassList, camera, scene, lightsNode ) {\n\n\t\tif ( doublePassList.length > 0 ) {\n\n\t\t\t// render back side\n\n\t\t\tfor ( const { material } of doublePassList ) {\n\n\t\t\t\tmaterial.side = BackSide;\n\n\t\t\t}\n\n\t\t\tthis._renderObjects( doublePassList, camera, scene, lightsNode, 'backSide' );\n\n\t\t\t// render front side\n\n\t\t\tfor ( const { material } of doublePassList ) {\n\n\t\t\t\tmaterial.side = FrontSide;\n\n\t\t\t}\n\n\t\t\tthis._renderObjects( renderList, camera, scene, lightsNode );\n\n\t\t\t// restore\n\n\t\t\tfor ( const { material } of doublePassList ) {\n\n\t\t\t\tmaterial.side = DoubleSide;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis._renderObjects( renderList, camera, scene, lightsNode );\n\n\t\t}\n\n\t}\n\n\t_renderObjects( renderList, camera, scene, lightsNode, passId = null ) {\n\n\t\t// process renderable objects\n\n\t\tfor ( let i = 0, il = renderList.length; i < il; i ++ ) {\n\n\t\t\tconst renderItem = renderList[ i ];\n\n\t\t\t// @TODO: Add support for multiple materials per object. This will require to extract\n\t\t\t// the material from the renderItem object and pass it with its group data to renderObject().\n\n\t\t\tconst { object, geometry, material, group } = renderItem;\n\n\t\t\tif ( camera.isArrayCamera ) {\n\n\t\t\t\tconst cameras = camera.cameras;\n\n\t\t\t\tfor ( let j = 0, jl = cameras.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst camera2 = cameras[ j ];\n\n\t\t\t\t\tif ( object.layers.test( camera2.layers ) ) {\n\n\t\t\t\t\t\tconst vp = camera2.viewport;\n\t\t\t\t\t\tconst minDepth = ( vp.minDepth === undefined ) ? 0 : vp.minDepth;\n\t\t\t\t\t\tconst maxDepth = ( vp.maxDepth === undefined ) ? 1 : vp.maxDepth;\n\n\t\t\t\t\t\tconst viewportValue = this._currentRenderContext.viewportValue;\n\t\t\t\t\t\tviewportValue.copy( vp ).multiplyScalar( this._pixelRatio ).floor();\n\t\t\t\t\t\tviewportValue.minDepth = minDepth;\n\t\t\t\t\t\tviewportValue.maxDepth = maxDepth;\n\n\t\t\t\t\t\tthis.backend.updateViewport( this._currentRenderContext );\n\n\t\t\t\t\t\tthis._currentRenderObjectFunction( object, scene, camera2, geometry, material, group, lightsNode, passId );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tthis._currentRenderObjectFunction( object, scene, camera, geometry, material, group, lightsNode, passId );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\trenderObject( object, scene, camera, geometry, material, group, lightsNode, passId = null ) {\n\n\t\tlet overridePositionNode;\n\t\tlet overrideFragmentNode;\n\t\tlet overrideDepthNode;\n\n\t\t//\n\n\t\tobject.onBeforeRender( this, scene, camera, geometry, material, group );\n\n\t\t//\n\n\t\tif ( scene.overrideMaterial !== null ) {\n\n\t\t\tconst overrideMaterial = scene.overrideMaterial;\n\n\t\t\tif ( material.positionNode && material.positionNode.isNode ) {\n\n\t\t\t\toverridePositionNode = overrideMaterial.positionNode;\n\t\t\t\toverrideMaterial.positionNode = material.positionNode;\n\n\t\t\t}\n\n\t\t\tif ( overrideMaterial.isShadowNodeMaterial ) {\n\n\t\t\t\toverrideMaterial.side = material.shadowSide === null ? material.side : material.shadowSide;\n\n\t\t\t\tif ( material.depthNode && material.depthNode.isNode ) {\n\n\t\t\t\t\toverrideDepthNode = overrideMaterial.depthNode;\n\t\t\t\t\toverrideMaterial.depthNode = material.depthNode;\n\n\t\t\t\t}\n\n\n\t\t\t\tif ( material.shadowNode && material.shadowNode.isNode ) {\n\n\t\t\t\t\toverrideFragmentNode = overrideMaterial.fragmentNode;\n\t\t\t\t\toverrideMaterial.fragmentNode = material.shadowNode;\n\n\t\t\t\t}\n\n\t\t\t\tif ( this.localClippingEnabled ) {\n\n\t\t\t\t\tif ( material.clipShadows ) {\n\n\t\t\t\t\t\tif ( overrideMaterial.clippingPlanes !== material.clippingPlanes ) {\n\n\t\t\t\t\t\t\toverrideMaterial.clippingPlanes = material.clippingPlanes;\n\t\t\t\t\t\t\toverrideMaterial.needsUpdate = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( overrideMaterial.clipIntersection !== material.clipIntersection ) {\n\n\t\t\t\t\t\t\toverrideMaterial.clipIntersection = material.clipIntersection;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( Array.isArray( overrideMaterial.clippingPlanes ) ) {\n\n\t\t\t\t\t\toverrideMaterial.clippingPlanes = null;\n\t\t\t\t\t\toverrideMaterial.needsUpdate = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterial = overrideMaterial;\n\n\t\t}\n\n\t\t//\n\n\t\tif ( material.transparent === true && material.side === DoubleSide && material.forceSinglePass === false ) {\n\n\t\t\tmaterial.side = BackSide;\n\t\t\tthis._handleObjectFunction( object, material, scene, camera, lightsNode, group, 'backSide' ); // create backSide pass id\n\n\t\t\tmaterial.side = FrontSide;\n\t\t\tthis._handleObjectFunction( object, material, scene, camera, lightsNode, group, passId ); // use default pass id\n\n\t\t\tmaterial.side = DoubleSide;\n\n\t\t} else {\n\n\t\t\tthis._handleObjectFunction( object, material, scene, camera, lightsNode, group, passId );\n\n\t\t}\n\n\t\t//\n\n\t\tif ( overridePositionNode !== undefined ) {\n\n\t\t\tscene.overrideMaterial.positionNode = overridePositionNode;\n\n\t\t}\n\n\t\tif ( overrideDepthNode !== undefined ) {\n\n\t\t\tscene.overrideMaterial.depthNode = overrideDepthNode;\n\n\t\t}\n\n\t\tif ( overrideFragmentNode !== undefined ) {\n\n\t\t\tscene.overrideMaterial.fragmentNode = overrideFragmentNode;\n\n\t\t}\n\n\t\t//\n\n\t\tobject.onAfterRender( this, scene, camera, geometry, material, group );\n\n\t}\n\n\t_renderObjectDirect( object, material, scene, camera, lightsNode, group, passId ) {\n\n\t\tconst renderObject = this._objects.get( object, material, scene, camera, lightsNode, this._currentRenderContext, passId );\n\t\trenderObject.drawRange = object.geometry.drawRange;\n\t\trenderObject.group = group;\n\n\t\t//\n\n\t\tconst needsRefresh = this._nodes.needsRefresh( renderObject );\n\n\t\tif ( needsRefresh ) {\n\n\t\t\tthis._nodes.updateBefore( renderObject );\n\n\t\t\tthis._geometries.updateForRender( renderObject );\n\n\t\t\tthis._nodes.updateForRender( renderObject );\n\t\t\tthis._bindings.updateForRender( renderObject );\n\n\t\t}\n\n\t\tthis._pipelines.updateForRender( renderObject );\n\n\t\t//\n\n\t\tif ( this._currentRenderBundle !== null ) {\n\n\t\t\tconst renderBundleData = this.backend.get( this._currentRenderBundle );\n\n\t\t\trenderBundleData.renderObjects.push( renderObject );\n\n\t\t\trenderObject.bundle = this._currentRenderBundle.scene;\n\n\t\t}\n\n\t\tthis.backend.draw( renderObject, this.info );\n\n\t\tif ( needsRefresh ) this._nodes.updateAfter( renderObject );\n\n\t}\n\n\t_createObjectPipeline( object, material, scene, camera, lightsNode, passId ) {\n\n\t\tconst renderObject = this._objects.get( object, material, scene, camera, lightsNode, this._currentRenderContext, passId );\n\n\t\t//\n\n\t\tthis._nodes.updateBefore( renderObject );\n\n\t\tthis._geometries.updateForRender( renderObject );\n\n\t\tthis._nodes.updateForRender( renderObject );\n\t\tthis._bindings.updateForRender( renderObject );\n\n\t\tthis._pipelines.getForRender( renderObject, this._compilationPromises );\n\n\t\tthis._nodes.updateAfter( renderObject );\n\n\t}\n\n\tget compile() {\n\n\t\treturn this.compileAsync;\n\n\t}\n\n}\n\nclass Binding {\n\n\tconstructor( name = '' ) {\n\n\t\tthis.name = name;\n\n\t\tthis.visibility = 0;\n\n\t}\n\n\tsetVisibility( visibility ) {\n\n\t\tthis.visibility |= visibility;\n\n\t}\n\n\tclone() {\n\n\t\treturn Object.assign( new this.constructor(), this );\n\n\t}\n\n}\n\nfunction getFloatLength( floatLength ) {\n\n\t// ensure chunk size alignment (STD140 layout)\n\n\treturn floatLength + ( ( GPU_CHUNK_BYTES - ( floatLength % GPU_CHUNK_BYTES ) ) % GPU_CHUNK_BYTES );\n\n}\n\nclass Buffer extends Binding {\n\n\tconstructor( name, buffer = null ) {\n\n\t\tsuper( name );\n\n\t\tthis.isBuffer = true;\n\n\t\tthis.bytesPerElement = Float32Array.BYTES_PER_ELEMENT;\n\n\t\tthis._buffer = buffer;\n\n\t}\n\n\tget byteLength() {\n\n\t\treturn getFloatLength( this._buffer.byteLength );\n\n\t}\n\n\tget buffer() {\n\n\t\treturn this._buffer;\n\n\t}\n\n\tupdate() {\n\n\t\treturn true;\n\n\t}\n\n}\n\nclass UniformBuffer extends Buffer {\n\n\tconstructor( name, buffer = null ) {\n\n\t\tsuper( name, buffer );\n\n\t\tthis.isUniformBuffer = true;\n\n\t}\n\n}\n\nlet _id$4 = 0;\n\nclass NodeUniformBuffer extends UniformBuffer {\n\n\tconstructor( nodeUniform, groupNode ) {\n\n\t\tsuper( 'UniformBuffer_' + _id$4 ++, nodeUniform ? nodeUniform.value : null );\n\n\t\tthis.nodeUniform = nodeUniform;\n\t\tthis.groupNode = groupNode;\n\n\t}\n\n\tget buffer() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass UniformsGroup extends UniformBuffer {\n\n\tconstructor( name ) {\n\n\t\tsuper( name );\n\n\t\tthis.isUniformsGroup = true;\n\n\t\tthis._values = null;\n\n\t\t// the order of uniforms in this array must match the order of uniforms in the shader\n\n\t\tthis.uniforms = [];\n\n\t}\n\n\taddUniform( uniform ) {\n\n\t\tthis.uniforms.push( uniform );\n\n\t\treturn this;\n\n\t}\n\n\tremoveUniform( uniform ) {\n\n\t\tconst index = this.uniforms.indexOf( uniform );\n\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.uniforms.splice( index, 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tget values() {\n\n\t\tif ( this._values === null ) {\n\n\t\t\tthis._values = Array.from( this.buffer );\n\n\t\t}\n\n\t\treturn this._values;\n\n\t}\n\n\tget buffer() {\n\n\t\tlet buffer = this._buffer;\n\n\t\tif ( buffer === null ) {\n\n\t\t\tconst byteLength = this.byteLength;\n\n\t\t\tbuffer = new Float32Array( new ArrayBuffer( byteLength ) );\n\n\t\t\tthis._buffer = buffer;\n\n\t\t}\n\n\t\treturn buffer;\n\n\t}\n\n\tget byteLength() {\n\n\t\tlet offset = 0; // global buffer offset in bytes\n\n\t\tfor ( let i = 0, l = this.uniforms.length; i < l; i ++ ) {\n\n\t\t\tconst uniform = this.uniforms[ i ];\n\n\t\t\tconst { boundary, itemSize } = uniform;\n\n\t\t\t// offset within a single chunk in bytes\n\n\t\t\tconst chunkOffset = offset % GPU_CHUNK_BYTES;\n\t\t\tconst remainingSizeInChunk = GPU_CHUNK_BYTES - chunkOffset;\n\n\t\t\t// conformance tests\n\n\t\t\tif ( chunkOffset !== 0 && ( remainingSizeInChunk - boundary ) < 0 ) {\n\n\t\t\t\t// check for chunk overflow\n\n\t\t\t\toffset += ( GPU_CHUNK_BYTES - chunkOffset );\n\n\t\t\t} else if ( chunkOffset % boundary !== 0 ) {\n\n\t\t\t\t// check for correct alignment\n\n\t\t\t\toffset += ( chunkOffset % boundary );\n\n\t\t\t}\n\n\t\t\tuniform.offset = ( offset / this.bytesPerElement );\n\n\t\t\toffset += ( itemSize * this.bytesPerElement );\n\n\t\t}\n\n\t\treturn Math.ceil( offset / GPU_CHUNK_BYTES ) * GPU_CHUNK_BYTES;\n\n\t}\n\n\tupdate() {\n\n\t\tlet updated = false;\n\n\t\tfor ( const uniform of this.uniforms ) {\n\n\t\t\tif ( this.updateByType( uniform ) === true ) {\n\n\t\t\t\tupdated = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateByType( uniform ) {\n\n\t\tif ( uniform.isNumberUniform ) return this.updateNumber( uniform );\n\t\tif ( uniform.isVector2Uniform ) return this.updateVector2( uniform );\n\t\tif ( uniform.isVector3Uniform ) return this.updateVector3( uniform );\n\t\tif ( uniform.isVector4Uniform ) return this.updateVector4( uniform );\n\t\tif ( uniform.isColorUniform ) return this.updateColor( uniform );\n\t\tif ( uniform.isMatrix3Uniform ) return this.updateMatrix3( uniform );\n\t\tif ( uniform.isMatrix4Uniform ) return this.updateMatrix4( uniform );\n\n\t\tconsole.error( 'THREE.WebGPUUniformsGroup: Unsupported uniform type.', uniform );\n\n\t}\n\n\tupdateNumber( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset ] !== v ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset ] = a[ offset ] = v;\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateVector2( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== v.x || a[ offset + 1 ] !== v.y ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = v.x;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = v.y;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateVector3( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== v.x || a[ offset + 1 ] !== v.y || a[ offset + 2 ] !== v.z ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = v.x;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = v.y;\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = v.z;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateVector4( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst v = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== v.x || a[ offset + 1 ] !== v.y || a[ offset + 2 ] !== v.z || a[ offset + 4 ] !== v.w ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = v.x;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = v.y;\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = v.z;\n\t\t\tb[ offset + 3 ] = a[ offset + 3 ] = v.w;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateColor( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst c = uniform.getValue();\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== c.r || a[ offset + 1 ] !== c.g || a[ offset + 2 ] !== c.b ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = c.r;\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = c.g;\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = c.b;\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateMatrix3( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst e = uniform.getValue().elements;\n\t\tconst offset = uniform.offset;\n\n\t\tif ( a[ offset + 0 ] !== e[ 0 ] || a[ offset + 1 ] !== e[ 1 ] || a[ offset + 2 ] !== e[ 2 ] ||\n\t\t\ta[ offset + 4 ] !== e[ 3 ] || a[ offset + 5 ] !== e[ 4 ] || a[ offset + 6 ] !== e[ 5 ] ||\n\t\t\ta[ offset + 8 ] !== e[ 6 ] || a[ offset + 9 ] !== e[ 7 ] || a[ offset + 10 ] !== e[ 8 ] ) {\n\n\t\t\tconst b = this.buffer;\n\n\t\t\tb[ offset + 0 ] = a[ offset + 0 ] = e[ 0 ];\n\t\t\tb[ offset + 1 ] = a[ offset + 1 ] = e[ 1 ];\n\t\t\tb[ offset + 2 ] = a[ offset + 2 ] = e[ 2 ];\n\t\t\tb[ offset + 4 ] = a[ offset + 4 ] = e[ 3 ];\n\t\t\tb[ offset + 5 ] = a[ offset + 5 ] = e[ 4 ];\n\t\t\tb[ offset + 6 ] = a[ offset + 6 ] = e[ 5 ];\n\t\t\tb[ offset + 8 ] = a[ offset + 8 ] = e[ 6 ];\n\t\t\tb[ offset + 9 ] = a[ offset + 9 ] = e[ 7 ];\n\t\t\tb[ offset + 10 ] = a[ offset + 10 ] = e[ 8 ];\n\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n\tupdateMatrix4( uniform ) {\n\n\t\tlet updated = false;\n\n\t\tconst a = this.values;\n\t\tconst e = uniform.getValue().elements;\n\t\tconst offset = uniform.offset;\n\n\t\tif ( arraysEqual( a, e, offset ) === false ) {\n\n\t\t\tconst b = this.buffer;\n\t\t\tb.set( e, offset );\n\t\t\tsetArray( a, e, offset );\n\t\t\tupdated = true;\n\n\t\t}\n\n\t\treturn updated;\n\n\t}\n\n}\n\nfunction setArray( a, b, offset ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\ta[ offset + i ] = b[ i ];\n\n\t}\n\n}\n\nfunction arraysEqual( a, b, offset ) {\n\n\tfor ( let i = 0, l = b.length; i < l; i ++ ) {\n\n\t\tif ( a[ offset + i ] !== b[ i ] ) return false;\n\n\t}\n\n\treturn true;\n\n}\n\nlet _id$3 = 0;\n\nclass NodeUniformsGroup extends UniformsGroup {\n\n\tconstructor( name, groupNode ) {\n\n\t\tsuper( name );\n\n\t\tthis.id = _id$3 ++;\n\t\tthis.groupNode = groupNode;\n\n\t\tthis.isNodeUniformsGroup = true;\n\n\t}\n\n\tgetNodes() {\n\n\t\tconst nodes = [];\n\n\t\tfor ( const uniform of this.uniforms ) {\n\n\t\t\tconst node = uniform.nodeUniform.node;\n\n\t\t\tif ( ! node ) throw new Error( 'NodeUniformsGroup: Uniform has no node.' );\n\n\t\t\tnodes.push( node );\n\n\t\t}\n\n\t\treturn nodes;\n\n\t}\n\n}\n\nlet _id$2 = 0;\n\nclass SampledTexture extends Binding {\n\n\tconstructor( name, texture ) {\n\n\t\tsuper( name );\n\n\t\tthis.id = _id$2 ++;\n\n\t\tthis.texture = texture;\n\t\tthis.version = texture ? texture.version : 0;\n\t\tthis.store = false;\n\t\tthis.generation = null;\n\n\t\tthis.isSampledTexture = true;\n\n\t}\n\n\tneedsBindingsUpdate( generation ) {\n\n\t\tconst { texture } = this;\n\n\t\tif ( generation !== this.generation ) {\n\n\t\t\tthis.generation = generation;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn texture.isVideoTexture;\n\n\t}\n\n\tupdate() {\n\n\t\tconst { texture, version } = this;\n\n\t\tif ( version !== texture.version ) {\n\n\t\t\tthis.version = texture.version;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n}\n\nclass NodeSampledTexture extends SampledTexture {\n\n\tconstructor( name, textureNode, groupNode, access = null ) {\n\n\t\tsuper( name, textureNode ? textureNode.value : null );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.groupNode = groupNode;\n\n\t\tthis.access = access;\n\n\t}\n\n\tneedsBindingsUpdate( generation ) {\n\n\t\treturn this.textureNode.value !== this.texture || super.needsBindingsUpdate( generation );\n\n\t}\n\n\tupdate() {\n\n\t\tconst { textureNode } = this;\n\n\t\tif ( this.texture !== textureNode.value ) {\n\n\t\t\tthis.texture = textureNode.value;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn super.update();\n\n\t}\n\n}\n\nclass NodeSampledCubeTexture extends NodeSampledTexture {\n\n\tconstructor( name, textureNode, groupNode, access ) {\n\n\t\tsuper( name, textureNode, groupNode, access );\n\n\t\tthis.isSampledCubeTexture = true;\n\n\t}\n\n}\n\nclass NodeSampledTexture3D extends NodeSampledTexture {\n\n\tconstructor( name, textureNode, groupNode, access ) {\n\n\t\tsuper( name, textureNode, groupNode, access );\n\n\t\tthis.isSampledTexture3D = true;\n\n\t}\n\n}\n\nconst glslMethods = {\n\tatan2: 'atan',\n\ttextureDimensions: 'textureSize',\n\tequals: 'equal'\n};\n\nconst precisionLib = {\n\tlow: 'lowp',\n\tmedium: 'mediump',\n\thigh: 'highp'\n};\n\nconst supports$1 = {\n\tswizzleAssign: true,\n\tstorageBuffer: false\n};\n\nconst defaultPrecisions = `\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\n`;\n\nclass GLSLNodeBuilder extends NodeBuilder {\n\n\tconstructor( object, renderer ) {\n\n\t\tsuper( object, renderer, new GLSLNodeParser() );\n\n\t\tthis.uniformGroups = {};\n\t\tthis.transforms = [];\n\t\tthis.extensions = {};\n\n\t\tthis.useComparisonMethod = true;\n\n\t}\n\n\tneedsColorSpaceToLinearSRGB( texture ) {\n\n\t\treturn texture.isVideoTexture === true && texture.colorSpace !== NoColorSpace;\n\n\t}\n\n\tgetMethod( method ) {\n\n\t\treturn glslMethods[ method ] || method;\n\n\t}\n\n\tgetOutputStructName() {\n\n\t\treturn '';\n\n\t}\n\n\tbuildFunctionCode( shaderNode ) {\n\n\t\tconst layout = shaderNode.layout;\n\t\tconst flowData = this.flowShaderNode( shaderNode );\n\n\t\tconst parameters = [];\n\n\t\tfor ( const input of layout.inputs ) {\n\n\t\t\tparameters.push( this.getType( input.type ) + ' ' + input.name );\n\n\t\t}\n\n\t\t//\n\n\t\tconst code = `${ this.getType( layout.type ) } ${ layout.name }( ${ parameters.join( ', ' ) } ) {\n\n\t${ flowData.vars }\n\n${ flowData.code }\n\treturn ${ flowData.result };\n\n}`;\n\n\t\t//\n\n\t\treturn code;\n\n\t}\n\n\tsetupPBO( storageBufferNode ) {\n\n\t\tconst attribute = storageBufferNode.value;\n\n\t\tif ( attribute.pbo === undefined ) {\n\n\t\t\tconst originalArray = attribute.array;\n\t\t\tconst numElements = attribute.count * attribute.itemSize;\n\n\t\t\tconst { itemSize } = attribute;\n\n\t\t\tconst isInteger = attribute.array.constructor.name.toLowerCase().includes( 'int' );\n\n\t\t\tlet format = isInteger ? RedIntegerFormat : RedFormat;\n\n\n\t\t\tif ( itemSize === 2 ) {\n\n\t\t\t\tformat = isInteger ? RGIntegerFormat : RGFormat;\n\n\t\t\t} else if ( itemSize === 3 ) {\n\n\t\t\t\tformat = isInteger ? RGBIntegerFormat : RGBFormat;\n\n\t\t\t} else if ( itemSize === 4 ) {\n\n\t\t\t\tformat = isInteger ? RGBAIntegerFormat : RGBAFormat;\n\n\t\t\t}\n\n\t\t\tconst typeMap = {\n\t\t\t\tFloat32Array: FloatType,\n\t\t\t\tUint8Array: UnsignedByteType,\n\t\t\t\tUint16Array: UnsignedShortType,\n\t\t\t\tUint32Array: UnsignedIntType,\n\t\t\t\tInt8Array: ByteType,\n\t\t\t\tInt16Array: ShortType,\n\t\t\t\tInt32Array: IntType,\n\t\t\t\tUint8ClampedArray: UnsignedByteType,\n\t\t\t};\n\n\t\t\tconst width = Math.pow( 2, Math.ceil( Math.log2( Math.sqrt( numElements / itemSize ) ) ) );\n\t\t\tlet height = Math.ceil( ( numElements / itemSize ) / width );\n\t\t\tif ( width * height * itemSize < numElements ) height ++; // Ensure enough space\n\n\t\t\tconst newSize = width * height * itemSize;\n\n\t\t\tconst newArray = new originalArray.constructor( newSize );\n\n\t\t\tnewArray.set( originalArray, 0 );\n\n\t\t\tattribute.array = newArray;\n\n\t\t\tconst pboTexture = new DataTexture( attribute.array, width, height, format, typeMap[ attribute.array.constructor.name ] || FloatType );\n\t\t\tpboTexture.needsUpdate = true;\n\t\t\tpboTexture.isPBOTexture = true;\n\n\t\t\tconst pbo = new TextureNode( pboTexture, null, null );\n\t\t\tpbo.setPrecision( 'high' );\n\n\t\t\tattribute.pboNode = pbo;\n\t\t\tattribute.pbo = pbo.value;\n\n\t\t\tthis.getUniformFromNode( attribute.pboNode, 'texture', this.shaderStage, this.context.label );\n\n\t\t}\n\n\t}\n\n\tgetPropertyName( node, shaderStage = this.shaderStage ) {\n\n\t\tif ( node.isNodeUniform && node.node.isTextureNode !== true && node.node.isBufferNode !== true ) {\n\n\t\t\treturn shaderStage.charAt( 0 ) + '_' + node.name;\n\n\t\t}\n\n\t\treturn super.getPropertyName( node, shaderStage );\n\n\t}\n\n\tgeneratePBO( storageArrayElementNode ) {\n\n\t\tconst { node, indexNode } = storageArrayElementNode;\n\t\tconst attribute = node.value;\n\n\t\tif ( this.renderer.backend.has( attribute ) ) {\n\n\t\t\tconst attributeData = this.renderer.backend.get( attribute );\n\t\t\tattributeData.pbo = attribute.pbo;\n\n\t\t}\n\n\n\t\tconst nodeUniform = this.getUniformFromNode( attribute.pboNode, 'texture', this.shaderStage, this.context.label );\n\t\tconst textureName = this.getPropertyName( nodeUniform );\n\n\t\tthis.increaseUsage( indexNode ); // force cache generate to be used as index in x,y\n\t\tconst indexSnippet = indexNode.build( this, 'uint' );\n\n\t\tconst elementNodeData = this.getDataFromNode( storageArrayElementNode );\n\n\t\tlet propertyName = elementNodeData.propertyName;\n\n\t\tif ( propertyName === undefined ) {\n\n\t\t\t// property element\n\n\t\t\tconst nodeVar = this.getVarFromNode( storageArrayElementNode );\n\n\t\t\tpropertyName = this.getPropertyName( nodeVar );\n\n\t\t\t// property size\n\n\t\t\tconst bufferNodeData = this.getDataFromNode( node );\n\n\t\t\tlet propertySizeName = bufferNodeData.propertySizeName;\n\n\t\t\tif ( propertySizeName === undefined ) {\n\n\t\t\t\tpropertySizeName = propertyName + 'Size';\n\n\t\t\t\tthis.getVarFromNode( node, propertySizeName, 'uint' );\n\n\t\t\t\tthis.addLineFlowCode( `${ propertySizeName } = uint( textureSize( ${ textureName }, 0 ).x )`, storageArrayElementNode );\n\n\t\t\t\tbufferNodeData.propertySizeName = propertySizeName;\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tconst { itemSize } = attribute;\n\n\t\t\tconst channel = '.' + vectorComponents.join( '' ).slice( 0, itemSize );\n\t\t\tconst uvSnippet = `ivec2(${indexSnippet} % ${ propertySizeName }, ${indexSnippet} / ${ propertySizeName })`;\n\n\t\t\tconst snippet = this.generateTextureLoad( null, textureName, uvSnippet, null, '0' );\n\n\t\t\t//\n\n\n\t\t\tlet prefix = 'vec4';\n\n\t\t\tif ( attribute.pbo.type === UnsignedIntType ) {\n\n\t\t\t\tprefix = 'uvec4';\n\n\t\t\t} else if ( attribute.pbo.type === IntType ) {\n\n\t\t\t\tprefix = 'ivec4';\n\n\t\t\t}\n\n\t\t\tthis.addLineFlowCode( `${ propertyName } = ${prefix}(${ snippet })${channel}`, storageArrayElementNode );\n\n\t\t\telementNodeData.propertyName = propertyName;\n\n\t\t}\n\n\t\treturn propertyName;\n\n\t}\n\n\tgenerateTextureLoad( texture, textureProperty, uvIndexSnippet, depthSnippet, levelSnippet = '0' ) {\n\n\t\tif ( depthSnippet ) {\n\n\t\t\treturn `texelFetch( ${ textureProperty }, ivec3( ${ uvIndexSnippet }, ${ depthSnippet } ), ${ levelSnippet } )`;\n\n\t\t} else {\n\n\t\t\treturn `texelFetch( ${ textureProperty }, ${ uvIndexSnippet }, ${ levelSnippet } )`;\n\n\t\t}\n\n\t}\n\n\tgenerateTexture( texture, textureProperty, uvSnippet, depthSnippet ) {\n\n\t\tif ( texture.isDepthTexture ) {\n\n\t\t\treturn `texture( ${ textureProperty }, ${ uvSnippet } ).x`;\n\n\t\t} else {\n\n\t\t\tif ( depthSnippet ) uvSnippet = `vec3( ${ uvSnippet }, ${ depthSnippet } )`;\n\n\t\t\treturn `texture( ${ textureProperty }, ${ uvSnippet } )`;\n\n\t\t}\n\n\t}\n\n\tgenerateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet ) {\n\n\t\treturn `textureLod( ${ textureProperty }, ${ uvSnippet }, ${ levelSnippet } )`;\n\n\t}\n\n\tgenerateTextureBias( texture, textureProperty, uvSnippet, biasSnippet ) {\n\n\t\treturn `texture( ${ textureProperty }, ${ uvSnippet }, ${ biasSnippet } )`;\n\n\t}\n\n\tgenerateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet ) {\n\n\t\treturn `textureGrad( ${ textureProperty }, ${ uvSnippet }, ${ gradSnippet[ 0 ] }, ${ gradSnippet[ 1 ] } )`;\n\n\t}\n\n\tgenerateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `texture( ${ textureProperty }, vec3( ${ uvSnippet }, ${ compareSnippet } ) )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgetVars( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tconst vars = this.vars[ shaderStage ];\n\n\t\tif ( vars !== undefined ) {\n\n\t\t\tfor ( const variable of vars ) {\n\n\t\t\t\tsnippets.push( `${ this.getVar( variable.type, variable.name ) };` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( '\\n\\t' );\n\n\t}\n\n\tgetUniforms( shaderStage ) {\n\n\t\tconst uniforms = this.uniforms[ shaderStage ];\n\n\t\tconst bindingSnippets = [];\n\t\tconst uniformGroups = {};\n\n\t\tfor ( const uniform of uniforms ) {\n\n\t\t\tlet snippet = null;\n\t\t\tlet group = false;\n\n\t\t\tif ( uniform.type === 'texture' ) {\n\n\t\t\t\tconst texture = uniform.node.value;\n\n\t\t\t\tlet typePrefix = '';\n\n\t\t\t\tif ( texture.isDataTexture === true ) {\n\n\n\t\t\t\t\tif ( texture.type === UnsignedIntType ) {\n\n\t\t\t\t\t\ttypePrefix = 'u';\n\n\t\t\t\t\t} else if ( texture.type === IntType ) {\n\n\t\t\t\t\t\ttypePrefix = 'i';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.compareFunction ) {\n\n\t\t\t\t\tsnippet = `sampler2DShadow ${ uniform.name };`;\n\n\t\t\t\t} else if ( texture.isDataArrayTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\t\t\t\tsnippet = `${typePrefix}sampler2DArray ${ uniform.name };`;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tsnippet = `${typePrefix}sampler2D ${ uniform.name };`;\n\n\t\t\t\t}\n\n\t\t\t} else if ( uniform.type === 'cubeTexture' ) {\n\n\t\t\t\tsnippet = `samplerCube ${ uniform.name };`;\n\n\t\t\t} else if ( uniform.type === 'texture3D' ) {\n\n\t\t\t\tsnippet = `sampler3D ${ uniform.name };`;\n\n\t\t\t} else if ( uniform.type === 'buffer' ) {\n\n\t\t\t\tconst bufferNode = uniform.node;\n\t\t\t\tconst bufferType = this.getType( bufferNode.bufferType );\n\t\t\t\tconst bufferCount = bufferNode.bufferCount;\n\n\t\t\t\tconst bufferCountSnippet = bufferCount > 0 ? bufferCount : '';\n\t\t\t\tsnippet = `${bufferNode.name} {\\n\\t${ bufferType } ${ uniform.name }[${ bufferCountSnippet }];\\n};\\n`;\n\n\t\t\t} else {\n\n\t\t\t\tconst vectorType = this.getVectorType( uniform.type );\n\n\t\t\t\tsnippet = `${ vectorType } ${ this.getPropertyName( uniform, shaderStage ) };`;\n\n\t\t\t\tgroup = true;\n\n\t\t\t}\n\n\t\t\tconst precision = uniform.node.precision;\n\n\t\t\tif ( precision !== null ) {\n\n\t\t\t\tsnippet = precisionLib[ precision ] + ' ' + snippet;\n\n\t\t\t}\n\n\t\t\tif ( group ) {\n\n\t\t\t\tsnippet = '\\t' + snippet;\n\n\t\t\t\tconst groupName = uniform.groupNode.name;\n\t\t\t\tconst groupSnippets = uniformGroups[ groupName ] || ( uniformGroups[ groupName ] = [] );\n\n\t\t\t\tgroupSnippets.push( snippet );\n\n\t\t\t} else {\n\n\t\t\t\tsnippet = 'uniform ' + snippet;\n\n\t\t\t\tbindingSnippets.push( snippet );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet output = '';\n\n\t\tfor ( const name in uniformGroups ) {\n\n\t\t\tconst groupSnippets = uniformGroups[ name ];\n\n\t\t\toutput += this._getGLSLUniformStruct( shaderStage + '_' + name, groupSnippets.join( '\\n' ) ) + '\\n';\n\n\t\t}\n\n\t\toutput += bindingSnippets.join( '\\n' );\n\n\t\treturn output;\n\n\t}\n\n\tgetTypeFromAttribute( attribute ) {\n\n\t\tlet nodeType = super.getTypeFromAttribute( attribute );\n\n\t\tif ( /^[iu]/.test( nodeType ) && attribute.gpuType !== IntType ) {\n\n\t\t\tlet dataAttribute = attribute;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute ) dataAttribute = attribute.data;\n\n\t\t\tconst array = dataAttribute.array;\n\n\t\t\tif ( ( array instanceof Uint32Array || array instanceof Int32Array ) === false ) {\n\n\t\t\t\tnodeType = nodeType.slice( 1 );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodeType;\n\n\t}\n\n\tgetAttributes( shaderStage ) {\n\n\t\tlet snippet = '';\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'compute' ) {\n\n\t\t\tconst attributes = this.getAttributesArray();\n\n\t\t\tlet location = 0;\n\n\t\t\tfor ( const attribute of attributes ) {\n\n\t\t\t\tsnippet += `layout( location = ${ location ++ } ) in ${ attribute.type } ${ attribute.name };\\n`;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgetStructMembers( struct ) {\n\n\t\tconst snippets = [];\n\t\tconst members = struct.getMemberTypes();\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst member = members[ i ];\n\t\t\tsnippets.push( `layout( location = ${i} ) out ${ member} m${i};` );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tgetStructs( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst structs = this.structs[ shaderStage ];\n\n\t\tif ( structs.length === 0 ) {\n\n\t\t\treturn 'layout( location = 0 ) out vec4 fragColor;\\n';\n\n\t\t}\n\n\t\tfor ( let index = 0, length = structs.length; index < length; index ++ ) {\n\n\t\t\tconst struct = structs[ index ];\n\n\t\t\tlet snippet = '\\n';\n\t\t\tsnippet += this.getStructMembers( struct );\n\t\t\tsnippet += '\\n';\n\n\t\t\tsnippets.push( snippet );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n\\n' );\n\n\t}\n\n\tgetVaryings( shaderStage ) {\n\n\t\tlet snippet = '';\n\n\t\tconst varyings = this.varyings;\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'compute' ) {\n\n\t\t\tfor ( const varying of varyings ) {\n\n\t\t\t\tif ( shaderStage === 'compute' ) varying.needsInterpolation = true;\n\t\t\t\tconst type = varying.type;\n\t\t\t\tconst flat = type.includes( 'int' ) || type.includes( 'uv' ) || type.includes( 'iv' ) ? 'flat ' : '';\n\n\t\t\t\tsnippet += `${flat}${varying.needsInterpolation ? 'out' : '/*out*/'} ${type} ${varying.name};\\n`;\n\n\t\t\t}\n\n\t\t} else if ( shaderStage === 'fragment' ) {\n\n\t\t\tfor ( const varying of varyings ) {\n\n\t\t\t\tif ( varying.needsInterpolation ) {\n\n\t\t\t\t\tconst type = varying.type;\n\t\t\t\t\tconst flat = type.includes( 'int' ) || type.includes( 'uv' ) || type.includes( 'iv' ) ? 'flat ' : '';\n\n\t\t\t\t\tsnippet += `${flat}in ${type} ${varying.name};\\n`;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgetVertexIndex() {\n\n\t\treturn 'uint( gl_VertexID )';\n\n\t}\n\n\tgetInstanceIndex() {\n\n\t\treturn 'uint( gl_InstanceID )';\n\n\t}\n\n\tgetInvocationLocalIndex() {\n\n\t\tconst workgroupSize = this.object.workgroupSize;\n\n\t\tconst size = workgroupSize.reduce( ( acc, curr ) => acc * curr, 1 );\n\n\t\treturn `uint( gl_InstanceID ) % ${size}u`;\n\n\t}\n\n\tgetDrawIndex() {\n\n\t\tconst extensions = this.renderer.backend.extensions;\n\n\t\tif ( extensions.has( 'WEBGL_multi_draw' ) ) {\n\n\t\t\treturn 'uint( gl_DrawID )';\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tgetFrontFacing() {\n\n\t\treturn 'gl_FrontFacing';\n\n\t}\n\n\tgetFragCoord() {\n\n\t\treturn 'gl_FragCoord.xy';\n\n\t}\n\n\tgetFragDepth() {\n\n\t\treturn 'gl_FragDepth';\n\n\t}\n\n\tenableExtension( name, behavior, shaderStage = this.shaderStage ) {\n\n\t\tconst map = this.extensions[ shaderStage ] || ( this.extensions[ shaderStage ] = new Map() );\n\n\t\tif ( map.has( name ) === false ) {\n\n\t\t\tmap.set( name, {\n\t\t\t\tname,\n\t\t\t\tbehavior\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tgetExtensions( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\tconst ext = this.renderer.backend.extensions;\n\t\t\tconst isBatchedMesh = this.object.isBatchedMesh;\n\n\t\t\tif ( isBatchedMesh && ext.has( 'WEBGL_multi_draw' ) ) {\n\n\t\t\t\tthis.enableExtension( 'GL_ANGLE_multi_draw', 'require', shaderStage );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensions = this.extensions[ shaderStage ];\n\n\t\tif ( extensions !== undefined ) {\n\n\t\t\tfor ( const { name, behavior } of extensions.values() ) {\n\n\t\t\t\tsnippets.push( `#extension ${name} : ${behavior}` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tisAvailable( name ) {\n\n\t\tlet result = supports$1[ name ];\n\n\t\tif ( result === undefined ) {\n\n\t\t\tif ( name === 'float32Filterable' ) {\n\n\t\t\t\tconst extensions = this.renderer.backend.extensions;\n\n\t\t\t\tif ( extensions.has( 'OES_texture_float_linear' ) ) {\n\n\t\t\t\t\textensions.get( 'OES_texture_float_linear' );\n\t\t\t\t\tresult = true;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tresult = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tsupports$1[ name ] = result;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tisFlipY() {\n\n\t\treturn true;\n\n\t}\n\n\tregisterTransform( varyingName, attributeNode ) {\n\n\t\tthis.transforms.push( { varyingName, attributeNode } );\n\n\t}\n\n\tgetTransforms( /* shaderStage  */ ) {\n\n\t\tconst transforms = this.transforms;\n\n\t\tlet snippet = '';\n\n\t\tfor ( let i = 0; i < transforms.length; i ++ ) {\n\n\t\t\tconst transform = transforms[ i ];\n\n\t\t\tconst attributeName = this.getPropertyName( transform.attributeNode );\n\n\t\t\tsnippet += `${ transform.varyingName } = ${ attributeName };\\n\\t`;\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\t_getGLSLUniformStruct( name, vars ) {\n\n\t\treturn `\nlayout( std140 ) uniform ${name} {\n${vars}\n};`;\n\n\t}\n\n\t_getGLSLVertexCode( shaderData ) {\n\n\t\treturn `#version 300 es\n\n${ this.getSignature() }\n\n// extensions \n${shaderData.extensions}\n\n// precision\n${ defaultPrecisions }\n\n// uniforms\n${shaderData.uniforms}\n\n// varyings\n${shaderData.varyings}\n\n// attributes\n${shaderData.attributes}\n\n// codes\n${shaderData.codes}\n\nvoid main() {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// transforms\n\t${shaderData.transforms}\n\n\t// flow\n\t${shaderData.flow}\n\n\tgl_PointSize = 1.0;\n\n}\n`;\n\n\t}\n\n\t_getGLSLFragmentCode( shaderData ) {\n\n\t\treturn `#version 300 es\n\n${ this.getSignature() }\n\n// precision\n${ defaultPrecisions }\n\n// uniforms\n${shaderData.uniforms}\n\n// varyings\n${shaderData.varyings}\n\n// codes\n${shaderData.codes}\n\n${shaderData.structs}\n\nvoid main() {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n}\n`;\n\n\t}\n\n\tbuildCode() {\n\n\t\tconst shadersData = this.material !== null ? { fragment: {}, vertex: {} } : { compute: {} };\n\n\t\tthis.sortBindingGroups();\n\n\t\tfor ( const shaderStage in shadersData ) {\n\n\t\t\tlet flow = '// code\\n\\n';\n\t\t\tflow += this.flowCode[ shaderStage ];\n\n\t\t\tconst flowNodes = this.flowNodes[ shaderStage ];\n\t\t\tconst mainNode = flowNodes[ flowNodes.length - 1 ];\n\n\t\t\tfor ( const node of flowNodes ) {\n\n\t\t\t\tconst flowSlotData = this.getFlowData( node/*, shaderStage*/ );\n\t\t\t\tconst slotName = node.name;\n\n\t\t\t\tif ( slotName ) {\n\n\t\t\t\t\tif ( flow.length > 0 ) flow += '\\n';\n\n\t\t\t\t\tflow += `\\t// flow -> ${ slotName }\\n\\t`;\n\n\t\t\t\t}\n\n\t\t\t\tflow += `${ flowSlotData.code }\\n\\t`;\n\n\t\t\t\tif ( node === mainNode && shaderStage !== 'compute' ) {\n\n\t\t\t\t\tflow += '// result\\n\\t';\n\n\t\t\t\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\t\t\t\tflow += 'gl_Position = ';\n\t\t\t\t\t\tflow += `${ flowSlotData.result };`;\n\n\t\t\t\t\t} else if ( shaderStage === 'fragment' ) {\n\n\t\t\t\t\t\tif ( ! node.outputNode.isOutputStructNode ) {\n\n\t\t\t\t\t\t\tflow += 'fragColor = ';\n\t\t\t\t\t\t\tflow += `${ flowSlotData.result };`;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst stageData = shadersData[ shaderStage ];\n\n\t\t\tstageData.extensions = this.getExtensions( shaderStage );\n\t\t\tstageData.uniforms = this.getUniforms( shaderStage );\n\t\t\tstageData.attributes = this.getAttributes( shaderStage );\n\t\t\tstageData.varyings = this.getVaryings( shaderStage );\n\t\t\tstageData.vars = this.getVars( shaderStage );\n\t\t\tstageData.structs = this.getStructs( shaderStage );\n\t\t\tstageData.codes = this.getCodes( shaderStage );\n\t\t\tstageData.transforms = this.getTransforms( shaderStage );\n\t\t\tstageData.flow = flow;\n\n\t\t}\n\n\t\tif ( this.material !== null ) {\n\n\t\t\tthis.vertexShader = this._getGLSLVertexCode( shadersData.vertex );\n\t\t\tthis.fragmentShader = this._getGLSLFragmentCode( shadersData.fragment );\n\n\t\t} else {\n\n\t\t\tthis.computeShader = this._getGLSLVertexCode( shadersData.compute );\n\n\t\t}\n\n\t}\n\n\tgetUniformFromNode( node, type, shaderStage, name = null ) {\n\n\t\tconst uniformNode = super.getUniformFromNode( node, type, shaderStage, name );\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage, this.globalCache );\n\n\t\tlet uniformGPU = nodeData.uniformGPU;\n\n\t\tif ( uniformGPU === undefined ) {\n\n\t\t\tconst group = node.groupNode;\n\t\t\tconst groupName = group.name;\n\n\t\t\tconst bindings = this.getBindGroupArray( groupName, shaderStage );\n\n\t\t\tif ( type === 'texture' ) {\n\n\t\t\t\tuniformGPU = new NodeSampledTexture( uniformNode.name, uniformNode.node, group );\n\t\t\t\tbindings.push( uniformGPU );\n\n\t\t\t} else if ( type === 'cubeTexture' ) {\n\n\t\t\t\tuniformGPU = new NodeSampledCubeTexture( uniformNode.name, uniformNode.node, group );\n\t\t\t\tbindings.push( uniformGPU );\n\n\t\t\t} else if ( type === 'texture3D' ) {\n\n\t\t\t\tuniformGPU = new NodeSampledTexture3D( uniformNode.name, uniformNode.node, group );\n\t\t\t\tbindings.push( uniformGPU );\n\n\t\t\t} else if ( type === 'buffer' ) {\n\n\t\t\t\tnode.name = `NodeBuffer_${ node.id }`;\n\t\t\t\tuniformNode.name = `buffer${ node.id }`;\n\n\t\t\t\tconst buffer = new NodeUniformBuffer( node, group );\n\t\t\t\tbuffer.name = node.name;\n\n\t\t\t\tbindings.push( buffer );\n\n\t\t\t\tuniformGPU = buffer;\n\n\t\t\t} else {\n\n\t\t\t\tconst uniformsStage = this.uniformGroups[ shaderStage ] || ( this.uniformGroups[ shaderStage ] = {} );\n\n\t\t\t\tlet uniformsGroup = uniformsStage[ groupName ];\n\n\t\t\t\tif ( uniformsGroup === undefined ) {\n\n\t\t\t\t\tuniformsGroup = new NodeUniformsGroup( shaderStage + '_' + groupName, group );\n\t\t\t\t\t//uniformsGroup.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\t\tuniformsStage[ groupName ] = uniformsGroup;\n\n\t\t\t\t\tbindings.push( uniformsGroup );\n\n\t\t\t\t}\n\n\t\t\t\tuniformGPU = this.getNodeUniform( uniformNode, type );\n\n\t\t\t\tuniformsGroup.addUniform( uniformGPU );\n\n\t\t\t}\n\n\t\t\tnodeData.uniformGPU = uniformGPU;\n\n\t\t}\n\n\t\treturn uniformNode;\n\n\t}\n\n}\n\nlet vector2 = null;\nlet vector4 = null;\nlet color4 = null;\n\nclass Backend {\n\n\tconstructor( parameters = {} ) {\n\n\t\tthis.parameters = Object.assign( {}, parameters );\n\t\tthis.data = new WeakMap();\n\t\tthis.renderer = null;\n\t\tthis.domElement = null;\n\n\t}\n\n\tasync init( renderer ) {\n\n\t\tthis.renderer = renderer;\n\n\t}\n\n\t// render context\n\n\tbegin( /*renderContext*/ ) { }\n\n\tfinish( /*renderContext*/ ) { }\n\n\t// render object\n\n\tdraw( /*renderObject, info*/ ) { }\n\n\t// program\n\n\tcreateProgram( /*program*/ ) { }\n\n\tdestroyProgram( /*program*/ ) { }\n\n\t// bindings\n\n\tcreateBindings( /*bingGroup, bindings*/ ) { }\n\n\tupdateBindings( /*bingGroup, bindings*/ ) { }\n\n\t// pipeline\n\n\tcreateRenderPipeline( /*renderObject*/ ) { }\n\n\tcreateComputePipeline( /*computeNode, pipeline*/ ) { }\n\n\tdestroyPipeline( /*pipeline*/ ) { }\n\n\t// cache key\n\n\tneedsRenderUpdate( /*renderObject*/ ) { } // return Boolean ( fast test )\n\n\tgetRenderCacheKey( /*renderObject*/ ) { } // return String\n\n\t// node builder\n\n\tcreateNodeBuilder( /*renderObject*/ ) { } // return NodeBuilder (ADD IT)\n\n\t// textures\n\n\tcreateSampler( /*texture*/ ) { }\n\n\tcreateDefaultTexture( /*texture*/ ) { }\n\n\tcreateTexture( /*texture*/ ) { }\n\n\tcopyTextureToBuffer( /*texture, x, y, width, height*/ ) {}\n\n\t// attributes\n\n\tcreateAttribute( /*attribute*/ ) { }\n\n\tcreateIndexAttribute( /*attribute*/ ) { }\n\n\tupdateAttribute( /*attribute*/ ) { }\n\n\tdestroyAttribute( /*attribute*/ ) { }\n\n\t// canvas\n\n\tgetContext() { }\n\n\tupdateSize() { }\n\n\t// utils\n\n\tresolveTimestampAsync( /*renderContext, type*/ ) { }\n\n\thasFeatureAsync( /*name*/ ) { } // return Boolean\n\n\thasFeature( /*name*/ ) { } // return Boolean\n\n\tgetInstanceCount( renderObject ) {\n\n\t\tconst { object, geometry } = renderObject;\n\n\t\treturn geometry.isInstancedBufferGeometry ? geometry.instanceCount : ( object.count > 1 ? object.count : 1 );\n\n\t}\n\n\tgetDrawingBufferSize() {\n\n\t\tvector2 = vector2 || new Vector2();\n\n\t\treturn this.renderer.getDrawingBufferSize( vector2 );\n\n\t}\n\n\tgetScissor() {\n\n\t\tvector4 = vector4 || new Vector4();\n\n\t\treturn this.renderer.getScissor( vector4 );\n\n\t}\n\n\tsetScissorTest( /*boolean*/ ) { }\n\n\tgetClearColor() {\n\n\t\tconst renderer = this.renderer;\n\n\t\tcolor4 = color4 || new Color4();\n\n\t\trenderer.getClearColor( color4 );\n\n\t\tcolor4.getRGB( color4, this.renderer.currentColorSpace );\n\n\t\treturn color4;\n\n\t}\n\n\tgetDomElement() {\n\n\t\tlet domElement = this.domElement;\n\n\t\tif ( domElement === null ) {\n\n\t\t\tdomElement = ( this.parameters.canvas !== undefined ) ? this.parameters.canvas : createCanvasElement();\n\n\t\t\t// OffscreenCanvas does not have setAttribute, see #22811\n\t\t\tif ( 'setAttribute' in domElement ) domElement.setAttribute( 'data-engine', `three.js r${REVISION} webgpu` );\n\n\t\t\tthis.domElement = domElement;\n\n\t\t}\n\n\t\treturn domElement;\n\n\t}\n\n\t// resource properties\n\n\tset( object, value ) {\n\n\t\tthis.data.set( object, value );\n\n\t}\n\n\tget( object ) {\n\n\t\tlet map = this.data.get( object );\n\n\t\tif ( map === undefined ) {\n\n\t\t\tmap = {};\n\t\t\tthis.data.set( object, map );\n\n\t\t}\n\n\t\treturn map;\n\n\t}\n\n\thas( object ) {\n\n\t\treturn this.data.has( object );\n\n\t}\n\n\tdelete( object ) {\n\n\t\tthis.data.delete( object );\n\n\t}\n\n\tdispose() { }\n\n}\n\nlet _id$1 = 0;\n\nclass DualAttributeData {\n\n\tconstructor( attributeData, dualBuffer ) {\n\n\t\tthis.buffers = [ attributeData.bufferGPU, dualBuffer ];\n\t\tthis.type = attributeData.type;\n\t\tthis.bufferType = attributeData.bufferType;\n\t\tthis.pbo = attributeData.pbo;\n\t\tthis.byteLength = attributeData.byteLength;\n\t\tthis.bytesPerElement = attributeData.BYTES_PER_ELEMENT;\n\t\tthis.version = attributeData.version;\n\t\tthis.isInteger = attributeData.isInteger;\n\t\tthis.activeBufferIndex = 0;\n\t\tthis.baseId = attributeData.id;\n\n\t}\n\n\n\tget id() {\n\n\t\treturn `${ this.baseId }|${ this.activeBufferIndex }`;\n\n\t}\n\n\tget bufferGPU() {\n\n\t\treturn this.buffers[ this.activeBufferIndex ];\n\n\t}\n\n\tget transformBuffer() {\n\n\t\treturn this.buffers[ this.activeBufferIndex ^ 1 ];\n\n\t}\n\n\tswitchBuffers() {\n\n\t\tthis.activeBufferIndex ^= 1;\n\n\t}\n\n}\n\nclass WebGLAttributeUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tcreateAttribute( attribute, bufferType ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tconst array = attribute.array;\n\t\tconst usage = attribute.usage || gl.STATIC_DRAW;\n\n\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\tconst bufferData = backend.get( bufferAttribute );\n\n\t\tlet bufferGPU = bufferData.bufferGPU;\n\n\t\tif ( bufferGPU === undefined ) {\n\n\t\t\tbufferGPU = this._createBuffer( gl, bufferType, array, usage );\n\n\t\t\tbufferData.bufferGPU = bufferGPU;\n\t\t\tbufferData.bufferType = bufferType;\n\t\t\tbufferData.version = bufferAttribute.version;\n\n\t\t}\n\n\t\t//attribute.onUploadCallback();\n\n\t\tlet type;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\ttype = gl.FLOAT;\n\n\t\t} else if ( array instanceof Uint16Array ) {\n\n\t\t\tif ( attribute.isFloat16BufferAttribute ) {\n\n\t\t\t\ttype = gl.HALF_FLOAT;\n\n\t\t\t} else {\n\n\t\t\t\ttype = gl.UNSIGNED_SHORT;\n\n\t\t\t}\n\n\t\t} else if ( array instanceof Int16Array ) {\n\n\t\t\ttype = gl.SHORT;\n\n\t\t} else if ( array instanceof Uint32Array ) {\n\n\t\t\ttype = gl.UNSIGNED_INT;\n\n\t\t} else if ( array instanceof Int32Array ) {\n\n\t\t\ttype = gl.INT;\n\n\t\t} else if ( array instanceof Int8Array ) {\n\n\t\t\ttype = gl.BYTE;\n\n\t\t} else if ( array instanceof Uint8Array ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t} else if ( array instanceof Uint8ClampedArray ) {\n\n\t\t\ttype = gl.UNSIGNED_BYTE;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.WebGLBackend: Unsupported buffer data format: ' + array );\n\n\t\t}\n\n\t\tlet attributeData = {\n\t\t\tbufferGPU,\n\t\t\tbufferType,\n\t\t\ttype,\n\t\t\tbyteLength: array.byteLength,\n\t\t\tbytesPerElement: array.BYTES_PER_ELEMENT,\n\t\t\tversion: attribute.version,\n\t\t\tpbo: attribute.pbo,\n\t\t\tisInteger: type === gl.INT || type === gl.UNSIGNED_INT || attribute.gpuType === IntType,\n\t\t\tid: _id$1 ++\n\t\t};\n\n\t\tif ( attribute.isStorageBufferAttribute || attribute.isStorageInstancedBufferAttribute ) {\n\n\t\t\t// create buffer for tranform feedback use\n\t\t\tconst bufferGPUDual = this._createBuffer( gl, bufferType, array, usage );\n\t\t\tattributeData = new DualAttributeData( attributeData, bufferGPUDual );\n\n\t\t}\n\n\t\tbackend.set( attribute, attributeData );\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tconst array = attribute.array;\n\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\tconst bufferData = backend.get( bufferAttribute );\n\t\tconst bufferType = bufferData.bufferType;\n\t\tconst updateRanges = attribute.isInterleavedBufferAttribute ? attribute.data.updateRanges : attribute.updateRanges;\n\n\t\tgl.bindBuffer( bufferType, bufferData.bufferGPU );\n\n\t\tif ( updateRanges.length === 0 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tgl.bufferSubData( bufferType, 0, array );\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0, l = updateRanges.length; i < l; i ++ ) {\n\n\t\t\t\tconst range = updateRanges[ i ];\n\t\t\t\tgl.bufferSubData( bufferType, range.start * array.BYTES_PER_ELEMENT,\n\t\t\t\t\tarray, range.start, range.count );\n\n\t\t\t}\n\n\t\t\tbufferAttribute.clearUpdateRanges();\n\n\t\t}\n\n\t\tgl.bindBuffer( bufferType, null );\n\n\t\tbufferData.version = bufferAttribute.version;\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tbackend.delete( attribute.data );\n\n\t\t}\n\n\t\tconst attributeData = backend.get( attribute );\n\n\t\tgl.deleteBuffer( attributeData.bufferGPU );\n\n\t\tbackend.delete( attribute );\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { gl } = backend;\n\n\t\tconst bufferAttribute = attribute.isInterleavedBufferAttribute ? attribute.data : attribute;\n\t\tconst { bufferGPU } = backend.get( bufferAttribute );\n\n\t\tconst array = attribute.array;\n\t\tconst byteLength = array.byteLength;\n\n\t\tgl.bindBuffer( gl.COPY_READ_BUFFER, bufferGPU );\n\n\t\tconst writeBuffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( gl.COPY_WRITE_BUFFER, writeBuffer );\n\t\tgl.bufferData( gl.COPY_WRITE_BUFFER, byteLength, gl.STREAM_READ );\n\n\t\tgl.copyBufferSubData( gl.COPY_READ_BUFFER, gl.COPY_WRITE_BUFFER, 0, 0, byteLength );\n\n\t\tawait backend.utils._clientWaitAsync();\n\n\t\tconst dstBuffer = new attribute.array.constructor( array.length );\n\n\t\t// Ensure the buffer is bound before reading\n\t\tgl.bindBuffer( gl.COPY_WRITE_BUFFER, writeBuffer );\n\n\t\tgl.getBufferSubData( gl.COPY_WRITE_BUFFER, 0, dstBuffer );\n\n\t\tgl.deleteBuffer( writeBuffer );\n\n\t\tgl.bindBuffer( gl.COPY_READ_BUFFER, null );\n\t\tgl.bindBuffer( gl.COPY_WRITE_BUFFER, null );\n\n\t\treturn dstBuffer.buffer;\n\n\t}\n\n\t_createBuffer( gl, bufferType, array, usage ) {\n\n\t\tconst bufferGPU = gl.createBuffer();\n\n\t\tgl.bindBuffer( bufferType, bufferGPU );\n\t\tgl.bufferData( bufferType, array, usage );\n\t\tgl.bindBuffer( bufferType, null );\n\n\t\treturn bufferGPU;\n\n\t}\n\n}\n\nlet initialized$1 = false, equationToGL, factorToGL;\n\nclass WebGLState {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = this.backend.gl;\n\n\t\tthis.enabled = {};\n\t\tthis.currentFlipSided = null;\n\t\tthis.currentCullFace = null;\n\t\tthis.currentProgram = null;\n\t\tthis.currentBlendingEnabled = false;\n\t\tthis.currentBlending = null;\n\t\tthis.currentBlendSrc = null;\n\t\tthis.currentBlendDst = null;\n\t\tthis.currentBlendSrcAlpha = null;\n\t\tthis.currentBlendDstAlpha = null;\n\t\tthis.currentPremultipledAlpha = null;\n\t\tthis.currentPolygonOffsetFactor = null;\n\t\tthis.currentPolygonOffsetUnits = null;\n\t\tthis.currentColorMask = null;\n\t\tthis.currentDepthFunc = null;\n\t\tthis.currentDepthMask = null;\n\t\tthis.currentStencilFunc = null;\n\t\tthis.currentStencilRef = null;\n\t\tthis.currentStencilFuncMask = null;\n\t\tthis.currentStencilFail = null;\n\t\tthis.currentStencilZFail = null;\n\t\tthis.currentStencilZPass = null;\n\t\tthis.currentStencilMask = null;\n\t\tthis.currentLineWidth = null;\n\n\t\tthis.currentBoundFramebuffers = {};\n\t\tthis.currentDrawbuffers = new WeakMap();\n\n\t\tthis.maxTextures = this.gl.getParameter( this.gl.MAX_TEXTURE_IMAGE_UNITS );\n\t\tthis.currentTextureSlot = null;\n\t\tthis.currentBoundTextures = {};\n\t\tthis.currentBoundBufferBases = {};\n\n\t\tif ( initialized$1 === false ) {\n\n\t\t\tthis._init( this.gl );\n\n\t\t\tinitialized$1 = true;\n\n\t\t}\n\n\t}\n\n\t_init( gl ) {\n\n\t\t// Store only WebGL constants here.\n\n\t\tequationToGL = {\n\t\t\t[ AddEquation ]: gl.FUNC_ADD,\n\t\t\t[ SubtractEquation ]: gl.FUNC_SUBTRACT,\n\t\t\t[ ReverseSubtractEquation ]: gl.FUNC_REVERSE_SUBTRACT\n\t\t};\n\n\t\tfactorToGL = {\n\t\t\t[ ZeroFactor ]: gl.ZERO,\n\t\t\t[ OneFactor ]: gl.ONE,\n\t\t\t[ SrcColorFactor ]: gl.SRC_COLOR,\n\t\t\t[ SrcAlphaFactor ]: gl.SRC_ALPHA,\n\t\t\t[ SrcAlphaSaturateFactor ]: gl.SRC_ALPHA_SATURATE,\n\t\t\t[ DstColorFactor ]: gl.DST_COLOR,\n\t\t\t[ DstAlphaFactor ]: gl.DST_ALPHA,\n\t\t\t[ OneMinusSrcColorFactor ]: gl.ONE_MINUS_SRC_COLOR,\n\t\t\t[ OneMinusSrcAlphaFactor ]: gl.ONE_MINUS_SRC_ALPHA,\n\t\t\t[ OneMinusDstColorFactor ]: gl.ONE_MINUS_DST_COLOR,\n\t\t\t[ OneMinusDstAlphaFactor ]: gl.ONE_MINUS_DST_ALPHA\n\t\t};\n\n\t}\n\n\tenable( id ) {\n\n\t\tconst { enabled } = this;\n\n\t\tif ( enabled[ id ] !== true ) {\n\n\t\t\tthis.gl.enable( id );\n\t\t\tenabled[ id ] = true;\n\n\t\t}\n\n\t}\n\n\tdisable( id ) {\n\n\t\tconst { enabled } = this;\n\n\t\tif ( enabled[ id ] !== false ) {\n\n\t\t\tthis.gl.disable( id );\n\t\t\tenabled[ id ] = false;\n\n\t\t}\n\n\t}\n\n\tsetFlipSided( flipSided ) {\n\n\t\tif ( this.currentFlipSided !== flipSided ) {\n\n\t\t\tconst { gl } = this;\n\n\t\t\tif ( flipSided ) {\n\n\t\t\t\tgl.frontFace( gl.CW );\n\n\t\t\t} else {\n\n\t\t\t\tgl.frontFace( gl.CCW );\n\n\t\t\t}\n\n\t\t\tthis.currentFlipSided = flipSided;\n\n\t\t}\n\n\t}\n\n\tsetCullFace( cullFace ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( cullFace !== CullFaceNone ) {\n\n\t\t\tthis.enable( gl.CULL_FACE );\n\n\t\t\tif ( cullFace !== this.currentCullFace ) {\n\n\t\t\t\tif ( cullFace === CullFaceBack ) {\n\n\t\t\t\t\tgl.cullFace( gl.BACK );\n\n\t\t\t\t} else if ( cullFace === CullFaceFront ) {\n\n\t\t\t\t\tgl.cullFace( gl.FRONT );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.cullFace( gl.FRONT_AND_BACK );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.CULL_FACE );\n\n\t\t}\n\n\t\tthis.currentCullFace = cullFace;\n\n\t}\n\n\tsetLineWidth( width ) {\n\n\t\tconst { currentLineWidth, gl } = this;\n\n\t\tif ( width !== currentLineWidth ) {\n\n\t\t\tgl.lineWidth( width );\n\n\t\t\tthis.currentLineWidth = width;\n\n\t\t}\n\n\t}\n\n\n\tsetBlending( blending, blendEquation, blendSrc, blendDst, blendEquationAlpha, blendSrcAlpha, blendDstAlpha, premultipliedAlpha ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( blending === NoBlending ) {\n\n\t\t\tif ( this.currentBlendingEnabled === true ) {\n\n\t\t\t\tthis.disable( gl.BLEND );\n\t\t\t\tthis.currentBlendingEnabled = false;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( this.currentBlendingEnabled === false ) {\n\n\t\t\tthis.enable( gl.BLEND );\n\t\t\tthis.currentBlendingEnabled = true;\n\n\t\t}\n\n\t\tif ( blending !== CustomBlending ) {\n\n\t\t\tif ( blending !== this.currentBlending || premultipliedAlpha !== this.currentPremultipledAlpha ) {\n\n\t\t\t\tif ( this.currentBlendEquation !== AddEquation || this.currentBlendEquationAlpha !== AddEquation ) {\n\n\t\t\t\t\tgl.blendEquation( gl.FUNC_ADD );\n\n\t\t\t\t\tthis.currentBlendEquation = AddEquation;\n\t\t\t\t\tthis.currentBlendEquationAlpha = AddEquation;\n\n\t\t\t\t}\n\n\t\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ONE, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ZERO, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.SRC_ALPHA, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\t\tgl.blendFuncSeparate( gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ZERO, gl.ONE );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\t\tgl.blendFunc( gl.ZERO, gl.SRC_COLOR );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.WebGLState: Invalid blending: ', blending );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tthis.currentBlendSrc = null;\n\t\t\t\tthis.currentBlendDst = null;\n\t\t\t\tthis.currentBlendSrcAlpha = null;\n\t\t\t\tthis.currentBlendDstAlpha = null;\n\n\t\t\t\tthis.currentBlending = blending;\n\t\t\t\tthis.currentPremultipledAlpha = premultipliedAlpha;\n\n\t\t\t}\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// custom blending\n\n\t\tblendEquationAlpha = blendEquationAlpha || blendEquation;\n\t\tblendSrcAlpha = blendSrcAlpha || blendSrc;\n\t\tblendDstAlpha = blendDstAlpha || blendDst;\n\n\t\tif ( blendEquation !== this.currentBlendEquation || blendEquationAlpha !== this.currentBlendEquationAlpha ) {\n\n\t\t\tgl.blendEquationSeparate( equationToGL[ blendEquation ], equationToGL[ blendEquationAlpha ] );\n\n\t\t\tthis.currentBlendEquation = blendEquation;\n\t\t\tthis.currentBlendEquationAlpha = blendEquationAlpha;\n\n\t\t}\n\n\t\tif ( blendSrc !== this.currentBlendSrc || blendDst !== this.currentBlendDst || blendSrcAlpha !== this.currentBlendSrcAlpha || blendDstAlpha !== this.currentBlendDstAlpha ) {\n\n\t\t\tgl.blendFuncSeparate( factorToGL[ blendSrc ], factorToGL[ blendDst ], factorToGL[ blendSrcAlpha ], factorToGL[ blendDstAlpha ] );\n\n\t\t\tthis.currentBlendSrc = blendSrc;\n\t\t\tthis.currentBlendDst = blendDst;\n\t\t\tthis.currentBlendSrcAlpha = blendSrcAlpha;\n\t\t\tthis.currentBlendDstAlpha = blendDstAlpha;\n\n\t\t}\n\n\t\tthis.currentBlending = blending;\n\t\tthis.currentPremultipledAlpha = false;\n\n\t}\n\n\tsetColorMask( colorMask ) {\n\n\t\tif ( this.currentColorMask !== colorMask ) {\n\n\t\t\tthis.gl.colorMask( colorMask, colorMask, colorMask, colorMask );\n\t\t\tthis.currentColorMask = colorMask;\n\n\t\t}\n\n\t}\n\n\tsetDepthTest( depthTest ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( depthTest ) {\n\n\t\t\tthis.enable( gl.DEPTH_TEST );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.DEPTH_TEST );\n\n\t\t}\n\n\t}\n\n\tsetDepthMask( depthMask ) {\n\n\t\tif ( this.currentDepthMask !== depthMask ) {\n\n\t\t\tthis.gl.depthMask( depthMask );\n\t\t\tthis.currentDepthMask = depthMask;\n\n\t\t}\n\n\t}\n\n\tsetDepthFunc( depthFunc ) {\n\n\t\tif ( this.currentDepthFunc !== depthFunc ) {\n\n\t\t\tconst { gl } = this;\n\n\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\tcase NeverDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.NEVER );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AlwaysDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.ALWAYS );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.LESS );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessEqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.EQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterEqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.GEQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.GREATER );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NotEqualDepth:\n\n\t\t\t\t\tgl.depthFunc( gl.NOTEQUAL );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tgl.depthFunc( gl.LEQUAL );\n\n\t\t\t}\n\n\t\t\tthis.currentDepthFunc = depthFunc;\n\n\t\t}\n\n\t}\n\n\tsetStencilTest( stencilTest ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( stencilTest ) {\n\n\t\t\tthis.enable( gl.STENCIL_TEST );\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.STENCIL_TEST );\n\n\t\t}\n\n\t}\n\n\tsetStencilMask( stencilMask ) {\n\n\t\tif ( this.currentStencilMask !== stencilMask ) {\n\n\t\t\tthis.gl.stencilMask( stencilMask );\n\t\t\tthis.currentStencilMask = stencilMask;\n\n\t\t}\n\n\t}\n\n\tsetStencilFunc( stencilFunc, stencilRef, stencilMask ) {\n\n\t\tif ( this.currentStencilFunc !== stencilFunc ||\n\t\t\t this.currentStencilRef !== stencilRef ||\n\t\t\t this.currentStencilFuncMask !== stencilMask ) {\n\n\t\t\tthis.gl.stencilFunc( stencilFunc, stencilRef, stencilMask );\n\n\t\t\tthis.currentStencilFunc = stencilFunc;\n\t\t\tthis.currentStencilRef = stencilRef;\n\t\t\tthis.currentStencilFuncMask = stencilMask;\n\n\t\t}\n\n\t}\n\n\tsetStencilOp( stencilFail, stencilZFail, stencilZPass ) {\n\n\t\tif ( this.currentStencilFail !== stencilFail ||\n\t\t\t this.currentStencilZFail !== stencilZFail ||\n\t\t\t this.currentStencilZPass !== stencilZPass ) {\n\n\t\t\tthis.gl.stencilOp( stencilFail, stencilZFail, stencilZPass );\n\n\t\t\tthis.currentStencilFail = stencilFail;\n\t\t\tthis.currentStencilZFail = stencilZFail;\n\t\t\tthis.currentStencilZPass = stencilZPass;\n\n\t\t}\n\n\t}\n\n\tsetMaterial( material, frontFaceCW ) {\n\n\t\tconst { gl } = this;\n\n\t\tmaterial.side === DoubleSide\n\t\t\t? this.disable( gl.CULL_FACE )\n\t\t\t: this.enable( gl.CULL_FACE );\n\n\t\tlet flipSided = ( material.side === BackSide );\n\t\tif ( frontFaceCW ) flipSided = ! flipSided;\n\n\t\tthis.setFlipSided( flipSided );\n\n\t\t( material.blending === NormalBlending && material.transparent === false )\n\t\t\t? this.setBlending( NoBlending )\n\t\t\t: this.setBlending( material.blending, material.blendEquation, material.blendSrc, material.blendDst, material.blendEquationAlpha, material.blendSrcAlpha, material.blendDstAlpha, material.premultipliedAlpha );\n\n\t\tthis.setDepthFunc( material.depthFunc );\n\t\tthis.setDepthTest( material.depthTest );\n\t\tthis.setDepthMask( material.depthWrite );\n\t\tthis.setColorMask( material.colorWrite );\n\n\t\tconst stencilWrite = material.stencilWrite;\n\t\tthis.setStencilTest( stencilWrite );\n\t\tif ( stencilWrite ) {\n\n\t\t\tthis.setStencilMask( material.stencilWriteMask );\n\t\t\tthis.setStencilFunc( material.stencilFunc, material.stencilRef, material.stencilFuncMask );\n\t\t\tthis.setStencilOp( material.stencilFail, material.stencilZFail, material.stencilZPass );\n\n\t\t}\n\n\t\tthis.setPolygonOffset( material.polygonOffset, material.polygonOffsetFactor, material.polygonOffsetUnits );\n\n\t\tmaterial.alphaToCoverage === true && this.backend.renderer.samples > 1\n\t\t\t? this.enable( gl.SAMPLE_ALPHA_TO_COVERAGE )\n\t\t\t: this.disable( gl.SAMPLE_ALPHA_TO_COVERAGE );\n\n\t}\n\n\tsetPolygonOffset( polygonOffset, factor, units ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( polygonOffset ) {\n\n\t\t\tthis.enable( gl.POLYGON_OFFSET_FILL );\n\n\t\t\tif ( this.currentPolygonOffsetFactor !== factor || this.currentPolygonOffsetUnits !== units ) {\n\n\t\t\t\tgl.polygonOffset( factor, units );\n\n\t\t\t\tthis.currentPolygonOffsetFactor = factor;\n\t\t\t\tthis.currentPolygonOffsetUnits = units;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tthis.disable( gl.POLYGON_OFFSET_FILL );\n\n\t\t}\n\n\t}\n\n\tuseProgram( program ) {\n\n\t\tif ( this.currentProgram !== program ) {\n\n\t\t\tthis.gl.useProgram( program );\n\n\t\t\tthis.currentProgram = program;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t// framebuffer\n\n\n\tbindFramebuffer( target, framebuffer ) {\n\n\t\tconst { gl, currentBoundFramebuffers } = this;\n\n\t\tif ( currentBoundFramebuffers[ target ] !== framebuffer ) {\n\n\t\t\tgl.bindFramebuffer( target, framebuffer );\n\n\t\t\tcurrentBoundFramebuffers[ target ] = framebuffer;\n\n\t\t\t// gl.DRAW_FRAMEBUFFER is equivalent to gl.FRAMEBUFFER\n\n\t\t\tif ( target === gl.DRAW_FRAMEBUFFER ) {\n\n\t\t\t\tcurrentBoundFramebuffers[ gl.FRAMEBUFFER ] = framebuffer;\n\n\t\t\t}\n\n\t\t\tif ( target === gl.FRAMEBUFFER ) {\n\n\t\t\t\tcurrentBoundFramebuffers[ gl.DRAW_FRAMEBUFFER ] = framebuffer;\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tdrawBuffers( renderContext, framebuffer ) {\n\n\t\tconst { gl } = this;\n\n\t\tlet drawBuffers = [];\n\n\t\tlet needsUpdate = false;\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tdrawBuffers = this.currentDrawbuffers.get( framebuffer );\n\n\t\t\tif ( drawBuffers === undefined ) {\n\n\t\t\t\tdrawBuffers = [];\n\t\t\t\tthis.currentDrawbuffers.set( framebuffer, drawBuffers );\n\n\t\t\t}\n\n\n\t\t\tconst textures = renderContext.textures;\n\n\t\t\tif ( drawBuffers.length !== textures.length || drawBuffers[ 0 ] !== gl.COLOR_ATTACHMENT0 ) {\n\n\t\t\t\tfor ( let i = 0, il = textures.length; i < il; i ++ ) {\n\n\t\t\t\t\tdrawBuffers[ i ] = gl.COLOR_ATTACHMENT0 + i;\n\n\t\t\t\t}\n\n\t\t\t\tdrawBuffers.length = textures.length;\n\n\t\t\t\tneedsUpdate = true;\n\n\t\t\t}\n\n\n\t\t} else {\n\n\t\t\tif ( drawBuffers[ 0 ] !== gl.BACK ) {\n\n\t\t\t\tdrawBuffers[ 0 ] = gl.BACK;\n\n\t\t\t\tneedsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\tgl.drawBuffers( drawBuffers );\n\n\t\t}\n\n\t}\n\n\n\t// texture\n\n\tactiveTexture( webglSlot ) {\n\n\t\tconst { gl, currentTextureSlot, maxTextures } = this;\n\n\t\tif ( webglSlot === undefined ) webglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\tgl.activeTexture( webglSlot );\n\t\t\tthis.currentTextureSlot = webglSlot;\n\n\t\t}\n\n\t}\n\n\tbindTexture( webglType, webglTexture, webglSlot ) {\n\n\t\tconst { gl, currentTextureSlot, currentBoundTextures, maxTextures } = this;\n\n\t\tif ( webglSlot === undefined ) {\n\n\t\t\tif ( currentTextureSlot === null ) {\n\n\t\t\t\twebglSlot = gl.TEXTURE0 + maxTextures - 1;\n\n\t\t\t} else {\n\n\t\t\t\twebglSlot = currentTextureSlot;\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet boundTexture = currentBoundTextures[ webglSlot ];\n\n\t\tif ( boundTexture === undefined ) {\n\n\t\t\tboundTexture = { type: undefined, texture: undefined };\n\t\t\tcurrentBoundTextures[ webglSlot ] = boundTexture;\n\n\t\t}\n\n\t\tif ( boundTexture.type !== webglType || boundTexture.texture !== webglTexture ) {\n\n\t\t\tif ( currentTextureSlot !== webglSlot ) {\n\n\t\t\t\tgl.activeTexture( webglSlot );\n\t\t\t\tthis.currentTextureSlot = webglSlot;\n\n\t\t\t}\n\n\t\t\tgl.bindTexture( webglType, webglTexture );\n\n\t\t\tboundTexture.type = webglType;\n\t\t\tboundTexture.texture = webglTexture;\n\n\t\t}\n\n\t}\n\n\tbindBufferBase( target, index, buffer ) {\n\n\t\tconst { gl } = this;\n\n\t\tconst key = `${target}-${index}`;\n\n\t\tif ( this.currentBoundBufferBases[ key ] !== buffer ) {\n\n\t\t\tgl.bindBufferBase( target, index, buffer );\n\t\t\tthis.currentBoundBufferBases[ key ] = buffer;\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\n\tunbindTexture() {\n\n\t\tconst { gl, currentTextureSlot, currentBoundTextures } = this;\n\n\t\tconst boundTexture = currentBoundTextures[ currentTextureSlot ];\n\n\t\tif ( boundTexture !== undefined && boundTexture.type !== undefined ) {\n\n\t\t\tgl.bindTexture( boundTexture.type, null );\n\n\t\t\tboundTexture.type = undefined;\n\t\t\tboundTexture.texture = undefined;\n\n\t\t}\n\n\t}\n\n}\n\nclass WebGLUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = this.backend.gl;\n\t\tthis.extensions = backend.extensions;\n\n\t}\n\n\tconvert( p, colorSpace = NoColorSpace ) {\n\n\t\tconst { gl, extensions } = this;\n\n\t\tlet extension;\n\n\t\tif ( p === UnsignedByteType ) return gl.UNSIGNED_BYTE;\n\t\tif ( p === UnsignedShort4444Type ) return gl.UNSIGNED_SHORT_4_4_4_4;\n\t\tif ( p === UnsignedShort5551Type ) return gl.UNSIGNED_SHORT_5_5_5_1;\n\t\tif ( p === UnsignedInt5999Type ) return gl.UNSIGNED_INT_5_9_9_9_REV;\n\n\t\tif ( p === ByteType ) return gl.BYTE;\n\t\tif ( p === ShortType ) return gl.SHORT;\n\t\tif ( p === UnsignedShortType ) return gl.UNSIGNED_SHORT;\n\t\tif ( p === IntType ) return gl.INT;\n\t\tif ( p === UnsignedIntType ) return gl.UNSIGNED_INT;\n\t\tif ( p === FloatType ) return gl.FLOAT;\n\n\t\tif ( p === HalfFloatType ) {\n\n\t\t\treturn gl.HALF_FLOAT;\n\n\t\t}\n\n\t\tif ( p === AlphaFormat ) return gl.ALPHA;\n\t\tif ( p === RGBFormat ) return gl.RGB;\n\t\tif ( p === RGBAFormat ) return gl.RGBA;\n\t\tif ( p === LuminanceFormat ) return gl.LUMINANCE;\n\t\tif ( p === LuminanceAlphaFormat ) return gl.LUMINANCE_ALPHA;\n\t\tif ( p === DepthFormat ) return gl.DEPTH_COMPONENT;\n\t\tif ( p === DepthStencilFormat ) return gl.DEPTH_STENCIL;\n\n\t\t// WebGL2 formats.\n\n\t\tif ( p === RedFormat ) return gl.RED;\n\t\tif ( p === RedIntegerFormat ) return gl.RED_INTEGER;\n\t\tif ( p === RGFormat ) return gl.RG;\n\t\tif ( p === RGIntegerFormat ) return gl.RG_INTEGER;\n\t\tif ( p === RGBAIntegerFormat ) return gl.RGBA_INTEGER;\n\n\t\t// S3TC\n\n\t\tif ( p === RGB_S3TC_DXT1_Format || p === RGBA_S3TC_DXT1_Format || p === RGBA_S3TC_DXT3_Format || p === RGBA_S3TC_DXT5_Format ) {\n\n\t\t\tif ( colorSpace === SRGBColorSpace ) {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc_srgb' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\textension = extensions.get( 'WEBGL_compressed_texture_s3tc' );\n\n\t\t\t\tif ( extension !== null ) {\n\n\t\t\t\t\tif ( p === RGB_S3TC_DXT1_Format ) return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT1_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT3_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;\n\t\t\t\t\tif ( p === RGBA_S3TC_DXT5_Format ) return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT;\n\n\t\t\t\t} else {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// PVRTC\n\n\t\tif ( p === RGB_PVRTC_4BPPV1_Format || p === RGB_PVRTC_2BPPV1_Format || p === RGBA_PVRTC_4BPPV1_Format || p === RGBA_PVRTC_2BPPV1_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_pvrtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGB_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_4BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;\n\t\t\t\tif ( p === RGBA_PVRTC_2BPPV1_Format ) return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ETC\n\n\t\tif ( p === RGB_ETC1_Format || p === RGB_ETC2_Format || p === RGBA_ETC2_EAC_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_etc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGB_ETC1_Format || p === RGB_ETC2_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ETC2 : extension.COMPRESSED_RGB8_ETC2;\n\t\t\t\tif ( p === RGBA_ETC2_EAC_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC : extension.COMPRESSED_RGBA8_ETC2_EAC;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// ASTC\n\n\t\tif ( p === RGBA_ASTC_4x4_Format || p === RGBA_ASTC_5x4_Format || p === RGBA_ASTC_5x5_Format ||\n\t\t\tp === RGBA_ASTC_6x5_Format || p === RGBA_ASTC_6x6_Format || p === RGBA_ASTC_8x5_Format ||\n\t\t\tp === RGBA_ASTC_8x6_Format || p === RGBA_ASTC_8x8_Format || p === RGBA_ASTC_10x5_Format ||\n\t\t\tp === RGBA_ASTC_10x6_Format || p === RGBA_ASTC_10x8_Format || p === RGBA_ASTC_10x10_Format ||\n\t\t\tp === RGBA_ASTC_12x10_Format || p === RGBA_ASTC_12x12_Format ) {\n\n\t\t\textension = extensions.get( 'WEBGL_compressed_texture_astc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_ASTC_4x4_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR : extension.COMPRESSED_RGBA_ASTC_4x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x4_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR : extension.COMPRESSED_RGBA_ASTC_5x4_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_5x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR : extension.COMPRESSED_RGBA_ASTC_5x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR : extension.COMPRESSED_RGBA_ASTC_6x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_6x6_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR : extension.COMPRESSED_RGBA_ASTC_6x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR : extension.COMPRESSED_RGBA_ASTC_8x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x6_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR : extension.COMPRESSED_RGBA_ASTC_8x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_8x8_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR : extension.COMPRESSED_RGBA_ASTC_8x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x5_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR : extension.COMPRESSED_RGBA_ASTC_10x5_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x6_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR : extension.COMPRESSED_RGBA_ASTC_10x6_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x8_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR : extension.COMPRESSED_RGBA_ASTC_10x8_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_10x10_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR : extension.COMPRESSED_RGBA_ASTC_10x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x10_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR : extension.COMPRESSED_RGBA_ASTC_12x10_KHR;\n\t\t\t\tif ( p === RGBA_ASTC_12x12_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR : extension.COMPRESSED_RGBA_ASTC_12x12_KHR;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// BPTC\n\n\t\tif ( p === RGBA_BPTC_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_bptc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_BPTC_Format ) return ( colorSpace === SRGBColorSpace ) ? extension.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT : extension.COMPRESSED_RGBA_BPTC_UNORM_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// RGTC\n\n\t\tif ( p === RED_RGTC1_Format || p === SIGNED_RED_RGTC1_Format || p === RED_GREEN_RGTC2_Format || p === SIGNED_RED_GREEN_RGTC2_Format ) {\n\n\t\t\textension = extensions.get( 'EXT_texture_compression_rgtc' );\n\n\t\t\tif ( extension !== null ) {\n\n\t\t\t\tif ( p === RGBA_BPTC_Format ) return extension.COMPRESSED_RED_RGTC1_EXT;\n\t\t\t\tif ( p === SIGNED_RED_RGTC1_Format ) return extension.COMPRESSED_SIGNED_RED_RGTC1_EXT;\n\t\t\t\tif ( p === RED_GREEN_RGTC2_Format ) return extension.COMPRESSED_RED_GREEN_RGTC2_EXT;\n\t\t\t\tif ( p === SIGNED_RED_GREEN_RGTC2_Format ) return extension.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;\n\n\t\t\t} else {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( p === UnsignedInt248Type ) {\n\n\t\t\treturn gl.UNSIGNED_INT_24_8;\n\n\t\t}\n\n\t\t// if \"p\" can't be resolved, assume the user defines a WebGL constant as a string (fallback/workaround for packed RGB formats)\n\n\t\treturn ( gl[ p ] !== undefined ) ? gl[ p ] : null;\n\n\t}\n\n\t_clientWaitAsync() {\n\n\t\tconst { gl } = this;\n\n\t\tconst sync = gl.fenceSync( gl.SYNC_GPU_COMMANDS_COMPLETE, 0 );\n\n\t\tgl.flush();\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tfunction test() {\n\n\t\t\t\tconst res = gl.clientWaitSync( sync, gl.SYNC_FLUSH_COMMANDS_BIT, 0 );\n\n\t\t\t\tif ( res === gl.WAIT_FAILED ) {\n\n\t\t\t\t\tgl.deleteSync( sync );\n\n\t\t\t\t\treject();\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tif ( res === gl.TIMEOUT_EXPIRED ) {\n\n\t\t\t\t\trequestAnimationFrame( test );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tgl.deleteSync( sync );\n\n\t\t\t\tresolve();\n\n\t\t\t}\n\n\t\t\ttest();\n\n\t\t} );\n\n\t}\n\n}\n\nlet initialized = false, wrappingToGL, filterToGL, compareToGL;\n\nclass WebGLTextureUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = backend.gl;\n\t\tthis.extensions = backend.extensions;\n\t\tthis.defaultTextures = {};\n\n\t\tif ( initialized === false ) {\n\n\t\t\tthis._init( this.gl );\n\n\t\t\tinitialized = true;\n\n\t\t}\n\n\t}\n\n\t_init( gl ) {\n\n\t\t// Store only WebGL constants here.\n\n\t\twrappingToGL = {\n\t\t\t[ RepeatWrapping ]: gl.REPEAT,\n\t\t\t[ ClampToEdgeWrapping ]: gl.CLAMP_TO_EDGE,\n\t\t\t[ MirroredRepeatWrapping ]: gl.MIRRORED_REPEAT\n\t\t};\n\n\t\tfilterToGL = {\n\t\t\t[ NearestFilter ]: gl.NEAREST,\n\t\t\t[ NearestMipmapNearestFilter ]: gl.NEAREST_MIPMAP_NEAREST,\n\t\t\t[ NearestMipmapLinearFilter ]: gl.NEAREST_MIPMAP_LINEAR,\n\n\t\t\t[ LinearFilter ]: gl.LINEAR,\n\t\t\t[ LinearMipmapNearestFilter ]: gl.LINEAR_MIPMAP_NEAREST,\n\t\t\t[ LinearMipmapLinearFilter ]: gl.LINEAR_MIPMAP_LINEAR\n\t\t};\n\n\t\tcompareToGL = {\n\t\t\t[ NeverCompare ]: gl.NEVER,\n\t\t\t[ AlwaysCompare ]: gl.ALWAYS,\n\t\t\t[ LessCompare ]: gl.LESS,\n\t\t\t[ LessEqualCompare ]: gl.LEQUAL,\n\t\t\t[ EqualCompare ]: gl.EQUAL,\n\t\t\t[ GreaterEqualCompare ]: gl.GEQUAL,\n\t\t\t[ GreaterCompare ]: gl.GREATER,\n\t\t\t[ NotEqualCompare ]: gl.NOTEQUAL\n\t\t};\n\n\t}\n\n\tfilterFallback( f ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( f === NearestFilter || f === NearestMipmapNearestFilter || f === NearestMipmapLinearFilter ) {\n\n\t\t\treturn gl.NEAREST;\n\n\t\t}\n\n\t\treturn gl.LINEAR;\n\n\t}\n\n\tgetGLTextureType( texture ) {\n\n\t\tconst { gl } = this;\n\n\t\tlet glTextureType;\n\n\t\tif ( texture.isCubeTexture === true ) {\n\n\t\t\tglTextureType = gl.TEXTURE_CUBE_MAP;\n\n\t\t} else if ( texture.isDataArrayTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\t\tglTextureType = gl.TEXTURE_2D_ARRAY;\n\n\t\t} else if ( texture.isData3DTexture === true ) { // TODO: isCompressed3DTexture, wait for #26642\n\n\t\t\tglTextureType = gl.TEXTURE_3D;\n\n\t\t} else {\n\n\t\t\tglTextureType = gl.TEXTURE_2D;\n\n\n\t\t}\n\n\t\treturn glTextureType;\n\n\t}\n\n\tgetInternalFormat( internalFormatName, glFormat, glType, colorSpace, forceLinearTransfer = false ) {\n\n\t\tconst { gl, extensions } = this;\n\n\t\tif ( internalFormatName !== null ) {\n\n\t\t\tif ( gl[ internalFormatName ] !== undefined ) return gl[ internalFormatName ];\n\n\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format \\'' + internalFormatName + '\\'' );\n\n\t\t}\n\n\t\tlet internalFormat = glFormat;\n\n\t\tif ( glFormat === gl.RED ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.R32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.R16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.R8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.R16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.R32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.R8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.R16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.R32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RED_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.R8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.R16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.R32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.R8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.R16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.R32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RG ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.RG32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.RG16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RG8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RG16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RG32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RG8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RG16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RG32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RG_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RG8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RG16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RG32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RG8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RG16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RG32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGB ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.RGB32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.RGB16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGB8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGB16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGB32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGB8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGB16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGB32I;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = ( colorSpace === SRGBColorSpace && forceLinearTransfer === false ) ? gl.SRGB8 : gl.RGB8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_5_6_5 ) internalFormat = gl.RGB565;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_5_5_5_1 ) internalFormat = gl.RGB5_A1;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ) internalFormat = gl.RGB4;\n\t\t\tif ( glType === gl.UNSIGNED_INT_5_9_9_9_REV ) internalFormat = gl.RGB9_E5;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGB_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGB8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGB16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGB32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGB8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGB16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGB32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGBA ) {\n\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.RGBA32F;\n\t\t\tif ( glType === gl.HALF_FLOAT ) internalFormat = gl.RGBA16F;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGBA8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGBA16;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGBA32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGBA8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGBA16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGBA32I;\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = ( colorSpace === SRGBColorSpace && forceLinearTransfer === false ) ? gl.SRGB8_ALPHA8 : gl.RGBA8;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ) internalFormat = gl.RGBA4;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT_5_5_5_1 ) internalFormat = gl.RGB5_A1;\n\n\t\t}\n\n\t\tif ( glFormat === gl.RGBA_INTEGER ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_BYTE ) internalFormat = gl.RGBA8UI;\n\t\t\tif ( glType === gl.UNSIGNED_SHORT ) internalFormat = gl.RGBA16UI;\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.RGBA32UI;\n\t\t\tif ( glType === gl.BYTE ) internalFormat = gl.RGBA8I;\n\t\t\tif ( glType === gl.SHORT ) internalFormat = gl.RGBA16I;\n\t\t\tif ( glType === gl.INT ) internalFormat = gl.RGBA32I;\n\n\t\t}\n\n\t\tif ( glFormat === gl.DEPTH_COMPONENT ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_INT ) internalFormat = gl.DEPTH24_STENCIL8;\n\t\t\tif ( glType === gl.FLOAT ) internalFormat = gl.DEPTH_COMPONENT32F;\n\n\t\t}\n\n\t\tif ( glFormat === gl.DEPTH_STENCIL ) {\n\n\t\t\tif ( glType === gl.UNSIGNED_INT_24_8 ) internalFormat = gl.DEPTH24_STENCIL8;\n\n\t\t}\n\n\t\tif ( internalFormat === gl.R16F || internalFormat === gl.R32F ||\n\t\t\tinternalFormat === gl.RG16F || internalFormat === gl.RG32F ||\n\t\t\tinternalFormat === gl.RGBA16F || internalFormat === gl.RGBA32F ) {\n\n\t\t\textensions.get( 'EXT_color_buffer_float' );\n\n\t\t}\n\n\t\treturn internalFormat;\n\n\t}\n\n\tsetTextureParameters( textureType, texture ) {\n\n\t\tconst { gl, extensions, backend } = this;\n\n\n\t\tgl.pixelStorei( gl.UNPACK_FLIP_Y_WEBGL, texture.flipY );\n\t\tgl.pixelStorei( gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, texture.premultiplyAlpha );\n\t\tgl.pixelStorei( gl.UNPACK_ALIGNMENT, texture.unpackAlignment );\n\t\tgl.pixelStorei( gl.UNPACK_COLORSPACE_CONVERSION_WEBGL, gl.NONE );\n\n\t\tgl.texParameteri( textureType, gl.TEXTURE_WRAP_S, wrappingToGL[ texture.wrapS ] );\n\t\tgl.texParameteri( textureType, gl.TEXTURE_WRAP_T, wrappingToGL[ texture.wrapT ] );\n\n\t\tif ( textureType === gl.TEXTURE_3D || textureType === gl.TEXTURE_2D_ARRAY ) {\n\n\t\t\tgl.texParameteri( textureType, gl.TEXTURE_WRAP_R, wrappingToGL[ texture.wrapR ] );\n\n\t\t}\n\n\t\tgl.texParameteri( textureType, gl.TEXTURE_MAG_FILTER, filterToGL[ texture.magFilter ] );\n\n\n\t\tconst hasMipmaps = texture.mipmaps !== undefined && texture.mipmaps.length > 0;\n\n\t\t// follow WebGPU backend mapping for texture filtering\n\t\tconst minFilter = texture.minFilter === LinearFilter && hasMipmaps ? LinearMipmapLinearFilter : texture.minFilter;\n\n\t\tgl.texParameteri( textureType, gl.TEXTURE_MIN_FILTER, filterToGL[ minFilter ] );\n\n\t\tif ( texture.compareFunction ) {\n\n\t\t\tgl.texParameteri( textureType, gl.TEXTURE_COMPARE_MODE, gl.COMPARE_REF_TO_TEXTURE );\n\t\t\tgl.texParameteri( textureType, gl.TEXTURE_COMPARE_FUNC, compareToGL[ texture.compareFunction ] );\n\n\t\t}\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tif ( texture.magFilter === NearestFilter ) return;\n\t\t\tif ( texture.minFilter !== NearestMipmapLinearFilter && texture.minFilter !== LinearMipmapLinearFilter ) return;\n\t\t\tif ( texture.type === FloatType && extensions.has( 'OES_texture_float_linear' ) === false ) return; // verify extension for WebGL 1 and WebGL 2\n\n\t\t\tif ( texture.anisotropy > 1 ) {\n\n\t\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\t\t\t\tgl.texParameterf( textureType, extension.TEXTURE_MAX_ANISOTROPY_EXT, Math.min( texture.anisotropy, backend.getMaxAnisotropy() ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tconst { gl, backend, defaultTextures } = this;\n\n\n\t\tconst glTextureType = this.getGLTextureType( texture );\n\n\t\tlet textureGPU = defaultTextures[ glTextureType ];\n\n\t\tif ( textureGPU === undefined ) {\n\n\t\t\ttextureGPU = gl.createTexture();\n\n\t\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\t\t\tgl.texParameteri( glTextureType, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\t\tgl.texParameteri( glTextureType, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\n\t\t\t// gl.texImage2D( glTextureType, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, data );\n\n\t\t\tdefaultTextures[ glTextureType ] = textureGPU;\n\n\t\t}\n\n\t\tbackend.set( texture, {\n\t\t\ttextureGPU,\n\t\t\tglTextureType,\n\t\t\tisDefault: true\n\t\t} );\n\n\t}\n\n\tcreateTexture( texture, options ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { levels, width, height, depth } = options;\n\n\t\tconst glFormat = backend.utils.convert( texture.format, texture.colorSpace );\n\t\tconst glType = backend.utils.convert( texture.type );\n\t\tconst glInternalFormat = this.getInternalFormat( texture.internalFormat, glFormat, glType, texture.colorSpace, texture.isVideoTexture );\n\n\t\tconst textureGPU = gl.createTexture();\n\t\tconst glTextureType = this.getGLTextureType( texture );\n\n\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\n\t\tthis.setTextureParameters( glTextureType, texture );\n\n\t\tif ( texture.isDataArrayTexture || texture.isCompressedArrayTexture ) {\n\n\t\t\tgl.texStorage3D( gl.TEXTURE_2D_ARRAY, levels, glInternalFormat, width, height, depth );\n\n\t\t} else if ( texture.isData3DTexture ) {\n\n\t\t\tgl.texStorage3D( gl.TEXTURE_3D, levels, glInternalFormat, width, height, depth );\n\n\t\t} else if ( ! texture.isVideoTexture ) {\n\n\t\t\tgl.texStorage2D( glTextureType, levels, glInternalFormat, width, height );\n\n\t\t}\n\n\t\tbackend.set( texture, {\n\t\t\ttextureGPU,\n\t\t\tglTextureType,\n\t\t\tglFormat,\n\t\t\tglType,\n\t\t\tglInternalFormat\n\t\t} );\n\n\t}\n\n\tcopyBufferToTexture( buffer, texture ) {\n\n\t\tconst { gl, backend } = this;\n\n\t\tconst { textureGPU, glTextureType, glFormat, glType } = backend.get( texture );\n\n\t\tconst { width, height } = texture.source.data;\n\n\t\tgl.bindBuffer( gl.PIXEL_UNPACK_BUFFER, buffer );\n\n\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\n\t\tgl.pixelStorei( gl.UNPACK_FLIP_Y_WEBGL, false );\n\t\tgl.pixelStorei( gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false );\n\t\tgl.texSubImage2D( glTextureType, 0, 0, 0, width, height, glFormat, glType, 0 );\n\n\t\tgl.bindBuffer( gl.PIXEL_UNPACK_BUFFER, null );\n\n\t\tbackend.state.unbindTexture();\n\t\t// debug\n\t\t// const framebuffer = gl.createFramebuffer();\n\t\t// gl.bindFramebuffer( gl.FRAMEBUFFER, framebuffer );\n\t\t// gl.framebufferTexture2D( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, glTextureType, textureGPU, 0 );\n\n\t\t// const readout = new Float32Array( width * height * 4 );\n\n\t\t// const altFormat = gl.getParameter( gl.IMPLEMENTATION_COLOR_READ_FORMAT );\n\t\t// const altType = gl.getParameter( gl.IMPLEMENTATION_COLOR_READ_TYPE );\n\n\t\t// gl.readPixels( 0, 0, width, height, altFormat, altType, readout );\n\t\t// gl.bindFramebuffer( gl.FRAMEBUFFER, null );\n\t\t// console.log( readout );\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tconst { gl } = this;\n\t\tconst { width, height } = options;\n\t\tconst { textureGPU, glTextureType, glFormat, glType, glInternalFormat } = this.backend.get( texture );\n\n\t\tif ( texture.isRenderTargetTexture || ( textureGPU === undefined /* unsupported texture format */ ) )\n\t\t\treturn;\n\n\t\tconst getImage = ( source ) => {\n\n\t\t\tif ( source.isDataTexture ) {\n\n\t\t\t\treturn source.image.data;\n\n\t\t\t} else if ( source instanceof ImageBitmap || source instanceof OffscreenCanvas || source instanceof HTMLImageElement || source instanceof HTMLCanvasElement ) {\n\n\t\t\t\treturn source;\n\n\t\t\t}\n\n\t\t\treturn source.data;\n\n\t\t};\n\n\t\tthis.backend.state.bindTexture( glTextureType, textureGPU );\n\n\t\tthis.setTextureParameters( glTextureType, texture );\n\n\t\tif ( texture.isCompressedTexture ) {\n\n\t\t\tconst mipmaps = texture.mipmaps;\n\t\t\tconst image = options.image;\n\n\t\t\tfor ( let i = 0; i < mipmaps.length; i ++ ) {\n\n\t\t\t\tconst mipmap = mipmaps[ i ];\n\n\t\t\t\tif ( texture.isCompressedArrayTexture ) {\n\n\n\t\t\t\t\tif ( texture.format !== gl.RGBA ) {\n\n\t\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\t\tgl.compressedTexSubImage3D( gl.TEXTURE_2D_ARRAY, i, 0, 0, 0, mipmap.width, mipmap.height, image.depth, glFormat, mipmap.data );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.texSubImage3D( gl.TEXTURE_2D_ARRAY, i, 0, 0, 0, mipmap.width, mipmap.height, image.depth, glFormat, glType, mipmap.data );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( glFormat !== null ) {\n\n\t\t\t\t\t\tgl.compressedTexSubImage2D( gl.TEXTURE_2D, i, 0, 0, mipmap.width, mipmap.height, glFormat, mipmap.data );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'Unsupported compressed texture format' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t} else if ( texture.isCubeTexture ) {\n\n\t\t\tconst images = options.images;\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tconst image = getImage( images[ i ] );\n\n\t\t\t\tgl.texSubImage2D( gl.TEXTURE_CUBE_MAP_POSITIVE_X + i, 0, 0, 0, width, height, glFormat, glType, image );\n\n\t\t\t}\n\n\t\t} else if ( texture.isDataArrayTexture ) {\n\n\t\t\tconst image = options.image;\n\n\t\t\tgl.texSubImage3D( gl.TEXTURE_2D_ARRAY, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t} else if ( texture.isData3DTexture ) {\n\n\t\t\tconst image = options.image;\n\n\t\t\tgl.texSubImage3D( gl.TEXTURE_3D, 0, 0, 0, 0, image.width, image.height, image.depth, glFormat, glType, image.data );\n\n\t\t} else if ( texture.isVideoTexture ) {\n\n\t\t\ttexture.update();\n\n\t\t\tgl.texImage2D( glTextureType, 0, glInternalFormat, glFormat, glType, options.image );\n\n\n\t\t} else {\n\n\t\t\tconst image = getImage( options.image );\n\n\t\t\tgl.texSubImage2D( glTextureType, 0, 0, 0, width, height, glFormat, glType, image );\n\n\t\t}\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { textureGPU, glTextureType } = backend.get( texture );\n\n\t\tbackend.state.bindTexture( glTextureType, textureGPU );\n\t\tgl.generateMipmap( glTextureType );\n\n\t}\n\n\tdeallocateRenderBuffers( renderTarget ) {\n\n\t\tconst { gl, backend } = this;\n\n\t\t// remove framebuffer reference\n\t\tif ( renderTarget ) {\n\n\t\t\tconst renderContextData = backend.get( renderTarget );\n\n\t\t\trenderContextData.renderBufferStorageSetup = undefined;\n\n\t\t\tif ( renderContextData.framebuffers ) {\n\n\t\t\t\tfor ( const cacheKey in renderContextData.framebuffers ) {\n\n\t\t\t\t\tgl.deleteFramebuffer( renderContextData.framebuffers[ cacheKey ] );\n\n\t\t\t\t}\n\n\t\t\t\tdelete renderContextData.framebuffers;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.depthRenderbuffer ) {\n\n\t\t\t\tgl.deleteRenderbuffer( renderContextData.depthRenderbuffer );\n\t\t\t\tdelete renderContextData.depthRenderbuffer;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.stencilRenderbuffer ) {\n\n\t\t\t\tgl.deleteRenderbuffer( renderContextData.stencilRenderbuffer );\n\t\t\t\tdelete renderContextData.stencilRenderbuffer;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.msaaFrameBuffer ) {\n\n\t\t\t\tgl.deleteFramebuffer( renderContextData.msaaFrameBuffer );\n\t\t\t\tdelete renderContextData.msaaFrameBuffer;\n\n\t\t\t}\n\n\t\t\tif ( renderContextData.msaaRenderbuffers ) {\n\n\t\t\t\tfor ( let i = 0; i < renderContextData.msaaRenderbuffers.length; i ++ ) {\n\n\t\t\t\t\tgl.deleteRenderbuffer( renderContextData.msaaRenderbuffers[ i ] );\n\n\t\t\t\t}\n\n\t\t\t\tdelete renderContextData.msaaRenderbuffers;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdestroyTexture( texture ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { textureGPU, renderTarget } = backend.get( texture );\n\n\t\tthis.deallocateRenderBuffers( renderTarget );\n\t\tgl.deleteTexture( textureGPU );\n\n\t\tbackend.delete( texture );\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion = null, dstPosition = null, level = 0 ) {\n\n\t\tconst { gl, backend } = this;\n\t\tconst { state } = this.backend;\n\n\t\tconst { textureGPU: dstTextureGPU, glTextureType, glType, glFormat } = backend.get( dstTexture );\n\n\t\tlet width, height, minX, minY;\n\t\tlet dstX, dstY;\n\n\t\tif ( srcRegion !== null ) {\n\n\t\t\twidth = srcRegion.max.x - srcRegion.min.x;\n\t\t\theight = srcRegion.max.y - srcRegion.min.y;\n\t\t\tminX = srcRegion.min.x;\n\t\t\tminY = srcRegion.min.y;\n\n\t\t} else {\n\n\t\t\twidth = srcTexture.image.width;\n\t\t\theight = srcTexture.image.height;\n\t\t\tminX = 0;\n\t\t\tminY = 0;\n\n\t\t}\n\n\t\tif ( dstPosition !== null ) {\n\n\t\t\tdstX = dstPosition.x;\n\t\t\tdstY = dstPosition.y;\n\n\t\t} else {\n\n\t\t\tdstX = 0;\n\t\t\tdstY = 0;\n\n\t\t}\n\n\t\tstate.bindTexture( glTextureType, dstTextureGPU );\n\n\t\t// As another texture upload may have changed pixelStorei\n\t\t// parameters, make sure they are correct for the dstTexture\n\t\tgl.pixelStorei( gl.UNPACK_ALIGNMENT, dstTexture.unpackAlignment );\n\t\tgl.pixelStorei( gl.UNPACK_FLIP_Y_WEBGL, dstTexture.flipY );\n\t\tgl.pixelStorei( gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, dstTexture.premultiplyAlpha );\n\t\tgl.pixelStorei( gl.UNPACK_ALIGNMENT, dstTexture.unpackAlignment );\n\n\t\tconst currentUnpackRowLen = gl.getParameter( gl.UNPACK_ROW_LENGTH );\n\t\tconst currentUnpackImageHeight = gl.getParameter( gl.UNPACK_IMAGE_HEIGHT );\n\t\tconst currentUnpackSkipPixels = gl.getParameter( gl.UNPACK_SKIP_PIXELS );\n\t\tconst currentUnpackSkipRows = gl.getParameter( gl.UNPACK_SKIP_ROWS );\n\t\tconst currentUnpackSkipImages = gl.getParameter( gl.UNPACK_SKIP_IMAGES );\n\n\t\tconst image = srcTexture.isCompressedTexture ? srcTexture.mipmaps[ level ] : srcTexture.image;\n\n\t\tgl.pixelStorei( gl.UNPACK_ROW_LENGTH, image.width );\n\t\tgl.pixelStorei( gl.UNPACK_IMAGE_HEIGHT, image.height );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_PIXELS, minX );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_ROWS, minY );\n\n\t\tif ( srcTexture.isRenderTargetTexture || srcTexture.isDepthTexture ) {\n\n\t\t\tconst srcTextureData = backend.get( srcTexture );\n\t\t\tconst dstTextureData = backend.get( dstTexture );\n\n\t\t\tconst srcRenderContextData = backend.get( srcTextureData.renderTarget );\n\t\t\tconst dstRenderContextData = backend.get( dstTextureData.renderTarget );\n\n\t\t\tconst srcFramebuffer = srcRenderContextData.framebuffers[ srcTextureData.cacheKey ];\n\t\t\tconst dstFramebuffer = dstRenderContextData.framebuffers[ dstTextureData.cacheKey ];\n\n\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, srcFramebuffer );\n\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, dstFramebuffer );\n\n\t\t\tlet mask = gl.COLOR_BUFFER_BIT;\n\n\t\t\tif ( srcTexture.isDepthTexture ) mask = gl.DEPTH_BUFFER_BIT;\n\n\t\t\tgl.blitFramebuffer( minX, minY, width, height, dstX, dstY, width, height, mask, gl.NEAREST );\n\n\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, null );\n\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, null );\n\n\t\t} else {\n\n\t\t\tif ( srcTexture.isDataTexture ) {\n\n\t\t\t\tgl.texSubImage2D( gl.TEXTURE_2D, level, dstX, dstY, width, height, glFormat, glType, image.data );\n\n\t\t\t} else {\n\n\t\t\t\tif ( srcTexture.isCompressedTexture ) {\n\n\t\t\t\t\tgl.compressedTexSubImage2D( gl.TEXTURE_2D, level, dstX, dstY, image.width, image.height, glFormat, image.data );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tgl.texSubImage2D( gl.TEXTURE_2D, level, dstX, dstY, width, height, glFormat, glType, image );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.pixelStorei( gl.UNPACK_ROW_LENGTH, currentUnpackRowLen );\n\t\tgl.pixelStorei( gl.UNPACK_IMAGE_HEIGHT, currentUnpackImageHeight );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_PIXELS, currentUnpackSkipPixels );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_ROWS, currentUnpackSkipRows );\n\t\tgl.pixelStorei( gl.UNPACK_SKIP_IMAGES, currentUnpackSkipImages );\n\n\t\t// Generate mipmaps only when copying level 0\n\t\tif ( level === 0 && dstTexture.generateMipmaps ) gl.generateMipmap( gl.TEXTURE_2D );\n\n\t\tstate.unbindTexture();\n\n\t}\n\n\tcopyFramebufferToTexture( texture, renderContext, rectangle ) {\n\n\t\tconst { gl } = this;\n\t\tconst { state } = this.backend;\n\n\t\tconst { textureGPU } = this.backend.get( texture );\n\n\t\tconst { x, y, z: width, w: height } = rectangle;\n\n\t\tconst requireDrawFrameBuffer = texture.isDepthTexture === true || ( renderContext.renderTarget && renderContext.renderTarget.samples > 0 );\n\n\t\tconst srcHeight = renderContext.renderTarget ? renderContext.renderTarget.height : this.backend.gerDrawingBufferSize().y;\n\n\t\tif ( requireDrawFrameBuffer ) {\n\n\t\t\tconst partial = ( x !== 0 || y !== 0 );\n\t\t\tlet mask;\n\t\t\tlet attachment;\n\n\t\t\tif ( texture.isDepthTexture === true ) {\n\n\t\t\t\tmask = gl.DEPTH_BUFFER_BIT;\n\t\t\t\tattachment = gl.DEPTH_ATTACHMENT;\n\n\t\t\t\tif ( renderContext.stencil ) {\n\n\t\t\t\t\tmask |= gl.STENCIL_BUFFER_BIT;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tmask = gl.COLOR_BUFFER_BIT;\n\t\t\t\tattachment = gl.COLOR_ATTACHMENT0;\n\n\t\t\t}\n\n\t\t\tif ( partial ) {\n\n\t\t\t\tconst renderTargetContextData = this.backend.get( renderContext.renderTarget );\n\n\t\t\t\tconst fb = renderTargetContextData.framebuffers[ renderContext.getCacheKey() ];\n\t\t\t\tconst msaaFrameBuffer = renderTargetContextData.msaaFrameBuffer;\n\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, fb );\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, msaaFrameBuffer );\n\n\t\t\t\tconst flippedY = srcHeight - y - height;\n\n\t\t\t\tgl.blitFramebuffer( x, flippedY, x + width, flippedY + height, x, flippedY, x + width, flippedY + height, mask, gl.NEAREST );\n\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, fb );\n\n\t\t\t\tstate.bindTexture( gl.TEXTURE_2D, textureGPU );\n\n\t\t\t\tgl.copyTexSubImage2D( gl.TEXTURE_2D, 0, 0, 0, x, flippedY, width, height );\n\n\t\t\t\tstate.unbindTexture();\n\n\t\t\t} else {\n\n\t\t\t\tconst fb = gl.createFramebuffer();\n\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, fb );\n\n\t\t\t\tgl.framebufferTexture2D( gl.DRAW_FRAMEBUFFER, attachment, gl.TEXTURE_2D, textureGPU, 0 );\n\t\t\t\tgl.blitFramebuffer( 0, 0, width, height, 0, 0, width, height, mask, gl.NEAREST );\n\n\t\t\t\tgl.deleteFramebuffer( fb );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstate.bindTexture( gl.TEXTURE_2D, textureGPU );\n\t\t\tgl.copyTexSubImage2D( gl.TEXTURE_2D, 0, 0, 0, x, srcHeight - height - y, width, height );\n\n\t\t\tstate.unbindTexture();\n\n\t\t}\n\n\t\tif ( texture.generateMipmaps ) this.generateMipmaps( texture );\n\n\t\tthis.backend._setFramebuffer( renderContext );\n\n\t}\n\n\t// Setup storage for internal depth/stencil buffers and bind to correct framebuffer\n\tsetupRenderBufferStorage( renderbuffer, renderContext ) {\n\n\t\tconst { gl } = this;\n\t\tconst renderTarget = renderContext.renderTarget;\n\n\t\tconst { samples, depthTexture, depthBuffer, stencilBuffer, width, height } = renderTarget;\n\n\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, renderbuffer );\n\n\t\tif ( depthBuffer && ! stencilBuffer ) {\n\n\t\t\tlet glInternalFormat = gl.DEPTH_COMPONENT24;\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tif ( depthTexture && depthTexture.isDepthTexture ) {\n\n\t\t\t\t\tif ( depthTexture.type === gl.FLOAT ) {\n\n\t\t\t\t\t\tglInternalFormat = gl.DEPTH_COMPONENT32F;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, samples, glInternalFormat, width, height );\n\n\t\t\t} else {\n\n\t\t\t\tgl.renderbufferStorage( gl.RENDERBUFFER, glInternalFormat, width, height );\n\n\t\t\t}\n\n\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer );\n\n\t\t} else if ( depthBuffer && stencilBuffer ) {\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, samples, gl.DEPTH24_STENCIL8, width, height );\n\n\t\t\t} else {\n\n\t\t\t\tgl.renderbufferStorage( gl.RENDERBUFFER, gl.DEPTH_STENCIL, width, height );\n\n\t\t\t}\n\n\n\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, renderbuffer );\n\n\t\t}\n\n\t}\n\n\tasync copyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\tconst { backend, gl } = this;\n\n\t\tconst { textureGPU, glFormat, glType } = this.backend.get( texture );\n\n\t\tconst fb = gl.createFramebuffer();\n\n\t\tgl.bindFramebuffer( gl.READ_FRAMEBUFFER, fb );\n\n\t\tconst target = texture.isCubeTexture ? gl.TEXTURE_CUBE_MAP_POSITIVE_X + faceIndex : gl.TEXTURE_2D;\n\n\t\tgl.framebufferTexture2D( gl.READ_FRAMEBUFFER, gl.COLOR_ATTACHMENT0, target, textureGPU, 0 );\n\n\t\tconst typedArrayType = this._getTypedArrayType( glType );\n\t\tconst bytesPerTexel = this._getBytesPerTexel( glType, glFormat );\n\n\t\tconst elementCount = width * height;\n\t\tconst byteLength = elementCount * bytesPerTexel;\n\n\t\tconst buffer = gl.createBuffer();\n\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, buffer );\n\t\tgl.bufferData( gl.PIXEL_PACK_BUFFER, byteLength, gl.STREAM_READ );\n\t\tgl.readPixels( x, y, width, height, glFormat, glType, 0 );\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, null );\n\n\t\tawait backend.utils._clientWaitAsync();\n\n\t\tconst dstBuffer = new typedArrayType( byteLength / typedArrayType.BYTES_PER_ELEMENT );\n\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, buffer );\n\t\tgl.getBufferSubData( gl.PIXEL_PACK_BUFFER, 0, dstBuffer );\n\t\tgl.bindBuffer( gl.PIXEL_PACK_BUFFER, null );\n\n\t\tgl.deleteFramebuffer( fb );\n\n\t\treturn dstBuffer;\n\n\t}\n\n\t_getTypedArrayType( glType ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( glType === gl.UNSIGNED_BYTE ) return Uint8Array;\n\n\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_SHORT_5_5_5_1 ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_SHORT_5_6_5 ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_SHORT ) return Uint16Array;\n\t\tif ( glType === gl.UNSIGNED_INT ) return Uint32Array;\n\n\t\tif ( glType === gl.HALF_FLOAT ) return Uint16Array;\n\t\tif ( glType === gl.FLOAT ) return Float32Array;\n\n\t\tthrow new Error( `Unsupported WebGL type: ${glType}` );\n\n\t}\n\n\t_getBytesPerTexel( glType, glFormat ) {\n\n\t\tconst { gl } = this;\n\n\t\tlet bytesPerComponent = 0;\n\n\t\tif ( glType === gl.UNSIGNED_BYTE ) bytesPerComponent = 1;\n\n\t\tif ( glType === gl.UNSIGNED_SHORT_4_4_4_4 ||\n\t\t\tglType === gl.UNSIGNED_SHORT_5_5_5_1 ||\n\t\t\tglType === gl.UNSIGNED_SHORT_5_6_5 ||\n\t\t\tglType === gl.UNSIGNED_SHORT ||\n\t\t\tglType === gl.HALF_FLOAT ) bytesPerComponent = 2;\n\n\t\tif ( glType === gl.UNSIGNED_INT ||\n\t\t\tglType === gl.FLOAT ) bytesPerComponent = 4;\n\n\t\tif ( glFormat === gl.RGBA ) return bytesPerComponent * 4;\n\t\tif ( glFormat === gl.RGB ) return bytesPerComponent * 3;\n\t\tif ( glFormat === gl.ALPHA ) return bytesPerComponent;\n\n\t}\n\n}\n\nclass WebGLExtensions {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.gl = this.backend.gl;\n\t\tthis.availableExtensions = this.gl.getSupportedExtensions();\n\n\t\tthis.extensions = {};\n\n\t}\n\n\tget( name ) {\n\n\t\tlet extension = this.extensions[ name ];\n\n\t\tif ( extension === undefined ) {\n\n\t\t\textension = this.gl.getExtension( name );\n\n\t\t\tthis.extensions[ name ] = extension;\n\n\t\t}\n\n\t\treturn extension;\n\n\t}\n\n\thas( name ) {\n\n\t\treturn this.availableExtensions.includes( name );\n\n\t}\n\n}\n\nclass WebGLCapabilities {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis.maxAnisotropy = null;\n\n\t}\n\n\tgetMaxAnisotropy() {\n\n\t\tif ( this.maxAnisotropy !== null ) return this.maxAnisotropy;\n\n\t\tconst gl = this.backend.gl;\n\t\tconst extensions = this.backend.extensions;\n\n\t\tif ( extensions.has( 'EXT_texture_filter_anisotropic' ) === true ) {\n\n\t\t\tconst extension = extensions.get( 'EXT_texture_filter_anisotropic' );\n\n\t\t\tthis.maxAnisotropy = gl.getParameter( extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT );\n\n\t\t} else {\n\n\t\t\tthis.maxAnisotropy = 0;\n\n\t\t}\n\n\t\treturn this.maxAnisotropy;\n\n\t}\n\n}\n\nconst GLFeatureName = {\n\n\t'WEBGL_multi_draw': 'WEBGL_multi_draw',\n\t'WEBGL_compressed_texture_astc': 'texture-compression-astc',\n\t'WEBGL_compressed_texture_etc': 'texture-compression-etc2',\n\t'WEBGL_compressed_texture_etc1': 'texture-compression-etc1',\n\t'WEBGL_compressed_texture_pvrtc': 'texture-compression-pvrtc',\n\t'WEBKIT_WEBGL_compressed_texture_pvrtc': 'texture-compression-pvrtc',\n\t'WEBGL_compressed_texture_s3tc': 'texture-compression-bc',\n\t'EXT_texture_compression_bptc': 'texture-compression-bptc',\n\t'EXT_disjoint_timer_query_webgl2': 'timestamp-query',\n\n};\n\nclass WebGLBufferRenderer {\n\n\tconstructor( backend ) {\n\n\t\tthis.gl = backend.gl;\n\t\tthis.extensions = backend.extensions;\n\t\tthis.info = backend.renderer.info;\n\t\tthis.mode = null;\n\t\tthis.index = 0;\n\t\tthis.type = null;\n\t\tthis.object = null;\n\n\t}\n\n\trender( start, count ) {\n\n\t\tconst { gl, mode, object, type, info, index } = this;\n\n\t\tif ( index !== 0 ) {\n\n\t\t\tgl.drawElements( mode, count, type, start );\n\n\t\t} else {\n\n\t\t\tgl.drawArrays( mode, start, count );\n\n\t\t}\n\n\t\tinfo.update( object, count, mode, 1 );\n\n\t}\n\n\trenderInstances( start, count, primcount ) {\n\n\t\tconst { gl, mode, type, index, object, info } = this;\n\n\t\tif ( primcount === 0 ) return;\n\n\t\tif ( index !== 0 ) {\n\n\t\t\tgl.drawElementsInstanced( mode, count, type, start, primcount );\n\n\t\t} else {\n\n\t\t\tgl.drawArraysInstanced( mode, start, count, primcount );\n\n\t\t}\n\n\t\tinfo.update( object, count, mode, primcount );\n\n\t}\n\n\trenderMultiDraw( starts, counts, drawCount ) {\n\n\t\tconst { extensions, mode, object, info } = this;\n\n\t\tif ( drawCount === 0 ) return;\n\n\t\tconst extension = extensions.get( 'WEBGL_multi_draw' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\tthis.render( starts[ i ], counts[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this.index !== 0 ) {\n\n\t\t\t\textension.multiDrawElementsWEBGL( mode, counts, 0, this.type, starts, 0, drawCount );\n\n\t\t\t} else {\n\n\t\t\t\textension.multiDrawArraysWEBGL( mode, starts, 0, counts, 0, drawCount );\n\n\t\t\t}\n\n\t\t\tlet elementCount = 0;\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\telementCount += counts[ i ];\n\n\t\t\t}\n\n\t\t\tinfo.update( object, elementCount, mode, 1 );\n\n\t\t}\n\n\t}\n\n\trenderMultiDrawInstances( starts, counts, drawCount, primcount ) {\n\n\t\tconst { extensions, mode, object, info } = this;\n\n\t\tif ( drawCount === 0 ) return;\n\n\t\tconst extension = extensions.get( 'WEBGL_multi_draw' );\n\n\t\tif ( extension === null ) {\n\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\tthis.renderInstances( starts[ i ], counts[ i ], primcount[ i ] );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( this.index !== 0 ) {\n\n\t\t\t\textension.multiDrawElementsInstancedWEBGL( mode, counts, 0, this.type, starts, 0, primcount, 0, drawCount );\n\n\t\t\t} else {\n\n\t\t\t\textension.multiDrawArraysInstancedWEBGL( mode, starts, 0, counts, 0, primcount, 0, drawCount );\n\n\t\t\t}\n\n\t\t\tlet elementCount = 0;\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\telementCount += counts[ i ] * primcount[ i ];\n\n\t\t\t}\n\n\t\t\tinfo.update( object, elementCount, mode, 1 );\n\n\t\t}\n\n\t}\n\n\t//\n\n}\n\n//\n\nclass WebGLBackend extends Backend {\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isWebGLBackend = true;\n\n\t}\n\n\tinit( renderer ) {\n\n\t\tsuper.init( renderer );\n\n\t\t//\n\n\t\tconst parameters = this.parameters;\n\n\t\tconst glContext = ( parameters.context !== undefined ) ? parameters.context : renderer.domElement.getContext( 'webgl2' );\n\n\t \tfunction onContextLost( event ) {\n\n\t\t\tevent.preventDefault();\n\n\t\t\tconst contextLossInfo = {\n\t\t\t\tapi: 'WebGL',\n\t\t\t\tmessage: event.statusMessage || 'Unknown reason',\n\t\t\t\treason: null,\n\t\t\t\toriginalEvent: event\n\t\t\t};\n\n\t\t\trenderer.onDeviceLost( contextLossInfo );\n\n\t\t}\n\n\t\tthis._onContextLost = onContextLost;\n\n\t\trenderer.domElement.addEventListener( 'webglcontextlost', onContextLost, false );\n\n\t\tthis.gl = glContext;\n\n\t\tthis.extensions = new WebGLExtensions( this );\n\t\tthis.capabilities = new WebGLCapabilities( this );\n\t\tthis.attributeUtils = new WebGLAttributeUtils( this );\n\t\tthis.textureUtils = new WebGLTextureUtils( this );\n\t\tthis.bufferRenderer = new WebGLBufferRenderer( this );\n\n\t\tthis.state = new WebGLState( this );\n\t\tthis.utils = new WebGLUtils( this );\n\n\t\tthis.vaoCache = {};\n\t\tthis.transformFeedbackCache = {};\n\t\tthis.discard = false;\n\t\tthis.trackTimestamp = ( parameters.trackTimestamp === true );\n\n\t\tthis.extensions.get( 'EXT_color_buffer_float' );\n\t\tthis.extensions.get( 'WEBGL_clip_cull_distance' );\n\t\tthis.extensions.get( 'OES_texture_float_linear' );\n\t\tthis.extensions.get( 'EXT_color_buffer_half_float' );\n\t\tthis.extensions.get( 'WEBGL_multisampled_render_to_texture' );\n\t\tthis.extensions.get( 'WEBGL_render_shared_exponent' );\n\t\tthis.extensions.get( 'WEBGL_multi_draw' );\n\n\t\tthis.disjoint = this.extensions.get( 'EXT_disjoint_timer_query_webgl2' );\n\t\tthis.parallel = this.extensions.get( 'KHR_parallel_shader_compile' );\n\n\t\tthis._knownBindings = new WeakSet();\n\n\t\tthis._currentContext = null;\n\n\t}\n\n\tget coordinateSystem() {\n\n\t\treturn WebGLCoordinateSystem;\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\treturn await this.attributeUtils.getArrayBufferAsync( attribute );\n\n\t}\n\n\tasync waitForGPU() {\n\n\t\tawait this.utils._clientWaitAsync();\n\n\t}\n\n\tinitTimestampQuery( renderContext ) {\n\n\t\tif ( ! this.disjoint || ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( this.queryRunning ) {\n\n\t\t  if ( ! renderContextData.queryQueue ) renderContextData.queryQueue = [];\n\t\t  renderContextData.queryQueue.push( renderContext );\n\t\t  return;\n\n\t\t}\n\n\t\tif ( renderContextData.activeQuery ) {\n\n\t\t  this.gl.endQuery( this.disjoint.TIME_ELAPSED_EXT );\n\t\t  renderContextData.activeQuery = null;\n\n\t\t}\n\n\t\trenderContextData.activeQuery = this.gl.createQuery();\n\n\t\tif ( renderContextData.activeQuery !== null ) {\n\n\t\t  this.gl.beginQuery( this.disjoint.TIME_ELAPSED_EXT, renderContextData.activeQuery );\n\t\t  this.queryRunning = true;\n\n\t\t}\n\n\t}\n\n\t// timestamp utils\n\n\tprepareTimestampBuffer( renderContext ) {\n\n\t\tif ( ! this.disjoint || ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( renderContextData.activeQuery ) {\n\n\t\t  this.gl.endQuery( this.disjoint.TIME_ELAPSED_EXT );\n\n\t\t  if ( ! renderContextData.gpuQueries ) renderContextData.gpuQueries = [];\n\t\t  renderContextData.gpuQueries.push( { query: renderContextData.activeQuery } );\n\t\t  renderContextData.activeQuery = null;\n\t\t  this.queryRunning = false;\n\n\t\t  if ( renderContextData.queryQueue && renderContextData.queryQueue.length > 0 ) {\n\n\t\t\t\tconst nextRenderContext = renderContextData.queryQueue.shift();\n\t\t\t\tthis.initTimestampQuery( nextRenderContext );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t  async resolveTimestampAsync( renderContext, type = 'render' ) {\n\n\t\tif ( ! this.disjoint || ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( ! renderContextData.gpuQueries ) renderContextData.gpuQueries = [];\n\n\t\tfor ( let i = 0; i < renderContextData.gpuQueries.length; i ++ ) {\n\n\t\t  const queryInfo = renderContextData.gpuQueries[ i ];\n\t\t  const available = this.gl.getQueryParameter( queryInfo.query, this.gl.QUERY_RESULT_AVAILABLE );\n\t\t  const disjoint = this.gl.getParameter( this.disjoint.GPU_DISJOINT_EXT );\n\n\t\t  if ( available && ! disjoint ) {\n\n\t\t\t\tconst elapsed = this.gl.getQueryParameter( queryInfo.query, this.gl.QUERY_RESULT );\n\t\t\t\tconst duration = Number( elapsed ) / 1000000; // Convert nanoseconds to milliseconds\n\t\t\t\tthis.gl.deleteQuery( queryInfo.query );\n\t\t\t\trenderContextData.gpuQueries.splice( i, 1 ); // Remove the processed query\n\t\t\t\ti --;\n\t\t\t\tthis.renderer.info.updateTimestamp( type, duration );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.gl;\n\n\t}\n\n\tbeginRender( renderContext ) {\n\n\t\tconst { gl } = this;\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\t//\n\n\t\t//\n\n\t\tthis.initTimestampQuery( renderContext );\n\n\t\trenderContextData.previousContext = this._currentContext;\n\t\tthis._currentContext = renderContext;\n\n\t\tthis._setFramebuffer( renderContext );\n\n\t\tthis.clear( renderContext.clearColor, renderContext.clearDepth, renderContext.clearStencil, renderContext, false );\n\n\t\t//\n\t\tif ( renderContext.viewport ) {\n\n\t\t\tthis.updateViewport( renderContext );\n\n\t\t} else {\n\n\t\t\tgl.viewport( 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight );\n\n\t\t}\n\n\t\tif ( renderContext.scissor ) {\n\n\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\tgl.scissor( x, renderContext.height - height - y, width, height );\n\n\t\t}\n\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\t// Get a reference to the array of objects with queries. The renderContextData property\n\t\t\t// can be changed by another render pass before the async reading of all previous queries complete\n\t\t\trenderContextData.currentOcclusionQueries = renderContextData.occlusionQueries;\n\t\t\trenderContextData.currentOcclusionQueryObjects = renderContextData.occlusionQueryObjects;\n\n\t\t\trenderContextData.lastOcclusionObject = null;\n\t\t\trenderContextData.occlusionQueries = new Array( occlusionQueryCount );\n\t\t\trenderContextData.occlusionQueryObjects = new Array( occlusionQueryCount );\n\t\t\trenderContextData.occlusionQueryIndex = 0;\n\n\t\t}\n\n\t}\n\n\tfinishRender( renderContext ) {\n\n\t\tconst { gl, state } = this;\n\t\tconst renderContextData = this.get( renderContext );\n\t\tconst previousContext = renderContextData.previousContext;\n\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\tif ( occlusionQueryCount > renderContextData.occlusionQueryIndex ) {\n\n\t\t\t\tgl.endQuery( gl.ANY_SAMPLES_PASSED );\n\n\t\t\t}\n\n\t\t\tthis.resolveOccludedAsync( renderContext );\n\n\t\t}\n\n\t\tconst textures = renderContext.textures;\n\n\t\tif ( textures !== null ) {\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst texture = textures[ i ];\n\n\t\t\t\tif ( texture.generateMipmaps ) {\n\n\t\t\t\t\tthis.generateMipmaps( texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._currentContext = previousContext;\n\n\t\tif ( renderContext.textures !== null && renderContext.renderTarget ) {\n\n\t\t\tconst renderTargetContextData = this.get( renderContext.renderTarget );\n\n\t\t\tconst { samples } = renderContext.renderTarget;\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tconst fb = renderTargetContextData.framebuffers[ renderContext.getCacheKey() ];\n\n\t\t\t\tconst mask = gl.COLOR_BUFFER_BIT;\n\n\t\t\t\tconst msaaFrameBuffer = renderTargetContextData.msaaFrameBuffer;\n\n\t\t\t\tconst textures = renderContext.textures;\n\n\t\t\t\tstate.bindFramebuffer( gl.READ_FRAMEBUFFER, msaaFrameBuffer );\n\t\t\t\tstate.bindFramebuffer( gl.DRAW_FRAMEBUFFER, fb );\n\n\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\t// TODO Add support for MRT\n\n\t\t\t\t\tif ( renderContext.scissor ) {\n\n\t\t\t\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\t\t\t\tconst viewY = renderContext.height - height - y;\n\n\t\t\t\t\t\tgl.blitFramebuffer( x, viewY, x + width, viewY + height, x, viewY, x + width, viewY + height, mask, gl.NEAREST );\n\t\t\t\t\t\tgl.invalidateSubFramebuffer( gl.READ_FRAMEBUFFER, renderTargetContextData.invalidationArray, x, viewY, width, height );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tgl.blitFramebuffer( 0, 0, renderContext.width, renderContext.height, 0, 0, renderContext.width, renderContext.height, mask, gl.NEAREST );\n\t\t\t\t\t\tgl.invalidateFramebuffer( gl.READ_FRAMEBUFFER, renderTargetContextData.invalidationArray );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\n\t\tif ( previousContext !== null ) {\n\n\t\t\tthis._setFramebuffer( previousContext );\n\n\t\t\tif ( previousContext.viewport ) {\n\n\t\t\t\tthis.updateViewport( previousContext );\n\n\t\t\t} else {\n\n\t\t\t\tgl.viewport( 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.prepareTimestampBuffer( renderContext );\n\n\t}\n\n\tresolveOccludedAsync( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\t// handle occlusion query results\n\n\t\tconst { currentOcclusionQueries, currentOcclusionQueryObjects } = renderContextData;\n\n\t\tif ( currentOcclusionQueries && currentOcclusionQueryObjects ) {\n\n\t\t\tconst occluded = new WeakSet();\n\t\t\tconst { gl } = this;\n\n\t\t\trenderContextData.currentOcclusionQueryObjects = null;\n\t\t\trenderContextData.currentOcclusionQueries = null;\n\n\t\t\tconst check = () => {\n\n\t\t\t\tlet completed = 0;\n\n\t\t\t\t// check all queries and requeue as appropriate\n\t\t\t\tfor ( let i = 0; i < currentOcclusionQueries.length; i ++ ) {\n\n\t\t\t\t\tconst query = currentOcclusionQueries[ i ];\n\n\t\t\t\t\tif ( query === null ) continue;\n\n\t\t\t\t\tif ( gl.getQueryParameter( query, gl.QUERY_RESULT_AVAILABLE ) ) {\n\n\t\t\t\t\t\tif ( gl.getQueryParameter( query, gl.QUERY_RESULT ) > 0 ) occluded.add( currentOcclusionQueryObjects[ i ] );\n\n\t\t\t\t\t\tcurrentOcclusionQueries[ i ] = null;\n\t\t\t\t\t\tgl.deleteQuery( query );\n\n\t\t\t\t\t\tcompleted ++;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( completed < currentOcclusionQueries.length ) {\n\n\t\t\t\t\trequestAnimationFrame( check );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderContextData.occluded = occluded;\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tcheck();\n\n\t\t}\n\n\t}\n\n\tisOccluded( renderContext, object ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\treturn renderContextData.occluded && renderContextData.occluded.has( object );\n\n\t}\n\n\tupdateViewport( renderContext ) {\n\n\t\tconst gl = this.gl;\n\t\tconst { x, y, width, height } = renderContext.viewportValue;\n\n\t\tgl.viewport( x, renderContext.height - height - y, width, height );\n\n\t}\n\n\tsetScissorTest( boolean ) {\n\n\t\tconst gl = this.gl;\n\n\t\tif ( boolean ) {\n\n\t\t\tgl.enable( gl.SCISSOR_TEST );\n\n\t\t} else {\n\n\t\t\tgl.disable( gl.SCISSOR_TEST );\n\n\t\t}\n\n\t}\n\n\tclear( color, depth, stencil, descriptor = null, setFrameBuffer = true ) {\n\n\t\tconst { gl } = this;\n\n\t\tif ( descriptor === null ) {\n\n\t\t\tconst clearColor = this.getClearColor();\n\n\t\t\t// premultiply alpha\n\n\t\t\tclearColor.r *= clearColor.a;\n\t\t\tclearColor.g *= clearColor.a;\n\t\t\tclearColor.b *= clearColor.a;\n\n\t\t\tdescriptor = {\n\t\t\t\ttextures: null,\n\t\t\t\tclearColorValue: clearColor\n\t\t\t};\n\n\t\t}\n\n\t\t//\n\n\t\tlet clear = 0;\n\n\t\tif ( color ) clear |= gl.COLOR_BUFFER_BIT;\n\t\tif ( depth ) clear |= gl.DEPTH_BUFFER_BIT;\n\t\tif ( stencil ) clear |= gl.STENCIL_BUFFER_BIT;\n\n\t\tif ( clear !== 0 ) {\n\n\t\t\tlet clearColor;\n\n\t\t\tif ( descriptor.clearColorValue ) {\n\n\t\t\t\tclearColor = descriptor.clearColorValue;\n\n\t\t\t} else {\n\n\t\t\t\tclearColor = this.getClearColor();\n\n\t\t\t\t// premultiply alpha\n\n\t\t\t\tclearColor.r *= clearColor.a;\n\t\t\t\tclearColor.g *= clearColor.a;\n\t\t\t\tclearColor.b *= clearColor.a;\n\n\t\t\t}\n\n\t\t\tif ( depth ) this.state.setDepthMask( true );\n\n\t\t\tif ( descriptor.textures === null ) {\n\n\t\t\t\tgl.clearColor( clearColor.r, clearColor.g, clearColor.b, clearColor.a );\n\t\t\t\tgl.clear( clear );\n\n\t\t\t} else {\n\n\t\t\t\tif ( setFrameBuffer ) this._setFramebuffer( descriptor );\n\n\t\t\t\tif ( color ) {\n\n\t\t\t\t\tfor ( let i = 0; i < descriptor.textures.length; i ++ ) {\n\n\t\t\t\t\t\tgl.clearBufferfv( gl.COLOR, i, [ clearColor.r, clearColor.g, clearColor.b, clearColor.a ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( depth && stencil ) {\n\n\t\t\t\t\tgl.clearBufferfi( gl.DEPTH_STENCIL, 0, 1, 0 );\n\n\t\t\t\t} else if ( depth ) {\n\n\t\t\t\t\tgl.clearBufferfv( gl.DEPTH, 0, [ 1.0 ] );\n\n\t\t\t\t} else if ( stencil ) {\n\n\t\t\t\t\tgl.clearBufferiv( gl.STENCIL, 0, [ 0 ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tbeginCompute( computeGroup ) {\n\n\t\tconst { state, gl } = this;\n\n\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, null );\n\t\tthis.initTimestampQuery( computeGroup );\n\n\t}\n\n\tcompute( computeGroup, computeNode, bindings, pipeline ) {\n\n\t\tconst { state, gl } = this;\n\n\t\tif ( ! this.discard ) {\n\n\t\t\t// required here to handle async behaviour of render.compute()\n\t\t\tgl.enable( gl.RASTERIZER_DISCARD );\n\t\t\tthis.discard = true;\n\n\t\t}\n\n\t\tconst { programGPU, transformBuffers, attributes } = this.get( pipeline );\n\n\t\tconst vaoKey = this._getVaoKey( null, attributes );\n\n\t\tconst vaoGPU = this.vaoCache[ vaoKey ];\n\n\t\tif ( vaoGPU === undefined ) {\n\n\t\t\tthis._createVao( null, attributes );\n\n\t\t} else {\n\n\t\t\tgl.bindVertexArray( vaoGPU );\n\n\t\t}\n\n\t\tstate.useProgram( programGPU );\n\n\t\tthis._bindUniforms( bindings );\n\n\t\tconst transformFeedbackGPU = this._getTransformFeedback( transformBuffers );\n\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, transformFeedbackGPU );\n\t\tgl.beginTransformFeedback( gl.POINTS );\n\n\t\tif ( attributes[ 0 ].isStorageInstancedBufferAttribute ) {\n\n\t\t\tgl.drawArraysInstanced( gl.POINTS, 0, 1, computeNode.count );\n\n\t\t} else {\n\n\t\t\tgl.drawArrays( gl.POINTS, 0, computeNode.count );\n\n\t\t}\n\n\t\tgl.endTransformFeedback();\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, null );\n\n\t\t// switch active buffers\n\n\t\tfor ( let i = 0; i < transformBuffers.length; i ++ ) {\n\n\t\t\tconst dualAttributeData = transformBuffers[ i ];\n\n\t\t\tif ( dualAttributeData.pbo ) {\n\n\t\t\t\tthis.textureUtils.copyBufferToTexture( dualAttributeData.transformBuffer, dualAttributeData.pbo );\n\n\t\t\t}\n\n\t\t\tdualAttributeData.switchBuffers();\n\n\n\t\t}\n\n\t}\n\n\tfinishCompute( computeGroup ) {\n\n\t\tconst gl = this.gl;\n\n\t\tthis.discard = false;\n\n\t\tgl.disable( gl.RASTERIZER_DISCARD );\n\n\t\tthis.prepareTimestampBuffer( computeGroup );\n\n\t\tif ( this._currentContext ) {\n\n\t\t\tthis._setFramebuffer( this._currentContext );\n\n\t\t}\n\n\t}\n\n\tdraw( renderObject/*, info*/ ) {\n\n\t\tconst { object, pipeline, material, context } = renderObject;\n\t\tconst { programGPU } = this.get( pipeline );\n\n\t\tconst { gl, state } = this;\n\n\t\tconst contextData = this.get( context );\n\n\t\tconst drawParams = renderObject.getDrawParameters();\n\n\t\tif ( drawParams === null ) return;\n\n\t\t//\n\n\t\tthis._bindUniforms( renderObject.getBindings() );\n\n\t\tconst frontFaceCW = ( object.isMesh && object.matrixWorld.determinant() < 0 );\n\n\t\tstate.setMaterial( material, frontFaceCW );\n\n\t\tstate.useProgram( programGPU );\n\n\t\t//\n\n\t\tlet vaoGPU = renderObject.staticVao;\n\n\t\tif ( vaoGPU === undefined ) {\n\n\t\t\tconst vaoKey = this._getVaoKey( renderObject.getIndex(), renderObject.getAttributes() );\n\n\t\t\tvaoGPU = this.vaoCache[ vaoKey ];\n\n\t\t\tif ( vaoGPU === undefined ) {\n\n\t\t\t\tlet staticVao;\n\n\t\t\t\t( { vaoGPU, staticVao } = this._createVao( renderObject.getIndex(), renderObject.getAttributes() ) );\n\n\t\t\t\tif ( staticVao ) renderObject.staticVao = vaoGPU;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.bindVertexArray( vaoGPU );\n\n\t\t//\n\n\t\tconst index = renderObject.getIndex();\n\n\t\t//\n\n\t\tconst lastObject = contextData.lastOcclusionObject;\n\n\t\tif ( lastObject !== object && lastObject !== undefined ) {\n\n\t\t\tif ( lastObject !== null && lastObject.occlusionTest === true ) {\n\n\t\t\t\tgl.endQuery( gl.ANY_SAMPLES_PASSED );\n\n\t\t\t\tcontextData.occlusionQueryIndex ++;\n\n\t\t\t}\n\n\t\t\tif ( object.occlusionTest === true ) {\n\n\t\t\t\tconst query = gl.createQuery();\n\n\t\t\t\tgl.beginQuery( gl.ANY_SAMPLES_PASSED, query );\n\n\t\t\t\tcontextData.occlusionQueries[ contextData.occlusionQueryIndex ] = query;\n\t\t\t\tcontextData.occlusionQueryObjects[ contextData.occlusionQueryIndex ] = object;\n\n\t\t\t}\n\n\t\t\tcontextData.lastOcclusionObject = object;\n\n\t\t}\n\n\t\t//\n\t\tconst renderer = this.bufferRenderer;\n\n\t\tif ( object.isPoints ) renderer.mode = gl.POINTS;\n\t\telse if ( object.isLineSegments ) renderer.mode = gl.LINES;\n\t\telse if ( object.isLine ) renderer.mode = gl.LINE_STRIP;\n\t\telse if ( object.isLineLoop ) renderer.mode = gl.LINE_LOOP;\n\t\telse {\n\n\t\t\tif ( material.wireframe === true ) {\n\n\t\t\t\tstate.setLineWidth( material.wireframeLinewidth * this.renderer.getPixelRatio() );\n\t\t\t\trenderer.mode = gl.LINES;\n\n\t\t\t} else {\n\n\t\t\t\trenderer.mode = gl.TRIANGLES;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst { vertexCount, instanceCount } = drawParams;\n\t\tlet { firstVertex } = drawParams;\n\n\t\trenderer.object = object;\n\n\t\tif ( index !== null ) {\n\n\t\t\tfirstVertex *= index.array.BYTES_PER_ELEMENT;\n\n\t\t\tconst indexData = this.get( index );\n\n\t\t\trenderer.index = index.count;\n\t\t\trenderer.type = indexData.type;\n\n\t\t} else {\n\n\t\t\trenderer.index = 0;\n\n\t\t}\n\n\t\tif ( object.isBatchedMesh ) {\n\n\t\t\tif ( object._multiDrawInstances !== null ) {\n\n\t\t\t\trenderer.renderMultiDrawInstances( object._multiDrawStarts, object._multiDrawCounts, object._multiDrawCount, object._multiDrawInstances );\n\n\t\t\t} else if ( ! this.hasFeature( 'WEBGL_multi_draw' ) ) {\n\n\t\t\t\twarnOnce( 'THREE.WebGLRenderer: WEBGL_multi_draw not supported.' );\n\n\t\t\t} else {\n\n\t\t\t\trenderer.renderMultiDraw( object._multiDrawStarts, object._multiDrawCounts, object._multiDrawCount );\n\n\t\t\t}\n\n\t\t} else if ( instanceCount > 1 ) {\n\n\t\t\trenderer.renderInstances( firstVertex, vertexCount, instanceCount );\n\n\t\t} else {\n\n\t\t\trenderer.render( firstVertex, vertexCount );\n\n\t\t}\n\t\t//\n\n\t\tgl.bindVertexArray( null );\n\n\t}\n\n\tneedsRenderUpdate( /*renderObject*/ ) {\n\n\t\treturn false;\n\n\t}\n\n\tgetRenderCacheKey( /*renderObject*/ ) {\n\n\t\treturn '';\n\n\t}\n\n\t// textures\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tthis.textureUtils.createDefaultTexture( texture );\n\n\t}\n\n\tcreateTexture( texture, options ) {\n\n\t\tthis.textureUtils.createTexture( texture, options );\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tthis.textureUtils.updateTexture( texture, options );\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tthis.textureUtils.generateMipmaps( texture );\n\n\t}\n\n\n\tdestroyTexture( texture ) {\n\n\t\tthis.textureUtils.destroyTexture( texture );\n\n\t}\n\n\tcopyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\treturn this.textureUtils.copyTextureToBuffer( texture, x, y, width, height, faceIndex );\n\n\t}\n\n\tcreateSampler( /*texture*/ ) {\n\n\t\t//console.warn( 'Abstract class.' );\n\n\t}\n\n\tdestroySampler() {}\n\n\t// node builder\n\n\tcreateNodeBuilder( object, renderer ) {\n\n\t\treturn new GLSLNodeBuilder( object, renderer );\n\n\t}\n\n\t// program\n\n\tcreateProgram( program ) {\n\n\t\tconst gl = this.gl;\n\t\tconst { stage, code } = program;\n\n\t\tconst shader = stage === 'fragment' ? gl.createShader( gl.FRAGMENT_SHADER ) : gl.createShader( gl.VERTEX_SHADER );\n\n\t\tgl.shaderSource( shader, code );\n\t\tgl.compileShader( shader );\n\n\t\tthis.set( program, {\n\t\t\tshaderGPU: shader\n\t\t} );\n\n\t}\n\n\tdestroyProgram( /*program*/ ) {\n\n\t\tconsole.warn( 'Abstract class.' );\n\n\t}\n\n\tcreateRenderPipeline( renderObject, promises ) {\n\n\t\tconst gl = this.gl;\n\t\tconst pipeline = renderObject.pipeline;\n\n\t\t// Program\n\n\t\tconst { fragmentProgram, vertexProgram } = pipeline;\n\n\t\tconst programGPU = gl.createProgram();\n\n\t\tconst fragmentShader = this.get( fragmentProgram ).shaderGPU;\n\t\tconst vertexShader = this.get( vertexProgram ).shaderGPU;\n\n\t\tgl.attachShader( programGPU, fragmentShader );\n\t\tgl.attachShader( programGPU, vertexShader );\n\t\tgl.linkProgram( programGPU );\n\n\t\tthis.set( pipeline, {\n\t\t\tprogramGPU,\n\t\t\tfragmentShader,\n\t\t\tvertexShader\n\t\t} );\n\n\t\tif ( promises !== null && this.parallel ) {\n\n\t\t\tconst p = new Promise( ( resolve /*, reject*/ ) => {\n\n\t\t\t\tconst parallel = this.parallel;\n\t\t\t\tconst checkStatus = () => {\n\n\t\t\t\t\tif ( gl.getProgramParameter( programGPU, parallel.COMPLETION_STATUS_KHR ) ) {\n\n\t\t\t\t\t\tthis._completeCompile( renderObject, pipeline );\n\t\t\t\t\t\tresolve();\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trequestAnimationFrame( checkStatus );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tcheckStatus();\n\n\t\t\t} );\n\n\t\t\tpromises.push( p );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._completeCompile( renderObject, pipeline );\n\n\t}\n\n\t_handleSource( string, errorLine ) {\n\n\t\tconst lines = string.split( '\\n' );\n\t\tconst lines2 = [];\n\n\t\tconst from = Math.max( errorLine - 6, 0 );\n\t\tconst to = Math.min( errorLine + 6, lines.length );\n\n\t\tfor ( let i = from; i < to; i ++ ) {\n\n\t\t\tconst line = i + 1;\n\t\t\tlines2.push( `${line === errorLine ? '>' : ' '} ${line}: ${lines[ i ]}` );\n\n\t\t}\n\n\t\treturn lines2.join( '\\n' );\n\n\t}\n\n\t_getShaderErrors( gl, shader, type ) {\n\n\t\tconst status = gl.getShaderParameter( shader, gl.COMPILE_STATUS );\n\t\tconst errors = gl.getShaderInfoLog( shader ).trim();\n\n\t\tif ( status && errors === '' ) return '';\n\n\t\tconst errorMatches = /ERROR: 0:(\\d+)/.exec( errors );\n\t\tif ( errorMatches ) {\n\n\t\t\tconst errorLine = parseInt( errorMatches[ 1 ] );\n\t\t\treturn type.toUpperCase() + '\\n\\n' + errors + '\\n\\n' + this._handleSource( gl.getShaderSource( shader ), errorLine );\n\n\t\t} else {\n\n\t\t\treturn errors;\n\n\t\t}\n\n\t}\n\n\t_logProgramError( programGPU, glFragmentShader, glVertexShader ) {\n\n\t\tif ( this.renderer.debug.checkShaderErrors ) {\n\n\t\t\tconst gl = this.gl;\n\n\t\t\tconst programLog = gl.getProgramInfoLog( programGPU ).trim();\n\n\t\t\tif ( gl.getProgramParameter( programGPU, gl.LINK_STATUS ) === false ) {\n\n\n\t\t\t\tif ( typeof this.renderer.debug.onShaderError === 'function' ) {\n\n\t\t\t\t\tthis.renderer.debug.onShaderError( gl, programGPU, glVertexShader, glFragmentShader );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// default error reporting\n\n\t\t\t\t\tconst vertexErrors = this._getShaderErrors( gl, glVertexShader, 'vertex' );\n\t\t\t\t\tconst fragmentErrors = this._getShaderErrors( gl, glFragmentShader, 'fragment' );\n\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t'THREE.WebGLProgram: Shader Error ' + gl.getError() + ' - ' +\n\t\t\t\t\t\t'VALIDATE_STATUS ' + gl.getProgramParameter( programGPU, gl.VALIDATE_STATUS ) + '\\n\\n' +\n\t\t\t\t\t\t'Program Info Log: ' + programLog + '\\n' +\n\t\t\t\t\t\tvertexErrors + '\\n' +\n\t\t\t\t\t\tfragmentErrors\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t} else if ( programLog !== '' ) {\n\n\t\t\t\tconsole.warn( 'THREE.WebGLProgram: Program Info Log:', programLog );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_completeCompile( renderObject, pipeline ) {\n\n\t\tconst { state, gl } = this;\n\t\tconst pipelineData = this.get( pipeline );\n\t\tconst { programGPU, fragmentShader, vertexShader } = pipelineData;\n\n\t\tif ( gl.getProgramParameter( programGPU, gl.LINK_STATUS ) === false ) {\n\n\t\t\tthis._logProgramError( programGPU, fragmentShader, vertexShader );\n\n\t\t}\n\n\t\tstate.useProgram( programGPU );\n\n\t\t// Bindings\n\n\t\tconst bindings = renderObject.getBindings();\n\n\t\tthis._setupBindings( bindings, programGPU );\n\n\t\t//\n\n\t\tthis.set( pipeline, {\n\t\t\tprogramGPU\n\t\t} );\n\n\t}\n\n\tcreateComputePipeline( computePipeline, bindings ) {\n\n\t\tconst { state, gl } = this;\n\n\t\t// Program\n\n\t\tconst fragmentProgram = {\n\t\t\tstage: 'fragment',\n\t\t\tcode: '#version 300 es\\nprecision highp float;\\nvoid main() {}'\n\t\t};\n\n\t\tthis.createProgram( fragmentProgram );\n\n\t\tconst { computeProgram } = computePipeline;\n\n\t\tconst programGPU = gl.createProgram();\n\n\t\tconst fragmentShader = this.get( fragmentProgram ).shaderGPU;\n\t\tconst vertexShader = this.get( computeProgram ).shaderGPU;\n\n\t\tconst transforms = computeProgram.transforms;\n\n\t\tconst transformVaryingNames = [];\n\t\tconst transformAttributeNodes = [];\n\n\t\tfor ( let i = 0; i < transforms.length; i ++ ) {\n\n\t\t\tconst transform = transforms[ i ];\n\n\t\t\ttransformVaryingNames.push( transform.varyingName );\n\t\t\ttransformAttributeNodes.push( transform.attributeNode );\n\n\t\t}\n\n\t\tgl.attachShader( programGPU, fragmentShader );\n\t\tgl.attachShader( programGPU, vertexShader );\n\n\t\tgl.transformFeedbackVaryings(\n\t\t\tprogramGPU,\n\t\t\ttransformVaryingNames,\n\t\t\tgl.SEPARATE_ATTRIBS\n\t\t);\n\n\t\tgl.linkProgram( programGPU );\n\n\t\tif ( gl.getProgramParameter( programGPU, gl.LINK_STATUS ) === false ) {\n\n\t\t\tthis._logProgramError( programGPU, fragmentShader, vertexShader );\n\n\n\t\t}\n\n\t\tstate.useProgram( programGPU );\n\n\t\t// Bindings\n\n\t\tthis._setupBindings( bindings, programGPU );\n\n\t\tconst attributeNodes = computeProgram.attributes;\n\t\tconst attributes = [];\n\t\tconst transformBuffers = [];\n\n\t\tfor ( let i = 0; i < attributeNodes.length; i ++ ) {\n\n\t\t\tconst attribute = attributeNodes[ i ].node.attribute;\n\n\t\t\tattributes.push( attribute );\n\n\t\t\tif ( ! this.has( attribute ) ) this.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < transformAttributeNodes.length; i ++ ) {\n\n\t\t\tconst attribute = transformAttributeNodes[ i ].attribute;\n\n\t\t\tif ( ! this.has( attribute ) ) this.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t\t\tconst attributeData = this.get( attribute );\n\n\t\t\ttransformBuffers.push( attributeData );\n\n\t\t}\n\n\t\t//\n\n\t\tthis.set( computePipeline, {\n\t\t\tprogramGPU,\n\t\t\ttransformBuffers,\n\t\t\tattributes\n\t\t} );\n\n\t}\n\n\tcreateBindings( bindGroup, bindings ) {\n\n\t\tif ( this._knownBindings.has( bindings ) === false ) {\n\n\t\t\tthis._knownBindings.add( bindings );\n\n\t\t\tlet uniformBuffers = 0;\n\t\t\tlet textures = 0;\n\n\t\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\t\tthis.set( bindGroup, {\n\t\t\t\t\ttextures: textures,\n\t\t\t\t\tuniformBuffers: uniformBuffers\n\t\t\t\t} );\n\n\t\t\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\t\t\tif ( binding.isUniformBuffer ) uniformBuffers ++;\n\t\t\t\t\tif ( binding.isSampledTexture ) textures ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.updateBindings( bindGroup, bindings );\n\n\t}\n\n\tupdateBindings( bindGroup /*, bindings*/ ) {\n\n\t\tconst { gl } = this;\n\n\t\tconst bindGroupData = this.get( bindGroup );\n\n\t\tlet i = bindGroupData.uniformBuffers;\n\t\tlet t = bindGroupData.textures;\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\t\tconst data = binding.buffer;\n\t\t\t\tconst bufferGPU = gl.createBuffer();\n\n\t\t\t\tgl.bindBuffer( gl.UNIFORM_BUFFER, bufferGPU );\n\t\t\t\tgl.bufferData( gl.UNIFORM_BUFFER, data, gl.DYNAMIC_DRAW );\n\n\t\t\t\tthis.set( binding, {\n\t\t\t\t\tindex: i ++,\n\t\t\t\t\tbufferGPU\n\t\t\t\t} );\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst { textureGPU, glTextureType } = this.get( binding.texture );\n\n\t\t\t\tthis.set( binding, {\n\t\t\t\t\tindex: t ++,\n\t\t\t\t\ttextureGPU,\n\t\t\t\t\tglTextureType\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tupdateBinding( binding ) {\n\n\t\tconst gl = this.gl;\n\n\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\tconst bindingData = this.get( binding );\n\t\t\tconst bufferGPU = bindingData.bufferGPU;\n\t\t\tconst data = binding.buffer;\n\n\t\t\tgl.bindBuffer( gl.UNIFORM_BUFFER, bufferGPU );\n\t\t\tgl.bufferData( gl.UNIFORM_BUFFER, data, gl.DYNAMIC_DRAW );\n\n\t\t}\n\n\t}\n\n\t// attributes\n\n\tcreateIndexAttribute( attribute ) {\n\n\t\tconst gl = this.gl;\n\n\t\tthis.attributeUtils.createAttribute( attribute, gl.ELEMENT_ARRAY_BUFFER );\n\n\t}\n\n\tcreateAttribute( attribute ) {\n\n\t\tif ( this.has( attribute ) ) return;\n\n\t\tconst gl = this.gl;\n\n\t\tthis.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t}\n\n\tcreateStorageAttribute( attribute ) {\n\n\t\tif ( this.has( attribute ) ) return;\n\n\t\tconst gl = this.gl;\n\n\t\tthis.attributeUtils.createAttribute( attribute, gl.ARRAY_BUFFER );\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tthis.attributeUtils.updateAttribute( attribute );\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tthis.attributeUtils.destroyAttribute( attribute );\n\n\t}\n\n\tupdateSize() {\n\n\t\t//console.warn( 'Abstract class.' );\n\n\t}\n\n\thasFeature( name ) {\n\n\t\tconst keysMatching = Object.keys( GLFeatureName ).filter( key => GLFeatureName[ key ] === name );\n\n\t\tconst extensions = this.extensions;\n\n\t\tfor ( let i = 0; i < keysMatching.length; i ++ ) {\n\n\t\t\tif ( extensions.has( keysMatching[ i ] ) ) return true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tgetMaxAnisotropy() {\n\n\t\treturn this.capabilities.getMaxAnisotropy();\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion, dstPosition, level ) {\n\n\t\tthis.textureUtils.copyTextureToTexture( srcTexture, dstTexture, srcRegion, dstPosition, level );\n\n\t}\n\n\tcopyFramebufferToTexture( texture, renderContext, rectangle ) {\n\n\t\tthis.textureUtils.copyFramebufferToTexture( texture, renderContext, rectangle );\n\n\t}\n\n\t_setFramebuffer( descriptor ) {\n\n\t\tconst { gl, state } = this;\n\n\t\tlet currentFrameBuffer = null;\n\n\t\tif ( descriptor.textures !== null ) {\n\n\t\t\tconst renderTarget = descriptor.renderTarget;\n\t\t\tconst renderTargetContextData = this.get( renderTarget );\n\t\t\tconst { samples, depthBuffer, stencilBuffer } = renderTarget;\n\n\t\t\tconst isCube = renderTarget.isWebGLCubeRenderTarget === true;\n\n\t\t\tlet msaaFb = renderTargetContextData.msaaFrameBuffer;\n\t\t\tlet depthRenderbuffer = renderTargetContextData.depthRenderbuffer;\n\n\t\t\tconst cacheKey = getCacheKey( descriptor );\n\n\t\t\tlet fb;\n\n\t\t\tif ( isCube ) {\n\n\t\t\t\trenderTargetContextData.cubeFramebuffers || ( renderTargetContextData.cubeFramebuffers = {} );\n\n\t\t\t\tfb = renderTargetContextData.cubeFramebuffers[ cacheKey ];\n\n\t\t\t} else {\n\n\t\t\t\trenderTargetContextData.framebuffers || ( renderTargetContextData.framebuffers = {} );\n\n\t\t\t\tfb = renderTargetContextData.framebuffers[ cacheKey ];\n\n\t\t\t}\n\n\t\t\tif ( fb === undefined ) {\n\n\t\t\t\tfb = gl.createFramebuffer();\n\n\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, fb );\n\n\t\t\t\tconst textures = descriptor.textures;\n\n\t\t\t\tif ( isCube ) {\n\n\t\t\t\t\trenderTargetContextData.cubeFramebuffers[ cacheKey ] = fb;\n\n\t\t\t\t\tconst { textureGPU } = this.get( textures[ 0 ] );\n\n\t\t\t\t\tconst cubeFace = this.renderer._activeCubeFace;\n\n\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_CUBE_MAP_POSITIVE_X + cubeFace, textureGPU, 0 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\trenderTargetContextData.framebuffers[ cacheKey ] = fb;\n\n\t\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\t\tconst texture = textures[ i ];\n\t\t\t\t\t\tconst textureData = this.get( texture );\n\t\t\t\t\t\ttextureData.renderTarget = descriptor.renderTarget;\n\t\t\t\t\t\ttextureData.cacheKey = cacheKey; // required for copyTextureToTexture()\n\n\t\t\t\t\t\tconst attachment = gl.COLOR_ATTACHMENT0 + i;\n\n\t\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, attachment, gl.TEXTURE_2D, textureData.textureGPU, 0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.drawBuffers( descriptor, fb );\n\n\t\t\t\t}\n\n\t\t\t\tif ( descriptor.depthTexture !== null ) {\n\n\t\t\t\t\tconst textureData = this.get( descriptor.depthTexture );\n\t\t\t\t\tconst depthStyle = stencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\ttextureData.renderTarget = descriptor.renderTarget;\n\t\t\t\t\ttextureData.cacheKey = cacheKey; // required for copyTextureToTexture()\n\n\t\t\t\t\tgl.framebufferTexture2D( gl.FRAMEBUFFER, depthStyle, gl.TEXTURE_2D, textureData.textureGPU, 0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( samples > 0 ) {\n\n\t\t\t\tif ( msaaFb === undefined ) {\n\n\t\t\t\t\tconst invalidationArray = [];\n\n\t\t\t\t\tmsaaFb = gl.createFramebuffer();\n\n\t\t\t\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, msaaFb );\n\n\t\t\t\t\tconst msaaRenderbuffers = [];\n\n\t\t\t\t\tconst textures = descriptor.textures;\n\n\t\t\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\t\t\tmsaaRenderbuffers[ i ] = gl.createRenderbuffer();\n\n\t\t\t\t\t\tgl.bindRenderbuffer( gl.RENDERBUFFER, msaaRenderbuffers[ i ] );\n\n\t\t\t\t\t\tinvalidationArray.push( gl.COLOR_ATTACHMENT0 + i );\n\n\t\t\t\t\t\tif ( depthBuffer ) {\n\n\t\t\t\t\t\t\tconst depthStyle = stencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\t\t\tinvalidationArray.push( depthStyle );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst texture = descriptor.textures[ i ];\n\t\t\t\t\t\tconst textureData = this.get( texture );\n\n\t\t\t\t\t\tgl.renderbufferStorageMultisample( gl.RENDERBUFFER, samples, textureData.glInternalFormat, descriptor.width, descriptor.height );\n\t\t\t\t\t\tgl.framebufferRenderbuffer( gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + i, gl.RENDERBUFFER, msaaRenderbuffers[ i ] );\n\n\n\t\t\t\t\t}\n\n\t\t\t\t\trenderTargetContextData.msaaFrameBuffer = msaaFb;\n\t\t\t\t\trenderTargetContextData.msaaRenderbuffers = msaaRenderbuffers;\n\n\t\t\t\t\tif ( depthRenderbuffer === undefined ) {\n\n\t\t\t\t\t\tdepthRenderbuffer = gl.createRenderbuffer();\n\t\t\t\t\t\tthis.textureUtils.setupRenderBufferStorage( depthRenderbuffer, descriptor );\n\n\t\t\t\t\t\trenderTargetContextData.depthRenderbuffer = depthRenderbuffer;\n\n\t\t\t\t\t\tconst depthStyle = stencilBuffer ? gl.DEPTH_STENCIL_ATTACHMENT : gl.DEPTH_ATTACHMENT;\n\t\t\t\t\t\tinvalidationArray.push( depthStyle );\n\n\t\t\t\t\t}\n\n\t\t\t\t\trenderTargetContextData.invalidationArray = invalidationArray;\n\n\t\t\t\t}\n\n\t\t\t\tcurrentFrameBuffer = renderTargetContextData.msaaFrameBuffer;\n\n\t\t\t} else {\n\n\t\t\t\tcurrentFrameBuffer = fb;\n\n\t\t\t}\n\n\t\t}\n\n\t\tstate.bindFramebuffer( gl.FRAMEBUFFER, currentFrameBuffer );\n\n\t}\n\n\n\t_getVaoKey( index, attributes ) {\n\n\t\tlet key = [];\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst indexData = this.get( index );\n\n\t\t\tkey += ':' + indexData.id;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < attributes.length; i ++ ) {\n\n\t\t\tconst attributeData = this.get( attributes[ i ] );\n\n\t\t\tkey += ':' + attributeData.id;\n\n\t\t}\n\n\t\treturn key;\n\n\t}\n\n\t_createVao( index, attributes ) {\n\n\t\tconst { gl } = this;\n\n\t\tconst vaoGPU = gl.createVertexArray();\n\t\tlet key = '';\n\n\t\tlet staticVao = true;\n\n\t\tgl.bindVertexArray( vaoGPU );\n\n\t\tif ( index !== null ) {\n\n\t\t\tconst indexData = this.get( index );\n\n\t\t\tgl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, indexData.bufferGPU );\n\n\t\t\tkey += ':' + indexData.id;\n\n\t\t}\n\n\t\tfor ( let i = 0; i < attributes.length; i ++ ) {\n\n\t\t\tconst attribute = attributes[ i ];\n\t\t\tconst attributeData = this.get( attribute );\n\n\t\t\tkey += ':' + attributeData.id;\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, attributeData.bufferGPU );\n\t\t\tgl.enableVertexAttribArray( i );\n\n\t\t\tif ( attribute.isStorageBufferAttribute || attribute.isStorageInstancedBufferAttribute ) staticVao = false;\n\n\t\t\tlet stride, offset;\n\n\t\t\tif ( attribute.isInterleavedBufferAttribute === true ) {\n\n\t\t\t\tstride = attribute.data.stride * attributeData.bytesPerElement;\n\t\t\t\toffset = attribute.offset * attributeData.bytesPerElement;\n\n\t\t\t} else {\n\n\t\t\t\tstride = 0;\n\t\t\t\toffset = 0;\n\n\t\t\t}\n\n\t\t\tif ( attributeData.isInteger ) {\n\n\t\t\t\tgl.vertexAttribIPointer( i, attribute.itemSize, attributeData.type, stride, offset );\n\n\t\t\t} else {\n\n\t\t\t\tgl.vertexAttribPointer( i, attribute.itemSize, attributeData.type, attribute.normalized, stride, offset );\n\n\t\t\t}\n\n\t\t\tif ( attribute.isInstancedBufferAttribute && ! attribute.isInterleavedBufferAttribute ) {\n\n\t\t\t\tgl.vertexAttribDivisor( i, attribute.meshPerAttribute );\n\n\t\t\t} else if ( attribute.isInterleavedBufferAttribute && attribute.data.isInstancedInterleavedBuffer ) {\n\n\t\t\t\tgl.vertexAttribDivisor( i, attribute.data.meshPerAttribute );\n\n\t\t\t}\n\n\t\t}\n\n\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\n\t\tthis.vaoCache[ key ] = vaoGPU;\n\n\t\treturn { vaoGPU, staticVao };\n\n\t}\n\n\t_getTransformFeedback( transformBuffers ) {\n\n\t\tlet key = '';\n\n\t\tfor ( let i = 0; i < transformBuffers.length; i ++ ) {\n\n\t\t\tkey += ':' + transformBuffers[ i ].id;\n\n\t\t}\n\n\t\tlet transformFeedbackGPU = this.transformFeedbackCache[ key ];\n\n\t\tif ( transformFeedbackGPU !== undefined ) {\n\n\t\t\treturn transformFeedbackGPU;\n\n\t\t}\n\n\t\tconst { gl } = this;\n\n\t\ttransformFeedbackGPU = gl.createTransformFeedback();\n\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, transformFeedbackGPU );\n\n\t\tfor ( let i = 0; i < transformBuffers.length; i ++ ) {\n\n\t\t\tconst attributeData = transformBuffers[ i ];\n\n\t\t\tgl.bindBufferBase( gl.TRANSFORM_FEEDBACK_BUFFER, i, attributeData.transformBuffer );\n\n\t\t}\n\n\t\tgl.bindTransformFeedback( gl.TRANSFORM_FEEDBACK, null );\n\n\t\tthis.transformFeedbackCache[ key ] = transformFeedbackGPU;\n\n\t\treturn transformFeedbackGPU;\n\n\t}\n\n\n\t_setupBindings( bindings, programGPU ) {\n\n\t\tconst gl = this.gl;\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\t\tconst bindingData = this.get( binding );\n\t\t\t\tconst index = bindingData.index;\n\n\t\t\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\t\t\tconst location = gl.getUniformBlockIndex( programGPU, binding.name );\n\t\t\t\t\tgl.uniformBlockBinding( programGPU, location, index );\n\n\t\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\t\tconst location = gl.getUniformLocation( programGPU, binding.name );\n\t\t\t\t\tgl.uniform1i( location, index );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_bindUniforms( bindings ) {\n\n\t\tconst { gl, state } = this;\n\n\t\tfor ( const bindGroup of bindings ) {\n\n\t\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\t\tconst bindingData = this.get( binding );\n\t\t\t\tconst index = bindingData.index;\n\n\t\t\t\tif ( binding.isUniformsGroup || binding.isUniformBuffer ) {\n\n\t\t\t\t\t// TODO USE bindBufferRange to group multiple uniform buffers\n\t\t\t\t\tstate.bindBufferBase( gl.UNIFORM_BUFFER, index, bindingData.bufferGPU );\n\n\t\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\t\tstate.bindTexture( bindingData.glTextureType, bindingData.textureGPU, gl.TEXTURE0 + index );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tdispose() {\n\n\t\tthis.renderer.domElement.removeEventListener( 'webglcontextlost', this._onContextLost );\n\n\t}\n\n}\n\nclass Sampler extends Binding {\n\n\tconstructor( name, texture ) {\n\n\t\tsuper( name );\n\n\t\tthis.texture = texture;\n\t\tthis.version = texture ? texture.version : 0;\n\n\t\tthis.isSampler = true;\n\n\t}\n\n}\n\nclass NodeSampler extends Sampler {\n\n\tconstructor( name, textureNode, groupNode ) {\n\n\t\tsuper( name, textureNode ? textureNode.value : null );\n\n\t\tthis.textureNode = textureNode;\n\t\tthis.groupNode = groupNode;\n\n\t}\n\n\tupdate() {\n\n\t\tthis.texture = this.textureNode.value;\n\n\t}\n\n}\n\nclass StorageBuffer extends Buffer {\n\n\tconstructor( name, attribute ) {\n\n\t\tsuper( name, attribute ? attribute.array : null );\n\n\t\tthis.attribute = attribute;\n\n\t\tthis.isStorageBuffer = true;\n\n\t}\n\n}\n\nlet _id = 0;\n\nclass NodeStorageBuffer extends StorageBuffer {\n\n\tconstructor( nodeUniform, groupNode ) {\n\n\t\tsuper( 'StorageBuffer_' + _id ++, nodeUniform ? nodeUniform.value : null );\n\n\t\tthis.nodeUniform = nodeUniform;\n\t\tthis.access = nodeUniform ? nodeUniform.access : GPUBufferBindingType.Storage;\n\t\tthis.groupNode = groupNode;\n\n\n\t}\n\n\tget buffer() {\n\n\t\treturn this.nodeUniform.value;\n\n\t}\n\n}\n\nclass WebGPUTexturePassUtils extends DataMap {\n\n\tconstructor( device ) {\n\n\t\tsuper();\n\n\t\tthis.device = device;\n\n\t\tconst mipmapVertexSource = `\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n`;\n\n\t\tconst mipmapFragmentSource = `\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n`;\n\n\t\tconst flipYFragmentSource = `\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n`;\n\t\tthis.mipmapSampler = device.createSampler( { minFilter: GPUFilterMode.Linear } );\n\t\tthis.flipYSampler = device.createSampler( { minFilter: GPUFilterMode.Nearest } ); //@TODO?: Consider using textureLoad()\n\n\t\t// We'll need a new pipeline for every texture format used.\n\t\tthis.transferPipelines = {};\n\t\tthis.flipYPipelines = {};\n\n\t\tthis.mipmapVertexShaderModule = device.createShaderModule( {\n\t\t\tlabel: 'mipmapVertex',\n\t\t\tcode: mipmapVertexSource\n\t\t} );\n\n\t\tthis.mipmapFragmentShaderModule = device.createShaderModule( {\n\t\t\tlabel: 'mipmapFragment',\n\t\t\tcode: mipmapFragmentSource\n\t\t} );\n\n\t\tthis.flipYFragmentShaderModule = device.createShaderModule( {\n\t\t\tlabel: 'flipYFragment',\n\t\t\tcode: flipYFragmentSource\n\t\t} );\n\n\t}\n\n\tgetTransferPipeline( format ) {\n\n\t\tlet pipeline = this.transferPipelines[ format ];\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = this.device.createRenderPipeline( {\n\t\t\t\tlabel: `mipmap-${ format }`,\n\t\t\t\tvertex: {\n\t\t\t\t\tmodule: this.mipmapVertexShaderModule,\n\t\t\t\t\tentryPoint: 'main'\n\t\t\t\t},\n\t\t\t\tfragment: {\n\t\t\t\t\tmodule: this.mipmapFragmentShaderModule,\n\t\t\t\t\tentryPoint: 'main',\n\t\t\t\t\ttargets: [ { format } ]\n\t\t\t\t},\n\t\t\t\tprimitive: {\n\t\t\t\t\ttopology: GPUPrimitiveTopology.TriangleStrip,\n\t\t\t\t\tstripIndexFormat: GPUIndexFormat.Uint32\n\t\t\t\t},\n\t\t\t\tlayout: 'auto'\n\t\t\t} );\n\n\t\t\tthis.transferPipelines[ format ] = pipeline;\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\tgetFlipYPipeline( format ) {\n\n\t\tlet pipeline = this.flipYPipelines[ format ];\n\n\t\tif ( pipeline === undefined ) {\n\n\t\t\tpipeline = this.device.createRenderPipeline( {\n\t\t\t\tlabel: `flipY-${ format }`,\n\t\t\t\tvertex: {\n\t\t\t\t\tmodule: this.mipmapVertexShaderModule,\n\t\t\t\t\tentryPoint: 'main'\n\t\t\t\t},\n\t\t\t\tfragment: {\n\t\t\t\t\tmodule: this.flipYFragmentShaderModule,\n\t\t\t\t\tentryPoint: 'main',\n\t\t\t\t\ttargets: [ { format } ]\n\t\t\t\t},\n\t\t\t\tprimitive: {\n\t\t\t\t\ttopology: GPUPrimitiveTopology.TriangleStrip,\n\t\t\t\t\tstripIndexFormat: GPUIndexFormat.Uint32\n\t\t\t\t},\n\t\t\t\tlayout: 'auto'\n\t\t\t} );\n\n\t\t\tthis.flipYPipelines[ format ] = pipeline;\n\n\t\t}\n\n\t\treturn pipeline;\n\n\t}\n\n\tflipY( textureGPU, textureGPUDescriptor, baseArrayLayer = 0 ) {\n\n\t\tconst format = textureGPUDescriptor.format;\n\t\tconst { width, height } = textureGPUDescriptor.size;\n\n\t\tconst transferPipeline = this.getTransferPipeline( format );\n\t\tconst flipYPipeline = this.getFlipYPipeline( format );\n\n\t\tconst tempTexture = this.device.createTexture( {\n\t\t\tsize: { width, height, depthOrArrayLayers: 1 },\n\t\t\tformat,\n\t\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.TEXTURE_BINDING\n\t\t} );\n\n\t\tconst srcView = textureGPU.createView( {\n\t\t\tbaseMipLevel: 0,\n\t\t\tmipLevelCount: 1,\n\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\tbaseArrayLayer\n\t\t} );\n\n\t\tconst dstView = tempTexture.createView( {\n\t\t\tbaseMipLevel: 0,\n\t\t\tmipLevelCount: 1,\n\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\tbaseArrayLayer: 0\n\t\t} );\n\n\t\tconst commandEncoder = this.device.createCommandEncoder( {} );\n\n\t\tconst pass = ( pipeline, sourceView, destinationView ) => {\n\n\t\t\tconst bindGroupLayout = pipeline.getBindGroupLayout( 0 ); // @TODO: Consider making this static.\n\n\t\t\tconst bindGroup = this.device.createBindGroup( {\n\t\t\t\tlayout: bindGroupLayout,\n\t\t\t\tentries: [ {\n\t\t\t\t\tbinding: 0,\n\t\t\t\t\tresource: this.flipYSampler\n\t\t\t\t}, {\n\t\t\t\t\tbinding: 1,\n\t\t\t\t\tresource: sourceView\n\t\t\t\t} ]\n\t\t\t} );\n\n\t\t\tconst passEncoder = commandEncoder.beginRenderPass( {\n\t\t\t\tcolorAttachments: [ {\n\t\t\t\t\tview: destinationView,\n\t\t\t\t\tloadOp: GPULoadOp.Clear,\n\t\t\t\t\tstoreOp: GPUStoreOp.Store,\n\t\t\t\t\tclearValue: [ 0, 0, 0, 0 ]\n\t\t\t\t} ]\n\t\t\t} );\n\n\t\t\tpassEncoder.setPipeline( pipeline );\n\t\t\tpassEncoder.setBindGroup( 0, bindGroup );\n\t\t\tpassEncoder.draw( 4, 1, 0, 0 );\n\t\t\tpassEncoder.end();\n\n\t\t};\n\n\t\tpass( transferPipeline, srcView, dstView );\n\t\tpass( flipYPipeline, dstView, srcView );\n\n\t\tthis.device.queue.submit( [ commandEncoder.finish() ] );\n\n\t\ttempTexture.destroy();\n\n\t}\n\n\tgenerateMipmaps( textureGPU, textureGPUDescriptor, baseArrayLayer = 0 ) {\n\n\t\tconst textureData = this.get( textureGPU );\n\n\t\tif ( textureData.useCount === undefined ) {\n\n\t\t\ttextureData.useCount = 0;\n\t\t\ttextureData.layers = [];\n\n\t\t}\n\n\t\tconst passes = textureData.layers[ baseArrayLayer ] || this._mipmapCreateBundles( textureGPU, textureGPUDescriptor, baseArrayLayer );\n\n\t\tconst commandEncoder = this.device.createCommandEncoder( {} );\n\n\t\tthis._mipmapRunBundles( commandEncoder, passes );\n\n\t\tthis.device.queue.submit( [ commandEncoder.finish() ] );\n\n\t\tif ( textureData.useCount !== 0 ) textureData.layers[ baseArrayLayer ] = passes;\n\n\t\ttextureData.useCount ++;\n\n\t}\n\n\t_mipmapCreateBundles( textureGPU, textureGPUDescriptor, baseArrayLayer ) {\n\n\t\tconst pipeline = this.getTransferPipeline( textureGPUDescriptor.format );\n\n\t\tconst bindGroupLayout = pipeline.getBindGroupLayout( 0 ); // @TODO: Consider making this static.\n\n\t\tlet srcView = textureGPU.createView( {\n\t\t\tbaseMipLevel: 0,\n\t\t\tmipLevelCount: 1,\n\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\tbaseArrayLayer\n\t\t} );\n\n\t\tconst passes = [];\n\n\t\tfor ( let i = 1; i < textureGPUDescriptor.mipLevelCount; i ++ ) {\n\n\t\t\tconst bindGroup = this.device.createBindGroup( {\n\t\t\t\tlayout: bindGroupLayout,\n\t\t\t\tentries: [ {\n\t\t\t\t\tbinding: 0,\n\t\t\t\t\tresource: this.mipmapSampler\n\t\t\t\t}, {\n\t\t\t\t\tbinding: 1,\n\t\t\t\t\tresource: srcView\n\t\t\t\t} ]\n\t\t\t} );\n\n\t\t\tconst dstView = textureGPU.createView( {\n\t\t\t\tbaseMipLevel: i,\n\t\t\t\tmipLevelCount: 1,\n\t\t\t\tdimension: GPUTextureViewDimension.TwoD,\n\t\t\t\tbaseArrayLayer\n\t\t\t} );\n\n\t\t\tconst passDescriptor = {\n\t\t\t\tcolorAttachments: [ {\n\t\t\t\t\tview: dstView,\n\t\t\t\t\tloadOp: GPULoadOp.Clear,\n\t\t\t\t\tstoreOp: GPUStoreOp.Store,\n\t\t\t\t\tclearValue: [ 0, 0, 0, 0 ]\n\t\t\t\t} ]\n\t\t\t};\n\n\t\t\tconst passEncoder = this.device.createRenderBundleEncoder( {\n\t\t\t\tcolorFormats: [ textureGPUDescriptor.format ]\n\t\t\t} );\n\n\t\t\tpassEncoder.setPipeline( pipeline );\n\t\t\tpassEncoder.setBindGroup( 0, bindGroup );\n\t\t\tpassEncoder.draw( 4, 1, 0, 0 );\n\n\t\t\tpasses.push( {\n\t\t\t\trenderBundles: [ passEncoder.finish() ],\n\t\t\t\tpassDescriptor\n\t\t\t} );\n\n\t\t\tsrcView = dstView;\n\n\t\t}\n\n\t\treturn passes;\n\n\t}\n\n\t_mipmapRunBundles( commandEncoder, passes ) {\n\n\t\tconst levels = passes.length;\n\n\t\tfor ( let i = 0; i < levels; i ++ ) {\n\n\t\t\tconst pass = passes[ i ];\n\n\t\t\tconst passEncoder = commandEncoder.beginRenderPass( pass.passDescriptor );\n\n\t\t\tpassEncoder.executeBundles( pass.renderBundles );\n\n\t\t\tpassEncoder.end();\n\n\t\t}\n\n\t}\n\n}\n\nconst _compareToWebGPU = {\n\t[ NeverCompare ]: 'never',\n\t[ LessCompare ]: 'less',\n\t[ EqualCompare ]: 'equal',\n\t[ LessEqualCompare ]: 'less-equal',\n\t[ GreaterCompare ]: 'greater',\n\t[ GreaterEqualCompare ]: 'greater-equal',\n\t[ AlwaysCompare ]: 'always',\n\t[ NotEqualCompare ]: 'not-equal'\n};\n\nconst _flipMap = [ 0, 1, 3, 2, 4, 5 ];\n\nclass WebGPUTextureUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t\tthis._passUtils = null;\n\n\t\tthis.defaultTexture = {};\n\t\tthis.defaultCubeTexture = {};\n\t\tthis.defaultVideoFrame = null;\n\n\t\tthis.colorBuffer = null;\n\n\t\tthis.depthTexture = new DepthTexture();\n\t\tthis.depthTexture.name = 'depthBuffer';\n\n\t}\n\n\tcreateSampler( texture ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst textureGPU = backend.get( texture );\n\n\t\tconst samplerDescriptorGPU = {\n\t\t\taddressModeU: this._convertAddressMode( texture.wrapS ),\n\t\t\taddressModeV: this._convertAddressMode( texture.wrapT ),\n\t\t\taddressModeW: this._convertAddressMode( texture.wrapR ),\n\t\t\tmagFilter: this._convertFilterMode( texture.magFilter ),\n\t\t\tminFilter: this._convertFilterMode( texture.minFilter ),\n\t\t\tmipmapFilter: this._convertFilterMode( texture.minFilter ),\n\t\t\tmaxAnisotropy: 1\n\t\t};\n\n\t\t// anisotropy can only be used when all filter modes are set to linear.\n\n\t\tif ( samplerDescriptorGPU.magFilter === GPUFilterMode.Linear && samplerDescriptorGPU.minFilter === GPUFilterMode.Linear && samplerDescriptorGPU.mipmapFilter === GPUFilterMode.Linear ) {\n\n\t\t\tsamplerDescriptorGPU.maxAnisotropy = texture.anisotropy;\n\n\t\t}\n\n\t\tif ( texture.isDepthTexture && texture.compareFunction !== null ) {\n\n\t\t\tsamplerDescriptorGPU.compare = _compareToWebGPU[ texture.compareFunction ];\n\n\t\t}\n\n\t\ttextureGPU.sampler = device.createSampler( samplerDescriptorGPU );\n\n\t}\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tlet textureGPU;\n\n\t\tconst format = getFormat( texture );\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\ttextureGPU = this._getDefaultCubeTextureGPU( format );\n\n\t\t} else if ( texture.isVideoTexture ) {\n\n\t\t\tthis.backend.get( texture ).externalTexture = this._getDefaultVideoFrame();\n\n\t\t} else {\n\n\t\t\ttextureGPU = this._getDefaultTextureGPU( format );\n\n\t\t}\n\n\t\tthis.backend.get( texture ).texture = textureGPU;\n\n\t}\n\n\tcreateTexture( texture, options = {} ) {\n\n\t\tconst backend = this.backend;\n\t\tconst textureData = backend.get( texture );\n\n\t\tif ( textureData.initialized ) {\n\n\t\t\tthrow new Error( 'WebGPUTextureUtils: Texture already initialized.' );\n\n\t\t}\n\n\t\tif ( options.needsMipmaps === undefined ) options.needsMipmaps = false;\n\t\tif ( options.levels === undefined ) options.levels = 1;\n\t\tif ( options.depth === undefined ) options.depth = 1;\n\n\t\tconst { width, height, depth, levels } = options;\n\n\t\tif ( texture.isFramebufferTexture ) {\n\n\t\t\tif ( options.renderTarget ) {\n\n\t\t\t\toptions.format = this.backend.utils.getCurrentColorFormat( options.renderTarget );\n\n\t\t\t} else {\n\n\t\t\t\toptions.format = this.backend.utils.getPreferredCanvasFormat();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst dimension = this._getDimension( texture );\n\t\tconst format = texture.internalFormat || options.format || getFormat( texture, backend.device );\n\n\t\ttextureData.format = format;\n\n\t\tlet sampleCount = options.sampleCount !== undefined ? options.sampleCount : 1;\n\n\t\tsampleCount = backend.utils.getSampleCount( sampleCount );\n\n\t\tconst primarySampleCount = texture.isRenderTargetTexture && ! texture.isMultisampleRenderTargetTexture ? 1 : sampleCount;\n\n\t\tlet usage = GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST | GPUTextureUsage.COPY_SRC;\n\n\t\tif ( texture.isStorageTexture === true ) {\n\n\t\t\tusage |= GPUTextureUsage.STORAGE_BINDING;\n\n\t\t}\n\n\t\tif ( texture.isCompressedTexture !== true && texture.isCompressedArrayTexture !== true ) {\n\n\t\t\tusage |= GPUTextureUsage.RENDER_ATTACHMENT;\n\n\t\t}\n\n\t\tconst textureDescriptorGPU = {\n\t\t\tlabel: texture.name,\n\t\t\tsize: {\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tdepthOrArrayLayers: depth,\n\t\t\t},\n\t\t\tmipLevelCount: levels,\n\t\t\tsampleCount: primarySampleCount,\n\t\t\tdimension: dimension,\n\t\t\tformat: format,\n\t\t\tusage: usage\n\t\t};\n\n\t\t// texture creation\n\n\t\tif ( texture.isVideoTexture ) {\n\n\t\t\tconst video = texture.source.data;\n\t\t\tconst videoFrame = new VideoFrame( video );\n\n\t\t\ttextureDescriptorGPU.size.width = videoFrame.displayWidth;\n\t\t\ttextureDescriptorGPU.size.height = videoFrame.displayHeight;\n\n\t\t\tvideoFrame.close();\n\n\t\t\ttextureData.externalTexture = video;\n\n\t\t} else {\n\n\t\t\tif ( format === undefined ) {\n\n\t\t\t\tconsole.warn( 'WebGPURenderer: Texture format not supported.' );\n\n\t\t\t\treturn this.createDefaultTexture( texture );\n\n\t\t\t}\n\n\t\t\ttextureData.texture = backend.device.createTexture( textureDescriptorGPU );\n\n\t\t}\n\n\t\tif ( texture.isRenderTargetTexture && sampleCount > 1 && ! texture.isMultisampleRenderTargetTexture ) {\n\n\t\t\tconst msaaTextureDescriptorGPU = Object.assign( {}, textureDescriptorGPU );\n\n\t\t\tmsaaTextureDescriptorGPU.label = msaaTextureDescriptorGPU.label + '-msaa';\n\t\t\tmsaaTextureDescriptorGPU.sampleCount = sampleCount;\n\n\t\t\ttextureData.msaaTexture = backend.device.createTexture( msaaTextureDescriptorGPU );\n\n\t\t}\n\n\t\ttextureData.initialized = true;\n\n\t\ttextureData.textureDescriptorGPU = textureDescriptorGPU;\n\n\t}\n\n\tdestroyTexture( texture ) {\n\n\t\tconst backend = this.backend;\n\t\tconst textureData = backend.get( texture );\n\n\t\ttextureData.texture.destroy();\n\n\t\tif ( textureData.msaaTexture !== undefined ) textureData.msaaTexture.destroy();\n\n\t\tbackend.delete( texture );\n\n\t}\n\n\tdestroySampler( texture ) {\n\n\t\tconst backend = this.backend;\n\t\tconst textureData = backend.get( texture );\n\n\t\tdelete textureData.sampler;\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tconst textureData = this.backend.get( texture );\n\n\t\tif ( texture.isCubeTexture ) {\n\n\t\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\t\tthis._generateMipmaps( textureData.texture, textureData.textureDescriptorGPU, i );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst depth = texture.image.depth || 1;\n\n\t\t\tfor ( let i = 0; i < depth; i ++ ) {\n\n\t\t\t\tthis._generateMipmaps( textureData.texture, textureData.textureDescriptorGPU, i );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetColorBuffer() {\n\n\t\tif ( this.colorBuffer ) this.colorBuffer.destroy();\n\n\t\tconst backend = this.backend;\n\t\tconst { width, height } = backend.getDrawingBufferSize();\n\n\t\tthis.colorBuffer = backend.device.createTexture( {\n\t\t\tlabel: 'colorBuffer',\n\t\t\tsize: {\n\t\t\t\twidth: width,\n\t\t\t\theight: height,\n\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t},\n\t\t\tsampleCount: backend.utils.getSampleCount( backend.renderer.samples ),\n\t\t\tformat: backend.utils.getPreferredCanvasFormat(),\n\t\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC\n\t\t} );\n\n\t\treturn this.colorBuffer;\n\n\t}\n\n\tgetDepthBuffer( depth = true, stencil = false ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { width, height } = backend.getDrawingBufferSize();\n\n\t\tconst depthTexture = this.depthTexture;\n\t\tconst depthTextureGPU = backend.get( depthTexture ).texture;\n\n\t\tlet format, type;\n\n\t\tif ( stencil ) {\n\n\t\t\tformat = DepthStencilFormat;\n\t\t\ttype = UnsignedInt248Type;\n\n\t\t} else if ( depth ) {\n\n\t\t\tformat = DepthFormat;\n\t\t\ttype = UnsignedIntType;\n\n\t\t}\n\n\t\tif ( depthTextureGPU !== undefined ) {\n\n\t\t\tif ( depthTexture.image.width === width && depthTexture.image.height === height && depthTexture.format === format && depthTexture.type === type ) {\n\n\t\t\t\treturn depthTextureGPU;\n\n\t\t\t}\n\n\t\t\tthis.destroyTexture( depthTexture );\n\n\t\t}\n\n\t\tdepthTexture.name = 'depthBuffer';\n\t\tdepthTexture.format = format;\n\t\tdepthTexture.type = type;\n\t\tdepthTexture.image.width = width;\n\t\tdepthTexture.image.height = height;\n\n\t\tthis.createTexture( depthTexture, { sampleCount: backend.utils.getSampleCount( backend.renderer.samples ), width, height } );\n\n\t\treturn backend.get( depthTexture ).texture;\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tconst textureData = this.backend.get( texture );\n\n\t\tconst { textureDescriptorGPU } = textureData;\n\n\t\tif ( texture.isRenderTargetTexture || ( textureDescriptorGPU === undefined /* unsupported texture format */ ) )\n\t\t\treturn;\n\n\t\t// transfer texture data\n\n\t\tif ( texture.isDataTexture ) {\n\n\t\t\tthis._copyBufferToTexture( options.image, textureData.texture, textureDescriptorGPU, 0, texture.flipY );\n\n\t\t} else if ( texture.isDataArrayTexture || texture.isData3DTexture ) {\n\n\t\t\tfor ( let i = 0; i < options.image.depth; i ++ ) {\n\n\t\t\t\tthis._copyBufferToTexture( options.image, textureData.texture, textureDescriptorGPU, i, texture.flipY, i );\n\n\t\t\t}\n\n\t\t} else if ( texture.isCompressedTexture || texture.isCompressedArrayTexture ) {\n\n\t\t\tthis._copyCompressedBufferToTexture( texture.mipmaps, textureData.texture, textureDescriptorGPU );\n\n\t\t} else if ( texture.isCubeTexture ) {\n\n\t\t\tthis._copyCubeMapToTexture( options.images, textureData.texture, textureDescriptorGPU, texture.flipY );\n\n\t\t} else if ( texture.isVideoTexture ) {\n\n\t\t\tconst video = texture.source.data;\n\n\t\t\ttextureData.externalTexture = video;\n\n\t\t} else {\n\n\t\t\tthis._copyImageToTexture( options.image, textureData.texture, textureDescriptorGPU, 0, texture.flipY );\n\n\t\t}\n\n\t\t//\n\n\t\ttextureData.version = texture.version;\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t}\n\n\tasync copyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\tconst device = this.backend.device;\n\n\t\tconst textureData = this.backend.get( texture );\n\t\tconst textureGPU = textureData.texture;\n\t\tconst format = textureData.textureDescriptorGPU.format;\n\t\tconst bytesPerTexel = this._getBytesPerTexel( format );\n\n\t\tlet bytesPerRow = width * bytesPerTexel;\n\t\tbytesPerRow = Math.ceil( bytesPerRow / 256 ) * 256; // Align to 256 bytes\n\n\t\tconst readBuffer = device.createBuffer(\n\t\t\t{\n\t\t\t\tsize: width * height * bytesPerTexel,\n\t\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ\n\t\t\t}\n\t\t);\n\n\t\tconst encoder = device.createCommandEncoder();\n\n\t\tencoder.copyTextureToBuffer(\n\t\t\t{\n\t\t\t\ttexture: textureGPU,\n\t\t\t\torigin: { x, y, z: faceIndex },\n\t\t\t},\n\t\t\t{\n\t\t\t\tbuffer: readBuffer,\n\t\t\t\tbytesPerRow: bytesPerRow\n\t\t\t},\n\t\t\t{\n\t\t\t\twidth: width,\n\t\t\t\theight: height\n\t\t\t}\n\n\t\t);\n\n\t\tconst typedArrayType = this._getTypedArrayType( format );\n\n\t\tdevice.queue.submit( [ encoder.finish() ] );\n\n\t\tawait readBuffer.mapAsync( GPUMapMode.READ );\n\n\t\tconst buffer = readBuffer.getMappedRange();\n\n\t\treturn new typedArrayType( buffer );\n\n\t}\n\n\t_isEnvironmentTexture( texture ) {\n\n\t\tconst mapping = texture.mapping;\n\n\t\treturn ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) || ( mapping === CubeReflectionMapping || mapping === CubeRefractionMapping );\n\n\t}\n\n\t_getDefaultTextureGPU( format ) {\n\n\t\tlet defaultTexture = this.defaultTexture[ format ];\n\n\t\tif ( defaultTexture === undefined ) {\n\n\t\t\tconst texture = new Texture();\n\t\t\ttexture.minFilter = NearestFilter;\n\t\t\ttexture.magFilter = NearestFilter;\n\n\t\t\tthis.createTexture( texture, { width: 1, height: 1, format } );\n\n\t\t\tthis.defaultTexture[ format ] = defaultTexture = texture;\n\n\t\t}\n\n\t\treturn this.backend.get( defaultTexture ).texture;\n\n\t}\n\n\t_getDefaultCubeTextureGPU( format ) {\n\n\t\tlet defaultCubeTexture = this.defaultTexture[ format ];\n\n\t\tif ( defaultCubeTexture === undefined ) {\n\n\t\t\tconst texture = new CubeTexture();\n\t\t\ttexture.minFilter = NearestFilter;\n\t\t\ttexture.magFilter = NearestFilter;\n\n\t\t\tthis.createTexture( texture, { width: 1, height: 1, depth: 6 } );\n\n\t\t\tthis.defaultCubeTexture[ format ] = defaultCubeTexture = texture;\n\n\t\t}\n\n\t\treturn this.backend.get( defaultCubeTexture ).texture;\n\n\t}\n\n\t_getDefaultVideoFrame() {\n\n\t\tlet defaultVideoFrame = this.defaultVideoFrame;\n\n\t\tif ( defaultVideoFrame === null ) {\n\n\t\t\tconst init = {\n\t\t\t\ttimestamp: 0,\n\t\t\t\tcodedWidth: 1,\n\t\t\t\tcodedHeight: 1,\n\t\t\t\tformat: 'RGBA',\n\t\t\t};\n\n\t\t\tthis.defaultVideoFrame = defaultVideoFrame = new VideoFrame( new Uint8Array( [ 0, 0, 0, 0xff ] ), init );\n\n\t\t}\n\n\t\treturn defaultVideoFrame;\n\n\t}\n\n\t_copyCubeMapToTexture( images, textureGPU, textureDescriptorGPU, flipY ) {\n\n\t\tfor ( let i = 0; i < 6; i ++ ) {\n\n\t\t\tconst image = images[ i ];\n\n\t\t\tconst flipIndex = flipY === true ? _flipMap[ i ] : i;\n\n\t\t\tif ( image.isDataTexture ) {\n\n\t\t\t\tthis._copyBufferToTexture( image.image, textureGPU, textureDescriptorGPU, flipIndex, flipY );\n\n\t\t\t} else {\n\n\t\t\t\tthis._copyImageToTexture( image, textureGPU, textureDescriptorGPU, flipIndex, flipY );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_copyImageToTexture( image, textureGPU, textureDescriptorGPU, originDepth, flipY ) {\n\n\t\tconst device = this.backend.device;\n\n\t\tdevice.queue.copyExternalImageToTexture(\n\t\t\t{\n\t\t\t\tsource: image\n\t\t\t}, {\n\t\t\t\ttexture: textureGPU,\n\t\t\t\tmipLevel: 0,\n\t\t\t\torigin: { x: 0, y: 0, z: originDepth }\n\t\t\t}, {\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t}\n\t\t);\n\n\t\tif ( flipY === true ) {\n\n\t\t\tthis._flipY( textureGPU, textureDescriptorGPU, originDepth );\n\n\t\t}\n\n\t}\n\n\t_getPassUtils() {\n\n\t\tlet passUtils = this._passUtils;\n\n\t\tif ( passUtils === null ) {\n\n\t\t\tthis._passUtils = passUtils = new WebGPUTexturePassUtils( this.backend.device );\n\n\t\t}\n\n\t\treturn passUtils;\n\n\t}\n\n\t_generateMipmaps( textureGPU, textureDescriptorGPU, baseArrayLayer = 0 ) {\n\n\t\tthis._getPassUtils().generateMipmaps( textureGPU, textureDescriptorGPU, baseArrayLayer );\n\n\t}\n\n\t_flipY( textureGPU, textureDescriptorGPU, originDepth = 0 ) {\n\n\t\tthis._getPassUtils().flipY( textureGPU, textureDescriptorGPU, originDepth );\n\n\t}\n\n\t_copyBufferToTexture( image, textureGPU, textureDescriptorGPU, originDepth, flipY, depth = 0 ) {\n\n\t\t// @TODO: Consider to use GPUCommandEncoder.copyBufferToTexture()\n\t\t// @TODO: Consider to support valid buffer layouts with other formats like RGB\n\n\t\tconst device = this.backend.device;\n\n\t\tconst data = image.data;\n\n\t\tconst bytesPerTexel = this._getBytesPerTexel( textureDescriptorGPU.format );\n\t\tconst bytesPerRow = image.width * bytesPerTexel;\n\n\t\tdevice.queue.writeTexture(\n\t\t\t{\n\t\t\t\ttexture: textureGPU,\n\t\t\t\tmipLevel: 0,\n\t\t\t\torigin: { x: 0, y: 0, z: originDepth }\n\t\t\t},\n\t\t\tdata,\n\t\t\t{\n\t\t\t\toffset: image.width * image.height * bytesPerTexel * depth,\n\t\t\t\tbytesPerRow\n\t\t\t},\n\t\t\t{\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height,\n\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t} );\n\n\t\tif ( flipY === true ) {\n\n\t\t\tthis._flipY( textureGPU, textureDescriptorGPU, originDepth );\n\n\t\t}\n\n\t}\n\n\t_copyCompressedBufferToTexture( mipmaps, textureGPU, textureDescriptorGPU ) {\n\n\t\t// @TODO: Consider to use GPUCommandEncoder.copyBufferToTexture()\n\n\t\tconst device = this.backend.device;\n\n\t\tconst blockData = this._getBlockData( textureDescriptorGPU.format );\n\t\tconst isTextureArray = textureDescriptorGPU.size.depthOrArrayLayers > 1;\n\n\t\tfor ( let i = 0; i < mipmaps.length; i ++ ) {\n\n\t\t\tconst mipmap = mipmaps[ i ];\n\n\t\t\tconst width = mipmap.width;\n\t\t\tconst height = mipmap.height;\n\t\t\tconst depth = isTextureArray ? textureDescriptorGPU.size.depthOrArrayLayers : 1;\n\n\t\t\tconst bytesPerRow = Math.ceil( width / blockData.width ) * blockData.byteLength;\n\t\t\tconst bytesPerImage = bytesPerRow * Math.ceil( height / blockData.height );\n\n\t\t\tfor ( let j = 0; j < depth; j ++ ) {\n\n\t\t\t\tdevice.queue.writeTexture(\n\t\t\t\t\t{\n\t\t\t\t\t\ttexture: textureGPU,\n\t\t\t\t\t\tmipLevel: i,\n\t\t\t\t\t\torigin: { x: 0, y: 0, z: j }\n\t\t\t\t\t},\n\t\t\t\t\tmipmap.data,\n\t\t\t\t\t{\n\t\t\t\t\t\toffset: j * bytesPerImage,\n\t\t\t\t\t\tbytesPerRow,\n\t\t\t\t\t\trowsPerImage: Math.ceil( height / blockData.height )\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: Math.ceil( width / blockData.width ) * blockData.width,\n\t\t\t\t\t\theight: Math.ceil( height / blockData.height ) * blockData.height,\n\t\t\t\t\t\tdepthOrArrayLayers: 1\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_getBlockData( format ) {\n\n\t\t// this method is only relevant for compressed texture formats\n\n\t\tif ( format === GPUTextureFormat.BC1RGBAUnorm || format === GPUTextureFormat.BC1RGBAUnormSRGB ) return { byteLength: 8, width: 4, height: 4 }; // DXT1\n\t\tif ( format === GPUTextureFormat.BC2RGBAUnorm || format === GPUTextureFormat.BC2RGBAUnormSRGB ) return { byteLength: 16, width: 4, height: 4 }; // DXT3\n\t\tif ( format === GPUTextureFormat.BC3RGBAUnorm || format === GPUTextureFormat.BC3RGBAUnormSRGB ) return { byteLength: 16, width: 4, height: 4 }; // DXT5\n\t\tif ( format === GPUTextureFormat.BC4RUnorm || format === GPUTextureFormat.BC4RSNorm ) return { byteLength: 8, width: 4, height: 4 }; // RGTC1\n\t\tif ( format === GPUTextureFormat.BC5RGUnorm || format === GPUTextureFormat.BC5RGSnorm ) return { byteLength: 16, width: 4, height: 4 }; // RGTC2\n\t\tif ( format === GPUTextureFormat.BC6HRGBUFloat || format === GPUTextureFormat.BC6HRGBFloat ) return { byteLength: 16, width: 4, height: 4 }; // BPTC (float)\n\t\tif ( format === GPUTextureFormat.BC7RGBAUnorm || format === GPUTextureFormat.BC7RGBAUnormSRGB ) return { byteLength: 16, width: 4, height: 4 }; // BPTC (unorm)\n\n\t\tif ( format === GPUTextureFormat.ETC2RGB8Unorm || format === GPUTextureFormat.ETC2RGB8UnormSRGB ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.ETC2RGB8A1Unorm || format === GPUTextureFormat.ETC2RGB8A1UnormSRGB ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.ETC2RGBA8Unorm || format === GPUTextureFormat.ETC2RGBA8UnormSRGB ) return { byteLength: 16, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACR11Unorm ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACR11Snorm ) return { byteLength: 8, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACRG11Unorm ) return { byteLength: 16, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.EACRG11Snorm ) return { byteLength: 16, width: 4, height: 4 };\n\n\t\tif ( format === GPUTextureFormat.ASTC4x4Unorm || format === GPUTextureFormat.ASTC4x4UnormSRGB ) return { byteLength: 16, width: 4, height: 4 };\n\t\tif ( format === GPUTextureFormat.ASTC5x4Unorm || format === GPUTextureFormat.ASTC5x4UnormSRGB ) return { byteLength: 16, width: 5, height: 4 };\n\t\tif ( format === GPUTextureFormat.ASTC5x5Unorm || format === GPUTextureFormat.ASTC5x5UnormSRGB ) return { byteLength: 16, width: 5, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC6x5Unorm || format === GPUTextureFormat.ASTC6x5UnormSRGB ) return { byteLength: 16, width: 6, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC6x6Unorm || format === GPUTextureFormat.ASTC6x6UnormSRGB ) return { byteLength: 16, width: 6, height: 6 };\n\t\tif ( format === GPUTextureFormat.ASTC8x5Unorm || format === GPUTextureFormat.ASTC8x5UnormSRGB ) return { byteLength: 16, width: 8, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC8x6Unorm || format === GPUTextureFormat.ASTC8x6UnormSRGB ) return { byteLength: 16, width: 8, height: 6 };\n\t\tif ( format === GPUTextureFormat.ASTC8x8Unorm || format === GPUTextureFormat.ASTC8x8UnormSRGB ) return { byteLength: 16, width: 8, height: 8 };\n\t\tif ( format === GPUTextureFormat.ASTC10x5Unorm || format === GPUTextureFormat.ASTC10x5UnormSRGB ) return { byteLength: 16, width: 10, height: 5 };\n\t\tif ( format === GPUTextureFormat.ASTC10x6Unorm || format === GPUTextureFormat.ASTC10x6UnormSRGB ) return { byteLength: 16, width: 10, height: 6 };\n\t\tif ( format === GPUTextureFormat.ASTC10x8Unorm || format === GPUTextureFormat.ASTC10x8UnormSRGB ) return { byteLength: 16, width: 10, height: 8 };\n\t\tif ( format === GPUTextureFormat.ASTC10x10Unorm || format === GPUTextureFormat.ASTC10x10UnormSRGB ) return { byteLength: 16, width: 10, height: 10 };\n\t\tif ( format === GPUTextureFormat.ASTC12x10Unorm || format === GPUTextureFormat.ASTC12x10UnormSRGB ) return { byteLength: 16, width: 12, height: 10 };\n\t\tif ( format === GPUTextureFormat.ASTC12x12Unorm || format === GPUTextureFormat.ASTC12x12UnormSRGB ) return { byteLength: 16, width: 12, height: 12 };\n\n\t}\n\n\t_convertAddressMode( value ) {\n\n\t\tlet addressMode = GPUAddressMode.ClampToEdge;\n\n\t\tif ( value === RepeatWrapping ) {\n\n\t\t\taddressMode = GPUAddressMode.Repeat;\n\n\t\t} else if ( value === MirroredRepeatWrapping ) {\n\n\t\t\taddressMode = GPUAddressMode.MirrorRepeat;\n\n\t\t}\n\n\t\treturn addressMode;\n\n\t}\n\n\t_convertFilterMode( value ) {\n\n\t\tlet filterMode = GPUFilterMode.Linear;\n\n\t\tif ( value === NearestFilter || value === NearestMipmapNearestFilter || value === NearestMipmapLinearFilter ) {\n\n\t\t\tfilterMode = GPUFilterMode.Nearest;\n\n\t\t}\n\n\t\treturn filterMode;\n\n\t}\n\n\t_getBytesPerTexel( format ) {\n\n\t\t// 8-bit formats\n\t\tif ( format === GPUTextureFormat.R8Unorm ||\n\t\t\tformat === GPUTextureFormat.R8Snorm ||\n\t\t\tformat === GPUTextureFormat.R8Uint ||\n\t\t\tformat === GPUTextureFormat.R8Sint ) return 1;\n\n\t\t// 16-bit formats\n\t\tif ( format === GPUTextureFormat.R16Uint ||\n\t\t\tformat === GPUTextureFormat.R16Sint ||\n\t\t\tformat === GPUTextureFormat.R16Float ||\n\t\t\tformat === GPUTextureFormat.RG8Unorm ||\n\t\t\tformat === GPUTextureFormat.RG8Snorm ||\n\t\t\tformat === GPUTextureFormat.RG8Uint ||\n\t\t\tformat === GPUTextureFormat.RG8Sint ) return 2;\n\n\t\t// 32-bit formats\n\t\tif ( format === GPUTextureFormat.R32Uint ||\n\t\t\tformat === GPUTextureFormat.R32Sint ||\n\t\t\tformat === GPUTextureFormat.R32Float ||\n\t\t\tformat === GPUTextureFormat.RG16Uint ||\n\t\t\tformat === GPUTextureFormat.RG16Sint ||\n\t\t\tformat === GPUTextureFormat.RG16Float ||\n\t\t\tformat === GPUTextureFormat.RGBA8Unorm ||\n\t\t\tformat === GPUTextureFormat.RGBA8UnormSRGB ||\n\t\t\tformat === GPUTextureFormat.RGBA8Snorm ||\n\t\t\tformat === GPUTextureFormat.RGBA8Uint ||\n\t\t\tformat === GPUTextureFormat.RGBA8Sint ||\n\t\t\tformat === GPUTextureFormat.BGRA8Unorm ||\n\t\t\tformat === GPUTextureFormat.BGRA8UnormSRGB ||\n\t\t\t// Packed 32-bit formats\n\t\t\tformat === GPUTextureFormat.RGB9E5UFloat ||\n\t\t\tformat === GPUTextureFormat.RGB10A2Unorm ||\n\t\t\tformat === GPUTextureFormat.RG11B10UFloat ||\n\t\t\tformat === GPUTextureFormat.Depth32Float ||\n\t\t\tformat === GPUTextureFormat.Depth24Plus ||\n\t\t\tformat === GPUTextureFormat.Depth24PlusStencil8 ||\n\t\t\tformat === GPUTextureFormat.Depth32FloatStencil8 ) return 4;\n\n\t\t// 64-bit formats\n\t\tif ( format === GPUTextureFormat.RG32Uint ||\n\t\t\tformat === GPUTextureFormat.RG32Sint ||\n\t\t\tformat === GPUTextureFormat.RG32Float ||\n\t\t\tformat === GPUTextureFormat.RGBA16Uint ||\n\t\t\tformat === GPUTextureFormat.RGBA16Sint ||\n\t\t\tformat === GPUTextureFormat.RGBA16Float ) return 8;\n\n\t\t// 128-bit formats\n\t\tif ( format === GPUTextureFormat.RGBA32Uint ||\n\t\t\tformat === GPUTextureFormat.RGBA32Sint ||\n\t\t\tformat === GPUTextureFormat.RGBA32Float ) return 16;\n\n\n\t}\n\n\t_getTypedArrayType( format ) {\n\n\t\tif ( format === GPUTextureFormat.R8Uint ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.R8Sint ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.R8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.R8Snorm ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RG8Uint ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RG8Sint ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RG8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RG8Snorm ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Uint ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Sint ) return Int8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RGBA8Snorm ) return Int8Array;\n\n\n\t\tif ( format === GPUTextureFormat.R16Uint ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.R16Sint ) return Int16Array;\n\t\tif ( format === GPUTextureFormat.RG16Uint ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RG16Sint ) return Int16Array;\n\t\tif ( format === GPUTextureFormat.RGBA16Uint ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RGBA16Sint ) return Int16Array;\n\t\tif ( format === GPUTextureFormat.R16Float ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RG16Float ) return Uint16Array;\n\t\tif ( format === GPUTextureFormat.RGBA16Float ) return Uint16Array;\n\n\n\t\tif ( format === GPUTextureFormat.R32Uint ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.R32Sint ) return Int32Array;\n\t\tif ( format === GPUTextureFormat.R32Float ) return Float32Array;\n\t\tif ( format === GPUTextureFormat.RG32Uint ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RG32Sint ) return Int32Array;\n\t\tif ( format === GPUTextureFormat.RG32Float ) return Float32Array;\n\t\tif ( format === GPUTextureFormat.RGBA32Uint ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RGBA32Sint ) return Int32Array;\n\t\tif ( format === GPUTextureFormat.RGBA32Float ) return Float32Array;\n\n\t\tif ( format === GPUTextureFormat.BGRA8Unorm ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.BGRA8UnormSRGB ) return Uint8Array;\n\t\tif ( format === GPUTextureFormat.RGB10A2Unorm ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RGB9E5UFloat ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.RG11B10UFloat ) return Uint32Array;\n\n\t\tif ( format === GPUTextureFormat.Depth32Float ) return Float32Array;\n\t\tif ( format === GPUTextureFormat.Depth24Plus ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.Depth24PlusStencil8 ) return Uint32Array;\n\t\tif ( format === GPUTextureFormat.Depth32FloatStencil8 ) return Float32Array;\n\n\t}\n\n\t_getDimension( texture ) {\n\n\t\tlet dimension;\n\n\t\tif ( texture.isData3DTexture ) {\n\n\t\t\tdimension = GPUTextureDimension.ThreeD;\n\n\t\t} else {\n\n\t\t\tdimension = GPUTextureDimension.TwoD;\n\n\t\t}\n\n\t\treturn dimension;\n\n\t}\n\n}\n\nfunction getFormat( texture, device = null ) {\n\n\tconst format = texture.format;\n\tconst type = texture.type;\n\tconst colorSpace = texture.colorSpace;\n\n\tlet formatGPU;\n\n\tif ( texture.isCompressedTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\tswitch ( format ) {\n\n\t\t\tcase RGBA_S3TC_DXT1_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.BC1RGBAUnormSRGB : GPUTextureFormat.BC1RGBAUnorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_S3TC_DXT3_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.BC2RGBAUnormSRGB : GPUTextureFormat.BC2RGBAUnorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_S3TC_DXT5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.BC3RGBAUnormSRGB : GPUTextureFormat.BC3RGBAUnorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGB_ETC2_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ETC2RGB8UnormSRGB : GPUTextureFormat.ETC2RGB8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ETC2_EAC_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ETC2RGBA8UnormSRGB : GPUTextureFormat.ETC2RGBA8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_4x4_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC4x4UnormSRGB : GPUTextureFormat.ASTC4x4Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_5x4_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC5x4UnormSRGB : GPUTextureFormat.ASTC5x4Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_5x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC5x5UnormSRGB : GPUTextureFormat.ASTC5x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_6x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC6x5UnormSRGB : GPUTextureFormat.ASTC6x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_6x6_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC6x6UnormSRGB : GPUTextureFormat.ASTC6x6Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_8x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC8x5UnormSRGB : GPUTextureFormat.ASTC8x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_8x6_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC8x6UnormSRGB : GPUTextureFormat.ASTC8x6Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_8x8_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC8x8UnormSRGB : GPUTextureFormat.ASTC8x8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x5_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x5UnormSRGB : GPUTextureFormat.ASTC10x5Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x6_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x6UnormSRGB : GPUTextureFormat.ASTC10x6Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x8_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x8UnormSRGB : GPUTextureFormat.ASTC10x8Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_10x10_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC10x10UnormSRGB : GPUTextureFormat.ASTC10x10Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_12x10_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC12x10UnormSRGB : GPUTextureFormat.ASTC12x10Unorm;\n\t\t\t\tbreak;\n\n\t\t\tcase RGBA_ASTC_12x12_Format:\n\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.ASTC12x12UnormSRGB : GPUTextureFormat.ASTC12x12Unorm;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture format.', format );\n\n\t\t}\n\n\t} else {\n\n\t\tswitch ( format ) {\n\n\t\t\tcase RGBAFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase ByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA8Snorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA16Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA16Uint;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedByteType:\n\t\t\t\t\t\tformatGPU = ( colorSpace === SRGBColorSpace ) ? GPUTextureFormat.RGBA8UnormSRGB : GPUTextureFormat.RGBA8Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA16Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGBAFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGBFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase UnsignedInt5999Type:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGB9E5UFloat;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGBFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RedFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase ByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R8Snorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R16Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R16Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R8Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R16Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RedFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase ByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG8Snorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG16Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG16Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedByteType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG8Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase HalfFloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG16Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase DepthFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase UnsignedShortType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth16Unorm;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth24Plus;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth32Float;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with DepthFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase DepthStencilFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase UnsignedInt248Type:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth24PlusStencil8;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase FloatType:\n\n\t\t\t\t\t\tif ( device && device.features.has( GPUFeatureName.Depth32FloatStencil8 ) === false ) {\n\n\t\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the \"depth32float-stencil8\" GPU feature.' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.Depth32FloatStencil8;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with DepthStencilFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RedIntegerFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.R32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RedIntegerFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGIntegerFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RG32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGIntegerFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase RGBAIntegerFormat:\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase IntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Sint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase UnsignedIntType:\n\t\t\t\t\t\tformatGPU = GPUTextureFormat.RGBA32Uint;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.', type );\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'WebGPURenderer: Unsupported texture format.', format );\n\n\t\t}\n\n\t}\n\n\treturn formatGPU;\n\n}\n\nconst declarationRegexp = /^[fn]*\\s*([a-z_0-9]+)?\\s*\\(([\\s\\S]*?)\\)\\s*[\\-\\>]*\\s*([a-z_0-9]+(?:<[\\s\\S]+?>)?)/i;\nconst propertiesRegexp = /([a-z_0-9]+)\\s*:\\s*([a-z_0-9]+(?:<[\\s\\S]+?>)?)/ig;\n\nconst wgslTypeLib$1 = {\n\t'f32': 'float',\n\t'i32': 'int',\n\t'u32': 'uint',\n\t'bool': 'bool',\n\n\t'vec2<f32>': 'vec2',\n \t'vec2<i32>': 'ivec2',\n \t'vec2<u32>': 'uvec2',\n \t'vec2<bool>': 'bvec2',\n\n\t'vec2f': 'vec2',\n\t'vec2i': 'ivec2',\n\t'vec2u': 'uvec2',\n\t'vec2b': 'bvec2',\n\n\t'vec3<f32>': 'vec3',\n\t'vec3<i32>': 'ivec3',\n\t'vec3<u32>': 'uvec3',\n\t'vec3<bool>': 'bvec3',\n\n\t'vec3f': 'vec3',\n\t'vec3i': 'ivec3',\n\t'vec3u': 'uvec3',\n\t'vec3b': 'bvec3',\n\n\t'vec4<f32>': 'vec4',\n\t'vec4<i32>': 'ivec4',\n\t'vec4<u32>': 'uvec4',\n\t'vec4<bool>': 'bvec4',\n\n\t'vec4f': 'vec4',\n\t'vec4i': 'ivec4',\n\t'vec4u': 'uvec4',\n\t'vec4b': 'bvec4',\n\n\t'mat2x2<f32>': 'mat2',\n\t'mat2x2f': 'mat2',\n\n\t'mat3x3<f32>': 'mat3',\n\t'mat3x3f': 'mat3',\n\n\t'mat4x4<f32>': 'mat4',\n\t'mat4x4f': 'mat4',\n\n\t'sampler': 'sampler',\n\n\t'texture_1d': 'texture',\n\n\t'texture_2d': 'texture',\n\t'texture_2d_array': 'texture',\n\t'texture_multisampled_2d': 'cubeTexture',\n\n\t'texture_depth_2d': 'depthTexture',\n\n\t'texture_3d': 'texture3D',\n\n\t'texture_cube': 'cubeTexture',\n\t'texture_cube_array': 'cubeTexture',\n\n\t'texture_storage_1d': 'storageTexture',\n\t'texture_storage_2d': 'storageTexture',\n\t'texture_storage_2d_array': 'storageTexture',\n\t'texture_storage_3d': 'storageTexture'\n\n};\n\nconst parse = ( source ) => {\n\n\tsource = source.trim();\n\n\tconst declaration = source.match( declarationRegexp );\n\n\tif ( declaration !== null && declaration.length === 4 ) {\n\n\t\tconst inputsCode = declaration[ 2 ];\n\t\tconst propsMatches = [];\n\t\tlet match = null;\n\n\t\twhile ( ( match = propertiesRegexp.exec( inputsCode ) ) !== null ) {\n\n\t\t\tpropsMatches.push( { name: match[ 1 ], type: match[ 2 ] } );\n\n\t\t}\n\n\t\t// Process matches to correctly pair names and types\n\t\tconst inputs = [];\n\t\tfor ( let i = 0; i < propsMatches.length; i ++ ) {\n\n\t\t\tconst { name, type } = propsMatches[ i ];\n\n\t\t\tlet resolvedType = type;\n\n\t\t\tif ( resolvedType.startsWith( 'ptr' ) ) {\n\n\t\t\t\tresolvedType = 'pointer';\n\n\t\t\t} else {\n\n\t\t\t\tif ( resolvedType.startsWith( 'texture' ) ) {\n\n\t\t\t\t\tresolvedType = type.split( '<' )[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t\tresolvedType = wgslTypeLib$1[ resolvedType ];\n\n\t\t\t}\n\n\t\t\tinputs.push( new NodeFunctionInput( resolvedType, name ) );\n\n\t\t}\n\n\t\tconst blockCode = source.substring( declaration[ 0 ].length );\n\t\tconst outputType = declaration[ 3 ] || 'void';\n\n\t\tconst name = declaration[ 1 ] !== undefined ? declaration[ 1 ] : '';\n\t\tconst type = wgslTypeLib$1[ outputType ] || outputType;\n\n\t\treturn {\n\t\t\ttype,\n\t\t\tinputs,\n\t\t\tname,\n\t\t\tinputsCode,\n\t\t\tblockCode,\n\t\t\toutputType\n\t\t};\n\n\t} else {\n\n\t\tthrow new Error( 'FunctionNode: Function is not a WGSL code.' );\n\n\t}\n\n};\n\nclass WGSLNodeFunction extends NodeFunction {\n\n\tconstructor( source ) {\n\n\t\tconst { type, inputs, name, inputsCode, blockCode, outputType } = parse( source );\n\n\t\tsuper( type, inputs, name );\n\n\t\tthis.inputsCode = inputsCode;\n\t\tthis.blockCode = blockCode;\n\t\tthis.outputType = outputType;\n\n\t}\n\n\tgetCode( name = this.name ) {\n\n\t\tconst outputType = this.outputType !== 'void' ? '-> ' + this.outputType : '';\n\n\t\treturn `fn ${ name } ( ${ this.inputsCode.trim() } ) ${ outputType }` + this.blockCode;\n\n\t}\n\n}\n\nclass WGSLNodeParser extends NodeParser {\n\n\tparseFunction( source ) {\n\n\t\treturn new WGSLNodeFunction( source );\n\n\t}\n\n}\n\n// GPUShaderStage is not defined in browsers not supporting WebGPU\nconst GPUShaderStage = self.GPUShaderStage;\n\nconst gpuShaderStageLib = {\n\t'vertex': GPUShaderStage ? GPUShaderStage.VERTEX : 1,\n\t'fragment': GPUShaderStage ? GPUShaderStage.FRAGMENT : 2,\n\t'compute': GPUShaderStage ? GPUShaderStage.COMPUTE : 4\n};\n\nconst supports = {\n\tinstance: true,\n\tswizzleAssign: false,\n\tstorageBuffer: true\n};\n\nconst wgslFnOpLib = {\n\t'^^': 'tsl_xor'\n};\n\nconst wgslTypeLib = {\n\tfloat: 'f32',\n\tint: 'i32',\n\tuint: 'u32',\n\tbool: 'bool',\n\tcolor: 'vec3<f32>',\n\n\tvec2: 'vec2<f32>',\n\tivec2: 'vec2<i32>',\n\tuvec2: 'vec2<u32>',\n\tbvec2: 'vec2<bool>',\n\n\tvec3: 'vec3<f32>',\n\tivec3: 'vec3<i32>',\n\tuvec3: 'vec3<u32>',\n\tbvec3: 'vec3<bool>',\n\n\tvec4: 'vec4<f32>',\n\tivec4: 'vec4<i32>',\n\tuvec4: 'vec4<u32>',\n\tbvec4: 'vec4<bool>',\n\n\tmat2: 'mat2x2<f32>',\n\tmat3: 'mat3x3<f32>',\n\tmat4: 'mat4x4<f32>'\n};\n\nconst wgslPolyfill = {\n\ttsl_xor: new CodeNode( 'fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }' ),\n\tmod_float: new CodeNode( 'fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }' ),\n\tmod_vec2: new CodeNode( 'fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }' ),\n\tmod_vec3: new CodeNode( 'fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }' ),\n\tmod_vec4: new CodeNode( 'fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }' ),\n\tequals_bool: new CodeNode( 'fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }' ),\n\tequals_bvec2: new CodeNode( 'fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }' ),\n\tequals_bvec3: new CodeNode( 'fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }' ),\n\tequals_bvec4: new CodeNode( 'fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }' ),\n\trepeatWrapping: new CodeNode( /* wgsl */`\nfn tsl_repeatWrapping( uv : vec2<f32>, dimension : vec2<u32> ) -> vec2<u32> {\n\n\tlet uvScaled = vec2<u32>( uv * vec2<f32>( dimension ) );\n\n\treturn ( ( uvScaled % dimension ) + dimension ) % dimension;\n\n}\n` ),\n\tbiquadraticTexture: new CodeNode( /* wgsl */`\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, level : i32 ) -> vec4f {\n\n\tlet iRes = vec2i( textureDimensions( map, level ) );\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2i( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2i( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2i( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2i( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n` )\n};\n\nconst wgslMethods = {\n\tdFdx: 'dpdx',\n\tdFdy: '- dpdy',\n\tmod_float: 'tsl_mod_float',\n\tmod_vec2: 'tsl_mod_vec2',\n\tmod_vec3: 'tsl_mod_vec3',\n\tmod_vec4: 'tsl_mod_vec4',\n\tequals_bool: 'tsl_equals_bool',\n\tequals_bvec2: 'tsl_equals_bvec2',\n\tequals_bvec3: 'tsl_equals_bvec3',\n\tequals_bvec4: 'tsl_equals_bvec4',\n\tinversesqrt: 'inverseSqrt',\n\tbitcast: 'bitcast<f32>'\n};\n\n// WebGPU issue: does not support pow() with negative base on Windows\n\nif ( /Windows/g.test( navigator.userAgent ) ) {\n\n\twgslPolyfill.pow_float = new CodeNode( 'fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }' );\n\twgslPolyfill.pow_vec2 = new CodeNode( 'fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }', [ wgslPolyfill.pow_float ] );\n\twgslPolyfill.pow_vec3 = new CodeNode( 'fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }', [ wgslPolyfill.pow_float ] );\n\twgslPolyfill.pow_vec4 = new CodeNode( 'fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }', [ wgslPolyfill.pow_float ] );\n\n\twgslMethods.pow_float = 'tsl_pow_float';\n\twgslMethods.pow_vec2 = 'tsl_pow_vec2';\n\twgslMethods.pow_vec3 = 'tsl_pow_vec3';\n\twgslMethods.pow_vec4 = 'tsl_pow_vec4';\n\n}\n\n//\n\nlet diagnostics = '';\n\nif ( /Firefox|Deno/g.test( navigator.userAgent ) !== true ) {\n\n\tdiagnostics += 'diagnostic( off, derivative_uniformity );\\n';\n\n}\n\n//\n\nclass WGSLNodeBuilder extends NodeBuilder {\n\n\tconstructor( object, renderer ) {\n\n\t\tsuper( object, renderer, new WGSLNodeParser() );\n\n\t\tthis.uniformGroups = {};\n\n\t\tthis.builtins = {};\n\n\t\tthis.directives = {};\n\n\t\tthis.scopedArrays = new Map();\n\n\t}\n\n\tneedsToWorkingColorSpace( texture ) {\n\n\t\treturn texture.isVideoTexture === true && texture.colorSpace !== NoColorSpace;\n\n\t}\n\n\t_generateTextureSample( texture, textureProperty, uvSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\tif ( depthSnippet ) {\n\n\t\t\t\treturn `textureSample( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ depthSnippet } )`;\n\n\t\t\t} else {\n\n\t\t\t\treturn `textureSample( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet } )`;\n\n\t\t\t}\n\n\t\t} else if ( this.isFilteredTexture( texture ) ) {\n\n\t\t\treturn this.generateFilteredTexture( texture, textureProperty, uvSnippet );\n\n\t\t} else {\n\n\t\t\treturn this.generateTextureLod( texture, textureProperty, uvSnippet, '0' );\n\n\t\t}\n\n\t}\n\n\t_generateVideoSample( textureProperty, uvSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `textureSampleBaseClampToEdge( ${ textureProperty }, ${ textureProperty }_sampler, vec2<f32>( ${ uvSnippet }.x, 1.0 - ${ uvSnippet }.y ) )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.VideoTexture does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\t_generateTextureSampleLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' && this.isUnfilterable( texture ) === false ) {\n\n\t\t\treturn `textureSampleLevel( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ levelSnippet } )`;\n\n\t\t} else if ( this.isFilteredTexture( texture ) ) {\n\n\t\t\treturn this.generateFilteredTexture( texture, textureProperty, uvSnippet, levelSnippet );\n\n\t\t} else {\n\n\t\t\treturn this.generateTextureLod( texture, textureProperty, uvSnippet, levelSnippet );\n\n\t\t}\n\n\t}\n\n\tgenerateFilteredTexture( texture, textureProperty, uvSnippet, levelSnippet = '0' ) {\n\n\t\tthis._include( 'biquadraticTexture' );\n\n\t\treturn `tsl_biquadraticTexture( ${ textureProperty }, ${ uvSnippet }, i32( ${ levelSnippet } ) )`;\n\n\t}\n\n\tgenerateTextureLod( texture, textureProperty, uvSnippet, levelSnippet = '0' ) {\n\n\t\tthis._include( 'repeatWrapping' );\n\n\t\tconst dimension = texture.isMultisampleRenderTargetTexture === true ? `textureDimensions( ${ textureProperty } )` : `textureDimensions( ${ textureProperty }, 0 )`;\n\n\t\treturn `textureLoad( ${ textureProperty }, tsl_repeatWrapping( ${ uvSnippet }, ${ dimension } ), i32( ${ levelSnippet } ) )`;\n\n\t}\n\n\tgenerateTextureLoad( texture, textureProperty, uvIndexSnippet, depthSnippet, levelSnippet = '0u' ) {\n\n\t\tif ( depthSnippet ) {\n\n\t\t\treturn `textureLoad( ${ textureProperty }, ${ uvIndexSnippet }, ${ depthSnippet }, ${ levelSnippet } )`;\n\n\t\t} else {\n\n\t\t\treturn `textureLoad( ${ textureProperty }, ${ uvIndexSnippet }, ${ levelSnippet } )`;\n\n\t\t}\n\n\t}\n\n\tgenerateTextureStore( texture, textureProperty, uvIndexSnippet, valueSnippet ) {\n\n\t\treturn `textureStore( ${ textureProperty }, ${ uvIndexSnippet }, ${ valueSnippet } )`;\n\n\t}\n\n\tisUnfilterable( texture ) {\n\n\t\treturn this.getComponentTypeFromTexture( texture ) !== 'float' || ( ! this.isAvailable( 'float32Filterable' ) && texture.isDataTexture === true && texture.type === FloatType ) || texture.isMultisampleRenderTargetTexture === true;\n\n\t}\n\n\tgenerateTexture( texture, textureProperty, uvSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tlet snippet = null;\n\n\t\tif ( texture.isVideoTexture === true ) {\n\n\t\t\tsnippet = this._generateVideoSample( textureProperty, uvSnippet, shaderStage );\n\n\t\t} else if ( this.isUnfilterable( texture ) ) {\n\n\t\t\tsnippet = this.generateTextureLod( texture, textureProperty, uvSnippet, '0', depthSnippet, shaderStage );\n\n\t\t} else {\n\n\t\t\tsnippet = this._generateTextureSample( texture, textureProperty, uvSnippet, depthSnippet, shaderStage );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerateTextureGrad( texture, textureProperty, uvSnippet, gradSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\t// TODO handle i32 or u32 --> uvSnippet, array_index: A, ddx, ddy\n\t\t\treturn `textureSampleGrad( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet },  ${ gradSnippet[ 0 ] }, ${ gradSnippet[ 1 ] } )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.TextureNode.gradient() does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgenerateTextureCompare( texture, textureProperty, uvSnippet, compareSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `textureSampleCompare( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ compareSnippet } )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgenerateTextureLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tlet snippet = null;\n\n\t\tif ( texture.isVideoTexture === true ) {\n\n\t\t\tsnippet = this._generateVideoSample( textureProperty, uvSnippet, shaderStage );\n\n\t\t} else {\n\n\t\t\tsnippet = this._generateTextureSampleLevel( texture, textureProperty, uvSnippet, levelSnippet, depthSnippet, shaderStage );\n\n\t\t}\n\n\t\treturn snippet;\n\n\t}\n\n\tgenerateTextureBias( texture, textureProperty, uvSnippet, biasSnippet, depthSnippet, shaderStage = this.shaderStage ) {\n\n\t\tif ( shaderStage === 'fragment' ) {\n\n\t\t\treturn `textureSampleBias( ${ textureProperty }, ${ textureProperty }_sampler, ${ uvSnippet }, ${ biasSnippet } )`;\n\n\t\t} else {\n\n\t\t\tconsole.error( `WebGPURenderer: THREE.TextureNode.biasNode does not support ${ shaderStage } shader.` );\n\n\t\t}\n\n\t}\n\n\tgetPropertyName( node, shaderStage = this.shaderStage ) {\n\n\t\tif ( node.isNodeVarying === true && node.needsInterpolation === true ) {\n\n\t\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\t\treturn `varyings.${ node.name }`;\n\n\t\t\t}\n\n\t\t} else if ( node.isNodeUniform === true ) {\n\n\t\t\tconst name = node.name;\n\t\t\tconst type = node.type;\n\n\t\t\tif ( type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'texture3D' ) {\n\n\t\t\t\treturn name;\n\n\t\t\t} else if ( type === 'buffer' || type === 'storageBuffer' || type === 'indirectStorageBuffer' ) {\n\n\t\t\t\treturn `NodeBuffer_${ node.id }.${name}`;\n\n\t\t\t} else {\n\n\t\t\t\treturn node.groupNode.name + '.' + name;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn super.getPropertyName( node );\n\n\t}\n\n\tgetOutputStructName() {\n\n\t\treturn 'output';\n\n\t}\n\n\t_getUniformGroupCount( shaderStage ) {\n\n\t\treturn Object.keys( this.uniforms[ shaderStage ] ).length;\n\n\t}\n\n\tgetFunctionOperator( op ) {\n\n\t\tconst fnOp = wgslFnOpLib[ op ];\n\n\t\tif ( fnOp !== undefined ) {\n\n\t\t\tthis._include( fnOp );\n\n\t\t\treturn fnOp;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tgetStorageAccess( node ) {\n\n\t\tif ( node.isStorageTextureNode ) {\n\n\t\t\tswitch ( node.access ) {\n\n\t\t\t\tcase GPUStorageTextureAccess.ReadOnly:\n\n\t\t\t\t\treturn 'read';\n\n\t\t\t\tcase GPUStorageTextureAccess.WriteOnly:\n\n\t\t\t\t\treturn 'write';\n\n\t\t\t\tdefault:\n\n\t\t\t\t\treturn 'read_write';\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tswitch ( node.access ) {\n\n\t\t\t\tcase GPUBufferBindingType.Storage:\n\n\t\t\t\t\treturn 'read_write';\n\n\n\t\t\t\tcase GPUBufferBindingType.ReadOnlyStorage:\n\n\t\t\t\t\treturn 'read';\n\n\t\t\t\tdefault:\n\n\t\t\t\t\treturn 'write';\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetUniformFromNode( node, type, shaderStage, name = null ) {\n\n\t\tconst uniformNode = super.getUniformFromNode( node, type, shaderStage, name );\n\t\tconst nodeData = this.getDataFromNode( node, shaderStage, this.globalCache );\n\n\t\tif ( nodeData.uniformGPU === undefined ) {\n\n\t\t\tlet uniformGPU;\n\n\t\t\tconst group = node.groupNode;\n\t\t\tconst groupName = group.name;\n\n\t\t\tconst bindings = this.getBindGroupArray( groupName, shaderStage );\n\n\t\t\tif ( type === 'texture' || type === 'cubeTexture' || type === 'storageTexture' || type === 'texture3D' ) {\n\n\t\t\t\tlet texture = null;\n\n\t\t\t\tif ( type === 'texture' || type === 'storageTexture' ) {\n\n\t\t\t\t\ttexture = new NodeSampledTexture( uniformNode.name, uniformNode.node, group, node.access ? node.access : null );\n\n\t\t\t\t} else if ( type === 'cubeTexture' ) {\n\n\t\t\t\t\ttexture = new NodeSampledCubeTexture( uniformNode.name, uniformNode.node, group, node.access ? node.access : null );\n\n\t\t\t\t} else if ( type === 'texture3D' ) {\n\n\t\t\t\t\ttexture = new NodeSampledTexture3D( uniformNode.name, uniformNode.node, group, node.access ? node.access : null );\n\n\t\t\t\t}\n\n\t\t\t\ttexture.store = node.isStorageTextureNode === true;\n\t\t\t\ttexture.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\tif ( shaderStage === 'fragment' && this.isUnfilterable( node.value ) === false && texture.store === false ) {\n\n\t\t\t\t\tconst sampler = new NodeSampler( `${uniformNode.name}_sampler`, uniformNode.node, group );\n\t\t\t\t\tsampler.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\t\tbindings.push( sampler, texture );\n\n\t\t\t\t\tuniformGPU = [ sampler, texture ];\n\n\t\t\t\t} else {\n\n\t\t\t\t\tbindings.push( texture );\n\n\t\t\t\t\tuniformGPU = [ texture ];\n\n\t\t\t\t}\n\n\t\t\t} else if ( type === 'buffer' || type === 'storageBuffer' || type === 'indirectStorageBuffer' ) {\n\n\t\t\t\tconst bufferClass = type === 'buffer' ? NodeUniformBuffer : NodeStorageBuffer;\n\n\t\t\t\tconst buffer = new bufferClass( node, group );\n\t\t\t\tbuffer.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\tbindings.push( buffer );\n\n\t\t\t\tuniformGPU = buffer;\n\n\t\t\t} else {\n\n\t\t\t\tconst uniformsStage = this.uniformGroups[ shaderStage ] || ( this.uniformGroups[ shaderStage ] = {} );\n\n\t\t\t\tlet uniformsGroup = uniformsStage[ groupName ];\n\n\t\t\t\tif ( uniformsGroup === undefined ) {\n\n\t\t\t\t\tuniformsGroup = new NodeUniformsGroup( groupName, group );\n\t\t\t\t\tuniformsGroup.setVisibility( gpuShaderStageLib[ shaderStage ] );\n\n\t\t\t\t\tuniformsStage[ groupName ] = uniformsGroup;\n\n\t\t\t\t\tbindings.push( uniformsGroup );\n\n\t\t\t\t}\n\n\t\t\t\tuniformGPU = this.getNodeUniform( uniformNode, type );\n\n\t\t\t\tuniformsGroup.addUniform( uniformGPU );\n\n\t\t\t}\n\n\t\t\tnodeData.uniformGPU = uniformGPU;\n\n\t\t}\n\n\t\treturn uniformNode;\n\n\t}\n\n\tgetBuiltin( name, property, type, shaderStage = this.shaderStage ) {\n\n\t\tconst map = this.builtins[ shaderStage ] || ( this.builtins[ shaderStage ] = new Map() );\n\n\t\tif ( map.has( name ) === false ) {\n\n\t\t\tmap.set( name, {\n\t\t\t\tname,\n\t\t\t\tproperty,\n\t\t\t\ttype\n\t\t\t} );\n\n\t\t}\n\n\t\treturn property;\n\n\t}\n\n\thasBuiltin( name, shaderStage = this.shaderStage ) {\n\n\t\treturn ( this.builtins[ shaderStage ] !== undefined && this.builtins[ shaderStage ].has( name ) );\n\n\t}\n\n\tgetVertexIndex() {\n\n\t\tif ( this.shaderStage === 'vertex' ) {\n\n\t\t\treturn this.getBuiltin( 'vertex_index', 'vertexIndex', 'u32', 'attribute' );\n\n\t\t}\n\n\t\treturn 'vertexIndex';\n\n\t}\n\n\tbuildFunctionCode( shaderNode ) {\n\n\t\tconst layout = shaderNode.layout;\n\t\tconst flowData = this.flowShaderNode( shaderNode );\n\n\t\tconst parameters = [];\n\n\t\tfor ( const input of layout.inputs ) {\n\n\t\t\tparameters.push( input.name + ' : ' + this.getType( input.type ) );\n\n\t\t}\n\n\t\t//\n\n\t\tlet code = `fn ${ layout.name }( ${ parameters.join( ', ' ) } ) -> ${ this.getType( layout.type ) } {\n${ flowData.vars }\n${ flowData.code }\n`;\n\n\t\tif ( flowData.result ) {\n\n\t\t\tcode += `\\treturn ${ flowData.result };\\n`;\n\n\t\t}\n\n\t\tcode += '\\n}\\n';\n\n\t\t//\n\n\t\treturn code;\n\n\t}\n\n\tgetInstanceIndex() {\n\n\t\tif ( this.shaderStage === 'vertex' ) {\n\n\t\t\treturn this.getBuiltin( 'instance_index', 'instanceIndex', 'u32', 'attribute' );\n\n\t\t}\n\n\t\treturn 'instanceIndex';\n\n\t}\n\n\tgetInvocationLocalIndex() {\n\n\t\treturn this.getBuiltin( 'local_invocation_index', 'invocationLocalIndex', 'u32', 'attribute' );\n\n\t}\n\n\tgetSubgroupSize() {\n\n\t\tthis.enableSubGroups();\n\n\t\treturn this.getBuiltin( 'subgroup_size', 'subgroupSize', 'u32', 'attribute' );\n\n\t}\n\n\tgetInvocationSubgroupIndex() {\n\n\t\tthis.enableSubGroups();\n\n\t\treturn this.getBuiltin( 'subgroup_invocation_id', 'invocationSubgroupIndex', 'u32', 'attribute' );\n\n\t}\n\n\tgetSubgroupIndex() {\n\n\t\tthis.enableSubGroups();\n\n\t\treturn this.getBuiltin( 'subgroup_id', 'subgroupIndex', 'u32', 'attribute' );\n\n\t}\n\n\tgetDrawIndex() {\n\n\t\treturn null;\n\n\t}\n\n\tgetFrontFacing() {\n\n\t\treturn this.getBuiltin( 'front_facing', 'isFront', 'bool' );\n\n\t}\n\n\tgetFragCoord() {\n\n\t\treturn this.getBuiltin( 'position', 'fragCoord', 'vec4<f32>' ) + '.xy';\n\n\t}\n\n\tgetFragDepth() {\n\n\t\treturn 'output.' + this.getBuiltin( 'frag_depth', 'depth', 'f32', 'output' );\n\n\t}\n\n\tisFlipY() {\n\n\t\treturn false;\n\n\t}\n\n\tenableDirective( name, shaderStage = this.shaderStage ) {\n\n\t\tconst stage = this.directives[ shaderStage ] || ( this.directives[ shaderStage ] = new Set() );\n\t\tstage.add( name );\n\n\t}\n\n\tgetDirectives( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst directives = this.directives[ shaderStage ];\n\n\t\tif ( directives !== undefined ) {\n\n\t\t\tfor ( const directive of directives ) {\n\n\t\t\t\tsnippets.push( `enable ${directive};` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tenableSubGroups() {\n\n\t\tthis.enableDirective( 'subgroups' );\n\n\t}\n\n\tenableSubgroupsF16() {\n\n\t\tthis.enableDirective( 'subgroups-f16' );\n\n\t}\n\n\tenableClipDistances() {\n\n\t\tthis.enableDirective( 'clip_distances' );\n\n\t}\n\n\tenableShaderF16() {\n\n\t\tthis.enableDirective( 'f16' );\n\n\t}\n\n\tenableDualSourceBlending() {\n\n\t\tthis.enableDirective( 'dual_source_blending' );\n\n\t}\n\n\tgetBuiltins( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst builtins = this.builtins[ shaderStage ];\n\n\t\tif ( builtins !== undefined ) {\n\n\t\t\tfor ( const { name, property, type } of builtins.values() ) {\n\n\t\t\t\tsnippets.push( `@builtin( ${name} ) ${property} : ${type}` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( ',\\n\\t' );\n\n\t}\n\n\tgetScopedArray( name, scope, bufferType, bufferCount ) {\n\n\t\tif ( this.scopedArrays.has( name ) === false ) {\n\n\t\t\tthis.scopedArrays.set( name, {\n\t\t\t\tname,\n\t\t\t\tscope,\n\t\t\t\tbufferType,\n\t\t\t\tbufferCount\n\t\t\t} );\n\n\t\t}\n\n\t\treturn name;\n\n\t}\n\n\tgetScopedArrays( shaderStage ) {\n\n\t\tif ( shaderStage !== 'compute' ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst snippets = [];\n\n\t\tfor ( const { name, scope, bufferType, bufferCount } of this.scopedArrays.values() ) {\n\n\t\t\tconst type = this.getType( bufferType );\n\n\t\t\tsnippets.push( `var<${scope}> ${name}: array< ${type}, ${bufferCount} >;` );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n' );\n\n\t}\n\n\tgetAttributes( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tif ( shaderStage === 'compute' ) {\n\n\t\t\tthis.getBuiltin( 'global_invocation_id', 'id', 'vec3<u32>', 'attribute' );\n\t\t\tthis.getBuiltin( 'workgroup_id', 'workgroupId', 'vec3<u32>', 'attribute' );\n\t\t\tthis.getBuiltin( 'local_invocation_id', 'localId', 'vec3<u32>', 'attribute' );\n\t\t\tthis.getBuiltin( 'num_workgroups', 'numWorkgroups', 'vec3<u32>', 'attribute' );\n\n\t\t\tif ( this.renderer.hasFeature( 'subgroups' ) ) {\n\n\t\t\t\tthis.enableDirective( 'subgroups', shaderStage );\n\t\t\t\tthis.getBuiltin( 'subgroup_size', 'subgroupSize', 'u32', 'attribute' );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'compute' ) {\n\n\t\t\tconst builtins = this.getBuiltins( 'attribute' );\n\n\t\t\tif ( builtins ) snippets.push( builtins );\n\n\t\t\tconst attributes = this.getAttributesArray();\n\n\t\t\tfor ( let index = 0, length = attributes.length; index < length; index ++ ) {\n\n\t\t\t\tconst attribute = attributes[ index ];\n\t\t\t\tconst name = attribute.name;\n\t\t\t\tconst type = this.getType( attribute.type );\n\n\t\t\t\tsnippets.push( `@location( ${index} ) ${ name } : ${ type }` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn snippets.join( ',\\n\\t' );\n\n\t}\n\n\tgetStructMembers( struct ) {\n\n\t\tconst snippets = [];\n\t\tconst members = struct.getMemberTypes();\n\n\t\tfor ( let i = 0; i < members.length; i ++ ) {\n\n\t\t\tconst member = members[ i ];\n\t\t\tsnippets.push( `\\t@location( ${i} ) m${i} : ${ member }<f32>` );\n\n\t\t}\n\n\t\tconst builtins = this.getBuiltins( 'output' );\n\n\t\tif ( builtins ) snippets.push( '\\t' + builtins );\n\n\t\treturn snippets.join( ',\\n' );\n\n\t}\n\n\tgetStructs( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst structs = this.structs[ shaderStage ];\n\n\t\tfor ( let index = 0, length = structs.length; index < length; index ++ ) {\n\n\t\t\tconst struct = structs[ index ];\n\t\t\tconst name = struct.name;\n\n\t\t\tlet snippet = `\\struct ${ name } {\\n`;\n\t\t\tsnippet += this.getStructMembers( struct );\n\t\t\tsnippet += '\\n}';\n\n\n\t\t\tsnippets.push( snippet );\n\n\t\t\tsnippets.push( `\\nvar<private> output : ${ name };\\n\\n` );\n\n\t\t}\n\n\t\treturn snippets.join( '\\n\\n' );\n\n\t}\n\n\tgetVar( type, name ) {\n\n\t\treturn `var ${ name } : ${ this.getType( type ) }`;\n\n\t}\n\n\tgetVars( shaderStage ) {\n\n\t\tconst snippets = [];\n\t\tconst vars = this.vars[ shaderStage ];\n\n\t\tif ( vars !== undefined ) {\n\n\t\t\tfor ( const variable of vars ) {\n\n\t\t\t\tsnippets.push( `\\t${ this.getVar( variable.type, variable.name ) };` );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn `\\n${ snippets.join( '\\n' ) }\\n`;\n\n\t}\n\n\tgetVaryings( shaderStage ) {\n\n\t\tconst snippets = [];\n\n\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\tthis.getBuiltin( 'position', 'Vertex', 'vec4<f32>', 'vertex' );\n\n\t\t}\n\n\t\tif ( shaderStage === 'vertex' || shaderStage === 'fragment' ) {\n\n\t\t\tconst varyings = this.varyings;\n\t\t\tconst vars = this.vars[ shaderStage ];\n\n\t\t\tfor ( let index = 0; index < varyings.length; index ++ ) {\n\n\t\t\t\tconst varying = varyings[ index ];\n\n\t\t\t\tif ( varying.needsInterpolation ) {\n\n\t\t\t\t\tlet attributesSnippet = `@location( ${index} )`;\n\n\t\t\t\t\tif ( /^(int|uint|ivec|uvec)/.test( varying.type ) ) {\n\n\t\t\t\t\t\tattributesSnippet += ' @interpolate( flat )';\n\n\n\t\t\t\t\t}\n\n\t\t\t\t\tsnippets.push( `${ attributesSnippet } ${ varying.name } : ${ this.getType( varying.type ) }` );\n\n\t\t\t\t} else if ( shaderStage === 'vertex' && vars.includes( varying ) === false ) {\n\n\t\t\t\t\tvars.push( varying );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst builtins = this.getBuiltins( shaderStage );\n\n\t\tif ( builtins ) snippets.push( builtins );\n\n\t\tconst code = snippets.join( ',\\n\\t' );\n\n\t\treturn shaderStage === 'vertex' ? this._getWGSLStruct( 'VaryingsStruct', '\\t' + code ) : code;\n\n\t}\n\n\tgetUniforms( shaderStage ) {\n\n\t\tconst uniforms = this.uniforms[ shaderStage ];\n\n\t\tconst bindingSnippets = [];\n\t\tconst bufferSnippets = [];\n\t\tconst structSnippets = [];\n\t\tconst uniformGroups = {};\n\n\t\tfor ( const uniform of uniforms ) {\n\n\t\t\tconst groupName = uniform.groupNode.name;\n\t\t\tconst uniformIndexes = this.bindingsIndexes[ groupName ];\n\n\t\t\tif ( uniform.type === 'texture' || uniform.type === 'cubeTexture' || uniform.type === 'storageTexture' || uniform.type === 'texture3D' ) {\n\n\t\t\t\tconst texture = uniform.node.value;\n\n\t\t\t\tif ( shaderStage === 'fragment' && this.isUnfilterable( texture ) === false && uniform.node.isStorageTextureNode !== true ) {\n\n\t\t\t\t\tif ( texture.isDepthTexture === true && texture.compareFunction !== null ) {\n\n\t\t\t\t\t\tbindingSnippets.push( `@binding( ${ uniformIndexes.binding ++ } ) @group( ${ uniformIndexes.group } ) var ${ uniform.name }_sampler : sampler_comparison;` );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindingSnippets.push( `@binding( ${ uniformIndexes.binding ++ } ) @group( ${ uniformIndexes.group } ) var ${ uniform.name }_sampler : sampler;` );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlet textureType;\n\n\t\t\t\tlet multisampled = '';\n\n\t\t\t\tif ( texture.isMultisampleRenderTargetTexture === true ) {\n\n\t\t\t\t\tmultisampled = '_multisampled';\n\n\t\t\t\t}\n\n\t\t\t\tif ( texture.isCubeTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_cube<f32>';\n\n\t\t\t\t} else if ( texture.isDataArrayTexture === true || texture.isCompressedArrayTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_2d_array<f32>';\n\n\t\t\t\t} else if ( texture.isDepthTexture === true ) {\n\n\t\t\t\t\ttextureType = `texture_depth${multisampled}_2d`;\n\n\t\t\t\t} else if ( texture.isVideoTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_external';\n\n\t\t\t\t} else if ( texture.isData3DTexture === true ) {\n\n\t\t\t\t\ttextureType = 'texture_3d<f32>';\n\n\t\t\t\t} else if ( uniform.node.isStorageTextureNode === true ) {\n\n\t\t\t\t\tconst format = getFormat( texture );\n\t\t\t\t\tconst access = this.getStorageAccess( uniform.node );\n\n\t\t\t\t\ttextureType = `texture_storage_2d<${ format }, ${ access }>`;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst componentPrefix = this.getComponentTypeFromTexture( texture ).charAt( 0 );\n\n\t\t\t\t\ttextureType = `texture${multisampled}_2d<${ componentPrefix }32>`;\n\n\t\t\t\t}\n\n\t\t\t\tbindingSnippets.push( `@binding( ${ uniformIndexes.binding ++ } ) @group( ${ uniformIndexes.group } ) var ${ uniform.name } : ${ textureType };` );\n\n\t\t\t} else if ( uniform.type === 'buffer' || uniform.type === 'storageBuffer' || uniform.type === 'indirectStorageBuffer' ) {\n\n\t\t\t\tconst bufferNode = uniform.node;\n\t\t\t\tconst bufferType = this.getType( bufferNode.bufferType );\n\t\t\t\tconst bufferCount = bufferNode.bufferCount;\n\n\t\t\t\tconst bufferCountSnippet = bufferCount > 0 && uniform.type === 'buffer' ? ', ' + bufferCount : '';\n\t\t\t\tconst bufferTypeSnippet = bufferNode.isAtomic ? `atomic<${bufferType}>` : `${bufferType}`;\n\t\t\t\tconst bufferSnippet = `\\t${ uniform.name } : array< ${ bufferTypeSnippet }${ bufferCountSnippet } >\\n`;\n\t\t\t\tconst bufferAccessMode = bufferNode.isStorageBufferNode ? `storage, ${ this.getStorageAccess( bufferNode ) }` : 'uniform';\n\n\t\t\t\tbufferSnippets.push( this._getWGSLStructBinding( 'NodeBuffer_' + bufferNode.id, bufferSnippet, bufferAccessMode, uniformIndexes.binding ++, uniformIndexes.group ) );\n\n\t\t\t} else {\n\n\t\t\t\tconst vectorType = this.getType( this.getVectorType( uniform.type ) );\n\t\t\t\tconst groupName = uniform.groupNode.name;\n\n\t\t\t\tconst group = uniformGroups[ groupName ] || ( uniformGroups[ groupName ] = {\n\t\t\t\t\tindex: uniformIndexes.binding ++,\n\t\t\t\t\tid: uniformIndexes.group,\n\t\t\t\t\tsnippets: []\n\t\t\t\t} );\n\n\t\t\t\tgroup.snippets.push( `\\t${ uniform.name } : ${ vectorType }` );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const name in uniformGroups ) {\n\n\t\t\tconst group = uniformGroups[ name ];\n\n\t\t\tstructSnippets.push( this._getWGSLStructBinding( name, group.snippets.join( ',\\n' ), 'uniform', group.index, group.id ) );\n\n\t\t}\n\n\t\tlet code = bindingSnippets.join( '\\n' );\n\t\tcode += bufferSnippets.join( '\\n' );\n\t\tcode += structSnippets.join( '\\n' );\n\n\t\treturn code;\n\n\t}\n\n\tbuildCode() {\n\n\t\tconst shadersData = this.material !== null ? { fragment: {}, vertex: {} } : { compute: {} };\n\n\t\tthis.sortBindingGroups();\n\n\t\tfor ( const shaderStage in shadersData ) {\n\n\t\t\tconst stageData = shadersData[ shaderStage ];\n\t\t\tstageData.uniforms = this.getUniforms( shaderStage );\n\t\t\tstageData.attributes = this.getAttributes( shaderStage );\n\t\t\tstageData.varyings = this.getVaryings( shaderStage );\n\t\t\tstageData.structs = this.getStructs( shaderStage );\n\t\t\tstageData.vars = this.getVars( shaderStage );\n\t\t\tstageData.codes = this.getCodes( shaderStage );\n\t\t\tstageData.directives = this.getDirectives( shaderStage );\n\t\t\tstageData.scopedArrays = this.getScopedArrays( shaderStage );\n\n\t\t\t//\n\n\t\t\tlet flow = '// code\\n\\n';\n\t\t\tflow += this.flowCode[ shaderStage ];\n\n\t\t\tconst flowNodes = this.flowNodes[ shaderStage ];\n\t\t\tconst mainNode = flowNodes[ flowNodes.length - 1 ];\n\n\t\t\tconst outputNode = mainNode.outputNode;\n\t\t\tconst isOutputStruct = ( outputNode !== undefined && outputNode.isOutputStructNode === true );\n\n\t\t\tfor ( const node of flowNodes ) {\n\n\t\t\t\tconst flowSlotData = this.getFlowData( node/*, shaderStage*/ );\n\t\t\t\tconst slotName = node.name;\n\n\t\t\t\tif ( slotName ) {\n\n\t\t\t\t\tif ( flow.length > 0 ) flow += '\\n';\n\n\t\t\t\t\tflow += `\\t// flow -> ${ slotName }\\n\\t`;\n\n\t\t\t\t}\n\n\t\t\t\tflow += `${ flowSlotData.code }\\n\\t`;\n\n\t\t\t\tif ( node === mainNode && shaderStage !== 'compute' ) {\n\n\t\t\t\t\tflow += '// result\\n\\n\\t';\n\n\t\t\t\t\tif ( shaderStage === 'vertex' ) {\n\n\t\t\t\t\t\tflow += `varyings.Vertex = ${ flowSlotData.result };`;\n\n\t\t\t\t\t} else if ( shaderStage === 'fragment' ) {\n\n\t\t\t\t\t\tif ( isOutputStruct ) {\n\n\t\t\t\t\t\t\tstageData.returnType = outputNode.nodeType;\n\n\t\t\t\t\t\t\tflow += `return ${ flowSlotData.result };`;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tlet structSnippet = '\\t@location(0) color: vec4<f32>';\n\n\t\t\t\t\t\t\tconst builtins = this.getBuiltins( 'output' );\n\n\t\t\t\t\t\t\tif ( builtins ) structSnippet += ',\\n\\t' + builtins;\n\n\t\t\t\t\t\t\tstageData.returnType = 'OutputStruct';\n\t\t\t\t\t\t\tstageData.structs += this._getWGSLStruct( 'OutputStruct', structSnippet );\n\t\t\t\t\t\t\tstageData.structs += '\\nvar<private> output : OutputStruct;\\n\\n';\n\n\t\t\t\t\t\t\tflow += `output.color = ${ flowSlotData.result };\\n\\n\\treturn output;`;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tstageData.flow = flow;\n\n\n\t\t}\n\n\t\tif ( this.material !== null ) {\n\n\t\t\tthis.vertexShader = this._getWGSLVertexCode( shadersData.vertex );\n\t\t\tthis.fragmentShader = this._getWGSLFragmentCode( shadersData.fragment );\n\n\t\t} else {\n\n\t\t\tthis.computeShader = this._getWGSLComputeCode( shadersData.compute, ( this.object.workgroupSize || [ 64 ] ).join( ', ' ) );\n\n\t\t}\n\n\t}\n\n\tgetMethod( method, output = null ) {\n\n\t\tlet wgslMethod;\n\n\t\tif ( output !== null ) {\n\n\t\t\twgslMethod = this._getWGSLMethod( method + '_' + output );\n\n\t\t}\n\n\t\tif ( wgslMethod === undefined ) {\n\n\t\t\twgslMethod = this._getWGSLMethod( method );\n\n\t\t}\n\n\t\treturn wgslMethod || method;\n\n\t}\n\n\tgetType( type ) {\n\n\t\treturn wgslTypeLib[ type ] || type;\n\n\t}\n\n\tisAvailable( name ) {\n\n\t\tlet result = supports[ name ];\n\n\t\tif ( result === undefined ) {\n\n\t\t\tif ( name === 'float32Filterable' ) {\n\n\t\t\t\tresult = this.renderer.hasFeature( 'float32-filterable' );\n\n\t\t\t}\n\n\t\t\tsupports[ name ] = result;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\t_getWGSLMethod( method ) {\n\n\t\tif ( wgslPolyfill[ method ] !== undefined ) {\n\n\t\t\tthis._include( method );\n\n\t\t}\n\n\t\treturn wgslMethods[ method ];\n\n\t}\n\n\t_include( name ) {\n\n\t\tconst codeNode = wgslPolyfill[ name ];\n\t\tcodeNode.build( this );\n\n\t\tif ( this.currentFunctionNode !== null ) {\n\n\t\t\tthis.currentFunctionNode.includes.push( codeNode );\n\n\t\t}\n\n\t\treturn codeNode;\n\n\t}\n\n\t_getWGSLVertexCode( shaderData ) {\n\n\t\treturn `${ this.getSignature() }\n// directives\n${shaderData.directives}\n\n// uniforms\n${shaderData.uniforms}\n\n// varyings\n${shaderData.varyings}\nvar<private> varyings : VaryingsStruct;\n\n// codes\n${shaderData.codes}\n\n@vertex\nfn main( ${shaderData.attributes} ) -> VaryingsStruct {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n\treturn varyings;\n\n}\n`;\n\n\t}\n\n\t_getWGSLFragmentCode( shaderData ) {\n\n\t\treturn `${ this.getSignature() }\n// global\n${ diagnostics }\n\n// uniforms\n${shaderData.uniforms}\n\n// structs\n${shaderData.structs}\n\n// codes\n${shaderData.codes}\n\n@fragment\nfn main( ${shaderData.varyings} ) -> ${shaderData.returnType} {\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n}\n`;\n\n\t}\n\n\t_getWGSLComputeCode( shaderData, workgroupSize ) {\n\n\t\treturn `${ this.getSignature() }\n// directives\n${shaderData.directives}\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n${shaderData.scopedArrays}\n\n// uniforms\n${shaderData.uniforms}\n\n// codes\n${shaderData.codes}\n\n@compute @workgroup_size( ${workgroupSize} )\nfn main( ${shaderData.attributes} ) {\n\n\t// system\n\tinstanceIndex = id.x + id.y * numWorkgroups.x * u32(${workgroupSize}) + id.z * numWorkgroups.x * numWorkgroups.y * u32(${workgroupSize});\n\n\t// vars\n\t${shaderData.vars}\n\n\t// flow\n\t${shaderData.flow}\n\n}\n`;\n\n\t}\n\n\t_getWGSLStruct( name, vars ) {\n\n\t\treturn `\nstruct ${name} {\n${vars}\n};`;\n\n\t}\n\n\t_getWGSLStructBinding( name, vars, access, binding = 0, group = 0 ) {\n\n\t\tconst structName = name + 'Struct';\n\t\tconst structSnippet = this._getWGSLStruct( structName, vars );\n\n\t\treturn `${structSnippet}\n@binding( ${binding} ) @group( ${group} )\nvar<${access}> ${name} : ${structName};`;\n\n\t}\n\n}\n\nclass WebGPUUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tgetCurrentDepthStencilFormat( renderContext ) {\n\n\t\tlet format;\n\n\t\tif ( renderContext.depthTexture !== null ) {\n\n\t\t\tformat = this.getTextureFormatGPU( renderContext.depthTexture );\n\n\t\t} else if ( renderContext.depth && renderContext.stencil ) {\n\n\t\t\tformat = GPUTextureFormat.Depth24PlusStencil8;\n\n\t\t} else if ( renderContext.depth ) {\n\n\t\t\tformat = GPUTextureFormat.Depth24Plus;\n\n\t\t}\n\n\t\treturn format;\n\n\t}\n\n\tgetTextureFormatGPU( texture ) {\n\n\t\treturn this.backend.get( texture ).format;\n\n\t}\n\n\tgetCurrentColorFormat( renderContext ) {\n\n\t\tlet format;\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tformat = this.getTextureFormatGPU( renderContext.textures[ 0 ] );\n\n\t\t} else {\n\n\t\t\tformat = this.getPreferredCanvasFormat(); // default context format\n\n\t\t}\n\n\t\treturn format;\n\n\t}\n\n\tgetCurrentColorSpace( renderContext ) {\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\treturn renderContext.textures[ 0 ].colorSpace;\n\n\t\t}\n\n\t\treturn this.backend.renderer.outputColorSpace;\n\n\t}\n\n\tgetPrimitiveTopology( object, material ) {\n\n\t\tif ( object.isPoints ) return GPUPrimitiveTopology.PointList;\n\t\telse if ( object.isLineSegments || ( object.isMesh && material.wireframe === true ) ) return GPUPrimitiveTopology.LineList;\n\t\telse if ( object.isLine ) return GPUPrimitiveTopology.LineStrip;\n\t\telse if ( object.isMesh ) return GPUPrimitiveTopology.TriangleList;\n\n\t}\n\n\tgetSampleCount( sampleCount ) {\n\n\t\tlet count = 1;\n\n\t\tif ( sampleCount > 1 ) {\n\n\t\t\t// WebGPU only supports power-of-two sample counts and 2 is not a valid value\n\t\t\tcount = Math.pow( 2, Math.floor( Math.log2( sampleCount ) ) );\n\n\t\t\tif ( count === 2 ) {\n\n\t\t\t\tcount = 4;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn count;\n\n\t}\n\n\tgetSampleCountRenderContext( renderContext ) {\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\treturn this.getSampleCount( renderContext.sampleCount );\n\n\t\t}\n\n\t\treturn this.getSampleCount( this.backend.renderer.samples );\n\n\t}\n\n\tgetPreferredCanvasFormat() {\n\n\t\t// TODO: Remove this check when Quest 34.5 is out\n\t\t// https://github.com/mrdoob/three.js/pull/29221/files#r1731833949\n\n\t\tif ( navigator.userAgent.includes( 'Quest' ) ) {\n\n\t\t\treturn GPUTextureFormat.BGRA8Unorm;\n\n\t\t} else {\n\n\t\t\treturn navigator.gpu.getPreferredCanvasFormat();\n\n\t\t}\n\n\t}\n\n}\n\nconst typedArraysToVertexFormatPrefix = new Map( [\n\t[ Int8Array, [ 'sint8', 'snorm8' ]],\n\t[ Uint8Array, [ 'uint8', 'unorm8' ]],\n\t[ Int16Array, [ 'sint16', 'snorm16' ]],\n\t[ Uint16Array, [ 'uint16', 'unorm16' ]],\n\t[ Int32Array, [ 'sint32', 'snorm32' ]],\n\t[ Uint32Array, [ 'uint32', 'unorm32' ]],\n\t[ Float32Array, [ 'float32', ]],\n] );\n\nconst typedAttributeToVertexFormatPrefix = new Map( [\n\t[ Float16BufferAttribute, [ 'float16', ]],\n] );\n\nconst typeArraysToVertexFormatPrefixForItemSize1 = new Map( [\n\t[ Int32Array, 'sint32' ],\n\t[ Int16Array, 'sint32' ], // patch for INT16\n\t[ Uint32Array, 'uint32' ],\n\t[ Uint16Array, 'uint32' ], // patch for UINT16\n\t[ Float32Array, 'float32' ]\n] );\n\nclass WebGPUAttributeUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\tcreateAttribute( attribute, usage ) {\n\n\t\tconst bufferAttribute = this._getBufferAttribute( attribute );\n\n\t\tconst backend = this.backend;\n\t\tconst bufferData = backend.get( bufferAttribute );\n\n\t\tlet buffer = bufferData.buffer;\n\n\t\tif ( buffer === undefined ) {\n\n\t\t\tconst device = backend.device;\n\n\t\t\tlet array = bufferAttribute.array;\n\n\t\t\t// patch for INT16 and UINT16\n\t\t\tif ( attribute.normalized === false && ( array.constructor === Int16Array || array.constructor === Uint16Array ) ) {\n\n\t\t\t\tconst tempArray = new Uint32Array( array.length );\n\t\t\t\tfor ( let i = 0; i < array.length; i ++ ) {\n\n\t\t\t\t\ttempArray[ i ] = array[ i ];\n\n\t\t\t\t}\n\n\t\t\t\tarray = tempArray;\n\n\t\t\t}\n\n\t\t\tbufferAttribute.array = array;\n\n\t\t\tif ( ( bufferAttribute.isStorageBufferAttribute || bufferAttribute.isStorageInstancedBufferAttribute ) && bufferAttribute.itemSize === 3 ) {\n\n\t\t\t\tarray = new array.constructor( bufferAttribute.count * 4 );\n\n\t\t\t\tfor ( let i = 0; i < bufferAttribute.count; i ++ ) {\n\n\t\t\t\t\tarray.set( bufferAttribute.array.subarray( i * 3, i * 3 + 3 ), i * 4 );\n\n\t\t\t\t}\n\n\t\t\t\t// Update BufferAttribute\n\t\t\t\tbufferAttribute.itemSize = 4;\n\t\t\t\tbufferAttribute.array = array;\n\n\t\t\t}\n\n\t\t\tconst size = array.byteLength + ( ( 4 - ( array.byteLength % 4 ) ) % 4 ); // ensure 4 byte alignment, see #20441\n\n\t\t\tbuffer = device.createBuffer( {\n\t\t\t\tlabel: bufferAttribute.name,\n\t\t\t\tsize: size,\n\t\t\t\tusage: usage,\n\t\t\t\tmappedAtCreation: true\n\t\t\t} );\n\n\t\t\tnew array.constructor( buffer.getMappedRange() ).set( array );\n\n\t\t\tbuffer.unmap();\n\n\t\t\tbufferData.buffer = buffer;\n\n\t\t}\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tconst bufferAttribute = this._getBufferAttribute( attribute );\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst buffer = backend.get( bufferAttribute ).buffer;\n\n\t\tconst array = bufferAttribute.array;\n\t\tconst updateRanges = bufferAttribute.updateRanges;\n\n\t\tif ( updateRanges.length === 0 ) {\n\n\t\t\t// Not using update ranges\n\n\t\t\tdevice.queue.writeBuffer(\n\t\t\t\tbuffer,\n\t\t\t\t0,\n\t\t\t\tarray,\n\t\t\t\t0\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tfor ( let i = 0, l = updateRanges.length; i < l; i ++ ) {\n\n\t\t\t\tconst range = updateRanges[ i ];\n\t\t\t\tdevice.queue.writeBuffer(\n\t\t\t\t\tbuffer,\n\t\t\t\t\t0,\n\t\t\t\t\tarray,\n\t\t\t\t\trange.start * array.BYTES_PER_ELEMENT,\n\t\t\t\t\trange.count * array.BYTES_PER_ELEMENT\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tbufferAttribute.clearUpdateRanges();\n\n\t\t}\n\n\t}\n\n\tcreateShaderVertexBuffers( renderObject ) {\n\n\t\tconst attributes = renderObject.getAttributes();\n\t\tconst vertexBuffers = new Map();\n\n\t\tfor ( let slot = 0; slot < attributes.length; slot ++ ) {\n\n\t\t\tconst geometryAttribute = attributes[ slot ];\n\t\t\tconst bytesPerElement = geometryAttribute.array.BYTES_PER_ELEMENT;\n\t\t\tconst bufferAttribute = this._getBufferAttribute( geometryAttribute );\n\n\t\t\tlet vertexBufferLayout = vertexBuffers.get( bufferAttribute );\n\n\t\t\tif ( vertexBufferLayout === undefined ) {\n\n\t\t\t\tlet arrayStride, stepMode;\n\n\t\t\t\tif ( geometryAttribute.isInterleavedBufferAttribute === true ) {\n\n\t\t\t\t\tarrayStride = geometryAttribute.data.stride * bytesPerElement;\n\t\t\t\t\tstepMode = geometryAttribute.data.isInstancedInterleavedBuffer ? GPUInputStepMode.Instance : GPUInputStepMode.Vertex;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarrayStride = geometryAttribute.itemSize * bytesPerElement;\n\t\t\t\t\tstepMode = geometryAttribute.isInstancedBufferAttribute ? GPUInputStepMode.Instance : GPUInputStepMode.Vertex;\n\n\t\t\t\t}\n\n\t\t\t\t// patch for INT16 and UINT16\n\t\t\t\tif ( geometryAttribute.normalized === false && ( geometryAttribute.array.constructor === Int16Array || geometryAttribute.array.constructor === Uint16Array ) ) {\n\n\t\t\t\t\tarrayStride = 4;\n\n\t\t\t\t}\n\n\t\t\t\tvertexBufferLayout = {\n\t\t\t\t\tarrayStride,\n\t\t\t\t\tattributes: [],\n\t\t\t\t\tstepMode\n\t\t\t\t};\n\n\t\t\t\tvertexBuffers.set( bufferAttribute, vertexBufferLayout );\n\n\t\t\t}\n\n\t\t\tconst format = this._getVertexFormat( geometryAttribute );\n\t\t\tconst offset = ( geometryAttribute.isInterleavedBufferAttribute === true ) ? geometryAttribute.offset * bytesPerElement : 0;\n\n\t\t\tvertexBufferLayout.attributes.push( {\n\t\t\t\tshaderLocation: slot,\n\t\t\t\toffset,\n\t\t\t\tformat\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Array.from( vertexBuffers.values() );\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst data = backend.get( this._getBufferAttribute( attribute ) );\n\n\t\tdata.buffer.destroy();\n\n\t\tbackend.delete( attribute );\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst data = backend.get( this._getBufferAttribute( attribute ) );\n\n\t\tconst bufferGPU = data.buffer;\n\t\tconst size = bufferGPU.size;\n\n\t\tconst readBufferGPU = device.createBuffer( {\n\t\t\tlabel: attribute.name,\n\t\t\tsize,\n\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ\n\t\t} );\n\n\n\t\tconst cmdEncoder = device.createCommandEncoder( {} );\n\n\t\tcmdEncoder.copyBufferToBuffer(\n\t\t\tbufferGPU,\n\t\t\t0,\n\t\t\treadBufferGPU,\n\t\t\t0,\n\t\t\tsize\n\t\t);\n\n\t\treadBufferGPU.unmap();\n\n\t\tconst gpuCommands = cmdEncoder.finish();\n\t\tdevice.queue.submit( [ gpuCommands ] );\n\n\t\tawait readBufferGPU.mapAsync( GPUMapMode.READ );\n\n\t\tconst arrayBuffer = readBufferGPU.getMappedRange();\n\n\t\treturn arrayBuffer;\n\n\t}\n\n\t_getVertexFormat( geometryAttribute ) {\n\n\t\tconst { itemSize, normalized } = geometryAttribute;\n\t\tconst ArrayType = geometryAttribute.array.constructor;\n\t\tconst AttributeType = geometryAttribute.constructor;\n\n\t\tlet format;\n\n\t\tif ( itemSize == 1 ) {\n\n\t\t\tformat = typeArraysToVertexFormatPrefixForItemSize1.get( ArrayType );\n\n\t\t} else {\n\n\t\t\tconst prefixOptions = typedAttributeToVertexFormatPrefix.get( AttributeType ) || typedArraysToVertexFormatPrefix.get( ArrayType );\n\t\t\tconst prefix = prefixOptions[ normalized ? 1 : 0 ];\n\n\t\t\tif ( prefix ) {\n\n\t\t\t\tconst bytesPerUnit = ArrayType.BYTES_PER_ELEMENT * itemSize;\n\t\t\t\tconst paddedBytesPerUnit = Math.floor( ( bytesPerUnit + 3 ) / 4 ) * 4;\n\t\t\t\tconst paddedItemSize = paddedBytesPerUnit / ArrayType.BYTES_PER_ELEMENT;\n\n\t\t\t\tif ( paddedItemSize % 1 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.WebGPUAttributeUtils: Bad vertex format item size.' );\n\n\t\t\t\t}\n\n\t\t\t\tformat = `${prefix}x${paddedItemSize}`;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ! format ) {\n\n\t\t\tconsole.error( 'THREE.WebGPUAttributeUtils: Vertex format not supported yet.' );\n\n\t\t}\n\n\t\treturn format;\n\n\t}\n\n\t_getBufferAttribute( attribute ) {\n\n\t\tif ( attribute.isInterleavedBufferAttribute ) attribute = attribute.data;\n\n\t\treturn attribute;\n\n\t}\n\n}\n\nclass WebGPUBindingUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\t\tthis.bindGroupLayoutCache = new WeakMap();\n\n\t}\n\n\tcreateBindingsLayout( bindGroup ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst entries = [];\n\n\t\tlet index = 0;\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tconst bindingGPU = {\n\t\t\t\tbinding: index ++,\n\t\t\t\tvisibility: binding.visibility\n\t\t\t};\n\n\t\t\tif ( binding.isUniformBuffer || binding.isStorageBuffer ) {\n\n\t\t\t\tconst buffer = {}; // GPUBufferBindingLayout\n\n\t\t\t\tif ( binding.isStorageBuffer ) {\n\n\t\t\t\t\tbuffer.type = binding.access;\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.buffer = buffer;\n\n\t\t\t} else if ( binding.isSampler ) {\n\n\t\t\t\tconst sampler = {}; // GPUSamplerBindingLayout\n\n\t\t\t\tif ( binding.texture.isDepthTexture ) {\n\n\t\t\t\t\tif ( binding.texture.compareFunction !== null ) {\n\n\t\t\t\t\t\tsampler.type = 'comparison';\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.sampler = sampler;\n\n\t\t\t} else if ( binding.isSampledTexture && binding.texture.isVideoTexture ) {\n\n\t\t\t\tbindingGPU.externalTexture = {}; // GPUExternalTextureBindingLayout\n\n\t\t\t} else if ( binding.isSampledTexture && binding.store ) {\n\n\t\t\t\tconst format = this.backend.get( binding.texture ).texture.format;\n\t\t\t\tconst access = binding.access;\n\n\t\t\t\tbindingGPU.storageTexture = { format, access }; // GPUStorageTextureBindingLayout\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst texture = {}; // GPUTextureBindingLayout\n\n\t\t\t\tif ( binding.texture.isMultisampleRenderTargetTexture === true ) {\n\n\t\t\t\t\ttexture.multisampled = true;\n\n\t\t\t\t}\n\n\t\t\t\tif ( binding.texture.isDepthTexture ) {\n\n\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.Depth;\n\n\t\t\t\t} else if ( binding.texture.isDataTexture || binding.texture.isDataArrayTexture || binding.texture.isData3DTexture ) {\n\n\t\t\t\t\tconst type = binding.texture.type;\n\n\t\t\t\t\tif ( type === IntType ) {\n\n\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.SInt;\n\n\t\t\t\t\t} else if ( type === UnsignedIntType ) {\n\n\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.UInt;\n\n\t\t\t\t\t} else if ( type === FloatType ) {\n\n\t\t\t\t\t\tif ( this.backend.hasFeature( 'float32-filterable' ) ) {\n\n\t\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.Float;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\ttexture.sampleType = GPUTextureSampleType.UnfilterableFloat;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( binding.isSampledCubeTexture ) {\n\n\t\t\t\t\ttexture.viewDimension = GPUTextureViewDimension.Cube;\n\n\t\t\t\t} else if ( binding.texture.isDataArrayTexture || binding.texture.isCompressedArrayTexture ) {\n\n\t\t\t\t\ttexture.viewDimension = GPUTextureViewDimension.TwoDArray;\n\n\t\t\t\t} else if ( binding.isSampledTexture3D ) {\n\n\t\t\t\t\ttexture.viewDimension = GPUTextureViewDimension.ThreeD;\n\n\t\t\t\t}\n\n\t\t\t\tbindingGPU.texture = texture;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( `WebGPUBindingUtils: Unsupported binding \"${ binding }\".` );\n\n\t\t\t}\n\n\t\t\tentries.push( bindingGPU );\n\n\t\t}\n\n\t\treturn device.createBindGroupLayout( { entries } );\n\n\t}\n\n\tcreateBindings( bindGroup ) {\n\n\t\tconst { backend, bindGroupLayoutCache } = this;\n\t\tconst bindingsData = backend.get( bindGroup );\n\n\t\t// setup (static) binding layout and (dynamic) binding group\n\n\t\tlet bindLayoutGPU = bindGroupLayoutCache.get( bindGroup.bindingsReference );\n\n\t\tif ( bindLayoutGPU === undefined ) {\n\n\t\t\tbindLayoutGPU = this.createBindingsLayout( bindGroup );\n\t\t\tbindGroupLayoutCache.set( bindGroup.bindingsReference, bindLayoutGPU );\n\n\t\t}\n\n\t\tconst bindGroupGPU = this.createBindGroup( bindGroup, bindLayoutGPU );\n\n\t\tbindingsData.layout = bindLayoutGPU;\n\t\tbindingsData.group = bindGroupGPU;\n\n\t}\n\n\tupdateBinding( binding ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst buffer = binding.buffer;\n\t\tconst bufferGPU = backend.get( binding ).buffer;\n\n\t\tdevice.queue.writeBuffer( bufferGPU, 0, buffer, 0 );\n\n\t}\n\n\tcreateBindGroup( bindGroup, layoutGPU ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tlet bindingPoint = 0;\n\t\tconst entriesGPU = [];\n\n\t\tfor ( const binding of bindGroup.bindings ) {\n\n\t\t\tif ( binding.isUniformBuffer ) {\n\n\t\t\t\tconst bindingData = backend.get( binding );\n\n\t\t\t\tif ( bindingData.buffer === undefined ) {\n\n\t\t\t\t\tconst byteLength = binding.byteLength;\n\n\t\t\t\t\tconst usage = GPUBufferUsage.UNIFORM | GPUBufferUsage.COPY_DST;\n\n\t\t\t\t\tconst bufferGPU = device.createBuffer( {\n\t\t\t\t\t\tlabel: 'bindingBuffer_' + binding.name,\n\t\t\t\t\t\tsize: byteLength,\n\t\t\t\t\t\tusage: usage\n\t\t\t\t\t} );\n\n\t\t\t\t\tbindingData.buffer = bufferGPU;\n\n\t\t\t\t}\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: { buffer: bindingData.buffer } } );\n\n\t\t\t} else if ( binding.isStorageBuffer ) {\n\n\t\t\t\tconst bindingData = backend.get( binding );\n\n\t\t\t\tif ( bindingData.buffer === undefined ) {\n\n\t\t\t\t\tconst attribute = binding.attribute;\n\t\t\t\t\t//const usage = GPUBufferUsage.STORAGE | GPUBufferUsage.VERTEX | /*GPUBufferUsage.COPY_SRC |*/ GPUBufferUsage.COPY_DST;\n\n\t\t\t\t\t//backend.attributeUtils.createAttribute( attribute, usage ); // @TODO: Move it to universal renderer\n\n\t\t\t\t\tbindingData.buffer = backend.get( attribute ).buffer;\n\n\t\t\t\t}\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: { buffer: bindingData.buffer } } );\n\n\t\t\t} else if ( binding.isSampler ) {\n\n\t\t\t\tconst textureGPU = backend.get( binding.texture );\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: textureGPU.sampler } );\n\n\t\t\t} else if ( binding.isSampledTexture ) {\n\n\t\t\t\tconst textureData = backend.get( binding.texture );\n\n\t\t\t\tlet resourceGPU;\n\n\t\t\t\tif ( textureData.externalTexture !== undefined ) {\n\n\t\t\t\t\tresourceGPU = device.importExternalTexture( { source: textureData.externalTexture } );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst mipLevelCount = binding.store ? 1 : textureData.texture.mipLevelCount;\n\t\t\t\t\tconst propertyName = `view-${ textureData.texture.width }-${ textureData.texture.height }-${ mipLevelCount }`;\n\n\t\t\t\t\tresourceGPU = textureData[ propertyName ];\n\n\t\t\t\t\tif ( resourceGPU === undefined ) {\n\n\t\t\t\t\t\tconst aspectGPU = GPUTextureAspect.All;\n\n\t\t\t\t\t\tlet dimensionViewGPU;\n\n\t\t\t\t\t\tif ( binding.isSampledCubeTexture ) {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.Cube;\n\n\t\t\t\t\t\t} else if ( binding.isSampledTexture3D ) {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.ThreeD;\n\n\t\t\t\t\t\t} else if ( binding.texture.isDataArrayTexture || binding.texture.isCompressedArrayTexture ) {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.TwoDArray;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tdimensionViewGPU = GPUTextureViewDimension.TwoD;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresourceGPU = textureData[ propertyName ] = textureData.texture.createView( { aspect: aspectGPU, dimension: dimensionViewGPU, mipLevelCount } );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tentriesGPU.push( { binding: bindingPoint, resource: resourceGPU } );\n\n\t\t\t}\n\n\t\t\tbindingPoint ++;\n\n\t\t}\n\n\t\treturn device.createBindGroup( {\n\t\t\tlabel: 'bindGroup_' + bindGroup.name,\n\t\t\tlayout: layoutGPU,\n\t\t\tentries: entriesGPU\n\t\t} );\n\n\t}\n\n}\n\nclass WebGPUPipelineUtils {\n\n\tconstructor( backend ) {\n\n\t\tthis.backend = backend;\n\n\t}\n\n\t_getSampleCount( renderObjectContext ) {\n\n\t\treturn this.backend.utils.getSampleCountRenderContext( renderObjectContext );\n\n\t}\n\n\tcreateRenderPipeline( renderObject, promises ) {\n\n\t\tconst { object, material, geometry, pipeline } = renderObject;\n\t\tconst { vertexProgram, fragmentProgram } = pipeline;\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\t\tconst utils = backend.utils;\n\n\t\tconst pipelineData = backend.get( pipeline );\n\n\t\t// bind group layouts\n\n\t\tconst bindGroupLayouts = [];\n\n\t\tfor ( const bindGroup of renderObject.getBindings() ) {\n\n\t\t\tconst bindingsData = backend.get( bindGroup );\n\n\t\t\tbindGroupLayouts.push( bindingsData.layout );\n\n\t\t}\n\n\t\t// vertex buffers\n\n\t\tconst vertexBuffers = backend.attributeUtils.createShaderVertexBuffers( renderObject );\n\n\t\t// blending\n\n\t\tlet blending;\n\n\t\tif ( material.transparent === true && material.blending !== NoBlending ) {\n\n\t\t\tblending = this._getBlending( material );\n\n\t\t}\n\n\t\t// stencil\n\n\t\tlet stencilFront = {};\n\n\t\tif ( material.stencilWrite === true ) {\n\n\t\t\tstencilFront = {\n\t\t\t\tcompare: this._getStencilCompare( material ),\n\t\t\t\tfailOp: this._getStencilOperation( material.stencilFail ),\n\t\t\t\tdepthFailOp: this._getStencilOperation( material.stencilZFail ),\n\t\t\t\tpassOp: this._getStencilOperation( material.stencilZPass )\n\t\t\t};\n\n\t\t}\n\n\t\tconst colorWriteMask = this._getColorWriteMask( material );\n\n\t\tconst targets = [];\n\n\t\tif ( renderObject.context.textures !== null ) {\n\n\t\t\tconst textures = renderObject.context.textures;\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst colorFormat = utils.getTextureFormatGPU( textures[ i ] );\n\n\t\t\t\ttargets.push( {\n\t\t\t\t\tformat: colorFormat,\n\t\t\t\t\tblend: blending,\n\t\t\t\t\twriteMask: colorWriteMask\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst colorFormat = utils.getCurrentColorFormat( renderObject.context );\n\n\t\t\ttargets.push( {\n\t\t\t\tformat: colorFormat,\n\t\t\t\tblend: blending,\n\t\t\t\twriteMask: colorWriteMask\n\t\t\t} );\n\n\t\t}\n\n\t\tconst vertexModule = backend.get( vertexProgram ).module;\n\t\tconst fragmentModule = backend.get( fragmentProgram ).module;\n\n\t\tconst primitiveState = this._getPrimitiveState( object, geometry, material );\n\t\tconst depthCompare = this._getDepthCompare( material );\n\t\tconst depthStencilFormat = utils.getCurrentDepthStencilFormat( renderObject.context );\n\n\t\tconst sampleCount = this._getSampleCount( renderObject.context );\n\n\t\tconst pipelineDescriptor = {\n\t\t\tlabel: `renderPipeline_${ material.name || material.type }_${ material.id }`,\n\t\t\tvertex: Object.assign( {}, vertexModule, { buffers: vertexBuffers } ),\n\t\t\tfragment: Object.assign( {}, fragmentModule, { targets } ),\n\t\t\tprimitive: primitiveState,\n\t\t\tmultisample: {\n\t\t\t\tcount: sampleCount,\n\t\t\t\talphaToCoverageEnabled: material.alphaToCoverage && sampleCount > 1\n\t\t\t},\n\t\t\tlayout: device.createPipelineLayout( {\n\t\t\t\tbindGroupLayouts\n\t\t\t} )\n\t\t};\n\n\n\t\tconst depthStencil = {};\n\t\tconst renderDepth = renderObject.context.depth;\n\t\tconst renderStencil = renderObject.context.stencil;\n\n\t\tif ( renderDepth === true || renderStencil === true ) {\n\n\t\t\tif ( renderDepth === true ) {\n\n\t\t\t\tdepthStencil.format = depthStencilFormat;\n\t\t\t\tdepthStencil.depthWriteEnabled = material.depthWrite;\n\t\t\t\tdepthStencil.depthCompare = depthCompare;\n\n\t\t\t}\n\n\t\t\tif ( renderStencil === true ) {\n\n\t\t\t\tdepthStencil.stencilFront = stencilFront;\n\t\t\t\tdepthStencil.stencilBack = {}; // three.js does not provide an API to configure the back function (gl.stencilFuncSeparate() was never used)\n\t\t\t\tdepthStencil.stencilReadMask = material.stencilFuncMask;\n\t\t\t\tdepthStencil.stencilWriteMask = material.stencilWriteMask;\n\n\t\t\t}\n\n\t\t\tpipelineDescriptor.depthStencil = depthStencil;\n\n\t\t}\n\n\n\t\tif ( promises === null ) {\n\n\t\t\tpipelineData.pipeline = device.createRenderPipeline( pipelineDescriptor );\n\n\t\t} else {\n\n\t\t\tconst p = new Promise( ( resolve /*, reject*/ ) => {\n\n\t\t\t\tdevice.createRenderPipelineAsync( pipelineDescriptor ).then( pipeline => {\n\n\t\t\t\t\tpipelineData.pipeline = pipeline;\n\t\t\t\t\tresolve();\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t\tpromises.push( p );\n\n\t\t}\n\n\t}\n\n\tcreateBundleEncoder( renderContext ) {\n\n\t\tconst backend = this.backend;\n\t\tconst { utils, device } = backend;\n\n\t\tconst depthStencilFormat = utils.getCurrentDepthStencilFormat( renderContext );\n\t\tconst colorFormat = utils.getCurrentColorFormat( renderContext );\n\t\tconst sampleCount = this._getSampleCount( renderContext );\n\n\t\tconst descriptor = {\n\t\t\tlabel: 'renderBundleEncoder',\n\t\t\tcolorFormats: [ colorFormat ],\n\t\t\tdepthStencilFormat,\n\t\t\tsampleCount\n\t\t};\n\n\t\treturn device.createRenderBundleEncoder( descriptor );\n\n\t}\n\n\tcreateComputePipeline( pipeline, bindings ) {\n\n\t\tconst backend = this.backend;\n\t\tconst device = backend.device;\n\n\t\tconst computeProgram = backend.get( pipeline.computeProgram ).module;\n\n\t\tconst pipelineGPU = backend.get( pipeline );\n\n\t\t// bind group layouts\n\n\t\tconst bindGroupLayouts = [];\n\n\t\tfor ( const bindingsGroup of bindings ) {\n\n\t\t\tconst bindingsData = backend.get( bindingsGroup );\n\n\t\t\tbindGroupLayouts.push( bindingsData.layout );\n\n\t\t}\n\n\t\tpipelineGPU.pipeline = device.createComputePipeline( {\n\t\t\tcompute: computeProgram,\n\t\t\tlayout: device.createPipelineLayout( {\n\t\t\t\tbindGroupLayouts\n\t\t\t} )\n\t\t} );\n\n\t}\n\n\t_getBlending( material ) {\n\n\t\tlet color, alpha;\n\n\t\tconst blending = material.blending;\n\t\tconst blendSrc = material.blendSrc;\n\t\tconst blendDst = material.blendDst;\n\t\tconst blendEquation = material.blendEquation;\n\n\n\t\tif ( blending === CustomBlending ) {\n\n\t\t\tconst blendSrcAlpha = material.blendSrcAlpha !== null ? material.blendSrcAlpha : blendSrc;\n\t\t\tconst blendDstAlpha = material.blendDstAlpha !== null ? material.blendDstAlpha : blendDst;\n\t\t\tconst blendEquationAlpha = material.blendEquationAlpha !== null ? material.blendEquationAlpha : blendEquation;\n\n\t\t\tcolor = {\n\t\t\t\tsrcFactor: this._getBlendFactor( blendSrc ),\n\t\t\t\tdstFactor: this._getBlendFactor( blendDst ),\n\t\t\t\toperation: this._getBlendOperation( blendEquation )\n\t\t\t};\n\n\t\t\talpha = {\n\t\t\t\tsrcFactor: this._getBlendFactor( blendSrcAlpha ),\n\t\t\t\tdstFactor: this._getBlendFactor( blendDstAlpha ),\n\t\t\t\toperation: this._getBlendOperation( blendEquationAlpha )\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconst premultipliedAlpha = material.premultipliedAlpha;\n\n\t\t\tconst setBlend = ( srcRGB, dstRGB, srcAlpha, dstAlpha ) => {\n\n\t\t\t\tcolor = {\n\t\t\t\t\tsrcFactor: srcRGB,\n\t\t\t\t\tdstFactor: dstRGB,\n\t\t\t\t\toperation: GPUBlendOperation.Add\n\t\t\t\t};\n\n\t\t\t\talpha = {\n\t\t\t\t\tsrcFactor: srcAlpha,\n\t\t\t\t\tdstFactor: dstAlpha,\n\t\t\t\t\toperation: GPUBlendOperation.Add\n\t\t\t\t};\n\n\t\t\t};\n\n\t\t\tif ( premultipliedAlpha ) {\n\n\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.One, GPUBlendFactor.OneMinusSrcAlpha, GPUBlendFactor.One, GPUBlendFactor.OneMinusSrcAlpha );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.One, GPUBlendFactor.One, GPUBlendFactor.One, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.OneMinusSrc, GPUBlendFactor.Zero, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.Src, GPUBlendFactor.Zero, GPUBlendFactor.SrcAlpha );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tswitch ( blending ) {\n\n\t\t\t\t\tcase NormalBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.SrcAlpha, GPUBlendFactor.OneMinusSrcAlpha, GPUBlendFactor.One, GPUBlendFactor.OneMinusSrcAlpha );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase AdditiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.SrcAlpha, GPUBlendFactor.One, GPUBlendFactor.SrcAlpha, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase SubtractiveBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.OneMinusSrc, GPUBlendFactor.Zero, GPUBlendFactor.One );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase MultiplyBlending:\n\t\t\t\t\t\tsetBlend( GPUBlendFactor.Zero, GPUBlendFactor.Src, GPUBlendFactor.Zero, GPUBlendFactor.Src );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( color !== undefined && alpha !== undefined ) {\n\n\t\t\treturn { color, alpha };\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.WebGPURenderer: Invalid blending: ', blending );\n\n\t\t}\n\n\t}\n\n\t_getBlendFactor( blend ) {\n\n\t\tlet blendFactor;\n\n\t\tswitch ( blend ) {\n\n\t\t\tcase ZeroFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Zero;\n\t\t\t\tbreak;\n\n\t\t\tcase OneFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.One;\n\t\t\t\tbreak;\n\n\t\t\tcase SrcColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Src;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusSrcColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusSrc;\n\t\t\t\tbreak;\n\n\t\t\tcase SrcAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.SrcAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusSrcAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusSrcAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase DstColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Dst;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusDstColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusDstColor;\n\t\t\t\tbreak;\n\n\t\t\tcase DstAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.DstAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusDstAlphaFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusDstAlpha;\n\t\t\t\tbreak;\n\n\t\t\tcase SrcAlphaSaturateFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.SrcAlphaSaturated;\n\t\t\t\tbreak;\n\n\t\t\tcase BlendColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.Constant;\n\t\t\t\tbreak;\n\n\t\t\tcase OneMinusBlendColorFactor:\n\t\t\t\tblendFactor = GPUBlendFactor.OneMinusConstant;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPURenderer: Blend factor not supported.', blend );\n\n\t\t}\n\n\t\treturn blendFactor;\n\n\t}\n\n\t_getStencilCompare( material ) {\n\n\t\tlet stencilCompare;\n\n\t\tconst stencilFunc = material.stencilFunc;\n\n\t\tswitch ( stencilFunc ) {\n\n\t\t\tcase NeverStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Never;\n\t\t\t\tbreak;\n\n\t\t\tcase AlwaysStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Always;\n\t\t\t\tbreak;\n\n\t\t\tcase LessStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Less;\n\t\t\t\tbreak;\n\n\t\t\tcase LessEqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.LessEqual;\n\t\t\t\tbreak;\n\n\t\t\tcase EqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Equal;\n\t\t\t\tbreak;\n\n\t\t\tcase GreaterEqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.GreaterEqual;\n\t\t\t\tbreak;\n\n\t\t\tcase GreaterStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.Greater;\n\t\t\t\tbreak;\n\n\t\t\tcase NotEqualStencilFunc:\n\t\t\t\tstencilCompare = GPUCompareFunction.NotEqual;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPURenderer: Invalid stencil function.', stencilFunc );\n\n\t\t}\n\n\t\treturn stencilCompare;\n\n\t}\n\n\t_getStencilOperation( op ) {\n\n\t\tlet stencilOperation;\n\n\t\tswitch ( op ) {\n\n\t\t\tcase KeepStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Keep;\n\t\t\t\tbreak;\n\n\t\t\tcase ZeroStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Zero;\n\t\t\t\tbreak;\n\n\t\t\tcase ReplaceStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Replace;\n\t\t\t\tbreak;\n\n\t\t\tcase InvertStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.Invert;\n\t\t\t\tbreak;\n\n\t\t\tcase IncrementStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.IncrementClamp;\n\t\t\t\tbreak;\n\n\t\t\tcase DecrementStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.DecrementClamp;\n\t\t\t\tbreak;\n\n\t\t\tcase IncrementWrapStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.IncrementWrap;\n\t\t\t\tbreak;\n\n\t\t\tcase DecrementWrapStencilOp:\n\t\t\t\tstencilOperation = GPUStencilOperation.DecrementWrap;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPURenderer: Invalid stencil operation.', stencilOperation );\n\n\t\t}\n\n\t\treturn stencilOperation;\n\n\t}\n\n\t_getBlendOperation( blendEquation ) {\n\n\t\tlet blendOperation;\n\n\t\tswitch ( blendEquation ) {\n\n\t\t\tcase AddEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Add;\n\t\t\t\tbreak;\n\n\t\t\tcase SubtractEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Subtract;\n\t\t\t\tbreak;\n\n\t\t\tcase ReverseSubtractEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.ReverseSubtract;\n\t\t\t\tbreak;\n\n\t\t\tcase MinEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Min;\n\t\t\t\tbreak;\n\n\t\t\tcase MaxEquation:\n\t\t\t\tblendOperation = GPUBlendOperation.Max;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPUPipelineUtils: Blend equation not supported.', blendEquation );\n\n\t\t}\n\n\t\treturn blendOperation;\n\n\t}\n\n\t_getPrimitiveState( object, geometry, material ) {\n\n\t\tconst descriptor = {};\n\t\tconst utils = this.backend.utils;\n\n\t\tdescriptor.topology = utils.getPrimitiveTopology( object, material );\n\n\t\tif ( geometry.index !== null && object.isLine === true && object.isLineSegments !== true ) {\n\n\t\t\tdescriptor.stripIndexFormat = ( geometry.index.array instanceof Uint16Array ) ? GPUIndexFormat.Uint16 : GPUIndexFormat.Uint32;\n\n\t\t}\n\n\t\tswitch ( material.side ) {\n\n\t\t\tcase FrontSide:\n\t\t\t\tdescriptor.frontFace = GPUFrontFace.CCW;\n\t\t\t\tdescriptor.cullMode = GPUCullMode.Back;\n\t\t\t\tbreak;\n\n\t\t\tcase BackSide:\n\t\t\t\tdescriptor.frontFace = GPUFrontFace.CCW;\n\t\t\t\tdescriptor.cullMode = GPUCullMode.Front;\n\t\t\t\tbreak;\n\n\t\t\tcase DoubleSide:\n\t\t\t\tdescriptor.frontFace = GPUFrontFace.CCW;\n\t\t\t\tdescriptor.cullMode = GPUCullMode.None;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error( 'THREE.WebGPUPipelineUtils: Unknown material.side value.', material.side );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\treturn descriptor;\n\n\t}\n\n\t_getColorWriteMask( material ) {\n\n\t\treturn ( material.colorWrite === true ) ? GPUColorWriteFlags.All : GPUColorWriteFlags.None;\n\n\t}\n\n\t_getDepthCompare( material ) {\n\n\t\tlet depthCompare;\n\n\t\tif ( material.depthTest === false ) {\n\n\t\t\tdepthCompare = GPUCompareFunction.Always;\n\n\t\t} else {\n\n\t\t\tconst depthFunc = material.depthFunc;\n\n\t\t\tswitch ( depthFunc ) {\n\n\t\t\t\tcase NeverDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Never;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AlwaysDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Always;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Less;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase LessEqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.LessEqual;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase EqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Equal;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterEqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.GreaterEqual;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase GreaterDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.Greater;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase NotEqualDepth:\n\t\t\t\t\tdepthCompare = GPUCompareFunction.NotEqual;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.error( 'THREE.WebGPUPipelineUtils: Invalid depth function.', depthFunc );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn depthCompare;\n\n\t}\n\n}\n\n/*// debugger tools\nimport 'https://greggman.github.io/webgpu-avoid-redundant-state-setting/webgpu-check-redundant-state-setting.js';\n//*/\n\n\n//\n\nclass WebGPUBackend extends Backend {\n\n\tconstructor( parameters = {} ) {\n\n\t\tsuper( parameters );\n\n\t\tthis.isWebGPUBackend = true;\n\n\t\t// some parameters require default values other than \"undefined\"\n\t\tthis.parameters.alpha = ( parameters.alpha === undefined ) ? true : parameters.alpha;\n\n\t\tthis.parameters.requiredLimits = ( parameters.requiredLimits === undefined ) ? {} : parameters.requiredLimits;\n\n\t\tthis.trackTimestamp = ( parameters.trackTimestamp === true );\n\n\t\tthis.device = null;\n\t\tthis.context = null;\n\t\tthis.colorBuffer = null;\n\t\tthis.defaultRenderPassdescriptor = null;\n\n\t\tthis.utils = new WebGPUUtils( this );\n\t\tthis.attributeUtils = new WebGPUAttributeUtils( this );\n\t\tthis.bindingUtils = new WebGPUBindingUtils( this );\n\t\tthis.pipelineUtils = new WebGPUPipelineUtils( this );\n\t\tthis.textureUtils = new WebGPUTextureUtils( this );\n\t\tthis.occludedResolveCache = new Map();\n\n\t}\n\n\tasync init( renderer ) {\n\n\t\tawait super.init( renderer );\n\n\t\t//\n\n\t\tconst parameters = this.parameters;\n\n\t\t// create the device if it is not passed with parameters\n\n\t\tlet device;\n\n\t\tif ( parameters.device === undefined ) {\n\n\t\t\tconst adapterOptions = {\n\t\t\t\tpowerPreference: parameters.powerPreference\n\t\t\t};\n\n\t\t\tconst adapter = await navigator.gpu.requestAdapter( adapterOptions );\n\n\t\t\tif ( adapter === null ) {\n\n\t\t\t\tthrow new Error( 'WebGPUBackend: Unable to create WebGPU adapter.' );\n\n\t\t\t}\n\n\t\t\t// feature support\n\n\t\t\tconst features = Object.values( GPUFeatureName );\n\n\t\t\tconst supportedFeatures = [];\n\n\t\t\tfor ( const name of features ) {\n\n\t\t\t\tif ( adapter.features.has( name ) ) {\n\n\t\t\t\t\tsupportedFeatures.push( name );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst deviceDescriptor = {\n\t\t\t\trequiredFeatures: supportedFeatures,\n\t\t\t\trequiredLimits: parameters.requiredLimits\n\t\t\t};\n\n\t\t\tdevice = await adapter.requestDevice( deviceDescriptor );\n\n\t\t} else {\n\n\t\t\tdevice = parameters.device;\n\n\t\t}\n\n\t\tdevice.lost.then( ( info ) => {\n\n\t\t\tconst deviceLossInfo = {\n\t\t\t\tapi: 'WebGPU',\n\t\t\t\tmessage: info.message || 'Unknown reason',\n\t\t\t\treason: info.reason || null,\n\t\t\t\toriginalEvent: info\n\t\t\t};\n\n\t\t\trenderer.onDeviceLost( deviceLossInfo );\n\n\t\t} );\n\n\t\tconst context = ( parameters.context !== undefined ) ? parameters.context : renderer.domElement.getContext( 'webgpu' );\n\n\t\tthis.device = device;\n\t\tthis.context = context;\n\n\t\tconst alphaMode = parameters.alpha ? 'premultiplied' : 'opaque';\n\n\t\tthis.trackTimestamp = this.trackTimestamp && this.hasFeature( GPUFeatureName.TimestampQuery );\n\n\t\tthis.context.configure( {\n\t\t\tdevice: this.device,\n\t\t\tformat: this.utils.getPreferredCanvasFormat(),\n\t\t\tusage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n\t\t\talphaMode: alphaMode\n\t\t} );\n\n\t\tthis.updateSize();\n\n\t}\n\n\tget coordinateSystem() {\n\n\t\treturn WebGPUCoordinateSystem;\n\n\t}\n\n\tasync getArrayBufferAsync( attribute ) {\n\n\t\treturn await this.attributeUtils.getArrayBufferAsync( attribute );\n\n\t}\n\n\tgetContext() {\n\n\t\treturn this.context;\n\n\t}\n\n\t_getDefaultRenderPassDescriptor() {\n\n\t\tlet descriptor = this.defaultRenderPassdescriptor;\n\n\t\tif ( descriptor === null ) {\n\n\t\t\tconst renderer = this.renderer;\n\n\t\t\tdescriptor = {\n\t\t\t\tcolorAttachments: [ {\n\t\t\t\t\tview: null\n\t\t\t\t} ],\n\t\t\t};\n\n\t\t\tif ( this.renderer.depth === true || this.renderer.stencil === true ) {\n\n\t\t\t\tdescriptor.depthStencilAttachment = {\n\t\t\t\t\tview: this.textureUtils.getDepthBuffer( renderer.depth, renderer.stencil ).createView()\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t\tconst colorAttachment = descriptor.colorAttachments[ 0 ];\n\n\t\t\tif ( this.renderer.samples > 0 ) {\n\n\t\t\t\tcolorAttachment.view = this.colorBuffer.createView();\n\n\t\t\t} else {\n\n\t\t\t\tcolorAttachment.resolveTarget = undefined;\n\n\t\t\t}\n\n\t\t\tthis.defaultRenderPassdescriptor = descriptor;\n\n\t\t}\n\n\t\tconst colorAttachment = descriptor.colorAttachments[ 0 ];\n\n\t\tif ( this.renderer.samples > 0 ) {\n\n\t\t\tcolorAttachment.resolveTarget = this.context.getCurrentTexture().createView();\n\n\t\t} else {\n\n\t\t\tcolorAttachment.view = this.context.getCurrentTexture().createView();\n\n\t\t}\n\n\t\treturn descriptor;\n\n\t}\n\n\t_getRenderPassDescriptor( renderContext ) {\n\n\t\tconst renderTarget = renderContext.renderTarget;\n\t\tconst renderTargetData = this.get( renderTarget );\n\n\t\tlet descriptors = renderTargetData.descriptors;\n\n\t\tif ( descriptors === undefined ||\n\t\t\trenderTargetData.width !== renderTarget.width ||\n\t\t\trenderTargetData.height !== renderTarget.height ||\n\t\t\trenderTargetData.activeMipmapLevel !== renderTarget.activeMipmapLevel ||\n\t\t\trenderTargetData.samples !== renderTarget.samples\n\t\t) {\n\n\t\t\tdescriptors = {};\n\n\t\t\trenderTargetData.descriptors = descriptors;\n\n\t\t\t// dispose\n\n\t\t\tconst onDispose = () => {\n\n\t\t\t\trenderTarget.removeEventListener( 'dispose', onDispose );\n\n\t\t\t\tthis.delete( renderTarget );\n\n\t\t\t};\n\n\t\t\trenderTarget.addEventListener( 'dispose', onDispose );\n\n\t\t}\n\n\t\tconst cacheKey = renderContext.getCacheKey();\n\n\t\tlet descriptor = descriptors[ cacheKey ];\n\n\t\tif ( descriptor === undefined ) {\n\n\t\t\tconst textures = renderContext.textures;\n\t\t\tconst colorAttachments = [];\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst textureData = this.get( textures[ i ] );\n\n\t\t\t\tconst textureView = textureData.texture.createView( {\n\t\t\t\t\tbaseMipLevel: renderContext.activeMipmapLevel,\n\t\t\t\t\tmipLevelCount: 1,\n\t\t\t\t\tbaseArrayLayer: renderContext.activeCubeFace,\n\t\t\t\t\tdimension: GPUTextureViewDimension.TwoD\n\t\t\t\t} );\n\n\t\t\t\tlet view, resolveTarget;\n\n\t\t\t\tif ( textureData.msaaTexture !== undefined ) {\n\n\t\t\t\t\tview = textureData.msaaTexture.createView();\n\t\t\t\t\tresolveTarget = textureView;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tview = textureView;\n\t\t\t\t\tresolveTarget = undefined;\n\n\t\t\t\t}\n\n\t\t\t\tcolorAttachments.push( {\n\t\t\t\t\tview,\n\t\t\t\t\tresolveTarget,\n\t\t\t\t\tloadOp: GPULoadOp.Load,\n\t\t\t\t\tstoreOp: GPUStoreOp.Store\n\t\t\t\t} );\n\n\t\t\t}\n\n\n\t\t\tdescriptor = {\n\t\t\t\tcolorAttachments,\n\t\t\t};\n\n\t\t\tif ( renderContext.depth ) {\n\n\t\t\t\tconst depthTextureData = this.get( renderContext.depthTexture );\n\n\t\t\t\tconst depthStencilAttachment = {\n\t\t\t\t\tview: depthTextureData.texture.createView()\n\t\t\t\t};\n\t\t\t\tdescriptor.depthStencilAttachment = depthStencilAttachment;\n\n\t\t\t}\n\n\t\t\tdescriptors[ cacheKey ] = descriptor;\n\n\t\t\trenderTargetData.width = renderTarget.width;\n\t\t\trenderTargetData.height = renderTarget.height;\n\t\t\trenderTargetData.samples = renderTarget.samples;\n\t\t\trenderTargetData.activeMipmapLevel = renderTarget.activeMipmapLevel;\n\n\t\t}\n\n\t\treturn descriptor;\n\n\t}\n\n\tbeginRender( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tconst device = this.device;\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tlet occlusionQuerySet;\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\tif ( renderContextData.currentOcclusionQuerySet ) renderContextData.currentOcclusionQuerySet.destroy();\n\t\t\tif ( renderContextData.currentOcclusionQueryBuffer ) renderContextData.currentOcclusionQueryBuffer.destroy();\n\n\t\t\t// Get a reference to the array of objects with queries. The renderContextData property\n\t\t\t// can be changed by another render pass before the buffer.mapAsyc() completes.\n\t\t\trenderContextData.currentOcclusionQuerySet = renderContextData.occlusionQuerySet;\n\t\t\trenderContextData.currentOcclusionQueryBuffer = renderContextData.occlusionQueryBuffer;\n\t\t\trenderContextData.currentOcclusionQueryObjects = renderContextData.occlusionQueryObjects;\n\n\t\t\t//\n\n\t\t\tocclusionQuerySet = device.createQuerySet( { type: 'occlusion', count: occlusionQueryCount } );\n\n\t\t\trenderContextData.occlusionQuerySet = occlusionQuerySet;\n\t\t\trenderContextData.occlusionQueryIndex = 0;\n\t\t\trenderContextData.occlusionQueryObjects = new Array( occlusionQueryCount );\n\n\t\t\trenderContextData.lastOcclusionObject = null;\n\n\t\t}\n\n\t\tlet descriptor;\n\n\t\tif ( renderContext.textures === null ) {\n\n\t\t\tdescriptor = this._getDefaultRenderPassDescriptor();\n\n\t\t} else {\n\n\t\t\tdescriptor = this._getRenderPassDescriptor( renderContext );\n\n\t\t}\n\n\t\tthis.initTimestampQuery( renderContext, descriptor );\n\n\t\tdescriptor.occlusionQuerySet = occlusionQuerySet;\n\n\t\tconst depthStencilAttachment = descriptor.depthStencilAttachment;\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tconst colorAttachments = descriptor.colorAttachments;\n\n\t\t\tfor ( let i = 0; i < colorAttachments.length; i ++ ) {\n\n\t\t\t\tconst colorAttachment = colorAttachments[ i ];\n\n\t\t\t\tif ( renderContext.clearColor ) {\n\n\t\t\t\t\tcolorAttachment.clearValue = i === 0 ? renderContext.clearColorValue : { r: 0, g: 0, b: 0, a: 1 };\n\t\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Clear;\n\t\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Load;\n\t\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconst colorAttachment = descriptor.colorAttachments[ 0 ];\n\n\t\t\tif ( renderContext.clearColor ) {\n\n\t\t\t\tcolorAttachment.clearValue = renderContext.clearColorValue;\n\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Clear;\n\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Load;\n\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( renderContext.depth ) {\n\n\t\t\tif ( renderContext.clearDepth ) {\n\n\t\t\t\tdepthStencilAttachment.depthClearValue = renderContext.clearDepthValue;\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( renderContext.stencil ) {\n\n\t\t\tif ( renderContext.clearStencil ) {\n\n\t\t\t\tdepthStencilAttachment.stencilClearValue = renderContext.clearStencilValue;\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst encoder = device.createCommandEncoder( { label: 'renderContext_' + renderContext.id } );\n\t\tconst currentPass = encoder.beginRenderPass( descriptor );\n\n\t\t//\n\n\t\trenderContextData.descriptor = descriptor;\n\t\trenderContextData.encoder = encoder;\n\t\trenderContextData.currentPass = currentPass;\n\t\trenderContextData.currentSets = { attributes: {}, bindingGroups: [], pipeline: null, index: null };\n\t\trenderContextData.renderBundles = [];\n\n\t\t//\n\n\t\tif ( renderContext.viewport ) {\n\n\t\t\tthis.updateViewport( renderContext );\n\n\t\t}\n\n\t\tif ( renderContext.scissor ) {\n\n\t\t\tconst { x, y, width, height } = renderContext.scissorValue;\n\n\t\t\tcurrentPass.setScissorRect( x, y, width, height );\n\n\t\t}\n\n\t}\n\n\tfinishRender( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\t\tconst occlusionQueryCount = renderContext.occlusionQueryCount;\n\n\t\tif ( renderContextData.renderBundles.length > 0 ) {\n\n\t\t\trenderContextData.currentPass.executeBundles( renderContextData.renderBundles );\n\n\t\t}\n\n\t\tif ( occlusionQueryCount > renderContextData.occlusionQueryIndex ) {\n\n\t\t\trenderContextData.currentPass.endOcclusionQuery();\n\n\t\t}\n\n\t\trenderContextData.currentPass.end();\n\n\t\tif ( occlusionQueryCount > 0 ) {\n\n\t\t\tconst bufferSize = occlusionQueryCount * 8; // 8 byte entries for query results\n\n\t\t\t//\n\n\t\t\tlet queryResolveBuffer = this.occludedResolveCache.get( bufferSize );\n\n\t\t\tif ( queryResolveBuffer === undefined ) {\n\n\t\t\t\tqueryResolveBuffer = this.device.createBuffer(\n\t\t\t\t\t{\n\t\t\t\t\t\tsize: bufferSize,\n\t\t\t\t\t\tusage: GPUBufferUsage.QUERY_RESOLVE | GPUBufferUsage.COPY_SRC\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.occludedResolveCache.set( bufferSize, queryResolveBuffer );\n\n\t\t\t}\n\n\t\t\t//\n\n\t\t\tconst readBuffer = this.device.createBuffer(\n\t\t\t\t{\n\t\t\t\t\tsize: bufferSize,\n\t\t\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ\n\t\t\t\t}\n\t\t\t);\n\n\t\t\t// two buffers required here - WebGPU doesn't allow usage of QUERY_RESOLVE & MAP_READ to be combined\n\t\t\trenderContextData.encoder.resolveQuerySet( renderContextData.occlusionQuerySet, 0, occlusionQueryCount, queryResolveBuffer, 0 );\n\t\t\trenderContextData.encoder.copyBufferToBuffer( queryResolveBuffer, 0, readBuffer, 0, bufferSize );\n\n\t\t\trenderContextData.occlusionQueryBuffer = readBuffer;\n\n\t\t\t//\n\n\t\t\tthis.resolveOccludedAsync( renderContext );\n\n\t\t}\n\n\t\tthis.prepareTimestampBuffer( renderContext, renderContextData.encoder );\n\n\t\tthis.device.queue.submit( [ renderContextData.encoder.finish() ] );\n\n\n\t\t//\n\n\t\tif ( renderContext.textures !== null ) {\n\n\t\t\tconst textures = renderContext.textures;\n\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\n\n\t\t\t\tconst texture = textures[ i ];\n\n\t\t\t\tif ( texture.generateMipmaps === true ) {\n\n\t\t\t\t\tthis.textureUtils.generateMipmaps( texture );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tisOccluded( renderContext, object ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\treturn renderContextData.occluded && renderContextData.occluded.has( object );\n\n\t}\n\n\tasync resolveOccludedAsync( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\t// handle occlusion query results\n\n\t\tconst { currentOcclusionQueryBuffer, currentOcclusionQueryObjects } = renderContextData;\n\n\t\tif ( currentOcclusionQueryBuffer && currentOcclusionQueryObjects ) {\n\n\t\t\tconst occluded = new WeakSet();\n\n\t\t\trenderContextData.currentOcclusionQueryObjects = null;\n\t\t\trenderContextData.currentOcclusionQueryBuffer = null;\n\n\t\t\tawait currentOcclusionQueryBuffer.mapAsync( GPUMapMode.READ );\n\n\t\t\tconst buffer = currentOcclusionQueryBuffer.getMappedRange();\n\t\t\tconst results = new BigUint64Array( buffer );\n\n\t\t\tfor ( let i = 0; i < currentOcclusionQueryObjects.length; i ++ ) {\n\n\t\t\t\tif ( results[ i ] !== BigInt( 0 ) ) {\n\n\t\t\t\t\toccluded.add( currentOcclusionQueryObjects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tcurrentOcclusionQueryBuffer.destroy();\n\n\t\t\trenderContextData.occluded = occluded;\n\n\t\t}\n\n\t}\n\n\tupdateViewport( renderContext ) {\n\n\t\tconst { currentPass } = this.get( renderContext );\n\t\tconst { x, y, width, height, minDepth, maxDepth } = renderContext.viewportValue;\n\n\t\tcurrentPass.setViewport( x, y, width, height, minDepth, maxDepth );\n\n\t}\n\n\tclear( color, depth, stencil, renderTargetData = null ) {\n\n\t\tconst device = this.device;\n\t\tconst renderer = this.renderer;\n\n\t\tlet colorAttachments = [];\n\n\t\tlet depthStencilAttachment;\n\t\tlet clearValue;\n\n\t\tlet supportsDepth;\n\t\tlet supportsStencil;\n\n\t\tif ( color ) {\n\n\t\t\tconst clearColor = this.getClearColor();\n\n\t\t\tif ( this.renderer.alpha === true ) {\n\n\t\t\t\t// premultiply alpha\n\n\t\t\t\tconst a = clearColor.a;\n\n\t\t\t\tclearValue = { r: clearColor.r * a, g: clearColor.g * a, b: clearColor.b * a, a: a };\n\n\t\t\t} else {\n\n\t\t\t\tclearValue = { r: clearColor.r, g: clearColor.g, b: clearColor.b, a: clearColor.a };\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( renderTargetData === null ) {\n\n\t\t\tsupportsDepth = renderer.depth;\n\t\t\tsupportsStencil = renderer.stencil;\n\n\t\t\tconst descriptor = this._getDefaultRenderPassDescriptor();\n\n\t\t\tif ( color ) {\n\n\t\t\t\tcolorAttachments = descriptor.colorAttachments;\n\n\t\t\t\tconst colorAttachment = colorAttachments[ 0 ];\n\n\t\t\t\tcolorAttachment.clearValue = clearValue;\n\t\t\t\tcolorAttachment.loadOp = GPULoadOp.Clear;\n\t\t\t\tcolorAttachment.storeOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t\tif ( supportsDepth || supportsStencil ) {\n\n\t\t\t\tdepthStencilAttachment = descriptor.depthStencilAttachment;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tsupportsDepth = renderTargetData.depth;\n\t\t\tsupportsStencil = renderTargetData.stencil;\n\n\t\t\tif ( color ) {\n\n\t\t\t\tfor ( const texture of renderTargetData.textures ) {\n\n\t\t\t\t\tconst textureData = this.get( texture );\n\t\t\t\t\tconst textureView = textureData.texture.createView();\n\n\t\t\t\t\tlet view, resolveTarget;\n\n\t\t\t\t\tif ( textureData.msaaTexture !== undefined ) {\n\n\t\t\t\t\t\tview = textureData.msaaTexture.createView();\n\t\t\t\t\t\tresolveTarget = textureView;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tview = textureView;\n\t\t\t\t\t\tresolveTarget = undefined;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcolorAttachments.push( {\n\t\t\t\t\t\tview,\n\t\t\t\t\t\tresolveTarget,\n\t\t\t\t\t\tclearValue,\n\t\t\t\t\t\tloadOp: GPULoadOp.Clear,\n\t\t\t\t\t\tstoreOp: GPUStoreOp.Store\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( supportsDepth || supportsStencil ) {\n\n\t\t\t\tconst depthTextureData = this.get( renderTargetData.depthTexture );\n\n\t\t\t\tdepthStencilAttachment = {\n\t\t\t\t\tview: depthTextureData.texture.createView()\n\t\t\t\t};\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( supportsDepth ) {\n\n\t\t\tif ( depth ) {\n\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.depthClearValue = renderer.getClearDepth();\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.depthLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.depthStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tif ( supportsStencil ) {\n\n\t\t\tif ( stencil ) {\n\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Clear;\n\t\t\t\tdepthStencilAttachment.stencilClearValue = renderer.getClearStencil();\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t} else {\n\n\t\t\t\tdepthStencilAttachment.stencilLoadOp = GPULoadOp.Load;\n\t\t\t\tdepthStencilAttachment.stencilStoreOp = GPUStoreOp.Store;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst encoder = device.createCommandEncoder( {} );\n\t\tconst currentPass = encoder.beginRenderPass( {\n\t\t\tcolorAttachments,\n\t\t\tdepthStencilAttachment\n\t\t} );\n\n\t\tcurrentPass.end();\n\n\t\tdevice.queue.submit( [ encoder.finish() ] );\n\n\t}\n\n\t// compute\n\n\tbeginCompute( computeGroup ) {\n\n\t\tconst groupGPU = this.get( computeGroup );\n\n\n\t\tconst descriptor = {};\n\n\t\tthis.initTimestampQuery( computeGroup, descriptor );\n\n\t\tgroupGPU.cmdEncoderGPU = this.device.createCommandEncoder();\n\n\t\tgroupGPU.passEncoderGPU = groupGPU.cmdEncoderGPU.beginComputePass( descriptor );\n\n\t}\n\n\tcompute( computeGroup, computeNode, bindings, pipeline ) {\n\n\t\tconst { passEncoderGPU } = this.get( computeGroup );\n\n\t\t// pipeline\n\n\t\tconst pipelineGPU = this.get( pipeline ).pipeline;\n\t\tpassEncoderGPU.setPipeline( pipelineGPU );\n\n\t\t// bind groups\n\n\t\tfor ( let i = 0, l = bindings.length; i < l; i ++ ) {\n\n\t\t\tconst bindGroup = bindings[ i ];\n\t\t\tconst bindingsData = this.get( bindGroup );\n\n\t\t\tpassEncoderGPU.setBindGroup( i, bindingsData.group );\n\n\t\t}\n\n\t\tconst maxComputeWorkgroupsPerDimension = this.device.limits.maxComputeWorkgroupsPerDimension;\n\n\t\tconst computeNodeData = this.get( computeNode );\n\n\t\tif ( computeNodeData.dispatchSize === undefined ) computeNodeData.dispatchSize = { x: 0, y: 1, z: 1 };\n\n\t\tconst { dispatchSize } = computeNodeData;\n\n\t\tif ( computeNode.dispatchCount > maxComputeWorkgroupsPerDimension ) {\n\n\t\t\tdispatchSize.x = Math.min( computeNode.dispatchCount, maxComputeWorkgroupsPerDimension );\n\t\t\tdispatchSize.y = Math.ceil( computeNode.dispatchCount / maxComputeWorkgroupsPerDimension );\n\n\t\t} else {\n\n\t\t\tdispatchSize.x = computeNode.dispatchCount;\n\n\t\t}\n\n\t\tpassEncoderGPU.dispatchWorkgroups(\n\t\t\tdispatchSize.x,\n\t\t\tdispatchSize.y,\n\t\t\tdispatchSize.z\n\t\t);\n\n\t}\n\n\tfinishCompute( computeGroup ) {\n\n\t\tconst groupData = this.get( computeGroup );\n\n\t\tgroupData.passEncoderGPU.end();\n\n\t\tthis.prepareTimestampBuffer( computeGroup, groupData.cmdEncoderGPU );\n\n\t\tthis.device.queue.submit( [ groupData.cmdEncoderGPU.finish() ] );\n\n\t}\n\n\tasync waitForGPU() {\n\n\t\tawait this.device.queue.onSubmittedWorkDone();\n\n\t}\n\n\t// render object\n\n\tdraw( renderObject, info ) {\n\n\t\tconst { object, context, pipeline } = renderObject;\n\t\tconst bindings = renderObject.getBindings();\n\t\tconst renderContextData = this.get( context );\n\t\tconst pipelineGPU = this.get( pipeline ).pipeline;\n\t\tconst currentSets = renderContextData.currentSets;\n\t\tconst passEncoderGPU = renderContextData.currentPass;\n\n\t\tconst drawParams = renderObject.getDrawParameters();\n\n\t\tif ( drawParams === null ) return;\n\n\t\t// pipeline\n\n\t\tif ( currentSets.pipeline !== pipelineGPU ) {\n\n\t\t\tpassEncoderGPU.setPipeline( pipelineGPU );\n\n\t\t\tcurrentSets.pipeline = pipelineGPU;\n\n\t\t}\n\n\t\t// bind groups\n\n\t\tconst currentBindingGroups = currentSets.bindingGroups;\n\n\t\tfor ( let i = 0, l = bindings.length; i < l; i ++ ) {\n\n\t\t\tconst bindGroup = bindings[ i ];\n\t\t\tconst bindingsData = this.get( bindGroup );\n\n\t\t\tif ( currentBindingGroups[ bindGroup.index ] !== bindGroup.id ) {\n\n\t\t\t\tpassEncoderGPU.setBindGroup( bindGroup.index, bindingsData.group );\n\t\t\t\tcurrentBindingGroups[ bindGroup.index ] = bindGroup.id;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// attributes\n\n\t\tconst index = renderObject.getIndex();\n\n\t\tconst hasIndex = ( index !== null );\n\n\t\t// index\n\n\t\tif ( hasIndex === true ) {\n\n\t\t\tif ( currentSets.index !== index ) {\n\n\t\t\t\tconst buffer = this.get( index ).buffer;\n\t\t\t\tconst indexFormat = ( index.array instanceof Uint16Array ) ? GPUIndexFormat.Uint16 : GPUIndexFormat.Uint32;\n\n\t\t\t\tpassEncoderGPU.setIndexBuffer( buffer, indexFormat );\n\n\t\t\t\tcurrentSets.index = index;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// vertex buffers\n\n\t\tconst vertexBuffers = renderObject.getVertexBuffers();\n\n\t\tfor ( let i = 0, l = vertexBuffers.length; i < l; i ++ ) {\n\n\t\t\tconst vertexBuffer = vertexBuffers[ i ];\n\n\t\t\tif ( currentSets.attributes[ i ] !== vertexBuffer ) {\n\n\t\t\t\tconst buffer = this.get( vertexBuffer ).buffer;\n\t\t\t\tpassEncoderGPU.setVertexBuffer( i, buffer );\n\n\t\t\t\tcurrentSets.attributes[ i ] = vertexBuffer;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// occlusion queries - handle multiple consecutive draw calls for an object\n\n\t\tif ( renderContextData.occlusionQuerySet !== undefined ) {\n\n\t\t\tconst lastObject = renderContextData.lastOcclusionObject;\n\n\t\t\tif ( lastObject !== object ) {\n\n\t\t\t\tif ( lastObject !== null && lastObject.occlusionTest === true ) {\n\n\t\t\t\t\tpassEncoderGPU.endOcclusionQuery();\n\t\t\t\t\trenderContextData.occlusionQueryIndex ++;\n\n\t\t\t\t}\n\n\t\t\t\tif ( object.occlusionTest === true ) {\n\n\t\t\t\t\tpassEncoderGPU.beginOcclusionQuery( renderContextData.occlusionQueryIndex );\n\t\t\t\t\trenderContextData.occlusionQueryObjects[ renderContextData.occlusionQueryIndex ] = object;\n\n\t\t\t\t}\n\n\t\t\t\trenderContextData.lastOcclusionObject = object;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// draw\n\n\t\tif ( object.isBatchedMesh === true ) {\n\n\t\t\tconst starts = object._multiDrawStarts;\n\t\t\tconst counts = object._multiDrawCounts;\n\t\t\tconst drawCount = object._multiDrawCount;\n\t\t\tconst drawInstances = object._multiDrawInstances;\n\n\t\t\tconst bytesPerElement = hasIndex ? index.array.BYTES_PER_ELEMENT : 1;\n\n\t\t\tfor ( let i = 0; i < drawCount; i ++ ) {\n\n\t\t\t\tconst count = drawInstances ? drawInstances[ i ] : 1;\n\t\t\t\tconst firstInstance = count > 1 ? 0 : i;\n\n\t\t\t\tpassEncoderGPU.drawIndexed( counts[ i ], count, starts[ i ] / bytesPerElement, 0, firstInstance );\n\n\t\t\t}\n\n\t\t} else if ( hasIndex === true ) {\n\n\t\t\tconst { vertexCount: indexCount, instanceCount, firstVertex: firstIndex } = drawParams;\n\n\t\t\tconst indirect = renderObject.getIndirect();\n\n\t\t\tif ( indirect !== null ) {\n\n\t\t\t\tconst buffer = this.get( indirect ).buffer;\n\n\t\t\t\tpassEncoderGPU.drawIndexedIndirect( buffer, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tpassEncoderGPU.drawIndexed( indexCount, instanceCount, firstIndex, 0, 0 );\n\n\t\t\t}\n\n\t\t\tinfo.update( object, indexCount, instanceCount );\n\n\t\t} else {\n\n\t\t\tconst { vertexCount, instanceCount, firstVertex } = drawParams;\n\n\t\t\tconst indirect = renderObject.getIndirect();\n\n\t\t\tif ( indirect !== null ) {\n\n\t\t\t\tconst buffer = this.get( indirect ).buffer;\n\n\t\t\t\tpassEncoderGPU.drawIndirect( buffer, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tpassEncoderGPU.draw( vertexCount, instanceCount, firstVertex, 0 );\n\n\t\t\t}\n\n\t\t\tinfo.update( object, vertexCount, instanceCount );\n\n\t\t}\n\n\t}\n\n\t// cache key\n\n\tneedsRenderUpdate( renderObject ) {\n\n\t\tconst data = this.get( renderObject );\n\n\t\tconst { object, material } = renderObject;\n\n\t\tconst utils = this.utils;\n\n\t\tconst sampleCount = utils.getSampleCountRenderContext( renderObject.context );\n\t\tconst colorSpace = utils.getCurrentColorSpace( renderObject.context );\n\t\tconst colorFormat = utils.getCurrentColorFormat( renderObject.context );\n\t\tconst depthStencilFormat = utils.getCurrentDepthStencilFormat( renderObject.context );\n\t\tconst primitiveTopology = utils.getPrimitiveTopology( object, material );\n\n\t\tlet needsUpdate = false;\n\n\t\tif ( data.material !== material || data.materialVersion !== material.version ||\n\t\t\tdata.transparent !== material.transparent || data.blending !== material.blending || data.premultipliedAlpha !== material.premultipliedAlpha ||\n\t\t\tdata.blendSrc !== material.blendSrc || data.blendDst !== material.blendDst || data.blendEquation !== material.blendEquation ||\n\t\t\tdata.blendSrcAlpha !== material.blendSrcAlpha || data.blendDstAlpha !== material.blendDstAlpha || data.blendEquationAlpha !== material.blendEquationAlpha ||\n\t\t\tdata.colorWrite !== material.colorWrite || data.depthWrite !== material.depthWrite || data.depthTest !== material.depthTest || data.depthFunc !== material.depthFunc ||\n\t\t\tdata.stencilWrite !== material.stencilWrite || data.stencilFunc !== material.stencilFunc ||\n\t\t\tdata.stencilFail !== material.stencilFail || data.stencilZFail !== material.stencilZFail || data.stencilZPass !== material.stencilZPass ||\n\t\t\tdata.stencilFuncMask !== material.stencilFuncMask || data.stencilWriteMask !== material.stencilWriteMask ||\n\t\t\tdata.side !== material.side || data.alphaToCoverage !== material.alphaToCoverage ||\n\t\t\tdata.sampleCount !== sampleCount || data.colorSpace !== colorSpace ||\n\t\t\tdata.colorFormat !== colorFormat || data.depthStencilFormat !== depthStencilFormat ||\n\t\t\tdata.primitiveTopology !== primitiveTopology ||\n\t\t\tdata.clippingContextCacheKey !== renderObject.clippingContext.cacheKey\n\t\t) {\n\n\t\t\tdata.material = material; data.materialVersion = material.version;\n\t\t\tdata.transparent = material.transparent; data.blending = material.blending; data.premultipliedAlpha = material.premultipliedAlpha;\n\t\t\tdata.blendSrc = material.blendSrc; data.blendDst = material.blendDst; data.blendEquation = material.blendEquation;\n\t\t\tdata.blendSrcAlpha = material.blendSrcAlpha; data.blendDstAlpha = material.blendDstAlpha; data.blendEquationAlpha = material.blendEquationAlpha;\n\t\t\tdata.colorWrite = material.colorWrite;\n\t\t\tdata.depthWrite = material.depthWrite; data.depthTest = material.depthTest; data.depthFunc = material.depthFunc;\n\t\t\tdata.stencilWrite = material.stencilWrite; data.stencilFunc = material.stencilFunc;\n\t\t\tdata.stencilFail = material.stencilFail; data.stencilZFail = material.stencilZFail; data.stencilZPass = material.stencilZPass;\n\t\t\tdata.stencilFuncMask = material.stencilFuncMask; data.stencilWriteMask = material.stencilWriteMask;\n\t\t\tdata.side = material.side; data.alphaToCoverage = material.alphaToCoverage;\n\t\t\tdata.sampleCount = sampleCount;\n\t\t\tdata.colorSpace = colorSpace;\n\t\t\tdata.colorFormat = colorFormat;\n\t\t\tdata.depthStencilFormat = depthStencilFormat;\n\t\t\tdata.primitiveTopology = primitiveTopology;\n\t\t\tdata.clippingContextCacheKey = renderObject.clippingContext.cacheKey;\n\n\t\t\tneedsUpdate = true;\n\n\t\t}\n\n\t\treturn needsUpdate;\n\n\t}\n\n\tgetRenderCacheKey( renderObject ) {\n\n\t\tconst { object, material } = renderObject;\n\n\t\tconst utils = this.utils;\n\t\tconst renderContext = renderObject.context;\n\n\t\treturn [\n\t\t\tmaterial.transparent, material.blending, material.premultipliedAlpha,\n\t\t\tmaterial.blendSrc, material.blendDst, material.blendEquation,\n\t\t\tmaterial.blendSrcAlpha, material.blendDstAlpha, material.blendEquationAlpha,\n\t\t\tmaterial.colorWrite,\n\t\t\tmaterial.depthWrite, material.depthTest, material.depthFunc,\n\t\t\tmaterial.stencilWrite, material.stencilFunc,\n\t\t\tmaterial.stencilFail, material.stencilZFail, material.stencilZPass,\n\t\t\tmaterial.stencilFuncMask, material.stencilWriteMask,\n\t\t\tmaterial.side,\n\t\t\tutils.getSampleCountRenderContext( renderContext ),\n\t\t\tutils.getCurrentColorSpace( renderContext ), utils.getCurrentColorFormat( renderContext ), utils.getCurrentDepthStencilFormat( renderContext ),\n\t\t\tutils.getPrimitiveTopology( object, material ),\n\t\t\trenderObject.getGeometryCacheKey(),\n\t\t\trenderObject.clippingContext.cacheKey\n\t\t].join();\n\n\t}\n\n\t// textures\n\n\tcreateSampler( texture ) {\n\n\t\tthis.textureUtils.createSampler( texture );\n\n\t}\n\n\tdestroySampler( texture ) {\n\n\t\tthis.textureUtils.destroySampler( texture );\n\n\t}\n\n\tcreateDefaultTexture( texture ) {\n\n\t\tthis.textureUtils.createDefaultTexture( texture );\n\n\t}\n\n\tcreateTexture( texture, options ) {\n\n\t\tthis.textureUtils.createTexture( texture, options );\n\n\t}\n\n\tupdateTexture( texture, options ) {\n\n\t\tthis.textureUtils.updateTexture( texture, options );\n\n\t}\n\n\tgenerateMipmaps( texture ) {\n\n\t\tthis.textureUtils.generateMipmaps( texture );\n\n\t}\n\n\tdestroyTexture( texture ) {\n\n\t\tthis.textureUtils.destroyTexture( texture );\n\n\t}\n\n\tcopyTextureToBuffer( texture, x, y, width, height, faceIndex ) {\n\n\t\treturn this.textureUtils.copyTextureToBuffer( texture, x, y, width, height, faceIndex );\n\n\t}\n\n\n\tinitTimestampQuery( renderContext, descriptor ) {\n\n\t\tif ( ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( ! renderContextData.timeStampQuerySet ) {\n\n\t\t\t// Create a GPUQuerySet which holds 2 timestamp query results: one for the\n\t\t\t// beginning and one for the end of compute pass execution.\n\t\t\tconst timeStampQuerySet = this.device.createQuerySet( { type: 'timestamp', count: 2 } );\n\n\t\t\tconst timestampWrites = {\n\t\t\t\tquerySet: timeStampQuerySet,\n\t\t\t\tbeginningOfPassWriteIndex: 0, // Write timestamp in index 0 when pass begins.\n\t\t\t\tendOfPassWriteIndex: 1, // Write timestamp in index 1 when pass ends.\n\t\t\t};\n\n\t\t\tObject.assign( descriptor, {\n\t\t\t\ttimestampWrites,\n\t\t\t} );\n\n\t\t\trenderContextData.timeStampQuerySet = timeStampQuerySet;\n\n\t\t}\n\n\t}\n\n\t// timestamp utils\n\n\tprepareTimestampBuffer( renderContext, encoder ) {\n\n\t\tif ( ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\n\t\tconst size = 2 * BigInt64Array.BYTES_PER_ELEMENT;\n\n\t\tif ( renderContextData.currentTimestampQueryBuffers === undefined ) {\n\n\t\t\trenderContextData.currentTimestampQueryBuffers = {\n\t\t\t\tresolveBuffer: this.device.createBuffer( {\n\t\t\t\t\tlabel: 'timestamp resolve buffer',\n\t\t\t\t\tsize: size,\n\t\t\t\t\tusage: GPUBufferUsage.QUERY_RESOLVE | GPUBufferUsage.COPY_SRC,\n\t\t\t\t} ),\n\t\t\t\tresultBuffer: this.device.createBuffer( {\n\t\t\t\t\tlabel: 'timestamp result buffer',\n\t\t\t\t\tsize: size,\n\t\t\t\t\tusage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ,\n\t\t\t\t} ),\n\t\t\t\tisMappingPending: false,\n\t\t\t};\n\n\t\t}\n\n\t\tconst { resolveBuffer, resultBuffer, isMappingPending } = renderContextData.currentTimestampQueryBuffers;\n\n\t\tif ( isMappingPending === true ) return;\n\n\t\tencoder.resolveQuerySet( renderContextData.timeStampQuerySet, 0, 2, resolveBuffer, 0 );\n\t\tencoder.copyBufferToBuffer( resolveBuffer, 0, resultBuffer, 0, size );\n\n\t}\n\n\tasync resolveTimestampAsync( renderContext, type = 'render' ) {\n\n\t\tif ( ! this.trackTimestamp ) return;\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tif ( renderContextData.currentTimestampQueryBuffers === undefined ) return;\n\n\t\tconst { resultBuffer, isMappingPending } = renderContextData.currentTimestampQueryBuffers;\n\n\t\tif ( isMappingPending === true ) return;\n\n\t\trenderContextData.currentTimestampQueryBuffers.isMappingPending = true;\n\n\t\tresultBuffer.mapAsync( GPUMapMode.READ ).then( () => {\n\n\t\t\tconst times = new BigUint64Array( resultBuffer.getMappedRange() );\n\t\t\tconst duration = Number( times[ 1 ] - times[ 0 ] ) / 1000000;\n\n\n\t\t\tthis.renderer.info.updateTimestamp( type, duration );\n\n\t\t\tresultBuffer.unmap();\n\n\t\t\trenderContextData.currentTimestampQueryBuffers.isMappingPending = false;\n\n\t\t} );\n\n\t}\n\n\t// node builder\n\n\tcreateNodeBuilder( object, renderer ) {\n\n\t\treturn new WGSLNodeBuilder( object, renderer );\n\n\t}\n\n\t// program\n\n\tcreateProgram( program ) {\n\n\t\tconst programGPU = this.get( program );\n\n\t\tprogramGPU.module = {\n\t\t\tmodule: this.device.createShaderModule( { code: program.code, label: program.stage } ),\n\t\t\tentryPoint: 'main'\n\t\t};\n\n\t}\n\n\tdestroyProgram( program ) {\n\n\t\tthis.delete( program );\n\n\t}\n\n\t// pipelines\n\n\tcreateRenderPipeline( renderObject, promises ) {\n\n\t\tthis.pipelineUtils.createRenderPipeline( renderObject, promises );\n\n\t}\n\n\tcreateComputePipeline( computePipeline, bindings ) {\n\n\t\tthis.pipelineUtils.createComputePipeline( computePipeline, bindings );\n\n\t}\n\n\tbeginBundle( renderContext ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\trenderContextData._currentPass = renderContextData.currentPass;\n\t\trenderContextData._currentSets = renderContextData.currentSets;\n\n\t\trenderContextData.currentSets = { attributes: {}, bindingGroups: [], pipeline: null, index: null };\n\t\trenderContextData.currentPass = this.pipelineUtils.createBundleEncoder( renderContext );\n\n\t}\n\n\tfinishBundle( renderContext, bundle ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tconst bundleEncoder = renderContextData.currentPass;\n\t\tconst bundleGPU = bundleEncoder.finish();\n\n\t\tthis.get( bundle ).bundleGPU = bundleGPU;\n\n\t\t// restore render pass state\n\n\t\trenderContextData.currentSets = renderContextData._currentSets;\n\t\trenderContextData.currentPass = renderContextData._currentPass;\n\n\t}\n\n\taddBundle( renderContext, bundle ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\trenderContextData.renderBundles.push( this.get( bundle ).bundleGPU );\n\n\t}\n\n\t// bindings\n\n\tcreateBindings( bindGroup ) {\n\n\t\tthis.bindingUtils.createBindings( bindGroup );\n\n\t}\n\n\tupdateBindings( bindGroup ) {\n\n\t\tthis.bindingUtils.createBindings( bindGroup );\n\n\t}\n\n\tupdateBinding( binding ) {\n\n\t\tthis.bindingUtils.updateBinding( binding );\n\n\t}\n\n\t// attributes\n\n\tcreateIndexAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.INDEX | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tcreateAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tcreateStorageAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.STORAGE | GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tcreateIndirectStorageAttribute( attribute ) {\n\n\t\tthis.attributeUtils.createAttribute( attribute, GPUBufferUsage.STORAGE | GPUBufferUsage.INDIRECT | GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST );\n\n\t}\n\n\tupdateAttribute( attribute ) {\n\n\t\tthis.attributeUtils.updateAttribute( attribute );\n\n\t}\n\n\tdestroyAttribute( attribute ) {\n\n\t\tthis.attributeUtils.destroyAttribute( attribute );\n\n\t}\n\n\t// canvas\n\n\tupdateSize() {\n\n\t\tthis.colorBuffer = this.textureUtils.getColorBuffer();\n\t\tthis.defaultRenderPassdescriptor = null;\n\n\t}\n\n\t// utils public\n\n\tgetMaxAnisotropy() {\n\n\t\treturn 16;\n\n\t}\n\n\thasFeature( name ) {\n\n\t\treturn this.device.features.has( name );\n\n\t}\n\n\tcopyTextureToTexture( srcTexture, dstTexture, srcRegion = null, dstPosition = null, level = 0 ) {\n\n\t\tlet dstX = 0;\n\t\tlet dstY = 0;\n\t\tlet dstLayer = 0;\n\n\t\tlet srcX = 0;\n\t\tlet srcY = 0;\n\t\tlet srcLayer = 0;\n\n\t\tlet srcWidth = srcTexture.image.width;\n\t\tlet srcHeight = srcTexture.image.height;\n\n\t\tif ( srcRegion !== null ) {\n\n\t\t\tsrcX = srcRegion.x;\n\t\t\tsrcY = srcRegion.y;\n\t\t\tsrcLayer = srcRegion.z || 0;\n\t\t\tsrcWidth = srcRegion.width;\n\t\t\tsrcHeight = srcRegion.height;\n\n\t\t}\n\n\t\tif ( dstPosition !== null ) {\n\n\t\t\tdstX = dstPosition.x;\n\t\t\tdstY = dstPosition.y;\n\t\t\tdstLayer = dstPosition.z || 0;\n\n\t\t}\n\n\t\tconst encoder = this.device.createCommandEncoder( { label: 'copyTextureToTexture_' + srcTexture.id + '_' + dstTexture.id } );\n\n\t\tconst sourceGPU = this.get( srcTexture ).texture;\n\t\tconst destinationGPU = this.get( dstTexture ).texture;\n\n\t\tencoder.copyTextureToTexture(\n\t\t\t{\n\t\t\t\ttexture: sourceGPU,\n\t\t\t\tmipLevel: level,\n\t\t\t\torigin: { x: srcX, y: srcY, z: srcLayer }\n\t\t\t},\n\t\t\t{\n\t\t\t\ttexture: destinationGPU,\n\t\t\t\tmipLevel: level,\n\t\t\t\torigin: { x: dstX, y: dstY, z: dstLayer }\n\t\t\t},\n\t\t\t[\n\t\t\t\tsrcWidth,\n\t\t\t\tsrcHeight,\n\t\t\t\t1\n\t\t\t]\n\t\t);\n\n\t\tthis.device.queue.submit( [ encoder.finish() ] );\n\n\t}\n\n\tcopyFramebufferToTexture( texture, renderContext, rectangle ) {\n\n\t\tconst renderContextData = this.get( renderContext );\n\n\t\tlet sourceGPU = null;\n\n\t\tif ( renderContext.renderTarget ) {\n\n\t\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t\tsourceGPU = this.get( renderContext.depthTexture ).texture;\n\n\t\t\t} else {\n\n\t\t\t\tsourceGPU = this.get( renderContext.textures[ 0 ] ).texture;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( texture.isDepthTexture ) {\n\n\t\t\t\tsourceGPU = this.textureUtils.getDepthBuffer( renderContext.depth, renderContext.stencil );\n\n\t\t\t} else {\n\n\t\t\t\tsourceGPU = this.context.getCurrentTexture();\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst destinationGPU = this.get( texture ).texture;\n\n\t\tif ( sourceGPU.format !== destinationGPU.format ) {\n\n\t\t\tconsole.error( 'WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.', sourceGPU.format, destinationGPU.format );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tlet encoder;\n\n\t\tif ( renderContextData.currentPass ) {\n\n\t\t\trenderContextData.currentPass.end();\n\n\t\t\tencoder = renderContextData.encoder;\n\n\t\t} else {\n\n\t\t\tencoder = this.device.createCommandEncoder( { label: 'copyFramebufferToTexture_' + texture.id } );\n\n\t\t}\n\n\t\tencoder.copyTextureToTexture(\n\t\t\t{\n\t\t\t\ttexture: sourceGPU,\n\t\t\t\torigin: { x: rectangle.x, y: rectangle.y, z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\ttexture: destinationGPU\n\t\t\t},\n\t\t\t[\n\t\t\t\trectangle.z,\n\t\t\t\trectangle.w\n\t\t\t]\n\t\t);\n\n\t\tif ( texture.generateMipmaps ) this.textureUtils.generateMipmaps( texture );\n\n\t\tif ( renderContextData.currentPass ) {\n\n\t\t\tconst { descriptor } = renderContextData;\n\n\t\t\tfor ( let i = 0; i < descriptor.colorAttachments.length; i ++ ) {\n\n\t\t\t\tdescriptor.colorAttachments[ i ].loadOp = GPULoadOp.Load;\n\n\t\t\t}\n\n\t\t\tif ( renderContext.depth ) descriptor.depthStencilAttachment.depthLoadOp = GPULoadOp.Load;\n\t\t\tif ( renderContext.stencil ) descriptor.depthStencilAttachment.stencilLoadOp = GPULoadOp.Load;\n\n\t\t\trenderContextData.currentPass = encoder.beginRenderPass( descriptor );\n\t\t\trenderContextData.currentSets = { attributes: {}, bindingGroups: [], pipeline: null, index: null };\n\n\t\t} else {\n\n\t\t\tthis.device.queue.submit( [ encoder.finish() ] );\n\n\t\t}\n\n\t}\n\n}\n\nclass IESSpotLight extends SpotLight {\n\n\tconstructor( color, intensity, distance, angle, penumbra, decay ) {\n\n\t\tsuper( color, intensity, distance, angle, penumbra, decay );\n\n\t\tthis.iesMap = null;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.iesMap = source.iesMap;\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass StandardNodeLibrary extends NodeLibrary {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.addMaterial( MeshPhongNodeMaterial, MeshPhongMaterial );\n\t\tthis.addMaterial( MeshStandardNodeMaterial, MeshStandardMaterial );\n\t\tthis.addMaterial( MeshPhysicalNodeMaterial, MeshPhysicalMaterial );\n\t\tthis.addMaterial( MeshToonNodeMaterial, MeshToonMaterial );\n\t\tthis.addMaterial( MeshBasicNodeMaterial, MeshBasicMaterial );\n\t\tthis.addMaterial( MeshLambertNodeMaterial, MeshLambertMaterial );\n\t\tthis.addMaterial( MeshNormalNodeMaterial, MeshNormalMaterial );\n\t\tthis.addMaterial( MeshMatcapNodeMaterial, MeshMatcapMaterial );\n\t\tthis.addMaterial( LineBasicNodeMaterial, LineBasicMaterial );\n\t\tthis.addMaterial( LineDashedNodeMaterial, LineDashedMaterial );\n\t\tthis.addMaterial( PointsNodeMaterial, PointsMaterial );\n\t\tthis.addMaterial( SpriteNodeMaterial, SpriteMaterial );\n\t\tthis.addMaterial( ShadowNodeMaterial, ShadowMaterial );\n\n\t\tthis.addLight( PointLightNode, PointLight );\n\t\tthis.addLight( DirectionalLightNode, DirectionalLight );\n\t\tthis.addLight( RectAreaLightNode, RectAreaLight );\n\t\tthis.addLight( SpotLightNode, SpotLight );\n\t\tthis.addLight( AmbientLightNode, AmbientLight );\n\t\tthis.addLight( HemisphereLightNode, HemisphereLight );\n\t\tthis.addLight( LightProbeNode, LightProbe );\n\t\tthis.addLight( IESSpotLightNode, IESSpotLight );\n\n\t\tthis.addToneMapping( linearToneMapping, LinearToneMapping );\n\t\tthis.addToneMapping( reinhardToneMapping, ReinhardToneMapping );\n\t\tthis.addToneMapping( cineonToneMapping, CineonToneMapping );\n\t\tthis.addToneMapping( acesFilmicToneMapping, ACESFilmicToneMapping );\n\t\tthis.addToneMapping( agxToneMapping, AgXToneMapping );\n\t\tthis.addToneMapping( neutralToneMapping, NeutralToneMapping );\n\n\t}\n\n}\n\n/*\nconst debugHandler = {\n\n\tget: function ( target, name ) {\n\n\t\t// Add |update\n\t\tif ( /^(create|destroy)/.test( name ) ) console.log( 'WebGPUBackend.' + name );\n\n\t\treturn target[ name ];\n\n\t}\n\n};\n*/\nclass WebGPURenderer extends Renderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tlet BackendClass;\n\n\t\tif ( parameters.forceWebGL ) {\n\n\t\t\tBackendClass = WebGLBackend;\n\n\t\t} else {\n\n\t\t\tBackendClass = WebGPUBackend;\n\n\t\t\tparameters.getFallback = () => {\n\n\t\t\t\tconsole.warn( 'THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend.' );\n\n\t\t\t\treturn new WebGLBackend( parameters );\n\n\t\t\t};\n\n\t\t}\n\n\t\tconst backend = new BackendClass( parameters );\n\n\t\t//super( new Proxy( backend, debugHandler ) );\n\t\tsuper( backend, parameters );\n\n\t\tthis.library = new StandardNodeLibrary();\n\n\t\tthis.isWebGPURenderer = true;\n\n\t}\n\n}\n\nclass BundleGroup extends Group {\n\n\tconstructor() {\n\n\t\tsuper();\n\n\t\tthis.isBundleGroup = true;\n\n\t\tthis.type = 'BundleGroup';\n\n\t\tthis.static = true;\n\t\tthis.version = 0;\n\n\t}\n\n\tset needsUpdate( value ) {\n\n\t\tif ( value === true ) this.version ++;\n\n\t}\n\n}\n\nconst _material = /*@__PURE__*/ new NodeMaterial();\nconst _quadMesh = /*@__PURE__*/ new QuadMesh( _material );\n\nclass PostProcessing {\n\n\tconstructor( renderer, outputNode = vec4( 0, 0, 1, 1 ) ) {\n\n\t\tthis.renderer = renderer;\n\t\tthis.outputNode = outputNode;\n\n\t\tthis.outputColorTransform = true;\n\n\t\tthis.needsUpdate = true;\n\n\t\t_material.name = 'PostProcessing';\n\n\t}\n\n\trender() {\n\n\t\tthis.update();\n\n\t\tconst renderer = this.renderer;\n\n\t\tconst toneMapping = renderer.toneMapping;\n\t\tconst outputColorSpace = renderer.outputColorSpace;\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.outputColorSpace = LinearSRGBColorSpace;\n\n\t\t//\n\n\t\t_quadMesh.render( renderer );\n\n\t\t//\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.outputColorSpace = outputColorSpace;\n\n\t}\n\n\tupdate() {\n\n\t\tif ( this.needsUpdate === true ) {\n\n\t\t\tconst renderer = this.renderer;\n\n\t\t\tconst toneMapping = renderer.toneMapping;\n\t\t\tconst outputColorSpace = renderer.outputColorSpace;\n\n\t\t\t_quadMesh.material.fragmentNode = this.outputColorTransform === true ? renderOutput( this.outputNode, toneMapping, outputColorSpace ) : this.outputNode.context( { toneMapping, outputColorSpace } );\n\t\t\t_quadMesh.material.needsUpdate = true;\n\n\t\t\tthis.needsUpdate = false;\n\n\t\t}\n\n\t}\n\n\tasync renderAsync() {\n\n\t\tthis.update();\n\n\t\tconst renderer = this.renderer;\n\n\t\tconst toneMapping = renderer.toneMapping;\n\t\tconst outputColorSpace = renderer.outputColorSpace;\n\n\t\trenderer.toneMapping = NoToneMapping;\n\t\trenderer.outputColorSpace = LinearSRGBColorSpace;\n\n\t\t//\n\n\t\tawait _quadMesh.renderAsync( renderer );\n\n\t\t//\n\n\t\trenderer.toneMapping = toneMapping;\n\t\trenderer.outputColorSpace = outputColorSpace;\n\n\t}\n\n}\n\n// renderer state\n\nfunction saveRendererState( renderer, state = {} ) {\n\n\tstate.toneMapping = renderer.toneMapping;\n\tstate.toneMappingExposure = renderer.toneMappingExposure;\n\tstate.outputColorSpace = renderer.outputColorSpace;\n\tstate.renderTarget = renderer.getRenderTarget();\n\tstate.activeCubeFace = renderer.getActiveCubeFace();\n\tstate.activeMipmapLevel = renderer.getActiveMipmapLevel();\n\tstate.renderObjectFunction = renderer.getRenderObjectFunction();\n\tstate.pixelRatio = renderer.getPixelRatio();\n\tstate.mrt = renderer.getMRT();\n\tstate.clearColor = renderer.getClearColor( state.clearColor || new Color() );\n\tstate.clearAlpha = renderer.getClearAlpha();\n\tstate.autoClear = renderer.autoClear;\n\tstate.scissorTest = renderer.getScissorTest();\n\n\treturn state;\n\n}\n\nfunction resetRendererState( renderer, state ) {\n\n\tstate = saveRendererState( renderer, state );\n\n\trenderer.setMRT( null );\n\trenderer.setRenderObjectFunction( null );\n\trenderer.setClearColor( 0x000000, 1 );\n\trenderer.autoClear = true;\n\n\treturn state;\n\n}\n\nfunction restoreRendererState( renderer, state ) {\n\n\trenderer.toneMapping = state.toneMapping;\n\trenderer.toneMappingExposure = state.toneMappingExposure;\n\trenderer.outputColorSpace = state.outputColorSpace;\n\trenderer.setRenderTarget( state.renderTarget, state.activeCubeFace, state.activeMipmapLevel );\n\trenderer.setRenderObjectFunction( state.renderObjectFunction );\n\trenderer.setPixelRatio( state.pixelRatio );\n\trenderer.setMRT( state.mrt );\n\trenderer.setClearColor( state.clearColor, state.clearAlpha );\n\trenderer.autoClear = state.autoClear;\n\trenderer.setScissorTest( state.scissorTest );\n\n}\n\n// renderer and scene state\n\nfunction saveRendererAndSceneState( renderer, scene, state = {} ) {\n\n\tstate = saveRendererState( renderer, state );\n\tstate.background = scene.background;\n\tstate.backgroundNode = scene.backgroundNode;\n\tstate.overrideMaterial = scene.overrideMaterial;\n\n\treturn state;\n\n}\n\nfunction resetRendererAndSceneState( renderer, scene, state ) {\n\n\tstate = saveRendererAndSceneState( renderer, scene, state );\n\n\tscene.background = null;\n\tscene.backgroundNode = null;\n\tscene.overrideMaterial = null;\n\n\treturn state;\n\n}\n\nfunction restoreRendererAndSceneState( renderer, scene, state ) {\n\n\trestoreRendererState( renderer, state );\n\n\tscene.background = state.background;\n\tscene.backgroundNode = state.backgroundNode;\n\tscene.overrideMaterial = state.overrideMaterial;\n\n}\n\nvar PostProcessingUtils = /*#__PURE__*/Object.freeze({\n\t__proto__: null,\n\tresetRendererAndSceneState: resetRendererAndSceneState,\n\tresetRendererState: resetRendererState,\n\trestoreRendererAndSceneState: restoreRendererAndSceneState,\n\trestoreRendererState: restoreRendererState,\n\tsaveRendererAndSceneState: saveRendererAndSceneState,\n\tsaveRendererState: saveRendererState\n});\n\nclass StorageTexture extends Texture {\n\n\tconstructor( width = 1, height = 1 ) {\n\n\t\tsuper();\n\n\t\tthis.image = { width, height };\n\n\t\tthis.magFilter = LinearFilter;\n\t\tthis.minFilter = LinearFilter;\n\n\t\tthis.isStorageTexture = true;\n\n\t}\n\n}\n\nclass StorageBufferAttribute extends BufferAttribute {\n\n\tconstructor( array, itemSize, typeClass = Float32Array ) {\n\n\t\tif ( ArrayBuffer.isView( array ) === false ) array = new typeClass( array * itemSize );\n\n\t\tsuper( array, itemSize );\n\n\t\tthis.isStorageBufferAttribute = true;\n\n\t}\n\n}\n\nclass StorageInstancedBufferAttribute extends InstancedBufferAttribute {\n\n\tconstructor( array, itemSize, typeClass = Float32Array ) {\n\n\t\tif ( ArrayBuffer.isView( array ) === false ) array = new typeClass( array * itemSize );\n\n\t\tsuper( array, itemSize );\n\n\t\tthis.isStorageInstancedBufferAttribute = true;\n\n\t}\n\n}\n\nclass IndirectStorageBufferAttribute extends StorageBufferAttribute {\n\n\tconstructor( array, itemSize ) {\n\n\t\tsuper( array, itemSize, Uint32Array );\n\n\t\tthis.isIndirectStorageBufferAttribute = true;\n\n\t}\n\n}\n\nclass NodeLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.textures = {};\n\t\tthis.nodes = {};\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.path );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, ( text ) => {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( this.parse( JSON.parse( text ) ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tthis.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparseNodes( json ) {\n\n\t\tconst nodes = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tfor ( const nodeJSON of json ) {\n\n\t\t\t\tconst { uuid, type } = nodeJSON;\n\n\t\t\t\tnodes[ uuid ] = this.createNodeFromType( type );\n\t\t\t\tnodes[ uuid ].uuid = uuid;\n\n\t\t\t}\n\n\t\t\tconst meta = { nodes, textures: this.textures };\n\n\t\t\tfor ( const nodeJSON of json ) {\n\n\t\t\t\tnodeJSON.meta = meta;\n\n\t\t\t\tconst node = nodes[ nodeJSON.uuid ];\n\t\t\t\tnode.deserialize( nodeJSON );\n\n\t\t\t\tdelete nodeJSON.meta;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn nodes;\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst node = this.createNodeFromType( json.type );\n\t\tnode.uuid = json.uuid;\n\n\t\tconst nodes = this.parseNodes( json.nodes );\n\t\tconst meta = { nodes, textures: this.textures };\n\n\t\tjson.meta = meta;\n\n\t\tnode.deserialize( json );\n\n\t\tdelete json.meta;\n\n\t\treturn node;\n\n\t}\n\n\tsetTextures( value ) {\n\n\t\tthis.textures = value;\n\t\treturn this;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\t\treturn this;\n\n\t}\n\n\tcreateNodeFromType( type ) {\n\n\t\tif ( this.nodes[ type ] === undefined ) {\n\n\t\t\tconsole.error( 'THREE.NodeLoader: Node type not found:', type );\n\t\t\treturn float();\n\n\t\t}\n\n\t\treturn nodeObject( new this.nodes[ type ]() );\n\n\t}\n\n}\n\nclass NodeMaterialLoader extends MaterialLoader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.nodes = {};\n\t\tthis.nodeMaterials = {};\n\n\t}\n\n\tparse( json ) {\n\n\t\tconst material = super.parse( json );\n\n\t\tconst nodes = this.nodes;\n\t\tconst inputNodes = json.inputNodes;\n\n\t\tfor ( const property in inputNodes ) {\n\n\t\t\tconst uuid = inputNodes[ property ];\n\n\t\t\tmaterial[ property ] = nodes[ uuid ];\n\n\t\t}\n\n\t\treturn material;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\t\treturn this;\n\n\t}\n\n\tsetNodeMaterials( value ) {\n\n\t\tthis.nodeMaterials = value;\n\t\treturn this;\n\n\t}\n\n\tcreateMaterialFromType( type ) {\n\n\t\tconst materialClass = this.nodeMaterials[ type ];\n\n\t\tif ( materialClass !== undefined ) {\n\n\t\t\treturn new materialClass();\n\n\t\t}\n\n\t\treturn super.createMaterialFromType( type );\n\n\t}\n\n}\n\nclass NodeObjectLoader extends ObjectLoader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.nodes = {};\n\t\tthis.nodeMaterials = {};\n\n\t\tthis._nodesJSON = null;\n\n\t}\n\n\tsetNodes( value ) {\n\n\t\tthis.nodes = value;\n\t\treturn this;\n\n\t}\n\n\tsetNodeMaterials( value ) {\n\n\t\tthis.nodeMaterials = value;\n\t\treturn this;\n\n\t}\n\n\tparse( json, onLoad ) {\n\n\t\tthis._nodesJSON = json.nodes;\n\n\t\tconst data = super.parse( json, onLoad );\n\n\t\tthis._nodesJSON = null; // dispose\n\n\t\treturn data;\n\n\t}\n\n\tparseNodes( json, textures ) {\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst loader = new NodeLoader();\n\t\t\tloader.setNodes( this.nodes );\n\t\t\tloader.setTextures( textures );\n\n\t\t\treturn loader.parseNodes( json );\n\n\t\t}\n\n\t\treturn {};\n\n\t}\n\n\tparseMaterials( json, textures ) {\n\n\t\tconst materials = {};\n\n\t\tif ( json !== undefined ) {\n\n\t\t\tconst nodes = this.parseNodes( this._nodesJSON, textures );\n\n\t\t\tconst loader = new NodeMaterialLoader();\n\t\t\tloader.setTextures( textures );\n\t\t\tloader.setNodes( nodes );\n\t\t\tloader.setNodeMaterials( this.nodeMaterials );\n\n\t\t\tfor ( let i = 0, l = json.length; i < l; i ++ ) {\n\n\t\t\t\tconst data = json[ i ];\n\n\t\t\t\tmaterials[ data.uuid ] = loader.parse( data );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materials;\n\n\t}\n\n}\n\nif ( typeof __THREE_DEVTOOLS__ !== 'undefined' ) {\n\n\t__THREE_DEVTOOLS__.dispatchEvent( new CustomEvent( 'register', { detail: {\n\t\trevision: REVISION,\n\t} } ) );\n\n}\n\nif ( typeof window !== 'undefined' ) {\n\n\tif ( window.__THREE__ ) {\n\n\t\tconsole.warn( 'WARNING: Multiple instances of Three.js being imported.' );\n\n\t} else {\n\n\t\twindow.__THREE__ = REVISION;\n\n\t}\n\n}\n\nexport { ACESFilmicToneMapping, AONode, AddEquation, AddOperation, AdditiveAnimationBlendMode, AdditiveBlending, AgXToneMapping, AlphaFormat, AlwaysCompare, AlwaysDepth, AlwaysStencilFunc, AmbientLight, AmbientLightNode, AnalyticLightNode, AnimationAction, AnimationClip, AnimationLoader, AnimationMixer, AnimationObjectGroup, AnimationUtils, ArcCurve, ArrayCamera, ArrayElementNode, ArrowHelper, AssignNode, AttachedBindMode, AttributeNode, Audio, AudioAnalyser, AudioContext, AudioListener, AudioLoader, AxesHelper, BRDF_GGX, BRDF_Lambert, BackSide, BasicDepthPacking, BasicEnvironmentNode, BasicShadowMap$1 as BasicShadowMap, BatchNode, BatchedMesh, Bone, BooleanKeyframeTrack, Box2, Box3, Box3Helper, BoxGeometry, BoxHelper, Break, BufferAttribute, BufferAttributeNode, BufferGeometry, BufferGeometryLoader, BufferNode, BumpMapNode, BundleGroup, BypassNode, ByteType, Cache, CacheNode, Camera, CameraHelper, CanvasTexture, CapsuleGeometry, CatmullRomCurve3, CineonToneMapping, CircleGeometry, ClampToEdgeWrapping, Clock, CodeNode, Color, ColorKeyframeTrack, ColorManagement, ColorSpaceNode, CompressedArrayTexture, CompressedCubeTexture, CompressedTexture, CompressedTextureLoader, ComputeNode, ConeGeometry, ConstNode, ConstantAlphaFactor, ConstantColorFactor, ContextNode, Continue, Controls, ConvertNode, CubeCamera, CubeReflectionMapping, CubeRefractionMapping, CubeTexture, CubeTextureLoader, CubeTextureNode, CubeUVReflectionMapping, CubicBezierCurve, CubicBezierCurve3, CubicInterpolant, CullFaceBack, CullFaceFront, CullFaceFrontBack, CullFaceNone, Curve, CurvePath, CustomBlending, CustomToneMapping, CylinderGeometry, Cylindrical, DFGApprox, D_GGX, Data3DTexture, DataArrayTexture, DataTexture, DataTextureLoader, DataUtils, DecrementStencilOp, DecrementWrapStencilOp, DefaultLoadingManager, DepthFormat, DepthStencilFormat, DepthTexture, DetachedBindMode, DirectionalLight, DirectionalLightHelper, DirectionalLightNode, Discard, DiscreteInterpolant, DodecahedronGeometry, DoubleSide, DstAlphaFactor, DstColorFactor, DynamicCopyUsage, DynamicDrawUsage, DynamicReadUsage, EPSILON, EdgesGeometry, EllipseCurve, EnvironmentNode, EqualCompare, EqualDepth, EqualStencilFunc, EquirectUVNode, EquirectangularReflectionMapping, EquirectangularRefractionMapping, Euler, EventDispatcher, ExpressionNode, ExtrudeGeometry, F_Schlick, FileLoader, Float16BufferAttribute, Float32BufferAttribute, FloatType, Fn, Fog, FogExp2, FogExp2Node, FogNode, FogRangeNode, FramebufferTexture, FrontFacingNode, FrontSide, Frustum, FunctionCallNode, FunctionNode, FunctionOverloadingNode, GLBufferAttribute, GLSL1, GLSL3, GLSLNodeParser, GreaterCompare, GreaterDepth, GreaterEqualCompare, GreaterEqualDepth, GreaterEqualStencilFunc, GreaterStencilFunc, GridHelper, Group, HalfFloatType, HemisphereLight, HemisphereLightHelper, HemisphereLightNode, IESSpotLight, IESSpotLightNode, INFINITY, IcosahedronGeometry, If, ImageBitmapLoader, ImageLoader, ImageUtils, IncrementStencilOp, IncrementWrapStencilOp, IndexNode, IndirectStorageBufferAttribute, InstanceNode, InstancedBufferAttribute, InstancedBufferGeometry, InstancedInterleavedBuffer, InstancedMesh, InstancedPointsNodeMaterial, Int16BufferAttribute, Int32BufferAttribute, Int8BufferAttribute, IntType, InterleavedBuffer, InterleavedBufferAttribute, Interpolant, InterpolateDiscrete, InterpolateLinear, InterpolateSmooth, InvertStencilOp, IrradianceNode, JoinNode, KeepStencilOp, KeyframeTrack, LOD, LatheGeometry, Layers, LessCompare, LessDepth, LessEqualCompare, LessEqualDepth, LessEqualStencilFunc, LessStencilFunc, Light, LightProbe, LightProbeNode, Lighting, LightingContextNode, LightingModel, LightingNode, LightsNode, Line, Line2NodeMaterial, Line3, LineBasicMaterial, LineBasicNodeMaterial, LineCurve, LineCurve3, LineDashedMaterial, LineDashedNodeMaterial, LineLoop, LineSegments, LinearFilter, LinearInterpolant, LinearMipMapLinearFilter, LinearMipMapNearestFilter, LinearMipmapLinearFilter, LinearMipmapNearestFilter, LinearSRGBColorSpace, LinearToneMapping, LinearTransfer, Loader, LoaderUtils, LoadingManager, Loop, LoopNode, LoopOnce, LoopPingPong, LoopRepeat, LuminanceAlphaFormat, LuminanceFormat, MOUSE, MRTNode, MatcapUVNode, Material, MaterialLoader, MaterialNode, MaterialReferenceNode, MathUtils, Matrix2, Matrix3, Matrix4, MaxEquation, MaxMipLevelNode, Mesh, MeshBasicMaterial, MeshBasicNodeMaterial, MeshDepthMaterial, MeshDistanceMaterial, MeshLambertMaterial, MeshLambertNodeMaterial, MeshMatcapMaterial, MeshMatcapNodeMaterial, MeshNormalMaterial, MeshNormalNodeMaterial, MeshPhongMaterial, MeshPhongNodeMaterial, MeshPhysicalMaterial, MeshPhysicalNodeMaterial, MeshSSSNodeMaterial, MeshStandardMaterial, MeshStandardNodeMaterial, MeshToonMaterial, MeshToonNodeMaterial, MinEquation, MirroredRepeatWrapping, MixOperation, ModelNode, ModelViewProjectionNode, MorphNode, MultiplyBlending, MultiplyOperation, NearestFilter, NearestMipMapLinearFilter, NearestMipMapNearestFilter, NearestMipmapLinearFilter, NearestMipmapNearestFilter, NeutralToneMapping, NeverCompare, NeverDepth, NeverStencilFunc, NoBlending, NoColorSpace, NoToneMapping, Node, NodeAttribute, NodeBuilder, NodeCache, NodeCode, NodeFrame, NodeFunctionInput, NodeLoader, NodeMaterial, NodeMaterialLoader, NodeMaterialObserver, NodeObjectLoader, NodeShaderStage, NodeType, NodeUniform, NodeUpdateType, NodeUtils, NodeVar, NodeVarying, NormalAnimationBlendMode, NormalBlending, NormalMapNode, NotEqualCompare, NotEqualDepth, NotEqualStencilFunc, NumberKeyframeTrack, Object3D, Object3DNode, ObjectLoader, ObjectSpaceNormalMap, OctahedronGeometry, OneFactor, OneMinusConstantAlphaFactor, OneMinusConstantColorFactor, OneMinusDstAlphaFactor, OneMinusDstColorFactor, OneMinusSrcAlphaFactor, OneMinusSrcColorFactor, OrthographicCamera, OutputStructNode, PCFShadowMap$1 as PCFShadowMap, PCFSoftShadowMap$1 as PCFSoftShadowMap, PI, PI2, PMREMGenerator, PMREMNode, ParameterNode, PassNode, Path, PerspectiveCamera, PhongLightingModel, PhysicalLightingModel, Plane, PlaneGeometry, PlaneHelper, PointLight, PointLightHelper, PointLightNode, PointUVNode, Points, PointsMaterial, PointsNodeMaterial, PolarGridHelper, PolyhedronGeometry, PositionalAudio, PostProcessing, PostProcessingUtils, PosterizeNode, PropertyBinding, PropertyMixer, PropertyNode, QuadMesh, QuadraticBezierCurve, QuadraticBezierCurve3, Quaternion, QuaternionKeyframeTrack, QuaternionLinearInterpolant, RED_GREEN_RGTC2_Format, RED_RGTC1_Format, REVISION, RGBADepthPacking, RGBAFormat, RGBAIntegerFormat, RGBA_ASTC_10x10_Format, RGBA_ASTC_10x5_Format, RGBA_ASTC_10x6_Format, RGBA_ASTC_10x8_Format, RGBA_ASTC_12x10_Format, RGBA_ASTC_12x12_Format, RGBA_ASTC_4x4_Format, RGBA_ASTC_5x4_Format, RGBA_ASTC_5x5_Format, RGBA_ASTC_6x5_Format, RGBA_ASTC_6x6_Format, RGBA_ASTC_8x5_Format, RGBA_ASTC_8x6_Format, RGBA_ASTC_8x8_Format, RGBA_BPTC_Format, RGBA_ETC2_EAC_Format, RGBA_PVRTC_2BPPV1_Format, RGBA_PVRTC_4BPPV1_Format, RGBA_S3TC_DXT1_Format, RGBA_S3TC_DXT3_Format, RGBA_S3TC_DXT5_Format, RGBDepthPacking, RGBFormat, RGBIntegerFormat, RGB_BPTC_SIGNED_Format, RGB_BPTC_UNSIGNED_Format, RGB_ETC1_Format, RGB_ETC2_Format, RGB_PVRTC_2BPPV1_Format, RGB_PVRTC_4BPPV1_Format, RGB_S3TC_DXT1_Format, RGDepthPacking, RGFormat, RGIntegerFormat, RTTNode, RangeNode, RawShaderMaterial, Ray, Raycaster, RectAreaLight, RectAreaLightNode, RedFormat, RedIntegerFormat, ReferenceNode, ReflectorNode, ReinhardToneMapping, RemapNode, RenderOutputNode, RenderTarget, RendererReferenceNode, RepeatWrapping, ReplaceStencilOp, Return, ReverseSubtractEquation, RingGeometry, RotateNode, SIGNED_RED_GREEN_RGTC2_Format, SIGNED_RED_RGTC1_Format, SRGBColorSpace, SRGBTransfer, Scene, SceneNode, Schlick_to_F0, ScreenNode, ScriptableNode, ScriptableNodeResources, ScriptableValueNode, SetNode, ShaderMaterial, ShaderNode, ShadowMaterial, ShadowNode, ShadowNodeMaterial, Shape, ShapeGeometry, ShapePath, ShapeUtils, ShortType, Skeleton, SkeletonHelper, SkinnedMesh, SkinningNode, Source, Sphere, SphereGeometry, Spherical, SphericalHarmonics3, SplineCurve, SplitNode, SpotLight, SpotLightHelper, SpotLightNode, Sprite, SpriteMaterial, SpriteNodeMaterial, SpriteSheetUVNode, SrcAlphaFactor, SrcAlphaSaturateFactor, SrcColorFactor, StackNode, StaticCopyUsage, StaticDrawUsage, StaticReadUsage, StereoCamera, StorageArrayElementNode, StorageBufferAttribute, StorageBufferNode, StorageInstancedBufferAttribute, StorageTexture, StorageTextureNode, StreamCopyUsage, StreamDrawUsage, StreamReadUsage, StringKeyframeTrack, SubtractEquation, SubtractiveBlending, TBNViewMatrix, TOUCH, TangentSpaceNormalMap, TempNode, TetrahedronGeometry, Texture, Texture3DNode, TextureLoader, TextureNode, TextureSizeNode, ToneMappingNode, ToonOutlinePassNode, TorusGeometry, TorusKnotGeometry, Triangle, TriangleFanDrawMode, TriangleStripDrawMode, TrianglesDrawMode, TriplanarTexturesNode, TubeGeometry, UVMapping, Uint16BufferAttribute, Uint32BufferAttribute, Uint8BufferAttribute, Uint8ClampedBufferAttribute, Uniform$1 as Uniform, UniformArrayNode, UniformGroupNode, UniformNode, UniformsGroup$1 as UniformsGroup, UnsignedByteType, UnsignedInt248Type, UnsignedInt5999Type, UnsignedIntType, UnsignedShort4444Type, UnsignedShort5551Type, UnsignedShortType, UserDataNode, VSMShadowMap, V_GGX_SmithCorrelated, VarNode, VaryingNode, Vector2, Vector3, Vector4, VectorKeyframeTrack, VertexColorNode, VideoTexture, ViewportDepthNode, ViewportDepthTextureNode, ViewportSharedTextureNode, ViewportTextureNode, VolumeNodeMaterial, WebGL3DRenderTarget, WebGLArrayRenderTarget, WebGLCoordinateSystem, WebGLCubeRenderTarget, WebGLMultipleRenderTargets, WebGLRenderTarget, WebGPUCoordinateSystem, WebGPURenderer, WireframeGeometry, WrapAroundEnding, ZeroCurvatureEnding, ZeroFactor, ZeroSlopeEnding, ZeroStencilOp, abs, acesFilmicToneMapping, acos, add, addMethodChaining, addNodeElement, agxToneMapping, all, alphaT, and, anisotropy, anisotropyB, anisotropyT, any, append, arrayBuffer, asin, assign, atan, atan2, atomicAdd, atomicAnd, atomicFunc, atomicMax, atomicMin, atomicOr, atomicStore, atomicSub, atomicXor, attenuationColor, attenuationDistance, attribute, backgroundBlurriness, backgroundIntensity, backgroundRotation, batch, billboarding, bitAnd, bitNot, bitOr, bitXor, bitangentGeometry, bitangentLocal, bitangentView, bitangentWorld, bitcast, blur, bool, buffer, bufferAttribute, bumpMap, burn, bvec2, bvec3, bvec4, bypass, cache, call, cameraFar, cameraNear, cameraNormalMatrix, cameraPosition, cameraProjectionMatrix, cameraProjectionMatrixInverse, cameraViewMatrix, cameraWorldMatrix, cbrt, cdl, ceil, checker, cineonToneMapping, clamp, clearcoat, clearcoatRoughness, code, color, colorSpaceToWorking, colorToDirection, compute, cond, context, convert, convertColorSpace, convertToTexture, cos, createCanvasElement, cross, cubeTexture, dFdx, dFdy, dashSize, defaultBuildStages, defaultShaderStages, defined, degrees, deltaTime, densityFog, depth, depthPass, difference, diffuseColor, directPointLight, directionToColor, dispersion, distance, div, dodge, dot, drawIndex, dynamicBufferAttribute, element, emissive, equal, equals, equirectUV, exp, exp2, expression, faceDirection, faceForward, float, floor, fog, fract, frameGroup, frameId, frontFacing, fwidth, gain, gapSize, getConstNodeType, getCurrentStack, getDirection, getDistanceAttenuation, getGeometryRoughness, getNormalFromDepth, getParallaxCorrectNormal, getRoughness, getScreenPosition, getShIrradianceAt, getTextureIndex, getViewPosition, glsl, glslFn, grayscale, greaterThan, greaterThanEqual, hash, highPrecisionModelNormalViewMatrix, highPrecisionModelViewMatrix, hue, instance, instanceIndex, instancedBufferAttribute, instancedDynamicBufferAttribute, int, inverseSqrt, invocationLocalIndex, invocationSubgroupIndex, ior, iridescence, iridescenceIOR, iridescenceThickness, ivec2, ivec3, ivec4, js, label, length, lengthSq, lessThan, lessThanEqual, lightPosition, lightTargetDirection, lightTargetPosition, lightViewPosition, lightingContext, lights, linearDepth, linearToneMapping, localId, log, log2, loop, luminance, mat2, mat3, mat4, matcapUV, materialAOMap, materialAlphaTest, materialAnisotropy, materialAnisotropyVector, materialAttenuationColor, materialAttenuationDistance, materialClearcoat, materialClearcoatNormal, materialClearcoatRoughness, materialColor, materialDispersion, materialEmissive, materialIOR, materialIridescence, materialIridescenceIOR, materialIridescenceThickness, materialLightMap, materialLineDashOffset, materialLineDashSize, materialLineGapSize, materialLineScale, materialLineWidth, materialMetalness, materialNormal, materialOpacity, materialPointWidth, materialReference, materialReflectivity, materialRefractionRatio, materialRotation, materialRoughness, materialSheen, materialSheenRoughness, materialShininess, materialSpecular, materialSpecularColor, materialSpecularIntensity, materialSpecularStrength, materialThickness, materialTransmission, max$1 as max, maxMipLevel, metalness, min$1 as min, mix, mixElement, mod, modInt, modelDirection, modelNormalMatrix, modelPosition, modelScale, modelViewMatrix, modelViewPosition, modelViewProjection, modelWorldMatrix, modelWorldMatrixInverse, morphReference, mrt, mul, mx_aastep, mx_cell_noise_float, mx_contrast, mx_fractal_noise_float, mx_fractal_noise_vec2, mx_fractal_noise_vec3, mx_fractal_noise_vec4, mx_hsvtorgb, mx_noise_float, mx_noise_vec3, mx_noise_vec4, mx_ramplr, mx_ramptb, mx_rgbtohsv, mx_safepower, mx_splitlr, mx_splittb, mx_srgb_texture_to_lin_rec709, mx_transform_uv, mx_worley_noise_float, mx_worley_noise_vec2, mx_worley_noise_vec3, negate, neutralToneMapping, nodeArray, nodeImmutable, nodeObject, nodeObjects, nodeProxy, normalFlat, normalGeometry, normalLocal, normalMap, normalView, normalWorld, normalize, not, notEqual, numWorkgroups, objectDirection, objectGroup, objectPosition, objectScale, objectViewPosition, objectWorldMatrix, oneMinus, or, orthographicDepthToViewZ, oscSawtooth, oscSine, oscSquare, oscTriangle, output, outputStruct, overlay, overloadingFn, parabola, parallaxDirection, parallaxUV, parameter, pass, passTexture, pcurve, perspectiveDepthToLogarithmicDepth, perspectiveDepthToViewZ, pmremTexture, pointUV, pointWidth, positionGeometry, positionLocal, positionPrevious, positionView, positionViewDirection, positionWorld, positionWorldDirection, posterize, pow, pow2, pow3, pow4, property, radians, rand, range, rangeFog, reciprocal, reference, referenceBuffer, reflect, reflectVector, reflectView, reflector, refract, refractVector, refractView, reinhardToneMapping, remainder, remap, remapClamp, renderGroup, renderOutput, rendererReference, rotate, rotateUV, roughness, round, rtt, sRGBTransferEOTF, sRGBTransferOETF, sampler, saturate, saturation, screen, screenCoordinate, screenSize, screenUV, scriptable, scriptableValue, select, setCurrentStack, shaderStages, shadow, sharedUniformGroup, sheen, sheenRoughness, shiftLeft, shiftRight, shininess, sign, sin, sinc, skinning, skinningReference, smoothstep, smoothstepElement, specularColor, specularF90, spherizeUV, split, spritesheetUV, sqrt, stack, step, storage, storageBarrier, storageObject, storageTexture, string, sub, subgroupIndex, subgroupSize, tan, tangentGeometry, tangentLocal, tangentView, tangentWorld, temp, texture, texture3D, textureBarrier, textureBicubic, textureCubeUV, textureLoad, textureSize, textureStore, thickness, threshold, time, timerDelta, timerGlobal, timerLocal, toOutputColorSpace, toWorkingColorSpace, toneMapping, toneMappingExposure, toonOutlinePass, transformDirection, transformNormal, transformNormalToView, transformedBentNormalView, transformedBitangentView, transformedBitangentWorld, transformedClearcoatNormalView, transformedNormalView, transformedNormalWorld, transformedTangentView, transformedTangentWorld, transmission, transpose, tri, tri3, triNoise3D, triplanarTexture, triplanarTextures, trunc, tslFn, uint, uniform, uniformArray, uniformGroup, uniforms, userData, uv, uvec2, uvec3, uvec4, varying, varyingProperty, vec2, vec3, vec4, vectorComponents, velocity, vertexColor, vertexIndex, vibrance, viewZToOrthographicDepth, viewZToPerspectiveDepth, viewport, viewportBottomLeft, viewportCoordinate, viewportDepthTexture, viewportLinearDepth, viewportMipTexture, viewportResolution, viewportSafeUV, viewportSharedTexture, viewportSize, viewportTexture, viewportTopLeft, viewportUV, wgsl, wgslFn, workgroupArray, workgroupBarrier, workgroupId, workingToColorSpace, xor };\n","import {\n\tControls,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3,\n\tPlane,\n\tRay,\n\tMathUtils\n} from 'three';\n\n// OrbitControls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nconst _changeEvent = { type: 'change' };\nconst _startEvent = { type: 'start' };\nconst _endEvent = { type: 'end' };\nconst _ray = new Ray();\nconst _plane = new Plane();\nconst _TILT_LIMIT = Math.cos( 70 * MathUtils.DEG2RAD );\n\nconst _v = new Vector3();\nconst _twoPI = 2 * Math.PI;\n\nconst _STATE = {\n\tNONE: - 1,\n\tROTATE: 0,\n\tDOLLY: 1,\n\tPAN: 2,\n\tTOUCH_ROTATE: 3,\n\tTOUCH_PAN: 4,\n\tTOUCH_DOLLY_PAN: 5,\n\tTOUCH_DOLLY_ROTATE: 6\n};\nconst _EPS = 0.000001;\n\nclass OrbitControls extends Controls {\n\n\tconstructor( object, domElement = null ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.state = _STATE.NONE;\n\n\t\t// Set to false to disable this control\n\t\tthis.enabled = true;\n\n\t\t// \"target\" sets the location of focus, where the object orbits around\n\t\tthis.target = new Vector3();\n\n\t\t// Sets the 3D cursor (similar to Blender), from which the maxTargetRadius takes effect\n\t\tthis.cursor = new Vector3();\n\n\t\t// How far you can dolly in and out ( PerspectiveCamera only )\n\t\tthis.minDistance = 0;\n\t\tthis.maxDistance = Infinity;\n\n\t\t// How far you can zoom in and out ( OrthographicCamera only )\n\t\tthis.minZoom = 0;\n\t\tthis.maxZoom = Infinity;\n\n\t\t// Limit camera target within a spherical area around the cursor\n\t\tthis.minTargetRadius = 0;\n\t\tthis.maxTargetRadius = Infinity;\n\n\t\t// How far you can orbit vertically, upper and lower limits.\n\t\t// Range is 0 to Math.PI radians.\n\t\tthis.minPolarAngle = 0; // radians\n\t\tthis.maxPolarAngle = Math.PI; // radians\n\n\t\t// How far you can orbit horizontally, upper and lower limits.\n\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\n\t\tthis.minAzimuthAngle = - Infinity; // radians\n\t\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t\t// Set to true to enable damping (inertia)\n\t\t// If damping is enabled, you must call controls.update() in your animation loop\n\t\tthis.enableDamping = false;\n\t\tthis.dampingFactor = 0.05;\n\n\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t\t// Set to false to disable zooming\n\t\tthis.enableZoom = true;\n\t\tthis.zoomSpeed = 1.0;\n\n\t\t// Set to false to disable rotating\n\t\tthis.enableRotate = true;\n\t\tthis.rotateSpeed = 1.0;\n\n\t\t// Set to false to disable panning\n\t\tthis.enablePan = true;\n\t\tthis.panSpeed = 1.0;\n\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\n\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\t\tthis.zoomToCursor = false;\n\n\t\t// Set to true to automatically rotate around the target\n\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\t\tthis.autoRotate = false;\n\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\n\n\t\t// The four arrow keys\n\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\n\n\t\t// Mouse buttons\n\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t\t// Touch fingers\n\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t\t// for reset\n\t\tthis.target0 = this.target.clone();\n\t\tthis.position0 = this.object.position.clone();\n\t\tthis.zoom0 = this.object.zoom;\n\n\t\t// the target DOM element for key events\n\t\tthis._domElementKeyEvents = null;\n\n\t\t// internals\n\n\t\tthis._lastPosition = new Vector3();\n\t\tthis._lastQuaternion = new Quaternion();\n\t\tthis._lastTargetPosition = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tthis._quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tthis._quatInverse = this._quat.clone().invert();\n\n\t\t// current position in spherical coordinates\n\t\tthis._spherical = new Spherical();\n\t\tthis._sphericalDelta = new Spherical();\n\n\t\tthis._scale = 1;\n\t\tthis._panOffset = new Vector3();\n\n\t\tthis._rotateStart = new Vector2();\n\t\tthis._rotateEnd = new Vector2();\n\t\tthis._rotateDelta = new Vector2();\n\n\t\tthis._panStart = new Vector2();\n\t\tthis._panEnd = new Vector2();\n\t\tthis._panDelta = new Vector2();\n\n\t\tthis._dollyStart = new Vector2();\n\t\tthis._dollyEnd = new Vector2();\n\t\tthis._dollyDelta = new Vector2();\n\n\t\tthis._dollyDirection = new Vector3();\n\t\tthis._mouse = new Vector2();\n\t\tthis._performCursorZoom = false;\n\n\t\tthis._pointers = [];\n\t\tthis._pointerPositions = {};\n\n\t\tthis._controlActive = false;\n\n\t\t// event listeners\n\n\t\tthis._onPointerMove = onPointerMove.bind( this );\n\t\tthis._onPointerDown = onPointerDown.bind( this );\n\t\tthis._onPointerUp = onPointerUp.bind( this );\n\t\tthis._onContextMenu = onContextMenu.bind( this );\n\t\tthis._onMouseWheel = onMouseWheel.bind( this );\n\t\tthis._onKeyDown = onKeyDown.bind( this );\n\n\t\tthis._onTouchStart = onTouchStart.bind( this );\n\t\tthis._onTouchMove = onTouchMove.bind( this );\n\n\t\tthis._onMouseDown = onMouseDown.bind( this );\n\t\tthis._onMouseMove = onMouseMove.bind( this );\n\n\t\tthis._interceptControlDown = interceptControlDown.bind( this );\n\t\tthis._interceptControlUp = interceptControlUp.bind( this );\n\n\t\t//\n\n\t\tif ( this.domElement !== null ) {\n\n\t\t\tthis.connect();\n\n\t\t}\n\n\t\tthis.update();\n\n\t}\n\n\tconnect() {\n\n\t\tthis.domElement.addEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointercancel', this._onPointerUp );\n\n\t\tthis.domElement.addEventListener( 'contextmenu', this._onContextMenu );\n\t\tthis.domElement.addEventListener( 'wheel', this._onMouseWheel, { passive: false } );\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\t\tdocument.addEventListener( 'keydown', this._interceptControlDown, { passive: true, capture: true } );\n\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\n\n\t}\n\n\tdisconnect() {\n\n\t\tthis.domElement.removeEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\n\t\tthis.domElement.removeEventListener( 'pointercancel', this._onPointerUp );\n\n\t\tthis.domElement.removeEventListener( 'wheel', this._onMouseWheel );\n\t\tthis.domElement.removeEventListener( 'contextmenu', this._onContextMenu );\n\n\t\tthis.stopListenToKeyEvents();\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\t\tdocument.removeEventListener( 'keydown', this._interceptControlDown, { capture: true } );\n\n\t\tthis.domElement.style.touchAction = 'auto';\n\n\t}\n\n\tdispose() {\n\n\t\tthis.disconnect();\n\n\t}\n\n\tgetPolarAngle() {\n\n\t\treturn this._spherical.phi;\n\n\t}\n\n\tgetAzimuthalAngle() {\n\n\t\treturn this._spherical.theta;\n\n\t}\n\n\tgetDistance() {\n\n\t\treturn this.object.position.distanceTo( this.target );\n\n\t}\n\n\tlistenToKeyEvents( domElement ) {\n\n\t\tdomElement.addEventListener( 'keydown', this._onKeyDown );\n\t\tthis._domElementKeyEvents = domElement;\n\n\t}\n\n\tstopListenToKeyEvents() {\n\n\t\tif ( this._domElementKeyEvents !== null ) {\n\n\t\t\tthis._domElementKeyEvents.removeEventListener( 'keydown', this._onKeyDown );\n\t\t\tthis._domElementKeyEvents = null;\n\n\t\t}\n\n\t}\n\n\tsaveState() {\n\n\t\tthis.target0.copy( this.target );\n\t\tthis.position0.copy( this.object.position );\n\t\tthis.zoom0 = this.object.zoom;\n\n\t}\n\n\treset() {\n\n\t\tthis.target.copy( this.target0 );\n\t\tthis.object.position.copy( this.position0 );\n\t\tthis.object.zoom = this.zoom0;\n\n\t\tthis.object.updateProjectionMatrix();\n\t\tthis.dispatchEvent( _changeEvent );\n\n\t\tthis.update();\n\n\t\tthis.state = _STATE.NONE;\n\n\t}\n\n\tupdate( deltaTime = null ) {\n\n\t\tconst position = this.object.position;\n\n\t\t_v.copy( position ).sub( this.target );\n\n\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t_v.applyQuaternion( this._quat );\n\n\t\t// angle from z-axis around y-axis\n\t\tthis._spherical.setFromVector3( _v );\n\n\t\tif ( this.autoRotate && this.state === _STATE.NONE ) {\n\n\t\t\tthis._rotateLeft( this._getAutoRotationAngle( deltaTime ) );\n\n\t\t}\n\n\t\tif ( this.enableDamping ) {\n\n\t\t\tthis._spherical.theta += this._sphericalDelta.theta * this.dampingFactor;\n\t\t\tthis._spherical.phi += this._sphericalDelta.phi * this.dampingFactor;\n\n\t\t} else {\n\n\t\t\tthis._spherical.theta += this._sphericalDelta.theta;\n\t\t\tthis._spherical.phi += this._sphericalDelta.phi;\n\n\t\t}\n\n\t\t// restrict theta to be between desired limits\n\n\t\tlet min = this.minAzimuthAngle;\n\t\tlet max = this.maxAzimuthAngle;\n\n\t\tif ( isFinite( min ) && isFinite( max ) ) {\n\n\t\t\tif ( min < - Math.PI ) min += _twoPI; else if ( min > Math.PI ) min -= _twoPI;\n\n\t\t\tif ( max < - Math.PI ) max += _twoPI; else if ( max > Math.PI ) max -= _twoPI;\n\n\t\t\tif ( min <= max ) {\n\n\t\t\t\tthis._spherical.theta = Math.max( min, Math.min( max, this._spherical.theta ) );\n\n\t\t\t} else {\n\n\t\t\t\tthis._spherical.theta = ( this._spherical.theta > ( min + max ) / 2 ) ?\n\t\t\t\t\tMath.max( min, this._spherical.theta ) :\n\t\t\t\t\tMath.min( max, this._spherical.theta );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// restrict phi to be between desired limits\n\t\tthis._spherical.phi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, this._spherical.phi ) );\n\n\t\tthis._spherical.makeSafe();\n\n\n\t\t// move target to panned location\n\n\t\tif ( this.enableDamping === true ) {\n\n\t\t\tthis.target.addScaledVector( this._panOffset, this.dampingFactor );\n\n\t\t} else {\n\n\t\t\tthis.target.add( this._panOffset );\n\n\t\t}\n\n\t\t// Limit the target distance from the cursor to create a sphere around the center of interest\n\t\tthis.target.sub( this.cursor );\n\t\tthis.target.clampLength( this.minTargetRadius, this.maxTargetRadius );\n\t\tthis.target.add( this.cursor );\n\n\t\tlet zoomChanged = false;\n\t\t// adjust the camera position based on zoom only if we're not zooming to the cursor or if it's an ortho camera\n\t\t// we adjust zoom later in these cases\n\t\tif ( this.zoomToCursor && this._performCursorZoom || this.object.isOrthographicCamera ) {\n\n\t\t\tthis._spherical.radius = this._clampDistance( this._spherical.radius );\n\n\t\t} else {\n\n\t\t\tconst prevRadius = this._spherical.radius;\n\t\t\tthis._spherical.radius = this._clampDistance( this._spherical.radius * this._scale );\n\t\t\tzoomChanged = prevRadius != this._spherical.radius;\n\n\t\t}\n\n\t\t_v.setFromSpherical( this._spherical );\n\n\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t_v.applyQuaternion( this._quatInverse );\n\n\t\tposition.copy( this.target ).add( _v );\n\n\t\tthis.object.lookAt( this.target );\n\n\t\tif ( this.enableDamping === true ) {\n\n\t\t\tthis._sphericalDelta.theta *= ( 1 - this.dampingFactor );\n\t\t\tthis._sphericalDelta.phi *= ( 1 - this.dampingFactor );\n\n\t\t\tthis._panOffset.multiplyScalar( 1 - this.dampingFactor );\n\n\t\t} else {\n\n\t\t\tthis._sphericalDelta.set( 0, 0, 0 );\n\n\t\t\tthis._panOffset.set( 0, 0, 0 );\n\n\t\t}\n\n\t\t// adjust camera position\n\t\tif ( this.zoomToCursor && this._performCursorZoom ) {\n\n\t\t\tlet newRadius = null;\n\t\t\tif ( this.object.isPerspectiveCamera ) {\n\n\t\t\t\t// move the camera down the pointer ray\n\t\t\t\t// this method avoids floating point error\n\t\t\t\tconst prevRadius = _v.length();\n\t\t\t\tnewRadius = this._clampDistance( prevRadius * this._scale );\n\n\t\t\t\tconst radiusDelta = prevRadius - newRadius;\n\t\t\t\tthis.object.position.addScaledVector( this._dollyDirection, radiusDelta );\n\t\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\t\tzoomChanged = !! radiusDelta;\n\n\t\t\t} else if ( this.object.isOrthographicCamera ) {\n\n\t\t\t\t// adjust the ortho camera position based on zoom changes\n\t\t\t\tconst mouseBefore = new Vector3( this._mouse.x, this._mouse.y, 0 );\n\t\t\t\tmouseBefore.unproject( this.object );\n\n\t\t\t\tconst prevZoom = this.object.zoom;\n\t\t\t\tthis.object.zoom = Math.max( this.minZoom, Math.min( this.maxZoom, this.object.zoom / this._scale ) );\n\t\t\t\tthis.object.updateProjectionMatrix();\n\n\t\t\t\tzoomChanged = prevZoom !== this.object.zoom;\n\n\t\t\t\tconst mouseAfter = new Vector3( this._mouse.x, this._mouse.y, 0 );\n\t\t\t\tmouseAfter.unproject( this.object );\n\n\t\t\t\tthis.object.position.sub( mouseAfter ).add( mouseBefore );\n\t\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\t\tnewRadius = _v.length();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled.' );\n\t\t\t\tthis.zoomToCursor = false;\n\n\t\t\t}\n\n\t\t\t// handle the placement of the target\n\t\t\tif ( newRadius !== null ) {\n\n\t\t\t\tif ( this.screenSpacePanning ) {\n\n\t\t\t\t\t// position the orbit target in front of the new camera position\n\t\t\t\t\tthis.target.set( 0, 0, - 1 )\n\t\t\t\t\t\t.transformDirection( this.object.matrix )\n\t\t\t\t\t\t.multiplyScalar( newRadius )\n\t\t\t\t\t\t.add( this.object.position );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// get the ray and translation plane to compute target\n\t\t\t\t\t_ray.origin.copy( this.object.position );\n\t\t\t\t\t_ray.direction.set( 0, 0, - 1 ).transformDirection( this.object.matrix );\n\n\t\t\t\t\t// if the camera is 20 degrees above the horizon then don't adjust the focus target to avoid\n\t\t\t\t\t// extremely large values\n\t\t\t\t\tif ( Math.abs( this.object.up.dot( _ray.direction ) ) < _TILT_LIMIT ) {\n\n\t\t\t\t\t\tthis.object.lookAt( this.target );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t_plane.setFromNormalAndCoplanarPoint( this.object.up, this.target );\n\t\t\t\t\t\t_ray.intersectPlane( _plane, this.target );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( this.object.isOrthographicCamera ) {\n\n\t\t\tconst prevZoom = this.object.zoom;\n\t\t\tthis.object.zoom = Math.max( this.minZoom, Math.min( this.maxZoom, this.object.zoom / this._scale ) );\n\n\t\t\tif ( prevZoom !== this.object.zoom ) {\n\n\t\t\t\tthis.object.updateProjectionMatrix();\n\t\t\t\tzoomChanged = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis._scale = 1;\n\t\tthis._performCursorZoom = false;\n\n\t\t// update condition is:\n\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\tif ( zoomChanged ||\n\t\t\tthis._lastPosition.distanceToSquared( this.object.position ) > _EPS ||\n\t\t\t8 * ( 1 - this._lastQuaternion.dot( this.object.quaternion ) ) > _EPS ||\n\t\t\tthis._lastTargetPosition.distanceToSquared( this.target ) > _EPS ) {\n\n\t\t\tthis.dispatchEvent( _changeEvent );\n\n\t\t\tthis._lastPosition.copy( this.object.position );\n\t\t\tthis._lastQuaternion.copy( this.object.quaternion );\n\t\t\tthis._lastTargetPosition.copy( this.target );\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t_getAutoRotationAngle( deltaTime ) {\n\n\t\tif ( deltaTime !== null ) {\n\n\t\t\treturn ( _twoPI / 60 * this.autoRotateSpeed ) * deltaTime;\n\n\t\t} else {\n\n\t\t\treturn _twoPI / 60 / 60 * this.autoRotateSpeed;\n\n\t\t}\n\n\t}\n\n\t_getZoomScale( delta ) {\n\n\t\tconst normalizedDelta = Math.abs( delta * 0.01 );\n\t\treturn Math.pow( 0.95, this.zoomSpeed * normalizedDelta );\n\n\t}\n\n\t_rotateLeft( angle ) {\n\n\t\tthis._sphericalDelta.theta -= angle;\n\n\t}\n\n\t_rotateUp( angle ) {\n\n\t\tthis._sphericalDelta.phi -= angle;\n\n\t}\n\n\t_panLeft( distance, objectMatrix ) {\n\n\t\t_v.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t_v.multiplyScalar( - distance );\n\n\t\tthis._panOffset.add( _v );\n\n\t}\n\n\t_panUp( distance, objectMatrix ) {\n\n\t\tif ( this.screenSpacePanning === true ) {\n\n\t\t\t_v.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t} else {\n\n\t\t\t_v.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t_v.crossVectors( this.object.up, _v );\n\n\t\t}\n\n\t\t_v.multiplyScalar( distance );\n\n\t\tthis._panOffset.add( _v );\n\n\t}\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\t_pan( deltaX, deltaY ) {\n\n\t\tconst element = this.domElement;\n\n\t\tif ( this.object.isPerspectiveCamera ) {\n\n\t\t\t// perspective\n\t\t\tconst position = this.object.position;\n\t\t\t_v.copy( position ).sub( this.target );\n\t\t\tlet targetDistance = _v.length();\n\n\t\t\t// half of the fov is center to top of screen\n\t\t\ttargetDistance *= Math.tan( ( this.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\tthis._panLeft( 2 * deltaX * targetDistance / element.clientHeight, this.object.matrix );\n\t\t\tthis._panUp( 2 * deltaY * targetDistance / element.clientHeight, this.object.matrix );\n\n\t\t} else if ( this.object.isOrthographicCamera ) {\n\n\t\t\t// orthographic\n\t\t\tthis._panLeft( deltaX * ( this.object.right - this.object.left ) / this.object.zoom / element.clientWidth, this.object.matrix );\n\t\t\tthis._panUp( deltaY * ( this.object.top - this.object.bottom ) / this.object.zoom / element.clientHeight, this.object.matrix );\n\n\t\t} else {\n\n\t\t\t// camera neither orthographic nor perspective\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\tthis.enablePan = false;\n\n\t\t}\n\n\t}\n\n\t_dollyOut( dollyScale ) {\n\n\t\tif ( this.object.isPerspectiveCamera || this.object.isOrthographicCamera ) {\n\n\t\t\tthis._scale /= dollyScale;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tthis.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t_dollyIn( dollyScale ) {\n\n\t\tif ( this.object.isPerspectiveCamera || this.object.isOrthographicCamera ) {\n\n\t\t\tthis._scale *= dollyScale;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tthis.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t_updateZoomParameters( x, y ) {\n\n\t\tif ( ! this.zoomToCursor ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tthis._performCursorZoom = true;\n\n\t\tconst rect = this.domElement.getBoundingClientRect();\n\t\tconst dx = x - rect.left;\n\t\tconst dy = y - rect.top;\n\t\tconst w = rect.width;\n\t\tconst h = rect.height;\n\n\t\tthis._mouse.x = ( dx / w ) * 2 - 1;\n\t\tthis._mouse.y = - ( dy / h ) * 2 + 1;\n\n\t\tthis._dollyDirection.set( this._mouse.x, this._mouse.y, 1 ).unproject( this.object ).sub( this.object.position ).normalize();\n\n\t}\n\n\t_clampDistance( dist ) {\n\n\t\treturn Math.max( this.minDistance, Math.min( this.maxDistance, dist ) );\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\t_handleMouseDownRotate( event ) {\n\n\t\tthis._rotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\t_handleMouseDownDolly( event ) {\n\n\t\tthis._updateZoomParameters( event.clientX, event.clientX );\n\t\tthis._dollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\t_handleMouseDownPan( event ) {\n\n\t\tthis._panStart.set( event.clientX, event.clientY );\n\n\t}\n\n\t_handleMouseMoveRotate( event ) {\n\n\t\tthis._rotateEnd.set( event.clientX, event.clientY );\n\n\t\tthis._rotateDelta.subVectors( this._rotateEnd, this._rotateStart ).multiplyScalar( this.rotateSpeed );\n\n\t\tconst element = this.domElement;\n\n\t\tthis._rotateLeft( _twoPI * this._rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\tthis._rotateUp( _twoPI * this._rotateDelta.y / element.clientHeight );\n\n\t\tthis._rotateStart.copy( this._rotateEnd );\n\n\t\tthis.update();\n\n\t}\n\n\t_handleMouseMoveDolly( event ) {\n\n\t\tthis._dollyEnd.set( event.clientX, event.clientY );\n\n\t\tthis._dollyDelta.subVectors( this._dollyEnd, this._dollyStart );\n\n\t\tif ( this._dollyDelta.y > 0 ) {\n\n\t\t\tthis._dollyOut( this._getZoomScale( this._dollyDelta.y ) );\n\n\t\t} else if ( this._dollyDelta.y < 0 ) {\n\n\t\t\tthis._dollyIn( this._getZoomScale( this._dollyDelta.y ) );\n\n\t\t}\n\n\t\tthis._dollyStart.copy( this._dollyEnd );\n\n\t\tthis.update();\n\n\t}\n\n\t_handleMouseMovePan( event ) {\n\n\t\tthis._panEnd.set( event.clientX, event.clientY );\n\n\t\tthis._panDelta.subVectors( this._panEnd, this._panStart ).multiplyScalar( this.panSpeed );\n\n\t\tthis._pan( this._panDelta.x, this._panDelta.y );\n\n\t\tthis._panStart.copy( this._panEnd );\n\n\t\tthis.update();\n\n\t}\n\n\t_handleMouseWheel( event ) {\n\n\t\tthis._updateZoomParameters( event.clientX, event.clientY );\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tthis._dollyIn( this._getZoomScale( event.deltaY ) );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tthis._dollyOut( this._getZoomScale( event.deltaY ) );\n\n\t\t}\n\n\t\tthis.update();\n\n\t}\n\n\t_handleKeyDown( event ) {\n\n\t\tlet needsUpdate = false;\n\n\t\tswitch ( event.code ) {\n\n\t\t\tcase this.keys.UP:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tthis._rotateUp( _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._pan( 0, this.keyPanSpeed );\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase this.keys.BOTTOM:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tthis._rotateUp( - _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._pan( 0, - this.keyPanSpeed );\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase this.keys.LEFT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tthis._rotateLeft( _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._pan( this.keyPanSpeed, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase this.keys.RIGHT:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tthis._rotateLeft( - _twoPI * this.rotateSpeed / this.domElement.clientHeight );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._pan( - this.keyPanSpeed, 0 );\n\n\t\t\t\t}\n\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.update();\n\n\t\t}\n\n\n\t}\n\n\t_handleTouchStartRotate( event ) {\n\n\t\tif ( this._pointers.length === 1 ) {\n\n\t\t\tthis._rotateStart.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._rotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\t_handleTouchStartPan( event ) {\n\n\t\tif ( this._pointers.length === 1 ) {\n\n\t\t\tthis._panStart.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._panStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\t_handleTouchStartDolly( event ) {\n\n\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\tconst dx = event.pageX - position.x;\n\t\tconst dy = event.pageY - position.y;\n\n\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tthis._dollyStart.set( 0, distance );\n\n\t}\n\n\t_handleTouchStartDollyPan( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchStartDolly( event );\n\n\t\tif ( this.enablePan ) this._handleTouchStartPan( event );\n\n\t}\n\n\t_handleTouchStartDollyRotate( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchStartDolly( event );\n\n\t\tif ( this.enableRotate ) this._handleTouchStartRotate( event );\n\n\t}\n\n\t_handleTouchMoveRotate( event ) {\n\n\t\tif ( this._pointers.length == 1 ) {\n\n\t\t\tthis._rotateEnd.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._rotateEnd.set( x, y );\n\n\t\t}\n\n\t\tthis._rotateDelta.subVectors( this._rotateEnd, this._rotateStart ).multiplyScalar( this.rotateSpeed );\n\n\t\tconst element = this.domElement;\n\n\t\tthis._rotateLeft( _twoPI * this._rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\tthis._rotateUp( _twoPI * this._rotateDelta.y / element.clientHeight );\n\n\t\tthis._rotateStart.copy( this._rotateEnd );\n\n\t}\n\n\t_handleTouchMovePan( event ) {\n\n\t\tif ( this._pointers.length === 1 ) {\n\n\t\t\tthis._panEnd.set( event.pageX, event.pageY );\n\n\t\t} else {\n\n\t\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\t\tconst x = 0.5 * ( event.pageX + position.x );\n\t\t\tconst y = 0.5 * ( event.pageY + position.y );\n\n\t\t\tthis._panEnd.set( x, y );\n\n\t\t}\n\n\t\tthis._panDelta.subVectors( this._panEnd, this._panStart ).multiplyScalar( this.panSpeed );\n\n\t\tthis._pan( this._panDelta.x, this._panDelta.y );\n\n\t\tthis._panStart.copy( this._panEnd );\n\n\t}\n\n\t_handleTouchMoveDolly( event ) {\n\n\t\tconst position = this._getSecondPointerPosition( event );\n\n\t\tconst dx = event.pageX - position.x;\n\t\tconst dy = event.pageY - position.y;\n\n\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tthis._dollyEnd.set( 0, distance );\n\n\t\tthis._dollyDelta.set( 0, Math.pow( this._dollyEnd.y / this._dollyStart.y, this.zoomSpeed ) );\n\n\t\tthis._dollyOut( this._dollyDelta.y );\n\n\t\tthis._dollyStart.copy( this._dollyEnd );\n\n\t\tconst centerX = ( event.pageX + position.x ) * 0.5;\n\t\tconst centerY = ( event.pageY + position.y ) * 0.5;\n\n\t\tthis._updateZoomParameters( centerX, centerY );\n\n\t}\n\n\t_handleTouchMoveDollyPan( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchMoveDolly( event );\n\n\t\tif ( this.enablePan ) this._handleTouchMovePan( event );\n\n\t}\n\n\t_handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( this.enableZoom ) this._handleTouchMoveDolly( event );\n\n\t\tif ( this.enableRotate ) this._handleTouchMoveRotate( event );\n\n\t}\n\n\t// pointers\n\n\t_addPointer( event ) {\n\n\t\tthis._pointers.push( event.pointerId );\n\n\t}\n\n\t_removePointer( event ) {\n\n\t\tdelete this._pointerPositions[ event.pointerId ];\n\n\t\tfor ( let i = 0; i < this._pointers.length; i ++ ) {\n\n\t\t\tif ( this._pointers[ i ] == event.pointerId ) {\n\n\t\t\t\tthis._pointers.splice( i, 1 );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_isTrackingPointer( event ) {\n\n\t\tfor ( let i = 0; i < this._pointers.length; i ++ ) {\n\n\t\t\tif ( this._pointers[ i ] == event.pointerId ) return true;\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t_trackPointer( event ) {\n\n\t\tlet position = this._pointerPositions[ event.pointerId ];\n\n\t\tif ( position === undefined ) {\n\n\t\t\tposition = new Vector2();\n\t\t\tthis._pointerPositions[ event.pointerId ] = position;\n\n\t\t}\n\n\t\tposition.set( event.pageX, event.pageY );\n\n\t}\n\n\t_getSecondPointerPosition( event ) {\n\n\t\tconst pointerId = ( event.pointerId === this._pointers[ 0 ] ) ? this._pointers[ 1 ] : this._pointers[ 0 ];\n\n\t\treturn this._pointerPositions[ pointerId ];\n\n\t}\n\n\t//\n\n\t_customWheelEvent( event ) {\n\n\t\tconst mode = event.deltaMode;\n\n\t\t// minimal wheel event altered to meet delta-zoom demand\n\t\tconst newEvent = {\n\t\t\tclientX: event.clientX,\n\t\t\tclientY: event.clientY,\n\t\t\tdeltaY: event.deltaY,\n\t\t};\n\n\t\tswitch ( mode ) {\n\n\t\t\tcase 1: // LINE_MODE\n\t\t\t\tnewEvent.deltaY *= 16;\n\t\t\t\tbreak;\n\n\t\t\tcase 2: // PAGE_MODE\n\t\t\t\tnewEvent.deltaY *= 100;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// detect if event was triggered by pinching\n\t\tif ( event.ctrlKey && ! this._controlActive ) {\n\n\t\t\tnewEvent.deltaY *= 10;\n\n\t\t}\n\n\t\treturn newEvent;\n\n\t}\n\n}\n\nfunction onPointerDown( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( this._pointers.length === 0 ) {\n\n\t\tthis.domElement.setPointerCapture( event.pointerId );\n\n\t\tthis.domElement.addEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerup', this._onPointerUp );\n\n\t}\n\n\t//\n\n\tif ( this._isTrackingPointer( event ) ) return;\n\n\t//\n\n\tthis._addPointer( event );\n\n\tif ( event.pointerType === 'touch' ) {\n\n\t\tthis._onTouchStart( event );\n\n\t} else {\n\n\t\tthis._onMouseDown( event );\n\n\t}\n\n}\n\nfunction onPointerMove( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( event.pointerType === 'touch' ) {\n\n\t\tthis._onTouchMove( event );\n\n\t} else {\n\n\t\tthis._onMouseMove( event );\n\n\t}\n\n}\n\nfunction onPointerUp( event ) {\n\n\tthis._removePointer( event );\n\n\tswitch ( this._pointers.length ) {\n\n\t\tcase 0:\n\n\t\t\tthis.domElement.releasePointerCapture( event.pointerId );\n\n\t\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\n\t\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\n\n\t\t\tthis.dispatchEvent( _endEvent );\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t\t\tbreak;\n\n\t\tcase 1:\n\n\t\t\tconst pointerId = this._pointers[ 0 ];\n\t\t\tconst position = this._pointerPositions[ pointerId ];\n\n\t\t\t// minimal placeholder event - allows state correction on pointer-up\n\t\t\tthis._onTouchStart( { pointerId: pointerId, pageX: position.x, pageY: position.y } );\n\n\t\t\tbreak;\n\n\t}\n\n}\n\nfunction onMouseDown( event ) {\n\n\tlet mouseAction;\n\n\tswitch ( event.button ) {\n\n\t\tcase 0:\n\n\t\t\tmouseAction = this.mouseButtons.LEFT;\n\t\t\tbreak;\n\n\t\tcase 1:\n\n\t\t\tmouseAction = this.mouseButtons.MIDDLE;\n\t\t\tbreak;\n\n\t\tcase 2:\n\n\t\t\tmouseAction = this.mouseButtons.RIGHT;\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tmouseAction = - 1;\n\n\t}\n\n\tswitch ( mouseAction ) {\n\n\t\tcase MOUSE.DOLLY:\n\n\t\t\tif ( this.enableZoom === false ) return;\n\n\t\t\tthis._handleMouseDownDolly( event );\n\n\t\t\tthis.state = _STATE.DOLLY;\n\n\t\t\tbreak;\n\n\t\tcase MOUSE.ROTATE:\n\n\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\t\tthis._handleMouseDownPan( event );\n\n\t\t\t\tthis.state = _STATE.PAN;\n\n\t\t\t} else {\n\n\t\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\t\tthis._handleMouseDownRotate( event );\n\n\t\t\t\tthis.state = _STATE.ROTATE;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase MOUSE.PAN:\n\n\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\t\tthis._handleMouseDownRotate( event );\n\n\t\t\t\tthis.state = _STATE.ROTATE;\n\n\t\t\t} else {\n\n\t\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\t\tthis._handleMouseDownPan( event );\n\n\t\t\t\tthis.state = _STATE.PAN;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t}\n\n\tif ( this.state !== _STATE.NONE ) {\n\n\t\tthis.dispatchEvent( _startEvent );\n\n\t}\n\n}\n\nfunction onMouseMove( event ) {\n\n\tswitch ( this.state ) {\n\n\t\tcase _STATE.ROTATE:\n\n\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\tthis._handleMouseMoveRotate( event );\n\n\t\t\tbreak;\n\n\t\tcase _STATE.DOLLY:\n\n\t\t\tif ( this.enableZoom === false ) return;\n\n\t\t\tthis._handleMouseMoveDolly( event );\n\n\t\t\tbreak;\n\n\t\tcase _STATE.PAN:\n\n\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\tthis._handleMouseMovePan( event );\n\n\t\t\tbreak;\n\n\t}\n\n}\n\nfunction onMouseWheel( event ) {\n\n\tif ( this.enabled === false || this.enableZoom === false || this.state !== _STATE.NONE ) return;\n\n\tevent.preventDefault();\n\n\tthis.dispatchEvent( _startEvent );\n\n\tthis._handleMouseWheel( this._customWheelEvent( event ) );\n\n\tthis.dispatchEvent( _endEvent );\n\n}\n\nfunction onKeyDown( event ) {\n\n\tif ( this.enabled === false || this.enablePan === false ) return;\n\n\tthis._handleKeyDown( event );\n\n}\n\nfunction onTouchStart( event ) {\n\n\tthis._trackPointer( event );\n\n\tswitch ( this._pointers.length ) {\n\n\t\tcase 1:\n\n\t\t\tswitch ( this.touches.ONE ) {\n\n\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartRotate( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_ROTATE;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartPan( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_PAN;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tthis.state = _STATE.NONE;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase 2:\n\n\t\t\tswitch ( this.touches.TWO ) {\n\n\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\tif ( this.enableZoom === false && this.enablePan === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartDollyPan( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\tif ( this.enableZoom === false && this.enableRotate === false ) return;\n\n\t\t\t\t\tthis._handleTouchStartDollyRotate( event );\n\n\t\t\t\t\tthis.state = _STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tthis.state = _STATE.NONE;\n\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t}\n\n\tif ( this.state !== _STATE.NONE ) {\n\n\t\tthis.dispatchEvent( _startEvent );\n\n\t}\n\n}\n\nfunction onTouchMove( event ) {\n\n\tthis._trackPointer( event );\n\n\tswitch ( this.state ) {\n\n\t\tcase _STATE.TOUCH_ROTATE:\n\n\t\t\tif ( this.enableRotate === false ) return;\n\n\t\t\tthis._handleTouchMoveRotate( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tcase _STATE.TOUCH_PAN:\n\n\t\t\tif ( this.enablePan === false ) return;\n\n\t\t\tthis._handleTouchMovePan( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tcase _STATE.TOUCH_DOLLY_PAN:\n\n\t\t\tif ( this.enableZoom === false && this.enablePan === false ) return;\n\n\t\t\tthis._handleTouchMoveDollyPan( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tcase _STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\tif ( this.enableZoom === false && this.enableRotate === false ) return;\n\n\t\t\tthis._handleTouchMoveDollyRotate( event );\n\n\t\t\tthis.update();\n\n\t\t\tbreak;\n\n\t\tdefault:\n\n\t\t\tthis.state = _STATE.NONE;\n\n\t}\n\n}\n\nfunction onContextMenu( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tevent.preventDefault();\n\n}\n\nfunction interceptControlDown( event ) {\n\n\tif ( event.key === 'Control' ) {\n\n\t\tthis._controlActive = true;\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\n\t\tdocument.addEventListener( 'keyup', this._interceptControlUp, { passive: true, capture: true } );\n\n\t}\n\n}\n\nfunction interceptControlUp( event ) {\n\n\tif ( event.key === 'Control' ) {\n\n\t\tthis._controlActive = false;\n\n\t\tconst document = this.domElement.getRootNode(); // offscreen canvas compatibility\n\n\t\tdocument.removeEventListener( 'keyup', this._interceptControlUp, { passive: true, capture: true } );\n\n\t}\n\n}\n\nexport { OrbitControls };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tInstancedBufferAttribute,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tTrianglesDrawMode,\n\tVector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents( geometry, MikkTSpace, negateSign = true ) {\n\n\tif ( ! MikkTSpace || ! MikkTSpace.isReady ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Initialized MikkTSpace library required.' );\n\n\t}\n\n\tif ( ! geometry.hasAttribute( 'position' ) || ! geometry.hasAttribute( 'normal' ) || ! geometry.hasAttribute( 'uv' ) ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.' );\n\n\t}\n\n\tfunction getAttributeArray( attribute ) {\n\n\t\tif ( attribute.normalized || attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst dstArray = new Float32Array( attribute.count * attribute.itemSize );\n\n\t\t\tfor ( let i = 0, j = 0; i < attribute.count; i ++ ) {\n\n\t\t\t\tdstArray[ j ++ ] = attribute.getX( i );\n\t\t\t\tdstArray[ j ++ ] = attribute.getY( i );\n\n\t\t\t\tif ( attribute.itemSize > 2 ) {\n\n\t\t\t\t\tdstArray[ j ++ ] = attribute.getZ( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t\tif ( attribute.array instanceof Float32Array ) {\n\n\t\t\treturn attribute.array;\n\n\t\t}\n\n\t\treturn new Float32Array( attribute.array );\n\n\t}\n\n\t// MikkTSpace algorithm requires non-indexed input.\n\n\tconst _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n\t// Compute vertex tangents.\n\n\tconst tangents = MikkTSpace.generateTangents(\n\n\t\tgetAttributeArray( _geometry.attributes.position ),\n\t\tgetAttributeArray( _geometry.attributes.normal ),\n\t\tgetAttributeArray( _geometry.attributes.uv )\n\n\t);\n\n\t// Texture coordinate convention of glTF differs from the apparent\n\t// default of the MikkTSpace library; .w component must be flipped.\n\n\tif ( negateSign ) {\n\n\t\tfor ( let i = 3; i < tangents.length; i += 4 ) {\n\n\t\t\ttangents[ i ] *= - 1;\n\n\t\t}\n\n\t}\n\n\t//\n\n\t_geometry.setAttribute( 'tangent', new BufferAttribute( tangents, 4 ) );\n\n\tif ( geometry !== _geometry ) {\n\n\t\tgeometry.copy( _geometry );\n\n\t}\n\n\treturn geometry;\n\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {Boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries( geometries, useGroups = false ) {\n\n\tconst isIndexed = geometries[ 0 ].index !== null;\n\n\tconst attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\tconst morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\tconst attributes = {};\n\tconst morphAttributes = {};\n\n\tconst morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\tconst mergedGeometry = new BufferGeometry();\n\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\tconst geometry = geometries[ i ];\n\t\tlet attributesCount = 0;\n\n\t\t// ensure that all geometries are indexed, or none\n\n\t\tif ( isIndexed !== ( geometry.index !== null ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather attributes, exit early if they're different\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tif ( ! attributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure \"' + name + '\" attribute exists among all geometries, or in none of them.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\tattributesCount ++;\n\n\t\t}\n\n\t\t// ensure geometries have the same number of attributes\n\n\t\tif ( attributesCount !== attributesUsed.size ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. Make sure all geometries have the same number of attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather morph attributes, exit early if they're different\n\n\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. .morphTargetsRelative must be consistent throughout all geometries.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfor ( const name in geometry.morphAttributes ) {\n\n\t\t\tif ( ! morphAttributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '.  .morphAttributes must be consistent throughout all geometries.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t}\n\n\t\tif ( useGroups ) {\n\n\t\t\tlet count;\n\n\t\t\tif ( isIndexed ) {\n\n\t\t\t\tcount = geometry.index.count;\n\n\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. The geometry must have either an index or a position attribute' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\toffset += count;\n\n\t\t}\n\n\t}\n\n\t// merge indices\n\n\tif ( isIndexed ) {\n\n\t\tlet indexOffset = 0;\n\t\tconst mergedIndex = [];\n\n\t\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tconst index = geometries[ i ].index;\n\n\t\t\tfor ( let j = 0; j < index.count; ++ j ) {\n\n\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t}\n\n\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t}\n\n\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t}\n\n\t// merge attributes\n\n\tfor ( const name in attributes ) {\n\n\t\tconst mergedAttribute = mergeAttributes( attributes[ name ] );\n\n\t\tif ( ! mergedAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' attribute.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t}\n\n\t// merge morph attributes\n\n\tfor ( const name in morphAttributes ) {\n\n\t\tconst numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\tif ( numMorphTargets === 0 ) break;\n\n\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\tconst morphAttributesToMerge = [];\n\n\t\t\tfor ( let j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t}\n\n\t\t\tconst mergedMorphAttribute = mergeAttributes( morphAttributesToMerge );\n\n\t\t\tif ( ! mergedMorphAttribute ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' morphAttribute.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t}\n\n\t}\n\n\treturn mergedGeometry;\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes( attributes ) {\n\n\tlet TypedArray;\n\tlet itemSize;\n\tlet normalized;\n\tlet gpuType = - 1;\n\tlet arrayLength = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\tif ( itemSize !== attribute.itemSize ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\tif ( normalized !== attribute.normalized ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( gpuType === - 1 ) gpuType = attribute.gpuType;\n\t\tif ( gpuType !== attribute.gpuType ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.count * itemSize;\n\n\t}\n\n\tconst array = new TypedArray( arrayLength );\n\tconst result = new BufferAttribute( array, itemSize, normalized );\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst tupleOffset = offset / itemSize;\n\t\t\tfor ( let j = 0, l = attribute.count; j < l; j ++ ) {\n\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tconst value = attribute.getComponent( j, c );\n\t\t\t\t\tresult.setComponent( j + tupleOffset, c, value );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tarray.set( attribute.array, offset );\n\n\t\t}\n\n\t\toffset += attribute.count * itemSize;\n\n\t}\n\n\tif ( gpuType !== undefined ) {\n\n\t\tresult.gpuType = gpuType;\n\n\t}\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferAttribute}\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute( attribute ) {\n\n\tif ( attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute ) {\n\n\t\treturn deinterleaveAttribute( attribute );\n\n\t}\n\n\tif ( attribute.isInstancedBufferAttribute ) {\n\n\t\treturn new InstancedBufferAttribute().copy( attribute );\n\n\t}\n\n\treturn new BufferAttribute().copy( attribute );\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes( attributes ) {\n\n\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t// a set of InterleavedBufferAttributes for each attribute\n\tlet TypedArray;\n\tlet arrayLength = 0;\n\tlet stride = 0;\n\n\t// calculate the length and type of the interleavedBuffer\n\tfor ( let i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\t\tstride += attribute.itemSize;\n\n\t}\n\n\t// Create the set of buffer attributes\n\tconst interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\tlet offset = 0;\n\tconst res = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\tfor ( let j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\tconst attribute = attributes[ j ];\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst count = attribute.count;\n\t\tconst iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\tres.push( iba );\n\n\t\toffset += itemSize;\n\n\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t// at the appropriate offset\n\t\tfor ( let c = 0; c < count; c ++ ) {\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute( attribute ) {\n\n\tconst cons = attribute.data.array.constructor;\n\tconst count = attribute.count;\n\tconst itemSize = attribute.itemSize;\n\tconst normalized = attribute.normalized;\n\n\tconst array = new cons( count * itemSize );\n\tlet newAttribute;\n\tif ( attribute.isInstancedInterleavedBufferAttribute ) {\n\n\t\tnewAttribute = new InstancedBufferAttribute( array, itemSize, normalized, attribute.meshPerAttribute );\n\n\t} else {\n\n\t\tnewAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tnewAttribute.setX( i, attribute.getX( i ) );\n\n\t\tif ( itemSize >= 2 ) {\n\n\t\t\tnewAttribute.setY( i, attribute.getY( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 3 ) {\n\n\t\t\tnewAttribute.setZ( i, attribute.getZ( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 4 ) {\n\n\t\t\tnewAttribute.setW( i, attribute.getW( i ) );\n\n\t\t}\n\n\t}\n\n\treturn newAttribute;\n\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry( geometry ) {\n\n\tconst attributes = geometry.attributes;\n\tconst morphTargets = geometry.morphTargets;\n\tconst attrMap = new Map();\n\n\tfor ( const key in attributes ) {\n\n\t\tconst attr = attributes[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tattributes[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n\tfor ( const key in morphTargets ) {\n\n\t\tconst attr = morphTargets[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tmorphTargets[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @return {number}\n */\nfunction estimateBytesUsed( geometry ) {\n\n\t// Return the estimated memory used by this geometry in bytes\n\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t// for InterleavedBufferAttributes.\n\tlet mem = 0;\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst attr = geometry.getAttribute( name );\n\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t}\n\n\tconst indices = geometry.getIndex();\n\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\treturn mem;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices( geometry, tolerance = 1e-4 ) {\n\n\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t// if it's already available.\n\tconst hashToIndex = {};\n\tconst indices = geometry.getIndex();\n\tconst positions = geometry.getAttribute( 'position' );\n\tconst vertexCount = indices ? indices.count : positions.count;\n\n\t// next value for triangle indices\n\tlet nextIndex = 0;\n\n\t// attributes and new attribute arrays\n\tconst attributeNames = Object.keys( geometry.attributes );\n\tconst tmpAttributes = {};\n\tconst tmpMorphAttributes = {};\n\tconst newIndices = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t// Initialize the arrays, allocating space conservatively. Extra\n\t// space will be trimmed in the last step.\n\tfor ( let i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\tconst name = attributeNames[ i ];\n\t\tconst attr = geometry.attributes[ name ];\n\n\t\ttmpAttributes[ name ] = new attr.constructor(\n\t\t\tnew attr.array.constructor( attr.count * attr.itemSize ),\n\t\t\tattr.itemSize,\n\t\t\tattr.normalized\n\t\t);\n\n\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\tif ( morphAttributes ) {\n\n\t\t\tif ( ! tmpMorphAttributes[ name ] ) tmpMorphAttributes[ name ] = [];\n\t\t\tmorphAttributes.forEach( ( morphAttr, i ) => {\n\n\t\t\t\tconst array = new morphAttr.array.constructor( morphAttr.count * morphAttr.itemSize );\n\t\t\t\ttmpMorphAttributes[ name ][ i ] = new morphAttr.constructor( array, morphAttr.itemSize, morphAttr.normalized );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// convert the error tolerance to an amount of decimal places to truncate to\n\tconst halfTolerance = tolerance * 0.5;\n\tconst exponent = Math.log10( 1 / tolerance );\n\tconst hashMultiplier = Math.pow( 10, exponent );\n\tconst hashAdditive = halfTolerance * hashMultiplier;\n\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\tconst index = indices ? indices.getX( i ) : i;\n\n\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\tlet hash = '';\n\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\tconst name = attributeNames[ j ];\n\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\tconst itemSize = attribute.itemSize;\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * hashMultiplier + hashAdditive ) },`;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add another reference to the vertex if it's already\n\t\t// used by another index\n\t\tif ( hash in hashToIndex ) {\n\n\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t} else {\n\n\t\t\t// copy data to the new index in the temporary attributes\n\t\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tconst name = attributeNames[ j ];\n\t\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\t\t\tconst itemSize = attribute.itemSize;\n\t\t\t\tconst newArray = tmpAttributes[ name ];\n\t\t\t\tconst newMorphArrays = tmpMorphAttributes[ name ];\n\n\t\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tconst getterFunc = getters[ k ];\n\t\t\t\t\tconst setterFunc = setters[ k ];\n\t\t\t\t\tnewArray[ setterFunc ]( nextIndex, attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\tif ( morphAttributes ) {\n\n\t\t\t\t\t\tfor ( let m = 0, ml = morphAttributes.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\tnewMorphArrays[ m ][ setterFunc ]( nextIndex, morphAttributes[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\tnewIndices.push( nextIndex );\n\t\t\tnextIndex ++;\n\n\t\t}\n\n\t}\n\n\t// generate result BufferGeometry\n\tconst result = geometry.clone();\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst tmpAttribute = tmpAttributes[ name ];\n\n\t\tresult.setAttribute( name, new tmpAttribute.constructor(\n\t\t\ttmpAttribute.array.slice( 0, nextIndex * tmpAttribute.itemSize ),\n\t\t\ttmpAttribute.itemSize,\n\t\t\ttmpAttribute.normalized,\n\t\t) );\n\n\t\tif ( ! ( name in tmpMorphAttributes ) ) continue;\n\n\t\tfor ( let j = 0; j < tmpMorphAttributes[ name ].length; j ++ ) {\n\n\t\t\tconst tmpMorphAttribute = tmpMorphAttributes[ name ][ j ];\n\n\t\t\tresult.morphAttributes[ name ][ j ] = new tmpMorphAttribute.constructor(\n\t\t\t\ttmpMorphAttribute.array.slice( 0, nextIndex * tmpMorphAttribute.itemSize ),\n\t\t\t\ttmpMorphAttribute.itemSize,\n\t\t\t\ttmpMorphAttribute.normalized,\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// indices\n\n\tresult.setIndex( newIndices );\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\treturn geometry;\n\n\t}\n\n\tif ( drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode ) {\n\n\t\tlet index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tconst indices = [];\n\n\t\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst numberOfTriangles = index.count - 2;\n\t\tconst newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tconst newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\t\tnewGeometry.clearGroups();\n\n\t\treturn newGeometry;\n\n\t} else {\n\n\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\treturn geometry;\n\n\t}\n\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes( object ) {\n\n\tconst _vA = new Vector3();\n\tconst _vB = new Vector3();\n\tconst _vC = new Vector3();\n\n\tconst _tempA = new Vector3();\n\tconst _tempB = new Vector3();\n\tconst _tempC = new Vector3();\n\n\tconst _morphA = new Vector3();\n\tconst _morphB = new Vector3();\n\tconst _morphC = new Vector3();\n\n\tfunction _calculateMorphedAttributeData(\n\t\tobject,\n\t\tattribute,\n\t\tmorphAttribute,\n\t\tmorphTargetsRelative,\n\t\ta,\n\t\tb,\n\t\tc,\n\t\tmodifiedAttributeArray\n\t) {\n\n\t\t_vA.fromBufferAttribute( attribute, a );\n\t\t_vB.fromBufferAttribute( attribute, b );\n\t\t_vC.fromBufferAttribute( attribute, c );\n\n\t\tconst morphInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphAttribute && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\t\t\t_morphB.set( 0, 0, 0 );\n\t\t\t_morphC.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morph = morphAttribute[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morph, a );\n\t\t\t\t_tempB.fromBufferAttribute( morph, b );\n\t\t\t\t_tempC.fromBufferAttribute( morph, c );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_vA.add( _morphA );\n\t\t\t_vB.add( _morphB );\n\t\t\t_vC.add( _morphC );\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tobject.applyBoneTransform( a, _vA );\n\t\t\tobject.applyBoneTransform( b, _vB );\n\t\t\tobject.applyBoneTransform( c, _vC );\n\n\t\t}\n\n\t\tmodifiedAttributeArray[ a * 3 + 0 ] = _vA.x;\n\t\tmodifiedAttributeArray[ a * 3 + 1 ] = _vA.y;\n\t\tmodifiedAttributeArray[ a * 3 + 2 ] = _vA.z;\n\t\tmodifiedAttributeArray[ b * 3 + 0 ] = _vB.x;\n\t\tmodifiedAttributeArray[ b * 3 + 1 ] = _vB.y;\n\t\tmodifiedAttributeArray[ b * 3 + 2 ] = _vB.z;\n\t\tmodifiedAttributeArray[ c * 3 + 0 ] = _vC.x;\n\t\tmodifiedAttributeArray[ c * 3 + 1 ] = _vC.y;\n\t\tmodifiedAttributeArray[ c * 3 + 2 ] = _vC.z;\n\n\t}\n\n\tconst geometry = object.geometry;\n\tconst material = object.material;\n\n\tlet a, b, c;\n\tconst index = geometry.index;\n\tconst positionAttribute = geometry.attributes.position;\n\tconst morphPosition = geometry.morphAttributes.position;\n\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\tconst normalAttribute = geometry.attributes.normal;\n\tconst morphNormal = geometry.morphAttributes.position;\n\n\tconst groups = geometry.groups;\n\tconst drawRange = geometry.drawRange;\n\tlet i, j, il, jl;\n\tlet group;\n\tlet start, end;\n\n\tconst modifiedPosition = new Float32Array( positionAttribute.count * positionAttribute.itemSize );\n\tconst modifiedNormal = new Float32Array( normalAttribute.count * normalAttribute.itemSize );\n\n\tif ( index !== null ) {\n\n\t\t// indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = index.getX( j );\n\t\t\t\t\tb = index.getX( j + 1 );\n\t\t\t\t\tc = index.getX( j + 2 );\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = index.getX( i );\n\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// non-indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = j;\n\t\t\t\t\tb = j + 1;\n\t\t\t\t\tc = j + 2;\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = i;\n\t\t\t\tb = i + 1;\n\t\t\t\tc = i + 2;\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst morphedPositionAttribute = new Float32BufferAttribute( modifiedPosition, 3 );\n\tconst morphedNormalAttribute = new Float32BufferAttribute( modifiedNormal, 3 );\n\n\treturn {\n\n\t\tpositionAttribute: positionAttribute,\n\t\tnormalAttribute: normalAttribute,\n\t\tmorphedPositionAttribute: morphedPositionAttribute,\n\t\tmorphedNormalAttribute: morphedNormalAttribute\n\n\t};\n\n}\n\nfunction mergeGroups( geometry ) {\n\n\tif ( geometry.groups.length === 0 ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.' );\n\t\treturn geometry;\n\n\t}\n\n\tlet groups = geometry.groups;\n\n\t// sort groups by material index\n\n\tgroups = groups.sort( ( a, b ) => {\n\n\t\tif ( a.materialIndex !== b.materialIndex ) return a.materialIndex - b.materialIndex;\n\n\t\treturn a.start - b.start;\n\n\t} );\n\n\t// create index for non-indexed geometries\n\n\tif ( geometry.getIndex() === null ) {\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\t\tconst indices = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i += 3 ) {\n\n\t\t\tindices.push( i, i + 1, i + 2 );\n\n\t\t}\n\n\t\tgeometry.setIndex( indices );\n\n\t}\n\n\t// sort index\n\n\tconst index = geometry.getIndex();\n\n\tconst newIndices = [];\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tconst groupStart = group.start;\n\t\tconst groupLength = groupStart + group.count;\n\n\t\tfor ( let j = groupStart; j < groupLength; j ++ ) {\n\n\t\t\tnewIndices.push( index.getX( j ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dispose(); // Required to force buffer recreation\n\tgeometry.setIndex( newIndices );\n\n\t// update groups indices\n\n\tlet start = 0;\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tgroup.start = start;\n\t\tstart += group.count;\n\n\t}\n\n\t// merge groups\n\n\tlet currentGroup = groups[ 0 ];\n\n\tgeometry.groups = [ currentGroup ];\n\n\tfor ( let i = 1; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tif ( currentGroup.materialIndex === group.materialIndex ) {\n\n\t\t\tcurrentGroup.count += group.count;\n\n\t\t} else {\n\n\t\t\tcurrentGroup = group;\n\t\t\tgeometry.groups.push( currentGroup );\n\n\t\t}\n\n\t}\n\n\treturn geometry;\n\n}\n\n\n/**\n * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,\n * non-indexed geometry. Returns the geometry with smooth normals everywhere except\n * faces that meet at an angle greater than the crease angle.\n *\n * @param {BufferGeometry} geometry\n * @param {number} [creaseAngle]\n * @return {BufferGeometry}\n */\nfunction toCreasedNormals( geometry, creaseAngle = Math.PI / 3 /* 60 degrees */ ) {\n\n\tconst creaseDot = Math.cos( creaseAngle );\n\tconst hashMultiplier = ( 1 + 1e-10 ) * 1e2;\n\n\t// reusable vectors\n\tconst verts = [ new Vector3(), new Vector3(), new Vector3() ];\n\tconst tempVec1 = new Vector3();\n\tconst tempVec2 = new Vector3();\n\tconst tempNorm = new Vector3();\n\tconst tempNorm2 = new Vector3();\n\n\t// hashes a vector\n\tfunction hashVertex( v ) {\n\n\t\tconst x = ~ ~ ( v.x * hashMultiplier );\n\t\tconst y = ~ ~ ( v.y * hashMultiplier );\n\t\tconst z = ~ ~ ( v.z * hashMultiplier );\n\t\treturn `${x},${y},${z}`;\n\n\t}\n\n\t// BufferGeometry.toNonIndexed() warns if the geometry is non-indexed\n\t// and returns the original geometry\n\tconst resultGeometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\tconst posAttr = resultGeometry.attributes.position;\n\tconst vertexMap = {};\n\n\t// find all the normals shared by commonly located vertices\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\t// add the normal to the map for all vertices\n\t\tconst normal = new Vector3().crossVectors( tempVec1, tempVec2 ).normalize();\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tif ( ! ( hash in vertexMap ) ) {\n\n\t\t\t\tvertexMap[ hash ] = [];\n\n\t\t\t}\n\n\t\t\tvertexMap[ hash ].push( normal );\n\n\t\t}\n\n\t}\n\n\t// average normals from all vertices that share a common location if they are within the\n\t// provided crease threshold\n\tconst normalArray = new Float32Array( posAttr.count * 3 );\n\tconst normAttr = new BufferAttribute( normalArray, 3, false );\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\t// get the face normal for this vertex\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\ttempNorm.crossVectors( tempVec1, tempVec2 ).normalize();\n\n\t\t// average all normals that meet the threshold and set the normal value\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tconst otherNormals = vertexMap[ hash ];\n\t\t\ttempNorm2.set( 0, 0, 0 );\n\n\t\t\tfor ( let k = 0, lk = otherNormals.length; k < lk; k ++ ) {\n\n\t\t\t\tconst otherNorm = otherNormals[ k ];\n\t\t\t\tif ( tempNorm.dot( otherNorm ) > creaseDot ) {\n\n\t\t\t\t\ttempNorm2.add( otherNorm );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttempNorm2.normalize();\n\t\t\tnormAttr.setXYZ( i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z );\n\n\t\t}\n\n\t}\n\n\tresultGeometry.setAttribute( 'normal', normAttr );\n\treturn resultGeometry;\n\n}\n\nexport {\n\tcomputeMikkTSpaceTangents,\n\tmergeGeometries,\n\tmergeAttributes,\n\tinterleaveAttributes,\n\testimateBytesUsed,\n\tmergeVertices,\n\ttoTrianglesDrawMode,\n\tcomputeMorphedAttributes,\n\tmergeGroups,\n\ttoCreasedNormals\n};\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tColorManagement,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInstancedMesh,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tInstancedBufferAttribute\n} from 'three';\nimport { toTrianglesDrawMode } from '../utils/BufferGeometryUtils.js';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsDispersionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureAVIFExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsEmissiveStrengthExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIridescenceExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsAnisotropyExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsBumpExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshGpuInstancing( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\t// If a base path is set, resources will be relative paths from that plus the relative path of the gltf file\n\t\t\t// Example  path = 'https://my-cnd-server.com/', url = 'assets/models/model.gltf'\n\t\t\t// resourcePath = 'https://my-cnd-server.com/assets/models/'\n\t\t\t// referenced resource 'model.bin' will be loaded from 'https://my-cnd-server.com/assets/models/model.bin'\n\t\t\t// referenced resource '../textures/texture.png' will be loaded from 'https://my-cnd-server.com/assets/textures/texture.png'\n\t\t\tconst relativeUrl = LoaderUtils.extractUrlBase( url );\n\t\t\tresourcePath = LoaderUtils.resolveURL( relativeUrl, this.path );\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet json;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tjson = JSON.parse( data );\n\n\t\t} else if ( data instanceof ArrayBuffer ) {\n\n\t\t\tconst magic = textDecoder.decode( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tjson = JSON.parse( extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content );\n\n\t\t\t} else {\n\n\t\t\t\tjson = JSON.parse( textDecoder.decode( data ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tjson = data;\n\n\t\t}\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\n\t\t\tif ( ! plugin.name ) console.error( 'THREE.GLTFLoader: Invalid plugin found: missing name' );\n\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_DISPERSION: 'KHR_materials_dispersion',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n\tKHR_MATERIALS_ANISOTROPY: 'KHR_materials_anisotropy',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tKHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n\tEXT_MATERIALS_BUMP: 'EXT_materials_bump',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_TEXTURE_AVIF: 'EXT_texture_avif',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n\tEXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.setRGB( lightDef.color[ 0 ], lightDef.color[ 1 ], lightDef.color[ 2 ], LinearSRGBColorSpace );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tassignExtrasToUserData( lightNode, lightDef );\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tgetDependency( type, index ) {\n\n\t\tif ( type !== 'light' ) return;\n\n\t\treturn this._loadLight( index );\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst emissiveStrength = materialDef.extensions[ this.name ].emissiveStrength;\n\n\t\tif ( emissiveStrength !== undefined ) {\n\n\t\t\tmaterialParams.emissiveIntensity = emissiveStrength;\n\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials dispersion Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_dispersion\n */\nclass GLTFMaterialsDispersionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_DISPERSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.dispersion = extension.dispersion !== undefined ? extension.dispersion : 0;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.iridescenceFactor !== undefined ) {\n\n\t\t\tmaterialParams.iridescence = extension.iridescenceFactor;\n\n\t\t}\n\n\t\tif ( extension.iridescenceTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceMap', extension.iridescenceTexture ) );\n\n\t\t}\n\n\t\tif ( extension.iridescenceIor !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceIOR = extension.iridescenceIor;\n\n\t\t}\n\n\t\tif ( materialParams.iridescenceThicknessRange === undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange = [ 100, 400 ];\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMinimum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 0 ] = extension.iridescenceThicknessMinimum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMaximum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 1 ] = extension.iridescenceThicknessMaximum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceThicknessMap', extension.iridescenceThicknessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tconst colorFactor = extension.sheenColorFactor;\n\t\t\tmaterialParams.sheenColor.setRGB( colorFactor[ 0 ], colorFactor[ 1 ], colorFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n\n/**\n * Materials bump Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_materials_bump\n */\nclass GLTFMaterialsBumpExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_MATERIALS_BUMP;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.bumpScale = extension.bumpFactor !== undefined ? extension.bumpFactor : 1.0;\n\n\t\tif ( extension.bumpTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'bumpMap', extension.bumpTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials anisotropy Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_anisotropy\n */\nclass GLTFMaterialsAnisotropyExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_ANISOTROPY;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.anisotropyStrength !== undefined ) {\n\n\t\t\tmaterialParams.anisotropy = extension.anisotropyStrength;\n\n\t\t}\n\n\t\tif ( extension.anisotropyRotation !== undefined ) {\n\n\t\t\tmaterialParams.anisotropyRotation = extension.anisotropyRotation;\n\n\t\t}\n\n\t\tif ( extension.anisotropyTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'anisotropyMap', extension.anisotropyTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: AVIF required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image.\n\t\t\t\timage.src = 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn buffer.then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst source = new Uint8Array( res, byteOffset, byteLength );\n\n\t\t\t\tif ( decoder.decodeGltfBufferAsync ) {\n\n\t\t\t\t\treturn decoder.decodeGltfBufferAsync( count, stride, source, extensionDef.mode, extensionDef.filter ).then( function ( res ) {\n\n\t\t\t\t\t\treturn res.buffer;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n\t\t\t\t\treturn decoder.ready.then( function () {\n\n\t\t\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n\t\tthis.parser = parser;\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( ! nodeDef.extensions || ! nodeDef.extensions[ this.name ] ||\n\t\t\tnodeDef.mesh === undefined ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst meshDef = json.meshes[ nodeDef.mesh ];\n\n\t\t// No Points or Lines + Instancing support yet\n\n\t\tfor ( const primitive of meshDef.primitives ) {\n\n\t\t\tif ( primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n\t\t\t\t primitive.mode !== undefined ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensionDef = nodeDef.extensions[ this.name ];\n\t\tconst attributesDef = extensionDef.attributes;\n\n\t\t// @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n\t\tconst pending = [];\n\t\tconst attributes = {};\n\n\t\tfor ( const key in attributesDef ) {\n\n\t\t\tpending.push( this.parser.getDependency( 'accessor', attributesDef[ key ] ).then( accessor => {\n\n\t\t\t\tattributes[ key ] = accessor;\n\t\t\t\treturn attributes[ key ];\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tif ( pending.length < 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tpending.push( this.parser.createNodeMesh( nodeIndex ) );\n\n\t\treturn Promise.all( pending ).then( results => {\n\n\t\t\tconst nodeObject = results.pop();\n\t\t\tconst meshes = nodeObject.isGroup ? nodeObject.children : [ nodeObject ];\n\t\t\tconst count = results[ 0 ].count; // All attribute counts should be same\n\t\t\tconst instancedMeshes = [];\n\n\t\t\tfor ( const mesh of meshes ) {\n\n\t\t\t\t// Temporal variables\n\t\t\t\tconst m = new Matrix4();\n\t\t\t\tconst p = new Vector3();\n\t\t\t\tconst q = new Quaternion();\n\t\t\t\tconst s = new Vector3( 1, 1, 1 );\n\n\t\t\t\tconst instancedMesh = new InstancedMesh( mesh.geometry, mesh.material, count );\n\n\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\tif ( attributes.TRANSLATION ) {\n\n\t\t\t\t\t\tp.fromBufferAttribute( attributes.TRANSLATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.ROTATION ) {\n\n\t\t\t\t\t\tq.fromBufferAttribute( attributes.ROTATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.SCALE ) {\n\n\t\t\t\t\t\ts.fromBufferAttribute( attributes.SCALE, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinstancedMesh.setMatrixAt( i, m.compose( p, q, s ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Add instance attributes to the geometry, excluding TRS.\n\t\t\t\tfor ( const attributeName in attributes ) {\n\n\t\t\t\t\tif ( attributeName === '_COLOR_0' ) {\n\n\t\t\t\t\t\tconst attr = attributes[ attributeName ];\n\t\t\t\t\t\tinstancedMesh.instanceColor = new InstancedBufferAttribute( attr.array, attr.itemSize, attr.normalized );\n\n\t\t\t\t\t} else if ( attributeName !== 'TRANSLATION' &&\n\t\t\t\t\t\t attributeName !== 'ROTATION' &&\n\t\t\t\t\t\t attributeName !== 'SCALE' ) {\n\n\t\t\t\t\t\tmesh.geometry.setAttribute( attributeName, attributes[ attributeName ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Just in case\n\t\t\t\tObject3D.prototype.copy.call( instancedMesh, mesh );\n\n\t\t\t\tthis.parser.assignFinalMaterial( instancedMesh );\n\n\t\t\t\tinstancedMeshes.push( instancedMesh );\n\n\t\t\t}\n\n\t\t\tif ( nodeObject.isGroup ) {\n\n\t\t\t\tnodeObject.clear();\n\n\t\t\t\tnodeObject.add( ... instancedMeshes );\n\n\t\t\t\treturn nodeObject;\n\n\t\t\t}\n\n\t\t\treturn instancedMeshes[ 0 ];\n\n\t\t} );\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tthis.header = {\n\t\t\tmagic: textDecoder.decode( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = textDecoder.decode( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType.name;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap, LinearSRGBColorSpace, reject );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( ( transform.texCoord === undefined || transform.texCoord === texture.channel )\n\t\t\t&& transform.offset === undefined\n\t\t\t&& transform.rotation === undefined\n\t\t\t&& transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\ttexture.channel = transform.texCoord;\n\n\t\t}\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer;\n\t\tconst values = this.sampleValues;\n\t\tconst stride = this.valueSize;\n\n\t\tconst stride2 = stride * 2;\n\t\tconst stride3 = stride * 3;\n\n\t\tconst td = t1 - t0;\n\n\t\tconst p = ( t - t0 ) / td;\n\t\tconst pp = p * p;\n\t\tconst ppp = pp * p;\n\n\t\tconst offset1 = i1 * stride3;\n\t\tconst offset0 = offset1 - stride3;\n\n\t\tconst s2 = - 2 * ppp + 3 * pp;\n\t\tconst s3 = ppp - pp;\n\t\tconst s0 = 1 - s2;\n\t\tconst s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv1',\n\tTEXCOORD_2: 'uv2',\n\tTEXCOORD_3: 'uv3',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\tlet hasMorphColor = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\t\tif ( target.COLOR_0 !== undefined ) hasMorphColor = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal && hasMorphColor ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal && ! hasMorphColor ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\tconst pendingColorAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphColor ) {\n\n\t\t\tconst pendingAccessor = target.COLOR_0 !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.COLOR_0 )\n\t\t\t\t: geometry.attributes.color;\n\n\t\t\tpendingColorAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors ),\n\t\tPromise.all( pendingColorAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\t\tconst morphColors = accessors[ 2 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tif ( hasMorphColor ) geometry.morphAttributes.color = morphColors;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tlet geometryKey;\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\tif ( primitiveDef.targets !== undefined ) {\n\n\t\tfor ( let i = 0, il = primitiveDef.targets.length; i < il; i ++ ) {\n\n\t\t\tgeometryKey += ':' + createAttributesKey( primitiveDef.targets[ i ] );\n\n\t\t}\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\nfunction getImageURIMimeType( uri ) {\n\n\tif ( uri.search( /\\.jpe?g($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/jpeg/ ) === 0 ) return 'image/jpeg';\n\tif ( uri.search( /\\.webp($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/webp/ ) === 0 ) return 'image/webp';\n\tif ( uri.search( /\\.ktx2($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/ktx2/ ) === 0 ) return 'image/ktx2';\n\n\treturn 'image/png';\n\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Node cache\n\t\tthis.nodeCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.sourceCache = {};\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\n\t\tlet isSafari = false;\n\t\tlet safariVersion = - 1;\n\t\tlet isFirefox = false;\n\t\tlet firefoxVersion = - 1;\n\n\t\tif ( typeof navigator !== 'undefined' ) {\n\n\t\t\tconst userAgent = navigator.userAgent;\n\n\t\t\tisSafari = /^((?!chrome|android).)*safari/i.test( userAgent ) === true;\n\t\t\tconst safariMatch = userAgent.match( /Version\\/(\\d+)/ );\n\t\t\tsafariVersion = isSafari && safariMatch ? parseInt( safariMatch[ 1 ], 10 ) : - 1;\n\n\t\t\tisFirefox = userAgent.indexOf( 'Firefox' ) > - 1;\n\t\t\tfirefoxVersion = isFirefox ? userAgent.match( /Firefox\\/([0-9]+)\\./ )[ 1 ] : - 1;\n\n\t\t}\n\n\t\tif ( typeof createImageBitmap === 'undefined' || ( isSafari && safariVersion < 17 ) || ( isFirefox && firefoxVersion < 98 ) ) {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\t\tthis.nodeCache = {};\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\treturn Promise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tfor ( const scene of result.scenes ) {\n\n\t\t\t\t\tscene.updateMatrixWorld();\n\n\t\t\t\t}\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadNode && ext.loadNode( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadAnimation && ext.loadAnimation( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext != this && ext.getDependency && ext.getDependency( type, index );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( ! dependency ) {\n\n\t\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\t\t\tconst normalized = accessorDef.normalized === true;\n\n\t\t\tconst array = new TypedArray( accessorDef.count * itemSize );\n\t\t\treturn Promise.resolve( new BufferAttribute( array, itemSize, normalized ) );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\t// Ignore normalized since we copy from sparse\n\t\t\t\tbufferAttribute.normalized = false;\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute.normalized = normalized;\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture|null>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceIndex = textureDef.source;\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( sourceDef.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( sourceDef.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, sourceIndex, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst cacheKey = ( sourceDef.uri || sourceDef.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst promise = this.loadImageSource( sourceIndex, loader ).then( function ( texture ) {\n\n\t\t\ttexture.flipY = false;\n\n\t\t\ttexture.name = textureDef.name || sourceDef.name || '';\n\n\t\t\tif ( texture.name === '' && typeof sourceDef.uri === 'string' && sourceDef.uri.startsWith( 'data:image/' ) === false ) {\n\n\t\t\t\ttexture.name = sourceDef.uri;\n\n\t\t\t}\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\t\t\ttexture.generateMipmaps = ! texture.isCompressedTexture && texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\tloadImageSource( sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tif ( this.sourceCache[ sourceIndex ] !== undefined ) {\n\n\t\t\treturn this.sourceCache[ sourceIndex ].then( ( texture ) => texture.clone() );\n\n\t\t}\n\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = sourceDef.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( sourceDef.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', sourceDef.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: sourceDef.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( sourceDef.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( texture, sourceDef );\n\n\t\t\ttexture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType( sourceDef.uri );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function ( error ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\tthrow error;\n\n\t\t} );\n\n\t\tthis.sourceCache[ sourceIndex ] = promise;\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef, colorSpace ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture ) return null;\n\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord > 0 ) {\n\n\t\t\t\ttexture = texture.clone();\n\t\t\t\ttexture.channel = mapDef.texCoord;\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = colorSpace;\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.map = material.map;\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tconst emissiveFactor = materialDef.emissiveFactor;\n\t\t\tmaterialParams.emissive = new Color().setRGB( emissiveFactor[ 0 ], emissiveFactor[ 1 ], emissiveFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tconst material = new materialType( materialParams );\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tif ( sanitizedName in this.nodeNamesUsed ) {\n\n\t\t\treturn sanitizedName + '_' + ( ++ this.nodeNamesUsed[ sanitizedName ] );\n\n\t\t} else {\n\n\t\t\tthis.nodeNamesUsed[ sanitizedName ] = 0;\n\n\t\t\treturn sanitizedName;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) {\n\n\t\t\t\t\t\t// normalize skin weights to fix malformed assets (see #15319)\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, meshes[ 0 ], meshDef );\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, group, meshDef );\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Skeleton>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = skinDef.joints.length; i < il; i ++ ) {\n\n\t\t\tpending.push( this._loadNodeShallow( skinDef.joints[ i ] ) );\n\n\t\t}\n\n\t\tif ( skinDef.inverseBindMatrices !== undefined ) {\n\n\t\t\tpending.push( this.getDependency( 'accessor', skinDef.inverseBindMatrices ) );\n\n\t\t} else {\n\n\t\t\tpending.push( null );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst inverseBindMatrices = results.pop();\n\t\t\tconst jointNodes = results;\n\n\t\t\t// Note that bones (joint nodes) may or may not be in the\n\t\t\t// scene graph at this time.\n\n\t\t\tconst bones = [];\n\t\t\tconst boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = jointNodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst jointNode = jointNodes[ i ];\n\n\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\tif ( inverseBindMatrices !== null ) {\n\n\t\t\t\t\t\tmat.fromArray( inverseBindMatrices.array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\t\tconst animationName = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node;\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tif ( target.node === undefined ) continue;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tif ( node.updateMatrix ) {\n\n\t\t\t\t\tnode.updateMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tconst createdTracks = parser._createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target );\n\n\t\t\t\tif ( createdTracks ) {\n\n\t\t\t\t\tfor ( let k = 0; k < createdTracks.length; k ++ ) {\n\n\t\t\t\t\t\ttracks.push( createdTracks[ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( animationName, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tconst nodePending = parser._loadNodeShallow( nodeIndex );\n\n\t\tconst childPending = [];\n\t\tconst childrenDef = nodeDef.children || [];\n\n\t\tfor ( let i = 0, il = childrenDef.length; i < il; i ++ ) {\n\n\t\t\tchildPending.push( parser.getDependency( 'node', childrenDef[ i ] ) );\n\n\t\t}\n\n\t\tconst skeletonPending = nodeDef.skin === undefined\n\t\t\t? Promise.resolve( null )\n\t\t\t: parser.getDependency( 'skin', nodeDef.skin );\n\n\t\treturn Promise.all( [\n\t\t\tnodePending,\n\t\t\tPromise.all( childPending ),\n\t\t\tskeletonPending\n\t\t] ).then( function ( results ) {\n\n\t\t\tconst node = results[ 0 ];\n\t\t\tconst children = results[ 1 ];\n\t\t\tconst skeleton = results[ 2 ];\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\t// This full traverse should be fine because\n\t\t\t\t// child glTF nodes have not been added to this node yet.\n\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\tif ( ! mesh.isSkinnedMesh ) return;\n\n\t\t\t\t\tmesh.bind( skeleton, _identityMatrix );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tnode.add( children[ i ] );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t// ._loadNodeShallow() parses a single node.\n\t// skin and child nodes are created and added in .loadNode() (no '_' prefix).\n\t_loadNodeShallow( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\t// This method is called from .loadNode() and .loadSkin().\n\t\t// Cache a node to avoid duplication.\n\n\t\tif ( this.nodeCache[ nodeIndex ] !== undefined ) {\n\n\t\t\treturn this.nodeCache[ nodeIndex ];\n\n\t\t}\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\tconst pending = [];\n\n\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t} );\n\n\t\tif ( meshPromise ) {\n\n\t\t\tpending.push( meshPromise );\n\n\t\t}\n\n\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t} ).forEach( function ( promise ) {\n\n\t\t\tpending.push( promise );\n\n\t\t} );\n\n\t\tthis.nodeCache[ nodeIndex ] = Promise.all( pending ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t\treturn this.nodeCache[ nodeIndex ];\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( parser.getDependency( 'node', nodeIds[ i ] ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( nodes ) {\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tscene.add( nodes[ i ] );\n\n\t\t\t}\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n\t_createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target ) {\n\n\t\tconst tracks = [];\n\n\t\tconst targetName = node.name ? node.name : node.uuid;\n\t\tconst targetNames = [];\n\n\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\ttargetNames.push( targetName );\n\n\t\t}\n\n\t\tlet TypedKeyframeTrack;\n\n\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.position:\n\t\t\tcase PATH_PROPERTIES.scale:\n\n\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tswitch ( outputAccessor.itemSize ) {\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\n\t\tconst outputArray = this._getArrayFromAccessor( outputAccessor );\n\n\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\tinputAccessor.array,\n\t\t\t\toutputArray,\n\t\t\t\tinterpolation\n\t\t\t);\n\n\t\t\t// Override interpolation with custom factory method.\n\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\tthis._createCubicSplineTrackInterpolant( track );\n\n\t\t\t}\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\t_getArrayFromAccessor( accessor ) {\n\n\t\tlet outputArray = accessor.array;\n\n\t\tif ( accessor.normalized ) {\n\n\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t}\n\n\t\t\toutputArray = scaled;\n\n\t\t}\n\n\t\treturn outputArray;\n\n\t}\n\n\t_createCubicSplineTrackInterpolant( track ) {\n\n\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t};\n\n\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tif ( ColorManagement.workingColorSpace !== LinearSRGBColorSpace && 'COLOR_0' in attributes ) {\n\n\t\tconsole.warn( `THREE.GLTFLoader: Converting vertex colors from \"srgb-linear\" to \"${ColorManagement.workingColorSpace}\" not supported.` );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\nexport { GLTFLoader };\n","import {\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tEqualStencilFunc,\n\tIncrementStencilOp\n} from 'three';\n\n/**\n * A shadow Mesh that follows a shadow-casting Mesh in the scene, but is confined to a single plane.\n */\n\nconst _shadowMatrix = new Matrix4();\n\nclass ShadowMesh extends Mesh {\n\n\tconstructor( mesh ) {\n\n\t\tconst shadowMaterial = new MeshBasicMaterial( {\n\n\t\t\tcolor: 0x000000,\n\t\t\ttransparent: true,\n\t\t\topacity: 0.6,\n\t\t\tdepthWrite: false,\n\t\t\tstencilWrite: true,\n\t\t\tstencilFunc: EqualStencilFunc,\n\t\t\tstencilRef: 0,\n\t\t\tstencilZPass: IncrementStencilOp\n\n\t\t} );\n\n\t\tsuper( mesh.geometry, shadowMaterial );\n\n\t\tthis.isShadowMesh = true;\n\n\t\tthis.meshMatrix = mesh.matrixWorld;\n\n\t\tthis.frustumCulled = false;\n\t\tthis.matrixAutoUpdate = false;\n\n\t}\n\n\tupdate( plane, lightPosition4D ) {\n\n\t\t// based on https://www.opengl.org/archives/resources/features/StencilTalk/tsld021.htm\n\n\t\tconst dot = plane.normal.x * lightPosition4D.x +\n\t\t\t  plane.normal.y * lightPosition4D.y +\n\t\t\t  plane.normal.z * lightPosition4D.z +\n\t\t\t  - plane.constant * lightPosition4D.w;\n\n\t\tconst sme = _shadowMatrix.elements;\n\n\t\tsme[ 0 ] = dot - lightPosition4D.x * plane.normal.x;\n\t\tsme[ 4 ] = - lightPosition4D.x * plane.normal.y;\n\t\tsme[ 8 ] = - lightPosition4D.x * plane.normal.z;\n\t\tsme[ 12 ] = - lightPosition4D.x * - plane.constant;\n\n\t\tsme[ 1 ] = - lightPosition4D.y * plane.normal.x;\n\t\tsme[ 5 ] = dot - lightPosition4D.y * plane.normal.y;\n\t\tsme[ 9 ] = - lightPosition4D.y * plane.normal.z;\n\t\tsme[ 13 ] = - lightPosition4D.y * - plane.constant;\n\n\t\tsme[ 2 ] = - lightPosition4D.z * plane.normal.x;\n\t\tsme[ 6 ] = - lightPosition4D.z * plane.normal.y;\n\t\tsme[ 10 ] = dot - lightPosition4D.z * plane.normal.z;\n\t\tsme[ 14 ] = - lightPosition4D.z * - plane.constant;\n\n\t\tsme[ 3 ] = - lightPosition4D.w * plane.normal.x;\n\t\tsme[ 7 ] = - lightPosition4D.w * plane.normal.y;\n\t\tsme[ 11 ] = - lightPosition4D.w * plane.normal.z;\n\t\tsme[ 15 ] = dot - lightPosition4D.w * - plane.constant;\n\n\t\tthis.matrix.multiplyMatrices( _shadowMatrix, this.meshMatrix );\n\n\t}\n\n}\n\nexport { ShadowMesh };\n","/*! Tweakpane 3.1.10 (c) 2016 cocopon, licensed under the MIT license. */\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.Tweakpane = {}));\n})(this, (function (exports) { 'use strict';\n\n    /***\n     * A simple semantic versioning perser.\n     */\n    class Semver {\n        /**\n         * @hidden\n         */\n        constructor(text) {\n            const [core, prerelease] = text.split('-');\n            const coreComps = core.split('.');\n            this.major = parseInt(coreComps[0], 10);\n            this.minor = parseInt(coreComps[1], 10);\n            this.patch = parseInt(coreComps[2], 10);\n            this.prerelease = prerelease !== null && prerelease !== void 0 ? prerelease : null;\n        }\n        toString() {\n            const core = [this.major, this.minor, this.patch].join('.');\n            return this.prerelease !== null ? [core, this.prerelease].join('-') : core;\n        }\n    }\n\n    class BladeApi {\n        constructor(controller) {\n            this.controller_ = controller;\n        }\n        get element() {\n            return this.controller_.view.element;\n        }\n        get disabled() {\n            return this.controller_.viewProps.get('disabled');\n        }\n        set disabled(disabled) {\n            this.controller_.viewProps.set('disabled', disabled);\n        }\n        get hidden() {\n            return this.controller_.viewProps.get('hidden');\n        }\n        set hidden(hidden) {\n            this.controller_.viewProps.set('hidden', hidden);\n        }\n        dispose() {\n            this.controller_.viewProps.set('disposed', true);\n        }\n    }\n\n    class TpEvent {\n        constructor(target) {\n            this.target = target;\n        }\n    }\n    class TpChangeEvent extends TpEvent {\n        constructor(target, value, presetKey, last) {\n            super(target);\n            this.value = value;\n            this.presetKey = presetKey;\n            this.last = last !== null && last !== void 0 ? last : true;\n        }\n    }\n    class TpUpdateEvent extends TpEvent {\n        constructor(target, value, presetKey) {\n            super(target);\n            this.value = value;\n            this.presetKey = presetKey;\n        }\n    }\n    class TpFoldEvent extends TpEvent {\n        constructor(target, expanded) {\n            super(target);\n            this.expanded = expanded;\n        }\n    }\n    class TpTabSelectEvent extends TpEvent {\n        constructor(target, index) {\n            super(target);\n            this.index = index;\n        }\n    }\n\n    function forceCast(v) {\n        return v;\n    }\n    function isEmpty(value) {\n        return value === null || value === undefined;\n    }\n    function deepEqualsArray(a1, a2) {\n        if (a1.length !== a2.length) {\n            return false;\n        }\n        for (let i = 0; i < a1.length; i++) {\n            if (a1[i] !== a2[i]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    function isPropertyWritable(obj, key) {\n        let target = obj;\n        do {\n            const d = Object.getOwnPropertyDescriptor(target, key);\n            if (d && (d.set !== undefined || d.writable === true)) {\n                return true;\n            }\n            target = Object.getPrototypeOf(target);\n        } while (target !== null);\n        return false;\n    }\n\n    const CREATE_MESSAGE_MAP = {\n        alreadydisposed: () => 'View has been already disposed',\n        invalidparams: (context) => `Invalid parameters for '${context.name}'`,\n        nomatchingcontroller: (context) => `No matching controller for '${context.key}'`,\n        nomatchingview: (context) => `No matching view for '${JSON.stringify(context.params)}'`,\n        notbindable: () => `Value is not bindable`,\n        propertynotfound: (context) => `Property '${context.name}' not found`,\n        shouldneverhappen: () => 'This error should never happen',\n    };\n    class TpError {\n        static alreadyDisposed() {\n            return new TpError({ type: 'alreadydisposed' });\n        }\n        static notBindable() {\n            return new TpError({\n                type: 'notbindable',\n            });\n        }\n        static propertyNotFound(name) {\n            return new TpError({\n                type: 'propertynotfound',\n                context: {\n                    name: name,\n                },\n            });\n        }\n        static shouldNeverHappen() {\n            return new TpError({ type: 'shouldneverhappen' });\n        }\n        constructor(config) {\n            var _a;\n            this.message =\n                (_a = CREATE_MESSAGE_MAP[config.type](forceCast(config.context))) !== null && _a !== void 0 ? _a : 'Unexpected error';\n            this.name = this.constructor.name;\n            this.stack = new Error(this.message).stack;\n            this.type = config.type;\n        }\n    }\n\n    class BindingTarget {\n        constructor(obj, key, opt_id) {\n            this.obj_ = obj;\n            this.key_ = key;\n            this.presetKey_ = opt_id !== null && opt_id !== void 0 ? opt_id : key;\n        }\n        static isBindable(obj) {\n            if (obj === null) {\n                return false;\n            }\n            if (typeof obj !== 'object' && typeof obj !== 'function') {\n                return false;\n            }\n            return true;\n        }\n        get key() {\n            return this.key_;\n        }\n        get presetKey() {\n            return this.presetKey_;\n        }\n        read() {\n            return this.obj_[this.key_];\n        }\n        write(value) {\n            this.obj_[this.key_] = value;\n        }\n        writeProperty(name, value) {\n            const valueObj = this.read();\n            if (!BindingTarget.isBindable(valueObj)) {\n                throw TpError.notBindable();\n            }\n            if (!(name in valueObj)) {\n                throw TpError.propertyNotFound(name);\n            }\n            valueObj[name] = value;\n        }\n    }\n\n    class ButtonApi extends BladeApi {\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        get title() {\n            var _a;\n            return (_a = this.controller_.valueController.props.get('title')) !== null && _a !== void 0 ? _a : '';\n        }\n        set title(title) {\n            this.controller_.valueController.props.set('title', title);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            const emitter = this.controller_.valueController.emitter;\n            emitter.on(eventName, () => {\n                bh(new TpEvent(this));\n            });\n            return this;\n        }\n    }\n\n    class Emitter {\n        constructor() {\n            this.observers_ = {};\n        }\n        on(eventName, handler) {\n            let observers = this.observers_[eventName];\n            if (!observers) {\n                observers = this.observers_[eventName] = [];\n            }\n            observers.push({\n                handler: handler,\n            });\n            return this;\n        }\n        off(eventName, handler) {\n            const observers = this.observers_[eventName];\n            if (observers) {\n                this.observers_[eventName] = observers.filter((observer) => {\n                    return observer.handler !== handler;\n                });\n            }\n            return this;\n        }\n        emit(eventName, event) {\n            const observers = this.observers_[eventName];\n            if (!observers) {\n                return;\n            }\n            observers.forEach((observer) => {\n                observer.handler(event);\n            });\n        }\n    }\n\n    const PREFIX = 'tp';\n    function ClassName(viewName) {\n        const fn = (opt_elementName, opt_modifier) => {\n            return [\n                PREFIX,\n                '-',\n                viewName,\n                'v',\n                opt_elementName ? `_${opt_elementName}` : '',\n                opt_modifier ? `-${opt_modifier}` : '',\n            ].join('');\n        };\n        return fn;\n    }\n\n    function compose(h1, h2) {\n        return (input) => h2(h1(input));\n    }\n    function extractValue(ev) {\n        return ev.rawValue;\n    }\n    function bindValue(value, applyValue) {\n        value.emitter.on('change', compose(extractValue, applyValue));\n        applyValue(value.rawValue);\n    }\n    function bindValueMap(valueMap, key, applyValue) {\n        bindValue(valueMap.value(key), applyValue);\n    }\n\n    function applyClass(elem, className, active) {\n        if (active) {\n            elem.classList.add(className);\n        }\n        else {\n            elem.classList.remove(className);\n        }\n    }\n    function valueToClassName(elem, className) {\n        return (value) => {\n            applyClass(elem, className, value);\n        };\n    }\n    function bindValueToTextContent(value, elem) {\n        bindValue(value, (text) => {\n            elem.textContent = text !== null && text !== void 0 ? text : '';\n        });\n    }\n\n    const className$q = ClassName('btn');\n    class ButtonView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$q());\n            config.viewProps.bindClassModifiers(this.element);\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(className$q('b'));\n            config.viewProps.bindDisabled(buttonElem);\n            this.element.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            const titleElem = doc.createElement('div');\n            titleElem.classList.add(className$q('t'));\n            bindValueToTextContent(config.props.value('title'), titleElem);\n            this.buttonElement.appendChild(titleElem);\n        }\n    }\n\n    class ButtonController {\n        constructor(doc, config) {\n            this.emitter = new Emitter();\n            this.onClick_ = this.onClick_.bind(this);\n            this.props = config.props;\n            this.viewProps = config.viewProps;\n            this.view = new ButtonView(doc, {\n                props: this.props,\n                viewProps: this.viewProps,\n            });\n            this.view.buttonElement.addEventListener('click', this.onClick_);\n        }\n        onClick_() {\n            this.emitter.emit('click', {\n                sender: this,\n            });\n        }\n    }\n\n    class BoundValue {\n        constructor(initialValue, config) {\n            var _a;\n            this.constraint_ = config === null || config === void 0 ? void 0 : config.constraint;\n            this.equals_ = (_a = config === null || config === void 0 ? void 0 : config.equals) !== null && _a !== void 0 ? _a : ((v1, v2) => v1 === v2);\n            this.emitter = new Emitter();\n            this.rawValue_ = initialValue;\n        }\n        get constraint() {\n            return this.constraint_;\n        }\n        get rawValue() {\n            return this.rawValue_;\n        }\n        set rawValue(rawValue) {\n            this.setRawValue(rawValue, {\n                forceEmit: false,\n                last: true,\n            });\n        }\n        setRawValue(rawValue, options) {\n            const opts = options !== null && options !== void 0 ? options : {\n                forceEmit: false,\n                last: true,\n            };\n            const constrainedValue = this.constraint_\n                ? this.constraint_.constrain(rawValue)\n                : rawValue;\n            const prevValue = this.rawValue_;\n            const changed = !this.equals_(prevValue, constrainedValue);\n            if (!changed && !opts.forceEmit) {\n                return;\n            }\n            this.emitter.emit('beforechange', {\n                sender: this,\n            });\n            this.rawValue_ = constrainedValue;\n            this.emitter.emit('change', {\n                options: opts,\n                previousRawValue: prevValue,\n                rawValue: constrainedValue,\n                sender: this,\n            });\n        }\n    }\n\n    class PrimitiveValue {\n        constructor(initialValue) {\n            this.emitter = new Emitter();\n            this.value_ = initialValue;\n        }\n        get rawValue() {\n            return this.value_;\n        }\n        set rawValue(value) {\n            this.setRawValue(value, {\n                forceEmit: false,\n                last: true,\n            });\n        }\n        setRawValue(value, options) {\n            const opts = options !== null && options !== void 0 ? options : {\n                forceEmit: false,\n                last: true,\n            };\n            const prevValue = this.value_;\n            if (prevValue === value && !opts.forceEmit) {\n                return;\n            }\n            this.emitter.emit('beforechange', {\n                sender: this,\n            });\n            this.value_ = value;\n            this.emitter.emit('change', {\n                options: opts,\n                previousRawValue: prevValue,\n                rawValue: this.value_,\n                sender: this,\n            });\n        }\n    }\n\n    function createValue(initialValue, config) {\n        const constraint = config === null || config === void 0 ? void 0 : config.constraint;\n        const equals = config === null || config === void 0 ? void 0 : config.equals;\n        if (!constraint && !equals) {\n            return new PrimitiveValue(initialValue);\n        }\n        return new BoundValue(initialValue, config);\n    }\n\n    class ValueMap {\n        constructor(valueMap) {\n            this.emitter = new Emitter();\n            this.valMap_ = valueMap;\n            for (const key in this.valMap_) {\n                const v = this.valMap_[key];\n                v.emitter.on('change', () => {\n                    this.emitter.emit('change', {\n                        key: key,\n                        sender: this,\n                    });\n                });\n            }\n        }\n        static createCore(initialValue) {\n            const keys = Object.keys(initialValue);\n            return keys.reduce((o, key) => {\n                return Object.assign(o, {\n                    [key]: createValue(initialValue[key]),\n                });\n            }, {});\n        }\n        static fromObject(initialValue) {\n            const core = this.createCore(initialValue);\n            return new ValueMap(core);\n        }\n        get(key) {\n            return this.valMap_[key].rawValue;\n        }\n        set(key, value) {\n            this.valMap_[key].rawValue = value;\n        }\n        value(key) {\n            return this.valMap_[key];\n        }\n    }\n\n    function parseObject(value, keyToParserMap) {\n        const keys = Object.keys(keyToParserMap);\n        const result = keys.reduce((tmp, key) => {\n            if (tmp === undefined) {\n                return undefined;\n            }\n            const parser = keyToParserMap[key];\n            const result = parser(value[key]);\n            return result.succeeded\n                ? Object.assign(Object.assign({}, tmp), { [key]: result.value }) : undefined;\n        }, {});\n        return forceCast(result);\n    }\n    function parseArray(value, parseItem) {\n        return value.reduce((tmp, item) => {\n            if (tmp === undefined) {\n                return undefined;\n            }\n            const result = parseItem(item);\n            if (!result.succeeded || result.value === undefined) {\n                return undefined;\n            }\n            return [...tmp, result.value];\n        }, []);\n    }\n    function isObject(value) {\n        if (value === null) {\n            return false;\n        }\n        return typeof value === 'object';\n    }\n    function createParamsParserBuilder(parse) {\n        return (optional) => (v) => {\n            if (!optional && v === undefined) {\n                return {\n                    succeeded: false,\n                    value: undefined,\n                };\n            }\n            if (optional && v === undefined) {\n                return {\n                    succeeded: true,\n                    value: undefined,\n                };\n            }\n            const result = parse(v);\n            return result !== undefined\n                ? {\n                    succeeded: true,\n                    value: result,\n                }\n                : {\n                    succeeded: false,\n                    value: undefined,\n                };\n        };\n    }\n    function createParamsParserBuilders(optional) {\n        return {\n            custom: (parse) => createParamsParserBuilder(parse)(optional),\n            boolean: createParamsParserBuilder((v) => typeof v === 'boolean' ? v : undefined)(optional),\n            number: createParamsParserBuilder((v) => typeof v === 'number' ? v : undefined)(optional),\n            string: createParamsParserBuilder((v) => typeof v === 'string' ? v : undefined)(optional),\n            function: createParamsParserBuilder((v) =>\n            typeof v === 'function' ? v : undefined)(optional),\n            constant: (value) => createParamsParserBuilder((v) => (v === value ? value : undefined))(optional),\n            raw: createParamsParserBuilder((v) => v)(optional),\n            object: (keyToParserMap) => createParamsParserBuilder((v) => {\n                if (!isObject(v)) {\n                    return undefined;\n                }\n                return parseObject(v, keyToParserMap);\n            })(optional),\n            array: (itemParser) => createParamsParserBuilder((v) => {\n                if (!Array.isArray(v)) {\n                    return undefined;\n                }\n                return parseArray(v, itemParser);\n            })(optional),\n        };\n    }\n    const ParamsParsers = {\n        optional: createParamsParserBuilders(true),\n        required: createParamsParserBuilders(false),\n    };\n    function parseParams(value, keyToParserMap) {\n        const result = ParamsParsers.required.object(keyToParserMap)(value);\n        return result.succeeded ? result.value : undefined;\n    }\n\n    function warnMissing(info) {\n        console.warn([\n            `Missing '${info.key}' of ${info.target} in ${info.place}.`,\n            'Please rebuild plugins with the latest core package.',\n        ].join(' '));\n    }\n\n    function disposeElement(elem) {\n        if (elem && elem.parentElement) {\n            elem.parentElement.removeChild(elem);\n        }\n        return null;\n    }\n\n    class ReadonlyValue {\n        constructor(value) {\n            this.value_ = value;\n        }\n        static create(value) {\n            return [\n                new ReadonlyValue(value),\n                (rawValue, options) => {\n                    value.setRawValue(rawValue, options);\n                },\n            ];\n        }\n        get emitter() {\n            return this.value_.emitter;\n        }\n        get rawValue() {\n            return this.value_.rawValue;\n        }\n    }\n\n    const className$p = ClassName('');\n    function valueToModifier(elem, modifier) {\n        return valueToClassName(elem, className$p(undefined, modifier));\n    }\n    class ViewProps extends ValueMap {\n        constructor(valueMap) {\n            var _a;\n            super(valueMap);\n            this.onDisabledChange_ = this.onDisabledChange_.bind(this);\n            this.onParentChange_ = this.onParentChange_.bind(this);\n            this.onParentGlobalDisabledChange_ =\n                this.onParentGlobalDisabledChange_.bind(this);\n            [this.globalDisabled_, this.setGlobalDisabled_] = ReadonlyValue.create(createValue(this.getGlobalDisabled_()));\n            this.value('disabled').emitter.on('change', this.onDisabledChange_);\n            this.value('parent').emitter.on('change', this.onParentChange_);\n            (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n        }\n        static create(opt_initialValue) {\n            var _a, _b, _c;\n            const initialValue = opt_initialValue !== null && opt_initialValue !== void 0 ? opt_initialValue : {};\n            return new ViewProps(ValueMap.createCore({\n                disabled: (_a = initialValue.disabled) !== null && _a !== void 0 ? _a : false,\n                disposed: false,\n                hidden: (_b = initialValue.hidden) !== null && _b !== void 0 ? _b : false,\n                parent: (_c = initialValue.parent) !== null && _c !== void 0 ? _c : null,\n            }));\n        }\n        get globalDisabled() {\n            return this.globalDisabled_;\n        }\n        bindClassModifiers(elem) {\n            bindValue(this.globalDisabled_, valueToModifier(elem, 'disabled'));\n            bindValueMap(this, 'hidden', valueToModifier(elem, 'hidden'));\n        }\n        bindDisabled(target) {\n            bindValue(this.globalDisabled_, (disabled) => {\n                target.disabled = disabled;\n            });\n        }\n        bindTabIndex(elem) {\n            bindValue(this.globalDisabled_, (disabled) => {\n                elem.tabIndex = disabled ? -1 : 0;\n            });\n        }\n        handleDispose(callback) {\n            this.value('disposed').emitter.on('change', (disposed) => {\n                if (disposed) {\n                    callback();\n                }\n            });\n        }\n        getGlobalDisabled_() {\n            const parent = this.get('parent');\n            const parentDisabled = parent ? parent.globalDisabled.rawValue : false;\n            return parentDisabled || this.get('disabled');\n        }\n        updateGlobalDisabled_() {\n            this.setGlobalDisabled_(this.getGlobalDisabled_());\n        }\n        onDisabledChange_() {\n            this.updateGlobalDisabled_();\n        }\n        onParentGlobalDisabledChange_() {\n            this.updateGlobalDisabled_();\n        }\n        onParentChange_(ev) {\n            var _a;\n            const prevParent = ev.previousRawValue;\n            prevParent === null || prevParent === void 0 ? void 0 : prevParent.globalDisabled.emitter.off('change', this.onParentGlobalDisabledChange_);\n            (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n            this.updateGlobalDisabled_();\n        }\n    }\n\n    function getAllBladePositions() {\n        return ['veryfirst', 'first', 'last', 'verylast'];\n    }\n\n    const className$o = ClassName('');\n    const POS_TO_CLASS_NAME_MAP = {\n        veryfirst: 'vfst',\n        first: 'fst',\n        last: 'lst',\n        verylast: 'vlst',\n    };\n    class BladeController {\n        constructor(config) {\n            this.parent_ = null;\n            this.blade = config.blade;\n            this.view = config.view;\n            this.viewProps = config.viewProps;\n            const elem = this.view.element;\n            this.blade.value('positions').emitter.on('change', () => {\n                getAllBladePositions().forEach((pos) => {\n                    elem.classList.remove(className$o(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n                });\n                this.blade.get('positions').forEach((pos) => {\n                    elem.classList.add(className$o(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n                });\n            });\n            this.viewProps.handleDispose(() => {\n                disposeElement(elem);\n            });\n        }\n        get parent() {\n            return this.parent_;\n        }\n        set parent(parent) {\n            this.parent_ = parent;\n            if (!('parent' in this.viewProps.valMap_)) {\n                warnMissing({\n                    key: 'parent',\n                    target: ViewProps.name,\n                    place: 'BladeController.parent',\n                });\n                return;\n            }\n            this.viewProps.set('parent', this.parent_ ? this.parent_.viewProps : null);\n        }\n    }\n\n    const SVG_NS = 'http://www.w3.org/2000/svg';\n    function forceReflow(element) {\n        element.offsetHeight;\n    }\n    function disableTransitionTemporarily(element, callback) {\n        const t = element.style.transition;\n        element.style.transition = 'none';\n        callback();\n        element.style.transition = t;\n    }\n    function supportsTouch(doc) {\n        return doc.ontouchstart !== undefined;\n    }\n    function getGlobalObject() {\n        return globalThis;\n    }\n    function getWindowDocument() {\n        const globalObj = forceCast(getGlobalObject());\n        return globalObj.document;\n    }\n    function getCanvasContext(canvasElement) {\n        const win = canvasElement.ownerDocument.defaultView;\n        if (!win) {\n            return null;\n        }\n        const isBrowser = 'document' in win;\n        return isBrowser\n            ? canvasElement.getContext('2d', {\n                willReadFrequently: true,\n            })\n            : null;\n    }\n    const ICON_ID_TO_INNER_HTML_MAP = {\n        check: '<path d=\"M2 8l4 4l8 -8\"/>',\n        dropdown: '<path d=\"M5 7h6l-3 3 z\"/>',\n        p2dpad: '<path d=\"M8 4v8\"/><path d=\"M4 8h8\"/><circle cx=\"12\" cy=\"12\" r=\"1.2\"/>',\n    };\n    function createSvgIconElement(document, iconId) {\n        const elem = document.createElementNS(SVG_NS, 'svg');\n        elem.innerHTML = ICON_ID_TO_INNER_HTML_MAP[iconId];\n        return elem;\n    }\n    function insertElementAt(parentElement, element, index) {\n        parentElement.insertBefore(element, parentElement.children[index]);\n    }\n    function removeElement(element) {\n        if (element.parentElement) {\n            element.parentElement.removeChild(element);\n        }\n    }\n    function removeChildElements(element) {\n        while (element.children.length > 0) {\n            element.removeChild(element.children[0]);\n        }\n    }\n    function removeChildNodes(element) {\n        while (element.childNodes.length > 0) {\n            element.removeChild(element.childNodes[0]);\n        }\n    }\n    function findNextTarget(ev) {\n        if (ev.relatedTarget) {\n            return forceCast(ev.relatedTarget);\n        }\n        if ('explicitOriginalTarget' in ev) {\n            return ev.explicitOriginalTarget;\n        }\n        return null;\n    }\n\n    const className$n = ClassName('lbl');\n    function createLabelNode(doc, label) {\n        const frag = doc.createDocumentFragment();\n        const lineNodes = label.split('\\n').map((line) => {\n            return doc.createTextNode(line);\n        });\n        lineNodes.forEach((lineNode, index) => {\n            if (index > 0) {\n                frag.appendChild(doc.createElement('br'));\n            }\n            frag.appendChild(lineNode);\n        });\n        return frag;\n    }\n    class LabelView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$n());\n            config.viewProps.bindClassModifiers(this.element);\n            const labelElem = doc.createElement('div');\n            labelElem.classList.add(className$n('l'));\n            bindValueMap(config.props, 'label', (value) => {\n                if (isEmpty(value)) {\n                    this.element.classList.add(className$n(undefined, 'nol'));\n                }\n                else {\n                    this.element.classList.remove(className$n(undefined, 'nol'));\n                    removeChildNodes(labelElem);\n                    labelElem.appendChild(createLabelNode(doc, value));\n                }\n            });\n            this.element.appendChild(labelElem);\n            this.labelElement = labelElem;\n            const valueElem = doc.createElement('div');\n            valueElem.classList.add(className$n('v'));\n            this.element.appendChild(valueElem);\n            this.valueElement = valueElem;\n        }\n    }\n\n    class LabelController extends BladeController {\n        constructor(doc, config) {\n            const viewProps = config.valueController.viewProps;\n            super(Object.assign(Object.assign({}, config), { view: new LabelView(doc, {\n                    props: config.props,\n                    viewProps: viewProps,\n                }), viewProps: viewProps }));\n            this.props = config.props;\n            this.valueController = config.valueController;\n            this.view.valueElement.appendChild(this.valueController.view.element);\n        }\n    }\n\n    const ButtonBladePlugin = {\n        id: 'button',\n        type: 'blade',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                title: p.required.string,\n                view: p.required.constant('button'),\n                label: p.optional.string,\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            return new LabelController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                valueController: new ButtonController(args.document, {\n                    props: ValueMap.fromObject({\n                        title: args.params.title,\n                    }),\n                    viewProps: args.viewProps,\n                }),\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabelController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof ButtonController)) {\n                return null;\n            }\n            return new ButtonApi(args.controller);\n        },\n    };\n\n    class ValueBladeController extends BladeController {\n        constructor(config) {\n            super(config);\n            this.value = config.value;\n        }\n    }\n\n    function createBlade() {\n        return new ValueMap({\n            positions: createValue([], {\n                equals: deepEqualsArray,\n            }),\n        });\n    }\n\n    class Foldable extends ValueMap {\n        constructor(valueMap) {\n            super(valueMap);\n        }\n        static create(expanded) {\n            const coreObj = {\n                completed: true,\n                expanded: expanded,\n                expandedHeight: null,\n                shouldFixHeight: false,\n                temporaryExpanded: null,\n            };\n            const core = ValueMap.createCore(coreObj);\n            return new Foldable(core);\n        }\n        get styleExpanded() {\n            var _a;\n            return (_a = this.get('temporaryExpanded')) !== null && _a !== void 0 ? _a : this.get('expanded');\n        }\n        get styleHeight() {\n            if (!this.styleExpanded) {\n                return '0';\n            }\n            const exHeight = this.get('expandedHeight');\n            if (this.get('shouldFixHeight') && !isEmpty(exHeight)) {\n                return `${exHeight}px`;\n            }\n            return 'auto';\n        }\n        bindExpandedClass(elem, expandedClassName) {\n            const onExpand = () => {\n                const expanded = this.styleExpanded;\n                if (expanded) {\n                    elem.classList.add(expandedClassName);\n                }\n                else {\n                    elem.classList.remove(expandedClassName);\n                }\n            };\n            bindValueMap(this, 'expanded', onExpand);\n            bindValueMap(this, 'temporaryExpanded', onExpand);\n        }\n        cleanUpTransition() {\n            this.set('shouldFixHeight', false);\n            this.set('expandedHeight', null);\n            this.set('completed', true);\n        }\n    }\n    function computeExpandedFolderHeight(folder, containerElement) {\n        let height = 0;\n        disableTransitionTemporarily(containerElement, () => {\n            folder.set('expandedHeight', null);\n            folder.set('temporaryExpanded', true);\n            forceReflow(containerElement);\n            height = containerElement.clientHeight;\n            folder.set('temporaryExpanded', null);\n            forceReflow(containerElement);\n        });\n        return height;\n    }\n    function applyHeight(foldable, elem) {\n        elem.style.height = foldable.styleHeight;\n    }\n    function bindFoldable(foldable, elem) {\n        foldable.value('expanded').emitter.on('beforechange', () => {\n            foldable.set('completed', false);\n            if (isEmpty(foldable.get('expandedHeight'))) {\n                const h = computeExpandedFolderHeight(foldable, elem);\n                if (h > 0) {\n                    foldable.set('expandedHeight', h);\n                }\n            }\n            foldable.set('shouldFixHeight', true);\n            forceReflow(elem);\n        });\n        foldable.emitter.on('change', () => {\n            applyHeight(foldable, elem);\n        });\n        applyHeight(foldable, elem);\n        elem.addEventListener('transitionend', (ev) => {\n            if (ev.propertyName !== 'height') {\n                return;\n            }\n            foldable.cleanUpTransition();\n        });\n    }\n\n    class RackLikeApi extends BladeApi {\n        constructor(controller, rackApi) {\n            super(controller);\n            this.rackApi_ = rackApi;\n        }\n    }\n\n    function addButtonAsBlade(api, params) {\n        return api.addBlade(Object.assign(Object.assign({}, params), { view: 'button' }));\n    }\n    function addFolderAsBlade(api, params) {\n        return api.addBlade(Object.assign(Object.assign({}, params), { view: 'folder' }));\n    }\n    function addSeparatorAsBlade(api, opt_params) {\n        const params = opt_params !== null && opt_params !== void 0 ? opt_params : {};\n        return api.addBlade(Object.assign(Object.assign({}, params), { view: 'separator' }));\n    }\n    function addTabAsBlade(api, params) {\n        return api.addBlade(Object.assign(Object.assign({}, params), { view: 'tab' }));\n    }\n\n    class NestedOrderedSet {\n        constructor(extract) {\n            this.emitter = new Emitter();\n            this.items_ = [];\n            this.cache_ = new Set();\n            this.onSubListAdd_ = this.onSubListAdd_.bind(this);\n            this.onSubListRemove_ = this.onSubListRemove_.bind(this);\n            this.extract_ = extract;\n        }\n        get items() {\n            return this.items_;\n        }\n        allItems() {\n            return Array.from(this.cache_);\n        }\n        find(callback) {\n            for (const item of this.allItems()) {\n                if (callback(item)) {\n                    return item;\n                }\n            }\n            return null;\n        }\n        includes(item) {\n            return this.cache_.has(item);\n        }\n        add(item, opt_index) {\n            if (this.includes(item)) {\n                throw TpError.shouldNeverHappen();\n            }\n            const index = opt_index !== undefined ? opt_index : this.items_.length;\n            this.items_.splice(index, 0, item);\n            this.cache_.add(item);\n            const subList = this.extract_(item);\n            if (subList) {\n                subList.emitter.on('add', this.onSubListAdd_);\n                subList.emitter.on('remove', this.onSubListRemove_);\n                subList.allItems().forEach((item) => {\n                    this.cache_.add(item);\n                });\n            }\n            this.emitter.emit('add', {\n                index: index,\n                item: item,\n                root: this,\n                target: this,\n            });\n        }\n        remove(item) {\n            const index = this.items_.indexOf(item);\n            if (index < 0) {\n                return;\n            }\n            this.items_.splice(index, 1);\n            this.cache_.delete(item);\n            const subList = this.extract_(item);\n            if (subList) {\n                subList.emitter.off('add', this.onSubListAdd_);\n                subList.emitter.off('remove', this.onSubListRemove_);\n            }\n            this.emitter.emit('remove', {\n                index: index,\n                item: item,\n                root: this,\n                target: this,\n            });\n        }\n        onSubListAdd_(ev) {\n            this.cache_.add(ev.item);\n            this.emitter.emit('add', {\n                index: ev.index,\n                item: ev.item,\n                root: this,\n                target: ev.target,\n            });\n        }\n        onSubListRemove_(ev) {\n            this.cache_.delete(ev.item);\n            this.emitter.emit('remove', {\n                index: ev.index,\n                item: ev.item,\n                root: this,\n                target: ev.target,\n            });\n        }\n    }\n\n    class InputBindingApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.onBindingChange_ = this.onBindingChange_.bind(this);\n            this.emitter_ = new Emitter();\n            this.controller_.binding.emitter.on('change', this.onBindingChange_);\n        }\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n        refresh() {\n            this.controller_.binding.read();\n        }\n        onBindingChange_(ev) {\n            const value = ev.sender.target.read();\n            this.emitter_.emit('change', {\n                event: new TpChangeEvent(this, forceCast(value), this.controller_.binding.target.presetKey, ev.options.last),\n            });\n        }\n    }\n\n    class InputBindingController extends LabelController {\n        constructor(doc, config) {\n            super(doc, config);\n            this.binding = config.binding;\n        }\n    }\n\n    class MonitorBindingApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.onBindingUpdate_ = this.onBindingUpdate_.bind(this);\n            this.emitter_ = new Emitter();\n            this.controller_.binding.emitter.on('update', this.onBindingUpdate_);\n        }\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n        refresh() {\n            this.controller_.binding.read();\n        }\n        onBindingUpdate_(ev) {\n            const value = ev.sender.target.read();\n            this.emitter_.emit('update', {\n                event: new TpUpdateEvent(this, forceCast(value), this.controller_.binding.target.presetKey),\n            });\n        }\n    }\n\n    class MonitorBindingController extends LabelController {\n        constructor(doc, config) {\n            super(doc, config);\n            this.binding = config.binding;\n            this.viewProps.bindDisabled(this.binding.ticker);\n            this.viewProps.handleDispose(() => {\n                this.binding.dispose();\n            });\n        }\n    }\n\n    function findSubBladeApiSet(api) {\n        if (api instanceof RackApi) {\n            return api['apiSet_'];\n        }\n        if (api instanceof RackLikeApi) {\n            return api['rackApi_']['apiSet_'];\n        }\n        return null;\n    }\n    function getApiByController(apiSet, controller) {\n        const api = apiSet.find((api) => api.controller_ === controller);\n        if (!api) {\n            throw TpError.shouldNeverHappen();\n        }\n        return api;\n    }\n    function createBindingTarget(obj, key, opt_id) {\n        if (!BindingTarget.isBindable(obj)) {\n            throw TpError.notBindable();\n        }\n        return new BindingTarget(obj, key, opt_id);\n    }\n    class RackApi extends BladeApi {\n        constructor(controller, pool) {\n            super(controller);\n            this.onRackAdd_ = this.onRackAdd_.bind(this);\n            this.onRackRemove_ = this.onRackRemove_.bind(this);\n            this.onRackInputChange_ = this.onRackInputChange_.bind(this);\n            this.onRackMonitorUpdate_ = this.onRackMonitorUpdate_.bind(this);\n            this.emitter_ = new Emitter();\n            this.apiSet_ = new NestedOrderedSet(findSubBladeApiSet);\n            this.pool_ = pool;\n            const rack = this.controller_.rack;\n            rack.emitter.on('add', this.onRackAdd_);\n            rack.emitter.on('remove', this.onRackRemove_);\n            rack.emitter.on('inputchange', this.onRackInputChange_);\n            rack.emitter.on('monitorupdate', this.onRackMonitorUpdate_);\n            rack.children.forEach((bc) => {\n                this.setUpApi_(bc);\n            });\n        }\n        get children() {\n            return this.controller_.rack.children.map((bc) => getApiByController(this.apiSet_, bc));\n        }\n        addInput(object, key, opt_params) {\n            const params = opt_params !== null && opt_params !== void 0 ? opt_params : {};\n            const doc = this.controller_.view.element.ownerDocument;\n            const bc = this.pool_.createInput(doc, createBindingTarget(object, key, params.presetKey), params);\n            const api = new InputBindingApi(bc);\n            return this.add(api, params.index);\n        }\n        addMonitor(object, key, opt_params) {\n            const params = opt_params !== null && opt_params !== void 0 ? opt_params : {};\n            const doc = this.controller_.view.element.ownerDocument;\n            const bc = this.pool_.createMonitor(doc, createBindingTarget(object, key), params);\n            const api = new MonitorBindingApi(bc);\n            return forceCast(this.add(api, params.index));\n        }\n        addFolder(params) {\n            return addFolderAsBlade(this, params);\n        }\n        addButton(params) {\n            return addButtonAsBlade(this, params);\n        }\n        addSeparator(opt_params) {\n            return addSeparatorAsBlade(this, opt_params);\n        }\n        addTab(params) {\n            return addTabAsBlade(this, params);\n        }\n        add(api, opt_index) {\n            this.controller_.rack.add(api.controller_, opt_index);\n            const gapi = this.apiSet_.find((a) => a.controller_ === api.controller_);\n            if (gapi) {\n                this.apiSet_.remove(gapi);\n            }\n            this.apiSet_.add(api);\n            return api;\n        }\n        remove(api) {\n            this.controller_.rack.remove(api.controller_);\n        }\n        addBlade(params) {\n            const doc = this.controller_.view.element.ownerDocument;\n            const bc = this.pool_.createBlade(doc, params);\n            const api = this.pool_.createBladeApi(bc);\n            return this.add(api, params.index);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n        setUpApi_(bc) {\n            const api = this.apiSet_.find((api) => api.controller_ === bc);\n            if (!api) {\n                this.apiSet_.add(this.pool_.createBladeApi(bc));\n            }\n        }\n        onRackAdd_(ev) {\n            this.setUpApi_(ev.bladeController);\n        }\n        onRackRemove_(ev) {\n            if (ev.isRoot) {\n                const api = getApiByController(this.apiSet_, ev.bladeController);\n                this.apiSet_.remove(api);\n            }\n        }\n        onRackInputChange_(ev) {\n            const bc = ev.bladeController;\n            if (bc instanceof InputBindingController) {\n                const api = getApiByController(this.apiSet_, bc);\n                const binding = bc.binding;\n                this.emitter_.emit('change', {\n                    event: new TpChangeEvent(api, forceCast(binding.target.read()), binding.target.presetKey, ev.options.last),\n                });\n            }\n            else if (bc instanceof ValueBladeController) {\n                const api = getApiByController(this.apiSet_, bc);\n                this.emitter_.emit('change', {\n                    event: new TpChangeEvent(api, bc.value.rawValue, undefined, ev.options.last),\n                });\n            }\n        }\n        onRackMonitorUpdate_(ev) {\n            if (!(ev.bladeController instanceof MonitorBindingController)) {\n                throw TpError.shouldNeverHappen();\n            }\n            const api = getApiByController(this.apiSet_, ev.bladeController);\n            const binding = ev.bladeController.binding;\n            this.emitter_.emit('update', {\n                event: new TpUpdateEvent(api, forceCast(binding.target.read()), binding.target.presetKey),\n            });\n        }\n    }\n\n    class FolderApi extends RackLikeApi {\n        constructor(controller, pool) {\n            super(controller, new RackApi(controller.rackController, pool));\n            this.emitter_ = new Emitter();\n            this.controller_.foldable\n                .value('expanded')\n                .emitter.on('change', (ev) => {\n                this.emitter_.emit('fold', {\n                    event: new TpFoldEvent(this, ev.sender.rawValue),\n                });\n            });\n            this.rackApi_.on('change', (ev) => {\n                this.emitter_.emit('change', {\n                    event: ev,\n                });\n            });\n            this.rackApi_.on('update', (ev) => {\n                this.emitter_.emit('update', {\n                    event: ev,\n                });\n            });\n        }\n        get expanded() {\n            return this.controller_.foldable.get('expanded');\n        }\n        set expanded(expanded) {\n            this.controller_.foldable.set('expanded', expanded);\n        }\n        get title() {\n            return this.controller_.props.get('title');\n        }\n        set title(title) {\n            this.controller_.props.set('title', title);\n        }\n        get children() {\n            return this.rackApi_.children;\n        }\n        addInput(object, key, opt_params) {\n            return this.rackApi_.addInput(object, key, opt_params);\n        }\n        addMonitor(object, key, opt_params) {\n            return this.rackApi_.addMonitor(object, key, opt_params);\n        }\n        addFolder(params) {\n            return this.rackApi_.addFolder(params);\n        }\n        addButton(params) {\n            return this.rackApi_.addButton(params);\n        }\n        addSeparator(opt_params) {\n            return this.rackApi_.addSeparator(opt_params);\n        }\n        addTab(params) {\n            return this.rackApi_.addTab(params);\n        }\n        add(api, opt_index) {\n            return this.rackApi_.add(api, opt_index);\n        }\n        remove(api) {\n            this.rackApi_.remove(api);\n        }\n        addBlade(params) {\n            return this.rackApi_.addBlade(params);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n    }\n\n    class RackLikeController extends BladeController {\n        constructor(config) {\n            super({\n                blade: config.blade,\n                view: config.view,\n                viewProps: config.rackController.viewProps,\n            });\n            this.rackController = config.rackController;\n        }\n    }\n\n    class PlainView {\n        constructor(doc, config) {\n            const className = ClassName(config.viewName);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className());\n            config.viewProps.bindClassModifiers(this.element);\n        }\n    }\n\n    function findInputBindingController(bcs, b) {\n        for (let i = 0; i < bcs.length; i++) {\n            const bc = bcs[i];\n            if (bc instanceof InputBindingController && bc.binding === b) {\n                return bc;\n            }\n        }\n        return null;\n    }\n    function findMonitorBindingController(bcs, b) {\n        for (let i = 0; i < bcs.length; i++) {\n            const bc = bcs[i];\n            if (bc instanceof MonitorBindingController && bc.binding === b) {\n                return bc;\n            }\n        }\n        return null;\n    }\n    function findValueBladeController(bcs, v) {\n        for (let i = 0; i < bcs.length; i++) {\n            const bc = bcs[i];\n            if (bc instanceof ValueBladeController && bc.value === v) {\n                return bc;\n            }\n        }\n        return null;\n    }\n    function findSubRack(bc) {\n        if (bc instanceof RackController) {\n            return bc.rack;\n        }\n        if (bc instanceof RackLikeController) {\n            return bc.rackController.rack;\n        }\n        return null;\n    }\n    function findSubBladeControllerSet(bc) {\n        const rack = findSubRack(bc);\n        return rack ? rack['bcSet_'] : null;\n    }\n    class BladeRack {\n        constructor(config) {\n            var _a, _b;\n            this.onBladePositionsChange_ = this.onBladePositionsChange_.bind(this);\n            this.onSetAdd_ = this.onSetAdd_.bind(this);\n            this.onSetRemove_ = this.onSetRemove_.bind(this);\n            this.onChildDispose_ = this.onChildDispose_.bind(this);\n            this.onChildPositionsChange_ = this.onChildPositionsChange_.bind(this);\n            this.onChildInputChange_ = this.onChildInputChange_.bind(this);\n            this.onChildMonitorUpdate_ = this.onChildMonitorUpdate_.bind(this);\n            this.onChildValueChange_ = this.onChildValueChange_.bind(this);\n            this.onChildViewPropsChange_ = this.onChildViewPropsChange_.bind(this);\n            this.onDescendantLayout_ = this.onDescendantLayout_.bind(this);\n            this.onDescendantInputChange_ = this.onDescendantInputChange_.bind(this);\n            this.onDescendantMonitorUpdate_ =\n                this.onDescendantMonitorUpdate_.bind(this);\n            this.emitter = new Emitter();\n            this.blade_ = (_a = config.blade) !== null && _a !== void 0 ? _a : null;\n            (_b = this.blade_) === null || _b === void 0 ? void 0 : _b.value('positions').emitter.on('change', this.onBladePositionsChange_);\n            this.viewProps = config.viewProps;\n            this.bcSet_ = new NestedOrderedSet(findSubBladeControllerSet);\n            this.bcSet_.emitter.on('add', this.onSetAdd_);\n            this.bcSet_.emitter.on('remove', this.onSetRemove_);\n        }\n        get children() {\n            return this.bcSet_.items;\n        }\n        add(bc, opt_index) {\n            var _a;\n            (_a = bc.parent) === null || _a === void 0 ? void 0 : _a.remove(bc);\n            if (isPropertyWritable(bc, 'parent')) {\n                bc.parent = this;\n            }\n            else {\n                bc['parent_'] = this;\n                warnMissing({\n                    key: 'parent',\n                    target: 'BladeController',\n                    place: 'BladeRack.add',\n                });\n            }\n            this.bcSet_.add(bc, opt_index);\n        }\n        remove(bc) {\n            if (isPropertyWritable(bc, 'parent')) {\n                bc.parent = null;\n            }\n            else {\n                bc['parent_'] = null;\n                warnMissing({\n                    key: 'parent',\n                    target: 'BladeController',\n                    place: 'BladeRack.remove',\n                });\n            }\n            this.bcSet_.remove(bc);\n        }\n        find(controllerClass) {\n            return forceCast(this.bcSet_.allItems().filter((bc) => {\n                return bc instanceof controllerClass;\n            }));\n        }\n        onSetAdd_(ev) {\n            this.updatePositions_();\n            const isRoot = ev.target === ev.root;\n            this.emitter.emit('add', {\n                bladeController: ev.item,\n                index: ev.index,\n                isRoot: isRoot,\n                sender: this,\n            });\n            if (!isRoot) {\n                return;\n            }\n            const bc = ev.item;\n            bc.viewProps.emitter.on('change', this.onChildViewPropsChange_);\n            bc.blade\n                .value('positions')\n                .emitter.on('change', this.onChildPositionsChange_);\n            bc.viewProps.handleDispose(this.onChildDispose_);\n            if (bc instanceof InputBindingController) {\n                bc.binding.emitter.on('change', this.onChildInputChange_);\n            }\n            else if (bc instanceof MonitorBindingController) {\n                bc.binding.emitter.on('update', this.onChildMonitorUpdate_);\n            }\n            else if (bc instanceof ValueBladeController) {\n                bc.value.emitter.on('change', this.onChildValueChange_);\n            }\n            else {\n                const rack = findSubRack(bc);\n                if (rack) {\n                    const emitter = rack.emitter;\n                    emitter.on('layout', this.onDescendantLayout_);\n                    emitter.on('inputchange', this.onDescendantInputChange_);\n                    emitter.on('monitorupdate', this.onDescendantMonitorUpdate_);\n                }\n            }\n        }\n        onSetRemove_(ev) {\n            this.updatePositions_();\n            const isRoot = ev.target === ev.root;\n            this.emitter.emit('remove', {\n                bladeController: ev.item,\n                isRoot: isRoot,\n                sender: this,\n            });\n            if (!isRoot) {\n                return;\n            }\n            const bc = ev.item;\n            if (bc instanceof InputBindingController) {\n                bc.binding.emitter.off('change', this.onChildInputChange_);\n            }\n            else if (bc instanceof MonitorBindingController) {\n                bc.binding.emitter.off('update', this.onChildMonitorUpdate_);\n            }\n            else if (bc instanceof ValueBladeController) {\n                bc.value.emitter.off('change', this.onChildValueChange_);\n            }\n            else {\n                const rack = findSubRack(bc);\n                if (rack) {\n                    const emitter = rack.emitter;\n                    emitter.off('layout', this.onDescendantLayout_);\n                    emitter.off('inputchange', this.onDescendantInputChange_);\n                    emitter.off('monitorupdate', this.onDescendantMonitorUpdate_);\n                }\n            }\n        }\n        updatePositions_() {\n            const visibleItems = this.bcSet_.items.filter((bc) => !bc.viewProps.get('hidden'));\n            const firstVisibleItem = visibleItems[0];\n            const lastVisibleItem = visibleItems[visibleItems.length - 1];\n            this.bcSet_.items.forEach((bc) => {\n                const ps = [];\n                if (bc === firstVisibleItem) {\n                    ps.push('first');\n                    if (!this.blade_ ||\n                        this.blade_.get('positions').includes('veryfirst')) {\n                        ps.push('veryfirst');\n                    }\n                }\n                if (bc === lastVisibleItem) {\n                    ps.push('last');\n                    if (!this.blade_ || this.blade_.get('positions').includes('verylast')) {\n                        ps.push('verylast');\n                    }\n                }\n                bc.blade.set('positions', ps);\n            });\n        }\n        onChildPositionsChange_() {\n            this.updatePositions_();\n            this.emitter.emit('layout', {\n                sender: this,\n            });\n        }\n        onChildViewPropsChange_(_ev) {\n            this.updatePositions_();\n            this.emitter.emit('layout', {\n                sender: this,\n            });\n        }\n        onChildDispose_() {\n            const disposedUcs = this.bcSet_.items.filter((bc) => {\n                return bc.viewProps.get('disposed');\n            });\n            disposedUcs.forEach((bc) => {\n                this.bcSet_.remove(bc);\n            });\n        }\n        onChildInputChange_(ev) {\n            const bc = findInputBindingController(this.find(InputBindingController), ev.sender);\n            if (!bc) {\n                throw TpError.alreadyDisposed();\n            }\n            this.emitter.emit('inputchange', {\n                bladeController: bc,\n                options: ev.options,\n                sender: this,\n            });\n        }\n        onChildMonitorUpdate_(ev) {\n            const bc = findMonitorBindingController(this.find(MonitorBindingController), ev.sender);\n            if (!bc) {\n                throw TpError.alreadyDisposed();\n            }\n            this.emitter.emit('monitorupdate', {\n                bladeController: bc,\n                sender: this,\n            });\n        }\n        onChildValueChange_(ev) {\n            const bc = findValueBladeController(this.find(ValueBladeController), ev.sender);\n            if (!bc) {\n                throw TpError.alreadyDisposed();\n            }\n            this.emitter.emit('inputchange', {\n                bladeController: bc,\n                options: ev.options,\n                sender: this,\n            });\n        }\n        onDescendantLayout_(_) {\n            this.updatePositions_();\n            this.emitter.emit('layout', {\n                sender: this,\n            });\n        }\n        onDescendantInputChange_(ev) {\n            this.emitter.emit('inputchange', {\n                bladeController: ev.bladeController,\n                options: ev.options,\n                sender: this,\n            });\n        }\n        onDescendantMonitorUpdate_(ev) {\n            this.emitter.emit('monitorupdate', {\n                bladeController: ev.bladeController,\n                sender: this,\n            });\n        }\n        onBladePositionsChange_() {\n            this.updatePositions_();\n        }\n    }\n\n    class RackController extends BladeController {\n        constructor(doc, config) {\n            super(Object.assign(Object.assign({}, config), { view: new PlainView(doc, {\n                    viewName: 'brk',\n                    viewProps: config.viewProps,\n                }) }));\n            this.onRackAdd_ = this.onRackAdd_.bind(this);\n            this.onRackRemove_ = this.onRackRemove_.bind(this);\n            const rack = new BladeRack({\n                blade: config.root ? undefined : config.blade,\n                viewProps: config.viewProps,\n            });\n            rack.emitter.on('add', this.onRackAdd_);\n            rack.emitter.on('remove', this.onRackRemove_);\n            this.rack = rack;\n            this.viewProps.handleDispose(() => {\n                for (let i = this.rack.children.length - 1; i >= 0; i--) {\n                    const bc = this.rack.children[i];\n                    bc.viewProps.set('disposed', true);\n                }\n            });\n        }\n        onRackAdd_(ev) {\n            if (!ev.isRoot) {\n                return;\n            }\n            insertElementAt(this.view.element, ev.bladeController.view.element, ev.index);\n        }\n        onRackRemove_(ev) {\n            if (!ev.isRoot) {\n                return;\n            }\n            removeElement(ev.bladeController.view.element);\n        }\n    }\n\n    const bladeContainerClassName = ClassName('cnt');\n\n    class FolderView {\n        constructor(doc, config) {\n            var _a;\n            this.className_ = ClassName((_a = config.viewName) !== null && _a !== void 0 ? _a : 'fld');\n            this.element = doc.createElement('div');\n            this.element.classList.add(this.className_(), bladeContainerClassName());\n            config.viewProps.bindClassModifiers(this.element);\n            this.foldable_ = config.foldable;\n            this.foldable_.bindExpandedClass(this.element, this.className_(undefined, 'expanded'));\n            bindValueMap(this.foldable_, 'completed', valueToClassName(this.element, this.className_(undefined, 'cpl')));\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(this.className_('b'));\n            bindValueMap(config.props, 'title', (title) => {\n                if (isEmpty(title)) {\n                    this.element.classList.add(this.className_(undefined, 'not'));\n                }\n                else {\n                    this.element.classList.remove(this.className_(undefined, 'not'));\n                }\n            });\n            config.viewProps.bindDisabled(buttonElem);\n            this.element.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            const indentElem = doc.createElement('div');\n            indentElem.classList.add(this.className_('i'));\n            this.element.appendChild(indentElem);\n            const titleElem = doc.createElement('div');\n            titleElem.classList.add(this.className_('t'));\n            bindValueToTextContent(config.props.value('title'), titleElem);\n            this.buttonElement.appendChild(titleElem);\n            this.titleElement = titleElem;\n            const markElem = doc.createElement('div');\n            markElem.classList.add(this.className_('m'));\n            this.buttonElement.appendChild(markElem);\n            const containerElem = config.containerElement;\n            containerElem.classList.add(this.className_('c'));\n            this.element.appendChild(containerElem);\n            this.containerElement = containerElem;\n        }\n    }\n\n    class FolderController extends RackLikeController {\n        constructor(doc, config) {\n            var _a;\n            const foldable = Foldable.create((_a = config.expanded) !== null && _a !== void 0 ? _a : true);\n            const rc = new RackController(doc, {\n                blade: config.blade,\n                root: config.root,\n                viewProps: config.viewProps,\n            });\n            super(Object.assign(Object.assign({}, config), { rackController: rc, view: new FolderView(doc, {\n                    containerElement: rc.view.element,\n                    foldable: foldable,\n                    props: config.props,\n                    viewName: config.root ? 'rot' : undefined,\n                    viewProps: config.viewProps,\n                }) }));\n            this.onTitleClick_ = this.onTitleClick_.bind(this);\n            this.props = config.props;\n            this.foldable = foldable;\n            bindFoldable(this.foldable, this.view.containerElement);\n            this.rackController.rack.emitter.on('add', () => {\n                this.foldable.cleanUpTransition();\n            });\n            this.rackController.rack.emitter.on('remove', () => {\n                this.foldable.cleanUpTransition();\n            });\n            this.view.buttonElement.addEventListener('click', this.onTitleClick_);\n        }\n        get document() {\n            return this.view.element.ownerDocument;\n        }\n        onTitleClick_() {\n            this.foldable.set('expanded', !this.foldable.get('expanded'));\n        }\n    }\n\n    const FolderBladePlugin = {\n        id: 'folder',\n        type: 'blade',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                title: p.required.string,\n                view: p.required.constant('folder'),\n                expanded: p.optional.boolean,\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            return new FolderController(args.document, {\n                blade: args.blade,\n                expanded: args.params.expanded,\n                props: ValueMap.fromObject({\n                    title: args.params.title,\n                }),\n                viewProps: args.viewProps,\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof FolderController)) {\n                return null;\n            }\n            return new FolderApi(args.controller, args.pool);\n        },\n    };\n\n    class LabeledValueController extends ValueBladeController {\n        constructor(doc, config) {\n            const viewProps = config.valueController.viewProps;\n            super(Object.assign(Object.assign({}, config), { value: config.valueController.value, view: new LabelView(doc, {\n                    props: config.props,\n                    viewProps: viewProps,\n                }), viewProps: viewProps }));\n            this.props = config.props;\n            this.valueController = config.valueController;\n            this.view.valueElement.appendChild(this.valueController.view.element);\n        }\n    }\n\n    class SeparatorApi extends BladeApi {\n    }\n\n    const className$m = ClassName('spr');\n    class SeparatorView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$m());\n            config.viewProps.bindClassModifiers(this.element);\n            const hrElem = doc.createElement('hr');\n            hrElem.classList.add(className$m('r'));\n            this.element.appendChild(hrElem);\n        }\n    }\n\n    class SeparatorController extends BladeController {\n        constructor(doc, config) {\n            super(Object.assign(Object.assign({}, config), { view: new SeparatorView(doc, {\n                    viewProps: config.viewProps,\n                }) }));\n        }\n    }\n\n    const SeparatorBladePlugin = {\n        id: 'separator',\n        type: 'blade',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                view: p.required.constant('separator'),\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            return new SeparatorController(args.document, {\n                blade: args.blade,\n                viewProps: args.viewProps,\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof SeparatorController)) {\n                return null;\n            }\n            return new SeparatorApi(args.controller);\n        },\n    };\n\n    const className$l = ClassName('tbi');\n    class TabItemView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$l());\n            config.viewProps.bindClassModifiers(this.element);\n            bindValueMap(config.props, 'selected', (selected) => {\n                if (selected) {\n                    this.element.classList.add(className$l(undefined, 'sel'));\n                }\n                else {\n                    this.element.classList.remove(className$l(undefined, 'sel'));\n                }\n            });\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(className$l('b'));\n            config.viewProps.bindDisabled(buttonElem);\n            this.element.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            const titleElem = doc.createElement('div');\n            titleElem.classList.add(className$l('t'));\n            bindValueToTextContent(config.props.value('title'), titleElem);\n            this.buttonElement.appendChild(titleElem);\n            this.titleElement = titleElem;\n        }\n    }\n\n    class TabItemController {\n        constructor(doc, config) {\n            this.emitter = new Emitter();\n            this.onClick_ = this.onClick_.bind(this);\n            this.props = config.props;\n            this.viewProps = config.viewProps;\n            this.view = new TabItemView(doc, {\n                props: config.props,\n                viewProps: config.viewProps,\n            });\n            this.view.buttonElement.addEventListener('click', this.onClick_);\n        }\n        onClick_() {\n            this.emitter.emit('click', {\n                sender: this,\n            });\n        }\n    }\n\n    class TabPageController {\n        constructor(doc, config) {\n            this.onItemClick_ = this.onItemClick_.bind(this);\n            this.ic_ = new TabItemController(doc, {\n                props: config.itemProps,\n                viewProps: ViewProps.create(),\n            });\n            this.ic_.emitter.on('click', this.onItemClick_);\n            this.cc_ = new RackController(doc, {\n                blade: createBlade(),\n                viewProps: ViewProps.create(),\n            });\n            this.props = config.props;\n            bindValueMap(this.props, 'selected', (selected) => {\n                this.itemController.props.set('selected', selected);\n                this.contentController.viewProps.set('hidden', !selected);\n            });\n        }\n        get itemController() {\n            return this.ic_;\n        }\n        get contentController() {\n            return this.cc_;\n        }\n        onItemClick_() {\n            this.props.set('selected', true);\n        }\n    }\n\n    class TabPageApi {\n        constructor(controller, contentRackApi) {\n            this.controller_ = controller;\n            this.rackApi_ = contentRackApi;\n        }\n        get title() {\n            var _a;\n            return (_a = this.controller_.itemController.props.get('title')) !== null && _a !== void 0 ? _a : '';\n        }\n        set title(title) {\n            this.controller_.itemController.props.set('title', title);\n        }\n        get selected() {\n            return this.controller_.props.get('selected');\n        }\n        set selected(selected) {\n            this.controller_.props.set('selected', selected);\n        }\n        get children() {\n            return this.rackApi_.children;\n        }\n        addButton(params) {\n            return this.rackApi_.addButton(params);\n        }\n        addFolder(params) {\n            return this.rackApi_.addFolder(params);\n        }\n        addSeparator(opt_params) {\n            return this.rackApi_.addSeparator(opt_params);\n        }\n        addTab(params) {\n            return this.rackApi_.addTab(params);\n        }\n        add(api, opt_index) {\n            this.rackApi_.add(api, opt_index);\n        }\n        remove(api) {\n            this.rackApi_.remove(api);\n        }\n        addInput(object, key, opt_params) {\n            return this.rackApi_.addInput(object, key, opt_params);\n        }\n        addMonitor(object, key, opt_params) {\n            return this.rackApi_.addMonitor(object, key, opt_params);\n        }\n        addBlade(params) {\n            return this.rackApi_.addBlade(params);\n        }\n    }\n\n    class TabApi extends RackLikeApi {\n        constructor(controller, pool) {\n            super(controller, new RackApi(controller.rackController, pool));\n            this.onPageAdd_ = this.onPageAdd_.bind(this);\n            this.onPageRemove_ = this.onPageRemove_.bind(this);\n            this.onSelect_ = this.onSelect_.bind(this);\n            this.emitter_ = new Emitter();\n            this.pageApiMap_ = new Map();\n            this.rackApi_.on('change', (ev) => {\n                this.emitter_.emit('change', {\n                    event: ev,\n                });\n            });\n            this.rackApi_.on('update', (ev) => {\n                this.emitter_.emit('update', {\n                    event: ev,\n                });\n            });\n            this.controller_.tab.selectedIndex.emitter.on('change', this.onSelect_);\n            this.controller_.pageSet.emitter.on('add', this.onPageAdd_);\n            this.controller_.pageSet.emitter.on('remove', this.onPageRemove_);\n            this.controller_.pageSet.items.forEach((pc) => {\n                this.setUpPageApi_(pc);\n            });\n        }\n        get pages() {\n            return this.controller_.pageSet.items.map((pc) => {\n                const api = this.pageApiMap_.get(pc);\n                if (!api) {\n                    throw TpError.shouldNeverHappen();\n                }\n                return api;\n            });\n        }\n        addPage(params) {\n            const doc = this.controller_.view.element.ownerDocument;\n            const pc = new TabPageController(doc, {\n                itemProps: ValueMap.fromObject({\n                    selected: false,\n                    title: params.title,\n                }),\n                props: ValueMap.fromObject({\n                    selected: false,\n                }),\n            });\n            this.controller_.add(pc, params.index);\n            const api = this.pageApiMap_.get(pc);\n            if (!api) {\n                throw TpError.shouldNeverHappen();\n            }\n            return api;\n        }\n        removePage(index) {\n            this.controller_.remove(index);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n        setUpPageApi_(pc) {\n            const rackApi = this.rackApi_['apiSet_'].find((api) => api.controller_ === pc.contentController);\n            if (!rackApi) {\n                throw TpError.shouldNeverHappen();\n            }\n            const api = new TabPageApi(pc, rackApi);\n            this.pageApiMap_.set(pc, api);\n        }\n        onPageAdd_(ev) {\n            this.setUpPageApi_(ev.item);\n        }\n        onPageRemove_(ev) {\n            const api = this.pageApiMap_.get(ev.item);\n            if (!api) {\n                throw TpError.shouldNeverHappen();\n            }\n            this.pageApiMap_.delete(ev.item);\n        }\n        onSelect_(ev) {\n            this.emitter_.emit('select', {\n                event: new TpTabSelectEvent(this, ev.rawValue),\n            });\n        }\n    }\n\n    const INDEX_NOT_SELECTED = -1;\n    class Tab {\n        constructor() {\n            this.onItemSelectedChange_ = this.onItemSelectedChange_.bind(this);\n            this.empty = createValue(true);\n            this.selectedIndex = createValue(INDEX_NOT_SELECTED);\n            this.items_ = [];\n        }\n        add(item, opt_index) {\n            const index = opt_index !== null && opt_index !== void 0 ? opt_index : this.items_.length;\n            this.items_.splice(index, 0, item);\n            item.emitter.on('change', this.onItemSelectedChange_);\n            this.keepSelection_();\n        }\n        remove(item) {\n            const index = this.items_.indexOf(item);\n            if (index < 0) {\n                return;\n            }\n            this.items_.splice(index, 1);\n            item.emitter.off('change', this.onItemSelectedChange_);\n            this.keepSelection_();\n        }\n        keepSelection_() {\n            if (this.items_.length === 0) {\n                this.selectedIndex.rawValue = INDEX_NOT_SELECTED;\n                this.empty.rawValue = true;\n                return;\n            }\n            const firstSelIndex = this.items_.findIndex((s) => s.rawValue);\n            if (firstSelIndex < 0) {\n                this.items_.forEach((s, i) => {\n                    s.rawValue = i === 0;\n                });\n                this.selectedIndex.rawValue = 0;\n            }\n            else {\n                this.items_.forEach((s, i) => {\n                    s.rawValue = i === firstSelIndex;\n                });\n                this.selectedIndex.rawValue = firstSelIndex;\n            }\n            this.empty.rawValue = false;\n        }\n        onItemSelectedChange_(ev) {\n            if (ev.rawValue) {\n                const index = this.items_.findIndex((s) => s === ev.sender);\n                this.items_.forEach((s, i) => {\n                    s.rawValue = i === index;\n                });\n                this.selectedIndex.rawValue = index;\n            }\n            else {\n                this.keepSelection_();\n            }\n        }\n    }\n\n    const className$k = ClassName('tab');\n    class TabView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$k(), bladeContainerClassName());\n            config.viewProps.bindClassModifiers(this.element);\n            bindValue(config.empty, valueToClassName(this.element, className$k(undefined, 'nop')));\n            const titleElem = doc.createElement('div');\n            titleElem.classList.add(className$k('t'));\n            this.element.appendChild(titleElem);\n            this.itemsElement = titleElem;\n            const indentElem = doc.createElement('div');\n            indentElem.classList.add(className$k('i'));\n            this.element.appendChild(indentElem);\n            const contentsElem = config.contentsElement;\n            contentsElem.classList.add(className$k('c'));\n            this.element.appendChild(contentsElem);\n            this.contentsElement = contentsElem;\n        }\n    }\n\n    class TabController extends RackLikeController {\n        constructor(doc, config) {\n            const cr = new RackController(doc, {\n                blade: config.blade,\n                viewProps: config.viewProps,\n            });\n            const tab = new Tab();\n            super({\n                blade: config.blade,\n                rackController: cr,\n                view: new TabView(doc, {\n                    contentsElement: cr.view.element,\n                    empty: tab.empty,\n                    viewProps: config.viewProps,\n                }),\n            });\n            this.onPageAdd_ = this.onPageAdd_.bind(this);\n            this.onPageRemove_ = this.onPageRemove_.bind(this);\n            this.pageSet_ = new NestedOrderedSet(() => null);\n            this.pageSet_.emitter.on('add', this.onPageAdd_);\n            this.pageSet_.emitter.on('remove', this.onPageRemove_);\n            this.tab = tab;\n        }\n        get pageSet() {\n            return this.pageSet_;\n        }\n        add(pc, opt_index) {\n            this.pageSet_.add(pc, opt_index);\n        }\n        remove(index) {\n            this.pageSet_.remove(this.pageSet_.items[index]);\n        }\n        onPageAdd_(ev) {\n            const pc = ev.item;\n            insertElementAt(this.view.itemsElement, pc.itemController.view.element, ev.index);\n            pc.itemController.viewProps.set('parent', this.viewProps);\n            this.rackController.rack.add(pc.contentController, ev.index);\n            this.tab.add(pc.props.value('selected'));\n        }\n        onPageRemove_(ev) {\n            const pc = ev.item;\n            removeElement(pc.itemController.view.element);\n            pc.itemController.viewProps.set('parent', null);\n            this.rackController.rack.remove(pc.contentController);\n            this.tab.remove(pc.props.value('selected'));\n        }\n    }\n\n    const TabBladePlugin = {\n        id: 'tab',\n        type: 'blade',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                pages: p.required.array(p.required.object({ title: p.required.string })),\n                view: p.required.constant('tab'),\n            });\n            if (!result || result.pages.length === 0) {\n                return null;\n            }\n            return { params: result };\n        },\n        controller(args) {\n            const c = new TabController(args.document, {\n                blade: args.blade,\n                viewProps: args.viewProps,\n            });\n            args.params.pages.forEach((p) => {\n                const pc = new TabPageController(args.document, {\n                    itemProps: ValueMap.fromObject({\n                        selected: false,\n                        title: p.title,\n                    }),\n                    props: ValueMap.fromObject({\n                        selected: false,\n                    }),\n                });\n                c.add(pc);\n            });\n            return c;\n        },\n        api(args) {\n            if (!(args.controller instanceof TabController)) {\n                return null;\n            }\n            return new TabApi(args.controller, args.pool);\n        },\n    };\n\n    function createBladeController(plugin, args) {\n        const ac = plugin.accept(args.params);\n        if (!ac) {\n            return null;\n        }\n        const disabled = ParamsParsers.optional.boolean(args.params['disabled']).value;\n        const hidden = ParamsParsers.optional.boolean(args.params['hidden']).value;\n        return plugin.controller({\n            blade: createBlade(),\n            document: args.document,\n            params: forceCast(Object.assign(Object.assign({}, ac.params), { disabled: disabled, hidden: hidden })),\n            viewProps: ViewProps.create({\n                disabled: disabled,\n                hidden: hidden,\n            }),\n        });\n    }\n\n    class ManualTicker {\n        constructor() {\n            this.disabled = false;\n            this.emitter = new Emitter();\n        }\n        dispose() { }\n        tick() {\n            if (this.disabled) {\n                return;\n            }\n            this.emitter.emit('tick', {\n                sender: this,\n            });\n        }\n    }\n\n    class IntervalTicker {\n        constructor(doc, interval) {\n            this.disabled_ = false;\n            this.timerId_ = null;\n            this.onTick_ = this.onTick_.bind(this);\n            this.doc_ = doc;\n            this.emitter = new Emitter();\n            this.interval_ = interval;\n            this.setTimer_();\n        }\n        get disabled() {\n            return this.disabled_;\n        }\n        set disabled(inactive) {\n            this.disabled_ = inactive;\n            if (this.disabled_) {\n                this.clearTimer_();\n            }\n            else {\n                this.setTimer_();\n            }\n        }\n        dispose() {\n            this.clearTimer_();\n        }\n        clearTimer_() {\n            if (this.timerId_ === null) {\n                return;\n            }\n            const win = this.doc_.defaultView;\n            if (win) {\n                win.clearInterval(this.timerId_);\n            }\n            this.timerId_ = null;\n        }\n        setTimer_() {\n            this.clearTimer_();\n            if (this.interval_ <= 0) {\n                return;\n            }\n            const win = this.doc_.defaultView;\n            if (win) {\n                this.timerId_ = win.setInterval(this.onTick_, this.interval_);\n            }\n        }\n        onTick_() {\n            if (this.disabled_) {\n                return;\n            }\n            this.emitter.emit('tick', {\n                sender: this,\n            });\n        }\n    }\n\n    class InputBinding {\n        constructor(config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.reader = config.reader;\n            this.writer = config.writer;\n            this.emitter = new Emitter();\n            this.value = config.value;\n            this.value.emitter.on('change', this.onValueChange_);\n            this.target = config.target;\n            this.read();\n        }\n        read() {\n            const targetValue = this.target.read();\n            if (targetValue !== undefined) {\n                this.value.rawValue = this.reader(targetValue);\n            }\n        }\n        write_(rawValue) {\n            this.writer(this.target, rawValue);\n        }\n        onValueChange_(ev) {\n            this.write_(ev.rawValue);\n            this.emitter.emit('change', {\n                options: ev.options,\n                rawValue: ev.rawValue,\n                sender: this,\n            });\n        }\n    }\n\n    function fillBuffer(buffer, bufferSize) {\n        while (buffer.length < bufferSize) {\n            buffer.push(undefined);\n        }\n    }\n    function initializeBuffer(bufferSize) {\n        const buffer = [];\n        fillBuffer(buffer, bufferSize);\n        return createValue(buffer);\n    }\n    function createTrimmedBuffer(buffer) {\n        const index = buffer.indexOf(undefined);\n        return forceCast(index < 0 ? buffer : buffer.slice(0, index));\n    }\n    function createPushedBuffer(buffer, newValue) {\n        const newBuffer = [...createTrimmedBuffer(buffer), newValue];\n        if (newBuffer.length > buffer.length) {\n            newBuffer.splice(0, newBuffer.length - buffer.length);\n        }\n        else {\n            fillBuffer(newBuffer, buffer.length);\n        }\n        return newBuffer;\n    }\n\n    class MonitorBinding {\n        constructor(config) {\n            this.onTick_ = this.onTick_.bind(this);\n            this.reader_ = config.reader;\n            this.target = config.target;\n            this.emitter = new Emitter();\n            this.value = config.value;\n            this.ticker = config.ticker;\n            this.ticker.emitter.on('tick', this.onTick_);\n            this.read();\n        }\n        dispose() {\n            this.ticker.dispose();\n        }\n        read() {\n            const targetValue = this.target.read();\n            if (targetValue === undefined) {\n                return;\n            }\n            const buffer = this.value.rawValue;\n            const newValue = this.reader_(targetValue);\n            this.value.rawValue = createPushedBuffer(buffer, newValue);\n            this.emitter.emit('update', {\n                rawValue: newValue,\n                sender: this,\n            });\n        }\n        onTick_(_) {\n            this.read();\n        }\n    }\n\n    class CompositeConstraint {\n        constructor(constraints) {\n            this.constraints = constraints;\n        }\n        constrain(value) {\n            return this.constraints.reduce((result, c) => {\n                return c.constrain(result);\n            }, value);\n        }\n    }\n    function findConstraint(c, constraintClass) {\n        if (c instanceof constraintClass) {\n            return c;\n        }\n        if (c instanceof CompositeConstraint) {\n            const result = c.constraints.reduce((tmpResult, sc) => {\n                if (tmpResult) {\n                    return tmpResult;\n                }\n                return sc instanceof constraintClass ? sc : null;\n            }, null);\n            if (result) {\n                return result;\n            }\n        }\n        return null;\n    }\n\n    class DefiniteRangeConstraint {\n        constructor(config) {\n            this.values = ValueMap.fromObject({\n                max: config.max,\n                min: config.min,\n            });\n        }\n        constrain(value) {\n            const max = this.values.get('max');\n            const min = this.values.get('min');\n            return Math.min(Math.max(value, min), max);\n        }\n    }\n\n    class ListConstraint {\n        constructor(options) {\n            this.values = ValueMap.fromObject({\n                options: options,\n            });\n        }\n        get options() {\n            return this.values.get('options');\n        }\n        constrain(value) {\n            const opts = this.values.get('options');\n            if (opts.length === 0) {\n                return value;\n            }\n            const matched = opts.filter((item) => {\n                return item.value === value;\n            }).length > 0;\n            return matched ? value : opts[0].value;\n        }\n    }\n\n    class RangeConstraint {\n        constructor(config) {\n            this.values = ValueMap.fromObject({\n                max: config.max,\n                min: config.min,\n            });\n        }\n        get maxValue() {\n            return this.values.get('max');\n        }\n        get minValue() {\n            return this.values.get('min');\n        }\n        constrain(value) {\n            const max = this.values.get('max');\n            const min = this.values.get('min');\n            let result = value;\n            if (!isEmpty(min)) {\n                result = Math.max(result, min);\n            }\n            if (!isEmpty(max)) {\n                result = Math.min(result, max);\n            }\n            return result;\n        }\n    }\n\n    class StepConstraint {\n        constructor(step, origin = 0) {\n            this.step = step;\n            this.origin = origin;\n        }\n        constrain(value) {\n            const o = this.origin % this.step;\n            const r = Math.round((value - o) / this.step);\n            return o + r * this.step;\n        }\n    }\n\n    const className$j = ClassName('lst');\n    class ListView {\n        constructor(doc, config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.props_ = config.props;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$j());\n            config.viewProps.bindClassModifiers(this.element);\n            const selectElem = doc.createElement('select');\n            selectElem.classList.add(className$j('s'));\n            config.viewProps.bindDisabled(selectElem);\n            this.element.appendChild(selectElem);\n            this.selectElement = selectElem;\n            const markElem = doc.createElement('div');\n            markElem.classList.add(className$j('m'));\n            markElem.appendChild(createSvgIconElement(doc, 'dropdown'));\n            this.element.appendChild(markElem);\n            config.value.emitter.on('change', this.onValueChange_);\n            this.value_ = config.value;\n            bindValueMap(this.props_, 'options', (opts) => {\n                removeChildElements(this.selectElement);\n                opts.forEach((item) => {\n                    const optionElem = doc.createElement('option');\n                    optionElem.textContent = item.text;\n                    this.selectElement.appendChild(optionElem);\n                });\n                this.update_();\n            });\n        }\n        update_() {\n            const values = this.props_.get('options').map((o) => o.value);\n            this.selectElement.selectedIndex = values.indexOf(this.value_.rawValue);\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class ListController {\n        constructor(doc, config) {\n            this.onSelectChange_ = this.onSelectChange_.bind(this);\n            this.props = config.props;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new ListView(doc, {\n                props: this.props,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.selectElement.addEventListener('change', this.onSelectChange_);\n        }\n        onSelectChange_(e) {\n            const selectElem = forceCast(e.currentTarget);\n            this.value.rawValue =\n                this.props.get('options')[selectElem.selectedIndex].value;\n        }\n    }\n\n    const className$i = ClassName('pop');\n    class PopupView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$i());\n            config.viewProps.bindClassModifiers(this.element);\n            bindValue(config.shows, valueToClassName(this.element, className$i(undefined, 'v')));\n        }\n    }\n\n    class PopupController {\n        constructor(doc, config) {\n            this.shows = createValue(false);\n            this.viewProps = config.viewProps;\n            this.view = new PopupView(doc, {\n                shows: this.shows,\n                viewProps: this.viewProps,\n            });\n        }\n    }\n\n    const className$h = ClassName('txt');\n    class TextView {\n        constructor(doc, config) {\n            this.onChange_ = this.onChange_.bind(this);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$h());\n            config.viewProps.bindClassModifiers(this.element);\n            this.props_ = config.props;\n            this.props_.emitter.on('change', this.onChange_);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className$h('i'));\n            inputElem.type = 'text';\n            config.viewProps.bindDisabled(inputElem);\n            this.element.appendChild(inputElem);\n            this.inputElement = inputElem;\n            config.value.emitter.on('change', this.onChange_);\n            this.value_ = config.value;\n            this.refresh();\n        }\n        refresh() {\n            const formatter = this.props_.get('formatter');\n            this.inputElement.value = formatter(this.value_.rawValue);\n        }\n        onChange_() {\n            this.refresh();\n        }\n    }\n\n    class TextController {\n        constructor(doc, config) {\n            this.onInputChange_ = this.onInputChange_.bind(this);\n            this.parser_ = config.parser;\n            this.props = config.props;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new TextView(doc, {\n                props: config.props,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.inputElement.addEventListener('change', this.onInputChange_);\n        }\n        onInputChange_(e) {\n            const inputElem = forceCast(e.currentTarget);\n            const value = inputElem.value;\n            const parsedValue = this.parser_(value);\n            if (!isEmpty(parsedValue)) {\n                this.value.rawValue = parsedValue;\n            }\n            this.view.refresh();\n        }\n    }\n\n    function boolToString(value) {\n        return String(value);\n    }\n    function boolFromUnknown(value) {\n        if (value === 'false') {\n            return false;\n        }\n        return !!value;\n    }\n    function BooleanFormatter(value) {\n        return boolToString(value);\n    }\n\n    class NumberLiteralNode {\n        constructor(text) {\n            this.text = text;\n        }\n        evaluate() {\n            return Number(this.text);\n        }\n        toString() {\n            return this.text;\n        }\n    }\n    const BINARY_OPERATION_MAP = {\n        '**': (v1, v2) => Math.pow(v1, v2),\n        '*': (v1, v2) => v1 * v2,\n        '/': (v1, v2) => v1 / v2,\n        '%': (v1, v2) => v1 % v2,\n        '+': (v1, v2) => v1 + v2,\n        '-': (v1, v2) => v1 - v2,\n        '<<': (v1, v2) => v1 << v2,\n        '>>': (v1, v2) => v1 >> v2,\n        '>>>': (v1, v2) => v1 >>> v2,\n        '&': (v1, v2) => v1 & v2,\n        '^': (v1, v2) => v1 ^ v2,\n        '|': (v1, v2) => v1 | v2,\n    };\n    class BinaryOperationNode {\n        constructor(operator, left, right) {\n            this.left = left;\n            this.operator = operator;\n            this.right = right;\n        }\n        evaluate() {\n            const op = BINARY_OPERATION_MAP[this.operator];\n            if (!op) {\n                throw new Error(`unexpected binary operator: '${this.operator}`);\n            }\n            return op(this.left.evaluate(), this.right.evaluate());\n        }\n        toString() {\n            return [\n                'b(',\n                this.left.toString(),\n                this.operator,\n                this.right.toString(),\n                ')',\n            ].join(' ');\n        }\n    }\n    const UNARY_OPERATION_MAP = {\n        '+': (v) => v,\n        '-': (v) => -v,\n        '~': (v) => ~v,\n    };\n    class UnaryOperationNode {\n        constructor(operator, expr) {\n            this.operator = operator;\n            this.expression = expr;\n        }\n        evaluate() {\n            const op = UNARY_OPERATION_MAP[this.operator];\n            if (!op) {\n                throw new Error(`unexpected unary operator: '${this.operator}`);\n            }\n            return op(this.expression.evaluate());\n        }\n        toString() {\n            return ['u(', this.operator, this.expression.toString(), ')'].join(' ');\n        }\n    }\n\n    function combineReader(parsers) {\n        return (text, cursor) => {\n            for (let i = 0; i < parsers.length; i++) {\n                const result = parsers[i](text, cursor);\n                if (result !== '') {\n                    return result;\n                }\n            }\n            return '';\n        };\n    }\n    function readWhitespace(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^\\s+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readNonZeroDigit(text, cursor) {\n        const ch = text.substr(cursor, 1);\n        return ch.match(/^[1-9]$/) ? ch : '';\n    }\n    function readDecimalDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[0-9]+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readSignedInteger(text, cursor) {\n        const ds = readDecimalDigits(text, cursor);\n        if (ds !== '') {\n            return ds;\n        }\n        const sign = text.substr(cursor, 1);\n        cursor += 1;\n        if (sign !== '-' && sign !== '+') {\n            return '';\n        }\n        const sds = readDecimalDigits(text, cursor);\n        if (sds === '') {\n            return '';\n        }\n        return sign + sds;\n    }\n    function readExponentPart(text, cursor) {\n        const e = text.substr(cursor, 1);\n        cursor += 1;\n        if (e.toLowerCase() !== 'e') {\n            return '';\n        }\n        const si = readSignedInteger(text, cursor);\n        if (si === '') {\n            return '';\n        }\n        return e + si;\n    }\n    function readDecimalIntegerLiteral(text, cursor) {\n        const ch = text.substr(cursor, 1);\n        if (ch === '0') {\n            return ch;\n        }\n        const nzd = readNonZeroDigit(text, cursor);\n        cursor += nzd.length;\n        if (nzd === '') {\n            return '';\n        }\n        return nzd + readDecimalDigits(text, cursor);\n    }\n    function readDecimalLiteral1(text, cursor) {\n        const dil = readDecimalIntegerLiteral(text, cursor);\n        cursor += dil.length;\n        if (dil === '') {\n            return '';\n        }\n        const dot = text.substr(cursor, 1);\n        cursor += dot.length;\n        if (dot !== '.') {\n            return '';\n        }\n        const dds = readDecimalDigits(text, cursor);\n        cursor += dds.length;\n        return dil + dot + dds + readExponentPart(text, cursor);\n    }\n    function readDecimalLiteral2(text, cursor) {\n        const dot = text.substr(cursor, 1);\n        cursor += dot.length;\n        if (dot !== '.') {\n            return '';\n        }\n        const dds = readDecimalDigits(text, cursor);\n        cursor += dds.length;\n        if (dds === '') {\n            return '';\n        }\n        return dot + dds + readExponentPart(text, cursor);\n    }\n    function readDecimalLiteral3(text, cursor) {\n        const dil = readDecimalIntegerLiteral(text, cursor);\n        cursor += dil.length;\n        if (dil === '') {\n            return '';\n        }\n        return dil + readExponentPart(text, cursor);\n    }\n    const readDecimalLiteral = combineReader([\n        readDecimalLiteral1,\n        readDecimalLiteral2,\n        readDecimalLiteral3,\n    ]);\n    function parseBinaryDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[01]+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readBinaryIntegerLiteral(text, cursor) {\n        const prefix = text.substr(cursor, 2);\n        cursor += prefix.length;\n        if (prefix.toLowerCase() !== '0b') {\n            return '';\n        }\n        const bds = parseBinaryDigits(text, cursor);\n        if (bds === '') {\n            return '';\n        }\n        return prefix + bds;\n    }\n    function readOctalDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[0-7]+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readOctalIntegerLiteral(text, cursor) {\n        const prefix = text.substr(cursor, 2);\n        cursor += prefix.length;\n        if (prefix.toLowerCase() !== '0o') {\n            return '';\n        }\n        const ods = readOctalDigits(text, cursor);\n        if (ods === '') {\n            return '';\n        }\n        return prefix + ods;\n    }\n    function readHexDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[0-9a-f]+/i);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readHexIntegerLiteral(text, cursor) {\n        const prefix = text.substr(cursor, 2);\n        cursor += prefix.length;\n        if (prefix.toLowerCase() !== '0x') {\n            return '';\n        }\n        const hds = readHexDigits(text, cursor);\n        if (hds === '') {\n            return '';\n        }\n        return prefix + hds;\n    }\n    const readNonDecimalIntegerLiteral = combineReader([\n        readBinaryIntegerLiteral,\n        readOctalIntegerLiteral,\n        readHexIntegerLiteral,\n    ]);\n    const readNumericLiteral = combineReader([\n        readNonDecimalIntegerLiteral,\n        readDecimalLiteral,\n    ]);\n\n    function parseLiteral(text, cursor) {\n        const num = readNumericLiteral(text, cursor);\n        cursor += num.length;\n        if (num === '') {\n            return null;\n        }\n        return {\n            evaluable: new NumberLiteralNode(num),\n            cursor: cursor,\n        };\n    }\n    function parseParenthesizedExpression(text, cursor) {\n        const op = text.substr(cursor, 1);\n        cursor += op.length;\n        if (op !== '(') {\n            return null;\n        }\n        const expr = parseExpression(text, cursor);\n        if (!expr) {\n            return null;\n        }\n        cursor = expr.cursor;\n        cursor += readWhitespace(text, cursor).length;\n        const cl = text.substr(cursor, 1);\n        cursor += cl.length;\n        if (cl !== ')') {\n            return null;\n        }\n        return {\n            evaluable: expr.evaluable,\n            cursor: cursor,\n        };\n    }\n    function parsePrimaryExpression(text, cursor) {\n        var _a;\n        return ((_a = parseLiteral(text, cursor)) !== null && _a !== void 0 ? _a : parseParenthesizedExpression(text, cursor));\n    }\n    function parseUnaryExpression(text, cursor) {\n        const expr = parsePrimaryExpression(text, cursor);\n        if (expr) {\n            return expr;\n        }\n        const op = text.substr(cursor, 1);\n        cursor += op.length;\n        if (op !== '+' && op !== '-' && op !== '~') {\n            return null;\n        }\n        const num = parseUnaryExpression(text, cursor);\n        if (!num) {\n            return null;\n        }\n        cursor = num.cursor;\n        return {\n            cursor: cursor,\n            evaluable: new UnaryOperationNode(op, num.evaluable),\n        };\n    }\n    function readBinaryOperator(ops, text, cursor) {\n        cursor += readWhitespace(text, cursor).length;\n        const op = ops.filter((op) => text.startsWith(op, cursor))[0];\n        if (!op) {\n            return null;\n        }\n        cursor += op.length;\n        cursor += readWhitespace(text, cursor).length;\n        return {\n            cursor: cursor,\n            operator: op,\n        };\n    }\n    function createBinaryOperationExpressionParser(exprParser, ops) {\n        return (text, cursor) => {\n            const firstExpr = exprParser(text, cursor);\n            if (!firstExpr) {\n                return null;\n            }\n            cursor = firstExpr.cursor;\n            let expr = firstExpr.evaluable;\n            for (;;) {\n                const op = readBinaryOperator(ops, text, cursor);\n                if (!op) {\n                    break;\n                }\n                cursor = op.cursor;\n                const nextExpr = exprParser(text, cursor);\n                if (!nextExpr) {\n                    return null;\n                }\n                cursor = nextExpr.cursor;\n                expr = new BinaryOperationNode(op.operator, expr, nextExpr.evaluable);\n            }\n            return expr\n                ? {\n                    cursor: cursor,\n                    evaluable: expr,\n                }\n                : null;\n        };\n    }\n    const parseBinaryOperationExpression = [\n        ['**'],\n        ['*', '/', '%'],\n        ['+', '-'],\n        ['<<', '>>>', '>>'],\n        ['&'],\n        ['^'],\n        ['|'],\n    ].reduce((parser, ops) => {\n        return createBinaryOperationExpressionParser(parser, ops);\n    }, parseUnaryExpression);\n    function parseExpression(text, cursor) {\n        cursor += readWhitespace(text, cursor).length;\n        return parseBinaryOperationExpression(text, cursor);\n    }\n    function parseEcmaNumberExpression(text) {\n        const expr = parseExpression(text, 0);\n        if (!expr) {\n            return null;\n        }\n        const cursor = expr.cursor + readWhitespace(text, expr.cursor).length;\n        if (cursor !== text.length) {\n            return null;\n        }\n        return expr.evaluable;\n    }\n\n    function parseNumber(text) {\n        var _a;\n        const r = parseEcmaNumberExpression(text);\n        return (_a = r === null || r === void 0 ? void 0 : r.evaluate()) !== null && _a !== void 0 ? _a : null;\n    }\n    function numberFromUnknown(value) {\n        if (typeof value === 'number') {\n            return value;\n        }\n        if (typeof value === 'string') {\n            const pv = parseNumber(value);\n            if (!isEmpty(pv)) {\n                return pv;\n            }\n        }\n        return 0;\n    }\n    function numberToString(value) {\n        return String(value);\n    }\n    function createNumberFormatter(digits) {\n        return (value) => {\n            return value.toFixed(Math.max(Math.min(digits, 20), 0));\n        };\n    }\n\n    const innerFormatter = createNumberFormatter(0);\n    function formatPercentage(value) {\n        return innerFormatter(value) + '%';\n    }\n\n    function stringFromUnknown(value) {\n        return String(value);\n    }\n    function formatString(value) {\n        return value;\n    }\n\n    function connectValues({ primary, secondary, forward, backward, }) {\n        let changing = false;\n        function preventFeedback(callback) {\n            if (changing) {\n                return;\n            }\n            changing = true;\n            callback();\n            changing = false;\n        }\n        primary.emitter.on('change', (ev) => {\n            preventFeedback(() => {\n                secondary.setRawValue(forward(primary, secondary), ev.options);\n            });\n        });\n        secondary.emitter.on('change', (ev) => {\n            preventFeedback(() => {\n                primary.setRawValue(backward(primary, secondary), ev.options);\n            });\n            preventFeedback(() => {\n                secondary.setRawValue(forward(primary, secondary), ev.options);\n            });\n        });\n        preventFeedback(() => {\n            secondary.setRawValue(forward(primary, secondary), {\n                forceEmit: false,\n                last: true,\n            });\n        });\n    }\n\n    function getStepForKey(baseStep, keys) {\n        const step = baseStep * (keys.altKey ? 0.1 : 1) * (keys.shiftKey ? 10 : 1);\n        if (keys.upKey) {\n            return +step;\n        }\n        else if (keys.downKey) {\n            return -step;\n        }\n        return 0;\n    }\n    function getVerticalStepKeys(ev) {\n        return {\n            altKey: ev.altKey,\n            downKey: ev.key === 'ArrowDown',\n            shiftKey: ev.shiftKey,\n            upKey: ev.key === 'ArrowUp',\n        };\n    }\n    function getHorizontalStepKeys(ev) {\n        return {\n            altKey: ev.altKey,\n            downKey: ev.key === 'ArrowLeft',\n            shiftKey: ev.shiftKey,\n            upKey: ev.key === 'ArrowRight',\n        };\n    }\n    function isVerticalArrowKey(key) {\n        return key === 'ArrowUp' || key === 'ArrowDown';\n    }\n    function isArrowKey(key) {\n        return isVerticalArrowKey(key) || key === 'ArrowLeft' || key === 'ArrowRight';\n    }\n\n    function computeOffset$1(ev, elem) {\n        var _a, _b;\n        const win = elem.ownerDocument.defaultView;\n        const rect = elem.getBoundingClientRect();\n        return {\n            x: ev.pageX - (((_a = (win && win.scrollX)) !== null && _a !== void 0 ? _a : 0) + rect.left),\n            y: ev.pageY - (((_b = (win && win.scrollY)) !== null && _b !== void 0 ? _b : 0) + rect.top),\n        };\n    }\n    class PointerHandler {\n        constructor(element) {\n            this.lastTouch_ = null;\n            this.onDocumentMouseMove_ = this.onDocumentMouseMove_.bind(this);\n            this.onDocumentMouseUp_ = this.onDocumentMouseUp_.bind(this);\n            this.onMouseDown_ = this.onMouseDown_.bind(this);\n            this.onTouchEnd_ = this.onTouchEnd_.bind(this);\n            this.onTouchMove_ = this.onTouchMove_.bind(this);\n            this.onTouchStart_ = this.onTouchStart_.bind(this);\n            this.elem_ = element;\n            this.emitter = new Emitter();\n            element.addEventListener('touchstart', this.onTouchStart_, {\n                passive: false,\n            });\n            element.addEventListener('touchmove', this.onTouchMove_, {\n                passive: true,\n            });\n            element.addEventListener('touchend', this.onTouchEnd_);\n            element.addEventListener('mousedown', this.onMouseDown_);\n        }\n        computePosition_(offset) {\n            const rect = this.elem_.getBoundingClientRect();\n            return {\n                bounds: {\n                    width: rect.width,\n                    height: rect.height,\n                },\n                point: offset\n                    ? {\n                        x: offset.x,\n                        y: offset.y,\n                    }\n                    : null,\n            };\n        }\n        onMouseDown_(ev) {\n            var _a;\n            ev.preventDefault();\n            (_a = ev.currentTarget) === null || _a === void 0 ? void 0 : _a.focus();\n            const doc = this.elem_.ownerDocument;\n            doc.addEventListener('mousemove', this.onDocumentMouseMove_);\n            doc.addEventListener('mouseup', this.onDocumentMouseUp_);\n            this.emitter.emit('down', {\n                altKey: ev.altKey,\n                data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n        onDocumentMouseMove_(ev) {\n            this.emitter.emit('move', {\n                altKey: ev.altKey,\n                data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n        onDocumentMouseUp_(ev) {\n            const doc = this.elem_.ownerDocument;\n            doc.removeEventListener('mousemove', this.onDocumentMouseMove_);\n            doc.removeEventListener('mouseup', this.onDocumentMouseUp_);\n            this.emitter.emit('up', {\n                altKey: ev.altKey,\n                data: this.computePosition_(computeOffset$1(ev, this.elem_)),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n        onTouchStart_(ev) {\n            ev.preventDefault();\n            const touch = ev.targetTouches.item(0);\n            const rect = this.elem_.getBoundingClientRect();\n            this.emitter.emit('down', {\n                altKey: ev.altKey,\n                data: this.computePosition_(touch\n                    ? {\n                        x: touch.clientX - rect.left,\n                        y: touch.clientY - rect.top,\n                    }\n                    : undefined),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n            this.lastTouch_ = touch;\n        }\n        onTouchMove_(ev) {\n            const touch = ev.targetTouches.item(0);\n            const rect = this.elem_.getBoundingClientRect();\n            this.emitter.emit('move', {\n                altKey: ev.altKey,\n                data: this.computePosition_(touch\n                    ? {\n                        x: touch.clientX - rect.left,\n                        y: touch.clientY - rect.top,\n                    }\n                    : undefined),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n            this.lastTouch_ = touch;\n        }\n        onTouchEnd_(ev) {\n            var _a;\n            const touch = (_a = ev.targetTouches.item(0)) !== null && _a !== void 0 ? _a : this.lastTouch_;\n            const rect = this.elem_.getBoundingClientRect();\n            this.emitter.emit('up', {\n                altKey: ev.altKey,\n                data: this.computePosition_(touch\n                    ? {\n                        x: touch.clientX - rect.left,\n                        y: touch.clientY - rect.top,\n                    }\n                    : undefined),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n    }\n\n    function mapRange(value, start1, end1, start2, end2) {\n        const p = (value - start1) / (end1 - start1);\n        return start2 + p * (end2 - start2);\n    }\n    function getDecimalDigits(value) {\n        const text = String(value.toFixed(10));\n        const frac = text.split('.')[1];\n        return frac.replace(/0+$/, '').length;\n    }\n    function constrainRange(value, min, max) {\n        return Math.min(Math.max(value, min), max);\n    }\n    function loopRange(value, max) {\n        return ((value % max) + max) % max;\n    }\n\n    const className$g = ClassName('txt');\n    class NumberTextView {\n        constructor(doc, config) {\n            this.onChange_ = this.onChange_.bind(this);\n            this.props_ = config.props;\n            this.props_.emitter.on('change', this.onChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$g(), className$g(undefined, 'num'));\n            if (config.arrayPosition) {\n                this.element.classList.add(className$g(undefined, config.arrayPosition));\n            }\n            config.viewProps.bindClassModifiers(this.element);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className$g('i'));\n            inputElem.type = 'text';\n            config.viewProps.bindDisabled(inputElem);\n            this.element.appendChild(inputElem);\n            this.inputElement = inputElem;\n            this.onDraggingChange_ = this.onDraggingChange_.bind(this);\n            this.dragging_ = config.dragging;\n            this.dragging_.emitter.on('change', this.onDraggingChange_);\n            this.element.classList.add(className$g());\n            this.inputElement.classList.add(className$g('i'));\n            const knobElem = doc.createElement('div');\n            knobElem.classList.add(className$g('k'));\n            this.element.appendChild(knobElem);\n            this.knobElement = knobElem;\n            const guideElem = doc.createElementNS(SVG_NS, 'svg');\n            guideElem.classList.add(className$g('g'));\n            this.knobElement.appendChild(guideElem);\n            const bodyElem = doc.createElementNS(SVG_NS, 'path');\n            bodyElem.classList.add(className$g('gb'));\n            guideElem.appendChild(bodyElem);\n            this.guideBodyElem_ = bodyElem;\n            const headElem = doc.createElementNS(SVG_NS, 'path');\n            headElem.classList.add(className$g('gh'));\n            guideElem.appendChild(headElem);\n            this.guideHeadElem_ = headElem;\n            const tooltipElem = doc.createElement('div');\n            tooltipElem.classList.add(ClassName('tt')());\n            this.knobElement.appendChild(tooltipElem);\n            this.tooltipElem_ = tooltipElem;\n            config.value.emitter.on('change', this.onChange_);\n            this.value = config.value;\n            this.refresh();\n        }\n        onDraggingChange_(ev) {\n            if (ev.rawValue === null) {\n                this.element.classList.remove(className$g(undefined, 'drg'));\n                return;\n            }\n            this.element.classList.add(className$g(undefined, 'drg'));\n            const x = ev.rawValue / this.props_.get('draggingScale');\n            const aox = x + (x > 0 ? -1 : x < 0 ? +1 : 0);\n            const adx = constrainRange(-aox, -4, +4);\n            this.guideHeadElem_.setAttributeNS(null, 'd', [`M ${aox + adx},0 L${aox},4 L${aox + adx},8`, `M ${x},-1 L${x},9`].join(' '));\n            this.guideBodyElem_.setAttributeNS(null, 'd', `M 0,4 L${x},4`);\n            const formatter = this.props_.get('formatter');\n            this.tooltipElem_.textContent = formatter(this.value.rawValue);\n            this.tooltipElem_.style.left = `${x}px`;\n        }\n        refresh() {\n            const formatter = this.props_.get('formatter');\n            this.inputElement.value = formatter(this.value.rawValue);\n        }\n        onChange_() {\n            this.refresh();\n        }\n    }\n\n    class NumberTextController {\n        constructor(doc, config) {\n            var _a;\n            this.originRawValue_ = 0;\n            this.onInputChange_ = this.onInputChange_.bind(this);\n            this.onInputKeyDown_ = this.onInputKeyDown_.bind(this);\n            this.onInputKeyUp_ = this.onInputKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.baseStep_ = config.baseStep;\n            this.parser_ = config.parser;\n            this.props = config.props;\n            this.sliderProps_ = (_a = config.sliderProps) !== null && _a !== void 0 ? _a : null;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.dragging_ = createValue(null);\n            this.view = new NumberTextView(doc, {\n                arrayPosition: config.arrayPosition,\n                dragging: this.dragging_,\n                props: this.props,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.inputElement.addEventListener('change', this.onInputChange_);\n            this.view.inputElement.addEventListener('keydown', this.onInputKeyDown_);\n            this.view.inputElement.addEventListener('keyup', this.onInputKeyUp_);\n            const ph = new PointerHandler(this.view.knobElement);\n            ph.emitter.on('down', this.onPointerDown_);\n            ph.emitter.on('move', this.onPointerMove_);\n            ph.emitter.on('up', this.onPointerUp_);\n        }\n        constrainValue_(value) {\n            var _a, _b;\n            const min = (_a = this.sliderProps_) === null || _a === void 0 ? void 0 : _a.get('minValue');\n            const max = (_b = this.sliderProps_) === null || _b === void 0 ? void 0 : _b.get('maxValue');\n            let v = value;\n            if (min !== undefined) {\n                v = Math.max(v, min);\n            }\n            if (max !== undefined) {\n                v = Math.min(v, max);\n            }\n            return v;\n        }\n        onInputChange_(e) {\n            const inputElem = forceCast(e.currentTarget);\n            const value = inputElem.value;\n            const parsedValue = this.parser_(value);\n            if (!isEmpty(parsedValue)) {\n                this.value.rawValue = this.constrainValue_(parsedValue);\n            }\n            this.view.refresh();\n        }\n        onInputKeyDown_(ev) {\n            const step = getStepForKey(this.baseStep_, getVerticalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.constrainValue_(this.value.rawValue + step), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onInputKeyUp_(ev) {\n            const step = getStepForKey(this.baseStep_, getVerticalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onPointerDown_() {\n            this.originRawValue_ = this.value.rawValue;\n            this.dragging_.rawValue = 0;\n        }\n        computeDraggingValue_(data) {\n            if (!data.point) {\n                return null;\n            }\n            const dx = data.point.x - data.bounds.width / 2;\n            return this.constrainValue_(this.originRawValue_ + dx * this.props.get('draggingScale'));\n        }\n        onPointerMove_(ev) {\n            const v = this.computeDraggingValue_(ev.data);\n            if (v === null) {\n                return;\n            }\n            this.value.setRawValue(v, {\n                forceEmit: false,\n                last: false,\n            });\n            this.dragging_.rawValue = this.value.rawValue - this.originRawValue_;\n        }\n        onPointerUp_(ev) {\n            const v = this.computeDraggingValue_(ev.data);\n            if (v === null) {\n                return;\n            }\n            this.value.setRawValue(v, {\n                forceEmit: true,\n                last: true,\n            });\n            this.dragging_.rawValue = null;\n        }\n    }\n\n    const className$f = ClassName('sld');\n    class SliderView {\n        constructor(doc, config) {\n            this.onChange_ = this.onChange_.bind(this);\n            this.props_ = config.props;\n            this.props_.emitter.on('change', this.onChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$f());\n            config.viewProps.bindClassModifiers(this.element);\n            const trackElem = doc.createElement('div');\n            trackElem.classList.add(className$f('t'));\n            config.viewProps.bindTabIndex(trackElem);\n            this.element.appendChild(trackElem);\n            this.trackElement = trackElem;\n            const knobElem = doc.createElement('div');\n            knobElem.classList.add(className$f('k'));\n            this.trackElement.appendChild(knobElem);\n            this.knobElement = knobElem;\n            config.value.emitter.on('change', this.onChange_);\n            this.value = config.value;\n            this.update_();\n        }\n        update_() {\n            const p = constrainRange(mapRange(this.value.rawValue, this.props_.get('minValue'), this.props_.get('maxValue'), 0, 100), 0, 100);\n            this.knobElement.style.width = `${p}%`;\n        }\n        onChange_() {\n            this.update_();\n        }\n    }\n\n    class SliderController {\n        constructor(doc, config) {\n            this.onKeyDown_ = this.onKeyDown_.bind(this);\n            this.onKeyUp_ = this.onKeyUp_.bind(this);\n            this.onPointerDownOrMove_ = this.onPointerDownOrMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.baseStep_ = config.baseStep;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.props = config.props;\n            this.view = new SliderView(doc, {\n                props: this.props,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.ptHandler_ = new PointerHandler(this.view.trackElement);\n            this.ptHandler_.emitter.on('down', this.onPointerDownOrMove_);\n            this.ptHandler_.emitter.on('move', this.onPointerDownOrMove_);\n            this.ptHandler_.emitter.on('up', this.onPointerUp_);\n            this.view.trackElement.addEventListener('keydown', this.onKeyDown_);\n            this.view.trackElement.addEventListener('keyup', this.onKeyUp_);\n        }\n        handlePointerEvent_(d, opts) {\n            if (!d.point) {\n                return;\n            }\n            this.value.setRawValue(mapRange(constrainRange(d.point.x, 0, d.bounds.width), 0, d.bounds.width, this.props.get('minValue'), this.props.get('maxValue')), opts);\n        }\n        onPointerDownOrMove_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onKeyDown_(ev) {\n            const step = getStepForKey(this.baseStep_, getHorizontalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue + step, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onKeyUp_(ev) {\n            const step = getStepForKey(this.baseStep_, getHorizontalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n    }\n\n    const className$e = ClassName('sldtxt');\n    class SliderTextView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$e());\n            const sliderElem = doc.createElement('div');\n            sliderElem.classList.add(className$e('s'));\n            this.sliderView_ = config.sliderView;\n            sliderElem.appendChild(this.sliderView_.element);\n            this.element.appendChild(sliderElem);\n            const textElem = doc.createElement('div');\n            textElem.classList.add(className$e('t'));\n            this.textView_ = config.textView;\n            textElem.appendChild(this.textView_.element);\n            this.element.appendChild(textElem);\n        }\n    }\n\n    class SliderTextController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.sliderC_ = new SliderController(doc, {\n                baseStep: config.baseStep,\n                props: config.sliderProps,\n                value: config.value,\n                viewProps: this.viewProps,\n            });\n            this.textC_ = new NumberTextController(doc, {\n                baseStep: config.baseStep,\n                parser: config.parser,\n                props: config.textProps,\n                sliderProps: config.sliderProps,\n                value: config.value,\n                viewProps: config.viewProps,\n            });\n            this.view = new SliderTextView(doc, {\n                sliderView: this.sliderC_.view,\n                textView: this.textC_.view,\n            });\n        }\n        get sliderController() {\n            return this.sliderC_;\n        }\n        get textController() {\n            return this.textC_;\n        }\n    }\n\n    function writePrimitive(target, value) {\n        target.write(value);\n    }\n\n    function parseListOptions(value) {\n        const p = ParamsParsers;\n        if (Array.isArray(value)) {\n            return p.required.array(p.required.object({\n                text: p.required.string,\n                value: p.required.raw,\n            }))(value).value;\n        }\n        if (typeof value === 'object') {\n            return p.required.raw(value)\n                .value;\n        }\n        return undefined;\n    }\n    function parsePickerLayout(value) {\n        if (value === 'inline' || value === 'popup') {\n            return value;\n        }\n        return undefined;\n    }\n    function parsePointDimensionParams(value) {\n        const p = ParamsParsers;\n        return p.required.object({\n            max: p.optional.number,\n            min: p.optional.number,\n            step: p.optional.number,\n        })(value).value;\n    }\n    function normalizeListOptions(options) {\n        if (Array.isArray(options)) {\n            return options;\n        }\n        const items = [];\n        Object.keys(options).forEach((text) => {\n            items.push({ text: text, value: options[text] });\n        });\n        return items;\n    }\n    function createListConstraint(options) {\n        return !isEmpty(options)\n            ? new ListConstraint(normalizeListOptions(forceCast(options)))\n            : null;\n    }\n    function findStep(constraint) {\n        const c = constraint ? findConstraint(constraint, StepConstraint) : null;\n        if (!c) {\n            return null;\n        }\n        return c.step;\n    }\n    function getSuitableDecimalDigits(constraint, rawValue) {\n        const sc = constraint && findConstraint(constraint, StepConstraint);\n        if (sc) {\n            return getDecimalDigits(sc.step);\n        }\n        return Math.max(getDecimalDigits(rawValue), 2);\n    }\n    function getBaseStep(constraint) {\n        const step = findStep(constraint);\n        return step !== null && step !== void 0 ? step : 1;\n    }\n    function getSuitableDraggingScale(constraint, rawValue) {\n        var _a;\n        const sc = constraint && findConstraint(constraint, StepConstraint);\n        const base = Math.abs((_a = sc === null || sc === void 0 ? void 0 : sc.step) !== null && _a !== void 0 ? _a : rawValue);\n        return base === 0 ? 0.1 : Math.pow(10, Math.floor(Math.log10(base)) - 1);\n    }\n\n    const className$d = ClassName('ckb');\n    class CheckboxView {\n        constructor(doc, config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$d());\n            config.viewProps.bindClassModifiers(this.element);\n            const labelElem = doc.createElement('label');\n            labelElem.classList.add(className$d('l'));\n            this.element.appendChild(labelElem);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className$d('i'));\n            inputElem.type = 'checkbox';\n            labelElem.appendChild(inputElem);\n            this.inputElement = inputElem;\n            config.viewProps.bindDisabled(this.inputElement);\n            const wrapperElem = doc.createElement('div');\n            wrapperElem.classList.add(className$d('w'));\n            labelElem.appendChild(wrapperElem);\n            const markElem = createSvgIconElement(doc, 'check');\n            wrapperElem.appendChild(markElem);\n            config.value.emitter.on('change', this.onValueChange_);\n            this.value = config.value;\n            this.update_();\n        }\n        update_() {\n            this.inputElement.checked = this.value.rawValue;\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class CheckboxController {\n        constructor(doc, config) {\n            this.onInputChange_ = this.onInputChange_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new CheckboxView(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.inputElement.addEventListener('change', this.onInputChange_);\n        }\n        onInputChange_(e) {\n            const inputElem = forceCast(e.currentTarget);\n            this.value.rawValue = inputElem.checked;\n        }\n    }\n\n    function createConstraint$6(params) {\n        const constraints = [];\n        const lc = createListConstraint(params.options);\n        if (lc) {\n            constraints.push(lc);\n        }\n        return new CompositeConstraint(constraints);\n    }\n    const BooleanInputPlugin = {\n        id: 'input-bool',\n        type: 'input',\n        accept: (value, params) => {\n            if (typeof value !== 'boolean') {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                options: p.optional.custom(parseListOptions),\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => boolFromUnknown,\n            constraint: (args) => createConstraint$6(args.params),\n            writer: (_args) => writePrimitive,\n        },\n        controller: (args) => {\n            const doc = args.document;\n            const value = args.value;\n            const c = args.constraint;\n            const lc = c && findConstraint(c, ListConstraint);\n            if (lc) {\n                return new ListController(doc, {\n                    props: new ValueMap({\n                        options: lc.values.value('options'),\n                    }),\n                    value: value,\n                    viewProps: args.viewProps,\n                });\n            }\n            return new CheckboxController(doc, {\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    const className$c = ClassName('col');\n    class ColorView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$c());\n            config.foldable.bindExpandedClass(this.element, className$c(undefined, 'expanded'));\n            bindValueMap(config.foldable, 'completed', valueToClassName(this.element, className$c(undefined, 'cpl')));\n            const headElem = doc.createElement('div');\n            headElem.classList.add(className$c('h'));\n            this.element.appendChild(headElem);\n            const swatchElem = doc.createElement('div');\n            swatchElem.classList.add(className$c('s'));\n            headElem.appendChild(swatchElem);\n            this.swatchElement = swatchElem;\n            const textElem = doc.createElement('div');\n            textElem.classList.add(className$c('t'));\n            headElem.appendChild(textElem);\n            this.textElement = textElem;\n            if (config.pickerLayout === 'inline') {\n                const pickerElem = doc.createElement('div');\n                pickerElem.classList.add(className$c('p'));\n                this.element.appendChild(pickerElem);\n                this.pickerElement = pickerElem;\n            }\n            else {\n                this.pickerElement = null;\n            }\n        }\n    }\n\n    function rgbToHslInt(r, g, b) {\n        const rp = constrainRange(r / 255, 0, 1);\n        const gp = constrainRange(g / 255, 0, 1);\n        const bp = constrainRange(b / 255, 0, 1);\n        const cmax = Math.max(rp, gp, bp);\n        const cmin = Math.min(rp, gp, bp);\n        const c = cmax - cmin;\n        let h = 0;\n        let s = 0;\n        const l = (cmin + cmax) / 2;\n        if (c !== 0) {\n            s = c / (1 - Math.abs(cmax + cmin - 1));\n            if (rp === cmax) {\n                h = (gp - bp) / c;\n            }\n            else if (gp === cmax) {\n                h = 2 + (bp - rp) / c;\n            }\n            else {\n                h = 4 + (rp - gp) / c;\n            }\n            h = h / 6 + (h < 0 ? 1 : 0);\n        }\n        return [h * 360, s * 100, l * 100];\n    }\n    function hslToRgbInt(h, s, l) {\n        const hp = ((h % 360) + 360) % 360;\n        const sp = constrainRange(s / 100, 0, 1);\n        const lp = constrainRange(l / 100, 0, 1);\n        const c = (1 - Math.abs(2 * lp - 1)) * sp;\n        const x = c * (1 - Math.abs(((hp / 60) % 2) - 1));\n        const m = lp - c / 2;\n        let rp, gp, bp;\n        if (hp >= 0 && hp < 60) {\n            [rp, gp, bp] = [c, x, 0];\n        }\n        else if (hp >= 60 && hp < 120) {\n            [rp, gp, bp] = [x, c, 0];\n        }\n        else if (hp >= 120 && hp < 180) {\n            [rp, gp, bp] = [0, c, x];\n        }\n        else if (hp >= 180 && hp < 240) {\n            [rp, gp, bp] = [0, x, c];\n        }\n        else if (hp >= 240 && hp < 300) {\n            [rp, gp, bp] = [x, 0, c];\n        }\n        else {\n            [rp, gp, bp] = [c, 0, x];\n        }\n        return [(rp + m) * 255, (gp + m) * 255, (bp + m) * 255];\n    }\n    function rgbToHsvInt(r, g, b) {\n        const rp = constrainRange(r / 255, 0, 1);\n        const gp = constrainRange(g / 255, 0, 1);\n        const bp = constrainRange(b / 255, 0, 1);\n        const cmax = Math.max(rp, gp, bp);\n        const cmin = Math.min(rp, gp, bp);\n        const d = cmax - cmin;\n        let h;\n        if (d === 0) {\n            h = 0;\n        }\n        else if (cmax === rp) {\n            h = 60 * (((((gp - bp) / d) % 6) + 6) % 6);\n        }\n        else if (cmax === gp) {\n            h = 60 * ((bp - rp) / d + 2);\n        }\n        else {\n            h = 60 * ((rp - gp) / d + 4);\n        }\n        const s = cmax === 0 ? 0 : d / cmax;\n        const v = cmax;\n        return [h, s * 100, v * 100];\n    }\n    function hsvToRgbInt(h, s, v) {\n        const hp = loopRange(h, 360);\n        const sp = constrainRange(s / 100, 0, 1);\n        const vp = constrainRange(v / 100, 0, 1);\n        const c = vp * sp;\n        const x = c * (1 - Math.abs(((hp / 60) % 2) - 1));\n        const m = vp - c;\n        let rp, gp, bp;\n        if (hp >= 0 && hp < 60) {\n            [rp, gp, bp] = [c, x, 0];\n        }\n        else if (hp >= 60 && hp < 120) {\n            [rp, gp, bp] = [x, c, 0];\n        }\n        else if (hp >= 120 && hp < 180) {\n            [rp, gp, bp] = [0, c, x];\n        }\n        else if (hp >= 180 && hp < 240) {\n            [rp, gp, bp] = [0, x, c];\n        }\n        else if (hp >= 240 && hp < 300) {\n            [rp, gp, bp] = [x, 0, c];\n        }\n        else {\n            [rp, gp, bp] = [c, 0, x];\n        }\n        return [(rp + m) * 255, (gp + m) * 255, (bp + m) * 255];\n    }\n    function hslToHsvInt(h, s, l) {\n        const sd = l + (s * (100 - Math.abs(2 * l - 100))) / (2 * 100);\n        return [\n            h,\n            sd !== 0 ? (s * (100 - Math.abs(2 * l - 100))) / sd : 0,\n            l + (s * (100 - Math.abs(2 * l - 100))) / (2 * 100),\n        ];\n    }\n    function hsvToHslInt(h, s, v) {\n        const sd = 100 - Math.abs((v * (200 - s)) / 100 - 100);\n        return [h, sd !== 0 ? (s * v) / sd : 0, (v * (200 - s)) / (2 * 100)];\n    }\n    function removeAlphaComponent(comps) {\n        return [comps[0], comps[1], comps[2]];\n    }\n    function appendAlphaComponent(comps, alpha) {\n        return [comps[0], comps[1], comps[2], alpha];\n    }\n    const MODE_CONVERTER_MAP = {\n        hsl: {\n            hsl: (h, s, l) => [h, s, l],\n            hsv: hslToHsvInt,\n            rgb: hslToRgbInt,\n        },\n        hsv: {\n            hsl: hsvToHslInt,\n            hsv: (h, s, v) => [h, s, v],\n            rgb: hsvToRgbInt,\n        },\n        rgb: {\n            hsl: rgbToHslInt,\n            hsv: rgbToHsvInt,\n            rgb: (r, g, b) => [r, g, b],\n        },\n    };\n    function getColorMaxComponents(mode, type) {\n        return [\n            type === 'float' ? 1 : mode === 'rgb' ? 255 : 360,\n            type === 'float' ? 1 : mode === 'rgb' ? 255 : 100,\n            type === 'float' ? 1 : mode === 'rgb' ? 255 : 100,\n        ];\n    }\n    function loopHueRange(hue, max) {\n        return hue === max ? max : loopRange(hue, max);\n    }\n    function constrainColorComponents(components, mode, type) {\n        var _a;\n        const ms = getColorMaxComponents(mode, type);\n        return [\n            mode === 'rgb'\n                ? constrainRange(components[0], 0, ms[0])\n                : loopHueRange(components[0], ms[0]),\n            constrainRange(components[1], 0, ms[1]),\n            constrainRange(components[2], 0, ms[2]),\n            constrainRange((_a = components[3]) !== null && _a !== void 0 ? _a : 1, 0, 1),\n        ];\n    }\n    function convertColorType(comps, mode, from, to) {\n        const fms = getColorMaxComponents(mode, from);\n        const tms = getColorMaxComponents(mode, to);\n        return comps.map((c, index) => (c / fms[index]) * tms[index]);\n    }\n    function convertColor(components, from, to) {\n        const intComps = convertColorType(components, from.mode, from.type, 'int');\n        const result = MODE_CONVERTER_MAP[from.mode][to.mode](...intComps);\n        return convertColorType(result, to.mode, 'int', to.type);\n    }\n\n    function isRgbColorComponent(obj, key) {\n        if (typeof obj !== 'object' || isEmpty(obj)) {\n            return false;\n        }\n        return key in obj && typeof obj[key] === 'number';\n    }\n    class Color {\n        static black(type = 'int') {\n            return new Color([0, 0, 0], 'rgb', type);\n        }\n        static fromObject(obj, type = 'int') {\n            const comps = 'a' in obj ? [obj.r, obj.g, obj.b, obj.a] : [obj.r, obj.g, obj.b];\n            return new Color(comps, 'rgb', type);\n        }\n        static toRgbaObject(color, type = 'int') {\n            return color.toRgbaObject(type);\n        }\n        static isRgbColorObject(obj) {\n            return (isRgbColorComponent(obj, 'r') &&\n                isRgbColorComponent(obj, 'g') &&\n                isRgbColorComponent(obj, 'b'));\n        }\n        static isRgbaColorObject(obj) {\n            return this.isRgbColorObject(obj) && isRgbColorComponent(obj, 'a');\n        }\n        static isColorObject(obj) {\n            return this.isRgbColorObject(obj);\n        }\n        static equals(v1, v2) {\n            if (v1.mode !== v2.mode) {\n                return false;\n            }\n            const comps1 = v1.comps_;\n            const comps2 = v2.comps_;\n            for (let i = 0; i < comps1.length; i++) {\n                if (comps1[i] !== comps2[i]) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        constructor(comps, mode, type = 'int') {\n            this.mode = mode;\n            this.type = type;\n            this.comps_ = constrainColorComponents(comps, mode, type);\n        }\n        getComponents(opt_mode, type = 'int') {\n            return appendAlphaComponent(convertColor(removeAlphaComponent(this.comps_), { mode: this.mode, type: this.type }, { mode: opt_mode !== null && opt_mode !== void 0 ? opt_mode : this.mode, type }), this.comps_[3]);\n        }\n        toRgbaObject(type = 'int') {\n            const rgbComps = this.getComponents('rgb', type);\n            return {\n                r: rgbComps[0],\n                g: rgbComps[1],\n                b: rgbComps[2],\n                a: rgbComps[3],\n            };\n        }\n    }\n\n    const className$b = ClassName('colp');\n    class ColorPickerView {\n        constructor(doc, config) {\n            this.alphaViews_ = null;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$b());\n            config.viewProps.bindClassModifiers(this.element);\n            const hsvElem = doc.createElement('div');\n            hsvElem.classList.add(className$b('hsv'));\n            const svElem = doc.createElement('div');\n            svElem.classList.add(className$b('sv'));\n            this.svPaletteView_ = config.svPaletteView;\n            svElem.appendChild(this.svPaletteView_.element);\n            hsvElem.appendChild(svElem);\n            const hElem = doc.createElement('div');\n            hElem.classList.add(className$b('h'));\n            this.hPaletteView_ = config.hPaletteView;\n            hElem.appendChild(this.hPaletteView_.element);\n            hsvElem.appendChild(hElem);\n            this.element.appendChild(hsvElem);\n            const rgbElem = doc.createElement('div');\n            rgbElem.classList.add(className$b('rgb'));\n            this.textView_ = config.textView;\n            rgbElem.appendChild(this.textView_.element);\n            this.element.appendChild(rgbElem);\n            if (config.alphaViews) {\n                this.alphaViews_ = {\n                    palette: config.alphaViews.palette,\n                    text: config.alphaViews.text,\n                };\n                const aElem = doc.createElement('div');\n                aElem.classList.add(className$b('a'));\n                const apElem = doc.createElement('div');\n                apElem.classList.add(className$b('ap'));\n                apElem.appendChild(this.alphaViews_.palette.element);\n                aElem.appendChild(apElem);\n                const atElem = doc.createElement('div');\n                atElem.classList.add(className$b('at'));\n                atElem.appendChild(this.alphaViews_.text.element);\n                aElem.appendChild(atElem);\n                this.element.appendChild(aElem);\n            }\n        }\n        get allFocusableElements() {\n            const elems = [\n                this.svPaletteView_.element,\n                this.hPaletteView_.element,\n                this.textView_.modeSelectElement,\n                ...this.textView_.textViews.map((v) => v.inputElement),\n            ];\n            if (this.alphaViews_) {\n                elems.push(this.alphaViews_.palette.element, this.alphaViews_.text.inputElement);\n            }\n            return elems;\n        }\n    }\n\n    function parseColorType(value) {\n        return value === 'int' ? 'int' : value === 'float' ? 'float' : undefined;\n    }\n    function parseColorInputParams(params) {\n        const p = ParamsParsers;\n        return parseParams(params, {\n            alpha: p.optional.boolean,\n            color: p.optional.object({\n                alpha: p.optional.boolean,\n                type: p.optional.custom(parseColorType),\n            }),\n            expanded: p.optional.boolean,\n            picker: p.optional.custom(parsePickerLayout),\n        });\n    }\n    function getBaseStepForColor(forAlpha) {\n        return forAlpha ? 0.1 : 1;\n    }\n    function extractColorType(params) {\n        var _a;\n        return (_a = params.color) === null || _a === void 0 ? void 0 : _a.type;\n    }\n\n    function equalsStringColorFormat(f1, f2) {\n        return (f1.alpha === f2.alpha &&\n            f1.mode === f2.mode &&\n            f1.notation === f2.notation &&\n            f1.type === f2.type);\n    }\n    function parseCssNumberOrPercentage(text, maxValue) {\n        const m = text.match(/^(.+)%$/);\n        if (!m) {\n            return Math.min(parseFloat(text), maxValue);\n        }\n        return Math.min(parseFloat(m[1]) * 0.01 * maxValue, maxValue);\n    }\n    const ANGLE_TO_DEG_MAP = {\n        deg: (angle) => angle,\n        grad: (angle) => (angle * 360) / 400,\n        rad: (angle) => (angle * 360) / (2 * Math.PI),\n        turn: (angle) => angle * 360,\n    };\n    function parseCssNumberOrAngle(text) {\n        const m = text.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);\n        if (!m) {\n            return parseFloat(text);\n        }\n        const angle = parseFloat(m[1]);\n        const unit = m[2];\n        return ANGLE_TO_DEG_MAP[unit](angle);\n    }\n    function parseFunctionalRgbColorComponents(text) {\n        const m = text.match(/^rgb\\(\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n        if (!m) {\n            return null;\n        }\n        const comps = [\n            parseCssNumberOrPercentage(m[1], 255),\n            parseCssNumberOrPercentage(m[2], 255),\n            parseCssNumberOrPercentage(m[3], 255),\n        ];\n        if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n            return null;\n        }\n        return comps;\n    }\n    function createFunctionalRgbColorParser(type) {\n        return (text) => {\n            const comps = parseFunctionalRgbColorComponents(text);\n            return comps ? new Color(comps, 'rgb', type) : null;\n        };\n    }\n    function parseFunctionalRgbaColorComponents(text) {\n        const m = text.match(/^rgba\\(\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n        if (!m) {\n            return null;\n        }\n        const comps = [\n            parseCssNumberOrPercentage(m[1], 255),\n            parseCssNumberOrPercentage(m[2], 255),\n            parseCssNumberOrPercentage(m[3], 255),\n            parseCssNumberOrPercentage(m[4], 1),\n        ];\n        if (isNaN(comps[0]) ||\n            isNaN(comps[1]) ||\n            isNaN(comps[2]) ||\n            isNaN(comps[3])) {\n            return null;\n        }\n        return comps;\n    }\n    function createFunctionalRgbaColorParser(type) {\n        return (text) => {\n            const comps = parseFunctionalRgbaColorComponents(text);\n            return comps ? new Color(comps, 'rgb', type) : null;\n        };\n    }\n    function parseHslColorComponents(text) {\n        const m = text.match(/^hsl\\(\\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n        if (!m) {\n            return null;\n        }\n        const comps = [\n            parseCssNumberOrAngle(m[1]),\n            parseCssNumberOrPercentage(m[2], 100),\n            parseCssNumberOrPercentage(m[3], 100),\n        ];\n        if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n            return null;\n        }\n        return comps;\n    }\n    function createHslColorParser(type) {\n        return (text) => {\n            const comps = parseHslColorComponents(text);\n            return comps ? new Color(comps, 'hsl', type) : null;\n        };\n    }\n    function parseHslaColorComponents(text) {\n        const m = text.match(/^hsla\\(\\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*([0-9A-Fa-f.]+%?)\\s*\\)$/);\n        if (!m) {\n            return null;\n        }\n        const comps = [\n            parseCssNumberOrAngle(m[1]),\n            parseCssNumberOrPercentage(m[2], 100),\n            parseCssNumberOrPercentage(m[3], 100),\n            parseCssNumberOrPercentage(m[4], 1),\n        ];\n        if (isNaN(comps[0]) ||\n            isNaN(comps[1]) ||\n            isNaN(comps[2]) ||\n            isNaN(comps[3])) {\n            return null;\n        }\n        return comps;\n    }\n    function createHslaColorParser(type) {\n        return (text) => {\n            const comps = parseHslaColorComponents(text);\n            return comps ? new Color(comps, 'hsl', type) : null;\n        };\n    }\n    function parseHexRgbColorComponents(text) {\n        const mRgb = text.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);\n        if (mRgb) {\n            return [\n                parseInt(mRgb[1] + mRgb[1], 16),\n                parseInt(mRgb[2] + mRgb[2], 16),\n                parseInt(mRgb[3] + mRgb[3], 16),\n            ];\n        }\n        const mRrggbb = text.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);\n        if (mRrggbb) {\n            return [\n                parseInt(mRrggbb[1], 16),\n                parseInt(mRrggbb[2], 16),\n                parseInt(mRrggbb[3], 16),\n            ];\n        }\n        return null;\n    }\n    function parseHexRgbColor(text) {\n        const comps = parseHexRgbColorComponents(text);\n        return comps ? new Color(comps, 'rgb', 'int') : null;\n    }\n    function parseHexRgbaColorComponents(text) {\n        const mRgb = text.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);\n        if (mRgb) {\n            return [\n                parseInt(mRgb[1] + mRgb[1], 16),\n                parseInt(mRgb[2] + mRgb[2], 16),\n                parseInt(mRgb[3] + mRgb[3], 16),\n                mapRange(parseInt(mRgb[4] + mRgb[4], 16), 0, 255, 0, 1),\n            ];\n        }\n        const mRrggbb = text.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);\n        if (mRrggbb) {\n            return [\n                parseInt(mRrggbb[1], 16),\n                parseInt(mRrggbb[2], 16),\n                parseInt(mRrggbb[3], 16),\n                mapRange(parseInt(mRrggbb[4], 16), 0, 255, 0, 1),\n            ];\n        }\n        return null;\n    }\n    function parseHexRgbaColor(text) {\n        const comps = parseHexRgbaColorComponents(text);\n        return comps ? new Color(comps, 'rgb', 'int') : null;\n    }\n    function parseObjectRgbColorComponents(text) {\n        const m = text.match(/^\\{\\s*r\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*g\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*b\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*\\}$/);\n        if (!m) {\n            return null;\n        }\n        const comps = [\n            parseFloat(m[1]),\n            parseFloat(m[2]),\n            parseFloat(m[3]),\n        ];\n        if (isNaN(comps[0]) || isNaN(comps[1]) || isNaN(comps[2])) {\n            return null;\n        }\n        return comps;\n    }\n    function createObjectRgbColorParser(type) {\n        return (text) => {\n            const comps = parseObjectRgbColorComponents(text);\n            return comps ? new Color(comps, 'rgb', type) : null;\n        };\n    }\n    function parseObjectRgbaColorComponents(text) {\n        const m = text.match(/^\\{\\s*r\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*g\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*b\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*,\\s*a\\s*:\\s*([0-9A-Fa-f.]+%?)\\s*\\}$/);\n        if (!m) {\n            return null;\n        }\n        const comps = [\n            parseFloat(m[1]),\n            parseFloat(m[2]),\n            parseFloat(m[3]),\n            parseFloat(m[4]),\n        ];\n        if (isNaN(comps[0]) ||\n            isNaN(comps[1]) ||\n            isNaN(comps[2]) ||\n            isNaN(comps[3])) {\n            return null;\n        }\n        return comps;\n    }\n    function createObjectRgbaColorParser(type) {\n        return (text) => {\n            const comps = parseObjectRgbaColorComponents(text);\n            return comps ? new Color(comps, 'rgb', type) : null;\n        };\n    }\n    const PARSER_AND_RESULT = [\n        {\n            parser: parseHexRgbColorComponents,\n            result: {\n                alpha: false,\n                mode: 'rgb',\n                notation: 'hex',\n            },\n        },\n        {\n            parser: parseHexRgbaColorComponents,\n            result: {\n                alpha: true,\n                mode: 'rgb',\n                notation: 'hex',\n            },\n        },\n        {\n            parser: parseFunctionalRgbColorComponents,\n            result: {\n                alpha: false,\n                mode: 'rgb',\n                notation: 'func',\n            },\n        },\n        {\n            parser: parseFunctionalRgbaColorComponents,\n            result: {\n                alpha: true,\n                mode: 'rgb',\n                notation: 'func',\n            },\n        },\n        {\n            parser: parseHslColorComponents,\n            result: {\n                alpha: false,\n                mode: 'hsl',\n                notation: 'func',\n            },\n        },\n        {\n            parser: parseHslaColorComponents,\n            result: {\n                alpha: true,\n                mode: 'hsl',\n                notation: 'func',\n            },\n        },\n        {\n            parser: parseObjectRgbColorComponents,\n            result: {\n                alpha: false,\n                mode: 'rgb',\n                notation: 'object',\n            },\n        },\n        {\n            parser: parseObjectRgbaColorComponents,\n            result: {\n                alpha: true,\n                mode: 'rgb',\n                notation: 'object',\n            },\n        },\n    ];\n    function detectStringColor(text) {\n        return PARSER_AND_RESULT.reduce((prev, { parser, result: detection }) => {\n            if (prev) {\n                return prev;\n            }\n            return parser(text) ? detection : null;\n        }, null);\n    }\n    function detectStringColorFormat(text, type = 'int') {\n        const r = detectStringColor(text);\n        if (!r) {\n            return null;\n        }\n        if (r.notation === 'hex' && type !== 'float') {\n            return Object.assign(Object.assign({}, r), { type: 'int' });\n        }\n        if (r.notation === 'func') {\n            return Object.assign(Object.assign({}, r), { type: type });\n        }\n        return null;\n    }\n    const TYPE_TO_PARSERS = {\n        int: [\n            parseHexRgbColor,\n            parseHexRgbaColor,\n            createFunctionalRgbColorParser('int'),\n            createFunctionalRgbaColorParser('int'),\n            createHslColorParser('int'),\n            createHslaColorParser('int'),\n            createObjectRgbColorParser('int'),\n            createObjectRgbaColorParser('int'),\n        ],\n        float: [\n            createFunctionalRgbColorParser('float'),\n            createFunctionalRgbaColorParser('float'),\n            createHslColorParser('float'),\n            createHslaColorParser('float'),\n            createObjectRgbColorParser('float'),\n            createObjectRgbaColorParser('float'),\n        ],\n    };\n    function createColorStringBindingReader(type) {\n        const parsers = TYPE_TO_PARSERS[type];\n        return (value) => {\n            if (typeof value !== 'string') {\n                return Color.black(type);\n            }\n            const result = parsers.reduce((prev, parser) => {\n                if (prev) {\n                    return prev;\n                }\n                return parser(value);\n            }, null);\n            return result !== null && result !== void 0 ? result : Color.black(type);\n        };\n    }\n    function createColorStringParser(type) {\n        const parsers = TYPE_TO_PARSERS[type];\n        return (value) => {\n            return parsers.reduce((prev, parser) => {\n                if (prev) {\n                    return prev;\n                }\n                return parser(value);\n            }, null);\n        };\n    }\n    function zerofill(comp) {\n        const hex = constrainRange(Math.floor(comp), 0, 255).toString(16);\n        return hex.length === 1 ? `0${hex}` : hex;\n    }\n    function colorToHexRgbString(value, prefix = '#') {\n        const hexes = removeAlphaComponent(value.getComponents('rgb'))\n            .map(zerofill)\n            .join('');\n        return `${prefix}${hexes}`;\n    }\n    function colorToHexRgbaString(value, prefix = '#') {\n        const rgbaComps = value.getComponents('rgb');\n        const hexes = [rgbaComps[0], rgbaComps[1], rgbaComps[2], rgbaComps[3] * 255]\n            .map(zerofill)\n            .join('');\n        return `${prefix}${hexes}`;\n    }\n    function colorToFunctionalRgbString(value, opt_type) {\n        const formatter = createNumberFormatter(opt_type === 'float' ? 2 : 0);\n        const comps = removeAlphaComponent(value.getComponents('rgb', opt_type)).map((comp) => formatter(comp));\n        return `rgb(${comps.join(', ')})`;\n    }\n    function createFunctionalRgbColorFormatter(type) {\n        return (value) => {\n            return colorToFunctionalRgbString(value, type);\n        };\n    }\n    function colorToFunctionalRgbaString(value, opt_type) {\n        const aFormatter = createNumberFormatter(2);\n        const rgbFormatter = createNumberFormatter(opt_type === 'float' ? 2 : 0);\n        const comps = value.getComponents('rgb', opt_type).map((comp, index) => {\n            const formatter = index === 3 ? aFormatter : rgbFormatter;\n            return formatter(comp);\n        });\n        return `rgba(${comps.join(', ')})`;\n    }\n    function createFunctionalRgbaColorFormatter(type) {\n        return (value) => {\n            return colorToFunctionalRgbaString(value, type);\n        };\n    }\n    function colorToFunctionalHslString(value) {\n        const formatters = [\n            createNumberFormatter(0),\n            formatPercentage,\n            formatPercentage,\n        ];\n        const comps = removeAlphaComponent(value.getComponents('hsl')).map((comp, index) => formatters[index](comp));\n        return `hsl(${comps.join(', ')})`;\n    }\n    function colorToFunctionalHslaString(value) {\n        const formatters = [\n            createNumberFormatter(0),\n            formatPercentage,\n            formatPercentage,\n            createNumberFormatter(2),\n        ];\n        const comps = value\n            .getComponents('hsl')\n            .map((comp, index) => formatters[index](comp));\n        return `hsla(${comps.join(', ')})`;\n    }\n    function colorToObjectRgbString(value, type) {\n        const formatter = createNumberFormatter(type === 'float' ? 2 : 0);\n        const names = ['r', 'g', 'b'];\n        const comps = removeAlphaComponent(value.getComponents('rgb', type)).map((comp, index) => `${names[index]}: ${formatter(comp)}`);\n        return `{${comps.join(', ')}}`;\n    }\n    function createObjectRgbColorFormatter(type) {\n        return (value) => colorToObjectRgbString(value, type);\n    }\n    function colorToObjectRgbaString(value, type) {\n        const aFormatter = createNumberFormatter(2);\n        const rgbFormatter = createNumberFormatter(type === 'float' ? 2 : 0);\n        const names = ['r', 'g', 'b', 'a'];\n        const comps = value.getComponents('rgb', type).map((comp, index) => {\n            const formatter = index === 3 ? aFormatter : rgbFormatter;\n            return `${names[index]}: ${formatter(comp)}`;\n        });\n        return `{${comps.join(', ')}}`;\n    }\n    function createObjectRgbaColorFormatter(type) {\n        return (value) => colorToObjectRgbaString(value, type);\n    }\n    const FORMAT_AND_STRINGIFIERS = [\n        {\n            format: {\n                alpha: false,\n                mode: 'rgb',\n                notation: 'hex',\n                type: 'int',\n            },\n            stringifier: colorToHexRgbString,\n        },\n        {\n            format: {\n                alpha: true,\n                mode: 'rgb',\n                notation: 'hex',\n                type: 'int',\n            },\n            stringifier: colorToHexRgbaString,\n        },\n        {\n            format: {\n                alpha: false,\n                mode: 'hsl',\n                notation: 'func',\n                type: 'int',\n            },\n            stringifier: colorToFunctionalHslString,\n        },\n        {\n            format: {\n                alpha: true,\n                mode: 'hsl',\n                notation: 'func',\n                type: 'int',\n            },\n            stringifier: colorToFunctionalHslaString,\n        },\n        ...['int', 'float'].reduce((prev, type) => {\n            return [\n                ...prev,\n                {\n                    format: {\n                        alpha: false,\n                        mode: 'rgb',\n                        notation: 'func',\n                        type: type,\n                    },\n                    stringifier: createFunctionalRgbColorFormatter(type),\n                },\n                {\n                    format: {\n                        alpha: true,\n                        mode: 'rgb',\n                        notation: 'func',\n                        type: type,\n                    },\n                    stringifier: createFunctionalRgbaColorFormatter(type),\n                },\n                {\n                    format: {\n                        alpha: false,\n                        mode: 'rgb',\n                        notation: 'object',\n                        type: type,\n                    },\n                    stringifier: createObjectRgbColorFormatter(type),\n                },\n                {\n                    format: {\n                        alpha: true,\n                        mode: 'rgb',\n                        notation: 'object',\n                        type: type,\n                    },\n                    stringifier: createObjectRgbaColorFormatter(type),\n                },\n            ];\n        }, []),\n    ];\n    function findColorStringifier(format) {\n        return FORMAT_AND_STRINGIFIERS.reduce((prev, fas) => {\n            if (prev) {\n                return prev;\n            }\n            return equalsStringColorFormat(fas.format, format)\n                ? fas.stringifier\n                : null;\n        }, null);\n    }\n\n    const className$a = ClassName('apl');\n    class APaletteView {\n        constructor(doc, config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.value = config.value;\n            this.value.emitter.on('change', this.onValueChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$a());\n            config.viewProps.bindClassModifiers(this.element);\n            config.viewProps.bindTabIndex(this.element);\n            const barElem = doc.createElement('div');\n            barElem.classList.add(className$a('b'));\n            this.element.appendChild(barElem);\n            const colorElem = doc.createElement('div');\n            colorElem.classList.add(className$a('c'));\n            barElem.appendChild(colorElem);\n            this.colorElem_ = colorElem;\n            const markerElem = doc.createElement('div');\n            markerElem.classList.add(className$a('m'));\n            this.element.appendChild(markerElem);\n            this.markerElem_ = markerElem;\n            const previewElem = doc.createElement('div');\n            previewElem.classList.add(className$a('p'));\n            this.markerElem_.appendChild(previewElem);\n            this.previewElem_ = previewElem;\n            this.update_();\n        }\n        update_() {\n            const c = this.value.rawValue;\n            const rgbaComps = c.getComponents('rgb');\n            const leftColor = new Color([rgbaComps[0], rgbaComps[1], rgbaComps[2], 0], 'rgb');\n            const rightColor = new Color([rgbaComps[0], rgbaComps[1], rgbaComps[2], 255], 'rgb');\n            const gradientComps = [\n                'to right',\n                colorToFunctionalRgbaString(leftColor),\n                colorToFunctionalRgbaString(rightColor),\n            ];\n            this.colorElem_.style.background = `linear-gradient(${gradientComps.join(',')})`;\n            this.previewElem_.style.backgroundColor = colorToFunctionalRgbaString(c);\n            const left = mapRange(rgbaComps[3], 0, 1, 0, 100);\n            this.markerElem_.style.left = `${left}%`;\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class APaletteController {\n        constructor(doc, config) {\n            this.onKeyDown_ = this.onKeyDown_.bind(this);\n            this.onKeyUp_ = this.onKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new APaletteView(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.ptHandler_ = new PointerHandler(this.view.element);\n            this.ptHandler_.emitter.on('down', this.onPointerDown_);\n            this.ptHandler_.emitter.on('move', this.onPointerMove_);\n            this.ptHandler_.emitter.on('up', this.onPointerUp_);\n            this.view.element.addEventListener('keydown', this.onKeyDown_);\n            this.view.element.addEventListener('keyup', this.onKeyUp_);\n        }\n        handlePointerEvent_(d, opts) {\n            if (!d.point) {\n                return;\n            }\n            const alpha = d.point.x / d.bounds.width;\n            const c = this.value.rawValue;\n            const [h, s, v] = c.getComponents('hsv');\n            this.value.setRawValue(new Color([h, s, v, alpha], 'hsv'), opts);\n        }\n        onPointerDown_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerMove_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onKeyDown_(ev) {\n            const step = getStepForKey(getBaseStepForColor(true), getHorizontalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            const c = this.value.rawValue;\n            const [h, s, v, a] = c.getComponents('hsv');\n            this.value.setRawValue(new Color([h, s, v, a + step], 'hsv'), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onKeyUp_(ev) {\n            const step = getStepForKey(getBaseStepForColor(true), getHorizontalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n    }\n\n    const className$9 = ClassName('coltxt');\n    function createModeSelectElement(doc) {\n        const selectElem = doc.createElement('select');\n        const items = [\n            { text: 'RGB', value: 'rgb' },\n            { text: 'HSL', value: 'hsl' },\n            { text: 'HSV', value: 'hsv' },\n        ];\n        selectElem.appendChild(items.reduce((frag, item) => {\n            const optElem = doc.createElement('option');\n            optElem.textContent = item.text;\n            optElem.value = item.value;\n            frag.appendChild(optElem);\n            return frag;\n        }, doc.createDocumentFragment()));\n        return selectElem;\n    }\n    class ColorTextView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$9());\n            config.viewProps.bindClassModifiers(this.element);\n            const modeElem = doc.createElement('div');\n            modeElem.classList.add(className$9('m'));\n            this.modeElem_ = createModeSelectElement(doc);\n            this.modeElem_.classList.add(className$9('ms'));\n            modeElem.appendChild(this.modeSelectElement);\n            config.viewProps.bindDisabled(this.modeElem_);\n            const modeMarkerElem = doc.createElement('div');\n            modeMarkerElem.classList.add(className$9('mm'));\n            modeMarkerElem.appendChild(createSvgIconElement(doc, 'dropdown'));\n            modeElem.appendChild(modeMarkerElem);\n            this.element.appendChild(modeElem);\n            const textsElem = doc.createElement('div');\n            textsElem.classList.add(className$9('w'));\n            this.element.appendChild(textsElem);\n            this.textsElem_ = textsElem;\n            this.textViews_ = config.textViews;\n            this.applyTextViews_();\n            bindValue(config.colorMode, (mode) => {\n                this.modeElem_.value = mode;\n            });\n        }\n        get modeSelectElement() {\n            return this.modeElem_;\n        }\n        get textViews() {\n            return this.textViews_;\n        }\n        set textViews(textViews) {\n            this.textViews_ = textViews;\n            this.applyTextViews_();\n        }\n        applyTextViews_() {\n            removeChildElements(this.textsElem_);\n            const doc = this.element.ownerDocument;\n            this.textViews_.forEach((v) => {\n                const compElem = doc.createElement('div');\n                compElem.classList.add(className$9('c'));\n                compElem.appendChild(v.element);\n                this.textsElem_.appendChild(compElem);\n            });\n        }\n    }\n\n    function createFormatter$2(type) {\n        return createNumberFormatter(type === 'float' ? 2 : 0);\n    }\n    function createConstraint$5(mode, type, index) {\n        const max = getColorMaxComponents(mode, type)[index];\n        return new DefiniteRangeConstraint({\n            min: 0,\n            max: max,\n        });\n    }\n    function createComponentController(doc, config, index) {\n        return new NumberTextController(doc, {\n            arrayPosition: index === 0 ? 'fst' : index === 3 - 1 ? 'lst' : 'mid',\n            baseStep: getBaseStepForColor(false),\n            parser: config.parser,\n            props: ValueMap.fromObject({\n                draggingScale: config.colorType === 'float' ? 0.01 : 1,\n                formatter: createFormatter$2(config.colorType),\n            }),\n            value: createValue(0, {\n                constraint: createConstraint$5(config.colorMode, config.colorType, index),\n            }),\n            viewProps: config.viewProps,\n        });\n    }\n    class ColorTextController {\n        constructor(doc, config) {\n            this.onModeSelectChange_ = this.onModeSelectChange_.bind(this);\n            this.colorType_ = config.colorType;\n            this.parser_ = config.parser;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.colorMode = createValue(this.value.rawValue.mode);\n            this.ccs_ = this.createComponentControllers_(doc);\n            this.view = new ColorTextView(doc, {\n                colorMode: this.colorMode,\n                textViews: [this.ccs_[0].view, this.ccs_[1].view, this.ccs_[2].view],\n                viewProps: this.viewProps,\n            });\n            this.view.modeSelectElement.addEventListener('change', this.onModeSelectChange_);\n        }\n        createComponentControllers_(doc) {\n            const cc = {\n                colorMode: this.colorMode.rawValue,\n                colorType: this.colorType_,\n                parser: this.parser_,\n                viewProps: this.viewProps,\n            };\n            const ccs = [\n                createComponentController(doc, cc, 0),\n                createComponentController(doc, cc, 1),\n                createComponentController(doc, cc, 2),\n            ];\n            ccs.forEach((cs, index) => {\n                connectValues({\n                    primary: this.value,\n                    secondary: cs.value,\n                    forward: (p) => {\n                        return p.rawValue.getComponents(this.colorMode.rawValue, this.colorType_)[index];\n                    },\n                    backward: (p, s) => {\n                        const pickedMode = this.colorMode.rawValue;\n                        const comps = p.rawValue.getComponents(pickedMode, this.colorType_);\n                        comps[index] = s.rawValue;\n                        return new Color(appendAlphaComponent(removeAlphaComponent(comps), comps[3]), pickedMode, this.colorType_);\n                    },\n                });\n            });\n            return ccs;\n        }\n        onModeSelectChange_(ev) {\n            const selectElem = ev.currentTarget;\n            this.colorMode.rawValue = selectElem.value;\n            this.ccs_ = this.createComponentControllers_(this.view.element.ownerDocument);\n            this.view.textViews = [\n                this.ccs_[0].view,\n                this.ccs_[1].view,\n                this.ccs_[2].view,\n            ];\n        }\n    }\n\n    const className$8 = ClassName('hpl');\n    class HPaletteView {\n        constructor(doc, config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.value = config.value;\n            this.value.emitter.on('change', this.onValueChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$8());\n            config.viewProps.bindClassModifiers(this.element);\n            config.viewProps.bindTabIndex(this.element);\n            const colorElem = doc.createElement('div');\n            colorElem.classList.add(className$8('c'));\n            this.element.appendChild(colorElem);\n            const markerElem = doc.createElement('div');\n            markerElem.classList.add(className$8('m'));\n            this.element.appendChild(markerElem);\n            this.markerElem_ = markerElem;\n            this.update_();\n        }\n        update_() {\n            const c = this.value.rawValue;\n            const [h] = c.getComponents('hsv');\n            this.markerElem_.style.backgroundColor = colorToFunctionalRgbString(new Color([h, 100, 100], 'hsv'));\n            const left = mapRange(h, 0, 360, 0, 100);\n            this.markerElem_.style.left = `${left}%`;\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class HPaletteController {\n        constructor(doc, config) {\n            this.onKeyDown_ = this.onKeyDown_.bind(this);\n            this.onKeyUp_ = this.onKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new HPaletteView(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.ptHandler_ = new PointerHandler(this.view.element);\n            this.ptHandler_.emitter.on('down', this.onPointerDown_);\n            this.ptHandler_.emitter.on('move', this.onPointerMove_);\n            this.ptHandler_.emitter.on('up', this.onPointerUp_);\n            this.view.element.addEventListener('keydown', this.onKeyDown_);\n            this.view.element.addEventListener('keyup', this.onKeyUp_);\n        }\n        handlePointerEvent_(d, opts) {\n            if (!d.point) {\n                return;\n            }\n            const hue = mapRange(constrainRange(d.point.x, 0, d.bounds.width), 0, d.bounds.width, 0, 360);\n            const c = this.value.rawValue;\n            const [, s, v, a] = c.getComponents('hsv');\n            this.value.setRawValue(new Color([hue, s, v, a], 'hsv'), opts);\n        }\n        onPointerDown_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerMove_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onKeyDown_(ev) {\n            const step = getStepForKey(getBaseStepForColor(false), getHorizontalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            const c = this.value.rawValue;\n            const [h, s, v, a] = c.getComponents('hsv');\n            this.value.setRawValue(new Color([h + step, s, v, a], 'hsv'), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onKeyUp_(ev) {\n            const step = getStepForKey(getBaseStepForColor(false), getHorizontalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n    }\n\n    const className$7 = ClassName('svp');\n    const CANVAS_RESOL = 64;\n    class SvPaletteView {\n        constructor(doc, config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.value = config.value;\n            this.value.emitter.on('change', this.onValueChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$7());\n            config.viewProps.bindClassModifiers(this.element);\n            config.viewProps.bindTabIndex(this.element);\n            const canvasElem = doc.createElement('canvas');\n            canvasElem.height = CANVAS_RESOL;\n            canvasElem.width = CANVAS_RESOL;\n            canvasElem.classList.add(className$7('c'));\n            this.element.appendChild(canvasElem);\n            this.canvasElement = canvasElem;\n            const markerElem = doc.createElement('div');\n            markerElem.classList.add(className$7('m'));\n            this.element.appendChild(markerElem);\n            this.markerElem_ = markerElem;\n            this.update_();\n        }\n        update_() {\n            const ctx = getCanvasContext(this.canvasElement);\n            if (!ctx) {\n                return;\n            }\n            const c = this.value.rawValue;\n            const hsvComps = c.getComponents('hsv');\n            const width = this.canvasElement.width;\n            const height = this.canvasElement.height;\n            const imgData = ctx.getImageData(0, 0, width, height);\n            const data = imgData.data;\n            for (let iy = 0; iy < height; iy++) {\n                for (let ix = 0; ix < width; ix++) {\n                    const s = mapRange(ix, 0, width, 0, 100);\n                    const v = mapRange(iy, 0, height, 100, 0);\n                    const rgbComps = hsvToRgbInt(hsvComps[0], s, v);\n                    const i = (iy * width + ix) * 4;\n                    data[i] = rgbComps[0];\n                    data[i + 1] = rgbComps[1];\n                    data[i + 2] = rgbComps[2];\n                    data[i + 3] = 255;\n                }\n            }\n            ctx.putImageData(imgData, 0, 0);\n            const left = mapRange(hsvComps[1], 0, 100, 0, 100);\n            this.markerElem_.style.left = `${left}%`;\n            const top = mapRange(hsvComps[2], 0, 100, 100, 0);\n            this.markerElem_.style.top = `${top}%`;\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class SvPaletteController {\n        constructor(doc, config) {\n            this.onKeyDown_ = this.onKeyDown_.bind(this);\n            this.onKeyUp_ = this.onKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new SvPaletteView(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.ptHandler_ = new PointerHandler(this.view.element);\n            this.ptHandler_.emitter.on('down', this.onPointerDown_);\n            this.ptHandler_.emitter.on('move', this.onPointerMove_);\n            this.ptHandler_.emitter.on('up', this.onPointerUp_);\n            this.view.element.addEventListener('keydown', this.onKeyDown_);\n            this.view.element.addEventListener('keyup', this.onKeyUp_);\n        }\n        handlePointerEvent_(d, opts) {\n            if (!d.point) {\n                return;\n            }\n            const saturation = mapRange(d.point.x, 0, d.bounds.width, 0, 100);\n            const value = mapRange(d.point.y, 0, d.bounds.height, 100, 0);\n            const [h, , , a] = this.value.rawValue.getComponents('hsv');\n            this.value.setRawValue(new Color([h, saturation, value, a], 'hsv'), opts);\n        }\n        onPointerDown_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerMove_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onKeyDown_(ev) {\n            if (isArrowKey(ev.key)) {\n                ev.preventDefault();\n            }\n            const [h, s, v, a] = this.value.rawValue.getComponents('hsv');\n            const baseStep = getBaseStepForColor(false);\n            const ds = getStepForKey(baseStep, getHorizontalStepKeys(ev));\n            const dv = getStepForKey(baseStep, getVerticalStepKeys(ev));\n            if (ds === 0 && dv === 0) {\n                return;\n            }\n            this.value.setRawValue(new Color([h, s + ds, v + dv, a], 'hsv'), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onKeyUp_(ev) {\n            const baseStep = getBaseStepForColor(false);\n            const ds = getStepForKey(baseStep, getHorizontalStepKeys(ev));\n            const dv = getStepForKey(baseStep, getVerticalStepKeys(ev));\n            if (ds === 0 && dv === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n    }\n\n    class ColorPickerController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.hPaletteC_ = new HPaletteController(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.svPaletteC_ = new SvPaletteController(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.alphaIcs_ = config.supportsAlpha\n                ? {\n                    palette: new APaletteController(doc, {\n                        value: this.value,\n                        viewProps: this.viewProps,\n                    }),\n                    text: new NumberTextController(doc, {\n                        parser: parseNumber,\n                        baseStep: 0.1,\n                        props: ValueMap.fromObject({\n                            draggingScale: 0.01,\n                            formatter: createNumberFormatter(2),\n                        }),\n                        value: createValue(0, {\n                            constraint: new DefiniteRangeConstraint({ min: 0, max: 1 }),\n                        }),\n                        viewProps: this.viewProps,\n                    }),\n                }\n                : null;\n            if (this.alphaIcs_) {\n                connectValues({\n                    primary: this.value,\n                    secondary: this.alphaIcs_.text.value,\n                    forward: (p) => {\n                        return p.rawValue.getComponents()[3];\n                    },\n                    backward: (p, s) => {\n                        const comps = p.rawValue.getComponents();\n                        comps[3] = s.rawValue;\n                        return new Color(comps, p.rawValue.mode);\n                    },\n                });\n            }\n            this.textC_ = new ColorTextController(doc, {\n                colorType: config.colorType,\n                parser: parseNumber,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view = new ColorPickerView(doc, {\n                alphaViews: this.alphaIcs_\n                    ? {\n                        palette: this.alphaIcs_.palette.view,\n                        text: this.alphaIcs_.text.view,\n                    }\n                    : null,\n                hPaletteView: this.hPaletteC_.view,\n                supportsAlpha: config.supportsAlpha,\n                svPaletteView: this.svPaletteC_.view,\n                textView: this.textC_.view,\n                viewProps: this.viewProps,\n            });\n        }\n        get textController() {\n            return this.textC_;\n        }\n    }\n\n    const className$6 = ClassName('colsw');\n    class ColorSwatchView {\n        constructor(doc, config) {\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            config.value.emitter.on('change', this.onValueChange_);\n            this.value = config.value;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$6());\n            config.viewProps.bindClassModifiers(this.element);\n            const swatchElem = doc.createElement('div');\n            swatchElem.classList.add(className$6('sw'));\n            this.element.appendChild(swatchElem);\n            this.swatchElem_ = swatchElem;\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(className$6('b'));\n            config.viewProps.bindDisabled(buttonElem);\n            this.element.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            this.update_();\n        }\n        update_() {\n            const value = this.value.rawValue;\n            this.swatchElem_.style.backgroundColor = colorToHexRgbaString(value);\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class ColorSwatchController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new ColorSwatchView(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n        }\n    }\n\n    class ColorController {\n        constructor(doc, config) {\n            this.onButtonBlur_ = this.onButtonBlur_.bind(this);\n            this.onButtonClick_ = this.onButtonClick_.bind(this);\n            this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n            this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.foldable_ = Foldable.create(config.expanded);\n            this.swatchC_ = new ColorSwatchController(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            const buttonElem = this.swatchC_.view.buttonElement;\n            buttonElem.addEventListener('blur', this.onButtonBlur_);\n            buttonElem.addEventListener('click', this.onButtonClick_);\n            this.textC_ = new TextController(doc, {\n                parser: config.parser,\n                props: ValueMap.fromObject({\n                    formatter: config.formatter,\n                }),\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view = new ColorView(doc, {\n                foldable: this.foldable_,\n                pickerLayout: config.pickerLayout,\n            });\n            this.view.swatchElement.appendChild(this.swatchC_.view.element);\n            this.view.textElement.appendChild(this.textC_.view.element);\n            this.popC_ =\n                config.pickerLayout === 'popup'\n                    ? new PopupController(doc, {\n                        viewProps: this.viewProps,\n                    })\n                    : null;\n            const pickerC = new ColorPickerController(doc, {\n                colorType: config.colorType,\n                supportsAlpha: config.supportsAlpha,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            pickerC.view.allFocusableElements.forEach((elem) => {\n                elem.addEventListener('blur', this.onPopupChildBlur_);\n                elem.addEventListener('keydown', this.onPopupChildKeydown_);\n            });\n            this.pickerC_ = pickerC;\n            if (this.popC_) {\n                this.view.element.appendChild(this.popC_.view.element);\n                this.popC_.view.element.appendChild(pickerC.view.element);\n                connectValues({\n                    primary: this.foldable_.value('expanded'),\n                    secondary: this.popC_.shows,\n                    forward: (p) => p.rawValue,\n                    backward: (_, s) => s.rawValue,\n                });\n            }\n            else if (this.view.pickerElement) {\n                this.view.pickerElement.appendChild(this.pickerC_.view.element);\n                bindFoldable(this.foldable_, this.view.pickerElement);\n            }\n        }\n        get textController() {\n            return this.textC_;\n        }\n        onButtonBlur_(e) {\n            if (!this.popC_) {\n                return;\n            }\n            const elem = this.view.element;\n            const nextTarget = forceCast(e.relatedTarget);\n            if (!nextTarget || !elem.contains(nextTarget)) {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        onButtonClick_() {\n            this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n            if (this.foldable_.get('expanded')) {\n                this.pickerC_.view.allFocusableElements[0].focus();\n            }\n        }\n        onPopupChildBlur_(ev) {\n            if (!this.popC_) {\n                return;\n            }\n            const elem = this.popC_.view.element;\n            const nextTarget = findNextTarget(ev);\n            if (nextTarget && elem.contains(nextTarget)) {\n                return;\n            }\n            if (nextTarget &&\n                nextTarget === this.swatchC_.view.buttonElement &&\n                !supportsTouch(elem.ownerDocument)) {\n                return;\n            }\n            this.popC_.shows.rawValue = false;\n        }\n        onPopupChildKeydown_(ev) {\n            if (this.popC_) {\n                if (ev.key === 'Escape') {\n                    this.popC_.shows.rawValue = false;\n                }\n            }\n            else if (this.view.pickerElement) {\n                if (ev.key === 'Escape') {\n                    this.swatchC_.view.buttonElement.focus();\n                }\n            }\n        }\n    }\n\n    function colorFromObject(value, opt_type) {\n        if (Color.isColorObject(value)) {\n            return Color.fromObject(value, opt_type);\n        }\n        return Color.black(opt_type);\n    }\n    function colorToRgbNumber(value) {\n        return removeAlphaComponent(value.getComponents('rgb')).reduce((result, comp) => {\n            return (result << 8) | (Math.floor(comp) & 0xff);\n        }, 0);\n    }\n    function colorToRgbaNumber(value) {\n        return (value.getComponents('rgb').reduce((result, comp, index) => {\n            const hex = Math.floor(index === 3 ? comp * 255 : comp) & 0xff;\n            return (result << 8) | hex;\n        }, 0) >>> 0);\n    }\n    function numberToRgbColor(num) {\n        return new Color([(num >> 16) & 0xff, (num >> 8) & 0xff, num & 0xff], 'rgb');\n    }\n    function numberToRgbaColor(num) {\n        return new Color([\n            (num >> 24) & 0xff,\n            (num >> 16) & 0xff,\n            (num >> 8) & 0xff,\n            mapRange(num & 0xff, 0, 255, 0, 1),\n        ], 'rgb');\n    }\n    function colorFromRgbNumber(value) {\n        if (typeof value !== 'number') {\n            return Color.black();\n        }\n        return numberToRgbColor(value);\n    }\n    function colorFromRgbaNumber(value) {\n        if (typeof value !== 'number') {\n            return Color.black();\n        }\n        return numberToRgbaColor(value);\n    }\n\n    function createColorStringWriter(format) {\n        const stringify = findColorStringifier(format);\n        return stringify\n            ? (target, value) => {\n                writePrimitive(target, stringify(value));\n            }\n            : null;\n    }\n    function createColorNumberWriter(supportsAlpha) {\n        const colorToNumber = supportsAlpha ? colorToRgbaNumber : colorToRgbNumber;\n        return (target, value) => {\n            writePrimitive(target, colorToNumber(value));\n        };\n    }\n    function writeRgbaColorObject(target, value, opt_type) {\n        const obj = value.toRgbaObject(opt_type);\n        target.writeProperty('r', obj.r);\n        target.writeProperty('g', obj.g);\n        target.writeProperty('b', obj.b);\n        target.writeProperty('a', obj.a);\n    }\n    function writeRgbColorObject(target, value, opt_type) {\n        const obj = value.toRgbaObject(opt_type);\n        target.writeProperty('r', obj.r);\n        target.writeProperty('g', obj.g);\n        target.writeProperty('b', obj.b);\n    }\n    function createColorObjectWriter(supportsAlpha, opt_type) {\n        return (target, inValue) => {\n            if (supportsAlpha) {\n                writeRgbaColorObject(target, inValue, opt_type);\n            }\n            else {\n                writeRgbColorObject(target, inValue, opt_type);\n            }\n        };\n    }\n\n    function shouldSupportAlpha$1(inputParams) {\n        var _a;\n        if ((inputParams === null || inputParams === void 0 ? void 0 : inputParams.alpha) || ((_a = inputParams === null || inputParams === void 0 ? void 0 : inputParams.color) === null || _a === void 0 ? void 0 : _a.alpha)) {\n            return true;\n        }\n        return false;\n    }\n    function createFormatter$1(supportsAlpha) {\n        return supportsAlpha\n            ? (v) => colorToHexRgbaString(v, '0x')\n            : (v) => colorToHexRgbString(v, '0x');\n    }\n    function isForColor(params) {\n        if ('color' in params) {\n            return true;\n        }\n        if ('view' in params && params.view === 'color') {\n            return true;\n        }\n        return false;\n    }\n    const NumberColorInputPlugin = {\n        id: 'input-color-number',\n        type: 'input',\n        accept: (value, params) => {\n            if (typeof value !== 'number') {\n                return null;\n            }\n            if (!isForColor(params)) {\n                return null;\n            }\n            const result = parseColorInputParams(params);\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (args) => {\n                return shouldSupportAlpha$1(args.params)\n                    ? colorFromRgbaNumber\n                    : colorFromRgbNumber;\n            },\n            equals: Color.equals,\n            writer: (args) => {\n                return createColorNumberWriter(shouldSupportAlpha$1(args.params));\n            },\n        },\n        controller: (args) => {\n            const supportsAlpha = shouldSupportAlpha$1(args.params);\n            const expanded = 'expanded' in args.params ? args.params.expanded : undefined;\n            const picker = 'picker' in args.params ? args.params.picker : undefined;\n            return new ColorController(args.document, {\n                colorType: 'int',\n                expanded: expanded !== null && expanded !== void 0 ? expanded : false,\n                formatter: createFormatter$1(supportsAlpha),\n                parser: createColorStringParser('int'),\n                pickerLayout: picker !== null && picker !== void 0 ? picker : 'popup',\n                supportsAlpha: supportsAlpha,\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    function shouldSupportAlpha(initialValue) {\n        return Color.isRgbaColorObject(initialValue);\n    }\n    function createColorObjectReader(opt_type) {\n        return (value) => {\n            return colorFromObject(value, opt_type);\n        };\n    }\n    function createColorObjectFormatter(supportsAlpha, type) {\n        return (value) => {\n            if (supportsAlpha) {\n                return colorToObjectRgbaString(value, type);\n            }\n            return colorToObjectRgbString(value, type);\n        };\n    }\n    const ObjectColorInputPlugin = {\n        id: 'input-color-object',\n        type: 'input',\n        accept: (value, params) => {\n            if (!Color.isColorObject(value)) {\n                return null;\n            }\n            const result = parseColorInputParams(params);\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (args) => createColorObjectReader(extractColorType(args.params)),\n            equals: Color.equals,\n            writer: (args) => createColorObjectWriter(shouldSupportAlpha(args.initialValue), extractColorType(args.params)),\n        },\n        controller: (args) => {\n            var _a;\n            const supportsAlpha = Color.isRgbaColorObject(args.initialValue);\n            const expanded = 'expanded' in args.params ? args.params.expanded : undefined;\n            const picker = 'picker' in args.params ? args.params.picker : undefined;\n            const type = (_a = extractColorType(args.params)) !== null && _a !== void 0 ? _a : 'int';\n            return new ColorController(args.document, {\n                colorType: type,\n                expanded: expanded !== null && expanded !== void 0 ? expanded : false,\n                formatter: createColorObjectFormatter(supportsAlpha, type),\n                parser: createColorStringParser(type),\n                pickerLayout: picker !== null && picker !== void 0 ? picker : 'popup',\n                supportsAlpha: supportsAlpha,\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    const StringColorInputPlugin = {\n        id: 'input-color-string',\n        type: 'input',\n        accept: (value, params) => {\n            if (typeof value !== 'string') {\n                return null;\n            }\n            if ('view' in params && params.view === 'text') {\n                return null;\n            }\n            const format = detectStringColorFormat(value, extractColorType(params));\n            if (!format) {\n                return null;\n            }\n            const stringifier = findColorStringifier(format);\n            if (!stringifier) {\n                return null;\n            }\n            const result = parseColorInputParams(params);\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (args) => { var _a; return createColorStringBindingReader((_a = extractColorType(args.params)) !== null && _a !== void 0 ? _a : 'int'); },\n            equals: Color.equals,\n            writer: (args) => {\n                const format = detectStringColorFormat(args.initialValue, extractColorType(args.params));\n                if (!format) {\n                    throw TpError.shouldNeverHappen();\n                }\n                const writer = createColorStringWriter(format);\n                if (!writer) {\n                    throw TpError.notBindable();\n                }\n                return writer;\n            },\n        },\n        controller: (args) => {\n            const format = detectStringColorFormat(args.initialValue, extractColorType(args.params));\n            if (!format) {\n                throw TpError.shouldNeverHappen();\n            }\n            const stringifier = findColorStringifier(format);\n            if (!stringifier) {\n                throw TpError.shouldNeverHappen();\n            }\n            const expanded = 'expanded' in args.params ? args.params.expanded : undefined;\n            const picker = 'picker' in args.params ? args.params.picker : undefined;\n            return new ColorController(args.document, {\n                colorType: format.type,\n                expanded: expanded !== null && expanded !== void 0 ? expanded : false,\n                formatter: stringifier,\n                parser: createColorStringParser(format.type),\n                pickerLayout: picker !== null && picker !== void 0 ? picker : 'popup',\n                supportsAlpha: format.alpha,\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    class PointNdConstraint {\n        constructor(config) {\n            this.components = config.components;\n            this.asm_ = config.assembly;\n        }\n        constrain(value) {\n            const comps = this.asm_\n                .toComponents(value)\n                .map((comp, index) => { var _a, _b; return (_b = (_a = this.components[index]) === null || _a === void 0 ? void 0 : _a.constrain(comp)) !== null && _b !== void 0 ? _b : comp; });\n            return this.asm_.fromComponents(comps);\n        }\n    }\n\n    const className$5 = ClassName('pndtxt');\n    class PointNdTextView {\n        constructor(doc, config) {\n            this.textViews = config.textViews;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$5());\n            this.textViews.forEach((v) => {\n                const axisElem = doc.createElement('div');\n                axisElem.classList.add(className$5('a'));\n                axisElem.appendChild(v.element);\n                this.element.appendChild(axisElem);\n            });\n        }\n    }\n\n    function createAxisController(doc, config, index) {\n        return new NumberTextController(doc, {\n            arrayPosition: index === 0 ? 'fst' : index === config.axes.length - 1 ? 'lst' : 'mid',\n            baseStep: config.axes[index].baseStep,\n            parser: config.parser,\n            props: config.axes[index].textProps,\n            value: createValue(0, {\n                constraint: config.axes[index].constraint,\n            }),\n            viewProps: config.viewProps,\n        });\n    }\n    class PointNdTextController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.acs_ = config.axes.map((_, index) => createAxisController(doc, config, index));\n            this.acs_.forEach((c, index) => {\n                connectValues({\n                    primary: this.value,\n                    secondary: c.value,\n                    forward: (p) => {\n                        return config.assembly.toComponents(p.rawValue)[index];\n                    },\n                    backward: (p, s) => {\n                        const comps = config.assembly.toComponents(p.rawValue);\n                        comps[index] = s.rawValue;\n                        return config.assembly.fromComponents(comps);\n                    },\n                });\n            });\n            this.view = new PointNdTextView(doc, {\n                textViews: this.acs_.map((ac) => ac.view),\n            });\n        }\n    }\n\n    function createStepConstraint(params, initialValue) {\n        if ('step' in params && !isEmpty(params.step)) {\n            return new StepConstraint(params.step, initialValue);\n        }\n        return null;\n    }\n    function createRangeConstraint(params) {\n        if (!isEmpty(params.max) && !isEmpty(params.min)) {\n            return new DefiniteRangeConstraint({\n                max: params.max,\n                min: params.min,\n            });\n        }\n        if (!isEmpty(params.max) || !isEmpty(params.min)) {\n            return new RangeConstraint({\n                max: params.max,\n                min: params.min,\n            });\n        }\n        return null;\n    }\n    function findNumberRange(c) {\n        const drc = findConstraint(c, DefiniteRangeConstraint);\n        if (drc) {\n            return [drc.values.get('min'), drc.values.get('max')];\n        }\n        const rc = findConstraint(c, RangeConstraint);\n        if (rc) {\n            return [rc.minValue, rc.maxValue];\n        }\n        return [undefined, undefined];\n    }\n    function createConstraint$4(params,\n    initialValue) {\n        const constraints = [];\n        const sc = createStepConstraint(params, initialValue);\n        if (sc) {\n            constraints.push(sc);\n        }\n        const rc = createRangeConstraint(params);\n        if (rc) {\n            constraints.push(rc);\n        }\n        const lc = createListConstraint(params.options);\n        if (lc) {\n            constraints.push(lc);\n        }\n        return new CompositeConstraint(constraints);\n    }\n    const NumberInputPlugin = {\n        id: 'input-number',\n        type: 'input',\n        accept: (value, params) => {\n            if (typeof value !== 'number') {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                format: p.optional.function,\n                max: p.optional.number,\n                min: p.optional.number,\n                options: p.optional.custom(parseListOptions),\n                step: p.optional.number,\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => numberFromUnknown,\n            constraint: (args) => createConstraint$4(args.params, args.initialValue),\n            writer: (_args) => writePrimitive,\n        },\n        controller: (args) => {\n            var _a;\n            const value = args.value;\n            const c = args.constraint;\n            const lc = c && findConstraint(c, ListConstraint);\n            if (lc) {\n                return new ListController(args.document, {\n                    props: new ValueMap({\n                        options: lc.values.value('options'),\n                    }),\n                    value: value,\n                    viewProps: args.viewProps,\n                });\n            }\n            const formatter = (_a = ('format' in args.params ? args.params.format : undefined)) !== null && _a !== void 0 ? _a : createNumberFormatter(getSuitableDecimalDigits(c, value.rawValue));\n            const drc = c && findConstraint(c, DefiniteRangeConstraint);\n            if (drc) {\n                return new SliderTextController(args.document, {\n                    baseStep: getBaseStep(c),\n                    parser: parseNumber,\n                    sliderProps: new ValueMap({\n                        maxValue: drc.values.value('max'),\n                        minValue: drc.values.value('min'),\n                    }),\n                    textProps: ValueMap.fromObject({\n                        draggingScale: getSuitableDraggingScale(c, value.rawValue),\n                        formatter: formatter,\n                    }),\n                    value: value,\n                    viewProps: args.viewProps,\n                });\n            }\n            return new NumberTextController(args.document, {\n                baseStep: getBaseStep(c),\n                parser: parseNumber,\n                props: ValueMap.fromObject({\n                    draggingScale: getSuitableDraggingScale(c, value.rawValue),\n                    formatter: formatter,\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    class Point2d {\n        constructor(x = 0, y = 0) {\n            this.x = x;\n            this.y = y;\n        }\n        getComponents() {\n            return [this.x, this.y];\n        }\n        static isObject(obj) {\n            if (isEmpty(obj)) {\n                return false;\n            }\n            const x = obj.x;\n            const y = obj.y;\n            if (typeof x !== 'number' || typeof y !== 'number') {\n                return false;\n            }\n            return true;\n        }\n        static equals(v1, v2) {\n            return v1.x === v2.x && v1.y === v2.y;\n        }\n        toObject() {\n            return {\n                x: this.x,\n                y: this.y,\n            };\n        }\n    }\n    const Point2dAssembly = {\n        toComponents: (p) => p.getComponents(),\n        fromComponents: (comps) => new Point2d(...comps),\n    };\n\n    const className$4 = ClassName('p2d');\n    class Point2dView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$4());\n            config.viewProps.bindClassModifiers(this.element);\n            bindValue(config.expanded, valueToClassName(this.element, className$4(undefined, 'expanded')));\n            const headElem = doc.createElement('div');\n            headElem.classList.add(className$4('h'));\n            this.element.appendChild(headElem);\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(className$4('b'));\n            buttonElem.appendChild(createSvgIconElement(doc, 'p2dpad'));\n            config.viewProps.bindDisabled(buttonElem);\n            headElem.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            const textElem = doc.createElement('div');\n            textElem.classList.add(className$4('t'));\n            headElem.appendChild(textElem);\n            this.textElement = textElem;\n            if (config.pickerLayout === 'inline') {\n                const pickerElem = doc.createElement('div');\n                pickerElem.classList.add(className$4('p'));\n                this.element.appendChild(pickerElem);\n                this.pickerElement = pickerElem;\n            }\n            else {\n                this.pickerElement = null;\n            }\n        }\n    }\n\n    const className$3 = ClassName('p2dp');\n    class Point2dPickerView {\n        constructor(doc, config) {\n            this.onFoldableChange_ = this.onFoldableChange_.bind(this);\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.invertsY_ = config.invertsY;\n            this.maxValue_ = config.maxValue;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$3());\n            if (config.layout === 'popup') {\n                this.element.classList.add(className$3(undefined, 'p'));\n            }\n            config.viewProps.bindClassModifiers(this.element);\n            const padElem = doc.createElement('div');\n            padElem.classList.add(className$3('p'));\n            config.viewProps.bindTabIndex(padElem);\n            this.element.appendChild(padElem);\n            this.padElement = padElem;\n            const svgElem = doc.createElementNS(SVG_NS, 'svg');\n            svgElem.classList.add(className$3('g'));\n            this.padElement.appendChild(svgElem);\n            this.svgElem_ = svgElem;\n            const xAxisElem = doc.createElementNS(SVG_NS, 'line');\n            xAxisElem.classList.add(className$3('ax'));\n            xAxisElem.setAttributeNS(null, 'x1', '0');\n            xAxisElem.setAttributeNS(null, 'y1', '50%');\n            xAxisElem.setAttributeNS(null, 'x2', '100%');\n            xAxisElem.setAttributeNS(null, 'y2', '50%');\n            this.svgElem_.appendChild(xAxisElem);\n            const yAxisElem = doc.createElementNS(SVG_NS, 'line');\n            yAxisElem.classList.add(className$3('ax'));\n            yAxisElem.setAttributeNS(null, 'x1', '50%');\n            yAxisElem.setAttributeNS(null, 'y1', '0');\n            yAxisElem.setAttributeNS(null, 'x2', '50%');\n            yAxisElem.setAttributeNS(null, 'y2', '100%');\n            this.svgElem_.appendChild(yAxisElem);\n            const lineElem = doc.createElementNS(SVG_NS, 'line');\n            lineElem.classList.add(className$3('l'));\n            lineElem.setAttributeNS(null, 'x1', '50%');\n            lineElem.setAttributeNS(null, 'y1', '50%');\n            this.svgElem_.appendChild(lineElem);\n            this.lineElem_ = lineElem;\n            const markerElem = doc.createElement('div');\n            markerElem.classList.add(className$3('m'));\n            this.padElement.appendChild(markerElem);\n            this.markerElem_ = markerElem;\n            config.value.emitter.on('change', this.onValueChange_);\n            this.value = config.value;\n            this.update_();\n        }\n        get allFocusableElements() {\n            return [this.padElement];\n        }\n        update_() {\n            const [x, y] = this.value.rawValue.getComponents();\n            const max = this.maxValue_;\n            const px = mapRange(x, -max, +max, 0, 100);\n            const py = mapRange(y, -max, +max, 0, 100);\n            const ipy = this.invertsY_ ? 100 - py : py;\n            this.lineElem_.setAttributeNS(null, 'x2', `${px}%`);\n            this.lineElem_.setAttributeNS(null, 'y2', `${ipy}%`);\n            this.markerElem_.style.left = `${px}%`;\n            this.markerElem_.style.top = `${ipy}%`;\n        }\n        onValueChange_() {\n            this.update_();\n        }\n        onFoldableChange_() {\n            this.update_();\n        }\n    }\n\n    function computeOffset(ev, baseSteps, invertsY) {\n        return [\n            getStepForKey(baseSteps[0], getHorizontalStepKeys(ev)),\n            getStepForKey(baseSteps[1], getVerticalStepKeys(ev)) * (invertsY ? 1 : -1),\n        ];\n    }\n    class Point2dPickerController {\n        constructor(doc, config) {\n            this.onPadKeyDown_ = this.onPadKeyDown_.bind(this);\n            this.onPadKeyUp_ = this.onPadKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.baseSteps_ = config.baseSteps;\n            this.maxValue_ = config.maxValue;\n            this.invertsY_ = config.invertsY;\n            this.view = new Point2dPickerView(doc, {\n                invertsY: this.invertsY_,\n                layout: config.layout,\n                maxValue: this.maxValue_,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.ptHandler_ = new PointerHandler(this.view.padElement);\n            this.ptHandler_.emitter.on('down', this.onPointerDown_);\n            this.ptHandler_.emitter.on('move', this.onPointerMove_);\n            this.ptHandler_.emitter.on('up', this.onPointerUp_);\n            this.view.padElement.addEventListener('keydown', this.onPadKeyDown_);\n            this.view.padElement.addEventListener('keyup', this.onPadKeyUp_);\n        }\n        handlePointerEvent_(d, opts) {\n            if (!d.point) {\n                return;\n            }\n            const max = this.maxValue_;\n            const px = mapRange(d.point.x, 0, d.bounds.width, -max, +max);\n            const py = mapRange(this.invertsY_ ? d.bounds.height - d.point.y : d.point.y, 0, d.bounds.height, -max, +max);\n            this.value.setRawValue(new Point2d(px, py), opts);\n        }\n        onPointerDown_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerMove_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            this.handlePointerEvent_(ev.data, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onPadKeyDown_(ev) {\n            if (isArrowKey(ev.key)) {\n                ev.preventDefault();\n            }\n            const [dx, dy] = computeOffset(ev, this.baseSteps_, this.invertsY_);\n            if (dx === 0 && dy === 0) {\n                return;\n            }\n            this.value.setRawValue(new Point2d(this.value.rawValue.x + dx, this.value.rawValue.y + dy), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPadKeyUp_(ev) {\n            const [dx, dy] = computeOffset(ev, this.baseSteps_, this.invertsY_);\n            if (dx === 0 && dy === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n    }\n\n    class Point2dController {\n        constructor(doc, config) {\n            var _a, _b;\n            this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n            this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n            this.onPadButtonBlur_ = this.onPadButtonBlur_.bind(this);\n            this.onPadButtonClick_ = this.onPadButtonClick_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.foldable_ = Foldable.create(config.expanded);\n            this.popC_ =\n                config.pickerLayout === 'popup'\n                    ? new PopupController(doc, {\n                        viewProps: this.viewProps,\n                    })\n                    : null;\n            const padC = new Point2dPickerController(doc, {\n                baseSteps: [config.axes[0].baseStep, config.axes[1].baseStep],\n                invertsY: config.invertsY,\n                layout: config.pickerLayout,\n                maxValue: config.maxValue,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            padC.view.allFocusableElements.forEach((elem) => {\n                elem.addEventListener('blur', this.onPopupChildBlur_);\n                elem.addEventListener('keydown', this.onPopupChildKeydown_);\n            });\n            this.pickerC_ = padC;\n            this.textC_ = new PointNdTextController(doc, {\n                assembly: Point2dAssembly,\n                axes: config.axes,\n                parser: config.parser,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view = new Point2dView(doc, {\n                expanded: this.foldable_.value('expanded'),\n                pickerLayout: config.pickerLayout,\n                viewProps: this.viewProps,\n            });\n            this.view.textElement.appendChild(this.textC_.view.element);\n            (_a = this.view.buttonElement) === null || _a === void 0 ? void 0 : _a.addEventListener('blur', this.onPadButtonBlur_);\n            (_b = this.view.buttonElement) === null || _b === void 0 ? void 0 : _b.addEventListener('click', this.onPadButtonClick_);\n            if (this.popC_) {\n                this.view.element.appendChild(this.popC_.view.element);\n                this.popC_.view.element.appendChild(this.pickerC_.view.element);\n                connectValues({\n                    primary: this.foldable_.value('expanded'),\n                    secondary: this.popC_.shows,\n                    forward: (p) => p.rawValue,\n                    backward: (_, s) => s.rawValue,\n                });\n            }\n            else if (this.view.pickerElement) {\n                this.view.pickerElement.appendChild(this.pickerC_.view.element);\n                bindFoldable(this.foldable_, this.view.pickerElement);\n            }\n        }\n        onPadButtonBlur_(e) {\n            if (!this.popC_) {\n                return;\n            }\n            const elem = this.view.element;\n            const nextTarget = forceCast(e.relatedTarget);\n            if (!nextTarget || !elem.contains(nextTarget)) {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        onPadButtonClick_() {\n            this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n            if (this.foldable_.get('expanded')) {\n                this.pickerC_.view.allFocusableElements[0].focus();\n            }\n        }\n        onPopupChildBlur_(ev) {\n            if (!this.popC_) {\n                return;\n            }\n            const elem = this.popC_.view.element;\n            const nextTarget = findNextTarget(ev);\n            if (nextTarget && elem.contains(nextTarget)) {\n                return;\n            }\n            if (nextTarget &&\n                nextTarget === this.view.buttonElement &&\n                !supportsTouch(elem.ownerDocument)) {\n                return;\n            }\n            this.popC_.shows.rawValue = false;\n        }\n        onPopupChildKeydown_(ev) {\n            if (this.popC_) {\n                if (ev.key === 'Escape') {\n                    this.popC_.shows.rawValue = false;\n                }\n            }\n            else if (this.view.pickerElement) {\n                if (ev.key === 'Escape') {\n                    this.view.buttonElement.focus();\n                }\n            }\n        }\n    }\n\n    class Point3d {\n        constructor(x = 0, y = 0, z = 0) {\n            this.x = x;\n            this.y = y;\n            this.z = z;\n        }\n        getComponents() {\n            return [this.x, this.y, this.z];\n        }\n        static isObject(obj) {\n            if (isEmpty(obj)) {\n                return false;\n            }\n            const x = obj.x;\n            const y = obj.y;\n            const z = obj.z;\n            if (typeof x !== 'number' ||\n                typeof y !== 'number' ||\n                typeof z !== 'number') {\n                return false;\n            }\n            return true;\n        }\n        static equals(v1, v2) {\n            return v1.x === v2.x && v1.y === v2.y && v1.z === v2.z;\n        }\n        toObject() {\n            return {\n                x: this.x,\n                y: this.y,\n                z: this.z,\n            };\n        }\n    }\n    const Point3dAssembly = {\n        toComponents: (p) => p.getComponents(),\n        fromComponents: (comps) => new Point3d(...comps),\n    };\n\n    function point3dFromUnknown(value) {\n        return Point3d.isObject(value)\n            ? new Point3d(value.x, value.y, value.z)\n            : new Point3d();\n    }\n    function writePoint3d(target, value) {\n        target.writeProperty('x', value.x);\n        target.writeProperty('y', value.y);\n        target.writeProperty('z', value.z);\n    }\n\n    function createConstraint$3(params, initialValue) {\n        return new PointNdConstraint({\n            assembly: Point3dAssembly,\n            components: [\n                createDimensionConstraint('x' in params ? params.x : undefined, initialValue.x),\n                createDimensionConstraint('y' in params ? params.y : undefined, initialValue.y),\n                createDimensionConstraint('z' in params ? params.z : undefined, initialValue.z),\n            ],\n        });\n    }\n    function createAxis$2(initialValue, constraint) {\n        return {\n            baseStep: getBaseStep(constraint),\n            constraint: constraint,\n            textProps: ValueMap.fromObject({\n                draggingScale: getSuitableDraggingScale(constraint, initialValue),\n                formatter: createNumberFormatter(getSuitableDecimalDigits(constraint, initialValue)),\n            }),\n        };\n    }\n    const Point3dInputPlugin = {\n        id: 'input-point3d',\n        type: 'input',\n        accept: (value, params) => {\n            if (!Point3d.isObject(value)) {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                x: p.optional.custom(parsePointDimensionParams),\n                y: p.optional.custom(parsePointDimensionParams),\n                z: p.optional.custom(parsePointDimensionParams),\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => point3dFromUnknown,\n            constraint: (args) => createConstraint$3(args.params, args.initialValue),\n            equals: Point3d.equals,\n            writer: (_args) => writePoint3d,\n        },\n        controller: (args) => {\n            const value = args.value;\n            const c = args.constraint;\n            if (!(c instanceof PointNdConstraint)) {\n                throw TpError.shouldNeverHappen();\n            }\n            return new PointNdTextController(args.document, {\n                assembly: Point3dAssembly,\n                axes: [\n                    createAxis$2(value.rawValue.x, c.components[0]),\n                    createAxis$2(value.rawValue.y, c.components[1]),\n                    createAxis$2(value.rawValue.z, c.components[2]),\n                ],\n                parser: parseNumber,\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    class Point4d {\n        constructor(x = 0, y = 0, z = 0, w = 0) {\n            this.x = x;\n            this.y = y;\n            this.z = z;\n            this.w = w;\n        }\n        getComponents() {\n            return [this.x, this.y, this.z, this.w];\n        }\n        static isObject(obj) {\n            if (isEmpty(obj)) {\n                return false;\n            }\n            const x = obj.x;\n            const y = obj.y;\n            const z = obj.z;\n            const w = obj.w;\n            if (typeof x !== 'number' ||\n                typeof y !== 'number' ||\n                typeof z !== 'number' ||\n                typeof w !== 'number') {\n                return false;\n            }\n            return true;\n        }\n        static equals(v1, v2) {\n            return v1.x === v2.x && v1.y === v2.y && v1.z === v2.z && v1.w === v2.w;\n        }\n        toObject() {\n            return {\n                x: this.x,\n                y: this.y,\n                z: this.z,\n                w: this.w,\n            };\n        }\n    }\n    const Point4dAssembly = {\n        toComponents: (p) => p.getComponents(),\n        fromComponents: (comps) => new Point4d(...comps),\n    };\n\n    function point4dFromUnknown(value) {\n        return Point4d.isObject(value)\n            ? new Point4d(value.x, value.y, value.z, value.w)\n            : new Point4d();\n    }\n    function writePoint4d(target, value) {\n        target.writeProperty('x', value.x);\n        target.writeProperty('y', value.y);\n        target.writeProperty('z', value.z);\n        target.writeProperty('w', value.w);\n    }\n\n    function createConstraint$2(params, initialValue) {\n        return new PointNdConstraint({\n            assembly: Point4dAssembly,\n            components: [\n                createDimensionConstraint('x' in params ? params.x : undefined, initialValue.x),\n                createDimensionConstraint('y' in params ? params.y : undefined, initialValue.y),\n                createDimensionConstraint('z' in params ? params.z : undefined, initialValue.z),\n                createDimensionConstraint('w' in params ? params.w : undefined, initialValue.w),\n            ],\n        });\n    }\n    function createAxis$1(initialValue, constraint) {\n        return {\n            baseStep: getBaseStep(constraint),\n            constraint: constraint,\n            textProps: ValueMap.fromObject({\n                draggingScale: getSuitableDraggingScale(constraint, initialValue),\n                formatter: createNumberFormatter(getSuitableDecimalDigits(constraint, initialValue)),\n            }),\n        };\n    }\n    const Point4dInputPlugin = {\n        id: 'input-point4d',\n        type: 'input',\n        accept: (value, params) => {\n            if (!Point4d.isObject(value)) {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                x: p.optional.custom(parsePointDimensionParams),\n                y: p.optional.custom(parsePointDimensionParams),\n                z: p.optional.custom(parsePointDimensionParams),\n                w: p.optional.custom(parsePointDimensionParams),\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => point4dFromUnknown,\n            constraint: (args) => createConstraint$2(args.params, args.initialValue),\n            equals: Point4d.equals,\n            writer: (_args) => writePoint4d,\n        },\n        controller: (args) => {\n            const value = args.value;\n            const c = args.constraint;\n            if (!(c instanceof PointNdConstraint)) {\n                throw TpError.shouldNeverHappen();\n            }\n            return new PointNdTextController(args.document, {\n                assembly: Point4dAssembly,\n                axes: value.rawValue\n                    .getComponents()\n                    .map((comp, index) => createAxis$1(comp, c.components[index])),\n                parser: parseNumber,\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    function createConstraint$1(params) {\n        const constraints = [];\n        const lc = createListConstraint(params.options);\n        if (lc) {\n            constraints.push(lc);\n        }\n        return new CompositeConstraint(constraints);\n    }\n    const StringInputPlugin = {\n        id: 'input-string',\n        type: 'input',\n        accept: (value, params) => {\n            if (typeof value !== 'string') {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                options: p.optional.custom(parseListOptions),\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => stringFromUnknown,\n            constraint: (args) => createConstraint$1(args.params),\n            writer: (_args) => writePrimitive,\n        },\n        controller: (args) => {\n            const doc = args.document;\n            const value = args.value;\n            const c = args.constraint;\n            const lc = c && findConstraint(c, ListConstraint);\n            if (lc) {\n                return new ListController(doc, {\n                    props: new ValueMap({\n                        options: lc.values.value('options'),\n                    }),\n                    value: value,\n                    viewProps: args.viewProps,\n                });\n            }\n            return new TextController(doc, {\n                parser: (v) => v,\n                props: ValueMap.fromObject({\n                    formatter: formatString,\n                }),\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    const Constants = {\n        monitor: {\n            defaultInterval: 200,\n            defaultLineCount: 3,\n        },\n    };\n\n    const className$2 = ClassName('mll');\n    class MultiLogView {\n        constructor(doc, config) {\n            this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n            this.formatter_ = config.formatter;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$2());\n            config.viewProps.bindClassModifiers(this.element);\n            const textareaElem = doc.createElement('textarea');\n            textareaElem.classList.add(className$2('i'));\n            textareaElem.style.height = `calc(var(--bld-us) * ${config.lineCount})`;\n            textareaElem.readOnly = true;\n            config.viewProps.bindDisabled(textareaElem);\n            this.element.appendChild(textareaElem);\n            this.textareaElem_ = textareaElem;\n            config.value.emitter.on('change', this.onValueUpdate_);\n            this.value = config.value;\n            this.update_();\n        }\n        update_() {\n            const elem = this.textareaElem_;\n            const shouldScroll = elem.scrollTop === elem.scrollHeight - elem.clientHeight;\n            const lines = [];\n            this.value.rawValue.forEach((value) => {\n                if (value !== undefined) {\n                    lines.push(this.formatter_(value));\n                }\n            });\n            elem.textContent = lines.join('\\n');\n            if (shouldScroll) {\n                elem.scrollTop = elem.scrollHeight;\n            }\n        }\n        onValueUpdate_() {\n            this.update_();\n        }\n    }\n\n    class MultiLogController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new MultiLogView(doc, {\n                formatter: config.formatter,\n                lineCount: config.lineCount,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n        }\n    }\n\n    const className$1 = ClassName('sgl');\n    class SingleLogView {\n        constructor(doc, config) {\n            this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n            this.formatter_ = config.formatter;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$1());\n            config.viewProps.bindClassModifiers(this.element);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className$1('i'));\n            inputElem.readOnly = true;\n            inputElem.type = 'text';\n            config.viewProps.bindDisabled(inputElem);\n            this.element.appendChild(inputElem);\n            this.inputElement = inputElem;\n            config.value.emitter.on('change', this.onValueUpdate_);\n            this.value = config.value;\n            this.update_();\n        }\n        update_() {\n            const values = this.value.rawValue;\n            const lastValue = values[values.length - 1];\n            this.inputElement.value =\n                lastValue !== undefined ? this.formatter_(lastValue) : '';\n        }\n        onValueUpdate_() {\n            this.update_();\n        }\n    }\n\n    class SingleLogController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new SingleLogView(doc, {\n                formatter: config.formatter,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n        }\n    }\n\n    const BooleanMonitorPlugin = {\n        id: 'monitor-bool',\n        type: 'monitor',\n        accept: (value, params) => {\n            if (typeof value !== 'boolean') {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                lineCount: p.optional.number,\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => boolFromUnknown,\n        },\n        controller: (args) => {\n            var _a;\n            if (args.value.rawValue.length === 1) {\n                return new SingleLogController(args.document, {\n                    formatter: BooleanFormatter,\n                    value: args.value,\n                    viewProps: args.viewProps,\n                });\n            }\n            return new MultiLogController(args.document, {\n                formatter: BooleanFormatter,\n                lineCount: (_a = args.params.lineCount) !== null && _a !== void 0 ? _a : Constants.monitor.defaultLineCount,\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    const className = ClassName('grl');\n    class GraphLogView {\n        constructor(doc, config) {\n            this.onCursorChange_ = this.onCursorChange_.bind(this);\n            this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className());\n            config.viewProps.bindClassModifiers(this.element);\n            this.formatter_ = config.formatter;\n            this.props_ = config.props;\n            this.cursor_ = config.cursor;\n            this.cursor_.emitter.on('change', this.onCursorChange_);\n            const svgElem = doc.createElementNS(SVG_NS, 'svg');\n            svgElem.classList.add(className('g'));\n            svgElem.style.height = `calc(var(--bld-us) * ${config.lineCount})`;\n            this.element.appendChild(svgElem);\n            this.svgElem_ = svgElem;\n            const lineElem = doc.createElementNS(SVG_NS, 'polyline');\n            this.svgElem_.appendChild(lineElem);\n            this.lineElem_ = lineElem;\n            const tooltipElem = doc.createElement('div');\n            tooltipElem.classList.add(className('t'), ClassName('tt')());\n            this.element.appendChild(tooltipElem);\n            this.tooltipElem_ = tooltipElem;\n            config.value.emitter.on('change', this.onValueUpdate_);\n            this.value = config.value;\n            this.update_();\n        }\n        get graphElement() {\n            return this.svgElem_;\n        }\n        update_() {\n            const bounds = this.svgElem_.getBoundingClientRect();\n            const maxIndex = this.value.rawValue.length - 1;\n            const min = this.props_.get('minValue');\n            const max = this.props_.get('maxValue');\n            const points = [];\n            this.value.rawValue.forEach((v, index) => {\n                if (v === undefined) {\n                    return;\n                }\n                const x = mapRange(index, 0, maxIndex, 0, bounds.width);\n                const y = mapRange(v, min, max, bounds.height, 0);\n                points.push([x, y].join(','));\n            });\n            this.lineElem_.setAttributeNS(null, 'points', points.join(' '));\n            const tooltipElem = this.tooltipElem_;\n            const value = this.value.rawValue[this.cursor_.rawValue];\n            if (value === undefined) {\n                tooltipElem.classList.remove(className('t', 'a'));\n                return;\n            }\n            const tx = mapRange(this.cursor_.rawValue, 0, maxIndex, 0, bounds.width);\n            const ty = mapRange(value, min, max, bounds.height, 0);\n            tooltipElem.style.left = `${tx}px`;\n            tooltipElem.style.top = `${ty}px`;\n            tooltipElem.textContent = `${this.formatter_(value)}`;\n            if (!tooltipElem.classList.contains(className('t', 'a'))) {\n                tooltipElem.classList.add(className('t', 'a'), className('t', 'in'));\n                forceReflow(tooltipElem);\n                tooltipElem.classList.remove(className('t', 'in'));\n            }\n        }\n        onValueUpdate_() {\n            this.update_();\n        }\n        onCursorChange_() {\n            this.update_();\n        }\n    }\n\n    class GraphLogController {\n        constructor(doc, config) {\n            this.onGraphMouseMove_ = this.onGraphMouseMove_.bind(this);\n            this.onGraphMouseLeave_ = this.onGraphMouseLeave_.bind(this);\n            this.onGraphPointerDown_ = this.onGraphPointerDown_.bind(this);\n            this.onGraphPointerMove_ = this.onGraphPointerMove_.bind(this);\n            this.onGraphPointerUp_ = this.onGraphPointerUp_.bind(this);\n            this.props_ = config.props;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.cursor_ = createValue(-1);\n            this.view = new GraphLogView(doc, {\n                cursor: this.cursor_,\n                formatter: config.formatter,\n                lineCount: config.lineCount,\n                props: this.props_,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            if (!supportsTouch(doc)) {\n                this.view.element.addEventListener('mousemove', this.onGraphMouseMove_);\n                this.view.element.addEventListener('mouseleave', this.onGraphMouseLeave_);\n            }\n            else {\n                const ph = new PointerHandler(this.view.element);\n                ph.emitter.on('down', this.onGraphPointerDown_);\n                ph.emitter.on('move', this.onGraphPointerMove_);\n                ph.emitter.on('up', this.onGraphPointerUp_);\n            }\n        }\n        onGraphMouseLeave_() {\n            this.cursor_.rawValue = -1;\n        }\n        onGraphMouseMove_(ev) {\n            const bounds = this.view.element.getBoundingClientRect();\n            this.cursor_.rawValue = Math.floor(mapRange(ev.offsetX, 0, bounds.width, 0, this.value.rawValue.length));\n        }\n        onGraphPointerDown_(ev) {\n            this.onGraphPointerMove_(ev);\n        }\n        onGraphPointerMove_(ev) {\n            if (!ev.data.point) {\n                this.cursor_.rawValue = -1;\n                return;\n            }\n            this.cursor_.rawValue = Math.floor(mapRange(ev.data.point.x, 0, ev.data.bounds.width, 0, this.value.rawValue.length));\n        }\n        onGraphPointerUp_() {\n            this.cursor_.rawValue = -1;\n        }\n    }\n\n    function createFormatter(params) {\n        return 'format' in params && !isEmpty(params.format)\n            ? params.format\n            : createNumberFormatter(2);\n    }\n    function createTextMonitor(args) {\n        var _a;\n        if (args.value.rawValue.length === 1) {\n            return new SingleLogController(args.document, {\n                formatter: createFormatter(args.params),\n                value: args.value,\n                viewProps: args.viewProps,\n            });\n        }\n        return new MultiLogController(args.document, {\n            formatter: createFormatter(args.params),\n            lineCount: (_a = args.params.lineCount) !== null && _a !== void 0 ? _a : Constants.monitor.defaultLineCount,\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    }\n    function createGraphMonitor(args) {\n        var _a, _b, _c;\n        return new GraphLogController(args.document, {\n            formatter: createFormatter(args.params),\n            lineCount: (_a = args.params.lineCount) !== null && _a !== void 0 ? _a : Constants.monitor.defaultLineCount,\n            props: ValueMap.fromObject({\n                maxValue: (_b = ('max' in args.params ? args.params.max : null)) !== null && _b !== void 0 ? _b : 100,\n                minValue: (_c = ('min' in args.params ? args.params.min : null)) !== null && _c !== void 0 ? _c : 0,\n            }),\n            value: args.value,\n            viewProps: args.viewProps,\n        });\n    }\n    function shouldShowGraph(params) {\n        return 'view' in params && params.view === 'graph';\n    }\n    const NumberMonitorPlugin = {\n        id: 'monitor-number',\n        type: 'monitor',\n        accept: (value, params) => {\n            if (typeof value !== 'number') {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                format: p.optional.function,\n                lineCount: p.optional.number,\n                max: p.optional.number,\n                min: p.optional.number,\n                view: p.optional.string,\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            defaultBufferSize: (params) => (shouldShowGraph(params) ? 64 : 1),\n            reader: (_args) => numberFromUnknown,\n        },\n        controller: (args) => {\n            if (shouldShowGraph(args.params)) {\n                return createGraphMonitor(args);\n            }\n            return createTextMonitor(args);\n        },\n    };\n\n    const StringMonitorPlugin = {\n        id: 'monitor-string',\n        type: 'monitor',\n        accept: (value, params) => {\n            if (typeof value !== 'string') {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                lineCount: p.optional.number,\n                multiline: p.optional.boolean,\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => stringFromUnknown,\n        },\n        controller: (args) => {\n            var _a;\n            const value = args.value;\n            const multiline = value.rawValue.length > 1 ||\n                ('multiline' in args.params && args.params.multiline);\n            if (multiline) {\n                return new MultiLogController(args.document, {\n                    formatter: formatString,\n                    lineCount: (_a = args.params.lineCount) !== null && _a !== void 0 ? _a : Constants.monitor.defaultLineCount,\n                    value: value,\n                    viewProps: args.viewProps,\n                });\n            }\n            return new SingleLogController(args.document, {\n                formatter: formatString,\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    function createInputBindingController(plugin, args) {\n        var _a;\n        const result = plugin.accept(args.target.read(), args.params);\n        if (isEmpty(result)) {\n            return null;\n        }\n        const p = ParamsParsers;\n        const valueArgs = {\n            target: args.target,\n            initialValue: result.initialValue,\n            params: result.params,\n        };\n        const reader = plugin.binding.reader(valueArgs);\n        const constraint = plugin.binding.constraint\n            ? plugin.binding.constraint(valueArgs)\n            : undefined;\n        const value = createValue(reader(result.initialValue), {\n            constraint: constraint,\n            equals: plugin.binding.equals,\n        });\n        const binding = new InputBinding({\n            reader: reader,\n            target: args.target,\n            value: value,\n            writer: plugin.binding.writer(valueArgs),\n        });\n        const disabled = p.optional.boolean(args.params.disabled).value;\n        const hidden = p.optional.boolean(args.params.hidden).value;\n        const controller = plugin.controller({\n            constraint: constraint,\n            document: args.document,\n            initialValue: result.initialValue,\n            params: result.params,\n            value: binding.value,\n            viewProps: ViewProps.create({\n                disabled: disabled,\n                hidden: hidden,\n            }),\n        });\n        return new InputBindingController(args.document, {\n            binding: binding,\n            blade: createBlade(),\n            props: ValueMap.fromObject({\n                label: 'label' in args.params\n                    ? (_a = p.optional.string(args.params.label).value) !== null && _a !== void 0 ? _a : null\n                    : args.target.key,\n            }),\n            valueController: controller,\n        });\n    }\n\n    function createTicker(document, interval) {\n        return interval === 0\n            ? new ManualTicker()\n            : new IntervalTicker(document, interval !== null && interval !== void 0 ? interval : Constants.monitor.defaultInterval);\n    }\n    function createMonitorBindingController(plugin, args) {\n        var _a, _b, _c;\n        const p = ParamsParsers;\n        const result = plugin.accept(args.target.read(), args.params);\n        if (isEmpty(result)) {\n            return null;\n        }\n        const bindingArgs = {\n            target: args.target,\n            initialValue: result.initialValue,\n            params: result.params,\n        };\n        const reader = plugin.binding.reader(bindingArgs);\n        const bufferSize = (_b = (_a = p.optional.number(args.params.bufferSize).value) !== null && _a !== void 0 ? _a : (plugin.binding.defaultBufferSize &&\n            plugin.binding.defaultBufferSize(result.params))) !== null && _b !== void 0 ? _b : 1;\n        const interval = p.optional.number(args.params.interval).value;\n        const binding = new MonitorBinding({\n            reader: reader,\n            target: args.target,\n            ticker: createTicker(args.document, interval),\n            value: initializeBuffer(bufferSize),\n        });\n        const disabled = p.optional.boolean(args.params.disabled).value;\n        const hidden = p.optional.boolean(args.params.hidden).value;\n        const controller = plugin.controller({\n            document: args.document,\n            params: result.params,\n            value: binding.value,\n            viewProps: ViewProps.create({\n                disabled: disabled,\n                hidden: hidden,\n            }),\n        });\n        return new MonitorBindingController(args.document, {\n            binding: binding,\n            blade: createBlade(),\n            props: ValueMap.fromObject({\n                label: 'label' in args.params\n                    ? (_c = p.optional.string(args.params.label).value) !== null && _c !== void 0 ? _c : null\n                    : args.target.key,\n            }),\n            valueController: controller,\n        });\n    }\n\n    class PluginPool {\n        constructor() {\n            this.pluginsMap_ = {\n                blades: [],\n                inputs: [],\n                monitors: [],\n            };\n        }\n        getAll() {\n            return [\n                ...this.pluginsMap_.blades,\n                ...this.pluginsMap_.inputs,\n                ...this.pluginsMap_.monitors,\n            ];\n        }\n        register(r) {\n            if (r.type === 'blade') {\n                this.pluginsMap_.blades.unshift(r);\n            }\n            else if (r.type === 'input') {\n                this.pluginsMap_.inputs.unshift(r);\n            }\n            else if (r.type === 'monitor') {\n                this.pluginsMap_.monitors.unshift(r);\n            }\n        }\n        createInput(document, target, params) {\n            const initialValue = target.read();\n            if (isEmpty(initialValue)) {\n                throw new TpError({\n                    context: {\n                        key: target.key,\n                    },\n                    type: 'nomatchingcontroller',\n                });\n            }\n            const bc = this.pluginsMap_.inputs.reduce((result, plugin) => result !== null && result !== void 0 ? result : createInputBindingController(plugin, {\n                document: document,\n                target: target,\n                params: params,\n            }), null);\n            if (bc) {\n                return bc;\n            }\n            throw new TpError({\n                context: {\n                    key: target.key,\n                },\n                type: 'nomatchingcontroller',\n            });\n        }\n        createMonitor(document, target, params) {\n            const bc = this.pluginsMap_.monitors.reduce((result, plugin) => result !== null && result !== void 0 ? result : createMonitorBindingController(plugin, {\n                document: document,\n                params: params,\n                target: target,\n            }), null);\n            if (bc) {\n                return bc;\n            }\n            throw new TpError({\n                context: {\n                    key: target.key,\n                },\n                type: 'nomatchingcontroller',\n            });\n        }\n        createBlade(document, params) {\n            const bc = this.pluginsMap_.blades.reduce((result, plugin) => result !== null && result !== void 0 ? result : createBladeController(plugin, {\n                document: document,\n                params: params,\n            }), null);\n            if (!bc) {\n                throw new TpError({\n                    type: 'nomatchingview',\n                    context: {\n                        params: params,\n                    },\n                });\n            }\n            return bc;\n        }\n        createBladeApi(bc) {\n            if (bc instanceof InputBindingController) {\n                return new InputBindingApi(bc);\n            }\n            if (bc instanceof MonitorBindingController) {\n                return new MonitorBindingApi(bc);\n            }\n            if (bc instanceof RackController) {\n                return new RackApi(bc, this);\n            }\n            const api = this.pluginsMap_.blades.reduce((result, plugin) => result !== null && result !== void 0 ? result : plugin.api({\n                controller: bc,\n                pool: this,\n            }), null);\n            if (!api) {\n                throw TpError.shouldNeverHappen();\n            }\n            return api;\n        }\n    }\n\n    function createDefaultPluginPool() {\n        const pool = new PluginPool();\n        [\n            Point2dInputPlugin,\n            Point3dInputPlugin,\n            Point4dInputPlugin,\n            StringInputPlugin,\n            NumberInputPlugin,\n            StringColorInputPlugin,\n            ObjectColorInputPlugin,\n            NumberColorInputPlugin,\n            BooleanInputPlugin,\n            BooleanMonitorPlugin,\n            StringMonitorPlugin,\n            NumberMonitorPlugin,\n            ButtonBladePlugin,\n            FolderBladePlugin,\n            SeparatorBladePlugin,\n            TabBladePlugin,\n        ].forEach((p) => {\n            pool.register(p);\n        });\n        return pool;\n    }\n\n    function point2dFromUnknown(value) {\n        return Point2d.isObject(value)\n            ? new Point2d(value.x, value.y)\n            : new Point2d();\n    }\n    function writePoint2d(target, value) {\n        target.writeProperty('x', value.x);\n        target.writeProperty('y', value.y);\n    }\n\n    function createDimensionConstraint(params, initialValue) {\n        if (!params) {\n            return undefined;\n        }\n        const constraints = [];\n        const cs = createStepConstraint(params, initialValue);\n        if (cs) {\n            constraints.push(cs);\n        }\n        const rs = createRangeConstraint(params);\n        if (rs) {\n            constraints.push(rs);\n        }\n        return new CompositeConstraint(constraints);\n    }\n    function createConstraint(params, initialValue) {\n        return new PointNdConstraint({\n            assembly: Point2dAssembly,\n            components: [\n                createDimensionConstraint('x' in params ? params.x : undefined, initialValue.x),\n                createDimensionConstraint('y' in params ? params.y : undefined, initialValue.y),\n            ],\n        });\n    }\n    function getSuitableMaxDimensionValue(constraint, rawValue) {\n        const [min, max] = constraint ? findNumberRange(constraint) : [];\n        if (!isEmpty(min) || !isEmpty(max)) {\n            return Math.max(Math.abs(min !== null && min !== void 0 ? min : 0), Math.abs(max !== null && max !== void 0 ? max : 0));\n        }\n        const step = getBaseStep(constraint);\n        return Math.max(Math.abs(step) * 10, Math.abs(rawValue) * 10);\n    }\n    function getSuitableMaxValue(initialValue, constraint) {\n        const xc = constraint instanceof PointNdConstraint\n            ? constraint.components[0]\n            : undefined;\n        const yc = constraint instanceof PointNdConstraint\n            ? constraint.components[1]\n            : undefined;\n        const xr = getSuitableMaxDimensionValue(xc, initialValue.x);\n        const yr = getSuitableMaxDimensionValue(yc, initialValue.y);\n        return Math.max(xr, yr);\n    }\n    function createAxis(initialValue, constraint) {\n        return {\n            baseStep: getBaseStep(constraint),\n            constraint: constraint,\n            textProps: ValueMap.fromObject({\n                draggingScale: getSuitableDraggingScale(constraint, initialValue),\n                formatter: createNumberFormatter(getSuitableDecimalDigits(constraint, initialValue)),\n            }),\n        };\n    }\n    function shouldInvertY(params) {\n        if (!('y' in params)) {\n            return false;\n        }\n        const yParams = params.y;\n        if (!yParams) {\n            return false;\n        }\n        return 'inverted' in yParams ? !!yParams.inverted : false;\n    }\n    const Point2dInputPlugin = {\n        id: 'input-point2d',\n        type: 'input',\n        accept: (value, params) => {\n            if (!Point2d.isObject(value)) {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                expanded: p.optional.boolean,\n                picker: p.optional.custom(parsePickerLayout),\n                x: p.optional.custom(parsePointDimensionParams),\n                y: p.optional.object({\n                    inverted: p.optional.boolean,\n                    max: p.optional.number,\n                    min: p.optional.number,\n                    step: p.optional.number,\n                }),\n            });\n            return result\n                ? {\n                    initialValue: value,\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => point2dFromUnknown,\n            constraint: (args) => createConstraint(args.params, args.initialValue),\n            equals: Point2d.equals,\n            writer: (_args) => writePoint2d,\n        },\n        controller: (args) => {\n            const doc = args.document;\n            const value = args.value;\n            const c = args.constraint;\n            if (!(c instanceof PointNdConstraint)) {\n                throw TpError.shouldNeverHappen();\n            }\n            const expanded = 'expanded' in args.params ? args.params.expanded : undefined;\n            const picker = 'picker' in args.params ? args.params.picker : undefined;\n            return new Point2dController(doc, {\n                axes: [\n                    createAxis(value.rawValue.x, c.components[0]),\n                    createAxis(value.rawValue.y, c.components[1]),\n                ],\n                expanded: expanded !== null && expanded !== void 0 ? expanded : false,\n                invertsY: shouldInvertY(args.params),\n                maxValue: getSuitableMaxValue(value.rawValue, c),\n                parser: parseNumber,\n                pickerLayout: picker !== null && picker !== void 0 ? picker : 'popup',\n                value: value,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    class ListApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.emitter_ = new Emitter();\n            this.controller_.valueController.value.emitter.on('change', (ev) => {\n                this.emitter_.emit('change', {\n                    event: new TpChangeEvent(this, ev.rawValue),\n                });\n            });\n        }\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        get options() {\n            return this.controller_.valueController.props.get('options');\n        }\n        set options(options) {\n            this.controller_.valueController.props.set('options', options);\n        }\n        get value() {\n            return this.controller_.valueController.value.rawValue;\n        }\n        set value(value) {\n            this.controller_.valueController.value.rawValue = value;\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n    }\n\n    class SliderApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.emitter_ = new Emitter();\n            this.controller_.valueController.value.emitter.on('change', (ev) => {\n                this.emitter_.emit('change', {\n                    event: new TpChangeEvent(this, ev.rawValue),\n                });\n            });\n        }\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        get maxValue() {\n            return this.controller_.valueController.sliderController.props.get('maxValue');\n        }\n        set maxValue(maxValue) {\n            this.controller_.valueController.sliderController.props.set('maxValue', maxValue);\n        }\n        get minValue() {\n            return this.controller_.valueController.sliderController.props.get('minValue');\n        }\n        set minValue(minValue) {\n            this.controller_.valueController.sliderController.props.set('minValue', minValue);\n        }\n        get value() {\n            return this.controller_.valueController.value.rawValue;\n        }\n        set value(value) {\n            this.controller_.valueController.value.rawValue = value;\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n    }\n\n    class TextApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.emitter_ = new Emitter();\n            this.controller_.valueController.value.emitter.on('change', (ev) => {\n                this.emitter_.emit('change', {\n                    event: new TpChangeEvent(this, ev.rawValue),\n                });\n            });\n        }\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        get formatter() {\n            return this.controller_.valueController.props.get('formatter');\n        }\n        set formatter(formatter) {\n            this.controller_.valueController.props.set('formatter', formatter);\n        }\n        get value() {\n            return this.controller_.valueController.value.rawValue;\n        }\n        set value(value) {\n            this.controller_.valueController.value.rawValue = value;\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n    }\n\n    const ListBladePlugin = (function () {\n        return {\n            id: 'list',\n            type: 'blade',\n            accept(params) {\n                const p = ParamsParsers;\n                const result = parseParams(params, {\n                    options: p.required.custom(parseListOptions),\n                    value: p.required.raw,\n                    view: p.required.constant('list'),\n                    label: p.optional.string,\n                });\n                return result ? { params: result } : null;\n            },\n            controller(args) {\n                const lc = new ListConstraint(normalizeListOptions(args.params.options));\n                const value = createValue(args.params.value, {\n                    constraint: lc,\n                });\n                const ic = new ListController(args.document, {\n                    props: new ValueMap({\n                        options: lc.values.value('options'),\n                    }),\n                    value: value,\n                    viewProps: args.viewProps,\n                });\n                return new LabeledValueController(args.document, {\n                    blade: args.blade,\n                    props: ValueMap.fromObject({\n                        label: args.params.label,\n                    }),\n                    valueController: ic,\n                });\n            },\n            api(args) {\n                if (!(args.controller instanceof LabeledValueController)) {\n                    return null;\n                }\n                if (!(args.controller.valueController instanceof ListController)) {\n                    return null;\n                }\n                return new ListApi(args.controller);\n            },\n        };\n    })();\n\n    /**\n     * @hidden\n     */\n    function exportPresetJson(targets) {\n        return targets.reduce((result, target) => {\n            return Object.assign(result, {\n                [target.presetKey]: target.read(),\n            });\n        }, {});\n    }\n    /**\n     * @hidden\n     */\n    function importPresetJson(bindings, preset) {\n        bindings.forEach((binding) => {\n            const value = preset[binding.target.presetKey];\n            if (value !== undefined) {\n                binding.writer(binding.target, binding.reader(value));\n            }\n        });\n    }\n\n    class RootApi extends FolderApi {\n        /**\n         * @hidden\n         */\n        constructor(controller, pool) {\n            super(controller, pool);\n        }\n        get element() {\n            return this.controller_.view.element;\n        }\n        /**\n         * Imports a preset of all inputs.\n         * @param preset The preset object to import.\n         */\n        importPreset(preset) {\n            const bindings = this.controller_.rackController.rack\n                .find(InputBindingController)\n                .map((ibc) => {\n                return ibc.binding;\n            });\n            importPresetJson(bindings, preset);\n            this.refresh();\n        }\n        /**\n         * Exports a preset of all inputs.\n         * @return An exported preset object.\n         */\n        exportPreset() {\n            const targets = this.controller_.rackController.rack\n                .find(InputBindingController)\n                .map((ibc) => {\n                return ibc.binding.target;\n            });\n            return exportPresetJson(targets);\n        }\n        /**\n         * Refreshes all bindings of the pane.\n         */\n        refresh() {\n            // Force-read all input bindings\n            this.controller_.rackController.rack\n                .find(InputBindingController)\n                .forEach((ibc) => {\n                ibc.binding.read();\n            });\n            // Force-read all monitor bindings\n            this.controller_.rackController.rack\n                .find(MonitorBindingController)\n                .forEach((mbc) => {\n                mbc.binding.read();\n            });\n        }\n    }\n\n    class RootController extends FolderController {\n        constructor(doc, config) {\n            super(doc, {\n                expanded: config.expanded,\n                blade: config.blade,\n                props: config.props,\n                root: true,\n                viewProps: config.viewProps,\n            });\n        }\n    }\n\n    const SliderBladePlugin = {\n        id: 'slider',\n        type: 'blade',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                max: p.required.number,\n                min: p.required.number,\n                view: p.required.constant('slider'),\n                format: p.optional.function,\n                label: p.optional.string,\n                value: p.optional.number,\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            var _a, _b;\n            const initialValue = (_a = args.params.value) !== null && _a !== void 0 ? _a : 0;\n            const drc = new DefiniteRangeConstraint({\n                max: args.params.max,\n                min: args.params.min,\n            });\n            const vc = new SliderTextController(args.document, {\n                baseStep: 1,\n                parser: parseNumber,\n                sliderProps: new ValueMap({\n                    maxValue: drc.values.value('max'),\n                    minValue: drc.values.value('min'),\n                }),\n                textProps: ValueMap.fromObject({\n                    draggingScale: getSuitableDraggingScale(undefined, initialValue),\n                    formatter: (_b = args.params.format) !== null && _b !== void 0 ? _b : numberToString,\n                }),\n                value: createValue(initialValue, {\n                    constraint: drc,\n                }),\n                viewProps: args.viewProps,\n            });\n            return new LabeledValueController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                valueController: vc,\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabeledValueController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof SliderTextController)) {\n                return null;\n            }\n            return new SliderApi(args.controller);\n        },\n    };\n\n    const TextBladePlugin = (function () {\n        return {\n            id: 'text',\n            type: 'blade',\n            accept(params) {\n                const p = ParamsParsers;\n                const result = parseParams(params, {\n                    parse: p.required.function,\n                    value: p.required.raw,\n                    view: p.required.constant('text'),\n                    format: p.optional.function,\n                    label: p.optional.string,\n                });\n                return result ? { params: result } : null;\n            },\n            controller(args) {\n                var _a;\n                const ic = new TextController(args.document, {\n                    parser: args.params.parse,\n                    props: ValueMap.fromObject({\n                        formatter: (_a = args.params.format) !== null && _a !== void 0 ? _a : ((v) => String(v)),\n                    }),\n                    value: createValue(args.params.value),\n                    viewProps: args.viewProps,\n                });\n                return new LabeledValueController(args.document, {\n                    blade: args.blade,\n                    props: ValueMap.fromObject({\n                        label: args.params.label,\n                    }),\n                    valueController: ic,\n                });\n            },\n            api(args) {\n                if (!(args.controller instanceof LabeledValueController)) {\n                    return null;\n                }\n                if (!(args.controller.valueController instanceof TextController)) {\n                    return null;\n                }\n                return new TextApi(args.controller);\n            },\n        };\n    })();\n\n    function createDefaultWrapperElement(doc) {\n        const elem = doc.createElement('div');\n        elem.classList.add(ClassName('dfw')());\n        if (doc.body) {\n            doc.body.appendChild(elem);\n        }\n        return elem;\n    }\n    function embedStyle(doc, id, css) {\n        if (doc.querySelector(`style[data-tp-style=${id}]`)) {\n            return;\n        }\n        const styleElem = doc.createElement('style');\n        styleElem.dataset.tpStyle = id;\n        styleElem.textContent = css;\n        doc.head.appendChild(styleElem);\n    }\n    /**\n     * The root pane of Tweakpane.\n     */\n    class Pane extends RootApi {\n        constructor(opt_config) {\n            var _a, _b;\n            const config = opt_config !== null && opt_config !== void 0 ? opt_config : {};\n            const doc = (_a = config.document) !== null && _a !== void 0 ? _a : getWindowDocument();\n            const pool = createDefaultPluginPool();\n            const rootController = new RootController(doc, {\n                expanded: config.expanded,\n                blade: createBlade(),\n                props: ValueMap.fromObject({\n                    title: config.title,\n                }),\n                viewProps: ViewProps.create(),\n            });\n            super(rootController, pool);\n            this.pool_ = pool;\n            this.containerElem_ = (_b = config.container) !== null && _b !== void 0 ? _b : createDefaultWrapperElement(doc);\n            this.containerElem_.appendChild(this.element);\n            this.doc_ = doc;\n            this.usesDefaultWrapper_ = !config.container;\n            this.setUpDefaultPlugins_();\n        }\n        get document() {\n            if (!this.doc_) {\n                throw TpError.alreadyDisposed();\n            }\n            return this.doc_;\n        }\n        dispose() {\n            const containerElem = this.containerElem_;\n            if (!containerElem) {\n                throw TpError.alreadyDisposed();\n            }\n            if (this.usesDefaultWrapper_) {\n                const parentElem = containerElem.parentElement;\n                if (parentElem) {\n                    parentElem.removeChild(containerElem);\n                }\n            }\n            this.containerElem_ = null;\n            this.doc_ = null;\n            super.dispose();\n        }\n        registerPlugin(bundle) {\n            const plugins = 'plugin' in bundle\n                ? [bundle.plugin]\n                : 'plugins' in bundle\n                    ? bundle.plugins\n                    : [];\n            plugins.forEach((p) => {\n                this.pool_.register(p);\n                this.embedPluginStyle_(p);\n            });\n        }\n        embedPluginStyle_(plugin) {\n            if (plugin.css) {\n                embedStyle(this.document, `plugin-${plugin.id}`, plugin.css);\n            }\n        }\n        setUpDefaultPlugins_() {\n            // NOTE: This string literal will be replaced with the default CSS by Rollup at the compilation time\n            embedStyle(this.document, 'default', '.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:\"\";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:\"\";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:\"\";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:\"\";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:\"\";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:\"\";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:\"\";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:\"\";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:\"\";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:\"\";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:\"\";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:\"\";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:\"\";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}');\n            this.pool_.getAll().forEach((plugin) => {\n                this.embedPluginStyle_(plugin);\n            });\n            this.registerPlugin({\n                plugins: [\n                    SliderBladePlugin,\n                    ListBladePlugin,\n                    TabBladePlugin,\n                    TextBladePlugin,\n                ],\n            });\n        }\n    }\n\n    const VERSION = new Semver('3.1.10');\n\n    exports.BladeApi = BladeApi;\n    exports.ButtonApi = ButtonApi;\n    exports.FolderApi = FolderApi;\n    exports.InputBindingApi = InputBindingApi;\n    exports.ListApi = ListApi;\n    exports.MonitorBindingApi = MonitorBindingApi;\n    exports.Pane = Pane;\n    exports.SeparatorApi = SeparatorApi;\n    exports.SliderApi = SliderApi;\n    exports.TabApi = TabApi;\n    exports.TabPageApi = TabPageApi;\n    exports.TextApi = TextApi;\n    exports.TpChangeEvent = TpChangeEvent;\n    exports.VERSION = VERSION;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n","(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.TweakpaneEssentialsPlugin = {}));\n})(this, (function (exports) { 'use strict';\n\n    class BladeApi {\n        constructor(controller) {\n            this.controller_ = controller;\n        }\n        get element() {\n            return this.controller_.view.element;\n        }\n        get disabled() {\n            return this.controller_.viewProps.get('disabled');\n        }\n        set disabled(disabled) {\n            this.controller_.viewProps.set('disabled', disabled);\n        }\n        get hidden() {\n            return this.controller_.viewProps.get('hidden');\n        }\n        set hidden(hidden) {\n            this.controller_.viewProps.set('hidden', hidden);\n        }\n        dispose() {\n            this.controller_.viewProps.set('disposed', true);\n        }\n    }\n\n    class TpEvent {\n        constructor(target) {\n            this.target = target;\n        }\n    }\n    class TpChangeEvent extends TpEvent {\n        constructor(target, value, presetKey, last) {\n            super(target);\n            this.value = value;\n            this.presetKey = presetKey;\n            this.last = last !== null && last !== void 0 ? last : true;\n        }\n    }\n\n    function forceCast(v) {\n        return v;\n    }\n    function isEmpty(value) {\n        return value === null || value === undefined;\n    }\n\n    const CREATE_MESSAGE_MAP = {\n        alreadydisposed: () => 'View has been already disposed',\n        invalidparams: (context) => `Invalid parameters for '${context.name}'`,\n        nomatchingcontroller: (context) => `No matching controller for '${context.key}'`,\n        nomatchingview: (context) => `No matching view for '${JSON.stringify(context.params)}'`,\n        notbindable: () => `Value is not bindable`,\n        propertynotfound: (context) => `Property '${context.name}' not found`,\n        shouldneverhappen: () => 'This error should never happen',\n    };\n    class TpError {\n        constructor(config) {\n            var _a;\n            this.message =\n                (_a = CREATE_MESSAGE_MAP[config.type](forceCast(config.context))) !== null && _a !== void 0 ? _a : 'Unexpected error';\n            this.name = this.constructor.name;\n            this.stack = new Error(this.message).stack;\n            this.type = config.type;\n        }\n        static alreadyDisposed() {\n            return new TpError({ type: 'alreadydisposed' });\n        }\n        static notBindable() {\n            return new TpError({\n                type: 'notbindable',\n            });\n        }\n        static propertyNotFound(name) {\n            return new TpError({\n                type: 'propertynotfound',\n                context: {\n                    name: name,\n                },\n            });\n        }\n        static shouldNeverHappen() {\n            return new TpError({ type: 'shouldneverhappen' });\n        }\n    }\n\n    class Emitter {\n        constructor() {\n            this.observers_ = {};\n        }\n        on(eventName, handler) {\n            let observers = this.observers_[eventName];\n            if (!observers) {\n                observers = this.observers_[eventName] = [];\n            }\n            observers.push({\n                handler: handler,\n            });\n            return this;\n        }\n        off(eventName, handler) {\n            const observers = this.observers_[eventName];\n            if (observers) {\n                this.observers_[eventName] = observers.filter((observer) => {\n                    return observer.handler !== handler;\n                });\n            }\n            return this;\n        }\n        emit(eventName, event) {\n            const observers = this.observers_[eventName];\n            if (!observers) {\n                return;\n            }\n            observers.forEach((observer) => {\n                observer.handler(event);\n            });\n        }\n    }\n\n    const PREFIX = 'tp';\n    function ClassName(viewName) {\n        const fn = (opt_elementName, opt_modifier) => {\n            return [\n                PREFIX,\n                '-',\n                viewName,\n                'v',\n                opt_elementName ? `_${opt_elementName}` : '',\n                opt_modifier ? `-${opt_modifier}` : '',\n            ].join('');\n        };\n        return fn;\n    }\n\n    function compose$1(h1, h2) {\n        return (input) => h2(h1(input));\n    }\n    function extractValue(ev) {\n        return ev.rawValue;\n    }\n    function bindValue(value, applyValue) {\n        value.emitter.on('change', compose$1(extractValue, applyValue));\n        applyValue(value.rawValue);\n    }\n    function bindValueMap(valueMap, key, applyValue) {\n        bindValue(valueMap.value(key), applyValue);\n    }\n\n    function applyClass(elem, className, active) {\n        if (active) {\n            elem.classList.add(className);\n        }\n        else {\n            elem.classList.remove(className);\n        }\n    }\n    function valueToClassName(elem, className) {\n        return (value) => {\n            applyClass(elem, className, value);\n        };\n    }\n    function bindValueToTextContent(value, elem) {\n        bindValue(value, (text) => {\n            elem.textContent = text !== null && text !== void 0 ? text : '';\n        });\n    }\n\n    const className$g = ClassName('btn');\n    class ButtonView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$g());\n            config.viewProps.bindClassModifiers(this.element);\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(className$g('b'));\n            config.viewProps.bindDisabled(buttonElem);\n            this.element.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            const titleElem = doc.createElement('div');\n            titleElem.classList.add(className$g('t'));\n            bindValueToTextContent(config.props.value('title'), titleElem);\n            this.buttonElement.appendChild(titleElem);\n        }\n    }\n\n    class ButtonController {\n        constructor(doc, config) {\n            this.emitter = new Emitter();\n            this.onClick_ = this.onClick_.bind(this);\n            this.props = config.props;\n            this.viewProps = config.viewProps;\n            this.view = new ButtonView(doc, {\n                props: this.props,\n                viewProps: this.viewProps,\n            });\n            this.view.buttonElement.addEventListener('click', this.onClick_);\n        }\n        onClick_() {\n            this.emitter.emit('click', {\n                sender: this,\n            });\n        }\n    }\n\n    class BoundValue {\n        constructor(initialValue, config) {\n            var _a;\n            this.constraint_ = config === null || config === void 0 ? void 0 : config.constraint;\n            this.equals_ = (_a = config === null || config === void 0 ? void 0 : config.equals) !== null && _a !== void 0 ? _a : ((v1, v2) => v1 === v2);\n            this.emitter = new Emitter();\n            this.rawValue_ = initialValue;\n        }\n        get constraint() {\n            return this.constraint_;\n        }\n        get rawValue() {\n            return this.rawValue_;\n        }\n        set rawValue(rawValue) {\n            this.setRawValue(rawValue, {\n                forceEmit: false,\n                last: true,\n            });\n        }\n        setRawValue(rawValue, options) {\n            const opts = options !== null && options !== void 0 ? options : {\n                forceEmit: false,\n                last: true,\n            };\n            const constrainedValue = this.constraint_\n                ? this.constraint_.constrain(rawValue)\n                : rawValue;\n            const prevValue = this.rawValue_;\n            const changed = !this.equals_(prevValue, constrainedValue);\n            if (!changed && !opts.forceEmit) {\n                return;\n            }\n            this.emitter.emit('beforechange', {\n                sender: this,\n            });\n            this.rawValue_ = constrainedValue;\n            this.emitter.emit('change', {\n                options: opts,\n                previousRawValue: prevValue,\n                rawValue: constrainedValue,\n                sender: this,\n            });\n        }\n    }\n\n    class PrimitiveValue {\n        constructor(initialValue) {\n            this.emitter = new Emitter();\n            this.value_ = initialValue;\n        }\n        get rawValue() {\n            return this.value_;\n        }\n        set rawValue(value) {\n            this.setRawValue(value, {\n                forceEmit: false,\n                last: true,\n            });\n        }\n        setRawValue(value, options) {\n            const opts = options !== null && options !== void 0 ? options : {\n                forceEmit: false,\n                last: true,\n            };\n            const prevValue = this.value_;\n            if (prevValue === value && !opts.forceEmit) {\n                return;\n            }\n            this.emitter.emit('beforechange', {\n                sender: this,\n            });\n            this.value_ = value;\n            this.emitter.emit('change', {\n                options: opts,\n                previousRawValue: prevValue,\n                rawValue: this.value_,\n                sender: this,\n            });\n        }\n    }\n\n    function createValue(initialValue, config) {\n        const constraint = config === null || config === void 0 ? void 0 : config.constraint;\n        const equals = config === null || config === void 0 ? void 0 : config.equals;\n        if (!constraint && !equals) {\n            return new PrimitiveValue(initialValue);\n        }\n        return new BoundValue(initialValue, config);\n    }\n\n    class ValueMap {\n        constructor(valueMap) {\n            this.emitter = new Emitter();\n            this.valMap_ = valueMap;\n            for (const key in this.valMap_) {\n                const v = this.valMap_[key];\n                v.emitter.on('change', () => {\n                    this.emitter.emit('change', {\n                        key: key,\n                        sender: this,\n                    });\n                });\n            }\n        }\n        static createCore(initialValue) {\n            const keys = Object.keys(initialValue);\n            return keys.reduce((o, key) => {\n                return Object.assign(o, {\n                    [key]: createValue(initialValue[key]),\n                });\n            }, {});\n        }\n        static fromObject(initialValue) {\n            const core = this.createCore(initialValue);\n            return new ValueMap(core);\n        }\n        get(key) {\n            return this.valMap_[key].rawValue;\n        }\n        set(key, value) {\n            this.valMap_[key].rawValue = value;\n        }\n        value(key) {\n            return this.valMap_[key];\n        }\n    }\n\n    function parseObject(value, keyToParserMap) {\n        const keys = Object.keys(keyToParserMap);\n        const result = keys.reduce((tmp, key) => {\n            if (tmp === undefined) {\n                return undefined;\n            }\n            const parser = keyToParserMap[key];\n            const result = parser(value[key]);\n            return result.succeeded\n                ? Object.assign(Object.assign({}, tmp), { [key]: result.value }) : undefined;\n        }, {});\n        return forceCast(result);\n    }\n    function parseArray(value, parseItem) {\n        return value.reduce((tmp, item) => {\n            if (tmp === undefined) {\n                return undefined;\n            }\n            const result = parseItem(item);\n            if (!result.succeeded || result.value === undefined) {\n                return undefined;\n            }\n            return [...tmp, result.value];\n        }, []);\n    }\n    function isObject(value) {\n        if (value === null) {\n            return false;\n        }\n        return typeof value === 'object';\n    }\n    function createParamsParserBuilder(parse) {\n        return (optional) => (v) => {\n            if (!optional && v === undefined) {\n                return {\n                    succeeded: false,\n                    value: undefined,\n                };\n            }\n            if (optional && v === undefined) {\n                return {\n                    succeeded: true,\n                    value: undefined,\n                };\n            }\n            const result = parse(v);\n            return result !== undefined\n                ? {\n                    succeeded: true,\n                    value: result,\n                }\n                : {\n                    succeeded: false,\n                    value: undefined,\n                };\n        };\n    }\n    function createParamsParserBuilders(optional) {\n        return {\n            custom: (parse) => createParamsParserBuilder(parse)(optional),\n            boolean: createParamsParserBuilder((v) => typeof v === 'boolean' ? v : undefined)(optional),\n            number: createParamsParserBuilder((v) => typeof v === 'number' ? v : undefined)(optional),\n            string: createParamsParserBuilder((v) => typeof v === 'string' ? v : undefined)(optional),\n            function: createParamsParserBuilder((v) =>\n            typeof v === 'function' ? v : undefined)(optional),\n            constant: (value) => createParamsParserBuilder((v) => (v === value ? value : undefined))(optional),\n            raw: createParamsParserBuilder((v) => v)(optional),\n            object: (keyToParserMap) => createParamsParserBuilder((v) => {\n                if (!isObject(v)) {\n                    return undefined;\n                }\n                return parseObject(v, keyToParserMap);\n            })(optional),\n            array: (itemParser) => createParamsParserBuilder((v) => {\n                if (!Array.isArray(v)) {\n                    return undefined;\n                }\n                return parseArray(v, itemParser);\n            })(optional),\n        };\n    }\n    const ParamsParsers = {\n        optional: createParamsParserBuilders(true),\n        required: createParamsParserBuilders(false),\n    };\n    function parseParams(value, keyToParserMap) {\n        const result = ParamsParsers.required.object(keyToParserMap)(value);\n        return result.succeeded ? result.value : undefined;\n    }\n\n    function warnMissing(info) {\n        console.warn([\n            `Missing '${info.key}' of ${info.target} in ${info.place}.`,\n            'Please rebuild plugins with the latest core package.',\n        ].join(' '));\n    }\n\n    function disposeElement(elem) {\n        if (elem && elem.parentElement) {\n            elem.parentElement.removeChild(elem);\n        }\n        return null;\n    }\n\n    class ReadonlyValue {\n        constructor(value) {\n            this.value_ = value;\n        }\n        static create(value) {\n            return [\n                new ReadonlyValue(value),\n                (rawValue, options) => {\n                    value.setRawValue(rawValue, options);\n                },\n            ];\n        }\n        get emitter() {\n            return this.value_.emitter;\n        }\n        get rawValue() {\n            return this.value_.rawValue;\n        }\n    }\n\n    const className$f = ClassName('');\n    function valueToModifier(elem, modifier) {\n        return valueToClassName(elem, className$f(undefined, modifier));\n    }\n    class ViewProps extends ValueMap {\n        constructor(valueMap) {\n            var _a;\n            super(valueMap);\n            this.onDisabledChange_ = this.onDisabledChange_.bind(this);\n            this.onParentChange_ = this.onParentChange_.bind(this);\n            this.onParentGlobalDisabledChange_ =\n                this.onParentGlobalDisabledChange_.bind(this);\n            [this.globalDisabled_, this.setGlobalDisabled_] = ReadonlyValue.create(createValue(this.getGlobalDisabled_()));\n            this.value('disabled').emitter.on('change', this.onDisabledChange_);\n            this.value('parent').emitter.on('change', this.onParentChange_);\n            (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n        }\n        static create(opt_initialValue) {\n            var _a, _b, _c;\n            const initialValue = opt_initialValue !== null && opt_initialValue !== void 0 ? opt_initialValue : {};\n            return new ViewProps(ValueMap.createCore({\n                disabled: (_a = initialValue.disabled) !== null && _a !== void 0 ? _a : false,\n                disposed: false,\n                hidden: (_b = initialValue.hidden) !== null && _b !== void 0 ? _b : false,\n                parent: (_c = initialValue.parent) !== null && _c !== void 0 ? _c : null,\n            }));\n        }\n        get globalDisabled() {\n            return this.globalDisabled_;\n        }\n        bindClassModifiers(elem) {\n            bindValue(this.globalDisabled_, valueToModifier(elem, 'disabled'));\n            bindValueMap(this, 'hidden', valueToModifier(elem, 'hidden'));\n        }\n        bindDisabled(target) {\n            bindValue(this.globalDisabled_, (disabled) => {\n                target.disabled = disabled;\n            });\n        }\n        bindTabIndex(elem) {\n            bindValue(this.globalDisabled_, (disabled) => {\n                elem.tabIndex = disabled ? -1 : 0;\n            });\n        }\n        handleDispose(callback) {\n            this.value('disposed').emitter.on('change', (disposed) => {\n                if (disposed) {\n                    callback();\n                }\n            });\n        }\n        getGlobalDisabled_() {\n            const parent = this.get('parent');\n            const parentDisabled = parent ? parent.globalDisabled.rawValue : false;\n            return parentDisabled || this.get('disabled');\n        }\n        updateGlobalDisabled_() {\n            this.setGlobalDisabled_(this.getGlobalDisabled_());\n        }\n        onDisabledChange_() {\n            this.updateGlobalDisabled_();\n        }\n        onParentGlobalDisabledChange_() {\n            this.updateGlobalDisabled_();\n        }\n        onParentChange_(ev) {\n            var _a;\n            const prevParent = ev.previousRawValue;\n            prevParent === null || prevParent === void 0 ? void 0 : prevParent.globalDisabled.emitter.off('change', this.onParentGlobalDisabledChange_);\n            (_a = this.get('parent')) === null || _a === void 0 ? void 0 : _a.globalDisabled.emitter.on('change', this.onParentGlobalDisabledChange_);\n            this.updateGlobalDisabled_();\n        }\n    }\n\n    function getAllBladePositions() {\n        return ['veryfirst', 'first', 'last', 'verylast'];\n    }\n\n    const className$e = ClassName('');\n    const POS_TO_CLASS_NAME_MAP = {\n        veryfirst: 'vfst',\n        first: 'fst',\n        last: 'lst',\n        verylast: 'vlst',\n    };\n    class BladeController {\n        constructor(config) {\n            this.parent_ = null;\n            this.blade = config.blade;\n            this.view = config.view;\n            this.viewProps = config.viewProps;\n            const elem = this.view.element;\n            this.blade.value('positions').emitter.on('change', () => {\n                getAllBladePositions().forEach((pos) => {\n                    elem.classList.remove(className$e(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n                });\n                this.blade.get('positions').forEach((pos) => {\n                    elem.classList.add(className$e(undefined, POS_TO_CLASS_NAME_MAP[pos]));\n                });\n            });\n            this.viewProps.handleDispose(() => {\n                disposeElement(elem);\n            });\n        }\n        get parent() {\n            return this.parent_;\n        }\n        set parent(parent) {\n            this.parent_ = parent;\n            if (!('parent' in this.viewProps.valMap_)) {\n                warnMissing({\n                    key: 'parent',\n                    target: ViewProps.name,\n                    place: 'BladeController.parent',\n                });\n                return;\n            }\n            this.viewProps.set('parent', this.parent_ ? this.parent_.viewProps : null);\n        }\n    }\n\n    const SVG_NS = 'http://www.w3.org/2000/svg';\n    function forceReflow(element) {\n        element.offsetHeight;\n    }\n    function disableTransitionTemporarily(element, callback) {\n        const t = element.style.transition;\n        element.style.transition = 'none';\n        callback();\n        element.style.transition = t;\n    }\n    function supportsTouch(doc) {\n        return doc.ontouchstart !== undefined;\n    }\n    function removeChildNodes(element) {\n        while (element.childNodes.length > 0) {\n            element.removeChild(element.childNodes[0]);\n        }\n    }\n    function findNextTarget(ev) {\n        if (ev.relatedTarget) {\n            return forceCast(ev.relatedTarget);\n        }\n        if ('explicitOriginalTarget' in ev) {\n            return ev.explicitOriginalTarget;\n        }\n        return null;\n    }\n\n    const className$d = ClassName('lbl');\n    function createLabelNode(doc, label) {\n        const frag = doc.createDocumentFragment();\n        const lineNodes = label.split('\\n').map((line) => {\n            return doc.createTextNode(line);\n        });\n        lineNodes.forEach((lineNode, index) => {\n            if (index > 0) {\n                frag.appendChild(doc.createElement('br'));\n            }\n            frag.appendChild(lineNode);\n        });\n        return frag;\n    }\n    class LabelView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$d());\n            config.viewProps.bindClassModifiers(this.element);\n            const labelElem = doc.createElement('div');\n            labelElem.classList.add(className$d('l'));\n            bindValueMap(config.props, 'label', (value) => {\n                if (isEmpty(value)) {\n                    this.element.classList.add(className$d(undefined, 'nol'));\n                }\n                else {\n                    this.element.classList.remove(className$d(undefined, 'nol'));\n                    removeChildNodes(labelElem);\n                    labelElem.appendChild(createLabelNode(doc, value));\n                }\n            });\n            this.element.appendChild(labelElem);\n            this.labelElement = labelElem;\n            const valueElem = doc.createElement('div');\n            valueElem.classList.add(className$d('v'));\n            this.element.appendChild(valueElem);\n            this.valueElement = valueElem;\n        }\n    }\n\n    class LabelController extends BladeController {\n        constructor(doc, config) {\n            const viewProps = config.valueController.viewProps;\n            super(Object.assign(Object.assign({}, config), { view: new LabelView(doc, {\n                    props: config.props,\n                    viewProps: viewProps,\n                }), viewProps: viewProps }));\n            this.props = config.props;\n            this.valueController = config.valueController;\n            this.view.valueElement.appendChild(this.valueController.view.element);\n        }\n    }\n\n    class ValueBladeController extends BladeController {\n        constructor(config) {\n            super(config);\n            this.value = config.value;\n        }\n    }\n\n    class Foldable extends ValueMap {\n        constructor(valueMap) {\n            super(valueMap);\n        }\n        static create(expanded) {\n            const coreObj = {\n                completed: true,\n                expanded: expanded,\n                expandedHeight: null,\n                shouldFixHeight: false,\n                temporaryExpanded: null,\n            };\n            const core = ValueMap.createCore(coreObj);\n            return new Foldable(core);\n        }\n        get styleExpanded() {\n            var _a;\n            return (_a = this.get('temporaryExpanded')) !== null && _a !== void 0 ? _a : this.get('expanded');\n        }\n        get styleHeight() {\n            if (!this.styleExpanded) {\n                return '0';\n            }\n            const exHeight = this.get('expandedHeight');\n            if (this.get('shouldFixHeight') && !isEmpty(exHeight)) {\n                return `${exHeight}px`;\n            }\n            return 'auto';\n        }\n        bindExpandedClass(elem, expandedClassName) {\n            const onExpand = () => {\n                const expanded = this.styleExpanded;\n                if (expanded) {\n                    elem.classList.add(expandedClassName);\n                }\n                else {\n                    elem.classList.remove(expandedClassName);\n                }\n            };\n            bindValueMap(this, 'expanded', onExpand);\n            bindValueMap(this, 'temporaryExpanded', onExpand);\n        }\n        cleanUpTransition() {\n            this.set('shouldFixHeight', false);\n            this.set('expandedHeight', null);\n            this.set('completed', true);\n        }\n    }\n    function createFoldable(expanded) {\n        return Foldable.create(expanded);\n    }\n    function computeExpandedFolderHeight(folder, containerElement) {\n        let height = 0;\n        disableTransitionTemporarily(containerElement, () => {\n            folder.set('expandedHeight', null);\n            folder.set('temporaryExpanded', true);\n            forceReflow(containerElement);\n            height = containerElement.clientHeight;\n            folder.set('temporaryExpanded', null);\n            forceReflow(containerElement);\n        });\n        return height;\n    }\n    function applyHeight(foldable, elem) {\n        elem.style.height = foldable.styleHeight;\n    }\n    function bindFoldable(foldable, elem) {\n        foldable.value('expanded').emitter.on('beforechange', () => {\n            foldable.set('completed', false);\n            if (isEmpty(foldable.get('expandedHeight'))) {\n                foldable.set('expandedHeight', computeExpandedFolderHeight(foldable, elem));\n            }\n            foldable.set('shouldFixHeight', true);\n            forceReflow(elem);\n        });\n        foldable.emitter.on('change', () => {\n            applyHeight(foldable, elem);\n        });\n        applyHeight(foldable, elem);\n        elem.addEventListener('transitionend', (ev) => {\n            if (ev.propertyName !== 'height') {\n                return;\n            }\n            foldable.cleanUpTransition();\n        });\n    }\n\n    class PlainView {\n        constructor(doc, config) {\n            const className = ClassName(config.viewName);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className());\n            config.viewProps.bindClassModifiers(this.element);\n        }\n    }\n\n    class LabeledValueController extends ValueBladeController {\n        constructor(doc, config) {\n            const viewProps = config.valueController.viewProps;\n            super(Object.assign(Object.assign({}, config), { value: config.valueController.value, view: new LabelView(doc, {\n                    props: config.props,\n                    viewProps: viewProps,\n                }), viewProps: viewProps }));\n            this.props = config.props;\n            this.valueController = config.valueController;\n            this.view.valueElement.appendChild(this.valueController.view.element);\n        }\n    }\n\n    class ManualTicker {\n        constructor() {\n            this.disabled = false;\n            this.emitter = new Emitter();\n        }\n        dispose() { }\n        tick() {\n            if (this.disabled) {\n                return;\n            }\n            this.emitter.emit('tick', {\n                sender: this,\n            });\n        }\n    }\n\n    class IntervalTicker {\n        constructor(doc, interval) {\n            this.disabled_ = false;\n            this.timerId_ = null;\n            this.onTick_ = this.onTick_.bind(this);\n            this.doc_ = doc;\n            this.emitter = new Emitter();\n            this.interval_ = interval;\n            this.setTimer_();\n        }\n        get disabled() {\n            return this.disabled_;\n        }\n        set disabled(inactive) {\n            this.disabled_ = inactive;\n            if (this.disabled_) {\n                this.clearTimer_();\n            }\n            else {\n                this.setTimer_();\n            }\n        }\n        dispose() {\n            this.clearTimer_();\n        }\n        clearTimer_() {\n            if (this.timerId_ === null) {\n                return;\n            }\n            const win = this.doc_.defaultView;\n            if (win) {\n                win.clearInterval(this.timerId_);\n            }\n            this.timerId_ = null;\n        }\n        setTimer_() {\n            this.clearTimer_();\n            if (this.interval_ <= 0) {\n                return;\n            }\n            const win = this.doc_.defaultView;\n            if (win) {\n                this.timerId_ = win.setInterval(this.onTick_, this.interval_);\n            }\n        }\n        onTick_() {\n            if (this.disabled_) {\n                return;\n            }\n            this.emitter.emit('tick', {\n                sender: this,\n            });\n        }\n    }\n\n    class CompositeConstraint {\n        constructor(constraints) {\n            this.constraints = constraints;\n        }\n        constrain(value) {\n            return this.constraints.reduce((result, c) => {\n                return c.constrain(result);\n            }, value);\n        }\n    }\n    function findConstraint(c, constraintClass) {\n        if (c instanceof constraintClass) {\n            return c;\n        }\n        if (c instanceof CompositeConstraint) {\n            const result = c.constraints.reduce((tmpResult, sc) => {\n                if (tmpResult) {\n                    return tmpResult;\n                }\n                return sc instanceof constraintClass ? sc : null;\n            }, null);\n            if (result) {\n                return result;\n            }\n        }\n        return null;\n    }\n\n    class DefiniteRangeConstraint {\n        constructor(config) {\n            this.values = ValueMap.fromObject({\n                max: config.max,\n                min: config.min,\n            });\n        }\n        constrain(value) {\n            const max = this.values.get('max');\n            const min = this.values.get('min');\n            return Math.min(Math.max(value, min), max);\n        }\n    }\n\n    class RangeConstraint {\n        constructor(config) {\n            this.values = ValueMap.fromObject({\n                max: config.max,\n                min: config.min,\n            });\n        }\n        get maxValue() {\n            return this.values.get('max');\n        }\n        get minValue() {\n            return this.values.get('min');\n        }\n        constrain(value) {\n            const max = this.values.get('max');\n            const min = this.values.get('min');\n            let result = value;\n            if (!isEmpty(min)) {\n                result = Math.max(result, min);\n            }\n            if (!isEmpty(max)) {\n                result = Math.min(result, max);\n            }\n            return result;\n        }\n    }\n\n    class StepConstraint {\n        constructor(step, origin = 0) {\n            this.step = step;\n            this.origin = origin;\n        }\n        constrain(value) {\n            const o = this.origin % this.step;\n            const r = Math.round((value - o) / this.step);\n            return o + r * this.step;\n        }\n    }\n\n    const className$c = ClassName('pop');\n    class PopupView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$c());\n            config.viewProps.bindClassModifiers(this.element);\n            bindValue(config.shows, valueToClassName(this.element, className$c(undefined, 'v')));\n        }\n    }\n\n    class PopupController {\n        constructor(doc, config) {\n            this.shows = createValue(false);\n            this.viewProps = config.viewProps;\n            this.view = new PopupView(doc, {\n                shows: this.shows,\n                viewProps: this.viewProps,\n            });\n        }\n    }\n\n    const className$b = ClassName('txt');\n    class TextView {\n        constructor(doc, config) {\n            this.onChange_ = this.onChange_.bind(this);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$b());\n            config.viewProps.bindClassModifiers(this.element);\n            this.props_ = config.props;\n            this.props_.emitter.on('change', this.onChange_);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className$b('i'));\n            inputElem.type = 'text';\n            config.viewProps.bindDisabled(inputElem);\n            this.element.appendChild(inputElem);\n            this.inputElement = inputElem;\n            config.value.emitter.on('change', this.onChange_);\n            this.value_ = config.value;\n            this.refresh();\n        }\n        refresh() {\n            const formatter = this.props_.get('formatter');\n            this.inputElement.value = formatter(this.value_.rawValue);\n        }\n        onChange_() {\n            this.refresh();\n        }\n    }\n\n    class TextController {\n        constructor(doc, config) {\n            this.onInputChange_ = this.onInputChange_.bind(this);\n            this.parser_ = config.parser;\n            this.props = config.props;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new TextView(doc, {\n                props: config.props,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.inputElement.addEventListener('change', this.onInputChange_);\n        }\n        onInputChange_(e) {\n            const inputElem = forceCast(e.currentTarget);\n            const value = inputElem.value;\n            const parsedValue = this.parser_(value);\n            if (!isEmpty(parsedValue)) {\n                this.value.rawValue = parsedValue;\n            }\n            this.view.refresh();\n        }\n    }\n\n    function boolFromUnknown(value) {\n        if (value === 'false') {\n            return false;\n        }\n        return !!value;\n    }\n\n    class NumberLiteralNode {\n        constructor(text) {\n            this.text = text;\n        }\n        evaluate() {\n            return Number(this.text);\n        }\n        toString() {\n            return this.text;\n        }\n    }\n    const BINARY_OPERATION_MAP = {\n        '**': (v1, v2) => Math.pow(v1, v2),\n        '*': (v1, v2) => v1 * v2,\n        '/': (v1, v2) => v1 / v2,\n        '%': (v1, v2) => v1 % v2,\n        '+': (v1, v2) => v1 + v2,\n        '-': (v1, v2) => v1 - v2,\n        '<<': (v1, v2) => v1 << v2,\n        '>>': (v1, v2) => v1 >> v2,\n        '>>>': (v1, v2) => v1 >>> v2,\n        '&': (v1, v2) => v1 & v2,\n        '^': (v1, v2) => v1 ^ v2,\n        '|': (v1, v2) => v1 | v2,\n    };\n    class BinaryOperationNode {\n        constructor(operator, left, right) {\n            this.left = left;\n            this.operator = operator;\n            this.right = right;\n        }\n        evaluate() {\n            const op = BINARY_OPERATION_MAP[this.operator];\n            if (!op) {\n                throw new Error(`unexpected binary operator: '${this.operator}`);\n            }\n            return op(this.left.evaluate(), this.right.evaluate());\n        }\n        toString() {\n            return [\n                'b(',\n                this.left.toString(),\n                this.operator,\n                this.right.toString(),\n                ')',\n            ].join(' ');\n        }\n    }\n    const UNARY_OPERATION_MAP = {\n        '+': (v) => v,\n        '-': (v) => -v,\n        '~': (v) => ~v,\n    };\n    class UnaryOperationNode {\n        constructor(operator, expr) {\n            this.operator = operator;\n            this.expression = expr;\n        }\n        evaluate() {\n            const op = UNARY_OPERATION_MAP[this.operator];\n            if (!op) {\n                throw new Error(`unexpected unary operator: '${this.operator}`);\n            }\n            return op(this.expression.evaluate());\n        }\n        toString() {\n            return ['u(', this.operator, this.expression.toString(), ')'].join(' ');\n        }\n    }\n\n    function combineReader(parsers) {\n        return (text, cursor) => {\n            for (let i = 0; i < parsers.length; i++) {\n                const result = parsers[i](text, cursor);\n                if (result !== '') {\n                    return result;\n                }\n            }\n            return '';\n        };\n    }\n    function readWhitespace(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^\\s+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readNonZeroDigit(text, cursor) {\n        const ch = text.substr(cursor, 1);\n        return ch.match(/^[1-9]$/) ? ch : '';\n    }\n    function readDecimalDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[0-9]+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readSignedInteger(text, cursor) {\n        const ds = readDecimalDigits(text, cursor);\n        if (ds !== '') {\n            return ds;\n        }\n        const sign = text.substr(cursor, 1);\n        cursor += 1;\n        if (sign !== '-' && sign !== '+') {\n            return '';\n        }\n        const sds = readDecimalDigits(text, cursor);\n        if (sds === '') {\n            return '';\n        }\n        return sign + sds;\n    }\n    function readExponentPart(text, cursor) {\n        const e = text.substr(cursor, 1);\n        cursor += 1;\n        if (e.toLowerCase() !== 'e') {\n            return '';\n        }\n        const si = readSignedInteger(text, cursor);\n        if (si === '') {\n            return '';\n        }\n        return e + si;\n    }\n    function readDecimalIntegerLiteral(text, cursor) {\n        const ch = text.substr(cursor, 1);\n        if (ch === '0') {\n            return ch;\n        }\n        const nzd = readNonZeroDigit(text, cursor);\n        cursor += nzd.length;\n        if (nzd === '') {\n            return '';\n        }\n        return nzd + readDecimalDigits(text, cursor);\n    }\n    function readDecimalLiteral1(text, cursor) {\n        const dil = readDecimalIntegerLiteral(text, cursor);\n        cursor += dil.length;\n        if (dil === '') {\n            return '';\n        }\n        const dot = text.substr(cursor, 1);\n        cursor += dot.length;\n        if (dot !== '.') {\n            return '';\n        }\n        const dds = readDecimalDigits(text, cursor);\n        cursor += dds.length;\n        return dil + dot + dds + readExponentPart(text, cursor);\n    }\n    function readDecimalLiteral2(text, cursor) {\n        const dot = text.substr(cursor, 1);\n        cursor += dot.length;\n        if (dot !== '.') {\n            return '';\n        }\n        const dds = readDecimalDigits(text, cursor);\n        cursor += dds.length;\n        if (dds === '') {\n            return '';\n        }\n        return dot + dds + readExponentPart(text, cursor);\n    }\n    function readDecimalLiteral3(text, cursor) {\n        const dil = readDecimalIntegerLiteral(text, cursor);\n        cursor += dil.length;\n        if (dil === '') {\n            return '';\n        }\n        return dil + readExponentPart(text, cursor);\n    }\n    const readDecimalLiteral = combineReader([\n        readDecimalLiteral1,\n        readDecimalLiteral2,\n        readDecimalLiteral3,\n    ]);\n    function parseBinaryDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[01]+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readBinaryIntegerLiteral(text, cursor) {\n        const prefix = text.substr(cursor, 2);\n        cursor += prefix.length;\n        if (prefix.toLowerCase() !== '0b') {\n            return '';\n        }\n        const bds = parseBinaryDigits(text, cursor);\n        if (bds === '') {\n            return '';\n        }\n        return prefix + bds;\n    }\n    function readOctalDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[0-7]+/);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readOctalIntegerLiteral(text, cursor) {\n        const prefix = text.substr(cursor, 2);\n        cursor += prefix.length;\n        if (prefix.toLowerCase() !== '0o') {\n            return '';\n        }\n        const ods = readOctalDigits(text, cursor);\n        if (ods === '') {\n            return '';\n        }\n        return prefix + ods;\n    }\n    function readHexDigits(text, cursor) {\n        var _a;\n        const m = text.substr(cursor).match(/^[0-9a-f]+/i);\n        return (_a = (m && m[0])) !== null && _a !== void 0 ? _a : '';\n    }\n    function readHexIntegerLiteral(text, cursor) {\n        const prefix = text.substr(cursor, 2);\n        cursor += prefix.length;\n        if (prefix.toLowerCase() !== '0x') {\n            return '';\n        }\n        const hds = readHexDigits(text, cursor);\n        if (hds === '') {\n            return '';\n        }\n        return prefix + hds;\n    }\n    const readNonDecimalIntegerLiteral = combineReader([\n        readBinaryIntegerLiteral,\n        readOctalIntegerLiteral,\n        readHexIntegerLiteral,\n    ]);\n    const readNumericLiteral = combineReader([\n        readNonDecimalIntegerLiteral,\n        readDecimalLiteral,\n    ]);\n\n    function parseLiteral(text, cursor) {\n        const num = readNumericLiteral(text, cursor);\n        cursor += num.length;\n        if (num === '') {\n            return null;\n        }\n        return {\n            evaluable: new NumberLiteralNode(num),\n            cursor: cursor,\n        };\n    }\n    function parseParenthesizedExpression(text, cursor) {\n        const op = text.substr(cursor, 1);\n        cursor += op.length;\n        if (op !== '(') {\n            return null;\n        }\n        const expr = parseExpression(text, cursor);\n        if (!expr) {\n            return null;\n        }\n        cursor = expr.cursor;\n        cursor += readWhitespace(text, cursor).length;\n        const cl = text.substr(cursor, 1);\n        cursor += cl.length;\n        if (cl !== ')') {\n            return null;\n        }\n        return {\n            evaluable: expr.evaluable,\n            cursor: cursor,\n        };\n    }\n    function parsePrimaryExpression(text, cursor) {\n        var _a;\n        return ((_a = parseLiteral(text, cursor)) !== null && _a !== void 0 ? _a : parseParenthesizedExpression(text, cursor));\n    }\n    function parseUnaryExpression(text, cursor) {\n        const expr = parsePrimaryExpression(text, cursor);\n        if (expr) {\n            return expr;\n        }\n        const op = text.substr(cursor, 1);\n        cursor += op.length;\n        if (op !== '+' && op !== '-' && op !== '~') {\n            return null;\n        }\n        const num = parseUnaryExpression(text, cursor);\n        if (!num) {\n            return null;\n        }\n        cursor = num.cursor;\n        return {\n            cursor: cursor,\n            evaluable: new UnaryOperationNode(op, num.evaluable),\n        };\n    }\n    function readBinaryOperator(ops, text, cursor) {\n        cursor += readWhitespace(text, cursor).length;\n        const op = ops.filter((op) => text.startsWith(op, cursor))[0];\n        if (!op) {\n            return null;\n        }\n        cursor += op.length;\n        cursor += readWhitespace(text, cursor).length;\n        return {\n            cursor: cursor,\n            operator: op,\n        };\n    }\n    function createBinaryOperationExpressionParser(exprParser, ops) {\n        return (text, cursor) => {\n            const firstExpr = exprParser(text, cursor);\n            if (!firstExpr) {\n                return null;\n            }\n            cursor = firstExpr.cursor;\n            let expr = firstExpr.evaluable;\n            for (;;) {\n                const op = readBinaryOperator(ops, text, cursor);\n                if (!op) {\n                    break;\n                }\n                cursor = op.cursor;\n                const nextExpr = exprParser(text, cursor);\n                if (!nextExpr) {\n                    return null;\n                }\n                cursor = nextExpr.cursor;\n                expr = new BinaryOperationNode(op.operator, expr, nextExpr.evaluable);\n            }\n            return expr\n                ? {\n                    cursor: cursor,\n                    evaluable: expr,\n                }\n                : null;\n        };\n    }\n    const parseBinaryOperationExpression = [\n        ['**'],\n        ['*', '/', '%'],\n        ['+', '-'],\n        ['<<', '>>>', '>>'],\n        ['&'],\n        ['^'],\n        ['|'],\n    ].reduce((parser, ops) => {\n        return createBinaryOperationExpressionParser(parser, ops);\n    }, parseUnaryExpression);\n    function parseExpression(text, cursor) {\n        cursor += readWhitespace(text, cursor).length;\n        return parseBinaryOperationExpression(text, cursor);\n    }\n    function parseEcmaNumberExpression(text) {\n        const expr = parseExpression(text, 0);\n        if (!expr) {\n            return null;\n        }\n        const cursor = expr.cursor + readWhitespace(text, expr.cursor).length;\n        if (cursor !== text.length) {\n            return null;\n        }\n        return expr.evaluable;\n    }\n\n    function parseNumber(text) {\n        var _a;\n        const r = parseEcmaNumberExpression(text);\n        return (_a = r === null || r === void 0 ? void 0 : r.evaluate()) !== null && _a !== void 0 ? _a : null;\n    }\n    function numberFromUnknown(value) {\n        if (typeof value === 'number') {\n            return value;\n        }\n        if (typeof value === 'string') {\n            const pv = parseNumber(value);\n            if (!isEmpty(pv)) {\n                return pv;\n            }\n        }\n        return 0;\n    }\n    function createNumberFormatter(digits) {\n        return (value) => {\n            return value.toFixed(Math.max(Math.min(digits, 20), 0));\n        };\n    }\n\n    const innerFormatter = createNumberFormatter(0);\n    function formatPercentage(value) {\n        return innerFormatter(value) + '%';\n    }\n\n    function stringFromUnknown(value) {\n        return String(value);\n    }\n\n    function fillBuffer(buffer, bufferSize) {\n        while (buffer.length < bufferSize) {\n            buffer.push(undefined);\n        }\n    }\n    function initializeBuffer(bufferSize) {\n        const buffer = [];\n        fillBuffer(buffer, bufferSize);\n        return createValue(buffer);\n    }\n    function createTrimmedBuffer(buffer) {\n        const index = buffer.indexOf(undefined);\n        return forceCast(index < 0 ? buffer : buffer.slice(0, index));\n    }\n    function createPushedBuffer(buffer, newValue) {\n        const newBuffer = [...createTrimmedBuffer(buffer), newValue];\n        if (newBuffer.length > buffer.length) {\n            newBuffer.splice(0, newBuffer.length - buffer.length);\n        }\n        else {\n            fillBuffer(newBuffer, buffer.length);\n        }\n        return newBuffer;\n    }\n\n    function connectValues({ primary, secondary, forward, backward, }) {\n        let changing = false;\n        function preventFeedback(callback) {\n            if (changing) {\n                return;\n            }\n            changing = true;\n            callback();\n            changing = false;\n        }\n        primary.emitter.on('change', (ev) => {\n            preventFeedback(() => {\n                secondary.setRawValue(forward(primary, secondary), ev.options);\n            });\n        });\n        secondary.emitter.on('change', (ev) => {\n            preventFeedback(() => {\n                primary.setRawValue(backward(primary, secondary), ev.options);\n            });\n            preventFeedback(() => {\n                secondary.setRawValue(forward(primary, secondary), ev.options);\n            });\n        });\n        preventFeedback(() => {\n            secondary.setRawValue(forward(primary, secondary), {\n                forceEmit: false,\n                last: true,\n            });\n        });\n    }\n\n    function getStepForKey(baseStep, keys) {\n        const step = baseStep * (keys.altKey ? 0.1 : 1) * (keys.shiftKey ? 10 : 1);\n        if (keys.upKey) {\n            return +step;\n        }\n        else if (keys.downKey) {\n            return -step;\n        }\n        return 0;\n    }\n    function getVerticalStepKeys(ev) {\n        return {\n            altKey: ev.altKey,\n            downKey: ev.key === 'ArrowDown',\n            shiftKey: ev.shiftKey,\n            upKey: ev.key === 'ArrowUp',\n        };\n    }\n    function getHorizontalStepKeys(ev) {\n        return {\n            altKey: ev.altKey,\n            downKey: ev.key === 'ArrowLeft',\n            shiftKey: ev.shiftKey,\n            upKey: ev.key === 'ArrowRight',\n        };\n    }\n    function isVerticalArrowKey(key) {\n        return key === 'ArrowUp' || key === 'ArrowDown';\n    }\n    function isArrowKey(key) {\n        return isVerticalArrowKey(key) || key === 'ArrowLeft' || key === 'ArrowRight';\n    }\n\n    function computeOffset(ev, elem) {\n        var _a, _b;\n        const win = elem.ownerDocument.defaultView;\n        const rect = elem.getBoundingClientRect();\n        return {\n            x: ev.pageX - (((_a = (win && win.scrollX)) !== null && _a !== void 0 ? _a : 0) + rect.left),\n            y: ev.pageY - (((_b = (win && win.scrollY)) !== null && _b !== void 0 ? _b : 0) + rect.top),\n        };\n    }\n    class PointerHandler {\n        constructor(element) {\n            this.lastTouch_ = null;\n            this.onDocumentMouseMove_ = this.onDocumentMouseMove_.bind(this);\n            this.onDocumentMouseUp_ = this.onDocumentMouseUp_.bind(this);\n            this.onMouseDown_ = this.onMouseDown_.bind(this);\n            this.onTouchEnd_ = this.onTouchEnd_.bind(this);\n            this.onTouchMove_ = this.onTouchMove_.bind(this);\n            this.onTouchStart_ = this.onTouchStart_.bind(this);\n            this.elem_ = element;\n            this.emitter = new Emitter();\n            element.addEventListener('touchstart', this.onTouchStart_, {\n                passive: false,\n            });\n            element.addEventListener('touchmove', this.onTouchMove_, {\n                passive: true,\n            });\n            element.addEventListener('touchend', this.onTouchEnd_);\n            element.addEventListener('mousedown', this.onMouseDown_);\n        }\n        computePosition_(offset) {\n            const rect = this.elem_.getBoundingClientRect();\n            return {\n                bounds: {\n                    width: rect.width,\n                    height: rect.height,\n                },\n                point: offset\n                    ? {\n                        x: offset.x,\n                        y: offset.y,\n                    }\n                    : null,\n            };\n        }\n        onMouseDown_(ev) {\n            var _a;\n            ev.preventDefault();\n            (_a = ev.currentTarget) === null || _a === void 0 ? void 0 : _a.focus();\n            const doc = this.elem_.ownerDocument;\n            doc.addEventListener('mousemove', this.onDocumentMouseMove_);\n            doc.addEventListener('mouseup', this.onDocumentMouseUp_);\n            this.emitter.emit('down', {\n                altKey: ev.altKey,\n                data: this.computePosition_(computeOffset(ev, this.elem_)),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n        onDocumentMouseMove_(ev) {\n            this.emitter.emit('move', {\n                altKey: ev.altKey,\n                data: this.computePosition_(computeOffset(ev, this.elem_)),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n        onDocumentMouseUp_(ev) {\n            const doc = this.elem_.ownerDocument;\n            doc.removeEventListener('mousemove', this.onDocumentMouseMove_);\n            doc.removeEventListener('mouseup', this.onDocumentMouseUp_);\n            this.emitter.emit('up', {\n                altKey: ev.altKey,\n                data: this.computePosition_(computeOffset(ev, this.elem_)),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n        onTouchStart_(ev) {\n            ev.preventDefault();\n            const touch = ev.targetTouches.item(0);\n            const rect = this.elem_.getBoundingClientRect();\n            this.emitter.emit('down', {\n                altKey: ev.altKey,\n                data: this.computePosition_(touch\n                    ? {\n                        x: touch.clientX - rect.left,\n                        y: touch.clientY - rect.top,\n                    }\n                    : undefined),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n            this.lastTouch_ = touch;\n        }\n        onTouchMove_(ev) {\n            const touch = ev.targetTouches.item(0);\n            const rect = this.elem_.getBoundingClientRect();\n            this.emitter.emit('move', {\n                altKey: ev.altKey,\n                data: this.computePosition_(touch\n                    ? {\n                        x: touch.clientX - rect.left,\n                        y: touch.clientY - rect.top,\n                    }\n                    : undefined),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n            this.lastTouch_ = touch;\n        }\n        onTouchEnd_(ev) {\n            var _a;\n            const touch = (_a = ev.targetTouches.item(0)) !== null && _a !== void 0 ? _a : this.lastTouch_;\n            const rect = this.elem_.getBoundingClientRect();\n            this.emitter.emit('up', {\n                altKey: ev.altKey,\n                data: this.computePosition_(touch\n                    ? {\n                        x: touch.clientX - rect.left,\n                        y: touch.clientY - rect.top,\n                    }\n                    : undefined),\n                sender: this,\n                shiftKey: ev.shiftKey,\n            });\n        }\n    }\n\n    function mapRange(value, start1, end1, start2, end2) {\n        const p = (value - start1) / (end1 - start1);\n        return start2 + p * (end2 - start2);\n    }\n    function getDecimalDigits(value) {\n        const text = String(value.toFixed(10));\n        const frac = text.split('.')[1];\n        return frac.replace(/0+$/, '').length;\n    }\n    function constrainRange(value, min, max) {\n        return Math.min(Math.max(value, min), max);\n    }\n\n    const className$a = ClassName('txt');\n    class NumberTextView {\n        constructor(doc, config) {\n            this.onChange_ = this.onChange_.bind(this);\n            this.props_ = config.props;\n            this.props_.emitter.on('change', this.onChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$a(), className$a(undefined, 'num'));\n            if (config.arrayPosition) {\n                this.element.classList.add(className$a(undefined, config.arrayPosition));\n            }\n            config.viewProps.bindClassModifiers(this.element);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className$a('i'));\n            inputElem.type = 'text';\n            config.viewProps.bindDisabled(inputElem);\n            this.element.appendChild(inputElem);\n            this.inputElement = inputElem;\n            this.onDraggingChange_ = this.onDraggingChange_.bind(this);\n            this.dragging_ = config.dragging;\n            this.dragging_.emitter.on('change', this.onDraggingChange_);\n            this.element.classList.add(className$a());\n            this.inputElement.classList.add(className$a('i'));\n            const knobElem = doc.createElement('div');\n            knobElem.classList.add(className$a('k'));\n            this.element.appendChild(knobElem);\n            this.knobElement = knobElem;\n            const guideElem = doc.createElementNS(SVG_NS, 'svg');\n            guideElem.classList.add(className$a('g'));\n            this.knobElement.appendChild(guideElem);\n            const bodyElem = doc.createElementNS(SVG_NS, 'path');\n            bodyElem.classList.add(className$a('gb'));\n            guideElem.appendChild(bodyElem);\n            this.guideBodyElem_ = bodyElem;\n            const headElem = doc.createElementNS(SVG_NS, 'path');\n            headElem.classList.add(className$a('gh'));\n            guideElem.appendChild(headElem);\n            this.guideHeadElem_ = headElem;\n            const tooltipElem = doc.createElement('div');\n            tooltipElem.classList.add(ClassName('tt')());\n            this.knobElement.appendChild(tooltipElem);\n            this.tooltipElem_ = tooltipElem;\n            config.value.emitter.on('change', this.onChange_);\n            this.value = config.value;\n            this.refresh();\n        }\n        onDraggingChange_(ev) {\n            if (ev.rawValue === null) {\n                this.element.classList.remove(className$a(undefined, 'drg'));\n                return;\n            }\n            this.element.classList.add(className$a(undefined, 'drg'));\n            const x = ev.rawValue / this.props_.get('draggingScale');\n            const aox = x + (x > 0 ? -1 : x < 0 ? +1 : 0);\n            const adx = constrainRange(-aox, -4, +4);\n            this.guideHeadElem_.setAttributeNS(null, 'd', [`M ${aox + adx},0 L${aox},4 L${aox + adx},8`, `M ${x},-1 L${x},9`].join(' '));\n            this.guideBodyElem_.setAttributeNS(null, 'd', `M 0,4 L${x},4`);\n            const formatter = this.props_.get('formatter');\n            this.tooltipElem_.textContent = formatter(this.value.rawValue);\n            this.tooltipElem_.style.left = `${x}px`;\n        }\n        refresh() {\n            const formatter = this.props_.get('formatter');\n            this.inputElement.value = formatter(this.value.rawValue);\n        }\n        onChange_() {\n            this.refresh();\n        }\n    }\n\n    class NumberTextController {\n        constructor(doc, config) {\n            var _a;\n            this.originRawValue_ = 0;\n            this.onInputChange_ = this.onInputChange_.bind(this);\n            this.onInputKeyDown_ = this.onInputKeyDown_.bind(this);\n            this.onInputKeyUp_ = this.onInputKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.baseStep_ = config.baseStep;\n            this.parser_ = config.parser;\n            this.props = config.props;\n            this.sliderProps_ = (_a = config.sliderProps) !== null && _a !== void 0 ? _a : null;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.dragging_ = createValue(null);\n            this.view = new NumberTextView(doc, {\n                arrayPosition: config.arrayPosition,\n                dragging: this.dragging_,\n                props: this.props,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.inputElement.addEventListener('change', this.onInputChange_);\n            this.view.inputElement.addEventListener('keydown', this.onInputKeyDown_);\n            this.view.inputElement.addEventListener('keyup', this.onInputKeyUp_);\n            const ph = new PointerHandler(this.view.knobElement);\n            ph.emitter.on('down', this.onPointerDown_);\n            ph.emitter.on('move', this.onPointerMove_);\n            ph.emitter.on('up', this.onPointerUp_);\n        }\n        constrainValue_(value) {\n            var _a, _b;\n            const min = (_a = this.sliderProps_) === null || _a === void 0 ? void 0 : _a.get('minValue');\n            const max = (_b = this.sliderProps_) === null || _b === void 0 ? void 0 : _b.get('maxValue');\n            let v = value;\n            if (min !== undefined) {\n                v = Math.max(v, min);\n            }\n            if (max !== undefined) {\n                v = Math.min(v, max);\n            }\n            return v;\n        }\n        onInputChange_(e) {\n            const inputElem = forceCast(e.currentTarget);\n            const value = inputElem.value;\n            const parsedValue = this.parser_(value);\n            if (!isEmpty(parsedValue)) {\n                this.value.rawValue = this.constrainValue_(parsedValue);\n            }\n            this.view.refresh();\n        }\n        onInputKeyDown_(ev) {\n            const step = getStepForKey(this.baseStep_, getVerticalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.constrainValue_(this.value.rawValue + step), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onInputKeyUp_(ev) {\n            const step = getStepForKey(this.baseStep_, getVerticalStepKeys(ev));\n            if (step === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onPointerDown_() {\n            this.originRawValue_ = this.value.rawValue;\n            this.dragging_.rawValue = 0;\n        }\n        computeDraggingValue_(data) {\n            if (!data.point) {\n                return null;\n            }\n            const dx = data.point.x - data.bounds.width / 2;\n            return this.constrainValue_(this.originRawValue_ + dx * this.props.get('draggingScale'));\n        }\n        onPointerMove_(ev) {\n            const v = this.computeDraggingValue_(ev.data);\n            if (v === null) {\n                return;\n            }\n            this.value.setRawValue(v, {\n                forceEmit: false,\n                last: false,\n            });\n            this.dragging_.rawValue = this.value.rawValue - this.originRawValue_;\n        }\n        onPointerUp_(ev) {\n            const v = this.computeDraggingValue_(ev.data);\n            if (v === null) {\n                return;\n            }\n            this.value.setRawValue(v, {\n                forceEmit: true,\n                last: true,\n            });\n            this.dragging_.rawValue = null;\n        }\n    }\n\n    function writePrimitive(target, value) {\n        target.write(value);\n    }\n\n    function findStep(constraint) {\n        const c = constraint ? findConstraint(constraint, StepConstraint) : null;\n        if (!c) {\n            return null;\n        }\n        return c.step;\n    }\n    function getSuitableDecimalDigits(constraint, rawValue) {\n        const sc = constraint && findConstraint(constraint, StepConstraint);\n        if (sc) {\n            return getDecimalDigits(sc.step);\n        }\n        return Math.max(getDecimalDigits(rawValue), 2);\n    }\n    function getBaseStep(constraint) {\n        const step = findStep(constraint);\n        return step !== null && step !== void 0 ? step : 1;\n    }\n    function getSuitableDraggingScale(constraint, rawValue) {\n        var _a;\n        const sc = constraint && findConstraint(constraint, StepConstraint);\n        const base = Math.abs((_a = sc === null || sc === void 0 ? void 0 : sc.step) !== null && _a !== void 0 ? _a : rawValue);\n        return base === 0 ? 0.1 : Math.pow(10, Math.floor(Math.log10(base)) - 1);\n    }\n\n    function removeAlphaComponent(comps) {\n        return [comps[0], comps[1], comps[2]];\n    }\n\n    function zerofill(comp) {\n        const hex = constrainRange(Math.floor(comp), 0, 255).toString(16);\n        return hex.length === 1 ? `0${hex}` : hex;\n    }\n    function colorToHexRgbString(value, prefix = '#') {\n        const hexes = removeAlphaComponent(value.getComponents('rgb'))\n            .map(zerofill)\n            .join('');\n        return `${prefix}${hexes}`;\n    }\n    function colorToHexRgbaString(value, prefix = '#') {\n        const rgbaComps = value.getComponents('rgb');\n        const hexes = [rgbaComps[0], rgbaComps[1], rgbaComps[2], rgbaComps[3] * 255]\n            .map(zerofill)\n            .join('');\n        return `${prefix}${hexes}`;\n    }\n    function colorToFunctionalRgbString(value, opt_type) {\n        const formatter = createNumberFormatter(opt_type === 'float' ? 2 : 0);\n        const comps = removeAlphaComponent(value.getComponents('rgb', opt_type)).map((comp) => formatter(comp));\n        return `rgb(${comps.join(', ')})`;\n    }\n    function createFunctionalRgbColorFormatter(type) {\n        return (value) => {\n            return colorToFunctionalRgbString(value, type);\n        };\n    }\n    function colorToFunctionalRgbaString(value, opt_type) {\n        const aFormatter = createNumberFormatter(2);\n        const rgbFormatter = createNumberFormatter(opt_type === 'float' ? 2 : 0);\n        const comps = value.getComponents('rgb', opt_type).map((comp, index) => {\n            const formatter = index === 3 ? aFormatter : rgbFormatter;\n            return formatter(comp);\n        });\n        return `rgba(${comps.join(', ')})`;\n    }\n    function createFunctionalRgbaColorFormatter(type) {\n        return (value) => {\n            return colorToFunctionalRgbaString(value, type);\n        };\n    }\n    function colorToFunctionalHslString(value) {\n        const formatters = [\n            createNumberFormatter(0),\n            formatPercentage,\n            formatPercentage,\n        ];\n        const comps = removeAlphaComponent(value.getComponents('hsl')).map((comp, index) => formatters[index](comp));\n        return `hsl(${comps.join(', ')})`;\n    }\n    function colorToFunctionalHslaString(value) {\n        const formatters = [\n            createNumberFormatter(0),\n            formatPercentage,\n            formatPercentage,\n            createNumberFormatter(2),\n        ];\n        const comps = value\n            .getComponents('hsl')\n            .map((comp, index) => formatters[index](comp));\n        return `hsla(${comps.join(', ')})`;\n    }\n    function colorToObjectRgbString(value, type) {\n        const formatter = createNumberFormatter(type === 'float' ? 2 : 0);\n        const names = ['r', 'g', 'b'];\n        const comps = removeAlphaComponent(value.getComponents('rgb', type)).map((comp, index) => `${names[index]}: ${formatter(comp)}`);\n        return `{${comps.join(', ')}}`;\n    }\n    function createObjectRgbColorFormatter(type) {\n        return (value) => colorToObjectRgbString(value, type);\n    }\n    function colorToObjectRgbaString(value, type) {\n        const aFormatter = createNumberFormatter(2);\n        const rgbFormatter = createNumberFormatter(type === 'float' ? 2 : 0);\n        const names = ['r', 'g', 'b', 'a'];\n        const comps = value.getComponents('rgb', type).map((comp, index) => {\n            const formatter = index === 3 ? aFormatter : rgbFormatter;\n            return `${names[index]}: ${formatter(comp)}`;\n        });\n        return `{${comps.join(', ')}}`;\n    }\n    function createObjectRgbaColorFormatter(type) {\n        return (value) => colorToObjectRgbaString(value, type);\n    }\n    [\n        {\n            format: {\n                alpha: false,\n                mode: 'rgb',\n                notation: 'hex',\n                type: 'int',\n            },\n            stringifier: colorToHexRgbString,\n        },\n        {\n            format: {\n                alpha: true,\n                mode: 'rgb',\n                notation: 'hex',\n                type: 'int',\n            },\n            stringifier: colorToHexRgbaString,\n        },\n        {\n            format: {\n                alpha: false,\n                mode: 'hsl',\n                notation: 'func',\n                type: 'int',\n            },\n            stringifier: colorToFunctionalHslString,\n        },\n        {\n            format: {\n                alpha: true,\n                mode: 'hsl',\n                notation: 'func',\n                type: 'int',\n            },\n            stringifier: colorToFunctionalHslaString,\n        },\n        ...['int', 'float'].reduce((prev, type) => {\n            return [\n                ...prev,\n                {\n                    format: {\n                        alpha: false,\n                        mode: 'rgb',\n                        notation: 'func',\n                        type: type,\n                    },\n                    stringifier: createFunctionalRgbColorFormatter(type),\n                },\n                {\n                    format: {\n                        alpha: true,\n                        mode: 'rgb',\n                        notation: 'func',\n                        type: type,\n                    },\n                    stringifier: createFunctionalRgbaColorFormatter(type),\n                },\n                {\n                    format: {\n                        alpha: false,\n                        mode: 'rgb',\n                        notation: 'object',\n                        type: type,\n                    },\n                    stringifier: createObjectRgbColorFormatter(type),\n                },\n                {\n                    format: {\n                        alpha: true,\n                        mode: 'rgb',\n                        notation: 'object',\n                        type: type,\n                    },\n                    stringifier: createObjectRgbaColorFormatter(type),\n                },\n            ];\n        }, []),\n    ];\n\n    class PointNdConstraint {\n        constructor(config) {\n            this.components = config.components;\n            this.asm_ = config.assembly;\n        }\n        constrain(value) {\n            const comps = this.asm_\n                .toComponents(value)\n                .map((comp, index) => { var _a, _b; return (_b = (_a = this.components[index]) === null || _a === void 0 ? void 0 : _a.constrain(comp)) !== null && _b !== void 0 ? _b : comp; });\n            return this.asm_.fromComponents(comps);\n        }\n    }\n\n    const className$9 = ClassName('pndtxt');\n    class PointNdTextView {\n        constructor(doc, config) {\n            this.textViews = config.textViews;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$9());\n            this.textViews.forEach((v) => {\n                const axisElem = doc.createElement('div');\n                axisElem.classList.add(className$9('a'));\n                axisElem.appendChild(v.element);\n                this.element.appendChild(axisElem);\n            });\n        }\n    }\n\n    function createAxisController(doc, config, index) {\n        return new NumberTextController(doc, {\n            arrayPosition: index === 0 ? 'fst' : index === config.axes.length - 1 ? 'lst' : 'mid',\n            baseStep: config.axes[index].baseStep,\n            parser: config.parser,\n            props: config.axes[index].textProps,\n            value: createValue(0, {\n                constraint: config.axes[index].constraint,\n            }),\n            viewProps: config.viewProps,\n        });\n    }\n    class PointNdTextController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.acs_ = config.axes.map((_, index) => createAxisController(doc, config, index));\n            this.acs_.forEach((c, index) => {\n                connectValues({\n                    primary: this.value,\n                    secondary: c.value,\n                    forward: (p) => {\n                        return config.assembly.toComponents(p.rawValue)[index];\n                    },\n                    backward: (p, s) => {\n                        const comps = config.assembly.toComponents(p.rawValue);\n                        comps[index] = s.rawValue;\n                        return config.assembly.fromComponents(comps);\n                    },\n                });\n            });\n            this.view = new PointNdTextView(doc, {\n                textViews: this.acs_.map((ac) => ac.view),\n            });\n        }\n    }\n\n    function createStepConstraint(params, initialValue) {\n        if ('step' in params && !isEmpty(params.step)) {\n            return new StepConstraint(params.step, initialValue);\n        }\n        return null;\n    }\n    function createRangeConstraint(params) {\n        if (!isEmpty(params.max) && !isEmpty(params.min)) {\n            return new DefiniteRangeConstraint({\n                max: params.max,\n                min: params.min,\n            });\n        }\n        if (!isEmpty(params.max) || !isEmpty(params.min)) {\n            return new RangeConstraint({\n                max: params.max,\n                min: params.min,\n            });\n        }\n        return null;\n    }\n\n    const Constants = {\n        monitor: {\n            defaultInterval: 200,\n            defaultLineCount: 3,\n        },\n    };\n\n    const className$8 = ClassName('grl');\n    class GraphLogView {\n        constructor(doc, config) {\n            this.onCursorChange_ = this.onCursorChange_.bind(this);\n            this.onValueUpdate_ = this.onValueUpdate_.bind(this);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$8());\n            config.viewProps.bindClassModifiers(this.element);\n            this.formatter_ = config.formatter;\n            this.props_ = config.props;\n            this.cursor_ = config.cursor;\n            this.cursor_.emitter.on('change', this.onCursorChange_);\n            const svgElem = doc.createElementNS(SVG_NS, 'svg');\n            svgElem.classList.add(className$8('g'));\n            svgElem.style.height = `calc(var(--bld-us) * ${config.lineCount})`;\n            this.element.appendChild(svgElem);\n            this.svgElem_ = svgElem;\n            const lineElem = doc.createElementNS(SVG_NS, 'polyline');\n            this.svgElem_.appendChild(lineElem);\n            this.lineElem_ = lineElem;\n            const tooltipElem = doc.createElement('div');\n            tooltipElem.classList.add(className$8('t'), ClassName('tt')());\n            this.element.appendChild(tooltipElem);\n            this.tooltipElem_ = tooltipElem;\n            config.value.emitter.on('change', this.onValueUpdate_);\n            this.value = config.value;\n            this.update_();\n        }\n        get graphElement() {\n            return this.svgElem_;\n        }\n        update_() {\n            const bounds = this.svgElem_.getBoundingClientRect();\n            const maxIndex = this.value.rawValue.length - 1;\n            const min = this.props_.get('minValue');\n            const max = this.props_.get('maxValue');\n            const points = [];\n            this.value.rawValue.forEach((v, index) => {\n                if (v === undefined) {\n                    return;\n                }\n                const x = mapRange(index, 0, maxIndex, 0, bounds.width);\n                const y = mapRange(v, min, max, bounds.height, 0);\n                points.push([x, y].join(','));\n            });\n            this.lineElem_.setAttributeNS(null, 'points', points.join(' '));\n            const tooltipElem = this.tooltipElem_;\n            const value = this.value.rawValue[this.cursor_.rawValue];\n            if (value === undefined) {\n                tooltipElem.classList.remove(className$8('t', 'a'));\n                return;\n            }\n            const tx = mapRange(this.cursor_.rawValue, 0, maxIndex, 0, bounds.width);\n            const ty = mapRange(value, min, max, bounds.height, 0);\n            tooltipElem.style.left = `${tx}px`;\n            tooltipElem.style.top = `${ty}px`;\n            tooltipElem.textContent = `${this.formatter_(value)}`;\n            if (!tooltipElem.classList.contains(className$8('t', 'a'))) {\n                tooltipElem.classList.add(className$8('t', 'a'), className$8('t', 'in'));\n                forceReflow(tooltipElem);\n                tooltipElem.classList.remove(className$8('t', 'in'));\n            }\n        }\n        onValueUpdate_() {\n            this.update_();\n        }\n        onCursorChange_() {\n            this.update_();\n        }\n    }\n\n    class GraphLogController {\n        constructor(doc, config) {\n            this.onGraphMouseMove_ = this.onGraphMouseMove_.bind(this);\n            this.onGraphMouseLeave_ = this.onGraphMouseLeave_.bind(this);\n            this.onGraphPointerDown_ = this.onGraphPointerDown_.bind(this);\n            this.onGraphPointerMove_ = this.onGraphPointerMove_.bind(this);\n            this.onGraphPointerUp_ = this.onGraphPointerUp_.bind(this);\n            this.props_ = config.props;\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.cursor_ = createValue(-1);\n            this.view = new GraphLogView(doc, {\n                cursor: this.cursor_,\n                formatter: config.formatter,\n                lineCount: config.lineCount,\n                props: this.props_,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            if (!supportsTouch(doc)) {\n                this.view.element.addEventListener('mousemove', this.onGraphMouseMove_);\n                this.view.element.addEventListener('mouseleave', this.onGraphMouseLeave_);\n            }\n            else {\n                const ph = new PointerHandler(this.view.element);\n                ph.emitter.on('down', this.onGraphPointerDown_);\n                ph.emitter.on('move', this.onGraphPointerMove_);\n                ph.emitter.on('up', this.onGraphPointerUp_);\n            }\n        }\n        onGraphMouseLeave_() {\n            this.cursor_.rawValue = -1;\n        }\n        onGraphMouseMove_(ev) {\n            const bounds = this.view.element.getBoundingClientRect();\n            this.cursor_.rawValue = Math.floor(mapRange(ev.offsetX, 0, bounds.width, 0, this.value.rawValue.length));\n        }\n        onGraphPointerDown_(ev) {\n            this.onGraphPointerMove_(ev);\n        }\n        onGraphPointerMove_(ev) {\n            if (!ev.data.point) {\n                this.cursor_.rawValue = -1;\n                return;\n            }\n            this.cursor_.rawValue = Math.floor(mapRange(ev.data.point.x, 0, ev.data.bounds.width, 0, this.value.rawValue.length));\n        }\n        onGraphPointerUp_() {\n            this.cursor_.rawValue = -1;\n        }\n    }\n\n    class ButtonCellApi {\n        constructor(controller) {\n            this.controller_ = controller;\n        }\n        get disabled() {\n            return this.controller_.viewProps.get('disabled');\n        }\n        set disabled(disabled) {\n            this.controller_.viewProps.set('disabled', disabled);\n        }\n        get title() {\n            var _a;\n            return (_a = this.controller_.props.get('title')) !== null && _a !== void 0 ? _a : '';\n        }\n        set title(title) {\n            this.controller_.props.set('title', title);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            const emitter = this.controller_.emitter;\n            emitter.on(eventName, () => {\n                bh(new TpEvent(this));\n            });\n            return this;\n        }\n    }\n\n    class TpButtonGridEvent extends TpEvent {\n        constructor(target, cell, index) {\n            super(target);\n            this.cell = cell;\n            this.index = index;\n        }\n    }\n\n    class ButtonGridApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.cellToApiMap_ = new Map();\n            this.emitter_ = new Emitter();\n            const gc = this.controller_.valueController;\n            gc.cellControllers.forEach((cc, i) => {\n                const api = new ButtonCellApi(cc);\n                this.cellToApiMap_.set(cc, api);\n                cc.emitter.on('click', () => {\n                    const x = i % gc.size[0];\n                    const y = Math.floor(i / gc.size[0]);\n                    this.emitter_.emit('click', {\n                        event: new TpButtonGridEvent(this, api, [x, y]),\n                    });\n                });\n            });\n        }\n        cell(x, y) {\n            const gc = this.controller_.valueController;\n            const cc = gc.cellControllers[y * gc.size[0] + x];\n            return this.cellToApiMap_.get(cc);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.emitter_.on(eventName, (ev) => {\n                bh(ev.event);\n            });\n            return this;\n        }\n    }\n\n    class ButtonGridController {\n        constructor(doc, config) {\n            this.size = config.size;\n            const [w, h] = this.size;\n            const bcs = [];\n            for (let y = 0; y < h; y++) {\n                for (let x = 0; x < w; x++) {\n                    const bc = new ButtonController(doc, {\n                        props: ValueMap.fromObject(Object.assign({}, config.cellConfig(x, y))),\n                        viewProps: ViewProps.create(),\n                    });\n                    bcs.push(bc);\n                }\n            }\n            this.cellCs_ = bcs;\n            this.viewProps = ViewProps.create();\n            this.viewProps.handleDispose(() => {\n                this.cellCs_.forEach((c) => {\n                    c.viewProps.set('disposed', true);\n                });\n            });\n            this.view = new PlainView(doc, {\n                viewProps: this.viewProps,\n                viewName: 'btngrid',\n            });\n            this.view.element.style.gridTemplateColumns = `repeat(${w}, 1fr)`;\n            this.cellCs_.forEach((bc) => {\n                this.view.element.appendChild(bc.view.element);\n            });\n        }\n        get cellControllers() {\n            return this.cellCs_;\n        }\n    }\n\n    const ButtonGridBladePlugin = {\n        id: 'buttongrid',\n        type: 'blade',\n        // TODO:\n        css: '.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                cells: p.required.function,\n                size: p.required.array(p.required.number),\n                view: p.required.constant('buttongrid'),\n                label: p.optional.string,\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            return new LabelController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                valueController: new ButtonGridController(args.document, {\n                    cellConfig: args.params.cells,\n                    size: args.params.size,\n                }),\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabelController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof ButtonGridController)) {\n                return null;\n            }\n            return new ButtonGridApi(args.controller);\n        },\n    };\n\n    class CubicBezierApi extends BladeApi {\n        get label() {\n            return this.controller_.props.get('label');\n        }\n        set label(label) {\n            this.controller_.props.set('label', label);\n        }\n        get value() {\n            return this.controller_.valueController.value.rawValue;\n        }\n        set value(value) {\n            this.controller_.valueController.value.rawValue = value;\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.controller_.valueController.value.emitter.on(eventName, (ev) => {\n                bh(new TpChangeEvent(this, ev.rawValue, undefined, ev.options.last));\n            });\n            return this;\n        }\n    }\n\n    function interpolate(x1, x2, t) {\n        return x1 * (1 - t) + x2 * t;\n    }\n    const MAX_ITERATION = 20;\n    const X_DELTA = 0.001;\n    const CACHE_RESOLUTION = 100;\n    function y(cb, x) {\n        let dt = 0.25;\n        let t = 0.5;\n        let y = -1;\n        for (let i = 0; i < MAX_ITERATION; i++) {\n            const [tx, ty] = cb.curve(t);\n            t += dt * (tx < x ? +1 : -1);\n            y = ty;\n            dt *= 0.5;\n            if (Math.abs(x - tx) < X_DELTA) {\n                break;\n            }\n        }\n        return y;\n    }\n    class CubicBezier {\n        constructor(x1 = 0, y1 = 0, x2 = 1, y2 = 1) {\n            this.cache_ = [];\n            this.comps_ = [x1, y1, x2, y2];\n        }\n        get x1() {\n            return this.comps_[0];\n        }\n        get y1() {\n            return this.comps_[1];\n        }\n        get x2() {\n            return this.comps_[2];\n        }\n        get y2() {\n            return this.comps_[3];\n        }\n        static isObject(obj) {\n            if (isEmpty(obj)) {\n                return false;\n            }\n            if (!Array.isArray(obj)) {\n                return false;\n            }\n            return (typeof obj[0] === 'number' &&\n                typeof obj[1] === 'number' &&\n                typeof obj[2] === 'number' &&\n                typeof obj[3] === 'number');\n        }\n        static equals(v1, v2) {\n            return (v1.x1 === v2.x1 && v1.y1 === v2.y1 && v1.x2 === v2.x2 && v1.y2 === v2.y2);\n        }\n        curve(t) {\n            const x01 = interpolate(0, this.x1, t);\n            const y01 = interpolate(0, this.y1, t);\n            const x12 = interpolate(this.x1, this.x2, t);\n            const y12 = interpolate(this.y1, this.y2, t);\n            const x23 = interpolate(this.x2, 1, t);\n            const y23 = interpolate(this.y2, 1, t);\n            const xr0 = interpolate(x01, x12, t);\n            const yr0 = interpolate(y01, y12, t);\n            const xr1 = interpolate(x12, x23, t);\n            const yr1 = interpolate(y12, y23, t);\n            return [interpolate(xr0, xr1, t), interpolate(yr0, yr1, t)];\n        }\n        y(x) {\n            if (this.cache_.length === 0) {\n                const cache = [];\n                for (let i = 0; i < CACHE_RESOLUTION; i++) {\n                    cache.push(y(this, mapRange(i, 0, CACHE_RESOLUTION - 1, 0, 1)));\n                }\n                this.cache_ = cache;\n            }\n            return this.cache_[Math.round(mapRange(constrainRange(x, 0, 1), 0, 1, 0, CACHE_RESOLUTION - 1))];\n        }\n        toObject() {\n            return [this.comps_[0], this.comps_[1], this.comps_[2], this.comps_[3]];\n        }\n    }\n    const CubicBezierAssembly = {\n        toComponents: (p) => p.toObject(),\n        fromComponents: (comps) => new CubicBezier(...comps),\n    };\n\n    function cubicBezierToString(cb) {\n        const formatter = createNumberFormatter(2);\n        const comps = cb.toObject().map((c) => formatter(c));\n        return `cubic-bezier(${comps.join(', ')})`;\n    }\n    const COMPS_EMPTY = [0, 0.5, 0.5, 1];\n    function cubicBezierFromString(text) {\n        const m = text.match(/^cubic-bezier\\s*\\(\\s*([0-9.]+)\\s*,\\s*([0-9.]+)\\s*,\\s*([0-9.]+)\\s*,\\s*([0-9.]+)\\s*\\)$/);\n        if (!m) {\n            return new CubicBezier(...COMPS_EMPTY);\n        }\n        const comps = [m[1], m[2], m[3], m[4]].reduce((comps, comp) => {\n            if (!comps) {\n                return null;\n            }\n            const n = Number(comp);\n            if (isNaN(n)) {\n                return null;\n            }\n            return [...comps, n];\n        }, []);\n        return new CubicBezier(...(comps !== null && comps !== void 0 ? comps : COMPS_EMPTY));\n    }\n\n    const className$7 = ClassName('cbz');\n    class CubicBezierView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$7());\n            config.viewProps.bindClassModifiers(this.element);\n            config.foldable.bindExpandedClass(this.element, className$7(undefined, 'expanded'));\n            bindValueMap(config.foldable, 'completed', valueToClassName(this.element, className$7(undefined, 'cpl')));\n            const headElem = doc.createElement('div');\n            headElem.classList.add(className$7('h'));\n            this.element.appendChild(headElem);\n            const buttonElem = doc.createElement('button');\n            buttonElem.classList.add(className$7('b'));\n            config.viewProps.bindDisabled(buttonElem);\n            const iconElem = doc.createElementNS(SVG_NS, 'svg');\n            iconElem.innerHTML = '<path d=\"M2 13C8 13 8 3 14 3\"/>';\n            buttonElem.appendChild(iconElem);\n            headElem.appendChild(buttonElem);\n            this.buttonElement = buttonElem;\n            const textElem = doc.createElement('div');\n            textElem.classList.add(className$7('t'));\n            headElem.appendChild(textElem);\n            this.textElement = textElem;\n            if (config.pickerLayout === 'inline') {\n                const pickerElem = doc.createElement('div');\n                pickerElem.classList.add(className$7('p'));\n                this.element.appendChild(pickerElem);\n                this.pickerElement = pickerElem;\n            }\n            else {\n                this.pickerElement = null;\n            }\n        }\n    }\n\n    const className$6 = ClassName('cbzp');\n    class CubicBezierPickerView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$6());\n            config.viewProps.bindClassModifiers(this.element);\n            const graphElem = doc.createElement('div');\n            graphElem.classList.add(className$6('g'));\n            this.element.appendChild(graphElem);\n            this.graphElement = graphElem;\n            const textElem = doc.createElement('div');\n            textElem.classList.add(className$6('t'));\n            this.element.appendChild(textElem);\n            this.textElement = textElem;\n        }\n    }\n\n    function waitToBeAddedToDom(elem, callback) {\n        const ob = new MutationObserver((ml) => {\n            for (const m of ml) {\n                if (m.type !== 'childList') {\n                    continue;\n                }\n                m.addedNodes.forEach((elem) => {\n                    if (!elem.contains(elem)) {\n                        return;\n                    }\n                    callback();\n                    ob.disconnect();\n                });\n            }\n        });\n        const doc = elem.ownerDocument;\n        ob.observe(doc.body, {\n            attributes: true,\n            childList: true,\n            subtree: true,\n        });\n    }\n\n    const className$5 = ClassName('cbzg');\n    // TODO: Apply to core\n    function compose(h1, h2) {\n        return (input) => h2(h1(input));\n    }\n    class CubicBezierGraphView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$5());\n            config.viewProps.bindClassModifiers(this.element);\n            config.viewProps.bindTabIndex(this.element);\n            const previewElem = doc.createElement('div');\n            previewElem.classList.add(className$5('p'));\n            this.element.appendChild(previewElem);\n            this.previewElement = previewElem;\n            const svgElem = doc.createElementNS(SVG_NS, 'svg');\n            svgElem.classList.add(className$5('g'));\n            this.element.appendChild(svgElem);\n            this.svgElem_ = svgElem;\n            const guideElem = doc.createElementNS(SVG_NS, 'path');\n            guideElem.classList.add(className$5('u'));\n            this.svgElem_.appendChild(guideElem);\n            this.guideElem_ = guideElem;\n            const lineElem = doc.createElementNS(SVG_NS, 'polyline');\n            lineElem.classList.add(className$5('l'));\n            this.svgElem_.appendChild(lineElem);\n            this.lineElem_ = lineElem;\n            this.handleElems_ = [doc.createElement('div'), doc.createElement('div')];\n            this.handleElems_.forEach((elem) => {\n                elem.classList.add(className$5('h'));\n                this.element.appendChild(elem);\n            });\n            this.vectorElems_ = [\n                doc.createElementNS(SVG_NS, 'line'),\n                doc.createElementNS(SVG_NS, 'line'),\n            ];\n            this.vectorElems_.forEach((elem) => {\n                elem.classList.add(className$5('v'));\n                this.svgElem_.appendChild(elem);\n            });\n            this.value_ = config.value;\n            this.value_.emitter.on('change', this.onValueChange_.bind(this));\n            this.sel_ = config.selection;\n            this.handleElems_.forEach((elem, index) => {\n                bindValue(this.sel_, compose((selection) => selection === index, valueToClassName(elem, className$5('h', 'sel'))));\n            });\n            waitToBeAddedToDom(this.element, () => {\n                this.refresh();\n            });\n        }\n        getVertMargin_(h) {\n            return h * 0.25;\n        }\n        valueToPosition(x, y) {\n            const bounds = this.element.getBoundingClientRect();\n            const w = bounds.width;\n            const h = bounds.height;\n            const vm = this.getVertMargin_(h);\n            return {\n                x: mapRange(x, 0, 1, 0, w),\n                y: mapRange(y, 0, 1, h - vm, vm),\n            };\n        }\n        positionToValue(x, y) {\n            const bounds = this.element.getBoundingClientRect();\n            const w = bounds.width;\n            const h = bounds.height;\n            const vm = this.getVertMargin_(h);\n            return {\n                x: constrainRange(mapRange(x, 0, w, 0, 1), 0, 1),\n                y: mapRange(y, h - vm, vm, 0, 1),\n            };\n        }\n        refresh() {\n            this.guideElem_.setAttributeNS(null, 'd', [0, 1]\n                .map((index) => {\n                const p1 = this.valueToPosition(0, index);\n                const p2 = this.valueToPosition(1, index);\n                return [`M ${p1.x},${p1.y}`, `L ${p2.x},${p2.y}`].join(' ');\n            })\n                .join(' '));\n            const bezier = this.value_.rawValue;\n            const points = [];\n            let t = 0;\n            for (;;) {\n                const p = this.valueToPosition(...bezier.curve(t));\n                points.push([p.x, p.y].join(','));\n                if (t >= 1) {\n                    break;\n                }\n                t = Math.min(t + 0.05, 1);\n            }\n            this.lineElem_.setAttributeNS(null, 'points', points.join(' '));\n            const obj = bezier.toObject();\n            [0, 1].forEach((index) => {\n                const p1 = this.valueToPosition(index, index);\n                const p2 = this.valueToPosition(obj[index * 2], obj[index * 2 + 1]);\n                const vElem = this.vectorElems_[index];\n                vElem.setAttributeNS(null, 'x1', String(p1.x));\n                vElem.setAttributeNS(null, 'y1', String(p1.y));\n                vElem.setAttributeNS(null, 'x2', String(p2.x));\n                vElem.setAttributeNS(null, 'y2', String(p2.y));\n                const hElem = this.handleElems_[index];\n                hElem.style.left = `${p2.x}px`;\n                hElem.style.top = `${p2.y}px`;\n            });\n        }\n        onValueChange_() {\n            this.refresh();\n        }\n    }\n\n    const TICK_COUNT = 24;\n    const PREVIEW_DELAY = 400;\n    const PREVIEW_DURATION = 1000;\n    const className$4 = ClassName('cbzprv');\n    class CubicBezierPreviewView {\n        constructor(doc, config) {\n            this.stopped_ = true;\n            this.startTime_ = -1;\n            this.onDispose_ = this.onDispose_.bind(this);\n            this.onTimer_ = this.onTimer_.bind(this);\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$4());\n            config.viewProps.bindClassModifiers(this.element);\n            const svgElem = doc.createElementNS(SVG_NS, 'svg');\n            svgElem.classList.add(className$4('g'));\n            this.element.appendChild(svgElem);\n            this.svgElem_ = svgElem;\n            const ticksElem = doc.createElementNS(SVG_NS, 'path');\n            ticksElem.classList.add(className$4('t'));\n            this.svgElem_.appendChild(ticksElem);\n            this.ticksElem_ = ticksElem;\n            const markerElem = doc.createElement('div');\n            markerElem.classList.add(className$4('m'));\n            this.element.appendChild(markerElem);\n            this.markerElem_ = markerElem;\n            this.value_ = config.value;\n            this.value_.emitter.on('change', this.onValueChange_);\n            config.viewProps.handleDispose(this.onDispose_);\n            waitToBeAddedToDom(this.element, () => {\n                this.refresh();\n            });\n        }\n        play() {\n            this.stop();\n            this.updateMarker_(0);\n            this.markerElem_.classList.add(className$4('m', 'a'));\n            this.startTime_ = new Date().getTime() + PREVIEW_DELAY;\n            this.stopped_ = false;\n            requestAnimationFrame(this.onTimer_);\n        }\n        stop() {\n            this.stopped_ = true;\n            this.markerElem_.classList.remove(className$4('m', 'a'));\n        }\n        onDispose_() {\n            this.stop();\n        }\n        updateMarker_(progress) {\n            const p = this.value_.rawValue.y(constrainRange(progress, 0, 1));\n            this.markerElem_.style.left = `${p * 100}%`;\n        }\n        refresh() {\n            const bounds = this.svgElem_.getBoundingClientRect();\n            const w = bounds.width;\n            const h = bounds.height;\n            const ds = [];\n            const bezier = this.value_.rawValue;\n            for (let i = 0; i < TICK_COUNT; i++) {\n                const px = mapRange(i, 0, TICK_COUNT - 1, 0, 1);\n                const x = mapRange(bezier.y(px), 0, 1, 0, w);\n                ds.push(`M ${x},0 v${h}`);\n            }\n            this.ticksElem_.setAttributeNS(null, 'd', ds.join(' '));\n        }\n        onTimer_() {\n            if (this.startTime_ === null) {\n                return;\n            }\n            const dt = new Date().getTime() - this.startTime_;\n            const p = dt / PREVIEW_DURATION;\n            this.updateMarker_(p);\n            if (dt > PREVIEW_DURATION + PREVIEW_DELAY) {\n                this.stop();\n            }\n            if (!this.stopped_) {\n                requestAnimationFrame(this.onTimer_);\n            }\n        }\n        onValueChange_() {\n            this.refresh();\n            this.play();\n        }\n    }\n\n    function getDistance(x1, y1, x2, y2) {\n        const dx = x2 - x1;\n        const dy = y2 - y1;\n        return Math.sqrt(dx * dx + dy * dy);\n    }\n    function lockAngle(x1, y1, x2, y2) {\n        const d = getDistance(x1, y1, x2, y2);\n        const a = Math.atan2(y2 - y1, x2 - x1);\n        const la = (Math.round(a / (Math.PI / 4)) * Math.PI) / 4;\n        return {\n            x: x1 + Math.cos(la) * d,\n            y: y1 + Math.sin(la) * d,\n        };\n    }\n    class CubicBezierGraphController {\n        constructor(doc, config) {\n            this.onKeyDown_ = this.onKeyDown_.bind(this);\n            this.onKeyUp_ = this.onKeyUp_.bind(this);\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.baseStep_ = config.baseStep;\n            this.value = config.value;\n            this.sel_ = createValue(0);\n            this.viewProps = config.viewProps;\n            this.view = new CubicBezierGraphView(doc, {\n                selection: this.sel_,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.element.addEventListener('keydown', this.onKeyDown_);\n            this.view.element.addEventListener('keyup', this.onKeyUp_);\n            this.prevView_ = new CubicBezierPreviewView(doc, {\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.prevView_.element.addEventListener('mousedown', (ev) => {\n                ev.stopImmediatePropagation();\n                ev.preventDefault();\n                this.prevView_.play();\n            });\n            this.view.previewElement.appendChild(this.prevView_.element);\n            const ptHandler = new PointerHandler(this.view.element);\n            ptHandler.emitter.on('down', this.onPointerDown_);\n            ptHandler.emitter.on('move', this.onPointerMove_);\n            ptHandler.emitter.on('up', this.onPointerUp_);\n        }\n        refresh() {\n            this.view.refresh();\n            this.prevView_.refresh();\n            this.prevView_.play();\n        }\n        updateValue_(point, locksAngle, opts) {\n            const index = this.sel_.rawValue;\n            const comps = this.value.rawValue.toObject();\n            const vp = this.view.positionToValue(point.x, point.y);\n            const v = locksAngle ? lockAngle(index, index, vp.x, vp.y) : vp;\n            comps[index * 2] = v.x;\n            comps[index * 2 + 1] = v.y;\n            this.value.setRawValue(new CubicBezier(...comps), opts);\n        }\n        onPointerDown_(ev) {\n            const data = ev.data;\n            if (!data.point) {\n                return;\n            }\n            const bezier = this.value.rawValue;\n            const p1 = this.view.valueToPosition(bezier.x1, bezier.y1);\n            const d1 = getDistance(data.point.x, data.point.y, p1.x, p1.y);\n            const p2 = this.view.valueToPosition(bezier.x2, bezier.y2);\n            const d2 = getDistance(data.point.x, data.point.y, p2.x, p2.y);\n            this.sel_.rawValue = d1 <= d2 ? 0 : 1;\n            this.updateValue_(data.point, ev.shiftKey, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerMove_(ev) {\n            const data = ev.data;\n            if (!data.point) {\n                return;\n            }\n            this.updateValue_(data.point, ev.shiftKey, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            const data = ev.data;\n            if (!data.point) {\n                return;\n            }\n            this.updateValue_(data.point, ev.shiftKey, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n        onKeyDown_(ev) {\n            if (isArrowKey(ev.key)) {\n                ev.preventDefault();\n            }\n            const index = this.sel_.rawValue;\n            const comps = this.value.rawValue.toObject();\n            comps[index * 2] += getStepForKey(this.baseStep_, getHorizontalStepKeys(ev));\n            comps[index * 2 + 1] += getStepForKey(this.baseStep_, getVerticalStepKeys(ev));\n            this.value.setRawValue(new CubicBezier(...comps), {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onKeyUp_(ev) {\n            if (isArrowKey(ev.key)) {\n                ev.preventDefault();\n            }\n            const xStep = getStepForKey(this.baseStep_, getHorizontalStepKeys(ev));\n            const yStep = getStepForKey(this.baseStep_, getVerticalStepKeys(ev));\n            if (xStep === 0 && yStep === 0) {\n                return;\n            }\n            this.value.setRawValue(this.value.rawValue, {\n                forceEmit: true,\n                last: true,\n            });\n        }\n    }\n\n    class CubicBezierPickerController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new CubicBezierPickerView(doc, {\n                viewProps: this.viewProps,\n            });\n            this.gc_ = new CubicBezierGraphController(doc, {\n                baseStep: config.axis.baseStep,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.graphElement.appendChild(this.gc_.view.element);\n            const xAxis = Object.assign(Object.assign({}, config.axis), { constraint: new RangeConstraint({ max: 1, min: 0 }) });\n            const yAxis = Object.assign(Object.assign({}, config.axis), { constraint: undefined });\n            this.tc_ = new PointNdTextController(doc, {\n                assembly: CubicBezierAssembly,\n                axes: [xAxis, yAxis, xAxis, yAxis],\n                parser: parseNumber,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.textElement.appendChild(this.tc_.view.element);\n        }\n        get allFocusableElements() {\n            return [\n                this.gc_.view.element,\n                ...this.tc_.view.textViews.map((v) => v.inputElement),\n            ];\n        }\n        refresh() {\n            this.gc_.refresh();\n        }\n    }\n\n    class CubicBezierController {\n        constructor(doc, config) {\n            this.onButtonBlur_ = this.onButtonBlur_.bind(this);\n            this.onButtonClick_ = this.onButtonClick_.bind(this);\n            this.onPopupChildBlur_ = this.onPopupChildBlur_.bind(this);\n            this.onPopupChildKeydown_ = this.onPopupChildKeydown_.bind(this);\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.foldable_ = createFoldable(config.expanded);\n            this.view = new CubicBezierView(doc, {\n                foldable: this.foldable_,\n                pickerLayout: config.pickerLayout,\n                viewProps: this.viewProps,\n            });\n            this.view.buttonElement.addEventListener('blur', this.onButtonBlur_);\n            this.view.buttonElement.addEventListener('click', this.onButtonClick_);\n            this.tc_ = new TextController(doc, {\n                parser: cubicBezierFromString,\n                props: ValueMap.fromObject({\n                    formatter: cubicBezierToString,\n                }),\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            this.view.textElement.appendChild(this.tc_.view.element);\n            this.popC_ =\n                config.pickerLayout === 'popup'\n                    ? new PopupController(doc, {\n                        viewProps: this.viewProps,\n                    })\n                    : null;\n            const pickerC = new CubicBezierPickerController(doc, {\n                axis: config.axis,\n                value: this.value,\n                viewProps: this.viewProps,\n            });\n            pickerC.allFocusableElements.forEach((elem) => {\n                elem.addEventListener('blur', this.onPopupChildBlur_);\n                elem.addEventListener('keydown', this.onPopupChildKeydown_);\n            });\n            this.pickerC_ = pickerC;\n            if (this.popC_) {\n                this.view.element.appendChild(this.popC_.view.element);\n                this.popC_.view.element.appendChild(this.pickerC_.view.element);\n                bindValue(this.popC_.shows, (shows) => {\n                    if (shows) {\n                        pickerC.refresh();\n                    }\n                });\n                connectValues({\n                    primary: this.foldable_.value('expanded'),\n                    secondary: this.popC_.shows,\n                    forward: (p) => p.rawValue,\n                    backward: (_, s) => s.rawValue,\n                });\n            }\n            else if (this.view.pickerElement) {\n                this.view.pickerElement.appendChild(this.pickerC_.view.element);\n                bindFoldable(this.foldable_, this.view.pickerElement);\n            }\n        }\n        onButtonBlur_(ev) {\n            if (!this.popC_) {\n                return;\n            }\n            const nextTarget = forceCast(ev.relatedTarget);\n            if (!nextTarget || !this.popC_.view.element.contains(nextTarget)) {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n        onButtonClick_() {\n            this.foldable_.set('expanded', !this.foldable_.get('expanded'));\n            if (this.foldable_.get('expanded')) {\n                this.pickerC_.allFocusableElements[0].focus();\n            }\n        }\n        onPopupChildBlur_(ev) {\n            if (!this.popC_) {\n                return;\n            }\n            const elem = this.popC_.view.element;\n            const nextTarget = findNextTarget(ev);\n            if (nextTarget && elem.contains(nextTarget)) {\n                // Next target is in the popup\n                return;\n            }\n            if (nextTarget &&\n                nextTarget === this.view.buttonElement &&\n                !supportsTouch(elem.ownerDocument)) {\n                // Next target is the trigger button\n                return;\n            }\n            this.popC_.shows.rawValue = false;\n        }\n        onPopupChildKeydown_(ev) {\n            if (!this.popC_) {\n                return;\n            }\n            if (ev.key === 'Escape') {\n                this.popC_.shows.rawValue = false;\n            }\n        }\n    }\n\n    function createConstraint$1() {\n        return new PointNdConstraint({\n            assembly: CubicBezierAssembly,\n            components: [0, 1, 2, 3].map((index) => index % 2 === 0\n                ? new RangeConstraint({\n                    min: 0,\n                    max: 1,\n                })\n                : undefined),\n        });\n    }\n    const CubicBezierBladePlugin = {\n        id: 'cubic-bezier',\n        type: 'blade',\n        css: '.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                value: p.required.array(p.required.number),\n                view: p.required.constant('cubicbezier'),\n                expanded: p.optional.boolean,\n                label: p.optional.string,\n                picker: p.optional.custom((v) => {\n                    return v === 'inline' || v === 'popup' ? v : undefined;\n                }),\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            var _a, _b;\n            const rv = new CubicBezier(...args.params.value);\n            const v = createValue(rv, {\n                constraint: createConstraint$1(),\n                equals: CubicBezier.equals,\n            });\n            const vc = new CubicBezierController(args.document, {\n                axis: {\n                    baseStep: 0.1,\n                    textProps: ValueMap.fromObject({\n                        draggingScale: 0.01,\n                        formatter: createNumberFormatter(2),\n                    }),\n                },\n                expanded: (_a = args.params.expanded) !== null && _a !== void 0 ? _a : false,\n                pickerLayout: (_b = args.params.picker) !== null && _b !== void 0 ? _b : 'popup',\n                value: v,\n                viewProps: args.viewProps,\n            });\n            return new LabeledValueController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                valueController: vc,\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabeledValueController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof CubicBezierController)) {\n                return null;\n            }\n            return new CubicBezierApi(args.controller);\n        },\n    };\n\n    class FpsGraphBladeApi extends BladeApi {\n        begin() {\n            this.controller_.valueController.begin();\n        }\n        end() {\n            this.controller_.valueController.end();\n        }\n    }\n\n    const MAX_TIMESTAMPS = 20;\n    class Fpswatch {\n        constructor() {\n            this.start_ = null;\n            this.duration_ = 0;\n            this.fps_ = null;\n            this.frameCount_ = 0;\n            this.timestamps_ = [];\n        }\n        get duration() {\n            return this.duration_;\n        }\n        get fps() {\n            return this.fps_;\n        }\n        begin(now) {\n            this.start_ = now.getTime();\n        }\n        calculateFps_(nowTime) {\n            if (this.timestamps_.length === 0) {\n                return null;\n            }\n            const ts = this.timestamps_[0];\n            return (1000 * (this.frameCount_ - ts.frameCount)) / (nowTime - ts.time);\n        }\n        compactTimestamps_() {\n            if (this.timestamps_.length <= MAX_TIMESTAMPS) {\n                return;\n            }\n            const len = this.timestamps_.length - MAX_TIMESTAMPS;\n            this.timestamps_.splice(0, len);\n            const df = this.timestamps_[0].frameCount;\n            this.timestamps_.forEach((ts) => {\n                ts.frameCount -= df;\n            });\n            this.frameCount_ -= df;\n        }\n        end(now) {\n            if (this.start_ === null) {\n                return;\n            }\n            const t = now.getTime();\n            this.duration_ = t - this.start_;\n            this.start_ = null;\n            this.fps_ = this.calculateFps_(t);\n            this.timestamps_.push({\n                frameCount: this.frameCount_,\n                time: t,\n            });\n            ++this.frameCount_;\n            this.compactTimestamps_();\n        }\n    }\n\n    const className$3 = ClassName('fps');\n    class FpsView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$3());\n            config.viewProps.bindClassModifiers(this.element);\n            this.graphElement = doc.createElement('div');\n            this.graphElement.classList.add(className$3('g'));\n            this.element.appendChild(this.graphElement);\n            const labelElement = doc.createElement('div');\n            labelElement.classList.add(className$3('l'));\n            this.element.appendChild(labelElement);\n            const valueElement = doc.createElement('span');\n            valueElement.classList.add(className$3('v'));\n            valueElement.textContent = '--';\n            labelElement.appendChild(valueElement);\n            this.valueElement = valueElement;\n            const unitElement = doc.createElement('span');\n            unitElement.classList.add(className$3('u'));\n            unitElement.textContent = 'FPS';\n            labelElement.appendChild(unitElement);\n        }\n    }\n\n    class FpsGraphController {\n        constructor(doc, config) {\n            this.stopwatch_ = new Fpswatch();\n            this.onTick_ = this.onTick_.bind(this);\n            this.ticker_ = config.ticker;\n            this.ticker_.emitter.on('tick', this.onTick_);\n            this.value_ = config.value;\n            this.viewProps = config.viewProps;\n            this.view = new FpsView(doc, {\n                viewProps: this.viewProps,\n            });\n            this.graphC_ = new GraphLogController(doc, {\n                formatter: createNumberFormatter(0),\n                lineCount: config.lineCount,\n                props: ValueMap.fromObject({\n                    maxValue: config.maxValue,\n                    minValue: config.minValue,\n                }),\n                value: this.value_,\n                viewProps: this.viewProps,\n            });\n            this.view.graphElement.appendChild(this.graphC_.view.element);\n            this.viewProps.handleDispose(() => {\n                this.graphC_.viewProps.set('disposed', true);\n                this.ticker_.dispose();\n            });\n        }\n        begin() {\n            this.stopwatch_.begin(new Date());\n        }\n        end() {\n            this.stopwatch_.end(new Date());\n        }\n        onTick_() {\n            const fps = this.stopwatch_.fps;\n            if (fps !== null) {\n                const buffer = this.value_.rawValue;\n                this.value_.rawValue = createPushedBuffer(buffer, fps);\n                this.view.valueElement.textContent = fps.toFixed(0);\n            }\n        }\n    }\n\n    function createTicker(document, interval) {\n        return interval === 0\n            ? new ManualTicker()\n            : new IntervalTicker(document, interval !== null && interval !== void 0 ? interval : Constants.monitor.defaultInterval);\n    }\n    const FpsGraphBladePlugin = {\n        id: 'fpsgraph',\n        type: 'blade',\n        accept(params) {\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                view: p.required.constant('fpsgraph'),\n                interval: p.optional.number,\n                label: p.optional.string,\n                lineCount: p.optional.number,\n                max: p.optional.number,\n                min: p.optional.number,\n            });\n            return result ? { params: result } : null;\n        },\n        controller(args) {\n            var _a, _b, _c, _d;\n            const interval = (_a = args.params.interval) !== null && _a !== void 0 ? _a : 500;\n            return new LabelController(args.document, {\n                blade: args.blade,\n                props: ValueMap.fromObject({\n                    label: args.params.label,\n                }),\n                valueController: new FpsGraphController(args.document, {\n                    lineCount: (_b = args.params.lineCount) !== null && _b !== void 0 ? _b : 2,\n                    maxValue: (_c = args.params.max) !== null && _c !== void 0 ? _c : 90,\n                    minValue: (_d = args.params.min) !== null && _d !== void 0 ? _d : 0,\n                    ticker: createTicker(args.document, interval),\n                    value: initializeBuffer(80),\n                    viewProps: args.viewProps,\n                }),\n            });\n        },\n        api(args) {\n            if (!(args.controller instanceof LabelController)) {\n                return null;\n            }\n            if (!(args.controller.valueController instanceof FpsGraphController)) {\n                return null;\n            }\n            return new FpsGraphBladeApi(args.controller);\n        },\n    };\n\n    class Interval {\n        constructor(min, max) {\n            this.min = min;\n            this.max = max;\n        }\n        static isObject(obj) {\n            if (typeof obj !== 'object' || obj === null) {\n                return false;\n            }\n            const min = obj.min;\n            const max = obj.max;\n            if (typeof min !== 'number' || typeof max !== 'number') {\n                return false;\n            }\n            return true;\n        }\n        static equals(v1, v2) {\n            return v1.min === v2.min && v1.max === v2.max;\n        }\n        get length() {\n            return this.max - this.min;\n        }\n        toObject() {\n            return {\n                min: this.min,\n                max: this.max,\n            };\n        }\n    }\n    const IntervalAssembly = {\n        fromComponents: (comps) => new Interval(comps[0], comps[1]),\n        toComponents: (p) => [p.min, p.max],\n    };\n\n    class IntervalConstraint {\n        constructor(edge) {\n            this.edge = edge;\n        }\n        constrain(value) {\n            var _a, _b, _c, _d, _e, _f, _g, _h;\n            if (value.min <= value.max) {\n                return new Interval((_b = (_a = this.edge) === null || _a === void 0 ? void 0 : _a.constrain(value.min)) !== null && _b !== void 0 ? _b : value.min, (_d = (_c = this.edge) === null || _c === void 0 ? void 0 : _c.constrain(value.max)) !== null && _d !== void 0 ? _d : value.max);\n            }\n            const c = (value.min + value.max) / 2;\n            return new Interval((_f = (_e = this.edge) === null || _e === void 0 ? void 0 : _e.constrain(c)) !== null && _f !== void 0 ? _f : c, (_h = (_g = this.edge) === null || _g === void 0 ? void 0 : _g.constrain(c)) !== null && _h !== void 0 ? _h : c);\n        }\n    }\n\n    const className$2 = ClassName('rsltxt');\n    class RangeSliderTextView {\n        constructor(doc, config) {\n            this.sliderView_ = config.sliderView;\n            this.textView_ = config.textView;\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$2());\n            const sliderElem = doc.createElement('div');\n            sliderElem.classList.add(className$2('s'));\n            sliderElem.appendChild(this.sliderView_.element);\n            this.element.appendChild(sliderElem);\n            const textElem = doc.createElement('div');\n            textElem.classList.add(className$2('t'));\n            textElem.appendChild(this.textView_.element);\n            this.element.appendChild(textElem);\n        }\n    }\n\n    const className$1 = ClassName('rsl');\n    class RangeSliderView {\n        constructor(doc, config) {\n            this.onSliderPropsChange_ = this.onSliderPropsChange_.bind(this);\n            this.onValueChange_ = this.onValueChange_.bind(this);\n            this.sliderProps_ = config.sliderProps;\n            this.sliderProps_.emitter.on('change', this.onSliderPropsChange_);\n            this.element = doc.createElement('div');\n            this.element.classList.add(className$1());\n            config.viewProps.bindClassModifiers(this.element);\n            this.value_ = config.value;\n            this.value_.emitter.on('change', this.onValueChange_);\n            const trackElem = doc.createElement('div');\n            trackElem.classList.add(className$1('t'));\n            this.element.appendChild(trackElem);\n            this.trackElement = trackElem;\n            const barElem = doc.createElement('div');\n            barElem.classList.add(className$1('b'));\n            trackElem.appendChild(barElem);\n            this.barElement = barElem;\n            const knobElems = ['min', 'max'].map((modifier) => {\n                const elem = doc.createElement('div');\n                elem.classList.add(className$1('k'), className$1('k', modifier));\n                trackElem.appendChild(elem);\n                return elem;\n            });\n            this.knobElements = [knobElems[0], knobElems[1]];\n            this.update_();\n        }\n        valueToX_(value) {\n            const min = this.sliderProps_.get('minValue');\n            const max = this.sliderProps_.get('maxValue');\n            return constrainRange(mapRange(value, min, max, 0, 1), 0, 1) * 100;\n        }\n        update_() {\n            const v = this.value_.rawValue;\n            if (v.length === 0) {\n                this.element.classList.add(className$1(undefined, 'zero'));\n            }\n            else {\n                this.element.classList.remove(className$1(undefined, 'zero'));\n            }\n            const xs = [this.valueToX_(v.min), this.valueToX_(v.max)];\n            this.barElement.style.left = `${xs[0]}%`;\n            this.barElement.style.right = `${100 - xs[1]}%`;\n            this.knobElements.forEach((elem, index) => {\n                elem.style.left = `${xs[index]}%`;\n            });\n        }\n        onSliderPropsChange_() {\n            this.update_();\n        }\n        onValueChange_() {\n            this.update_();\n        }\n    }\n\n    class RangeSliderController {\n        constructor(doc, config) {\n            this.grabbing_ = null;\n            this.grabOffset_ = 0;\n            this.onPointerDown_ = this.onPointerDown_.bind(this);\n            this.onPointerMove_ = this.onPointerMove_.bind(this);\n            this.onPointerUp_ = this.onPointerUp_.bind(this);\n            this.sliderProps = config.sliderProps;\n            this.viewProps = config.viewProps;\n            this.value = config.value;\n            this.view = new RangeSliderView(doc, {\n                sliderProps: this.sliderProps,\n                value: this.value,\n                viewProps: config.viewProps,\n            });\n            const ptHandler = new PointerHandler(this.view.trackElement);\n            ptHandler.emitter.on('down', this.onPointerDown_);\n            ptHandler.emitter.on('move', this.onPointerMove_);\n            ptHandler.emitter.on('up', this.onPointerUp_);\n        }\n        ofs_() {\n            if (this.grabbing_ === 'min') {\n                return this.view.knobElements[0].getBoundingClientRect().width / 2;\n            }\n            if (this.grabbing_ === 'max') {\n                return -this.view.knobElements[1].getBoundingClientRect().width / 2;\n            }\n            return 0;\n        }\n        valueFromData_(data) {\n            if (!data.point) {\n                return null;\n            }\n            const p = (data.point.x + this.ofs_()) / data.bounds.width;\n            const min = this.sliderProps.get('minValue');\n            const max = this.sliderProps.get('maxValue');\n            return mapRange(p, 0, 1, min, max);\n        }\n        onPointerDown_(ev) {\n            if (!ev.data.point) {\n                return;\n            }\n            const p = ev.data.point.x / ev.data.bounds.width;\n            const v = this.value.rawValue;\n            const min = this.sliderProps.get('minValue');\n            const max = this.sliderProps.get('maxValue');\n            const pmin = mapRange(v.min, min, max, 0, 1);\n            const pmax = mapRange(v.max, min, max, 0, 1);\n            if (Math.abs(pmax - p) <= 0.025) {\n                this.grabbing_ = 'max';\n            }\n            else if (Math.abs(pmin - p) <= 0.025) {\n                this.grabbing_ = 'min';\n            }\n            else if (p >= pmin && p <= pmax) {\n                this.grabbing_ = 'length';\n                this.grabOffset_ = mapRange(p - pmin, 0, 1, 0, max - min);\n            }\n            else if (p < pmin) {\n                this.grabbing_ = 'min';\n                this.onPointerMove_(ev);\n            }\n            else if (p > pmax) {\n                this.grabbing_ = 'max';\n                this.onPointerMove_(ev);\n            }\n        }\n        applyPointToValue_(data, opts) {\n            const v = this.valueFromData_(data);\n            if (v === null) {\n                return;\n            }\n            const rmin = this.sliderProps.get('minValue');\n            const rmax = this.sliderProps.get('maxValue');\n            if (this.grabbing_ === 'min') {\n                this.value.setRawValue(new Interval(v, this.value.rawValue.max), opts);\n            }\n            else if (this.grabbing_ === 'max') {\n                this.value.setRawValue(new Interval(this.value.rawValue.min, v), opts);\n            }\n            else if (this.grabbing_ === 'length') {\n                const len = this.value.rawValue.length;\n                let min = v - this.grabOffset_;\n                let max = min + len;\n                if (min < rmin) {\n                    min = rmin;\n                    max = rmin + len;\n                }\n                else if (max > rmax) {\n                    min = rmax - len;\n                    max = rmax;\n                }\n                this.value.setRawValue(new Interval(min, max), opts);\n            }\n        }\n        onPointerMove_(ev) {\n            this.applyPointToValue_(ev.data, {\n                forceEmit: false,\n                last: false,\n            });\n        }\n        onPointerUp_(ev) {\n            this.applyPointToValue_(ev.data, {\n                forceEmit: true,\n                last: true,\n            });\n            this.grabbing_ = null;\n        }\n    }\n\n    class RangeSliderTextController {\n        constructor(doc, config) {\n            this.value = config.value;\n            this.viewProps = config.viewProps;\n            this.sc_ = new RangeSliderController(doc, config);\n            const axis = {\n                baseStep: config.baseStep,\n                constraint: config.constraint,\n                textProps: ValueMap.fromObject({\n                    draggingScale: config.draggingScale,\n                    formatter: config.formatter,\n                }),\n            };\n            this.tc_ = new PointNdTextController(doc, {\n                assembly: IntervalAssembly,\n                axes: [axis, axis],\n                parser: config.parser,\n                value: this.value,\n                viewProps: config.viewProps,\n            });\n            this.view = new RangeSliderTextView(doc, {\n                sliderView: this.sc_.view,\n                textView: this.tc_.view,\n            });\n        }\n        get textController() {\n            return this.tc_;\n        }\n    }\n\n    function intervalFromUnknown(value) {\n        return Interval.isObject(value)\n            ? new Interval(value.min, value.max)\n            : new Interval(0, 0);\n    }\n    function writeInterval(target, value) {\n        target.writeProperty('max', value.max);\n        target.writeProperty('min', value.min);\n    }\n\n    function createConstraint(params) {\n        const constraints = [];\n        const rc = createRangeConstraint(params);\n        if (rc) {\n            constraints.push(rc);\n        }\n        const sc = createStepConstraint(params);\n        if (sc) {\n            constraints.push(sc);\n        }\n        return new IntervalConstraint(new CompositeConstraint(constraints));\n    }\n    const IntervalInputPlugin = {\n        id: 'input-interval',\n        type: 'input',\n        css: '.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:\"\";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',\n        accept: (exValue, params) => {\n            if (!Interval.isObject(exValue)) {\n                return null;\n            }\n            const p = ParamsParsers;\n            const result = parseParams(params, {\n                format: p.optional.function,\n                max: p.optional.number,\n                min: p.optional.number,\n                step: p.optional.number,\n            });\n            return result\n                ? {\n                    initialValue: new Interval(exValue.min, exValue.max),\n                    params: result,\n                }\n                : null;\n        },\n        binding: {\n            reader: (_args) => intervalFromUnknown,\n            constraint: (args) => createConstraint(args.params),\n            equals: Interval.equals,\n            writer: (_args) => writeInterval,\n        },\n        controller(args) {\n            var _a;\n            const v = args.value;\n            const c = args.constraint;\n            if (!(c instanceof IntervalConstraint)) {\n                throw TpError.shouldNeverHappen();\n            }\n            const midValue = (v.rawValue.min + v.rawValue.max) / 2;\n            const formatter = (_a = args.params.format) !== null && _a !== void 0 ? _a : createNumberFormatter(getSuitableDecimalDigits(c.edge, midValue));\n            const drc = c.edge && findConstraint(c.edge, DefiniteRangeConstraint);\n            if (drc) {\n                return new RangeSliderTextController(args.document, {\n                    baseStep: getBaseStep(c.edge),\n                    constraint: c.edge,\n                    draggingScale: getSuitableDraggingScale(c.edge, midValue),\n                    formatter: formatter,\n                    parser: parseNumber,\n                    sliderProps: new ValueMap({\n                        maxValue: drc.values.value('max'),\n                        minValue: drc.values.value('min'),\n                    }),\n                    value: v,\n                    viewProps: args.viewProps,\n                });\n            }\n            const axis = {\n                baseStep: getBaseStep(c.edge),\n                constraint: c.edge,\n                textProps: ValueMap.fromObject({\n                    draggingScale: midValue,\n                    formatter: formatter,\n                }),\n            };\n            return new PointNdTextController(args.document, {\n                assembly: IntervalAssembly,\n                axes: [axis, axis],\n                parser: parseNumber,\n                value: v,\n                viewProps: args.viewProps,\n            });\n        },\n    };\n\n    class RadioCellApi {\n        constructor(controller) {\n            this.controller_ = controller;\n        }\n        get disabled() {\n            return this.controller_.viewProps.get('disabled');\n        }\n        set disabled(disabled) {\n            this.controller_.viewProps.set('disabled', disabled);\n        }\n        get title() {\n            var _a;\n            return (_a = this.controller_.props.get('title')) !== null && _a !== void 0 ? _a : '';\n        }\n        set title(title) {\n            this.controller_.props.set('title', title);\n        }\n    }\n\n    class TpRadioGridChangeEvent extends TpChangeEvent {\n        constructor(target, cell, index, value, presetKey) {\n            super(target, value, presetKey);\n            this.cell = cell;\n            this.index = index;\n        }\n    }\n\n    class RadioGridApi extends BladeApi {\n        constructor(controller) {\n            super(controller);\n            this.cellToApiMap_ = new Map();\n            const gc = this.controller_.valueController;\n            gc.cellControllers.forEach((cc) => {\n                const api = new RadioCellApi(cc);\n                this.cellToApiMap_.set(cc, api);\n            });\n        }\n        get value() {\n            return this.controller_.value;\n        }\n        cell(x, y) {\n            const gc = this.controller_.valueController;\n            const cc = gc.cellControllers[y * gc.size[0] + x];\n            return this.cellToApiMap_.get(cc);\n        }\n        on(eventName, handler) {\n            const bh = handler.bind(this);\n            this.controller_.value.emitter.on(eventName, (ev) => {\n                const gc = this.controller_.valueController;\n                const cc = gc.findCellByValue(ev.rawValue);\n                if (!cc) {\n                    return;\n                }\n                const capi = this.cellToApiMap_.get(cc);\n                if (!capi) {\n                    return;\n                }\n                const i = gc.cellControllers.indexOf(cc);\n                bh(new TpRadioGridChangeEvent(this, capi, [i % gc.size[0], Math.floor(i / gc.size[0])], ev.rawValue, undefined));\n            });\n        }\n    }\n\n    const className = ClassName('rad');\n    class RadioView {\n        constructor(doc, config) {\n            this.element = doc.createElement('div');\n            this.element.classList.add(className());\n            config.viewProps.bindClassModifiers(this.element);\n            const labelElem = doc.createElement('label');\n            labelElem.classList.add(className('l'));\n            this.element.appendChild(labelElem);\n            const inputElem = doc.createElement('input');\n            inputElem.classList.add(className('i'));\n            inputElem.name = config.name;\n            inputElem.type = 'radio';\n            config.viewProps.bindDisabled(inputElem);\n            labelElem.appendChild(inputElem);\n            this.inputElement = inputElem;\n            const bodyElem = doc.createElement('div');\n            bodyElem.classList.add(className('b'));\n            labelElem.appendChild(bodyElem);\n            const titleElem = doc.createElement('div');\n            titleElem.classList.add(className('t'));\n            bodyElem.appendChild(titleElem);\n            bindValueMap(config.props, 'title', (title) => {\n                titleElem.textContent = title;\n            });\n        }\n    }\n\n    class RadioController {\n        constructor(doc, config) {\n            this.props = config.props;\n            this.viewProps = config.viewProps;\n            this.view = new RadioView(doc, {\n                name: config.name,\n                props: this.props,\n                viewProps: this.viewProps,\n            });\n        }\n    }\n\n    class RadioGridController {\n        constructor(doc, config) {\n            this.cellCs_ = [];\n            this.cellValues_ = [];\n            this.onCellInputChange_ = this.onCellInputChange_.bind(this);\n            this.size = config.size;\n            const [w, h] = this.size;\n            for (let y = 0; y < h; y++) {\n                for (let x = 0; x < w; x++) {\n                    const bc = new RadioController(doc, {\n                        name: config.groupName,\n                        props: ValueMap.fromObject(Object.assign({}, config.cellConfig(x, y))),\n                        viewProps: ViewProps.create(),\n                    });\n                    this.cellCs_.push(bc);\n                    this.cellValues_.push(config.cellConfig(x, y).value);\n                }\n            }\n            this.value = config.value;\n            bindValue(this.value, (value) => {\n                const cc = this.findCellByValue(value);\n                if (!cc) {\n                    return;\n                }\n                cc.view.inputElement.checked = true;\n            });\n            this.viewProps = ViewProps.create();\n            this.view = new PlainView(doc, {\n                viewProps: this.viewProps,\n                viewName: 'radgrid',\n            });\n            this.view.element.style.gridTemplateColumns = `repeat(${w}, 1fr)`;\n            this.cellCs_.forEach((bc) => {\n                bc.view.inputElement.addEventListener('change', this.onCellInputChange_);\n                this.view.element.appendChild(bc.view.element);\n            });\n        }\n        get cellControllers() {\n            return this.cellCs_;\n        }\n        findCellByValue(value) {\n            const index = this.cellValues_.findIndex((v) => v === value);\n            if (index < 0) {\n                return null;\n            }\n            return this.cellCs_[index];\n        }\n        onCellInputChange_(ev) {\n            const inputElem = ev.currentTarget;\n            const index = this.cellCs_.findIndex((c) => c.view.inputElement === inputElem);\n            if (index < 0) {\n                return;\n            }\n            this.value.rawValue = this.cellValues_[index];\n        }\n    }\n\n    const RadioGridBladePlugin = (function () {\n        return {\n            id: 'radiogrid',\n            type: 'blade',\n            accept(params) {\n                const p = ParamsParsers;\n                const result = parseParams(params, {\n                    cells: p.required.function,\n                    groupName: p.required.string,\n                    size: p.required.array(p.required.number),\n                    value: p.required.raw,\n                    view: p.required.constant('radiogrid'),\n                    label: p.optional.string,\n                });\n                return result ? { params: result } : null;\n            },\n            controller(args) {\n                return new LabeledValueController(args.document, {\n                    blade: args.blade,\n                    props: ValueMap.fromObject({\n                        label: args.params.label,\n                    }),\n                    valueController: new RadioGridController(args.document, {\n                        groupName: args.params.groupName,\n                        cellConfig: args.params.cells,\n                        size: args.params.size,\n                        value: createValue(args.params.value),\n                    }),\n                });\n            },\n            api(args) {\n                if (!(args.controller instanceof LabeledValueController)) {\n                    return null;\n                }\n                if (!(args.controller.valueController instanceof RadioGridController)) {\n                    return null;\n                }\n                return new RadioGridApi(args.controller);\n            },\n        };\n    })();\n\n    function createRadioGridInputPlugin(config) {\n        return {\n            id: 'input-radiogrid',\n            type: 'input',\n            accept(value, params) {\n                if (!config.isType(value)) {\n                    return null;\n                }\n                const p = ParamsParsers;\n                const result = parseParams(params, {\n                    cells: p.required.function,\n                    groupName: p.required.string,\n                    size: p.required.array(p.required.number),\n                    view: p.required.constant('radiogrid'),\n                });\n                return result\n                    ? {\n                        initialValue: value,\n                        params: result,\n                    }\n                    : null;\n            },\n            binding: config.binding,\n            controller: (args) => {\n                return new RadioGridController(args.document, {\n                    cellConfig: args.params.cells,\n                    groupName: args.params.groupName,\n                    size: args.params.size,\n                    value: args.value,\n                });\n            },\n        };\n    }\n    const RadioGruidNumberInputPlugin = createRadioGridInputPlugin({\n        isType: (value) => {\n            return typeof value === 'number';\n        },\n        binding: {\n            reader: (_args) => numberFromUnknown,\n            writer: (_args) => writePrimitive,\n        },\n    });\n    const RadioGruidStringInputPlugin = createRadioGridInputPlugin({\n        isType: (value) => {\n            return typeof value === 'string';\n        },\n        binding: {\n            reader: (_args) => stringFromUnknown,\n            writer: (_args) => writePrimitive,\n        },\n    });\n    const RadioGruidBooleanInputPlugin = createRadioGridInputPlugin({\n        isType: (value) => {\n            return typeof value === 'boolean';\n        },\n        binding: {\n            reader: (_args) => boolFromUnknown,\n            writer: (_args) => writePrimitive,\n        },\n    });\n\n    const plugins = [\n        ButtonGridBladePlugin,\n        CubicBezierBladePlugin,\n        FpsGraphBladePlugin,\n        IntervalInputPlugin,\n        RadioGridBladePlugin,\n        RadioGruidBooleanInputPlugin,\n        RadioGruidNumberInputPlugin,\n        RadioGruidStringInputPlugin,\n    ];\n\n    exports.ButtonCellApi = ButtonCellApi;\n    exports.ButtonGridApi = ButtonGridApi;\n    exports.ButtonGridController = ButtonGridController;\n    exports.CubicBezier = CubicBezier;\n    exports.CubicBezierApi = CubicBezierApi;\n    exports.CubicBezierAssembly = CubicBezierAssembly;\n    exports.CubicBezierController = CubicBezierController;\n    exports.CubicBezierGraphController = CubicBezierGraphController;\n    exports.CubicBezierGraphView = CubicBezierGraphView;\n    exports.CubicBezierPickerController = CubicBezierPickerController;\n    exports.CubicBezierPickerView = CubicBezierPickerView;\n    exports.CubicBezierPreviewView = CubicBezierPreviewView;\n    exports.CubicBezierView = CubicBezierView;\n    exports.FpsGraphBladeApi = FpsGraphBladeApi;\n    exports.FpsGraphController = FpsGraphController;\n    exports.FpsView = FpsView;\n    exports.Fpswatch = Fpswatch;\n    exports.Interval = Interval;\n    exports.IntervalAssembly = IntervalAssembly;\n    exports.IntervalConstraint = IntervalConstraint;\n    exports.RadioCellApi = RadioCellApi;\n    exports.RadioController = RadioController;\n    exports.RadioGridApi = RadioGridApi;\n    exports.RadioGridController = RadioGridController;\n    exports.RadioView = RadioView;\n    exports.RangeSliderController = RangeSliderController;\n    exports.RangeSliderTextController = RangeSliderTextController;\n    exports.RangeSliderTextView = RangeSliderTextView;\n    exports.RangeSliderView = RangeSliderView;\n    exports.TpRadioGridChangeEvent = TpRadioGridChangeEvent;\n    exports.plugins = plugins;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n","import * as THREE from 'three'\nimport { OrbitControls } from 'three/addons/controls/OrbitControls.js'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js'\nimport { ShadowMesh } from 'three/addons/objects/ShadowMesh.js'\nimport { Pane } from 'tweakpane';\nimport * as EssentialsPlugin from '@tweakpane/plugin-essentials';\nimport { sin, positionLocal, time, vec2, vec3, vec4, uv, uniform, color, rangeFog } from 'three'\n\n/**\n * Base\n */\nconst pane = new Pane();\npane.registerPlugin(EssentialsPlugin);\nconst fpsGraph = pane.addBlade({\n    view: 'fpsgraph',\n    label: 'fpsgraph',\n})\n\nconst gltfLoader = new GLTFLoader()\n\n// Canvas\nconst canvas = document.querySelector('canvas.webgl')\n\n// Scene\nconst scene = new THREE.Scene()\nconst fogColor = uniform(color('#1b191f'))\nconst fogNode = rangeFog(fogColor, 20, 50)\nscene.fogNode = fogNode\n\n// Ground plane for shadows\nconst groundGeometry = new THREE.PlaneGeometry(20, 20)\nconst groundMaterial = new THREE.MeshStandardMaterial({ \n    color: '#aaaaaa', // Lighter color for better shadow contrast\n    roughness: 0.8,\n    metalness: 0.2\n})\nconst ground = new THREE.Mesh(groundGeometry, groundMaterial)\nground.rotation.x = -Math.PI * 0.5\nground.position.y = 0 // Set to 0 to match the plane constant\nscene.add(ground)\n\n// Light for better visibility\nconst ambientLight = new THREE.AmbientLight(0xffffff, 0.5)\nscene.add(ambientLight)\n\nconst directionalLight = new THREE.DirectionalLight(0xffffff, 2)\ndirectionalLight.position.set(5, 7, -1)\ndirectionalLight.lookAt(scene.position)\nscene.add(directionalLight)\n\n// Light visualization (helper arrows)\nconst arrowDirection = new THREE.Vector3()\narrowDirection.subVectors(scene.position, directionalLight.position).normalize()\n\nconst arrowPosition = new THREE.Vector3().copy(directionalLight.position)\nconst arrowHelper = new THREE.ArrowHelper(\n    arrowDirection, \n    arrowPosition, \n    0.9, \n    0xffff00, \n    0.25, \n    0.08\n)\nscene.add(arrowHelper)\n\n// ShadowMesh parameters\nconst normalVector = new THREE.Vector3(0, 1, 0)\nconst planeConstant = 0 // Ground plane is at y=0\nconst groundPlane = new THREE.Plane(normalVector, planeConstant)\nconst lightPosition4D = new THREE.Vector4()\n\nlightPosition4D.x = directionalLight.position.x\nlightPosition4D.y = directionalLight.position.y\nlightPosition4D.z = directionalLight.position.z\n// amount of light-ray divergence: 0.001 = sunlight, 1.0 = pointlight\nlightPosition4D.w = 0.1 // Increased slightly to make shadow more visible\n\n/**\n * Chair model and shadow\n */\nlet chair\nlet chairShadow\ngltfLoader.load('/chair.glb', (gltf) => {\n    chair = gltf.scene\n    \n    // Position and scale adjustments if needed\n    chair.position.set(0, 1, 0) // Raise chair above ground\n    chair.scale.set(1, 1, 1)\n    scene.add(chair)\n    \n    // Create shadow for the chair with custom material for better visibility\n    chairShadow = new ShadowMesh(chair)\n    // Make shadow darker and more visible\n    chairShadow.material.opacity = 0.9\n    scene.add(chairShadow)\n    \n    // Log to help debug\n    console.log(\"Chair loaded\", chair)\n    console.log(\"Shadow created\", chairShadow)\n    \n    // Add to GUI\n    const chairFolder = pane.addFolder({ title: 'Chair Position' })\n    \n    chairFolder.addInput(chair.position, 'x', { min: -5, max: 5, step: 0.1 })\n    chairFolder.addInput(chair.position, 'y', { min: -1, max: 5, step: 0.1 })\n    chairFolder.addInput(chair.position, 'z', { min: -5, max: 5, step: 0.1 })\n    \n    const chairRotationFolder = pane.addFolder({ title: 'Chair Rotation' })\n    \n    chairRotationFolder.addInput(chair.rotation, 'y', { \n        min: -Math.PI, \n        max: Math.PI, \n        step: 0.01,\n        label: 'Rotate'\n    })\n})\n\n/**\n * Light controls\n */\nconst lightFolder = pane.addFolder({ title: 'Light Settings' })\n\n// Light type control\nconst lightParams = { \n    useDirectionalLight: true,\n    intensity: 2\n}\n\n// Light type toggle\nlightFolder.addInput(lightParams, 'useDirectionalLight', { label: 'Directional Light' })\n    .on('change', () => {\n        if (lightParams.useDirectionalLight) {\n            // Directional light settings\n            lightPosition4D.w = 0.001\n            directionalLight.position.set(5, 7, -1)\n        } else {\n            // Point light settings\n            lightPosition4D.w = 0.9\n            directionalLight.position.set(0, 6, -2)\n        }\n        \n        // Update light position\n        lightPosition4D.x = directionalLight.position.x\n        lightPosition4D.y = directionalLight.position.y\n        lightPosition4D.z = directionalLight.position.z\n        \n        // Update arrow helper\n        arrowDirection.subVectors(scene.position, directionalLight.position).normalize()\n        arrowPosition.copy(directionalLight.position)\n        arrowHelper.position.copy(arrowPosition)\n        arrowHelper.setDirection(arrowDirection)\n    })\n\n// Light intensity\nlightFolder.addInput(lightParams, 'intensity', { min: 0, max: 5, step: 0.1 })\n    .on('change', () => {\n        directionalLight.intensity = lightParams.intensity\n    })\n\n// Light position controls\nlightFolder.addInput(directionalLight.position, 'x', { min: -10, max: 10, step: 0.1 })\n    .on('change', () => {\n        updateLightPosition()\n    })\n\nlightFolder.addInput(directionalLight.position, 'y', { min: 1, max: 10, step: 0.1 })\n    .on('change', () => {\n        updateLightPosition()\n    })\n\nlightFolder.addInput(directionalLight.position, 'z', { min: -10, max: 10, step: 0.1 })\n    .on('change', () => {\n        updateLightPosition()\n    })\n\nfunction updateLightPosition() {\n    // Update light position 4D vector\n    lightPosition4D.x = directionalLight.position.x\n    lightPosition4D.y = directionalLight.position.y\n    lightPosition4D.z = directionalLight.position.z\n    \n    // Update arrow helper\n    arrowDirection.subVectors(scene.position, directionalLight.position).normalize()\n    arrowPosition.copy(directionalLight.position)\n    arrowHelper.position.copy(arrowPosition)\n    arrowHelper.setDirection(arrowDirection)\n}\n\n/**\n * Sizes\n */\nconst sizes = {\n    width: window.innerWidth,\n    height: window.innerHeight\n}\n\nwindow.addEventListener('resize', () => {\n    // Update sizes\n    sizes.width = window.innerWidth\n    sizes.height = window.innerHeight\n    \n    // Update camera\n    camera.aspect = sizes.width / sizes.height\n    camera.updateProjectionMatrix()\n    \n    // Update renderer\n    renderer.setSize(sizes.width, sizes.height)\n    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\n})\n\n/**\n * Camera\n */\n// Base camera\nconst camera = new THREE.PerspectiveCamera(25, sizes.width / sizes.height, 0.1, 100)\ncamera.position.x = 6\ncamera.position.y = 3\ncamera.position.z = 10\nscene.add(camera)\n\n// Controls\nconst controls = new OrbitControls(camera, canvas)\ncontrols.enableDamping = true\n\n/**\n * Renderer\n */\nconst renderer = new THREE.WebGPURenderer({\n    canvas: canvas,\n    forceWebGL: false\n})\nrenderer.setSize(sizes.width, sizes.height)\nrenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\nrenderer.setClearColor(fogColor.value)\n\n/**\n *  Background Color GUI\n */\nconst params = { color: '#1b191f' };\n// add a folder for the scene background color\nconst folder = pane.addFolder({ title: 'Background Color' });\nfolder.addInput(params, 'color').on('change', () => {\n    const newColor = new THREE.Color(params.color);\n    renderer.setClearColor(newColor);\n    fogColor.value = newColor;\n});\n\n/**\n * Animate\n */\nconst tick = () => {\n    fpsGraph.begin()\n    \n    // Update controls\n    controls.update()\n    \n    // Update shadow if chair exists\n    if (chair && chairShadow) {\n        // Update light position before updating shadow (in case it was changed via GUI)\n        lightPosition4D.x = directionalLight.position.x\n        lightPosition4D.y = directionalLight.position.y\n        lightPosition4D.z = directionalLight.position.z\n        \n        // Update shadow with current parameters\n        chairShadow.update(groundPlane, lightPosition4D)\n        \n        // Alternative debugging approach - create shadow each frame if not working\n        // scene.remove(chairShadow)\n        // chairShadow = new ShadowMesh(chair)\n        // chairShadow.material.opacity = 0.9\n        // scene.add(chairShadow)\n        // chairShadow.update(groundPlane, lightPosition4D)\n    }\n    \n    // Render\n    renderer.renderAsync(scene, camera)\n    \n    fpsGraph.end()\n}\n\nrenderer.setAnimationLoop(tick)"],"names":["REVISION","MOUSE","TOUCH","CullFaceNone","CullFaceBack","CullFaceFront","PCFShadowMap$1","VSMShadowMap","FrontSide","BackSide","DoubleSide","NoBlending","NormalBlending","AdditiveBlending","SubtractiveBlending","MultiplyBlending","CustomBlending","AddEquation","SubtractEquation","ReverseSubtractEquation","MinEquation","MaxEquation","ZeroFactor","OneFactor","SrcColorFactor","OneMinusSrcColorFactor","SrcAlphaFactor","OneMinusSrcAlphaFactor","DstAlphaFactor","OneMinusDstAlphaFactor","DstColorFactor","OneMinusDstColorFactor","SrcAlphaSaturateFactor","NeverDepth","AlwaysDepth","LessDepth","LessEqualDepth","EqualDepth","GreaterEqualDepth","GreaterDepth","NotEqualDepth","MultiplyOperation","MixOperation","AddOperation","NoToneMapping","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","AgXToneMapping","NeutralToneMapping","AttachedBindMode","DetachedBindMode","UVMapping","CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","CubeUVReflectionMapping","RepeatWrapping","ClampToEdgeWrapping","MirroredRepeatWrapping","NearestFilter","NearestMipmapNearestFilter","NearestMipmapLinearFilter","LinearFilter","LinearMipmapNearestFilter","LinearMipmapLinearFilter","UnsignedByteType","ByteType","ShortType","UnsignedShortType","IntType","UnsignedIntType","FloatType","HalfFloatType","UnsignedShort4444Type","UnsignedShort5551Type","UnsignedInt248Type","UnsignedInt5999Type","AlphaFormat","RGBFormat","RGBAFormat","LuminanceFormat","LuminanceAlphaFormat","DepthFormat","DepthStencilFormat","RedFormat","RedIntegerFormat","RGFormat","RGIntegerFormat","RGBIntegerFormat","RGBAIntegerFormat","RGB_S3TC_DXT1_Format","RGBA_S3TC_DXT1_Format","RGBA_S3TC_DXT3_Format","RGBA_S3TC_DXT5_Format","RGB_PVRTC_4BPPV1_Format","RGB_PVRTC_2BPPV1_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_PVRTC_2BPPV1_Format","RGB_ETC1_Format","RGB_ETC2_Format","RGBA_ETC2_EAC_Format","RGBA_ASTC_4x4_Format","RGBA_ASTC_5x4_Format","RGBA_ASTC_5x5_Format","RGBA_ASTC_6x5_Format","RGBA_ASTC_6x6_Format","RGBA_ASTC_8x5_Format","RGBA_ASTC_8x6_Format","RGBA_ASTC_8x8_Format","RGBA_ASTC_10x5_Format","RGBA_ASTC_10x6_Format","RGBA_ASTC_10x8_Format","RGBA_ASTC_10x10_Format","RGBA_ASTC_12x10_Format","RGBA_ASTC_12x12_Format","RGBA_BPTC_Format","RED_RGTC1_Format","SIGNED_RED_RGTC1_Format","RED_GREEN_RGTC2_Format","SIGNED_RED_GREEN_RGTC2_Format","InterpolateDiscrete","InterpolateLinear","InterpolateSmooth","ZeroCurvatureEnding","ZeroSlopeEnding","WrapAroundEnding","NormalAnimationBlendMode","TrianglesDrawMode","TriangleStripDrawMode","TriangleFanDrawMode","TangentSpaceNormalMap","ObjectSpaceNormalMap","NoColorSpace","SRGBColorSpace","LinearSRGBColorSpace","LinearTransfer","SRGBTransfer","ZeroStencilOp","KeepStencilOp","ReplaceStencilOp","IncrementStencilOp","DecrementStencilOp","IncrementWrapStencilOp","DecrementWrapStencilOp","InvertStencilOp","NeverStencilFunc","LessStencilFunc","EqualStencilFunc","LessEqualStencilFunc","GreaterStencilFunc","NotEqualStencilFunc","GreaterEqualStencilFunc","AlwaysStencilFunc","NeverCompare","LessCompare","EqualCompare","LessEqualCompare","GreaterCompare","NotEqualCompare","GreaterEqualCompare","AlwaysCompare","StaticDrawUsage","DynamicDrawUsage","WebGLCoordinateSystem","WebGPUCoordinateSystem","EventDispatcher","type","listener","listeners","listenerArray","index","event","array","i","l","_lut","_seed","DEG2RAD","RAD2DEG","generateUUID","d0","d1","d2","d3","clamp$1","value","min","max","euclideanModulo","n","m","mapLinear","x","a1","a2","b1","b2","inverseLerp","y","lerp","damp","lambda","dt","pingpong","length","smoothstep$1","smootherstep","randInt","low","high","randFloat","randFloatSpread","range","seededRandom","s","t","degToRad","degrees","radToDeg","radians","isPowerOfTwo","ceilPowerOfTwo","floorPowerOfTwo","setQuaternionFromProperEuler","q","a","b","c","order","cos","sin","c2","s2","c13","s13","c1_3","s1_3","c3_1","s3_1","denormalize","normalize$1","MathUtils","Vector2","scalar","v","e","minVal","maxVal","denominator","theta","dx","dy","alpha","v1","v2","offset","attribute","center","angle","Matrix3","n11","n12","n13","n21","n22","n23","n31","n32","n33","te","me","xAxis","yAxis","zAxis","ae","be","a11","a12","a13","a21","a22","a23","a31","a32","a33","b11","b12","b13","b21","b22","b23","b31","b32","b33","d","f","g","t11","t12","t13","det","detInv","tmp","matrix4","r","tx","ty","sx","sy","rotation","cx","cy","_m3","matrix","arrayNeedsUint32$1","createElementNS","name","createCanvasElement","canvas","_cache$2","warnOnce","message","ColorManagement","color","sourceColorSpace","targetColorSpace","SRGBToLinear","LinearToSRGB","colorSpace","target","colorSpaces","targetMatrix","REC709_PRIMARIES","REC709_LUMINANCE_COEFFICIENTS","D65","LINEAR_REC709_TO_XYZ","XYZ_TO_LINEAR_REC709","_canvas","ImageUtils","image","context","imageData","data","_sourceId","Source","meta","isRootObject","output","url","serializeImage","_textureId","Texture","mapping","wrapS","wrapT","magFilter","minFilter","format","anisotropy","source","uv","Vector4","z","w","m11","m12","m13","m21","m22","m23","m31","m32","m33","xx","yy","zz","xy","xz","yz","RenderTarget","width","height","options","texture","count","depth","il","WebGLRenderTarget","DataArrayTexture","layerIndex","Quaternion","dst","dstOffset","src0","srcOffset0","src1","srcOffset1","x0","y0","z0","w0","x1","y1","z1","w1","dir","sqrSin","len","tDir","quaternion","euler","update","c1","c3","s1","s3","axis","halfAngle","trace","vFrom","vTo","step","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","qb","cosHalfTheta","sqrSinHalfTheta","sinHalfTheta","halfTheta","ratioA","ratioB","qa","theta1","theta2","r1","r2","callback","Vector3","_quaternion$4","vx","vy","vz","qx","qy","qz","qw","tz","camera","ax","ay","az","bx","by","bz","planeNormal","_vector$c","normal","dz","radius","phi","sinPhiRadius","sz","u","Box3","_vector$b","points","size","halfSize","object","precise","box","point","vector","geometry","positionAttribute","_box$4","children","sphere","plane","triangle","_center","_extents","_v0$2","_v1$7","_v2$4","_f0","_f1","_f2","axes","satForAxes","_triangleNormal","_points","_testAxis","v0","extents","j","p0","p1","p2","_box$3","_v1$6","_v2$3","Sphere","optionalCenter","maxRadiusSq","radiusSum","deltaLengthSq","lengthSq","delta","_vector$a","_segCenter","_segDir","_diff","_edge1","_edge2","_normal$2","Ray","origin","direction","ray","directionDistance","optionalPointOnRay","optionalPointOnSegment","segExtent","a01","b0","s0","sqrDist","extDet","invDet","tca","radius2","thc","t0","t1","distToPoint","tmin","tmax","tymin","tymax","tzmin","tzmax","invdirx","invdiry","invdirz","backfaceCulling","DdN","sign","DdQxE2","DdE1xQ","QdN","Matrix4","n14","n24","n34","n41","n42","n43","n44","scaleX","_v1$5","scaleY","scaleZ","af","bf","ce","cf","de","df","ac","ad","bc","bd","_zero","_one","eye","up","_z","_x","_y","a14","a24","a34","a41","a42","a43","a44","b14","b24","b34","b41","b42","b43","b44","t14","scaleXSq","scaleYSq","scaleZSq","yx","zx","zy","position","scale","x2","y2","z2","wx","wy","wz","_m1$3","invSX","invSY","invSZ","left","right","top","bottom","near","far","coordinateSystem","h","p","zInv","_matrix$2","_quaternion$3","Euler","newOrder","Layers","channel","layers","_object3DId","_v1$4","_q1","_m1$2","_target$1","_position$3","_scale$2","_quaternion$2","_xAxis","_yAxis","_zAxis","_addedEvent","_removedEvent","_childaddedEvent","_childremovedEvent","Object3D","onRotationChange","onQuaternionChange","distance","parent","id","result","force","updateParents","updateChildren","bound","serialize","library","element","parameters","shapes","shape","uuids","animation","geometries","extractFromCache","materials","textures","images","skeletons","animations","nodes","cache","values","key","recursive","child","_v0$1","_v1$3","_v2$2","_v3$2","_vab","_vac","_vbc","_vap","_vbp","_vcp","_v40","_v41","_v42","Triangle","targetLengthSq","dot00","dot01","dot02","dot11","dot12","denom","invDenom","p3","v3","attr","i1","i2","i3","barycoord","i0","d4","vc","d5","d6","vb","va","_colorKeywords","_hslA","_hslB","hue2rgb","Color","hex","style","handleAlpha","string","components","_color","hue","saturation","lightness","color1","color2","_materialId","Material","_value","newValue","currentValue","srcPlanes","dstPlanes","MeshBasicMaterial","_tables","_generateTables","buffer","floatView","uint32View","baseTable","shiftTable","mantissaTable","exponentTable","offsetTable","toHalfFloat","val","fromHalfFloat","_vector$9","_vector2$1","BufferAttribute","itemSize","normalized","start","index1","index2","component","Uint16BufferAttribute","Uint32BufferAttribute","Float16BufferAttribute","Float32BufferAttribute","_id$9","_m1$1","_obj","_offset","_box$2","_boxMorphTargets","_vector$8","BufferGeometry","indirect","materialIndex","normalMatrix","tangent","morphAttributesPosition","morphAttribute","morphTargetsRelative","jl","attributes","normalAttribute","uvAttribute","tangentAttribute","tan1","tan2","vA","vB","vC","uvA","uvB","uvC","sdir","tdir","handleTriangle","groups","group","tmp2","n2","handleVertex","pA","pB","pC","nA","nB","nC","cb","ab","normals","convertBufferAttribute","indices","array2","geometry2","newAttribute","morphAttributes","morphArray","hasMorphAttributes","attributeArray","boundingSphere","boundingBox","_inverseMatrix$3","_ray$3","_sphere$6","_sphereHitAt","_vA$1","_vB$1","_vC$1","_tempA","_morphA","_intersectionPoint","_intersectionPointWorld","Mesh","material","keys","ml","morphPosition","morphInfluences","influence","raycaster","intersects","matrixWorld","rayLocalSpace","intersection","uv1","drawRange","groupMaterial","end","checkGeometryIntersection","checkIntersection$1","intersect","face","BoxGeometry","widthSegments","heightSegments","depthSegments","scope","vertices","uvs","numberOfVertices","groupStart","buildPlane","udir","vdir","gridX","gridY","segmentWidth","segmentHeight","widthHalf","heightHalf","depthHalf","gridX1","gridY1","vertexCounter","groupCount","iy","ix","cloneUniforms","src","property","cloneUniformsGroups","default_vertex","default_fragment","ShaderMaterial","extensions","Camera","_v3$1","_minTarget","_maxTarget","PerspectiveCamera","fov","aspect","focalLength","vExtentSlope","minTarget","maxTarget","fullWidth","fullHeight","view","skew","CubeCamera","renderTarget","cameraPX","cameraNX","cameraPY","cameraNY","cameraPZ","cameraNZ","cameras","renderer","scene","activeMipmapLevel","currentRenderTarget","currentActiveCubeFace","currentActiveMipmapLevel","currentXrEnabled","generateMipmaps","CubeTexture","WebGLCubeRenderTarget","shader","mesh","currentMinFilter","stencil","Scene","InterleavedBuffer","stride","ib","_vector$7","InterleavedBufferAttribute","interleavedBuffer","SpriteMaterial","_basePosition","_skinIndex","_skinWeight","_vector3","_matrix4","_vertex","_sphere$5","_inverseMatrix$2","_ray$2","SkinnedMesh","skeleton","bindMatrix","skinWeight","weight","boneIndex","Bone","DataTexture","_offsetMatrix","_identityMatrix","Skeleton","bones","boneInverses","inverse","bone","boneMatrices","boneTexture","json","uuid","boneInverse","InstancedBufferAttribute","meshPerAttribute","_instanceLocalMatrix","_instanceWorldMatrix","_instanceIntersects","_box3","_identity","_mesh$1","_sphere$4","InstancedMesh","objectInfluences","dataIndex","raycastTimes","instanceId","morphInfluencesSum","morphBaseInfluence","_vector1","_vector2","_normalMatrix","Plane","constant","inverseNormalLength","line","startSign","endSign","optionalNormalMatrix","referencePoint","_sphere$3","_vector$6","Frustum","p4","p5","planes","frustum","me0","me1","me2","me3","me4","me5","me6","me7","me8","me9","me10","me11","me12","me13","me14","me15","sprite","negRadius","LineBasicMaterial","_vStart","_vEnd","_inverseMatrix$1","_ray$1","_sphere$1","_intersectPointOnRay","_intersectPointOnSegment","Line","lineDistances","threshold","localThreshold","localThresholdSq","checkIntersection","thresholdSq","_start","_end","LineSegments","LineLoop","PointsMaterial","_inverseMatrix","_ray","_sphere","_position$2","Points","testPoint","rayPointDistanceSq","intersectPoint","Group","FramebufferTexture","DepthTexture","CylinderGeometry","radiusTop","radiusBottom","radialSegments","openEnded","thetaStart","thetaLength","indexArray","halfHeight","generateTorso","generateCap","vertex","slope","indexRow","sinTheta","cosTheta","centerIndexStart","centerIndexEnd","PlaneGeometry","width_half","height_half","segment_width","segment_height","SphereGeometry","phiStart","phiLength","thetaEnd","grid","verticesRow","uOffset","ShadowMaterial","MeshStandardMaterial","MeshPhysicalMaterial","reflectivity","MeshPhongMaterial","MeshToonMaterial","MeshNormalMaterial","MeshLambertMaterial","MeshMatcapMaterial","LineDashedMaterial","convertArray","forceClone","isTypedArray","getKeyframeOrder","times","compareTime","sortedArray","nValues","srcOffset","flattenJSON","jsonKeys","valuePropertyName","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","pp","validate_interval","seek","linear_scan","forward_scan","giveUpAt","t1global","mid","CubicInterpolant","iPrev","iNext","tPrev","tNext","halfDt","o1","o0","oP","oN","wP","wN","ppp","sP","sN","LinearInterpolant","offset1","offset0","weight1","weight0","DiscreteInterpolant","KeyframeTrack","interpolation","track","trackType","factoryMethod","timeOffset","timeScale","startTime","endTime","nKeys","from","to","valid","valueSize","prevTime","currTime","smoothInterpolation","lastIndex","writeIndex","keep","time","timeNext","offsetP","offsetN","readOffset","writeOffset","TypedKeyframeTrack","BooleanKeyframeTrack","ColorKeyframeTrack","NumberKeyframeTrack","QuaternionLinearInterpolant","QuaternionKeyframeTrack","StringKeyframeTrack","VectorKeyframeTrack","AnimationClip","duration","tracks","blendMode","jsonTracks","frameTime","parseKeyframeTrack","clip","clipTracks","morphTargetSequence","fps","noLoop","numMorphTargets","objectOrClipArray","clipArray","o","morphTargets","animationToMorphTargets","pattern","morphTarget","parts","animationMorphTargets","clips","addNonemptyTrack","trackName","animationKeys","propertyName","destTracks","clipName","hierarchyTracks","morphTargetNames","k","morphTargetName","animationKey","boneName","getTrackTypeForValueTypeName","typeName","Cache","file","LoadingManager","onLoad","onProgress","onError","isLoading","itemsLoaded","itemsTotal","urlModifier","handlers","transform","regex","loader","DefaultLoadingManager","Loader","manager","resolve","reject","crossOrigin","path","resourcePath","requestHeader","loading","HttpError","response","FileLoader","cached","req","mimeType","responseType","callbacks","reader","contentLength","total","lengthComputable","loaded","stream","controller","readData","done","text","exec","label","decoder","err","ImageLoader","onImageLoad","removeEventListeners","onImageError","TextureLoader","Light","intensity","HemisphereLight","skyColor","groundColor","_projScreenMatrix$2","_lightPositionWorld$1","_lookTarget$1","LightShadow","light","shadowCamera","shadowMatrix","viewportIndex","SpotLightShadow","SpotLight","penumbra","decay","power","_projScreenMatrix$1","_lightPositionWorld","_lookTarget","PointLightShadow","PointLight","OrthographicCamera","scaleW","scaleH","DirectionalLightShadow","DirectionalLight","AmbientLight","RectAreaLight","SphericalHarmonics3","coefficients","coeff","sh","shBasis","LightProbe","LoaderUtils","ImageBitmapLoader","imageBitmap","fetchOptions","promise","res","blob","_RESERVED_CHARS_RE","_reservedRe","_wordChar","_wordCharOrDot","_directoryRe","_nodeRe","_objectRe","_propertyRe","_trackRe","_supportedObjectNames","Composite","targetGroup","optionalParsedPath","parsedPath","PropertyBinding","firstValidIndex","binding","bindings","rootNode","root","matches","results","lastDot","objectName","nodeName","searchNodeSubtree","childNode","subTreeNode","dest","targetArray","sourceArray","targetObject","propertyIndex","objectIndex","nodeProperty","versioning","bindingType","InstancedInterleavedBuffer","Spherical","other","_axis","_lineGeometry","_coneGeometry","ArrowHelper","headLength","headWidth","Controls","domElement","refreshUniforms","NodeMaterialObserver","builder","renderObject","attributesData","renderObjectData","materialData","mtlValue","storedGeometryData","storedAttributes","storedAttributeNames","currentAttributeNames","storedAttributeData","storedIndexVersion","currentIndexVersion","morphChanged","nodeFrame","renderId","isStatic","isBundle","cyrb53","seed","h1","h2","ch","hashString","str","hashArray","hash$1","params","getCacheKey$1","getNodeChildren","node","toJSON","subProperty","getValueType","typeOf","getValueFromType","last4","base64ToArrayBuffer","arrayBufferToBase64","arrayBuffer","chars","base64","NodeShaderStage","NodeUpdateType","defaultShaderStages","defaultBuildStages","shaderStages","vectorComponents","_nodeId","Node","nodeType","updateType","nodeProperties","hash","outputNode","refNode","buildStage","properties","stackNodesBeforeSetup","nodeData","nodeChildren","inputNodes","inputArray","inputObject","isRoot","ArrayElementNode","indexNode","nodeSnippet","indexSnippet","ConvertNode","convertTo","requestType","overloadingType","snippet","TempNode","nodeVar","JoinNode","cur","primitiveType","snippetValues","input","inputSnippet","inputPrimitiveType","stringVectorComponents","SplitNode","vectorLength","nodeTypeLength","SetNode","sourceNode","targetNode","sourceType","targetType","targetSnippet","sourceSnippet","FlipNode","sourceCache","sourceProperty","componentIndex","InputNode","precision","ConstNode","currentStack","NodeElements","addMethodChaining","nodeElement","parseSwizzle","props","parseSwizzleAndSort","shaderNodeHandler","NodeClosure","inputs","nodeObjects","prop","nodeObj","nodeObject","nodeObjectsCacheMap","nodeBuilderFunctionsCacheMap","ShaderNodeObject","obj","altType","getConstNode","Fn","ShaderNodeObjects","objects","ShaderNodeArray","ShaderNodeProxy","NodeClass","factor","settings","assignNode","nodeArray","ShaderNodeImmutable","ShaderCallNodeInternal","shaderNode","functionNodesCacheMap","functionNode","jsFunc","ShaderNodeInternal","layout","bools","uints","ints","floats","boolsCacheMap","bool","uintsCacheMap","uint","intsCacheMap","el","int","floatsCacheMap","float","cacheMaps","constNodesCacheMap","safeGetNodeType","ConvertType","cacheMap","param","defined","getConstNodeType","ShaderNode","nodeProxy","nodeImmutable","fn","setCurrentStack","stack","getCurrentStack","If","append","vec2","ivec2","uvec2","bvec2","vec3","ivec3","uvec3","bvec3","vec4","ivec4","uvec4","bvec4","mat2","mat3","mat4","convert","types","UniformGroupNode","shared","uniformGroup","sharedUniformGroup","frameGroup","renderGroup","objectGroup","UniformNode","self","frame","sharedNode","sharedNodeType","nodeUniform","uniform","arg1","arg2","PropertyNode","varying","varyingProperty","diffuseColor","emissive","roughness","metalness","clearcoat","clearcoatRoughness","sheen","sheenRoughness","iridescence","iridescenceIOR","iridescenceThickness","alphaT","anisotropyT","anisotropyB","specularColor","specularF90","shininess","dashSize","gapSize","ior","transmission","thickness","attenuationDistance","attenuationColor","dispersion","AssignNode","targetLength","needsSplitAssign","sourceVar","targetRoot","assign","FunctionCallNode","generateInput","inputNode","pointer","call","func","OperatorNode","op","aNode","bNode","finalOp","typeA","typeB","typeLength","outputLength","fnOpSnippet","add","sub","mul","div","modInt","equal","notEqual","lessThan","greaterThan","lessThanEqual","greaterThanEqual","and","or","not","xor","bitAnd","bitNot","bitOr","bitXor","shiftLeft","shiftRight","remainder","MathNode","method","cNode","aType","bType","cType","aLen","bLen","cLen","inputType","isWebGL","tA","tB","mulNode","normalize","abs","EPSILON","PI","all","any","equals","exp","exp2","log","log2","sqrt","inverseSqrt","floor","ceil","fract","tan","asin","acos","atan","negate","oneMinus","dFdx","dFdy","round","reciprocal","trunc","fwidth","transpose","atan2","min$1","max$1","mod","reflect","difference","dot","cross","pow","pow2","pow3","pow4","transformDirection","cbrt","mix","clamp","saturate","refract","smoothstep","faceForward","rand","sn","mixElement","e1","e2","smoothstepElement","ConditionalNode","condNode","ifNode","elseNode","ifType","elseType","currentNodeBlock","needsOutput","ifSnippet","elseSnippet","select","cond","ContextNode","previousContext","VarNode","createVar","temp","VaryingNode","sRGBTransferEOTF","sRGBTransferOETF","WORKING_COLOR_SPACE","OUTPUT_COLOR_SPACE","ColorSpaceNode","colorNode","toOutputColorSpace","toWorkingColorSpace","workingToColorSpace","colorSpaceToWorking","ReferenceElementNode$1","referenceNode","arrayType","elementType","ReferenceBaseNode","uniformType","state","reference$1","RendererReferenceNode","rendererReference","ToneMappingNode","toneMapping","exposureNode","toneMappingExposure","toneMappingFn","exposure","BufferAttributeNode","bufferType","bufferStride","bufferOffset","bufferData","bufferAttribute","nodeAttribute","dynamicBufferAttribute","instancedBufferAttribute","instancedDynamicBufferAttribute","bufferNode","ComputeNode","computeNode","workgroupSize","shaderStage","compute","CacheNode","previousCache","BypassNode","returnNode","callNode","bypass","RemapNode","inLowNode","inHighNode","outLowNode","outHighNode","doClamp","remap","remapClamp","ExpressionNode","expression","Discard","conditional","RenderOutputNode","outputColorSpace","renderOutput","AttributeNode","attributeName","attributeType","TextureSizeNode","textureNode","levelNode","textureProperty","level","textureSize","MaxMipLevelNode","maxMipLevel","TextureNode","uvNode","biasNode","uvSnippet","levelSnippet","biasSnippet","depthSnippet","compareSnippet","gradSnippet","compareNode","depthNode","gradNode","amountNode","gradNodeX","gradNodeY","matrixUniform","newNode","textureLoad","cameraNear","cameraFar","cameraProjectionMatrix","cameraViewMatrix","cameraPosition","Object3DNode","object3d","uniformNode","ModelNode","modelWorldMatrix","modelNormalMatrix","modelViewMatrix","positionGeometry","positionLocal","positionPrevious","positionWorld","positionWorldDirection","positionView","positionViewDirection","FrontFacingNode","frontFacing","faceDirection","normalGeometry","normalLocal","normalFlat","normalView","transformNormalToView","normalWorld","transformedNormalView","transformedNormalWorld","transformedClearcoatNormalView","transformNormal","transformedNormal","modelNormalViewMatrix","materialRefractionRatio","reflectView","refractView","reflectVector","refractVector","CubeTextureNode","cubeUV","cubeTexture","BufferNode","bufferCount","UniformArrayElementNode","UniformArrayNode","elementLength","uniformArray","ReferenceElementNode","ReferenceNode","reference","referenceBuffer","MaterialReferenceNode","materialReference","tangentGeometry","tangentLocal","tangentView","getBitangent","crossNormalTangent","bitangentView","TBNViewMatrix","transformedBentNormalView","bentNormal","perturbNormal2Arb","eye_pos","surf_norm","mapN","q0","q1","st0","st1","N","q1perp","q0perp","T","B","NormalMapNode","scaleNode","normalMapType","normalMap","dHdxy_fwd","bumpScale","sampleTexture","texNode","Hll","perturbNormalArb","surf_pos","dHdxy","vSigmaX","vSigmaY","vN","R1","R2","fDet","vGrad","BumpMapNode","bumpMap","_propertyCache","MaterialNode","opacityNode","specularIntensity","specularColorNode","roughnessNode","metalnessNode","emissiveIntensityNode","emissiveNode","clearcoatNode","clearcoatRoughnessNode","sheenNode","sheenRoughnessNode","anisotropyPolar","materialAnisotropyVector","iridescenceThicknessMaximum","iridescenceThicknessMinimum","transmissionNode","thicknessNode","outputType","materialAlphaTest","materialColor","materialShininess","materialEmissive","materialOpacity","materialSpecular","materialSpecularIntensity","materialSpecularColor","materialSpecularStrength","materialReflectivity","materialRoughness","materialMetalness","materialNormal","materialClearcoat","materialClearcoatRoughness","materialClearcoatNormal","materialRotation","materialSheen","materialSheenRoughness","materialAnisotropy","materialIridescence","materialIridescenceIOR","materialIridescenceThickness","materialTransmission","materialThickness","materialIOR","materialAttenuationDistance","materialAttenuationColor","materialLineScale","materialLineDashSize","materialLineGapSize","materialDispersion","materialLightMap","materialAOMap","ModelViewProjectionNode","positionNode","viewMatrix","modelViewProjection","IndexNode","vertexIndex","instanceIndex","drawIndex","InstanceNode","instanceMesh","instanceMatrixNode","instanceColorNode","instanceAttribute","bufferFn","instanceBuffers","instanceColorAttribute","instancePosition","instanceNormal","instance","BatchNode","batchMesh","indirectId","matricesTexture","batchingMatrix","colorsTexture","bm","batchingNormal","batch","_frameId","SkinningNode","skinnedMesh","useReference","bindMatrixNode","bindMatrixInverseNode","boneMatricesNode","skinIndexNode","skinWeightNode","boneMatX","boneMatY","boneMatZ","boneMatW","skinVertex","skinned","skinMatrix","mrt","skinPosition","skinNormal","skinningReference","LoopNode","returnsNode","stackNode","condition","internalParam","startSnippet","endSnippet","declarationSnippet","conditionalSnippet","updateSnippet","forSnippet","stackSnippet","returnsSnippet","Loop","Break","_morphTextures","_morphVec4","getMorph","bufferMap","texelIndex","getEntry","hasMorphPosition","hasMorphNormals","hasMorphColors","morphTargetsCount","entry","disposeTexture","bufferTexture","morphNormals","morphColors","vertexDataCount","maxTextureSize","vertexDataStride","morphNormal","morphColor","MorphNode","morphReference","LightingNode","AONode","aoNode","LightingContextNode","lightingModel","backdropNode","backdropAlphaNode","directDiffuse","directSpecular","indirectDiffuse","indirectSpecular","reflectedLight","lightingContext","IrradianceNode","screenSizeVec","viewportVec","ScreenNode","screenCoordinate","screenSize","coord","screenUV","viewport","_size$4","ViewportTextureNode","framebufferTexture","currentGenerateMipmaps","viewportTextureNode","viewportMipTexture","sharedDepthbuffer","ViewportDepthTextureNode","viewportDepthTexture","ViewportDepthNode","valueNode","depthBase","viewZToPerspectiveDepth","viewZToOrthographicDepth","viewZ","perspectiveDepthToViewZ","perspectiveDepthToLogarithmicDepth","perspectiveW","numerator","linearDepth","ClippingNode","clippingContext","localClipIntersection","localClippingCount","globalClippingCount","numClippingPlanes","numUnionClippingPlanes","clippingPlanes","distanceToPlane","distanceGradient","clipOpacity","unionClipOpacity","clipped","clipping","clippingAlpha","ALPHA_HASH_SCALE","hash2D","hash3D","getAlphaHashThreshold","maxDeriv","pixScale","pixScales","lerpFactor","cases","NodeMaterial","resultNode","clippingNode","outgoingLightNode","basicOutput","materialMRT","fragmentNode","samples","displacementMap","displacementScale","displacementBias","mvp","alphaTestNode","materialLightsNode","envNode","lightMapNode","lightsN","lightsNode","fogNode","descriptors","_defaultValues$d","LineBasicNodeMaterial","_defaultValues$c","LineDashedNodeMaterial","offsetNode","dashScaleNode","dashSizeNode","gapSizeNode","vLineDistance","directionToColor","_defaultValues$a","MeshNormalNodeMaterial","EquirectUVNode","dirNode","equirectUV","CubeRenderTarget","texture$1","currentMRT","_cache$1","CubeMapNode","defaultTexture","cubeMap","mapTextureMapping","isEquirectangularMapReady$1","onTextureDispose","cubeMapNode","BasicEnvironmentNode","BasicLightMapNode","RECIPROCAL_PI","LightingModel","BasicLightingModel","ambientOcclusion","irradianceLightMap","outgoingLight","_defaultValues$9","MeshBasicNodeMaterial","F_Schlick","f0","f90","dotVH","fresnel","BRDF_Lambert","G_BlinnPhong_Implicit","D_BlinnPhong","dotNH","BRDF_BlinnPhong","lightDirection","halfDir","F","G","D","PhongLightingModel","specular","lightColor","irradiance","_defaultValues$8","MeshLambertNodeMaterial","_defaultValues$7","MeshPhongNodeMaterial","shininessNode","specularNode","getGeometryRoughness","dxy","getRoughness","geometryRoughness","roughnessFactor","V_GGX_SmithCorrelated","dotNL","dotNV","gv","gl","V_GGX_SmithCorrelated_Anisotropic","alphaB","dotTV","dotBV","dotTL","dotBL","D_GGX","D_GGX_Anisotropic","dotTH","dotBH","w2","BRDF_GGX","USE_IRIDESCENCE","USE_ANISOTROPY","V","DFGApprox","c0","a004","EnvironmentBRDF","fab","Schlick_to_F0","x5","D_Charlie","invAlpha","sin2h","V_Neubelt","BRDF_Sheen","LTC_Uv","LUT_BIAS","LTC_ClippedSphereFormFactor","LTC_EdgeVectorFormFactor","theta_sintheta","LTC_Evaluate","P","mInv","lightNormal","T1","T2","mat","coords0","coords1","coords2","coords3","vectorFormFactor","bC","w3","g0","g1","h0","bicubic","texelSize","lod","uvScaled","iuv","fuv","g0x","g1x","h0x","h1x","h0y","h1y","textureBicubic","lodNode","fLodSize","cLodSize","fLodSizeInv","cLodSizeInv","fSample","cSample","getVolumeTransmissionRay","modelMatrix","refractionVector","modelScale","applyIorToRoughness","viewportBackSideTexture","viewportFrontSideTexture","getTransmissionSample","fragCoord","transmissionSample","volumeAttenuation","transmissionDistance","attenuationCoefficient","getIBLVolumeRefraction","projMatrix","transmittedLight","transmittance","halfSpread","iors","transmissionRay","refractedRayExit","ndcPos","refractionCoords","attenuatedColor","transmittanceFactor","XYZ_TO_REC709","Fresnel0ToIor","fresnel0","sqrtF0","IorToFresnel0","transmittedIor","incidentIor","evalSensitivity","OPD","shift","phase","pos","VAR","xyz","evalIridescence","outsideIOR","eta2","cosTheta1","thinFilmThickness","baseF0","cosTheta2Sq","cosTheta2","R0","R12","T121","phi12","phi21","baseIOR","R23","phi23","R123","r123","Rs","I","Cm","Sm","IBLSheenBRDF","viewDir","clearcoatF0","clearcoatF90","PhysicalLightingModel","dotNVi","singleScatter","multiScatter","FssEss","Ems","Favg","Fms","ccIrradiance","lightPosition","halfWidth","ltc_1","ltc_2","t2","radiance","iblIrradiance","dotNVcc","clearcoatEnv","singleScattering","multiScattering","cosineWeightedIrradiance","totalScattering","diffuse","aoNV","aoExp","Fcc","clearcoatLight","sheenEnergyComp","sheenLight","cubeUV_r0","cubeUV_m0","cubeUV_r1","cubeUV_m1","cubeUV_r4","cubeUV_m4","cubeUV_r5","cubeUV_m5","cubeUV_r6","cubeUV_m6","cubeUV_minMipLevel","cubeUV_minTileSize","getFace","absDirection","getUV","roughnessToMip","mip","getDirection","uv_immutable","textureCubeUV","envMap","sampleDir_immutable","roughness_immutable","CUBEUV_TEXEL_WIDTH","CUBEUV_TEXEL_HEIGHT","CUBEUV_MAX_MIP","sampleDir","mipF","mipInt","color0","bilinearCubeUV","direction_immutable","mipInt_immutable","filterInt","faceSize","getSample","outputDirection","sampleDirection","blur","latitudinal","poleAxis","weights","dTheta","gl_FragColor","_generator","_cache","_generateCubeUVSize","imageHeight","maxMip","texelHeight","_getPMREMFromTexture","cacheTexture","isCubeMapReady","isEquirectangularMapReady","PMREMNode","cubeUVSize","pmrem","pmremVersion","pmremTexture","_envNodeCache","EnvironmentNode","cacheEnvNode","radianceNormalView","createRadianceContext","createIrradianceContext","isolateRadiance","isolateIrradiance","clearcoatRadiance","clearcoatRadianceContext","isolateClearcoatRadiance","normalViewNode","reflectVec","normalWorldNode","_defaultValues$6","MeshStandardNodeMaterial","_defaultValues$5","MeshPhysicalNodeMaterial","iorNode","iridescenceNode","iridescenceIORNode","iridescenceThicknessNode","anisotropyV","attenuationDistanceNode","attenuationColorNode","dispersionNode","getGradientIrradiance","gradientMap","fw","ToonLightingModel","_defaultValues$4","MeshToonNodeMaterial","MatcapUVNode","matcapUV","_defaultValues$3","MeshMatcapNodeMaterial","matcapColor","_defaultValues$2","PointsNodeMaterial","RotateNode","rotationNode","cosAngle","sinAngle","rotationXMatrix","rotationYMatrix","rotationZMatrix","rotate","_defaultValues$1","SpriteNodeMaterial","sizeAttenuation","mvPosition","orthoScale","alignedPosition","rotatedPosition","ShadowMaskModel","shadowMask","_defaultValues","ShadowNodeMaterial","ret","Animation","info","ChainMap","map","_plane","ClippingContext","rendererClippingPlanes","localClippingPlanes","_id$7","getKeys","proto","descriptor","RenderObject","renderContext","nodeAttributes","vertexBuffers","drawParams","hasIndex","instanceCount","rangeFactor","firstVertex","lastVertex","itemCount","cacheKey","valueKey","chainArray","RenderObjects","pipelines","passId","chainMap","DataMap","AttributeType","GPU_CHUNK_BYTES","BlendColorFactor","OneMinusBlendColorFactor","Attributes","backend","attributeData","arrayNeedsUint32","getWireframeVersion","getWireframeIndex","geometryIndex","geometryPosition","Geometries","geometryData","onDispose","geometryAttributes","geometryAttribute","wireframeAttribute","callId","wireframes","Info","previousRenderFrameCalls","previousComputeFrameCalls","Pipeline","RenderPipeline","vertexProgram","fragmentProgram","ComputePipeline","computeProgram","_id$6","ProgrammableStage","code","transforms","Pipelines","previousPipeline","nodeBuilderState","stageCompute","pipeline","promises","stageVertex","stageFragment","program","stage","Bindings","bindGroup","groupData","needsBindingsUpdate","updated","textureData","painterSortStable","reversePainterSortStable","needsDoublePass","RenderList","lighting","groupOrder","renderItem","customOpaqueSort","customTransparentSort","RenderLists","lists","list","id$1","RenderContext","getCacheKey","activeCubeFace","RenderContexts","chainKey","attachmentState","renderState","_size$3","Textures","renderTargetData","sampleCount","depthTextureMips","mipWidth","mipHeight","depthTexture","useDepthTexture","textureNeedsUpdate","isRenderTarget","mipLevelCount","Color4","ParameterNode","StackNode","boolNode","methodNode","previousStack","_defaultRT","_camera","QuadGeometry","flipY","_geometry","QuadMesh","_e1","_m1","SceneNode","background","backgroundBlurriness","backgroundIntensity","backgroundRotation","GPUPrimitiveTopology","GPUCompareFunction","GPUStoreOp","GPULoadOp","GPUFrontFace","GPUCullMode","GPUIndexFormat","GPUTextureFormat","GPUAddressMode","GPUFilterMode","GPUBlendFactor","GPUBlendOperation","GPUColorWriteFlags","GPUStencilOperation","GPUBufferBindingType","GPUStorageTextureAccess","GPUTextureSampleType","GPUTextureDimension","GPUTextureViewDimension","GPUTextureAspect","GPUInputStepMode","GPUFeatureName","_size","PassTextureNode","passNode","PassMultipleTextureNode","textureName","previousTexture","PassNode","prevTexture","viewZNode","linearDepthNode","effectiveWidth","effectiveHeight","pixelRatio","linearToneMapping","reinhardToneMapping","cineonToneMapping","RRTAndODTFit","acesFilmicToneMapping","ACESInputMat","ACESOutputMat","LINEAR_REC2020_TO_LINEAR_SRGB","LINEAR_SRGB_TO_LINEAR_REC2020","agxDefaultContrastApprox","x_immutable","x4","agxToneMapping","colortone","AgXInsetMatrix","AgXOutsetMatrix","AgxMinEv","AgxMaxEv","neutralToneMapping","StartCompression","Desaturation","peak","newPeak","CodeNode","includes","language","include","nodeCode","FunctionNode","nodeFunction","FogNode","factorNode","getViewZ","FogRangeNode","nearNode","farNode","rangeFog","FogExp2Node","densityNode","density","densityFog","BarrierNode","AtomicFunctionNode","pointerNode","storeNode","methodSnippet","varSnippet","uniformsLib","getLightData","uniforms","_","lightTargetPosition","lightViewPosition","lightTargetDirection","sortLights","lights","getLightNodeById","lightNodes","lightNode","_lightsNodeRef","LightsNode","previousLightNodes","nodeLibrary","lightNodeClass","_lightNodes","totalDiffuseNode","totalSpecularNode","backdrop","backdropAlpha","totalDiffuse","BasicShadowMap","shadowCoord","PCFShadowMap","shadow","depthCompare","compare","mapSize","dx0","dy0","dx1","dy1","dx2","dy2","dx3","dy3","PCFSoftShadowMap","VSMShadowMapNode","occlusion","distribution","hardShadow","variance","softnessProbability","VSMPassVertical","shadowPass","mean","squaredMean","uvStride","uvStart","uvOffset","std_dev","VSMPassHorizontal","_shadowFilterLib","_overrideMaterial","_quadMesh$1","ShadowNode","shadowMapType","shadowMap","shadowPassVertical","shadowPassHorizontal","shadowIntensity","bias","normalBias","coordZ","cameraNearLocal","cameraFarLocal","frustumTest","filterFn","shadowColor","shadowNode","shadowType","depthVersion","currentOverrideMaterial","currentRenderObjectFunction","AnalyticLightNode","shadowColorNode","customShadowNode","getDistanceAttenuation","lightDistance","cutoffDistance","decayExponent","distanceFalloff","directPointLight","lVector","lightAttenuation","PointLightNode","getShIrradianceAt","shCoefficients","_clearColor$1","Background","renderList","forceClear","sceneData","backgroundNode","backgroundMesh","backgroundMeshNode","viewProj","nodeMaterial","backgroundCacheKey","clearColorValue","_id$5","BindGroup","bindingsReference","NodeBuilderState","vertexShader","fragmentShader","computeShader","updateNodes","updateBeforeNodes","updateAfterNodes","monitor","instanceGroup","bindingsGroup","instanceBinding","NodeAttribute","NodeUniform","NodeVar","NodeVarying","NodeCode","NodeCache","Uniform","NumberUniform","Vector2Uniform","Vector3Uniform","Vector4Uniform","ColorUniform","Matrix3Uniform","Matrix4Uniform","NumberNodeUniform","Vector2NodeUniform","Vector3NodeUniform","Vector4NodeUniform","ColorNodeUniform","Matrix3NodeUniform","Matrix4NodeUniform","LOD_MIN","EXTRA_LOD_SIGMA","MAX_SAMPLES","_flatCamera","_cubeCamera","_clearColor","_oldTarget","_oldActiveCubeFace","_oldActiveMipmapLevel","PHI","INV_PHI","_axisDirections","_faceLib","PMREMGenerator","sigma","cubeUVRenderTarget","equirectangular","cubemap","_getCubemapMaterial","_getEquirectMaterial","cubeSize","outputTarget","_setViewport","_createRenderTarget","_lodMax","_createPlanes","_getBlurShader","tmpMesh","cubeCamera","upSign","forwardSign","originalAutoClear","backgroundBox","backgroundMaterial","useSolidColor","col","isCubeTexture","autoClear","lodIn","lodOut","pingPongRenderTarget","targetIn","targetOut","sigmaRadians","blurMaterial","STANDARD_DEVIATIONS","blurMesh","blurUniforms","pixels","radiansPerPixel","sigmaPixels","sum","outputSize","lodMax","lodPlanes","sizeLods","sigmas","lodMeshes","totalLods","sizeLod","cubeFaces","positionSize","uvSize","faceIndexSize","faceIndex","coordinates","faceIdx","fill","_getMaterial","materialUniforms","envTexture","rendererCache","typeFromLength","typeFromArray","toFloat","NodeBuilder","parser","bindGroupsCache","groupName","bindingsArray","sharedGroup","bindingsGroups","bindingGroup","updateBeforeType","updateAfterType","componentType","generateConst","baseType","dataAttribute","vecType","vecNum","newComponentType","lastStack","vars","nodeVarying","varyings","codes","nodeBlock","flowCodes","flowCodeBlock","needsFlowCode","nodeBlockHierarchy","flowCode","codeBlock","flowData","previous","previousFlow","previousVars","previousBuildStage","flow","previousShaderStage","variable","flowNodes","fromType","toType","fromTypeLength","toTypeLength","NodeFrame","referenceMap","nodeRef","maps","frameMap","renderMap","NodeFunctionInput","qualifier","isConst","DirectionalLightNode","_matrix41","_matrix42","ltcLib","RectAreaLightNode","ltc","SpotLightNode","angleCosine","coneCosNode","penumbraCosNode","cutoffDistanceNode","decayExponentNode","angleCos","spotAttenuation","IESSpotLightNode","iesMap","AmbientLightNode","HemisphereLightNode","groundColorNode","lightDirectionNode","hemiDiffuseWeight","LightProbeNode","NodeParser","NodeFunction","declarationRegexp$1","propertiesRegexp$1","pragmaMain","parse$1","pragmaMainIndex","mainCode","declaration","inputsCode","propsMatches","nameMatch","blockCode","headerCode","GLSLNodeFunction","declarationCode","GLSLNodeParser","outputNodeMap","Nodes","nodeUniformsGroup","groupNode","uniformsGroupData","frameId","groupChain","nodeBuilderCache","nodeBuilder","computeData","chain","cacheKeyData","environmentNode","forceUpdate","fog","environment","outputTexture","RenderBundle","RenderBundles","NodeLibrary","nodeMaterialClass","toneMappingNode","materialType","materialNodeClass","materialClass","lightClass","nodeClass","baseClass","_defaultLights","Lighting","_scene","_drawingBufferSize","_screen","_frustum","_projScreenMatrix","_vector4","Renderer","logarithmicDepthBuffer","antialias","getFallback","alphaClear","error","targetScene","previousRenderId","previousRenderContext","previousRenderObjectFunction","previousCompilationPromises","sceneRef","compilationPromises","opaqueObjects","transparentObjects","errorMessage","bundle","bundleGroup","renderBundle","renderBundleData","needsUpdate","renderBundleNeedsUpdate","renderObjects","currentToneMapping","currentColorSpace","frameBufferTarget","useFrameBufferTarget","outputRenderTarget","scissor","minDepth","maxDepth","bundles","transparentDoublePassObjects","quad","updateStyle","boolean","renderObjectFunction","computeNodes","computeList","dispose","onInitFn","computeBindings","computePipeline","rectangle","srcTexture","dstTexture","srcRegion","dstPosition","baseRenderList","doublePassList","camera2","vp","viewportValue","overridePositionNode","overrideFragmentNode","overrideDepthNode","overrideMaterial","needsRefresh","Binding","visibility","getFloatLength","floatLength","Buffer","UniformBuffer","_id$4","NodeUniformBuffer","UniformsGroup","byteLength","boundary","chunkOffset","remainingSizeInChunk","arraysEqual","setArray","_id$3","NodeUniformsGroup","_id$2","SampledTexture","generation","version","NodeSampledTexture","access","NodeSampledCubeTexture","NodeSampledTexture3D","glslMethods","precisionLib","supports$1","defaultPrecisions","GLSLNodeBuilder","storageBufferNode","originalArray","numElements","isInteger","typeMap","newSize","newArray","pboTexture","pbo","storageArrayElementNode","elementNodeData","bufferNodeData","propertySizeName","prefix","uvIndexSnippet","snippets","bindingSnippets","uniformGroups","typePrefix","bufferCountSnippet","groupSnippets","location","struct","members","member","structs","flat","acc","curr","behavior","ext","varyingName","attributeNode","shaderData","shadersData","mainNode","flowSlotData","slotName","stageData","uniformGPU","uniformsStage","uniformsGroup","vector2","vector4","color4","Backend","_id$1","DualAttributeData","dualBuffer","WebGLAttributeUtils","usage","bufferGPU","bufferGPUDual","updateRanges","writeBuffer","dstBuffer","initialized$1","equationToGL","factorToGL","WebGLState","enabled","flipSided","cullFace","currentLineWidth","blending","blendEquation","blendSrc","blendDst","blendEquationAlpha","blendSrcAlpha","blendDstAlpha","premultipliedAlpha","colorMask","depthTest","depthMask","depthFunc","stencilTest","stencilMask","stencilFunc","stencilRef","stencilFail","stencilZFail","stencilZPass","frontFaceCW","stencilWrite","polygonOffset","units","framebuffer","currentBoundFramebuffers","drawBuffers","webglSlot","currentTextureSlot","maxTextures","webglType","webglTexture","currentBoundTextures","boundTexture","WebGLUtils","extension","sync","test","initialized","wrappingToGL","filterToGL","compareToGL","WebGLTextureUtils","glTextureType","internalFormatName","glFormat","glType","forceLinearTransfer","internalFormat","textureType","hasMipmaps","defaultTextures","textureGPU","levels","glInternalFormat","getImage","mipmaps","mipmap","renderContextData","dstTextureGPU","minX","minY","dstX","dstY","currentUnpackRowLen","currentUnpackImageHeight","currentUnpackSkipPixels","currentUnpackSkipRows","currentUnpackSkipImages","srcTextureData","dstTextureData","srcRenderContextData","dstRenderContextData","srcFramebuffer","dstFramebuffer","mask","requireDrawFrameBuffer","srcHeight","partial","attachment","renderTargetContextData","fb","msaaFrameBuffer","flippedY","renderbuffer","depthBuffer","stencilBuffer","typedArrayType","bytesPerTexel","bytesPerComponent","WebGLExtensions","WebGLCapabilities","GLFeatureName","WebGLBufferRenderer","mode","primcount","starts","counts","drawCount","elementCount","WebGLBackend","glContext","onContextLost","contextLossInfo","nextRenderContext","queryInfo","available","disjoint","elapsed","occlusionQueryCount","viewY","currentOcclusionQueries","currentOcclusionQueryObjects","occluded","check","completed","query","setFrameBuffer","clearColor","clear","computeGroup","programGPU","transformBuffers","vaoKey","vaoGPU","transformFeedbackGPU","dualAttributeData","contextData","staticVao","lastObject","vertexCount","indexData","parallel","checkStatus","errorLine","lines","lines2","status","errors","errorMatches","glFragmentShader","glVertexShader","programLog","vertexErrors","fragmentErrors","pipelineData","transformVaryingNames","transformAttributeNodes","attributeNodes","uniformBuffers","bindGroupData","keysMatching","currentFrameBuffer","isCube","msaaFb","depthRenderbuffer","cubeFace","depthStyle","invalidationArray","msaaRenderbuffers","bindingData","Sampler","NodeSampler","StorageBuffer","_id","NodeStorageBuffer","WebGPUTexturePassUtils","device","mipmapVertexSource","mipmapFragmentSource","flipYFragmentSource","textureGPUDescriptor","baseArrayLayer","transferPipeline","flipYPipeline","tempTexture","srcView","dstView","commandEncoder","pass","sourceView","destinationView","bindGroupLayout","passEncoder","passes","passDescriptor","_compareToWebGPU","_flipMap","WebGPUTextureUtils","samplerDescriptorGPU","getFormat","dimension","primarySampleCount","textureDescriptorGPU","video","videoFrame","msaaTextureDescriptorGPU","depthTextureGPU","bytesPerRow","readBuffer","encoder","defaultCubeTexture","defaultVideoFrame","init","flipIndex","originDepth","passUtils","blockData","isTextureArray","bytesPerImage","addressMode","filterMode","formatGPU","declarationRegexp","propertiesRegexp","wgslTypeLib$1","parse","match","resolvedType","WGSLNodeFunction","WGSLNodeParser","GPUShaderStage","gpuShaderStageLib","supports","wgslFnOpLib","wgslTypeLib","wgslPolyfill","wgslMethods","diagnostics","WGSLNodeBuilder","valueSnippet","fnOp","sampler","bufferClass","directives","directive","builtins","attributesSnippet","bufferSnippets","structSnippets","uniformIndexes","multisampled","componentPrefix","bufferTypeSnippet","bufferSnippet","bufferAccessMode","vectorType","isOutputStruct","structSnippet","wgslMethod","codeNode","structName","WebGPUUtils","typedArraysToVertexFormatPrefix","typedAttributeToVertexFormatPrefix","typeArraysToVertexFormatPrefixForItemSize1","WebGPUAttributeUtils","tempArray","slot","bytesPerElement","vertexBufferLayout","arrayStride","stepMode","readBufferGPU","cmdEncoder","gpuCommands","ArrayType","bytesPerUnit","paddedItemSize","WebGPUBindingUtils","entries","bindingGPU","bindGroupLayoutCache","bindingsData","bindLayoutGPU","bindGroupGPU","layoutGPU","bindingPoint","entriesGPU","resourceGPU","aspectGPU","dimensionViewGPU","WebGPUPipelineUtils","renderObjectContext","utils","bindGroupLayouts","stencilFront","colorWriteMask","targets","colorFormat","vertexModule","fragmentModule","primitiveState","depthStencilFormat","pipelineDescriptor","depthStencil","renderDepth","renderStencil","pipelineGPU","setBlend","srcRGB","dstRGB","srcAlpha","dstAlpha","blend","blendFactor","stencilCompare","stencilOperation","blendOperation","WebGPUBackend","adapterOptions","adapter","features","supportedFeatures","deviceDescriptor","deviceLossInfo","alphaMode","colorAttachment","colorAttachments","textureView","resolveTarget","depthStencilAttachment","occlusionQuerySet","currentPass","bufferSize","queryResolveBuffer","currentOcclusionQueryBuffer","clearValue","supportsDepth","supportsStencil","groupGPU","passEncoderGPU","maxComputeWorkgroupsPerDimension","computeNodeData","dispatchSize","currentSets","currentBindingGroups","indexFormat","vertexBuffer","drawInstances","firstInstance","indexCount","firstIndex","primitiveTopology","timeStampQuerySet","resolveBuffer","isMappingPending","bundleGPU","dstLayer","srcX","srcY","srcLayer","srcWidth","sourceGPU","destinationGPU","IESSpotLight","StandardNodeLibrary","WebGPURenderer","BackendClass","_changeEvent","_startEvent","_endEvent","_TILT_LIMIT","_v","_twoPI","_STATE","_EPS","OrbitControls","onPointerMove","onPointerDown","onPointerUp","onContextMenu","onMouseWheel","onKeyDown","onTouchStart","onTouchMove","onMouseDown","onMouseMove","interceptControlDown","interceptControlUp","deltaTime","zoomChanged","prevRadius","newRadius","radiusDelta","mouseBefore","prevZoom","mouseAfter","normalizedDelta","objectMatrix","deltaX","deltaY","targetDistance","dollyScale","rect","dist","centerX","centerY","pointerId","newEvent","mouseAction","toTrianglesDrawMode","drawMode","numberOfTriangles","newIndices","newGeometry","GLTFLoader","GLTFMaterialsClearcoatExtension","GLTFMaterialsDispersionExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFTextureAVIFExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsEmissiveStrengthExtension","GLTFMaterialsSpecularExtension","GLTFMaterialsIridescenceExtension","GLTFMaterialsAnisotropyExtension","GLTFMaterialsBumpExtension","GLTFLightsExtension","GLTFMeshoptCompression","GLTFMeshGpuInstancing","relativeUrl","_onError","gltf","dracoLoader","ktx2Loader","meshoptDecoder","plugins","textDecoder","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","GLTFBinaryExtension","GLTFParser","plugin","extensionName","extensionsRequired","GLTFMaterialsUnlitExtension","GLTFDracoMeshCompressionExtension","GLTFTextureTransformExtension","GLTFMeshQuantizationExtension","GLTFRegistry","nodeDefs","nodeIndex","nodeLength","nodeDef","lightIndex","dependency","lightDef","assignExtrasToUserData","materialParams","materialDef","pending","metallicRoughness","emissiveStrength","colorFactor","colorArray","textureIndex","textureDef","handler","isSupported","bufferView","extensionDef","byteOffset","meshDef","primitive","WEBGL_CONSTANTS","attributesDef","accessor","meshes","instancedMeshes","instancedMesh","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","headerView","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","accessorDef","WEBGL_COMPONENT_TYPES","GLTFCubicSplineInterpolant","stride2","stride3","td","m0","m1","_q","GLTFCubicSplineQuaternionInterpolant","WEBGL_FILTERS","WEBGL_WRAPPINGS","WEBGL_TYPE_SIZES","PATH_PROPERTIES","INTERPOLATION","ALPHA_MODES","createDefaultMaterial","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfDef","addMorphTargets","hasMorphNormal","hasMorphColor","pendingPositionAccessors","pendingNormalAccessors","pendingColorAccessors","pendingAccessor","accessors","morphPositions","updateMorphTargets","targetNames","createPrimitiveKey","primitiveDef","geometryKey","dracoExtension","createAttributesKey","attributesKey","getNormalizedComponentScale","constructor","getImageURIMimeType","uri","isSafari","safariVersion","isFirefox","firefoxVersion","userAgent","safariMatch","dependencies","skinDefs","meshDefs","skinIndex","skinLength","joints","ref","updateMappings","original","clone","mappings","defs","def","bufferIndex","bufferDef","bufferViewDef","accessorIndex","TypedArray","pendingBufferViews","bufferViews","elementBytes","itemBytes","byteStride","ibSlice","ibCacheKey","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","sourceIndex","sourceDef","URL","sourceURI","isObjectURL","mapName","mapDef","gltfReference","useDerivativeTangents","useVertexColors","useFlatShading","pointsMaterial","lineMaterial","cachedMaterial","materialExtensions","kmuExtension","emissiveFactor","originalName","sanitizedName","primitives","createDracoPrimitive","addPrimitiveAttributes","geometryPromise","meshIndex","cameraIndex","cameraDef","skinDef","inverseBindMatrices","jointNodes","jointNode","animationIndex","animationDef","animationName","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","inputAccessors","outputAccessors","samplers","inputAccessor","outputAccessor","createdTracks","nodePending","childPending","childrenDef","skeletonPending","meshPromise","sceneIndex","sceneDef","nodeIds","reduceAssociations","reducedAssociations","targetName","outputArray","scaled","interpolantType","computeBounds","boxScale","maxDisplacement","assignAttributeAccessor","gltfAttributeName","_shadowMatrix","ShadowMesh","shadowMaterial","lightPosition4D","sme","global","factory","exports","this","Semver","core","prerelease","coreComps","BladeApi","disabled","hidden","TpEvent","TpChangeEvent","presetKey","last","TpUpdateEvent","TpFoldEvent","expanded","TpTabSelectEvent","forceCast","isEmpty","deepEqualsArray","isPropertyWritable","CREATE_MESSAGE_MAP","TpError","config","_a","BindingTarget","opt_id","valueObj","ButtonApi","title","eventName","bh","Emitter","observers","observer","PREFIX","ClassName","viewName","opt_elementName","opt_modifier","compose","extractValue","ev","bindValue","applyValue","bindValueMap","valueMap","applyClass","elem","className","active","valueToClassName","bindValueToTextContent","className$q","ButtonView","doc","buttonElem","titleElem","ButtonController","BoundValue","initialValue","rawValue","opts","constrainedValue","prevValue","PrimitiveValue","createValue","constraint","ValueMap","parseObject","keyToParserMap","parseArray","parseItem","item","isObject","createParamsParserBuilder","optional","createParamsParserBuilders","itemParser","ParamsParsers","parseParams","warnMissing","disposeElement","ReadonlyValue","className$p","valueToModifier","modifier","ViewProps","opt_initialValue","_b","_c","disposed","prevParent","getAllBladePositions","className$o","POS_TO_CLASS_NAME_MAP","BladeController","SVG_NS","forceReflow","disableTransitionTemporarily","supportsTouch","getGlobalObject","getWindowDocument","getCanvasContext","canvasElement","win","ICON_ID_TO_INNER_HTML_MAP","createSvgIconElement","document","iconId","insertElementAt","parentElement","removeElement","removeChildElements","removeChildNodes","findNextTarget","className$n","createLabelNode","frag","lineNode","LabelView","labelElem","valueElem","LabelController","viewProps","ButtonBladePlugin","args","ValueBladeController","createBlade","Foldable","coreObj","exHeight","expandedClassName","onExpand","computeExpandedFolderHeight","folder","containerElement","applyHeight","foldable","bindFoldable","RackLikeApi","rackApi","addButtonAsBlade","api","addFolderAsBlade","addSeparatorAsBlade","opt_params","addTabAsBlade","NestedOrderedSet","extract","opt_index","subList","InputBindingApi","InputBindingController","MonitorBindingApi","MonitorBindingController","findSubBladeApiSet","RackApi","getApiByController","apiSet","createBindingTarget","pool","rack","gapi","FolderApi","RackLikeController","PlainView","findInputBindingController","bcs","findMonitorBindingController","findValueBladeController","findSubRack","RackController","findSubBladeControllerSet","BladeRack","controllerClass","emitter","visibleItems","firstVisibleItem","lastVisibleItem","ps","_ev","bladeContainerClassName","FolderView","indentElem","markElem","containerElem","FolderController","rc","FolderBladePlugin","LabeledValueController","SeparatorApi","className$m","SeparatorView","hrElem","SeparatorController","SeparatorBladePlugin","className$l","TabItemView","selected","TabItemController","TabPageController","TabPageApi","contentRackApi","TabApi","pc","INDEX_NOT_SELECTED","Tab","firstSelIndex","className$k","TabView","contentsElem","TabController","cr","tab","TabBladePlugin","createBladeController","ManualTicker","IntervalTicker","interval","inactive","InputBinding","targetValue","fillBuffer","initializeBuffer","createTrimmedBuffer","createPushedBuffer","newBuffer","MonitorBinding","CompositeConstraint","constraints","findConstraint","constraintClass","tmpResult","sc","DefiniteRangeConstraint","ListConstraint","RangeConstraint","StepConstraint","className$j","ListView","selectElem","optionElem","ListController","className$i","PopupView","PopupController","className$h","TextView","inputElem","formatter","TextController","parsedValue","boolToString","boolFromUnknown","BooleanFormatter","NumberLiteralNode","BINARY_OPERATION_MAP","BinaryOperationNode","operator","UNARY_OPERATION_MAP","UnaryOperationNode","expr","combineReader","parsers","cursor","readWhitespace","readNonZeroDigit","readDecimalDigits","readSignedInteger","ds","sds","readExponentPart","si","readDecimalIntegerLiteral","nzd","readDecimalLiteral1","dil","dds","readDecimalLiteral2","readDecimalLiteral3","readDecimalLiteral","parseBinaryDigits","readBinaryIntegerLiteral","bds","readOctalDigits","readOctalIntegerLiteral","ods","readHexDigits","readHexIntegerLiteral","hds","readNonDecimalIntegerLiteral","readNumericLiteral","parseLiteral","num","parseParenthesizedExpression","parseExpression","cl","parsePrimaryExpression","parseUnaryExpression","readBinaryOperator","ops","createBinaryOperationExpressionParser","exprParser","firstExpr","nextExpr","parseBinaryOperationExpression","parseEcmaNumberExpression","parseNumber","numberFromUnknown","pv","numberToString","createNumberFormatter","digits","innerFormatter","formatPercentage","stringFromUnknown","formatString","connectValues","primary","secondary","forward","backward","changing","preventFeedback","getStepForKey","baseStep","getVerticalStepKeys","getHorizontalStepKeys","isVerticalArrowKey","isArrowKey","computeOffset$1","PointerHandler","touch","mapRange","start1","end1","start2","end2","getDecimalDigits","constrainRange","loopRange","className$g","NumberTextView","knobElem","guideElem","bodyElem","headElem","tooltipElem","aox","adx","NumberTextController","ph","className$f","SliderView","trackElem","SliderController","className$e","SliderTextView","sliderElem","textElem","SliderTextController","writePrimitive","parseListOptions","parsePickerLayout","parsePointDimensionParams","normalizeListOptions","items","createListConstraint","findStep","getSuitableDecimalDigits","getBaseStep","getSuitableDraggingScale","base","className$d","CheckboxView","wrapperElem","CheckboxController","createConstraint$6","lc","BooleanInputPlugin","_args","className$c","ColorView","swatchElem","pickerElem","rgbToHslInt","rp","gp","bp","cmax","cmin","hslToRgbInt","hp","sp","lp","rgbToHsvInt","hsvToRgbInt","hslToHsvInt","sd","hsvToHslInt","removeAlphaComponent","comps","appendAlphaComponent","MODE_CONVERTER_MAP","getColorMaxComponents","loopHueRange","constrainColorComponents","ms","convertColorType","fms","tms","convertColor","intComps","isRgbColorComponent","comps1","comps2","opt_mode","rgbComps","className$b","ColorPickerView","hsvElem","svElem","hElem","rgbElem","aElem","apElem","atElem","elems","parseColorType","parseColorInputParams","getBaseStepForColor","forAlpha","extractColorType","equalsStringColorFormat","f1","f2","parseCssNumberOrPercentage","maxValue","ANGLE_TO_DEG_MAP","parseCssNumberOrAngle","unit","parseFunctionalRgbColorComponents","createFunctionalRgbColorParser","parseFunctionalRgbaColorComponents","createFunctionalRgbaColorParser","parseHslColorComponents","createHslColorParser","parseHslaColorComponents","createHslaColorParser","parseHexRgbColorComponents","mRgb","mRrggbb","parseHexRgbColor","parseHexRgbaColorComponents","parseHexRgbaColor","parseObjectRgbColorComponents","createObjectRgbColorParser","parseObjectRgbaColorComponents","createObjectRgbaColorParser","PARSER_AND_RESULT","detectStringColor","prev","detection","detectStringColorFormat","TYPE_TO_PARSERS","createColorStringBindingReader","createColorStringParser","zerofill","comp","colorToHexRgbString","hexes","colorToHexRgbaString","rgbaComps","colorToFunctionalRgbString","opt_type","createFunctionalRgbColorFormatter","colorToFunctionalRgbaString","aFormatter","rgbFormatter","createFunctionalRgbaColorFormatter","colorToFunctionalHslString","formatters","colorToFunctionalHslaString","colorToObjectRgbString","names","createObjectRgbColorFormatter","colorToObjectRgbaString","createObjectRgbaColorFormatter","FORMAT_AND_STRINGIFIERS","findColorStringifier","fas","className$a","APaletteView","barElem","colorElem","markerElem","previewElem","leftColor","rightColor","gradientComps","APaletteController","className$9","createModeSelectElement","optElem","ColorTextView","modeElem","modeMarkerElem","textsElem","textViews","compElem","createFormatter$2","createConstraint$5","createComponentController","ColorTextController","cc","ccs","cs","pickedMode","className$8","HPaletteView","HPaletteController","className$7","CANVAS_RESOL","SvPaletteView","canvasElem","ctx","hsvComps","imgData","SvPaletteController","dv","ColorPickerController","className$6","ColorSwatchView","ColorSwatchController","ColorController","pickerC","nextTarget","colorFromObject","colorToRgbNumber","colorToRgbaNumber","numberToRgbColor","numberToRgbaColor","colorFromRgbNumber","colorFromRgbaNumber","createColorStringWriter","stringify","createColorNumberWriter","supportsAlpha","colorToNumber","writeRgbaColorObject","writeRgbColorObject","createColorObjectWriter","inValue","shouldSupportAlpha$1","inputParams","createFormatter$1","isForColor","NumberColorInputPlugin","picker","shouldSupportAlpha","createColorObjectReader","createColorObjectFormatter","ObjectColorInputPlugin","StringColorInputPlugin","writer","stringifier","PointNdConstraint","className$5","PointNdTextView","axisElem","createAxisController","PointNdTextController","createStepConstraint","createRangeConstraint","findNumberRange","drc","createConstraint$4","NumberInputPlugin","Point2d","Point2dAssembly","className$4","Point2dView","className$3","Point2dPickerView","padElem","svgElem","xAxisElem","yAxisElem","lineElem","px","py","ipy","computeOffset","baseSteps","invertsY","Point2dPickerController","Point2dController","padC","Point3d","Point3dAssembly","point3dFromUnknown","writePoint3d","createConstraint$3","createDimensionConstraint","createAxis$2","Point3dInputPlugin","Point4d","Point4dAssembly","point4dFromUnknown","writePoint4d","createConstraint$2","createAxis$1","Point4dInputPlugin","createConstraint$1","StringInputPlugin","Constants","className$2","MultiLogView","textareaElem","shouldScroll","MultiLogController","className$1","SingleLogView","lastValue","SingleLogController","BooleanMonitorPlugin","GraphLogView","bounds","maxIndex","GraphLogController","createFormatter","createTextMonitor","createGraphMonitor","shouldShowGraph","NumberMonitorPlugin","StringMonitorPlugin","createInputBindingController","valueArgs","createTicker","createMonitorBindingController","bindingArgs","PluginPool","createDefaultPluginPool","Point2dInputPlugin","point2dFromUnknown","writePoint2d","rs","createConstraint","getSuitableMaxDimensionValue","getSuitableMaxValue","xc","yc","xr","yr","createAxis","shouldInvertY","yParams","ListApi","SliderApi","minValue","TextApi","ListBladePlugin","ic","exportPresetJson","importPresetJson","preset","RootApi","ibc","mbc","RootController","SliderBladePlugin","TextBladePlugin","createDefaultWrapperElement","embedStyle","css","styleElem","Pane","opt_config","rootController","parentElem","VERSION","compose$1","createFoldable","ButtonCellApi","TpButtonGridEvent","cell","ButtonGridApi","gc","ButtonGridController","ButtonGridBladePlugin","CubicBezierApi","interpolate","MAX_ITERATION","X_DELTA","CACHE_RESOLUTION","CubicBezier","x01","y01","x12","y12","x23","y23","xr0","yr0","xr1","yr1","CubicBezierAssembly","cubicBezierToString","COMPS_EMPTY","cubicBezierFromString","CubicBezierView","iconElem","CubicBezierPickerView","graphElem","waitToBeAddedToDom","ob","CubicBezierGraphView","selection","vm","bezier","vElem","TICK_COUNT","PREVIEW_DELAY","PREVIEW_DURATION","CubicBezierPreviewView","ticksElem","progress","getDistance","lockAngle","la","CubicBezierGraphController","ptHandler","locksAngle","xStep","yStep","CubicBezierPickerController","CubicBezierController","shows","CubicBezierBladePlugin","rv","FpsGraphBladeApi","MAX_TIMESTAMPS","Fpswatch","now","nowTime","ts","FpsView","labelElement","valueElement","unitElement","FpsGraphController","FpsGraphBladePlugin","_d","Interval","IntervalAssembly","IntervalConstraint","edge","_e","_f","_g","_h","RangeSliderTextView","RangeSliderView","knobElems","xs","RangeSliderController","pmin","pmax","rmin","rmax","RangeSliderTextController","intervalFromUnknown","writeInterval","IntervalInputPlugin","exValue","midValue","RadioCellApi","TpRadioGridChangeEvent","RadioGridApi","capi","RadioView","RadioController","RadioGridController","RadioGridBladePlugin","createRadioGridInputPlugin","RadioGruidNumberInputPlugin","RadioGruidStringInputPlugin","RadioGruidBooleanInputPlugin","pane","EssentialsPlugin","fpsGraph","gltfLoader","THREE.Scene","fogColor","groundGeometry","THREE.PlaneGeometry","groundMaterial","THREE.MeshStandardMaterial","ground","THREE.Mesh","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","arrowDirection","THREE.Vector3","arrowPosition","arrowHelper","THREE.ArrowHelper","normalVector","planeConstant","groundPlane","THREE.Plane","THREE.Vector4","chair","chairShadow","chairFolder","lightFolder","lightParams","updateLightPosition","sizes","THREE.PerspectiveCamera","controls","THREE.WebGPURenderer","newColor","THREE.Color","tick"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6]}